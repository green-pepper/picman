2004-03-23  Sven Neumann  <sven@picman.org>
	    Michael Natterer <mitch@picman.org>

	* Made 2.0.0 release.

2004-03-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.h
	* libpicmanmodule/picmanmodule.h: incremented PICMAN_PROTOCOL_VERSION
	and PICMAN_MODULE_ABI_VERSION. This means that plug-ins or modules
	built for picman-1.3 will not work with PICMAN 2.0.

2004-03-23  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scripts/alien-glow-arrow.scm
	* plug-ins/script-fu/scripts/beveled-pattern-arrow.scm: Make
	helper functions local to the scripts. The better fix for
	bug #136868. Should also be done for a lot of other scripts,
	but is too likely to introduce new bugs to do this now.

2004-03-23  Sven Neumann  <sven@picman.org>

	* INSTALL
	* NEWS
	* README: updated for the 2.0 release.

2004-03-23  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scripts/alien-glow-arrow.scm: fixed
	utility function rotate-points. Only worked sometimes by
	accident, probably because beveled-pattern-arrow.scm implemented
	a function of the same name correctly and all scripts share
	a common namespace.

	Fixes bug #136868.

2004-03-23  Michael Natterer  <mitch@picman.org>

	The floating_sel code is really from the stone age:

	* app/core/picmanlayer-floating-sel.c (floating_sel_attach): call
	picman_image_floating_sel() once and work on the return value
	instead of accessing gimage->floating_sel directly twice and
	calling picman_image_floating_sel() for the thrid access.

	* app/core/picmanimage.c (picman_image_floating_sel): no need to
	return NULL if gimage->floating_sel is NULL, just always return
	gimage->floating_sel.

2004-03-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer-floating-sel.c (floating_sel_attach): don't
	do a type-checking cast on an object that was released a few lines
	above. Fixes bug #137957.

2004-03-22  Tor Lillqvist  <tml@iki.fi>

	* app/plug-in/plug-in.c (plug_in_recv_message): Win32-only
	workaround for bug #137968.

2004-03-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: keep the text editor open as long as
	the text tool is connected to a text layer. Open the text editor
	when a text layer is activated in the layers dialog.

2004-03-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: preserve the text tool on image
	changes. Instead connect to the text layer's "notify::modified"
	signal and disconnect from the layer when it is modified.
	Fixes bug #137890.

2004-03-22  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c (file_open_with_proc_and_display): removed
	the undo clearing/sanitizing code...

	(file_open_image): ...and added it here so *all* newly opened
	images start with a clean and sane undo state.

	* app/gui/file-commands.c (file_revert_confirm_callback): removed
	(incomplete) undo sanitizing here too.

2004-03-22  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: use putenv(); setenv() isn't available
	everywhere (bug #137930).

2004-03-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_reconnect):
	call picman_display_shell_expose_full() so the whole canvas gets
	cleared when reverting the image.

2004-03-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanparasiteio.c (picman_pixpipe_params_parse): clamp
	the pixpipe dimension to the allowed range. Fixes bug #137902.

2004-03-22  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_duplicate): put some
	code back in that I removed accidentally.
	(picman_text_layer_render) freeze/thaw notifications to avoid that
	two "notify::modified" signals are emitted.

2004-03-22  RaphaÃ«l Quinet  <quinet@gamers.org>

	* autogen.sh: Added a test for the version of intltool because
	some of the recent versions are known to break the Tips file.
	This fixes bug #137502.  The message should be updated when a new
	version of intltool is released.

2004-03-22  Simon Budig  <simon@picman.org>

	* app/widgets/picmandock.c: set the minimum of the
	"default_heigt" property range to -1, this enables users
	to disable this feature via gtkrc.

2004-03-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandock.c: added a style property "default_height"
	and set a window default size for new docks. Fixes bug #137876.

	* themes/Default/gtkrc: document the default dock height.

	* themes/Small/gtkrc: set a smaller default dock height here.

2004-03-21  Sven Neumann  <sven@picman.org>

	* app/core/picmanundo.[ch]: added picman_undo_type_to_name() a similar
	function used to live in picmanimage-undo.[ch].

	* app/core/picmanitemundo.c (picman_item_undo_new): allow NULL as name
	and generate it from the undo_type then.

	* app/core/picmanimage-undo.[ch]: added picman_image_undo_push_undu(),
	new function that allows to push an undo on the image.

	* app/text/Makefile.am
	* app/text/text-types.h
	* app/text/picmantextundo.[ch]: added PicmanTextUndo, derived from
	PicmanItemUndo.

	* app/core/picmanimage-undo-push.c (picman_image_undo_push_text_layer):
	use the new code and simply push a text undo here.

	* app/tools/picmantexttool.c: compress text undos by peeking at the
	undo stack. Fixes bug #137766.

2004-03-21  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/makefile.msc: 
	* libpicmanmodule/makefile.msc: s/1.3/2.0/g

2004-03-21  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_events): added run-time version
	check and do the workaround for bug #136636 only if
	the Gtk+ version is < 2.2.5.

	* m4macros/picman-2.0.m4: require picman >= 2.0.0

2004-03-21  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: fixed check that suppresses
	unnecessary reloads of the current page.

2004-03-21  Sven Neumann  <sven@picman.org>

	* app/gui/debug-commands.h: corrected #define for the debug menu.

2004-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.c: modify the event_box and preview
	styles in GtkWidget::style_set() instead of in
	picman_thumb_box_new() so they follow theme changes correctly and
	the labels stay visible when switching to an "inverse" theme.

2004-03-20  Sven Neumann  <sven@picman.org>

	* Made 2.0rc1 release.

2004-03-20  Simon Budig  <simon@picman.org>

	* app/.cvsignore
	* docs/.cvsignore
	* tools/.cvsignore: updated to ignore 2.0 stuff  :-)

2004-03-20  Pedro Gimeno  <pggimeno@wanadoo.es>

	Fixed several off-by-one problems in display:

	* app/display/picmandisplayshell.h (PROJ_ROUND): New macro to apply
	to a float the same rounding method as the one used when rendering.
	(SCALEX, SCALEY): Use PROJ_ROUND instead of truncating.

	* app/display/picmandisplayshell-transform.c
	(picman_display_shell_transform_xy): Accept gdouble image coordinates
	even if the returned screen coordinates are integer. Use PROJ_ROUND
	instead of (gint) to apply proper rounding. Fixes bug #137566.

	* app/display/picmandisplayshell-transform.h
	(picman_display_shell_transform_xy): changed accordingly.

	* app/display/picmandisplayshell-draw.c
	* app/tools/picmandrawtool.c: make sure everywhere that PROJ_ROUND
	is used either directly or through picman_display_shell_transform_xy,
	instead of using arbitrary rounding methods.

2004-03-20  Sven Neumann  <sven@picman.org>

	* configure.in: set version number to 2.0.0, version string to
	"2.0rc1".

	* app/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanmodule/Makefile.am
	* libpicmanthumb/Makefile.am
	* libpicmanwidgets/Makefile.am
	* tools/Makefile.am: changed 1.3 to 2.0 all over the place.

	* README
	* NEWS: updated for the 2.0rc1 release.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c: it wasn't such a good idea to let
	PicmanConfig take care of the text when duplicating a text layer; it
	didn't create a copy. Do that manually again; fixes bug #137786.
	
2004-03-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_create_vectors): don't
	take the image from tool->gdisp, this might be a NULL pointer.

	* app/core/picmanimage-undo-push.c: removed debugging output.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c (picman_prop_size_entry_callback):
	avoid to set the unit property with every size change; only set it
	if it actually changed.

	* app/core/picmanimage-undo-push.c (picman_image_undo_push_text_layer):
	allow to pass a GParamSpec that identifies a single text property
	to be changed. In this case, don't store a PicmanText object on the
	undo stack but only the changed value.

	* app/tools/picmantexttool.c: use the new undo feature to reduce the
	memory footprint of text undo for the common case.

	* app/text/picmantextlayer.c: changed accordingly.

2004-03-20  Simon Budig  <simon@picman.org>

	* app/core/picmanimage-qmask.c: Applied slightly modified patch
	from Sven. When the quickmask has a floating selection, anchor
	it before loading the selection and deleting the qmask channel.

	Fixes bug #137170.

2004-03-20  Simon Budig  <simon@picman.org>

	* app/gui/select-commands.[ch]: new callbacks to convert the
	current vector to the selection.

	* app/gui/image-menu.c: hook it into the menu. Default shortcut
	is Shift+V.
	
	Fixes bug #137754.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_set): use the same
	undo group logic as in the text tool. Not really necessary since
	this function must not be called on modified text layers, but it's
	more consistent this way.

2004-03-20  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Assigned "b" as the default shortcut
	for the path tool ("Bezier").

	Fixes bug #137753.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: update the text editor when the text
	changes (for example when undoing text changes). Push a drawable
	undo when applying text changes to a modified text layer.

2004-03-20  Simon Budig  <simon@picman.org>

	* docs/picman.1.in: fixed a mangeled entry and described
	"picman --batch -".

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_render): don't fiddle
	with the item size, picman_drawable_set_tiles() does the right thing.
 
2004-03-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/jigsaw.c: pack and show the "Jigsaw Style" radio
	buttons. Fixes bug #137737.

2004-03-20  Simon Budig  <simon@picman.org>

	* app/core/picmanundo.[ch]: Make it possible to refresh the preview
	of an undo step.

	* app/tools/picmaneditselectiontool.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c: refresh the preview when
	compressing undos. This ensures that the last preview in the undo
	history always reflects the current state of the image.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_text_layer): fixed a
	bug that Mitch spotted.

2004-03-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_text_layer): don't
	exchange the text_layer's text object but sync it with the text
	object from the undo step.

	* app/text/picmantextlayer.c (picman_text_layer_set): in case the
	layer has a mask, push an undo group around the text modifications.

	* app/tools/picmantexttool.c (picman_text_tool_idle_apply): push a
	text layer undo before applying the text changes.

2004-03-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spread.c: don't call g_rand_int_range() with
	invalid parameters.

2004-03-19  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.[ch]: added picman_text_layer_set(), a
	function that calls g_object_set() on the text-layer's text object
	and pushes an undo step.

	* app/display/picmandisplayshell-dnd.c (picman_display_shell_bucket_fill):
	use the new function.

2004-03-19  Sven Neumann  <sven@picman.org>

	* HACKING: some minor updates.

2004-03-19  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_render): if there's a
	layer mask, resize it with the layer.

	* app/tools/picmantexttool.c: don't change text_tool->layer before
	calling picman_text_tool_connect().

2004-03-19  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: updated PS keybindings contributed by Eric Pierce.

2004-03-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: added a confirmation dialog that is
	shown when the user attempts to modify a modified text layer.

2004-03-19  Michael Natterer  <mitch@picman.org>

	* themes/Default/gtkrc
	* themes/Small/gtkrc: don't set the height of GtkHScales to 11px
	any longer. This modification was added only because at some time
	GTK+ 1.3.x (!!!) looked strange with the default size.

2004-03-19  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_scale_entry_new_internal): if
	a tooltip is given, put the label into an eventbox (bug #137612).

2004-03-19  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): added
	runtime check for GTK+ >= 2.4.0 and make sure the menubar's accels
	can be invoked even if the menubar is invisible (workaround for
	bug #137151).

2004-03-19  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.c (color_notebook_new)
	* app/tools/picmancroptool.c (crop_info_create)
	* app/tools/picmantransformtool.c (picman_transform_tool_dialog):
	explicitely set a default response for dialog buttons which were
	created using gtk_dialog_add_buttons().

2004-03-18  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: cleaned up text tool logic.

2004-03-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c: simplified visibility and linked
	undo compression by passing an UNDO type, not an UNDO_GROUP type.

	Fixed (made weird) compression of "exclusive visible/linked" undos
	to only compress undos of the same item type (only compress layer
	visibility if we pushed a *layer* visibility before, not a channel
	or vectors visibility). Even worse, we need to push the
	visibility/linked state of *all* items when pushing an exclusive
	group, otherwise compression won't work.

2004-03-18  Manish Singh  <yosh@picman.org>

	* libpicman/picmantypes.h: removed obsolete PicmanParamColor typedef.

2004-03-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: applied a patch from
	Kevin Cozens that slightly alters the Script-Fu console output.

2004-03-18  Sven Neumann  <sven@picman.org>

	* app/gui/layers-commands.c (layers_text_tool)
	* app/gui/layers-menu.c (layers_menu_update): treat modified text
	layers like normal layers.

	* app/gui/layers-commands.c (layers_edit_layer_query): added a
	check button that gives access to the "auto-rename" property of a
	text layer.

	* app/text/picmantextlayer.c: typo.

	* app/widgets/picmanpreviewrendererlayer.c
	(picman_preview_renderer_layer_render): show the text layer icon for
	unmodified text layers only.

2004-03-18  Simon Budig  <simon@picman.org>

	* app/widgets/picmanitemtreeview.c: compress visibility and linked
	undos.

2004-03-18  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-dnd.c (picman_display_shell_bucket_fill):
	added a missing call to picman_image_flush().

	* app/tools/picmantexttool.c: propagate text changes to the tool
	options.
	
	* app/text/picmantextlayer.c: made "text", "auto-rename" and
	"modified" properties of the text layer and copy them when
	duplicating a text layer.

	* app/text/picmantextlayer-xcf.[ch]: added utility functions to
	convert the new properties to flags to be saved in the XCF file.

	* app/xcf/xcf-load.c
	* app/xcf/xcf-private.h
	* app/xcf/xcf-save.c: load and save text layer properties.
	Disabled warnings about unknown properties for stable branches.

2004-03-18  Simon Budig  <simon@picman.org>

	* app/gui/layers-commands.c: Initialize a new layer
	unconditionally. Spotted by Roman Joost.

2004-03-18  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhelp.c: disabled debug output.

	* plug-ins/help/domain.[ch]
	* plug-ins/help/help.[ch]
	* plug-ins/help/locales.c: improved error reporting, fixed bugs
	and disabled debug output.

2004-03-18  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/CML_explorer.c
	* plug-ins/common/gtm.c: changed procedure names to be all
	lowercase so 2.0 ships with a sane namespace and doesn't give bad
	examples to plug-in authors.

2004-03-18  Sven Neumann  <sven@picman.org>

	Added support for localized help (bug #136996). Will need some
	minor touches to improve error reporting but basically it works.

	* plug-ins/help/Makefile.am
	* plug-ins/help/help.h: new file with common defines.

	* plug-ins/help/help.c
	* plug-ins/help/locales.c: include help.h, made debugging output
	optional.

	* plug-ins/help/domain.[ch]: added a hash table with locales for
	each help domain.

2004-03-18  Sven Neumann  <sven@picman.org>

	* plug-ins/help/Makefile.am
	* plug-ins/help/locales.[ch]: new files with code to handle locales.

	* plug-ins/help/help.c: changed accordingly.

	* plug-ins/help/domain.[ch]: added support for a fallback URL to
	handle missing help content. I18n support is missing still.

2004-03-17  Simon Budig  <simon@picman.org>

	* app/core/picmanbrushpipe.c: ensure that each rank of a
	brushpipe is >= 1.

	Fixes bug #137529

2004-03-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanpatternfactoryview.c: removed redundant code.

2004-03-17  Simon Budig  <simon@picman.org>

	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c
	* app/widgets/picmanitemtreeview.c: shuffled some
	picman_image_flush()'es around.

2004-03-17  Simon Budig  <simon@picman.org>

	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c: Make sure that non-dialog creation
	of layer/channels/vectors properly updates the image. Also
	clear the new channel unconditionally.

	Change the name of the newly created item to not include the "Copy".
	It isn't a copy.

	* app/widgets/picmanitemtreeview.c: Don't try to assemble translated
	strings.

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c: properly overwrite the
	tooltip for the "New" button.

	Sorry, some real string changes ahere, but they were necessary.

2004-03-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_paste): push the undo group around all
	operations, not just around some of them. Pulled common code
	out of the if() { } else { } construct. Cleanup.

2004-03-17  Simon Budig  <simon@picman.org>

	* app/gui/plug-in-menus.c: Sort the plugin menu entries with
	the mnemonics stripped. Avoids weird ordering in the "C" and
	"POSIX" locales.

	Fixes bug #137435.

	* app/widgets/picmanitemtreeview.c: make a simple click on the
	"New" Button use defaults and use shift-click for the new-dialog
	invocation.

	Some more useless button cleanup:

	* app/widgets/picmandatafactoryview.c: only create an Edit button
	when the edit_function is set.

	* app/core/picman.c: don't set an edit func for the patterns.

	* app/gui/patterns-menu.c: Don't create the "New", "Edit" and 
	"Duplicate" Menu entries for the patterns.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpatternfactoryview.[ch]: New widget:
	picman_pattern_factory_view. Necessary to be able to hide the
	"duplicate" button...

	* app/gui/dialogs-constructors.c: Use it.

2004-03-17  Sven Neumann  <sven@picman.org>

	Changes for help i18n in the core, the rest will take place in the
	help plug-in:
	
	* app/text/picmantext.[ch]: removed picman_text_get_default_language()
	
	* app/core/picman-utils.[ch]: ... and added it here as
	picman_get_default_language().

	* app/config/picmanrc-blurbs.h
	* app/config/picmandisplayconfig.[ch]: added property "help-locales".
	
	* app/widgets/picmanhelp.c: use the new property and pass it to the
	help plug-in.

	* app/core/picmanselection.c (picman_selection_invalidate_boundary):
	removed unused variable.

2004-03-17  Simon Budig  <simon@picman.org>

	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmandatafactoryview.c: remove basically useless
	edit buttons in the layers, vectors and patterns dialog.

	* app/widgets/picmanitemtreeview.c: Make Shift-Click on the "New"
	button create a new item using defaults.

2004-03-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_set_tiles): ref new
	tiles before unrefing the old ones.

	* app/core/picmanimage-undo-push.c: keep undo memsize exact by
	adjusting undo->size when the stored data changes.

	* app/core/picmanchannel.[ch] (picman_channel_new_from_alpha)
	* app/core/picmanchannel-select.[ch] (picman_channel_select_alpha):
	replaced "layer" parameter by "drawable".

	* app/gui/layers-commands.c
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/selection_cmds.c: regenerated.

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.[ch]
	* app/core/picmanselection.c: remdom cleanup & code review.

2004-03-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlist.c (picman_list_dispose): removed this function.
	It was removing all items without freezing the container first,
	which caused excessive signal handler activity in PicmanContext.

	Cleaned up the whole file a bit.

	* app/core/picmancontainer.c (picman_container_dispose): call
	picman_container_clear() which does the right thing and e.g. speeds
	up quitting significantly when picman->documents is huge.
	Reported by Jimmac.

2004-03-16  Simon Budig  <simon@picman.org>

	* app/gui/plug-in-commands.c: Update the Plugin Menu immediately
	after setting the last invoked plugin. Fixes inconsistencies
	between name shown and plugin invoked.

	Fixes #136909, #137242 and #81479 (again, the fix in
	lightening_main.c only probably was bogus, since this must not
	rely on correctly written plugins).

	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c
	* plug-ins/common/film.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/tile.c
	* plug-ins/fits/fits.c: Ensure that each picman_image_undo_enable()
	had a picman_image_undo_disable() first...

2004-03-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c: removed unused #includes.

2004-03-15  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_apply): look ahead in
	the queue of pending changes and compress changes to the same
	property. Fixed a couple of smaller issues.

	* app/widgets/picmanwidgets-utils.c: corrected indentation.

2004-03-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.c (picman_thumb_box_new): set a fixed
	width on the "filename" and "info" labels so they clip their texts
	rather than expand the thumb_box when the text is too wide
	(spotted by Jonathan Blandford).

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch] (enum PicmanUndoType): replaced
	PICMAN_UNDO_LAYER_MOD and PICMAN_UNDO_CHANNEL_MOD by
	PICMAN_UNDO_DRAWABLE_MOD.

	* app/core/picmanimage-undo-push.[ch]: ditto: replaced
	picman_image_undo_push_layer_mod() and
	picman_image_undo_push_channel_mod() by
	picman_image_undo_push_drawable_mod().

	* app/core/picmandrawable.[ch]: added undo_desc strings for "resize"
	and "scale" to the PicmanDrawableClass struct.

	(picman_drawable_scale)
	(picman_drawable_resize): pass push_undo = TRUE to
	picman_drawable_set_tiles_full() and use the undo_desc from the
	class.

	(picman_drawable_real_set_tiles): push a PICMAN_UNDO_DRAWABLE_MOD here...

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: ...and don't push undos in
	PicmanItem::scale(), PicmanItem::resize(), PicmanDrawable::set_tiles().

	* app/core/picmanchannel.c: Removed even more bounds_known = FALSE
	assignments from functions which already call
	picman_drawable_set_tiles().

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_set_tiles_full): emit
	"update" signals from the drawable before and after setting tiles
	and offsets.

	* app/core/picmandrawable-offset.c (picman_drawable_offset)
	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste)
	* app/core/picmanimage-undo-push.c (undo_pop_layer_mod, _channel_mod)
	* app/text/picmantextlayer.c (picman_text_layer_render)
	* app/tools/picmantransformtool.c (picman_transform_tool_doit):
	removed calls to picman_drawable_update().

	* app/core/picmandrawable-offset.c (picman_drawable_offset): don't
	push an undo step before calling picman_drawable_set_tiles()
	but simply pass push_undo == TRUE and the undo_desc.

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: added "offset_x" and "offset_y"
	parameters to PicmanDrawable::set_tiles().

	(picman_drawable_set_tiles): removed the "PicmanImageType" parameter.

	(picman_drawable_set_tiles_full): new function adding type, offset_x
	and offset_y parameters.

	(picman_drawable_real_set_tiles): set the drawable's offsets from
	the offset parameters and its size from the passed TileManager's
	size. Emit "size_changed" accordingly.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanlayer.c
	* app/text/picmantextlayer.c
	* app/tools/picmantransformtool.c: changed accordingly: removed
	calls to picman_viewable_size_changed() and all sorts of hackish
	assignments of the drawable's width/height/offset_x/offset_y
	properties.

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_render): don't call
	picman_image_flush().

	* app/tools/picmanxttool.c (picman_text_tool_apply): call it here
	instead.

	Now that we have a common place that exchanges drawable->tiles,
	we can abstract away boundary invalidation for this operation:

	* app/core/picmandrawable.c (picman_drawable_real_set_tiles):
	call picman_drawable_invalidate_boundary() before setting
	the new tiles.

	* app/core/picmanchannel.c (picman_channel_set_tiles)
	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste)
	* app/core/picmanimage-undo-push.c (undo_pop_layer_mod)
	* app/core/picmanlayer.c (picman_layer_scale) (picman_layer_resize)
	(picman_layer_flip) (picman_layer_rotate) (picman_layer_transform)
	* app/text/picmantextlayer.c (picman_text_layer_render): removed
	calls to picman_drawable_invalidate_boundary() from all functions
	which finally call picman_drawable_real_set_tiles().

	* app/tools/picmantransformtool.c (picman_transform_tool_doit): no
	need to set channel->bounds_known to FALSE, because
	picman_drawable_set_tiles() already did this.

2004-03-15  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: moved global variables to a struct and
	optimized the area exposed from splash_update().

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added "gboolean alpha_changed" to
	PicmanImageFlushAccumulator. Install an "alpha_changed" handler
	on gimage->layers and set flush_accum.alpha_changed = TRUE
	whenever the image's *only* layer changed its alpha.

	* app/core/picmanimage-undo-push.c (undo_pop_layer_mod)
	* app/core/picmanlayer.c (picman_layer_add_alpha): removed
	explicit calls to picman_image_alpha_changed().

2004-03-15  Simon Budig  <simon@picman.org>

	* app/base/tile-swap.[ch]: Applied a modified version of a patch
	from RaphaÃ«l, that implements a test if a swap file can be
	created. Also make the failure message more verbose.

	* app/base/base.[ch]: extend base_init() with a boolean return
	to indicate if the test to create a swap file was OK.

	* app/app_procs.c: Display a warning message at startup when the
	test fails.

	Fixes bug #64835.

2004-03-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_real_set_tiles): emit
	"alpha_changed" if the drawable got/lost an alpha channel by
	setting the new tiles.

	* app/core/picmanimage-undo-push.c (undo_pop_layer_mod)
	* app/core/picmanlayer.c (picman_layer_add_alpha): removed explicit
	calls to picman_drawable_alpha_changed().

2004-03-15  Michael Natterer  <mitch@picman.org>

	Closer to text layer undo:

	* app/core/picmanchannel.c (picman_channel_set_tiles): invalidate the
	channel's boundary and bounds.

	* app/text/picmantextlayer.c: implement PicmanDrawable::swap_pixels()
	and set text_layer->modified = TRUE after upchaining.

	(picman_text_layer_render): use picman_drawable_set_tiles() and
	set text_layer->modified = FALSE afterwards.

	* app/core/picmanimage-undo-push.c: cleaned up variable declarations
	and initializations.

	(undo_pop_layer_mod)
	(undo_pop_channel_mod): use picman_drawable_set_tiles() instead of
	touching drawable->tiles manually. Now all pixel manipulation
	(at least on layers) should be virtualized and can be detected by
	the text layer.

2004-03-15  Michael Natterer  <mitch@picman.org>

	Prepare the undo system for proper text layer undo:

	* app/core/core-enums.[ch] (enum PicmanUndoType): replaced
	PICMAN_UNDO_IMAGE and PICMAN_UNDO_IMAGE_MOD by PICMAN_UNDO_DRAWABLE.

	* app/core/picmanimage-undo-push.[ch]: ditto: replaced
	picman_image_undo_push_image() and picman_image_undo_push_image_mod()
	by picman_image_undo_push_drawable() which *always* expects to get a
	TileManager passed. Also added g_return_if_fail()s to check if the
	passed in tile manager follows the semantics of the "sparse"
	boolean.

	(undo_pop_drawable): removed all code and call the new
	picman_drawable_swap_pixels() instead (see below).

	* app/core/picmandrawable.[ch] (picman_drawable_push_undo): if tiles
	are NULL, create a copy of the area here and always pass tiles to
	picman_image_undo_push_drawable(). Added lots of g_return_if_fail()
	here too.

	Added new vitrual function PicmanDrawable::swap_pixels() which
	does what undo_pop_drawable() did.

	* app/core/picmanchannel.c: implement swap_pixels() and invalidate
	the channel's bounds and boundary.

2004-03-15  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: don't show a web-browser setting
	on win32, it's not used there (see bug #137173).

2004-03-15  Sven Neumann  <sven@picman.org>

	* data/images/picman_splash.png: splash image for PICMAN 2.0 by Jimmac.

	* app/gui/splash.[ch]: draw the text on the splash image, not
	below it.

	* app/app_procs.[ch]
	* app/gui/gui.[ch]
	* app/main.c
	* docs/picman.1.in: dropped support for the --no-splash-image
	command-line option (not to be confused with --no-splash). It was
	never very useful and makes even less sense in times where startup
	notification is available.

2004-03-15  Simon Budig  <simon@picman.org>

	* app/core/picmanimage.[ch]
	* app/core/picmanimage-undo.c: renamed gimage->freeze_count
	to gimage->undo_freeze_count (more explicit).
	
	* app/file/file-open.c: Ensure that the undo system is enabled
	after loading an image (to protect against broken loaders).

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c: don't set tool dialogs transient
	to the image window. Fixes bug #128833.

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/gui/about-dialog.c: don't abuse the SPLASHSCREEN window type
	hint, instead make the about dialog a popup window and center it
	explicitely.

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooldialog.c (picman_tool_dialog_new): allow to
	pass NULL as parent widget.

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: some code cleanup.

	* app/gui/about_dialog.c: typo.

2004-03-14  Simon Budig  <simon@picman.org>

	* plug-ins/common/jpeg.c: No need to use an undo_group *and*
	freeze/thaw an image. Just using the latter keeps the undo
	history ok in both directions. Also call picman_displays_flush()
	to make sure the undo keyboard shortcuts are enabled after the
	plugin ends.

2004-03-14  Simon Budig  <simon@picman.org>

	* app/core/picmanimage.[ch]
	* app/core/picmanimage-undo.c: introduced a freeze counter, so
	that undo_freeze(); undo_freeze(); undo_thaw(); no longer
	results in an thawed undo stack.

	Fixes Bug #124176.

	This might reveal other places in the code where
	picman_image_undo_freeze/thaw or picman_image_undo_disable/enable
	were used in an inconsistent (not-paired) manner.

	* app/file/file-open.c: e.g. here, where _enable was called on
	the new image. The intention was to free a potential undo stack,
	so now call picman_image_undo_free() instead.

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.[ch]: removed all idle handling here.
	Changes to the text-layer's text object all applied synchronously.
	
	* app/display/picmandisplayshell-dnd.c
	* app/text/picmantextlayer-transform.c: removed now obsolete calls
	to picman_text_layer_flush().

	* app/tools/picmantexttool.[ch]: queue up changes to the proxy text
	object and apply them in one go from a low-priority idle handler.
	This is basically what PicmanTextLayer used to do.

2004-03-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.[ch]
	* app/tools/picmantexttool.[ch]: introduced a proxy PicmanText object
	that is tied to the PicmanTextOptions for the lifetime of the text
	tool. Brings us one step closer to text undo...

2004-03-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-offset.c (picman_drawable_offset)
	* app/core/picmandrawable.c (picman_drawable_scale) (picman_drawable_resize)
	* app/core/picmanlayer.c (picman_layer_convert) (picman_layer_add_alpha):
	use picman_drawable_set_tiles() instead of fiddling with
	drawable->tiles, ->bytes etc. manually.

2004-03-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.[ch]: made enum
	PicmanDialogVisibilityState and PICMAN_DIALOG_VISIBILITY_KEY public.

	* app/widgets/picmansessioninfo.c (picman_session_info_get_geometry):
	only look at GTK_WIDGET_VISIBLE(info->widget) if the dialog's
	visibility state is PICMAN_DIALOG_VISIBILITY_UNKNOWN and map the
	visibility state to info->open otherwise.

	Fixes bug #137076.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c (gradient_calc_shapeburst_*):
	applied a patch from Pedro Gimeno that fixes the crash reported in
	bug #136219.

2004-03-13  Michael Natterer  <mitch@picman.org>

	Completed the fix for bug #136702:

	* app/core/picmanitem.[ch]: added "gboolean supersample" and
	"gint recursion_level" to PicmanItem::transform().

	* app/core/picmanitem-linked.[ch]	(picman_item_linked_transform): ditto.

	* app/core/picmandrawable-transform.[ch]: added "recursion_level"
	parameters and removed the RECURSION_LEVEL #define.

	* app/core/picmanchannel.c
	* app/core/picmandrawable.c
	* app/core/picmanlayer.c
	* app/vectors/picmanvectors.c: changed accordingly.

	* app/tools/picmantransformoptions.[ch]: added new property
	"recursion_level" which is not serializable and has no GUI. Pretty
	useless, but it's IMHO better to hardcode the default value here
	than in picmandrawable-transform.c

	* app/tools/picmantransformtool.c: changed accordingly.

	* tools/pdbgen/pdb/transform_tools.pdb: hardcode "recursion_level"
	to 3.

	* app/pdb/transform_tools_cmds.c: regenerated.

2004-03-13  Simon Budig  <simon@picman.org>

	* app/widgets/widgets-enums.h
	* app/widgets/picmanpreviewrenderer.[ch]: New function 
	picman_preview_renderer_set_border_type that takes an enum instead
	of an color to set the color of the border.

	* app/widgets/picmancellrendererviewable.c: check for the
	current border_type and change it to black when it is white and
	the cell is unselected. This should be solved in a better way
	later.

	Fixes bug #135023. 

	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmancontainergridview.c: changed to use the new
	function.

2004-03-13  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/script-fu/scripts/carve-it.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm: Fixed to avoid
	pasting to a layer that was not added to any image. This was causing
	the scripts to abort, because picman-edit-paste is now failing in that
	case.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmanblendoptions.c: override the "gradient_repeat"
	property inherited from PicmanPaintOptions and set the default to
	PICMAN_REPEAT_NONE. Seems more appropriate for the blend tool.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.[ch]: implement PicmanDrawable functions
	that affect the tiles and mark the text layer as modified. Added
	new function picman_drawable_is_text_layer() that checks whether a
	drawable is an unmodified text layer.

	* app/display/picmandisplayshell-dnd.c (picman_display_shell_bucket_fill):
	use picman_drawable_is_text_layer() and only set the text color if the
	text layer is unmodified. Fixes bug #136623.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.[ch]: added new virtual function
	PicmanDrawable::set_tiles().

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: push an undo before chaining up in
	set_tiles().

	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-convert.c
	* app/tools/picmantransformtool.c: use picman_drawable_set_tiles()
	instead of fiddling with the drawable's tile manager directly.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformoptions.c (picman_transform_options_gui): for
	consistency, changed the label from "Supersample" to "Supersampling".

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c: use g_printerr() for debug output.

	* app/base/tile-manager.c: cleaned up stone-old debug output.

2004-03-13  RaphaÃ«l Quinet  <quinet@gamers.org>

	* app/tools/picmantransformoptions.[ch]: added new "supersample"
	property to PicmanTransformOptions and added corresponding check
	button in the option dialog for the transform tools.

	* app/core/picmandrawable-transform.[ch],
	* app/core/picmandrawable.c,
	* app/tools/picmantransformtool.c: new "gboolean supersample"
	parameter added to picman_drawable_transform_tiles_affine() and
	picman_drawable_transform_affine().

	* tools/pdbgen/pdb/transform_tools.pdb: ditto.  For the PDB calls,
	the supersample parameter is set to FALSE for "rotate" and "shear"
	and set to TRUE for "perspective", "scale" and "transform_2d".

	* app/pdb/transform_tools_cmds.c: regenerated.

	The new "supersample" option lets the user decide if the
	transformations should use supersampling (RECURSION_LEVEL 3) or
	not.  This fixes both bug #136702 and bug #109817.  Hopefully for
	good, this time.

2004-03-13  RaphaÃ«l Quinet  <quinet@gamers.org>

	* app/tools/picmantexttool.c (picman_text_tool_set_layer): added
	missing semicolon that was breaking the build.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_set_layer): bugfix.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainermenuimpl.c: marked missing string for
	translation (spotted by Branko Collin).

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.[ch]: use a PicmanSizeEntry for the
	font size.

	* app/tools/picmantexttool.c: set the size entry's resolution to the
	image resolution. Fixes bug #118356.

2004-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: keep a pointer on the active text
	layer and let the tool follow the active layer. Fixes bug #124970.

	* app/gui/layers-commands.c: changed accordingly.

2004-03-12  Michael Natterer  <mitch@picman.org>

	Cleaned up the remaining libpicman API issues:

	* libpicman/picmanpixelfetcher.[ch] (enum PicmanPixelFetcherEdgeMode):
	added new enum value PICMAN_PIXEL_FETCHER_EDGE_BACKGROUND so we
	can actually use the bg_color feature of the PicmanPixelFetcher.

	(picman_pixel_fetcher_new): added "gboolean shadow" parameter
	because it must not change while the PicmanPixelFetcher exists.

	(picman_pixel_fetcher_set_shadow): removed.

	(picman_pixel_fetcher_set_bg_color): added "PicmanRGB *color"
	parameter and don't call picman_palette_get_foreground().

	(picman_pixel_fetcher_get_pixel): handle BACKGROUND mode. Cleaned up
	the function.

	(picman_get_bg_guchar)
	(picman_get_fg_guchar): removed these functions...

	* libpicman/picmandrawable.[ch]: ...and added
	picman_drawable_get_color_uchar() instead.

	* libpicman/picman.def
	* plug-ins/common/blinds.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/cubism.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/displace.c
	* plug-ins/common/edge.c
	* plug-ins/common/illusion.c
	* plug-ins/common/mblur.c
	* plug-ins/common/mosaic.c
	* plug-ins/common/plasma.c
	* plug-ins/common/polar.c
	* plug-ins/common/ripple.c
	* plug-ins/common/shift.c
	* plug-ins/common/spread.c
	* plug-ins/common/tileit.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/gflare/gflare.c
	* plug-ins/libpicmanoldpreview/picmanoldpreview.c: changed accordingly.

	(Didn't test the changed plug-ins because I wanted to get this
	API change into CVS as soon as possible)

2004-03-12  RaphaÃ«l Quinet  <quinet@gamers.org>

	* app/core/picmandrawable-transform.c (RECURSION_LEVEL): Set to 0 in
	order to avoid nasty blurring effects.  Fixes bug #136702, but
	re-opens bug #109817.  This is the best compromise for 2.0.
	Later, we will have to make the supersampling optional as
	suggested in the original patch to bug #109817.

2004-03-12  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	applied a patch from Kevin Cozens that improves Script-Fu error
	reporting (addresses bug #73610).

2004-03-12  Sven Neumann  <sven@picman.org>

	* data/misc/picman.keys.in: removed category entry. This would have
	to be translated and it's not our job to define where image/jpeg
	belongs to.

2004-03-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c
	* app/tools/picmaninktool.c
	* app/tools/picmantool.c: print debug output to stderr.

2004-03-12  Simon Budig  <simon@picman.org>

	* libpicman/picmanpixelfetcher.c: fixed off-by-one error
	in picman_pixel_fetcher_get_pixel () for EDGE_BLACK mode.

	Fixes bug #136907

2004-03-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-dnd.c (picman_display_shell_bucket_fill):
	only set the text layer's color if a color is being dropped. Fixes
	crash on pattern drops (bug #136645).

2004-03-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_editor): always connect
	the "text_changed" signal so text layers can be edited again.

2004-03-12  Sven Neumann  <sven@picman.org>

	* app/gui/tool-options-menu.c (tool_options_menu_entries): added
	explicit menu branches to allow them to be translated (bug #136937).

2004-03-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c (picman_text_options_create_text):
	set the color of the new text from the context foreground color.

2004-03-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.[ch]: redid the color handling.
	Still not perfect, but it is somewhat cleaner.

2004-03-11  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c: reverted a small change that I didn't
	want to commit at all.
	
2004-03-11  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.c: made picman_config_sync() and
	picman_config_connect() also work on objects of different types.
	Properties with the same name and the same type are synced /
	connected.
 
	* app/core/picmancontext.[ch]: added convenience functions to get/set
	the font by name.

	* app/tools/picmantextoptions.[ch]: don't hold a PicmanText object
	that duplicates properties like font and color which are in
	PicmanContext already. Instead added all text properties that are
	controlled from the text tool options.  Handling of the foreground
	color is somewhat broken and needs a PicmanContext wizard (Mitch!).

	* app/text/picmantext.c: blurbs are not any longer needed now that
	the property widgets are created from the PicmanTextOptions.

	* app/tools/picmantexttool.c: changed accordingly.

	* app/widgets/picmantexteditor.[ch]: use an internal GtkTextBuffer
	and emit "text-changed" when it changes.

2004-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colortoalpha.c: when running in interactive
	mode, get the foreground color after restoring the parameters from
	the last run.

2004-03-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_initialize):
	connect to notify::preview using g_signal_connect_object().
	Fixes bug #136850.

2004-03-10  Manish Singh  <yosh@picman.org>

	* data/misc/picman.applications.in: PICMAN_VISIBLE_NAME doesn't exist
	anymore. Just use "The PICMAN".

2004-03-10  Manish Singh  <yosh@picman.org>

	* acinclude.m4: #include <string.h> for picman-print test. Fixes
	#136747.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): redid last change so it
	calls tool_manager_cursor_update_active() *before*
	tool_manager_button_press_active(). Removes the ugly
	"force_cursor_updating" boolean again and adds even more ugly code
	duplication instead.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): added new local state
	"gboolean force_cursor_updating" which makes the function call
	tool_manger_cursor_update_active() even though a mouse button is
	pressed. Fixes tool cursors in click-to-focus mode.  Reported by
	Michael Schumacher.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_events): work around bug #136636 (Win32 only)
	and ask the current device for its modifier state in order to fill
	in the missing GDK_BUTTON*_MASK bits in GdkEventKey::state.

2004-03-10  Ville PÃ¤tsi  <drc@picman.org>

	* Makefile.am
	* configure.in: Removed picman.spec creation and distribution.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: disabled debugging
	output when pushing/popping the move too using <space>.

2004-03-10  Simon Budig  <simon@picman.org>

	* app/base/cpu-accel.c
	* app/display/picmandisplayshell-dnd.c
	* app/tools/picmanvectortool.c
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanvectors-import.c: Removed, disabled or
	conditionalized some debug output.

	There still is debug output when pushing/popping the move tool
	via space bar. Mitch wanted to look at that.

2004-03-10  Simon Budig  <simon@picman.org>

	* app/widgets/picmandnd.c: Disabled debug output and made it
	conditional with DEBUG_DND.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.h
	* libpicmanwidgets/picmanhelpui.c: fixed prototypes to match function
	definitions. Fixes bug #136343.

	* app/base/temp-buf.c (temp_buf_new): remove unused variable.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantool.c
	* app/tools/picmantransformtool.c: minor cleanup.

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c (tool_manager_image_dirty): don't
	reinitialize the tool when the image becomes dirty but just cancel
	it (fixes bug #131965). Also, only cancel the tool if the tool is
	operating on one of the dirtied image's displays (fixes bug #12253).

2004-03-10  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_object_popup.c: marked missing strings
	for localization (bug #136713).

	* plug-ins/imagemap/imap_stock.c (imap_stock_items): fixed bogus
	translation domain for stock item (bug #136713).

2004-03-10  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/edit.pdb (edit_cut, edit_copy): added boolean
	return value indicating whether the cut/copy was successful.
	Fixes bug #136489.

	* app/pdb/edit_cmds.c
	* libpicman/picmanedit_pdb.c: regenerated.

2004-03-10  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: added missing localization for
	popup menu (bug #136706).

2004-03-10  Michael Natterer  <mitch@picman.org>

	* app/gui/file-save-dialog.c (file_save_dialog_save_image): added
	boolean return value and don't hide the file dialog on success but
	return TRUE.

	(file_save_dialog_response)
	(file_save_overwrite_callback): hide the file dialog here instead.

2004-03-09  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c (picman_move_tool_button_press): redid my
	last layer_mask vs. layer move fix by reordering the whole
	function: now we first check if we can pick a path, guide or layer
	and bail out early if we can't; do the actual init_edit_selection()
	calls in a trivial unconditional switch() after that picking
	check. Removes code duplication and makes the whole function less
	nested and weird.

	Cleaned up the whole file a bit.

2004-03-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhelp.c (picman_help_internal): call
	procedural_db_destroy_args() with the correct nargs.

2004-03-09  Simon Budig  <simon@picman.org>

	* app/gui/preferences-dialog.c: Resurrect the "Save"-Button
	in the input-devices dialog, to avoid to confuse the users
	as described in bug #128588. This is not a proper fix though,
	since the input device configuration should be independant
	from the tool configuration. However, we can bump this bug
	to 2.2 now.

2004-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/general.c: fixed typo (bug #136610).

2004-03-09  Sven Neumann  <sven@picman.org>

	Finished some work that Brix started on the help system. It's
	now possibly to use an external web-browser for context help
	(bug #136081):

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/help/Makefile.am
	* plug-ins/help/domain.[ch]
	* plug-ins/help/help.c: new plug-in that does the help domain
	management. Most of this used to live in the helpbrowser plug-in.

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/domain.[ch]: removed these two files here.

	* plug-ins/helpbrowser/helpbrowser.c: changed accordingly.

	* app/widgets/picmanhelp.c: use the new help plug-in.
	
2004-03-08  Sven Neumann  <sven@picman.org>

	* app/gui/convert-dialog.c (indexed_palette_select_palette): added
	a message explaining that PICMAN cannot convert to a palette with
	more than 256 colors. Should actually not list palettes that don't
	match this criteria, but we'll leave that change for later (see
	bug #136574).

2004-03-08  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in.h: Use GPid with newer glib so that we work
	cleanly with the new API.

2004-03-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c: redone this change. We should
	probably add a PicmanMessageDialog to avoid duplicating this code
	every so often.

2004-03-08  Dave Neary  <bolsh@picman.org>

	* app/display/picmandisplayshell.c: First attempt to resolve bug 
	#107009. This changes the wording on the buttons to "Discard 
	changes" and "Cancel" when closing an insaved image. However I 
	think the absence of icons is a but ugly. I would like to add 
	respectively the icons from GTK_STOCK_DELETE and GTK_STOCK_CANCEL 
	to these two buttons.

2004-03-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c (run): added missing call to INIT_I18N()
	(spotted by Yuheng Xie, bug #136535).

2004-03-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/shadow_bevel.py: don't pass extra
	parameters to undo group functions. Fixes #136524.

2004-03-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c (run): added missing call to INIT_I18N()
	(spotted by iiccii@hotmail.com).

2004-03-07  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/edit.pdb (picman-edit-copy, picman-edit-cut)
	removed some comments that dated back to the time when these
	functions used to take image and drawable parameters.

	* app/pdb/edit_cmds.c
	* libpicman/picmanedit_pdb.c: regenerated.

2004-03-07  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c (picman_edit_extract): fixed bug added when
	factoring out picman_edit_extract(): check if tile_manager_crop()
	cropped away the whole TileManager before making a PicmanBuffer from
	it.

2004-03-07  Sven Neumann  <sven@picman.org>

	* picman.spec.in: removed references to static libraries. These
	are not any longer built by default.

2004-03-07  Sven Neumann  <sven@picman.org>

	* libpicman/picmanfontmenu.c (picman_font_select_widget_new): use
	PICMAN_STOCK_FONT instead of GTK_STOCK_SELECT_FONT.

2004-03-07  Sven Neumann  <sven@picman.org>

	Made size of undo previews configurable. Not dynamic for now, but
	at least not hardcoded any longer. Fixes bug #119905:
	
	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: added "undo-preview-size" property.

	* app/core/picmanundo.[ch]: use the new property instead of a
	hardcoded value.

	* app/widgets/picmanundoeditor.[ch]: added a "preview-size"
	construct property.

	* app/gui/dialogs-constructors.c: changed accordingly.

	* app/gui/preferences-dialog.c: added a widget to control the undo
	preview size.

2004-03-07  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: more cleanup.

2004-03-07  Sven Neumann  <sven@picman.org>

	* tools/Makefile.am (AM_CPPFLAGS): define PICMAN_APP_VERSION

	* tools/picman-remote.c: when starting a new picman, make sure the
	desktop-startup-id gets passed to it. Makes startup notification
	work correctly again.

2004-03-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c (run): corrected check for number of PDB
	parameters. Fxes bug #136403.

	* app/widgets/picmanfontview.c: removed unused variables.

2004-03-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanquerybox.c (query_box_disconnect): disconnect
	the response handler to avoid that the query_box callback is being
	called multiple times. Fixes bug #136371.

2004-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plasma.c (add_random): check random range before
	calling g_rand_int_range(). Fixes bug #136321.

2004-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/libpicmanoldpreview/picmanoldpreview.c: include
	stdplugins-intl.h so that "Preview" ends up in the plug-in
	translation domain (bug #136303).

2004-03-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c: compute the slider positions in the
	expose event handler so that the sliders get positioned correctly
	when the dialog is resized.

2004-03-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_random_seed_new): resurrected
	a mnemonic that was lost lately (1.88 -> 1.89) but still exists in
	most translations.

2004-03-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c: #include "widgets/picmanpropwidgets.h"

2004-03-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c: added buttons to toggle the
	histogram scale from the tool dialogs. Fixes bug #136227.

2004-03-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c (picman_move_tool_button_press): if we
	pick a layer to move and this layer has a mask which is being
	edited (active), start moving the mask, not the layer.

2004-03-04  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: marked new strings for translation.

	* libpicmanwidgets/picmanstock.h: added #defines for missing icons.
	This allows us to replace them later without changing the API.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs-menu.c
	* app/gui/gradient-editor-commands.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmantextoptions.c
	* app/widgets/picmanpaletteeditor.c: use the new stock icon names
	instead of abusing GTK+ and PICMAN tool stock icons.

	* app/gui/preferences-dialog.c (prefs_dialog_new): added icons
	to the new check buttons.

2004-03-04  Simon Budig  <simon@picman.org>

	* app/gui/preferences-dialog.c: remove the widgets for
	global-font and global-palette, since these are no options
	for multiple tools and have no visible effect for the user.

2004-03-04  Sven Neumann  <sven@picman.org>

	* autogen.sh: follow the changes done for other modules such as
	glib, pango and gtk+:

	- exit with $? instead of 1 in case of failure
	- exit with $? if ./configure failed
	- removed --enable-gtk-doc option
	- added $AUTOGEN_CONFIGURE_ARGS

	* HACKING: document the new behaviour.

2004-03-04  Michael Natterer  <mitch@picman.org>

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: added boolean properties
	"global-brush", "global-pattern" etc.

	* app/gui/preferences-dialog.c: added GUI for them to the
	"Tool Options" page.

	* app/tools/tool_manager.c (tool_manager_tool_changed): honor the
	new prefs options when copying the new tool's properties.
	Fixed bug #122519.

2004-03-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmantoolinfo.c: minor cleanup.

2004-03-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_init): eek, the
	separator crept back in while hacking PicmanFileDialog. Removed it
	again.

2004-03-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_message_box): set the
	window icon to the icon displayed in the message dialog.

2004-03-04  Simon Budig  <simon@picman.org>

	* plug-ins/common/animationplay.c: Display Frame numbers from
	1 to n instead of 0 to n-1. Less confusing for the user.

	Fixes bug #136124

2004-03-04  Sven Neumann  <sven@picman.org>

	* Made 2.0pre4 release.

2004-03-04  Simon Budig  <simon@picman.org>

	* app/widgets/picmanimagedock.[ch]: #ifdef'ed the code for
	the global shortcuts and disabled it.

	Fixes bug #133453

2004-03-03  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c (picman_vectors_import): better
	error reporting in case of a parser error.

2004-03-03  Simon Budig  <simon@picman.org>

	* app/xcf/xcf-load.c: make the path-loading debug output conditional.

2004-03-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_new_preview):
	let GdkPixbuf scale the thumbnail. It does a nicer job than
	temp_buf_scale().

2004-03-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.c (picman_colormap_editor_class_init):
	GDK_TYPE_MODIFIER_TYPE are flags, not enum values, use the
	right marshaller for the "selected" signal.

2004-03-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrendererimagefile.[ch]: moved the
	(disabled) ENABLE_FILE_SYSTEM_ICONS from the .c to the .h file and
	#ifdef the "gpointer file_system" member with it.

2004-03-03  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.c: fixed offset handling. Vectors
	objects always have 0,0 as offsets and image->width,
	image->height as their dimensions.

	Fixes bug #135994.

2004-03-03  Michael Natterer  <mitch@picman.org>

	* libpicmanthumb/picmanthumb-utils.[ch] (picman_thumb_file_test):
	return the "errno" of a failed stat() call.

	* libpicmanthumb/picmanthumbnail.[ch]: added member
	"image_not_found_errno" which contains the errno as returned by
	picman_thumb_file_test() if thumbnail->image_state is
	PICMAN_THUMB_STATE_NOT_FOUND.

	* app/core/picmanimagefile.c (picman_imagefile_get_desc_string): display
	the real error as specified by thumbnail->image_not_found_errno
	instead of just "Could not open".

2004-03-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpreviewrendererimagefile.[ch]: added new preview
	renderer class (has some disabled code from my GtkFileChooser tree
	and behaves exactly as the default implementation).

	* app/widgets/picmanpreviewrenderer-utils.c: use it for PicmanImagefiles.

2004-03-02  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: Disable PF_*ARRAY for now. Addresses
	#122049.

2004-03-02  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c
	* app/widgets/picmanlayertreeview.c: compress undo steps only
	if the redo stack is empty.

2004-03-02  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/bumpmap.c (bumpmap): Fix handling of positive Y
	displacements of the bumpmap. Thanks to Joao S.O. Bueno for
	tracking this. Fixes bug #135866.

2004-03-01  Manish Singh  <yosh@picman.org>

	* configure.in: define a picman_stable symbol based on the version
	number (to complement picman_unstable) and use it as a default for
	--enable-default-binary.

2004-03-01  Sven Neumann  <sven@picman.org>

	* app/config/test-config.c: added simple test for picman_config_diff().

2004-03-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.[ch] (picman_file_dialog_set_uri):
	new function which configures the dialog to load an image.

	* app/gui/file-open-dialog.c: use it. Don't use file-dialog-utils
	any more and allow setting the uri of an already visible file open
	dialog.

	* app/gui/file-dialog-utils.c: took the file open menu entries out
	of that insane logic that makes the menus insensitive while any
	file dialog is open.

2004-03-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.[ch] (picman_file_dialog_set_image): 
	new function which configures the dialog to save an image.

	* app/gui/file-save-dialog.c: use it.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: removed useless #inlcudes.

2004-03-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.[ch] (picman_file_dialog_new): added
	unused "GSList *file_procs" parameter.

	* app/gui/file-open-dialog.c: pass picman->load_procs.
	* app/gui/file-save-dialog.c: pass picman->save_procs.

2004-02-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmanblendoptions.c: changed the upper limit for the
	supersampling depth from 10 to 6 (as a workaround for bug #133266).

2004-02-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanunitmenu.c (picman_unit_menu_create_selection):
	no need to connect to "destroy", GTK_DIALOG_DESTROY_WITH_PARENT
	does this for us already.

2004-02-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmandialog.c: removed the call to
	gtk_widget_get_toplevel() again.
	Implement the GTK_DIALOG_DESTROY_WITH_PARENT behaviour in a way
	that works for PicmanDialog.

	* app/gui/resolution-calibrate-dialog.c: pass the toplevel window
	to picman_dialog_new ().
	
2004-02-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancellrendererviewable.c: some general cleanup.

	(picman_cell_renderer_viewable_set_property): ref the new renderer
	before unrefing the old one. Fixes potential crash when setting
	the same renderer again.

2004-02-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_apply_mask): when deleting the
	mask, use "Delete Layer Mask" instead of "Apply Layer Mask" as
	undo description.

2004-02-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmandialog.c (picman_dialog_new_valist): if the
	parent widget is not a GtkWindow, use gtk_widget_get_toplevel()
	to get a pointer to the window the widget lives in.

	* app/gui/resolution-calibrate-dialog.c: don't make the dialog
	modal. It was a bad idea to do that, leading to problems spotted
	by Pedro Gimeno (bug #135630).

2004-02-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanfileentry.c: removed useless #includes.

2004-02-27  Michael Natterer  <mitch@picman.org>

	* app/gui/file-dialog-utils.c
	* app/widgets/picmanfiledialog.c
	* libpicmanwidgets/picmanfileentry.[ch]: some irrelevant micro changes
	to make that patch smaller.

2004-02-27  Michael Natterer  <mitch@picman.org>

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: merged some small fixes/changes
	from my HEAD tree so the file chooser patch becomes smaller.

2004-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_save_thumb): peek the
	image to make sure that mtime and filesize are written correctly.

2004-02-27  Michael Natterer  <mitch@picman.org>

	* app/gui/file-open-dialog.c: removed the thumbnail box.

	* app/widgets/picmanfiledialog.c: and added it here.

2004-02-27  Michael Natterer  <mitch@picman.org>

	* app/gui/file-dialog-utils.[ch]: renamed parameters and removed
	useless #includes.

2004-02-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanfiledialog.[ch]: new widget swallowing most
	of file-dialog-utils.[ch]'s functionality.

	* app/widgets/widgets-types.h: added "gpointer callback_data" to
	PicmanItemFactorySetupFunc so the setup_funcs can create items in
	the same context as the item factory's default items.

	* app/widgets/picmanmenufactory.c (picman_menu_factory_menu_new):
	pass "callback_data" to setup_func().

	* app/gui/file-open-menu.[ch]
	* app/gui/file-save-menu.[ch]: use the passed callback_data
	when creating the menus and attach the file_proc to the
	menu items using g_object_set_data().

	* app/gui/file-commands.[ch]: merged separate file type callbacks
	for open and save dialogs into one callback which simply
	calls picman_file_dialog_set_file_proc().

	* app/gui/file-dialog-utils.[ch]: removed file_dialog_new()
	and file_dialog_set_proc().

	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]: use the new widget and removed
	global variables except the dialog pointer itself.

	* app/gui/image-menu.[ch]
	* app/gui/tool-options-menu.[ch]
	* app/gui/toolbox-menu.[ch]: changed accordingly.

2004-02-26  Sven Neumann  <sven@picman.org>

	* INSTALL: improved help on missing libraries at run-time.

2004-02-26  Michael Natterer  <mitch@picman.org>

	* app/gui/file-dialog-utils.[ch] (file_dialog_hide): changed
	return value from gboolean to void because the function is no
	longer used as "delete_event" callback.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: removed unused #includes.

2004-02-26  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c (file_open_image): added missing cast.

	* app/widgets/picmanerrorconsole.[ch]
	* app/widgets/picmantexteditor.[ch]: renamed members so my file
	chooser patch becomes smaller ;)

2004-02-26  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/file/file-open.c (file_open_image): Applied a fix by
	Michael Natterer addressing a problem with the preview in the
	open images list when loading a file.

2004-02-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.[ch]: renamed some members, cleanup.

2004-02-26  Sven Neumann  <sven@picman.org>

	* app/display/picmanprogress.c (picman_progress_end): check
	display->shell before using it. It might be NULL if the function
	is being called from picman_exit().

	* app/app_procs.c (app_exit_after_callback): added back the call
	to exit() but only for stable releases. See my comments in the
	code to understand the reasons.

2004-02-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanthumbbox.[ch]: new widget ripped out of the file
	open dialog.

	* app/gui/file-open-dialog.c: use it.

2004-02-26  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c: fixed my fixes.

2004-02-25  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_load_thumb): never
	return a failed pixbuf.

	(picman_thumbnail_save_failure) (picman_thumbnail_save_thumb): set the
	thumb_state when saving a thumbnail.

2004-02-25  Michael Natterer  <mitch@picman.org>

	Changed libpicmanthumb API in a way that will make GtkFileChooser
	integration possible without doing major hacks:

	* libpicmanthumb/picmanthumb-enums.h: added PicmanThumbFileType enum
	and extended PicmanThumbState enum.

	* libpicmanthumb/picmanthumb-utils.[ch]: return PicmanThumbFileType
	instead of gboolean from picman_thumb_file_test().

	* libpicmanthumb/picmanthumbnail.c
	* app/core/picmanimagefile.c: changed accordingly (the icons
	used for REMOTE, FOLDER and SPECIAL need to be changed).

2004-02-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanimagemaptool.c: cleanup.

	* app/tools/picmanlevelstool.c (picman_levels_tool_dialog): added 2px
	spacing between the pick buttons and their entries.

2004-02-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanimagemaptool.[ch]: moved "shell_desc" from
	PicmanImageMapTool to PicmanImageMapToolClass and added
	"load_dialog_title" and "save_dialog_title". Create the
	load/save buttons in picman_image_map_tool_initialize() and
	remember them in the PicmanImageMapTool struct. Moved the
	whole load/save button/dialog logic into private functions.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: changed accordingly, removed
	load/save callbacks, inlined the load/save functions into
	PicmanImageMapTool's virtual function implementations.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: changed accordingly.

2004-02-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.[ch]
	* app/tools/picmanlevelstool.h: removed obsoleted variables.

2004-02-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.[ch]
	* app/tools/picmanimagemapoptions.[ch]
	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmanlevelstool.[ch]: moved the settings file dialog
	that was duplicated in the curves and levels tools to the
	PicmanImageMapTool class. Store the last used filename in the
	PicmanImageMapOptions (proper fix for bug #135059).

2004-02-24  Dave Neary  <bolsh@picman.org>

	* app/tools/picmancurvestool.c: Revert to 1.2 behaviour of hiding
	rather than destroying the curves load/save dialog. This makes 
	the last selected curve be selected when the dialog is 
	re-opened, and fixes bug #135059.

	Also append G_DIR_SEPARATOR_S to the end of the filename we 
	build while creating the dialog, rather than ".".

2004-02-24  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanfileentry.[ch]: renamed member
	"file_selection" to "file_dialog" because the former refers to the
	currently used implementation, while the latter is neutral.

2004-02-23  Adam Weinberger  <adamw@FreeBSD.org>

	* configure.in: added "en_CA" (Canadian English) to ALL_LINGUAS.

2004-02-23  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added #defines for PicmanCoords' default
	pressure, tilt and wheel values.

	* app/display/picmandisplayshell-callbacks.c
	* app/paint/picmanpaintcore-stroke.c
	* app/text/picmantext-vectors.c
	* app/vectors/picmanvectors-compat.c
	* tools/pdbgen/pdb/paint_tools.pdb: use them. Fixes lots more
	buggy default values for tilt (in fact all of them were wrong).

	* app/pdb/paint_tools_cmds.c: regenerated.

2004-02-23  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-callbacks.c: corrected the
	value ranges and default values for GDK_AXIS_XTILT and
	GDK_AXIS_YTILT. Now the ink-tool behaves sane with a mouse
	again  :)

2004-02-23  Simon Budig  <simon@picman.org>

	* app/tools/picmaninktool-blob.c: don't access the array before
	checking if the index is within the valid bounds...

2004-02-23  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-snap.[ch]: return the snapped coordinates as
	gdouble, not gint because we must not round the unsnapped axis
	if only one axis snapped.

	* app/display/picmandisplayshell.[ch] (picman_display_shell_snap_coords):
	changed accordingly. Added boolean return value indicating "snapped".

	* app/display/picmandisplayshell-cursor.[ch]
	(picman_display_shell_update_cursor): take both display_x and _x and
	(possibly snapped) image_x and _y. Use the snapped values for the
	statusbar and the unsnapped ones for updating the info_window.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): applied modified patch
	from Simon Budig which moves guide/grid snapping out of the
	button_press/motion/button_release handlers and *always* snaps
	the image_coords if the active_tool wants them to be snapped.
	Makes sure that e.g. the brush preview is drawn at the right
	place and fixes bug #134284.

	Also pass both display_coords and image_coords to
	picman_display_shell_update_cursor().

2004-02-23  Simon Budig  <simon@picman.org>

	* app/core/picman.[ch]: removed unused member "standard_context"
	from the Picman struct.

2004-02-22  Sven Neumann  <sven@picman.org>

	Let all PicmanImageMap tools remember the state of the preview toggle
	(bug #135059):

	* app/tools/Makefile.am
	* app/tools/picmanimagemapoptions.[ch]
	* app/tools/tools-types.h: added new PicmanToolOptions class to hold
	the preview setting.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancoloroptions.[ch]
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmanposterizetool.c
	* app/tools/tools-types.h: use the new class.

2004-02-21  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanenummenu.c (picman_enum_stock_box_set_child_padding):
	Add GTK_MISC cast for bin->child.

2004-02-21  Simon Budig  <simon@picman.org>

	* app/tools/picmandrawtool.[ch]: added "use_offsets" parameter
	to picman_draw_tool_draw_boundary() for consistency.

	* app/tools/picmaneditselectiontool.c: Changed accordingly.

	* app/tools/picmanpainttool.c: when drawing straight lines draw
	the brush preview at the end of the line.

2004-02-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.[ch]: put the color bars into an event
	box and draw the sliders on the event box window.

	* app/widgets/picmancolorbar.[ch]: removed support for input events
	which is no longer needed. For consistency, renamed "channel"
	property to "histogram-channel".

	* app/widgets/picmanhistogrambox.c: changed accordingly.

	* app/widgets/picmanenummenu.[ch]: added new function
	picman_enum_stock_box_set_child_padding().

	* app/tools/picmancurvestool.c: let the graph widget expand with the
	dialog plus some other dialog tweaks.

	* app/widgets/picmanhistogrameditor.c: let the channel menu shrink
	as in the other dialogs.

	* libpicmanwidgets/picmancolorselect.c (picman_color_select_image_fill):
	allocate temporary buffer on the stack.

2004-02-20  Manish Singh  <yosh@picman.org>

	* plug-ins/common/pypicman/plug-ins/sphere.py: Moved to the Test menu,
	to clarify its station in life.

2004-02-20  Manish Singh  <yosh@picman.org>

	* plug-ins/common/pypicman/picmanfu.py: Do some simple validation on the
	GUI input. Arrays are still kinda hokey though. Based on Dave Neary's
	patch, addresses bug #122049.

	* plug-ins/common/pypicman/plug-ins/sphere.py: Make sure radius is at
	least 1. Thanks to Florian Traverse for noticing. (Also in #122049)

2004-02-20  Simon Budig  <simon@picman.org>

	* plug-ins/common/lic.c: fixed crash when the effect image
	is smaller than the target drawable. Major code overhaul (not
	yet fully completed), removed global variables, removed
	micro-functions that itself just invoke micro-functions, use
	more libpicmancolor functions.

	Slightly improved the algorithm by adding small random
	distorsions to the effect image. This avoids artefacts in plain
	areas.

2004-02-19  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancolorbar.[ch]: added new widget PicmanColorBar.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanhistogrambox.[ch]: use PicmanColorBar widgets.

	* app/widgets/picmancolorframe.[ch]: fixed typos.

2004-02-19  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-display-filter-16.png
	* themes/Default/images/stock-display-filter-24.png
	* libpicmanwidgets/picmanstock.[ch]: added Jimmac's glasses.

	* app/display/picmandisplayshell-filter-dialog.c
	* app/gui/image-menu.c: and use them.

2004-02-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandasheditor.[ch]: removed static variables, don't
	use PICMAN_CONFIG_INSTALL_PROP_FOO() for non-config classes,
	trailing whitespace, cleanup.

2004-02-19  Simon Budig  <simon@picman.org>

	* plug-ins/common/lic.c: fixed picman_dialog_new invocation.
	Also fixed a blatant error in the algorithm (PicmanRGB has a 
	range from 0..1 for each component...) and now the plugin
	actually does something useful.

2004-02-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c (picman_curves_tool_dialog): follow
	some of the levels tool dialog changes for consistency.

2004-02-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-qmask.c (picman_image_get_qmask): new function
	which returns the image's QMask.

	* app/core/picmanimage.c (picman_image_channel_name_changed)
	* app/gui/qmask-commands.c (qmask_query_response): use it.

2004-02-19  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added new signal "buffer_changed" and new
	function picman_set_global_buffer() which emits it when the global
	buffer changes.

	* app/core/picman-edit.c (picman_edit_extract): use it instead
	of fiddling with picman->global_buffer manually.

	* app/gui/image-menu.c: connect to "buffer_changed" and set the
	"Paste" menu entries sensitive. Fixes bug #134752.

	(image_menu_update): changed accordingly. Also changed a lot of
	buggy SET_SENSITIVE() lines which made menu items which work fine
	on any drawable insensitive when there were no layers (instead
	of no drawable).

	* app/gui/edit-commands.c: added new macro return_if_no_drawable()
	and use it instead of return_if_no_image() so we don't run
	into assertions if there is no active drawable.

	(cut,copy_named_buffer_callback): unfortunately had to introduce
	two new translated messages about not being able to cut/copy when
	there is no active drawable.

2004-02-19  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-serialize.c
	(picman_config_serialize_property)
	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_property): Reverted my last "cleanup" and
	put the "obsolete" check for the exact owner class of the property
	back. It appears that if a subclass does *not* implement
	PicmanConfigInterface *itself*, it still inherits
	serialize_property()/deserialize_property().

2004-02-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c: more dialog tweaking, fixed
	positioning of slider triangles.

2004-02-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c (picman_levels_tool_dialog): applied
	patch from Dave Neary that removes gray point pickers for
	individual channels (bug #125303). Let the levels widgets expand
	with the dialog.

2004-02-18  Simon Budig  <simon@picman.org>

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h: Added new GUI option: snapping distance

	* app/gui/preferences-dialog.c: add a preferences widget

	* app/tools/picmanmovetool.c
	* app/display/picmandisplayshell.c: use it for snapping.

2004-02-18  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell.c
	* app/tools/picmanmovetool.c: Adjusted snapping distance
	to 8 pixels, probably should be a preferences option.

	* app/tools/picmanpainttool.c: Do not center the start and end
	of a straight line to the center of an image-pixel unless
	the brush mode is PICMAN_BRUSH_HARD. Fixes bug #134410.

2004-02-18  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c
	* app/base/tile-private.h
	* app/base/tile.[ch]: removed trailing whitespace, added some
	newlines, let tile_is_valid() return a gboolean instead of a gint.

	* app/core/picmanimage-projection.c
	* app/core/picmanimage-undo-push.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmaninktool.c: use the return value from tile_is_valid()
	as a boolean.

2004-02-18  Sven Neumann  <sven@picman.org>

	* app/base/tile.h: exchanged TILEROWHINT_UNKNOWN and
	TILEROWHINT_BROKEN so that TILEROWHINT_UNKNOWN becomes 0. This
	allows to use calloc() to allocate and initialize the rowhint
	array.

	* app/base/tile.c (tile_sanitize_rowhints): reimplemented by a
	call to g_new0().

	* app/base/tile-manager.c (tile_manager_get): use g_memdup() to
	duplicate the rowhints when creating a tile copy.

2004-02-18  Michael Natterer  <mitch@picman.org>

	Some code review:

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c: removed obsolete code which
	made sure serialize_property()/deserialize_property() are only
	called for properties of the correct class. We do it the right way
	for quite a while now and clear the inherited function pointers in
	picman_config_iface_base_init().

	* app/config/picmanrc.c (picman_rc_dispose): don't forget to chain up.

	* app/base/picmanlut.c
	* app/base/lut-funcs.c
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-types.c
	* app/config/picmanrc.c
	* app/core/picman-modules.c
	* app/core/picmanbrush.c
	* app/core/picmancontainer.c
	* app/core/picmandocumentlist.c
	* app/core/picmanitem.c
	* app/gui/about-dialog.c
	* app/gui/color-notebook.c
	* app/gui/gui.c
	* app/gui/tips-dialog.c
	* app/paint/picmanpaintcore.c
	* app/paint-funcs/paint-funcs.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmanselectioneditor.c: removed I/O includes from
	files which don't use lowlevel APIs any more. Also removes
	a whole bunch of G_OS_WIN32 special casing. Removed trailing
	whitespace. Misc tiny cleanups.

2004-02-18  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_disconnect): disconnect from the correct
	config objects. Fixes bug #134694.

2004-02-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmaneditor.c (picman_editor_add_stock_box): cannot
	gtk_widget_destroy() a floating widget, sink it instead.

	* libpicmanwidgets/picmanpatheditor.c (picman_path_editor_set_path):
	plugged a small memleak.

2004-02-17  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/pagecurl/pagecurl.c: Corrected the pairing of
	picman_drawable_get/picman_drawable_detach and other cleanups.
	(do_curl_effect): Fixed a bug spotted by Simon Budig: uninitialized
	data could be exposed when applying the effect to non-rectangular
	selections.

2004-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.c (picman_viewable_calc_preview_size): argh,
	take the resolution into account if "dot_for_dot" is FALSE, not
	TRUE.

2004-02-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-scale.c (picman_image_scale_check): exclude the
	size of the undo stacks so that the memory size is comparable with
	the value displayed in the "New Image" dialog. Fixes bug #134512.

2004-02-17  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.[ch]: changed wm_name to app_name in
	the PicmanConfig struct; increased PICMAN_PROTOCOL_VERSION.

	* app/plug-in/plug-in-run.c (plug_in_run): pass the return value
	of g_get_application_name() to the plug-ins.

	* libpicman/picman.[ch]: removed function picman_wm_name(). Set the
	plug-in's application name if an app_name is passed in the config
	message.

	* libpicman/picmanui.c: removed usage of picman_wm_name(); it was wrong
	to do it this way and caused all plug-ins claim to be the picman-1.3
	executable in their error messages.

	* libpicman/picman.def: removed symbol picman_wm_name.

	* configure.in: reset picman_binary_age and picman_interface_age.

	* app/core/picmanimage.c (picman_image_name_changed): removed unused
	variable.

2004-02-17  Michael Natterer  <mitch@picman.org>

	Make sure each PicmanItem emits "removed" when it is removed from
	the image so dialogs have a chance to close themselves:

	* app/core/picmanlayer.c (picman_layer_apply_mask): emit "removed"
	from the mask.

	(picman_layer_removed): new function which emits "removed" from
	the layer's mask when the layer gets removed from the image.

	* app/core/picmanimage.c (picman_image_dispose): emit "removed"
	from all layers, channels and vectors.

	* app/gui/layers-commands.c (layers_scale_layer_query)
	(layers_resize_layer_query): removed recently added connections to
	"removed" because PicmanViewableDialog does this automatically.

2004-02-16  Michael Natterer  <mitch@picman.org>

	* libpicman/picmantile.[ch] (_picman_tile_cache_flush_drawable): new
	inernal function which removes all tiles from a given drawable
	from the cache.

	* libpicman/picmandrawable.c (picman_drawable_detach): call the new
	function before freeing the tiles. Fixes bug #134562.

2004-02-16  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanpixelrgn.c: cleaned up a bit: added missing
	g_return_if_fail()s, iterate lists using for() loops, indentation.

2004-02-16  Sven Neumann  <sven@picman.org>

	* libpicman/picmantile.c (picman_tile_cache_insert): partly rewritten.
	Instead of removing the list element from the hash table, freeing
	it, allocating a new one and inserting it again, simply move it to
	the end of the list without touching the hash table at all.

2004-02-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c (picman_xml_parser_parse_io_channel):
	set the GIOChannel encoding to NULL here instead of doing it in
	picman_xml_parser_parse_file().

2004-02-16  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c (gfig_response): set the Undo button
	insensitive, not the whole dialog (bug #134419). Also start the
	dialog with the Undo button set insensitive.

2004-02-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmancroptool.c (crop_info_create): use limits from
	libpicmanbase instead of arbitrary numbers. Don't allow a crop width
	or height smaller than 1 (or PICMAN_MIN_IMAGE_SIZE actually).

2004-02-16  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.c (picman_canvas_gc_new): fixed my last
	change here; of course only the guide GCs need a stipple pattern.

2004-02-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c (picman_xml_parser_parse_io_channel):
	unset the GIOChannel's encoding before trying to locate and parse
	the XML header.

2004-02-15  Michael Natterer  <mitch@picman.org>

	* libpicman/picmandrawable.c (picman_drawable_get): warn and return NULL
	instead of a meaningless struct for invalid drawable_IDs. Will
	make buggy plug-ins crash earlier and more reliably.

	Replaced all if(drawable) by g_return_if_fail(drawable != NULL)

	* libpicman/picmantile.c (picman_tile_ref): replaced if(tile)
	by g_return_if_fail(tile != NULL)

	(picman_tile_unref): g_return_if_fail(tile->ref_count > 0)

2004-02-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c: only call picman_ui_init() when being run
	in interactively. Should fix bug #134423.

2004-02-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmandata.c (picman_data_init): using
	FOO_GET_CLASS(instance) in a GInstanceInitFunc doesn't work
	because during instance init, the object's class is always set to
	be the class of the currently called init function. Use the second
	parameter of GInstanceInitFunc instead, which is the instance's
	real class. Fixes bug #134274.

2004-02-14  Michael Natterer  <mitch@picman.org>

	Fixed lots of QuickMask brokenness by letting the image adjust
	its qmask_state automatically:

	* app/core/picmanimage-qmask.h: #define PICMAN_IMAGE_QMASK_NAME "Qmask".
	Use the define in all files below.

	* app/core/picmanimage.[ch]: split picman_image_drawable_add,_remove()
	into separate handlers for layers and channels. Added a
	"name_changed" handler for all channels. In the channel "add",
	"remove" and "name_changed" handlers, check if it was a channel
	named "Qmask" that was added, removed or renamed and call
	picman_image_set_qmask_state() accordingly.

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanundo.c: removed all Qmask undo code because the image
	does the right thing without undo interaction now.

	* app/core/picmanimage-qmask.c (picman_image_set_qmask_state): set
	gimage->qmask_state early so we can return early when called
	recursively. Removed calls to picman_image_undo_push_image_qmask().
	Returned "removed" callback (it was utterly broken the way it was
	implemented).

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_qmask_toggled): check if the image's
	qmask state needs to be changed before changing it.

	* app/xcf/xcf-load.c (xcf_load_channel): removed code which
	recognized the qmask. PicmanImage does this automatically now.

	* app/gui/qmask-commands.c: cleanup.

	* app/widgets/picmanimagedock.c (picman_image_dock_constructor):
	destroy the "/Select/By Color" and "/Select/Toggle QuickMask" menu
	items.

	* app/widgets/image-menu.c (image_menu_update): changed accordingly.

2004-02-13  Manish Singh  <yosh@picman.org>

	* plug-ins/common/psd.c (load_image): Initialize dest to NULL,
	make it so the temp variable use for PANOTOOLS_FIX is only declared
	when it is enabled.

2004-02-13  Manish Singh  <yosh@picman.org>

	* app/base/temp-buf.c (temp_buf_get_memsize)
	* core/picmanviewable.c (picman_viewable_get_memsize): Add some casts
	to gsize for ints to prevent overflows.

	* app/base/tile-manager.c (tile_manager_get_memsize): Same as above,
	except cast to gint64.

2004-02-13  Simon Budig  <simon@picman.org>

	* app/core/picmanimage-guides.[ch]: make a similar fix as in my
	last commit for snapping the guides.
	
	* app/tools/picmanmovetool.c: use the fixed version.

2004-02-13  Simon Budig  <simon@picman.org>

	* app/core/picmanimage-snap.[ch]: make the snapping width a
	parameter of the snapping functions.

	* app/display/picmandisplayshell.c: make sure that the snapping
	width always is 5 pixels in the view coordinates.

	Fixes bug #134285

2004-02-13  Michael Natterer  <mitch@picman.org>

	* app/core/picman-units.c (picman_units_init, _exit): removed
	redundant g_return_if_fail()s.

2004-02-13  Michael Natterer  <mitch@picman.org>

	Fixed PicmanData's default "writable" and "deletable" behaviour:

	* app/core/picmandata.c (picman_data_init): default to writable and
	deletable == TRUE (something that has no filename was never loaded
	from disk and can't be undeletable or read-only).
	Fixes bug #134274.

	* app/core/picmandata.[ch]: added new function
	picman_data_make_internal() which frees the filename and sets the
	data's flags accordingly.

	* app/core/picman-gradients.c (picman_gradients_add_gradient)
	* app/core/picmanbrush.c (picman_brush_get_standard)
	* app/core/picmangradient.c (picman_gradient_get_standard)
	* app/core/picmanpalette.c (picman_palette_get_standard)
	* app/core/picmanpattern.c (picman_pattern_get_standard): use the
	new function for internal data objects.

	* app/core/picmandata.c (picman_data_save, picman_data_delete_from_disk)
	* app/core/picmandatafactory.c (picman_data_factory_save_single):
	bail out with g_return_if_fail() is the data is not writable
	or deletable.

	* app/widgets/picmandataeditor.c
	* app/widgets/picmandatafactoryview.c: changed accordingly.

2004-02-12  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.c (picman_canvas_gc_new): use
	GDK_CAP_NOT_LAST as the cap_style for all canvas drawing.

2004-02-12  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/psd.c:
	- Disable one of the PanoTools fixes by default, since it causes
          regressions in some ordinary PSD file loading.
	- Fix a twisted utf8-obsessive bug diagnosed by Piotr Krysiuk
	- Fix another one...
	- Fix from Daniel Rogers: PICMAN crashes on 0x0 layers, so we skip them.
	- Also try to avoid 0-sized drawables (including channels)

2004-02-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): call
	picman_image_colormap_changed() after installing the colormap.

	* app/tools/picmanhistogramoptions.h: fixed typedef of
	PicmanHistogramOptionsClass.

2004-02-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.c (picman_histogram_view_button_press):
	ignore double clicks so we don't grab the pointer away from the
	curves dialog. Fixes bug #132356.

	* app/tools/picmancurvestool.c (curves_graph_events): ignore button
	press and release events from all buttons except the first one.

2004-02-12  Michael Natterer  <mitch@picman.org>

	Make sure that non-indexed images never have a colormap.
	Fixes bug #121033.

	* app/core/picmanimage-colormap.c (picman_image_set_colormap): set
	image->cmap to NULL when called with a NULL colormap.

	* app/core/picmanimage-undo-push.c: made colormap undo/redo aware
	of NULL colormaps.

	* app/core/picmanimage-convert.c (picman_image_convert): remove the
	colormap using picman_image_set_colormap() instead of freeing it
	manually.

	* app/widgets/picmancolormapeditor.c: always check if the image
	is INDEXED *and* has a colormap before accessing the colormap.

	(need this new check because the fixed behaviour of colormap undo
	produces undo groups which, when being popped, make the image have
	no colormap while still being INDEXED in the small time frame
	between the emission of "colormap_changed" and "mode_changed").

2004-02-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: derive the text tool from PicmanTool
	directly. Doesn't look like we are going to use draw_tool
	functionality for 2.0.

2004-02-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-dnd.c
	(picman_display_shell_bucket_fill): when dropping a color on a text
	layer, change the text color. This is a quick hack; we should make
	filling a drawable a virtual method that can be overridden by the
	text layer.

2004-02-11  Sven Neumann  <sven@picman.org>

	* configure.in (PICMAN_DESKTOP_ICON): fixed icon names.

2004-02-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: repaired broken text tool logic
	(bug #124969).

2004-02-11  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init)
	* app/plug-in/plug-in.c (plug_in_close): changed g_warning() to
	g_printerr() in a few places where the problem is not an error in
	PICMAN but a misbehaving plug-in. Suppress some of this output in
	the stable branch.

2004-02-10  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c (prefs_dialog_new): removed "Default"
	prefix from "Navigation Preview Size" label again.

2004-02-10  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/preferences-dialog.c (prefs_dialog_new): prefix preview
	size labels with "Default" to avoid misunderstandings.

2004-02-10  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am (CORE_IMAGES): use the
	question stock icon instead of the warning one.

	* app/core/picmanviewable.c (picman_viewable_get_dummy_preview):
	return a question icon as dummy preview.

2004-02-10  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am: added a rule to create a
	header containing a warning pixbuf that we can use from the core.

	* app/base/temp-buf.c (temp_buf_new): rewritten an optimisation so
	that it works for any number of bytes per pixel.

2004-02-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added new function
	picman_viewable_get_dummy_preview() which currently returns a
	completely white and opaque TempBuf of the requested size.  Added
	this useless function because this is the place where to implement
	a nicer preview if someone volunteers.

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: use the new function if
	picman->config->layer_previews is FALSE instead of returning no
	preview at all. Fixes bug #112012.

	Cleaned up the preview functions a bit and raised
	the limit for drawable previews from 128x128 to 256x256.

	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmandrawable_pdb.c: regenerated.

2004-02-10  Sven Neumann  <sven@picman.org>

	* configure.in: warn when picmanprint is older than version 4.2.6.
	It's probably too late to introduce a dependency on that version
	but we would like people to update in order to avoid bug #125283.

2004-02-10  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorframe.c (picman_color_frame_init): make the
	value labels selectable as suggested by Mariano SuÃ¡rez-Alvarez in
	bug #133958.

2004-02-10  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 1.3.27 (interface_age 1,
	binary_age 1). Added PICMAN_DESKTOP_ICON variable and set it
	depending on PICMAN_UNSTABLE.

	* data/images/Makefile.am
	* data/images/wilber-devel-icon.png
	* data/images/wilber-icon.png: renamed the development icon and
	added one for the stable version.

	* data/misc/picman.desktop.in.in: use @PICMAN_DESKTOP_ICON@.

2004-02-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_register): set
	PICMAN_CONTEXT_FONT_MASK. Fixes bug #133067.

2004-02-09  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scripts/add-bevel.scm: Fixed Undo
	handling, make sure that the bumpmap is big enough to
	avoid artefacts.

	Fixes bug #130636.

2004-02-09  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_libs_init): added runtime check for
	fontconfig > 2.2.0 and abort with a dialog box telling the
	user to upgrade fontconfig if the requirement is not met.
	Fixes all bugs like #133818.

2004-02-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c: applied patch from Wolfgang Hofer
	that fixes bug #133244.

2004-02-09  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: some updates to the picman-console rules so that
	it fails less badly.

2004-02-09  Manish Singh  <yosh@picman.org>

	* app/file/Makefile.am
	* app/paint/Makefile.am
	* app/text/Makefile.am
	* app/xcf/Makefile.am: changed GTK_CFLAGS to GDK_PIXBUF_CFLAGS, since
	we don't use any gtk/gdk functions here. This especially helps in the
	text directory, since it avoids problems on broken setups with old
	fontconfig stuff in the X11 directory lying around.

2004-02-09  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/text-circle.scm: removed some workarounds
	for bugs in the PICMAN 1.2 text functions that don't exist any longer.

2004-02-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_layer) (undo_push_layer)
	* app/paint-funcs/paint-funcs.c (scale_region): ifdef'ed out debug
	output.

2004-02-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanitem.[ch]: added progress callback pointers to
	picman_item_scale() and its variants.

	* app/core/picmanchannel.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-scale.c
	* app/core/picmanlayer.c
	* app/core/picmanselection.c
	* app/gui/layers-commands.c
	* app/paint-funcs/paint-funcs.[ch]
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly. Fixes bug #97999.

	* app/pdb/layer_cmds.c: regenerated.

2004-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (picman_iscissors_tool_button_press): 
	don't activate the iscissors tool if it's already active
	(bug #132351).

2004-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_set_layer): implemented
	so that double-clicking a text layer now only activates the text
	tool but also set the layer's text on the tool options.

2004-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmantoolcontrol.c (picman_tool_control_activate)
	(picman_tool_control_halt): put overly picky sanity checks into
	#ifdef PICMAN_UNSTABLE ... #endif so we won't get these harmless
	tool warnings from the stable version (bug #121074).

2004-02-08  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/nova.c : access dest[alpha] only if (has_alpha);
	remove stray semicolon, fixes bug #132503	

2004-02-08  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-rc.c (plug_in_rc_parse): return FALSE if the
	file wasn't found.

	* app/plug-in/plug-ins.c (plug_ins_init): don't output the error
	message from plug_in_rc_parse() if it failed for file not found.

	Fixes bug #133490.
	
2004-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpickbutton.c: some code cleanup, no changes.

2004-02-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_rotate): fixed typo:
	s/spacified/specified/. Spotted by Kevin Cozens.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2004-02-08  DindinX  <david@dindinx.org>

	* plug-ins/common/tiff.c: applied a modified patch from Pablo
	d'Angelo, which add support for tiff layer names when the name is 7
	bits clean.

	Fixes bug #131044

2004-02-07  Manish Singh  <yosh@picman.org>

	* configure.in: fix use of EXEEXT in tiff checks. Fixes bug #133763.

2004-02-07  Hans Breuer  <hans@breuer.org>

	* picmandefs.msc : new file to keep common definitions for the msc build
	* **/makefile.msc : use common defintions, e.g. PICMAN_VER
	* Makefile.am : add the former to EXTRA_DIST

2004-02-07  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/core/picmanimage-convert.c (median_cut_pass2_no_dither_rgb):
	Corrected position for alpha_pix in the case of grayscale images
	with custom or mono palette and no dither. Fixes bug #133642.

	(median_cut_pass2_fixed_dither_rgb): Ditto for fixed dither
	(Positioned Color Dither).

2004-02-07  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-draw.c
	(picman_display_shell_draw_area): intersect the passed in area with
	the real area of the image in display coordinates and render the
	projection only if there actually is an intersection.
	Use picman_rectangle_intersect() instead of handmade CLAMP()
	constructs. Fixes bug #113142.

2004-02-07  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-shm.c (plug_in_shm_get_ID): don't
	g_return_if_fail() if picman->plug_in_shm is NULL; return -1 instead.
	This allows to run picman with --no-shm again.

2004-02-07  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: removed all drawing functions.
	The file was still too large.

	* app/display/Makefile.am
	* app/display/picmandisplayshell-draw.[ch]: new files containing
	the drawing functions.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/tools/picmanmovetool.c: changed #includes accordingly.

	* app/display/picmandisplay-handlers.c
	(picman_display_size_changed_handler): added some #if 0'ed code I'm
	not sure about. Actually, some of the handlers in this file could
	need the same code, so it could be abstracted as
	picman_display_stop_draw() or something. Please have a look.

2004-02-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorselect.c: let the color selector widget
	expand. Removes the ugly empty spaces and improves the color
	selection experience ;)

2004-02-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_mask_bounds):
	fixed integer/boolean confusion: s/0/FALSE/.

	(picman_display_shell_draw_cursor): draw the cursor only if
	shell->have_cursor is TRUE.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_expose): call the above unconditionally.

2004-02-05  Michael Natterer  <mitch@picman.org>

	Disallow editing of data objects which have no save functionality.
	Also fixed the misassumption that "deletable" is always equal to
	"writable". Fixes bug #133456.

	* app/core/picmandata.[ch]: added a "deletable" property which is
	always equal to "writable" except when the data class does not
	implement PicmanData::save() (then deletable may be TRUE but
	writable is always FALSE).

	* app/gui/brushes-menu.c
	* app/gui/gradients-menu.c
	* app/gui/palettes-menu.c
	* app/gui/patterns-menu.c
	* app/widgets/picmandatafactoryview.c: look at data->deletable when
	setting the sensitivity of the "Delete" buttons and menu items.

	* app/widgets/picmandatafactoryview.c
	(picman_data_factory_view_tree_name_edited): rename the data
	only if it's writable and restore the old name otherwise.

	* app/widgets/picmandataeditor.c: no need to look at data->internal
	for figuring if the data is editable, data->editable is enough.

	All files above: s/writeable/writable/g

	* app/widgets/picmanbrusheditor.c (picman_brush_editor_set_data):
	simplified.

2004-02-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/edit.pdb (edit_paste): don't call
	picman_edit_paste() with a NULL buffer. Instead, return an execution
	error if there is no global buffer to paste. Fixes the warning
	triggered by bug #133244 (but not the bug itself of course).

	* app/pdb/edit_cmds.c: regenerated.

2004-02-05  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.c (dialog): quit the main loop when
	the dialog is destroyed. Fixes bug #133532.

2004-02-05  DindinX  <david@dindinx.org>

	* plug-ins/script-fu/scripts/text-circle.scm: Fixes the layout of the
	rendered text.

	Fixes bug #131634

2004-02-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-crop.c: removed trailing whitespace.

	* app/gui/debug-commands.[ch]
	* app/gui/toolbox-menu.c: renamed ENABLE_DEBUG_ENTRIES to
	ENABLE_DEBUG_MENU and #define it to be equal to PICMAN_UNSTABLE.

2004-02-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectselecttool.c
	(picman_rect_select_tool_rect_select): don't try to CLAMP() the
	passed in rectangle to valid image/drawable coordinates manually
	when auto-shrinking the selection. Instead, use
	picman_rectangle_intersect(). Also honor the active drawable's
	offsets. Fixes bug #133467.

2004-02-05  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c (pypicman_param_from_tuple): Translate
	None to NULL when passing strings.

	* plug-ins/pypicman/picmanui.py: Pass None for brush, pattern, and
	gradient get_list so they work. Redo selection list to use a
	TreeView. Quickie solution for now, it could be much better.

2004-02-04  Manish Singh  <yosh@picman.org>

	* configure.in: Resurrected several autoconf substitutions relating
	to versions, so the .spec file can use them.

2004-02-05  RaphaÃ«l Quinet  <quinet@gamers.org>

	* configure.in: Added a conditional definition of the preprocessor
	symbol PICMAN_UNSTABLE if the autoconf symbol PICMAN_UNSTABLE is
	defined.

	* app/errors.c (picman_errors_init): Replaced the #if test on
	PICMAN_MINOR_VERSION modulo 2 by #ifdef PICMAN_UNSTABLE.

	* app/composite/picman-composite.c (picman_composite_init): Print the
	init messages only in unstable versions.  Split the messages in
	two lines and mention "supported by picman_composite" in order to
	give a hint that the availability of some features depends also on
	what code has been written.  Fixes bug #128825.

2004-02-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel.c
	* app/tools/picmantexttool.c
	* app/vectors/picmanvectors.c
	* app/widgets/picmanbufferview.c: removed double semicolons.

2004-02-04  Sven Neumann  <sven@picman.org>

	* app/Makefile.am (dist-hook): create an unversioned picmanrc manpage.

2004-02-04  Sven Neumann  <sven@picman.org>

	* Made 2.0pre3 release.

2004-02-04  Sven Neumann  <sven@picman.org>

	* docs/Makefile.am (EXTRA_DIST): removed redundant entries that
	became invalid when the change to unversioned files was made.

2004-02-04  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-render.c (struct RenderInfo)
	(render_image_accelerate_scaling): use gdouble instead of gfloat
	for x and y scale factors so gfloat's limited precision can't add
	up to off-by-one pixel errors. Fixes display artefacts (missing
	updates) at the bottom and right sides of updated areas at certain
	irrational zoom factors like 1:3.

2004-02-04  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_entries): added percentages to
	the View->Zoom menu entries as suggested in bug #131563.

2004-02-04  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.[ch]: added the new function
	picman_rc_set_unknown_token() to get autosave working for unknown
	picmanrc tokens.
	
	* app/config/picmanconfig.c: indentation.

	* tools/pdbgen/pdb/picmanrc.pdb: picman->edit_config was used for a
	good reason, it's the one that's saved. Reverted a change I did
	about a month ago. Use picman_rc_set_unknown_token() so unknown
	tokens get saved. This really fixes picman_picmanrc_set().

	* app/pdb/picmanrc_cmds.c: regenerated.

2004-02-03  Manish Singh  <yosh@picman.org>

	* configure.in: Allow generated files with versions.

	* picman-2.0.pc.in
	* picmanthumb-2.0.pc.in
	* picmanui-2.0.pc.in
	* docs/picman-1.3.1.in
	* docs/picman-remote-1.3.1.in
	* docs/picmanrc-1.3.5.in
	* docs/picmantool-2.0.1.in: renamed to unversioned files.

	I left picmantool-2.0.in alone since I didn't want to screw with
	other branches history. It'll be obsolete post-2.0 anyway.

2004-02-03  Manish Singh  <yosh@picman.org>

	* plug-ins/maze/maze_face.c (maze_dialog): remove unused variable
	randomize.

2004-02-03  Manish Singh  <yosh@picman.org>

	* picmantool-2.0.in: use PICMAN_API_VERSION.

2004-02-03  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_dialog): improved dialog layout.

2004-02-03  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_set_zoom): don't mark weird
	format strings as translatable.

	* data/misc/picman.desktop.in.in (_Name): use "The PICMAN" without an
	"(unstable)" suffix. Should give translators the chance to update
	their translations before the final 2.0 release.

	* configure.in: removed now unused PICMAN_VISIBLE_NAME variable.

2004-02-03  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): use g_clear_error()
	instead of g_error_free() and re-use the same GError location for
	pluginrc parsing and writing.

	(plug_ins_proc_def_insert): when overriding a PlugInProcDef, don't
	take over the menu_path and menu_accel of the overridden proc
	because (a) it's just plain wrong and (b) we don't need to
	preserve the proc_defs' order any more (see below).

2004-02-03  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc.[ch]: added new function
	plug_in_proc_def_compare_menu_path() which is a GCompareDataFunc.
	(uses g_utf8_collate() on the translated menu paths).

	* app/plug-in/plug-ins.c (plug_ins_init): sort picman->load_procs
	and picman->save_procs using the new compare function above.
	Fixes bug #133180.

	(plug_ins_locale_domain)
	(plug_ins_help_domain): don't g_return_if_fail() on a NULL
	prog_name but return the default locale and help domains
	of the PICMAN itself.

	(plug_ins_proc_def_insert): removed obsolete and broken (not
	locale and UTF-8 aware) code which tried to insert new plug-in
	menu entries in alphabetical order (was unused except for load
	and save procs).

	Unrelated:

	* app/plug-in/plug-in-proc.[ch]: added const qualifiers.

	* app/file/file-open.c
	* app/file/file-save.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly (constify
	local variables).

	* app/pdb/fileops_cmds.c: regenerated.

2004-02-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/*.scm: applied patch from Kevin
	Cozens <kcozens@interlog.com> which removes the use of deprecated
	constants in all scripts. Fixes bug #133270.

2004-02-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_free_script): 
	call picman_uninstall_temp_proc() with script->pdb_name, not
	script->script_name. Fixes bug #133280.

2004-02-02  DindinX  <david@dindinx.org>

	* app/display/picmancanvas.c: picman_canvas_draw_segments():
	  Do not call gdk_draw_segments() with more than 32000 segments at a
	  time, because XDrawSegments should never be called with more
	  segments than that. This should really be fixed at the gdk level,
	  though.

	This fixes bug #122026.

2004-02-02  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_save_thumb): use
	the UTF-encoded URI in error messages, not the filename.

	* app/Makefile.am: use $(EXEEXT) for dist-hook binary dependency.
	
	* tools/picman-remote.c: include <unistd.h> conditionally.

2004-02-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanimagedock.c (picman_image_dock_constructor):
	also destroy the <Image> factory's "Tools" submenu because menu
	shortcuts with no or <shift> modifier prevent this key to be
	entered in text entries. This really badly baldy cries for
	GTK+ 2.4's GtkActions...

2004-02-01  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-path.c (picman_config_path_expand_only):
	when calculating the length of the expanded path, add the length
	of the UTF-8 converted substitution, not its length in filesystem
	encoding. Finally enables PICMAN2_DIRECTORY containing non-ascii
	chars (at least on linux). Should fix bug #130118.

2004-02-01  Michael Natterer  <mitch@picman.org>

	Disallow to rename the layer mask. Instead, always name the mask
	"<layer name> mask". Fixes bug #133112 along with some other
	unreported ones.

	* app/core/picmanitem.[ch]: added a boolean return value indicating
	success to PicmanItem::rename().

	(picman_item_real_rename): push an undo step only if the item is
	attached.

	* app/core/picmanlayer.c (picman_layer_rename): refuse renaming if
	the layer is a floating selection floated from a channel
	(renaming a layer's floating selection makes a new layer out
	of the floating selection).

	(picman_layer_duplicate): use picman_layer_add_mask() to attach the
	mask's duplicate. Fixes mask refcount brokenness for duplicated
	layer masks.

	(picman_layer_name_changed): new function. Automatically renames the
	layer mask when the layer's name changes.

	* app/core/picmanlayermask.c (picman_layer_mask_rename): new function
	which refuses renaming.

	(picman_layer_mask_name_changed): skip the unique name voodoo
	PicmanItem does by not chaining up.

	(picman_layer_mask_set_layer): change the mask's name whenever it is
	attached to a layer.

	* app/text/picmantextlayer.c (picman_text_layer_rename): fiddle with
	text_layer->auto_rename only if renaming was successful.

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_name_edited):
	restore the old name if renaming failed.

	* tools/pdbgen/pdb/drawable.pdb (set_name): return an execution
	error if renaming failed.

	* app/pdb/drawable_cmds.c: regenerated.

2004-02-01  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_layer): no need to set the layer
	mask's offsets, picman_layer_add_mask() does this for us. Simplified
	mask property assignments.

2004-02-01  Michael Natterer  <mitch@picman.org>

	Reworked random seed handling once more:

	* libpicmanwidgets/picmanwidgets.c (picman_random_seed_new): make sure
	the displayed random seed value is always the one which will be
	used, whether "Randomize" is checked or not.

	* plug-ins/common/blur.c
	* plug-ins/common/plasma.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/maze.c: if running interactively, always take
	the seed value produced by the picman_random_seed widget and don't
	touch it because the widgets honors the "randomize" toggle
	correctly now.

	For noninteractive and last_vals runs, look at the "randomize"
	boolean and generate a seed if it is TRUE.

	Initialize the random number generators from the seed determined
	by either of the above ways and don't fiddle with it in the inner
	algorithms itself.

	* plug-ins/gflare/gflare.c (plugin_run): initialize the GRand
	from the seed unconditionally.

	(ed_make_page_sflare): no need to get the entry from the random
	seed widget to get its adjustment. Instead get the adjustment
	directly.

	(The random handling code of gflare looks somewhat broken, but
	that applies to the whole plug-in).

2004-02-01  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): when removing a
	duplicate PDB procedure, also remove it from picman->load_procs and
	picman->save_procs.  Fixes bug #133099.

	Some general cleanup like moving variables to local scopes.

2004-01-31  Manish Singh  <yosh@picman.org>

	* plug-ins/common/tiff.c (tiff_warning): use G_VA_COPY for copying
	va_lists.

2004-02-01  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-scale.c: initialize variable
	to avoid stupid compiler warning.

2004-02-01  Dave Neary  <bolsh@picman.org>

	* libpicmanwidgets/picmanwidgets.c
	* libpicmanwidgets/picmanwidgets.h: Modify random seed widget to 
	allow the user to specify that a seed should be chosen 
	randomly for them (useful to allow re-running random plug-ins 
	several times to get several different results).

	* plug-ins/common/blur.c
	* plug-ins/common/plasma.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c
	* plug-ins/gflare/gflare.c
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/maze.c
	* plug-ins/maze/maze.h
	* plug-ins/maze/maze_face.c: Changed appropriately.

	This fixes bug #129529.

2004-01-31  RaphaÃ«l Quinet  <quinet@gamers.org>

	* plug-ins/common/tiff.c (tiff_warning, tiff_error): Do not
	display the warning message about unknown tags for unregistered
	private tags (>= 32768).  Fixes bug #131975.  Do not display the
	error message about random access not supported for images using
	JPEG compression.  Fixes bug #132297.  It would be better to allow
	the user to customize which messages should be displayed or not,
	but this can be done in a future release.

2004-01-31  Michael Natterer  <mitch@picman.org>

	Use the global <Image> accel_group in all docks except the
	toolbox (the latter needs GTK+ 2.4's new menu features).
	Addresses bug #119878:

	* app/gui/buffers-commands.c
	* app/gui/channels-commands.c
	* app/gui/data-commands.c
	* app/gui/documents-commands.c
	* app/gui/drawable-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/gradients-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/plug-in-commands.c
	* app/gui/select-commands.c
	* app/gui/tool-options-commands.c
	* app/gui/tools-commands.c
	* app/gui/vectors-commands.c
	* app/gui/view-commands.c: changed the various return_if_no_foo()
	macros to also accept a PicmanDock as user_data.

	* app/gui/image-menu.c (image_menu_update): don't update the
	display related menu items if they don't exist (see below).

	* app/gui/gui.c (gui_display_changed): simplified.

	* app/widgets/picmanimagedock.[ch]: create an "<Image>" item_factory
	and attach its accel_group to the dock. Destroy all display
	related menu items. Destroy the layer stack navigation items
	because their default shortcuts interfere with tree and grid view
	keybindings. Connect to "image_changed" of the dock's private
	context and to "flush" of the image container to update the
	item_factory's state.

2004-01-31  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs.c: added some g_return_if_fail().

2004-01-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c (picman_dock_constructor): g_assert() that
	we got the essential construct properties.

2004-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-convert.[ch]: use gboolean instead of gint
	for "alpha_dither" and "remove_dups" in all public and private
	functions. Properly prototyped private functions. Minor cleanup.

	* app/gui/convert-dialog.c: pass FALSE instead of 0.

	* tools/pdbgen/pdb/convert.pdb: ditto. Also cleaned up a bit: use
	generated checks and documentation for enums, removed duplicate
	check for enum range (spotted by Kevin Cozens).

	* app/pdb/convert_cmds.c
	* libpicman/picmanconvert_pdb.c: regenerated.

2004-01-31  Manish Singh  <yosh@picman.org>

	* app/base/cpu-accel.c: Make the assembly PIC safe. Fixes #132999.

	* app/composite/Makefile.am
	* app/composite/picman-composite-3dnow.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse2.c: Disable code when compiling
	for PIC on ia32, since it'll barf things. These can be fixed later.

	* app/composite/picman-composite-3dnow-test.c
	* app/composite/picman-composite-mmx-installer.c
	* app/composite/picman-composite-mmx-test.c
	* app/composite/picman-composite-sse-installer.c
	* app/composite/picman-composite-sse-test.c
	* app/composite/picman-composite-sse2-installer.c
	* app/composite/picman-composite-sse2-test.c: Regenerated.

2004-01-31  Manish Singh  <yosh@picman.org>

	* configure.in: define ARCH_X86_64 globally.

	* app/base/cpu-accel.c: remove local definition.

2004-01-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantooloptionseditor.[ch]: added the scrolled
	window to the PicmanToolOptionsEditor struct.

	(picman_tool_options_editor_tool_changed): set the active tool's
	help ID on the scrolled window. Fixes bug #132969.

2004-01-30  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: map the Home button to
	"index.html" and removed the Index button for now.

2004-01-30  Michael Natterer  <mitch@picman.org>

	* plug-ins/rcm/rcm_dialog.c (rcm_dialog): fixed help ID.

	* plug-ins/rcm/rcm.[ch]
	* plug-ins/rcm/rcm_callback.[ch]
	* plug-ins/rcm/rcm_dialog.[ch]
	* plug-ins/rcm/rcm_gdk.[ch]
	* plug-ins/rcm/rcm_misc.[ch]: completely reindented, removed
	overly long /*---...---*/ comment lines, fixed spacing.

2004-01-30  Michael Schumacher <schumaml@cvs.gnome.org>

	* libpicmanwidgets/picmanwidgets.def: added missing symbols.
	* README.win32: Sven fixed the EXEEXT problem in
	plug-ins/common. Updated README.win32 accordingly.	

2004-01-29  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell.[ch]: Store the zoom factor as
	float, not as a ratio.

	* app/display/picmandisplayshell-scale.[ch]: change the API to
	expose the Float instead a weirdly encoded integer. Implement
	functions to get a ratio from the scale factor. Implement a set
	as presets as discussed on the mailinglist. Changed Zoom->Other
	dialog to enable entering a float.

	* app/display/picmandisplayshell-title.c
	* app/display/picmannavigationview.c
	* app/gui/image-menu.c
	* app/gui/info-window.c
	* app/tools/picmanmagnifytool.c: changed accordingly.

	* app/core/picman.[ch]
	* app/display/picmandisplay.[ch]
	* app/gui/gui-vtable.c
	* app/widgets/widgets-enums.h: Made the various display-creating
	functions accept a float for the scale. Introduce a new
	PicmanZoomType: PICMAN_ZOOM_TO. Generally adjust the API to use
	floats instead of weird integers.

	* app/core/picman-edit.c
	* app/core/picmantemplate.c
	* app/display/picmandisplayshell-callbacks.c
	* app/file/file-open.c
	* app/gui/image-commands.c
	* app/gui/view-commands.[ch]
	* tools/pdbgen/pdb/display.pdb
	* app/widgets/picmanimageview.c
	* app/widgets/picmantoolbox-dnd.c: changed accordingly

	* app/pdb/display_cmds.c: regenerated

	Fixes bug #131964 and makes bug #131563 easy to resolve.

2004-01-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.[ch]: removed the last artefact of context
	signal handling from 1.2:

	PicmanContext used to connect to e.g. the current brush's
	"invalidate_preview" and "name_changed" signals and emitted
	"brush_changed" when the callback was invoked. This was needed to
	make 1.2 work, but is conceptually broken with the real model <->
	view approach implemented in the current code.
	This change also optimizes things quite a bit because lots of
	signal emissions are saved.

	Added utility function which finds a container's current object
	after a freeze/thaw.

	* app/widgets/picmancontainerview.[ch]: added new virtual function
	PicmanContainerView::rename_item(). Connect to "name_changed" of the
	corrent container's children and invoke rename_item() accordingly.

	* app/widgets/picmancontainertreeview.[ch]: removed name_changed
	handler and implement PicmanContainerView::rename_item().

	* app/widgets/picmancontainergridview.c: ditto. the grid view was
	still relying on the removed PicmanContext behaviour for updating
	the label showing the sleected item's name.

2004-01-29  Michael Natterer  <mitch@picman.org>

	PicmanData code review:

	* app/core/picmandata.c (picman_data_init): default to
	writable = FALSE and dirty = TRUE.

	* app/core/picmanbrushgenerated.[ch]: added "const gchar *name" to
	picman_brush_generated_new().

	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: set all standard datas to clean and
	internal, check for g_path_is_absolute() in all load functions,
	pass the data's name as construct property to g_object_new()
	instead of calling picman_object_set_name() after creation, fixed
	some UTF-8 handling, spacing, indentation, coding style, general
	cleanup.

2004-01-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c
	* app/tools/picmaninkoptions.c
	* app/tools/picmanlevelstool.c: removed explicit grabs. The pointer
	is already implicitely grabbed while the button is pressed.

2004-01-29  Michael Natterer  <mitch@picman.org>

	* configure.in: reset binary age because of struct changes below.
	* m4macros/picman-2.0.m4: require PICMAN 1.3.26.

	* libpicmanmodule/picmanmodule.h
	* libpicmanmodule/picmanmoduledb.h
	* libpicmanthumb/picmanthumbnail.h
	* libpicmanwidgets/picmanbutton.h
	* libpicmanwidgets/picmanchainbutton.h
	* libpicmanwidgets/picmancolorarea.h
	* libpicmanwidgets/picmancolorbutton.h
	* libpicmanwidgets/picmancolordisplay.h
	* libpicmanwidgets/picmancolordisplaystack.h
	* libpicmanwidgets/picmancolornotebook.h
	* libpicmanwidgets/picmancolorscale.h
	* libpicmanwidgets/picmancolorselection.h
	* libpicmanwidgets/picmancolorselector.h
	* libpicmanwidgets/picmandialog.h
	* libpicmanwidgets/picmanfileentry.h
	* libpicmanwidgets/picmanmemsizeentry.h
	* libpicmanwidgets/picmanoffsetarea.h
	* libpicmanwidgets/picmanpickbutton.h
	* libpicmanwidgets/picmanpixmap.h
	* libpicmanwidgets/picmansizeentry.h
	* libpicmanwidgets/picmanunitmenu.h: added 4 function pointers padding
	to all class structures.

2004-01-28  Michael Natterer  <mitch@picman.org>

	Added infrastructure to make sure we don't write to the global
	brush, pattern etc. directories. Needed to make this configurable
	because we can't rely on the global directories being read-only,
	having certain names or being otherwise detectable at runtime in a
	sane way. Fixes bug #132214.

	* libpicmanbase/picmandatafiles.[ch]: added "const gchar *dirname" to
	the PicmanDataFileData struct so callbacks don't need to call
	g_path_get_dirname() for each file.

	* libpicmanwidgets/picmanfileentry.c: made it work with non UTF-8
	encoded filenames.

	* libpicmanwidgets/picmanpatheditor.[ch]: ditto. Added GUI and API for
	setting/getting a second "writable_path". The widget makes sure
	that the writable_path is always a subset of the path.

	* app/config/picmanconfig-utils.[ch]: added new function
	picman_config_build_writable_path().

	* app/config/picmancoreconfig.[ch]: added separate properties for
	the writable brush, pattern, gradient, palette and font paths.

	* app/config/picmanrc-blurbs.h: added (still empty) blurbs for the
	new properties.

	* app/core/picmandata.[ch] (picman_data_set_filename): added parameter
	"gboolean writable". Set data->writable to FALSE by default. If
	"writable" is passed as TRUE, still check if we can write to the
	file before setting data->writable to TRUE.

	(picman_data_create_filename): changed "data_path" parameter to
	"dest_dir" and assume dest_dir is writable.

	(picman_data_duplicate): set data->dirty to TRUE to make sure
	duplicated things will be saved.

	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: don't set the data's filename and don't
	touch data->dirty in the _load() functions because that's done by
	the data factory now. Don't touch data->dirty in the _duplicate()
	functions because that's done by picman_data_duplicate() itself now.

	* app/core/picmandatafactory.[ch] (picman_data_factory_new): added
	"writable_property_name" and remember it.
	Added utility function picman_data_factory_get_save_dir() which
	determines the directory to save new datas to.
	Added public function picman_data_factory_data_save_single() which
	saves a single data object.
	Make sure new things get saved to the first writable directory
	as specified in preferences.

	* app/core/picman.c (picman_real_initialize): pass the writable_paths'
	property names to picman_data_factory_new().

	* app/widgets/picmandataeditor.c (picman_data_editor_save_dirty): use
	picman_data_factory_data_save_single() instead of implementing
	saving here.

	* app/widgets/picmanpropwidgets.[ch] (picman_prop_path_editor_new):
	added "const gchar *writable_property_name" parameter (can be
	NULL).

	Added the needed callbacks to handle the writable_path and made
	the path_editor and file_entry code aware of non UTF-8 filename
	encodings. Some general cleanup.

	* app/gui/preferences-dialog.c: changed accordingly.

2004-01-28  Sven Neumann  <sven@picman.org>

	* configure.in: according to the automake docs, we need to add
	$(EXEEXT) explicitely for programs that are conditionally built
	using configure substitutions instead of automake conditionals.

2004-01-28  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-path.c (picman_config_path_expand): return
	early if picman_config_path_expand_only() fails.

2004-01-28  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/tiff.c: Removed duplicate TIFF entry from save 
	dialog, and made the save handler point to the one that doesn't 
	pre-multiply by alpha. Reported on picman-user by misfit-x. Also 
	changed default value to not destroy data on save.

2004-01-28  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/script-fu/scripts/grid-system.scm: Fix typo that prevented
	using the inverse of the golden ratio (1/g) as a weight in the list.

2004-01-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp-ids.h: updated help IDs for new/reordered
	pages in the prefs dialog.

	* app/gui/preferences-dialog.c (prefs_dialog_new): changed
	accordingly.

2004-01-28  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call): validate
	the types of the individual list members when passing parasites.
	Fixes #93806.

2004-01-27  Manish Singh  <yosh@picman.org>

	* app/paint-funcs/paint-funcs.c: inlined rotate_pointers, changed
	prototypes and casts around so that we're compliant with C99 aliasing
	rules.

2004-01-27  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-generic.c
	(picman_composite_overlay_any_any_any_generic)
	* app/paint-funcs/paint-funcs-generic.h (overlay_pixels): use more
	than one temporary when stacking INT_MULTs, to avoid undefined
	values.

2004-01-27  Manish Singh  <yosh@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_interpolate): Use a real
	PicmanVector2 for vector operations, instead of stuffing everything
	into a PicmanCoords. C99 aliasing fix.

2004-01-27  Manish Singh  <yosh@picman.org>

	* plug-ins/common/plugindetails.c: removed unused variable.

	* plug-ins/common/nlfilt.c: declare nlfiltRow as inline in the
	function definition as well.

2004-01-27  Manish Singh  <yosh@picman.org>

	* configure.in: use AM_PATH_PICMANPRINT to get some additional
	sanity checks.

	* acinclude.m4: define AM_PATH_PICMANPRINT here, so we don't have
	add a new autogen dependency.

	* plug-ins/print/Makefile.am: Use PICMANPRINT_{CFLAGS,LIBS}

2004-01-28  Simon Budig  <simon@picman.org>

	Argh, this is getting silly.

	* app/core/picmanscanconvert.c: Fix dumb bug I introduced
	while fixing bug #132036. Instead of always closing a
	polyline to the first point of the vpath close to the
	first point of the current polyline

	I'll close #132036 for the third time now, feel free to
	reopen it when bugs appear...

2004-01-27  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/tiff.c: Apply patch from Andrey Kiselev to 
	improve defaults when there is no photometric specified for 
	CCITT encoded tiffs. Closes bug #131902.

2004-01-27  Michael Natterer  <mitch@picman.org>

	* app/gui/layers-commands.c (layers_add_mask_query): use the
	new PICMAN_STOCK_LAYER_MASK icon for "Add Layer Mask" dialog.

2004-01-27  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-channel-indexed-16.png
	* themes/Default/images/stock-channel-indexed-24.png
	* themes/Default/images/stock-channel-indexed-32.png
	* themes/Default/images/stock-channel-indexed-48.png: replacing
	  placeholders
	
2004-01-27  Michael Natterer  <mitch@picman.org>

	Re-enabled filling the whole selection using the bucket fill
	tool. Fixes bug #132649.

	* app/tools/picmanbucketfilloptions.[ch]: added boolean property
	"fill-selection" and a GUI for it.

	* app/tools/picmanbucketfilltool.c: changed accordingly.

2004-01-27  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c (image_menu_entries)
	* app/gui/layers-menu.c (layers_menu_entries): use the new
	PICMAN_STOCK_LAYER_MASK icons for "Add Layer Mask".

2004-01-27  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-channel-indexed-16.png
	* themes/Default/images/stock-channel-indexed-24.png
	* themes/Default/images/stock-channel-indexed-32.png
	* themes/Default/images/stock-channel-indexed-48.png
	* libpicmanwidgets/picmanstock.[ch]: added placeholders for an INDEXED
	channel icon (copied from the GRAY channel icon). To be replaced...

	* app/widgets/picmanpreviewrendererimage.c: use
	PICMAN_STOCK_CHANNEL_INDEXED instead of PICMAN_STOCK_QUESTION for the
	indexed channel.

2004-01-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/comic-logo.scm: applied a patch from
	Pedro Gimeno to make the logo behave more like it used to in 1.2
	(bug #132493).

2004-01-27  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): added '%P' which expands to the
	PDB id of the active drawable. Moved local variables to local
	scopes where they are needed.

	* app/config/picmanconfig-dump.c: document it.

2004-01-27  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.c: some cleanup.

	(picman_display_shell_bucket_fill): don't use the bucket fill
	options but behave like "Edit -> Fill" and fill with NORMAL/100%.
	Fixes bug #132596.

2004-01-26  Manish Singh  <yosh@picman.org>

	* picman-zip.in: use new versioning defines.

2004-01-26  Manish Singh  <yosh@picman.org>

	* configure.in: add m4_defines for picman_unstable and picman_full_name,
	and define a PICMAN_VISIBLE_NAME based on that.

	* data/misc/Makefile.am
	* data/misc/picman.applications.in
	* data/misc/picman.keys.in: made these configured files, so they can 
	use PICMAN_APP_VERSION and PICMAN_VISIBLE_NAME.

	* data/misc/picman.desktop.in.in: use PICMAN_APP_VERSION and
	PICMAN_VISIBLE_NAME.

2004-01-27  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-layer-mask-32.png
	* themes/Default/images/stock-layer-mask-48.png: replaced the
	  placeholders

2004-01-27  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-layer-mask-16.png
	* themes/Default/images/stock-layer-mask-24.png
	* themes/Default/images/stock-layer-mask-32.png
	* themes/Default/images/stock-layer-mask-48.png
	* themes/Default/images/stock-selection-border-16.png
	* libpicmanwidgets/picmanstock.[ch]: added forgotten layer mask and
	new "border selection" icons from Jimmac (-32 and -48 ones to be
	updated, they are currently copies of the channel icons).

	* app/core/picmanlayermask.c (picman_layer_mask_class_init)
	* app/gui/image-menu.c (image_menu_entries): use them.

2004-01-27  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/picmanressionist/picmanressionist.[ch]
	* plug-ins/picmanressionist/paper.c
	* plug-ins/picmanressionist/presets.c: fixed a crash (bug #132027),
	got rid of some possible buffer overflows and fixed platform issues
	like hardcoding '/' as the path separator.

2004-01-26  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c (image_menu_entries): use
	PICMAN_STOCK_FLOATING_SELECTION for "Select->Float".

	(image_menu_update): set "Layer->Merge Down" insensitive for the
	bottom layer.

2004-01-26  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.c: use the modern libart way
	to uncross/rewind a libart SVP. This time really fixes
	bug #132036 (please test it though...).

2004-01-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: don't draw the
	outbounds selection when the selection is hidden (bug #132595).

2004-01-26  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-xlfd.c (picman_text_font_size_from_xlfd):
	account for the fact that XLFD stores point sizes in decipoints.

	* app/text/picmantext-vectors.c: s/TEXT_DEBUG/PICMAN_TEXT_DEBUG/

2004-01-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c
	* app/widgets/picmanhistogramview.c: use dark_gc instead of
	text_aa_gc to draw the histogram and curves grid lines. dark_gc is
	slightly lighter, looks better and fixes bug #132565.

2004-01-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: removed picman_image_owns_item() again.

	* app/core/picmanitem.[ch]: instead, added new virtual function
	PicmanItem::is_attached().

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanselection.c
	* app/vectors/picmanvectors.c: implement it.

	* app/core/picman-edit.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanlayer-floating-sel.c
	* app/text/picmantext-compat.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/transform_tools.pdb_ changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2004-01-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/unsharp-mask.scm: add the layer to
	the image before pasting to it. Fixes bug #132504.

	Fixed the underlying problem: make it impossible to attach
	floating selections to drawables which are not currently part of
	the image's layer or channel stacks.
	Also cleaned up image <-> floating_sel interaction:

	* app/core/picmanlayer-floating-sel.[ch] (floating_sel_attach):
	added assertion that the drawable is part of the image (see below).
	Don't call picman_image_floating_selection_changed(), it's emitted
	by picman_image_add_layer() now.

	(floating_sel_remove)
	(floating_sel_anchor): don't emit "floating_selection_changed",
	it's emitted by picman_image_remove_layer() now.

	(floating_sel_anchor): removed the fix for bug #132162 because
	picman_image_remove_layer() behaves correctly now (see below).

	Renamed floating_sel_reset() to floating_sel_activate_drawable().
	Added g_return_if_fail() all over the place.

	* app/core/picmanimage.[ch]: added new function picman_image_owns_item()
	which return TRUE if the passed item is part of the image.

	(picman_image_add_layer): emit "floating_selection_changed" here if
	needed.

	(picman_image_remove_layer): emit "floating_selection_changed" if
	needed, don't try to activate a layer if we called
	floating_sel_activate_drawable().
	This is the real fix for bug #132162.

	* app/core/picmanimage-undo-push.c (undo_pop_layer): apply the same
	fixes as to picman_image_add,remove_layer(). Don't call
	picman_drawable_invalidate_preview() on the previously active layer
	because that's done by picman_image_set_active_layer() now.

	* app/xcf/xcf-load.c: remember the "floating_sel_drawable" in the
	XcfInfo struct and attach it *after* all layers and channels are
	loaded to avoid attaching the floating selection to an
	out-of-image drawable.

	* app/core/picman-edit.c (picman_edit_paste)
	* app/core/picmandrawable-transform.c (picman_drawable_transform_affine,
	picman_drawable_transform_flip, picman_drawable_transform_rotate)
	* app/core/picmanselection.c (picman_selection_float)
	* app/text/picmantext-compat.c (text_render): added checks for
	picman_image_owns_item() in all functions which can produce
	floating selections.

	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: added checks for
	picman_item_owns_image() and return an execution error if invoked
	with a drawable which is not part of the image.

	* app/pdb/edit_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2004-01-26  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-save.c (xcf_save_channel): store the correct offset
	of the floating selection's drawable. This bug has been around
	since 1.2 (!!!) and made it impossible to save images correctly
	where the floating selection's drawable was a channel or layer
	mask.

2004-01-26  Sven Neumann  <sven@picman.org>

	* autogen.sh: prefer automake-1.7 over 1.8 since there are issues
	with the latter.

2004-01-26  Manish Singh  <yosh@picman.org>

	* app/core/picmandrawable-blend.c (gradient_fill_region): use memcpy
	instead of casted assignment for storing HSV values in rbd.fg/bg,
	for C99 aliasing compliance.

	* app/xcf/xcf-load.c (xcf_load_layer_mask): use a PicmanChannel *
	explictly for xcf_load_channel_props, for the above reason.

	* app/xcf/xcf-save.c (xcf_save_prop): use a temporary guint32 for
	saving property types, for the above reason.

	* app/core/picmanparasitelist.c (picman_parasite_list_deserialize): plug
	a memory leak, since data is copied on parasite creation.
	
2004-01-26  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: do nothing in _button_press when
	the tool is in the VECTORS_FINISHED state.
	Fixes bug #132508.

2004-01-25  Manish Singh  <yosh@picman.org>

	* plug-ins/common/postscript.c: use GSpawn instead of popen, -dBATCH,
	fixes #108659 for this plugin. Thanks to Peter Kirchgessner for the
	patch.

2004-01-25  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout.c (picman_text_layout_position): fixed
	text positioning for fonts where glyphs extend the logical
	rectangle (fixes bug #132495).

2004-01-25  Sven Neumann  <sven@picman.org>

	* app/gui/info-window.c (info_window_create): don't update the fields
	here...

	* app/gui/view-commands.c (view_info_window_cmd_callback): ... but
	here when the info window is connected to the display shell. Patch
	from Shlomi Fish; fixes bug #132329.

	* app/gui/info-window.c (info_window_update_extended): fixed update
	of info window in automatic mode. Bug #118084, patch by Shlomi Fish.

	* autogen.sh: check for automake-1.8 also.

	* HACKING: note that automake-1.8 should work as well.

2004-01-24  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/color.pdb (levels, curves): fiddle with the
	passed channel index only for GRAYA drawables, not for all GRAY
	drawables. Fixes bug #132322.

	* tools/pdbgen/pdb/color.pdb: regenerated.

	* app/tools/picmancurvestool.[ch]
	* app/tools/picmanlevelstool.[ch]: fixed the same bug here. It never
	occured because the "channel" field was accidentially initialized
	with the correct value and never changed after.

2004-01-23  Simon Budig  <simon@picman.org>

	* plug-ins/common/mosaic.c: properly use src_rgn.rowstride when
	initializing the target region. Fixes bug #132271.

2004-01-23  Manish Singh  <yosh@picman.org>

	* configure.in: made the pygtk minimum version an m4 define as well.

2004-01-23  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c
	* app/errors.c
	* app/main.c
	* app/config/picmanconfigwriter.c
	* app/core/picmandata.c
	* app/core/picmandatafactory.c
	* app/gui/user-install-dialog.c
	* app/plug-in/plug-ins.c
	* app/vectors/picmanvectors-import.c: some more picman_filename_to_utf8().

	* libpicman/picman.c
	* libpicmanmodule/picmanmodule.c
	* libpicmanmodule/picmanmoduledb.c: use it here, too, now that is in
	libpicmanbase.

2004-01-23  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/.cvsignore: s/ps/postscript/ to shut up cvs.

2004-01-22  Manish Singh  <yosh@picman.org>

	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am: renamed ps to postscript, so automake
	doesn't get confused.

2004-01-22  Sven Neumann  <sven@picman.org>

	* configure.in: libpicmanmodule depends on gmodule-2.0 and gobject-2.0.
	Incorporate both into GMODULE_CFLAGS and GMODULE_LIBS.

2004-01-22  Sven Neumann  <sven@picman.org>

	* debian/*: removed outdated and unmaintained debian package
	description. The debian package is well maintained without keeping
	these files in our CVS tree.

2004-01-22  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Added a depedency for libexif

2004-01-22  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gbr.c
	* plug-ins/common/pat.c: store the brush/pattern's name in a
	parasite attached to the image. The parasite overrides the
	RUN_WITH_LAST_VALS logic if it exists. Consistently set the
	description as the layer's name, but ignore the layer's name
	when saving because it may have been modified by exporting.
	Fixes bug #131450.

	Misc. cleanup/fixes: Don't assume that strncpy() nul-terminates
	the buffer, use sizeof() instead of magic numbers, sanitize
	descriptions using picman_any_to_utf8(), always use strncpy()
	instead of strcpy().

	* devel-docs/parasites.txt: document the "picman-brush-name" and
	"picman-pattern-name" parasites.

2004-01-22  Tor Lillqvist  <tml@iki.fi>

	* picmantool-win32.c.in (get_prefix): Use PICMAN_APP_VERSION.

2004-01-21  Manish Singh  <yosh@picman.org>

	* m4macros/picman-2.0.m4: quote AM_PATH_PICMAN_2_O properly so automake
	1.8 won't whine at us.

2004-01-21  Manish Singh  <yosh@picman.org>

	* configure.in
	* plug-ins/FractalExplorer/Makefile.am: renamed obnoxiously long
	fractalexplorer-examples directory to simply examples.

2004-01-21  Manish Singh  <yosh@picman.org>

	* configure.in: modernized, made a lot of things m4 macros, and made
	versioning a lot more finegrained, in anticipation for post-2.0.

	* autogen.sh: bumped up libtool and glib minimum requirements to match
	reality.

	* picman-2.0.pc.in
	* picmanthumb-2.0.pc.in
	* picmanui-2.0.pc.in: adapted to new versioning variables, and bring
	in RT_LIBS when needed.

	* */*/Makefile.am: adapted to new versioning variables.

2004-01-22  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.c (floating_sel_anchor):
	explicitly activate the drawable the floating selection was
	attached to (function was relying on implicit voodoo that
	happened 1.2). Fixes bug #132162.

2004-01-22  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added "gboolean use_default_values"
	to PicmanItem::stroke().

	* app/core/picmanselection.c: changed accordingly.

	* app/core/picmanchannel.c
	* app/vectors/picmanvectors.c: if use_default_values is TRUE, don't
	use the PicmanPaintOptions passed in the PicmanPaintInfo, but create a
	new one.

	* app/gui/stroke-dialog.c: pass FALSE so the values as set in the
	tool options are used.

	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paths.pdb: pass TRUE so tool options settings
	don't affect PDB stroke calls. Fixes part 2 of bug #132145.

	* app/pdb/edit_cmds.c
	* app/pdb/paths_cmds.c: regenerated.

2004-01-22  Simon Budig  <simon@picman.org>

	* app/gui/dialogs-commands.c: replaced the indexed palette in
	the default "Layers, Channels, Paths"-Dock (as created by the
	menu in the toolbox) with the Undo History, since the indexed
	palette is pretty useless most of the time and the new setup
	at least matches the upper half of the dockable that comes up
	after a new user starts the Picman the first time.

2004-01-21  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-commands.c: show the image menu in newly created
	layers, channels & paths docks.

2004-01-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]: added boolean return value to
	PicmanTool::initialize(). Returning FALSE means the tool could not
	be initialized and doesn't want to receive button events.
	Return TRUE from the default implementation.

	* app/tools/tool_manager.[ch]: added boolean return value to
	tool_manager_initialize_active(). Don't set the tool's display or
	drawable if initialize() returns FALSE.

	* app/display/picmandisplayshell-callbacks.c: don't send button
	events to the tool if initialize() returns FALSE.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: return FALSE for NULL and indexed
	drawables.

	* app/tools/picmanimagemaptool.c: always return TRUE because our
	subclasses already checked if the active drawable is OK.

	* app/tools/picmantransformtool.c: return FALSE for layers with
	masks. Fixes bug #132089. Some random cleanups.

2004-01-21  DindinX  <david@dindinx.org>

	* plug-ins/common/plugindetails.c: correctly resize both panels of the
	GTK_PANED. This fixes bugs #132032.

	This plug-ins still needs work.

2004-01-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c: use RINT() instead of ROUND()
	to calculate the coordinates of the transformed tiles to avoid
	off-by-one errors when affine-transforming, flipping and rotating
	drawables with negative offsets.
	Fixes the off-by-one part of bug #132089.

2004-01-21  Tor Lillqvist  <tml@iki.fi>

	* app/gui/themes.c (themes_list_themes_foreach): Fix undefined
	behaviour. Fixes crash in bringing up the Preferences dialog when
	compiled with Sun's compiler.

2004-01-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste): 
	call picman_drawable_invalidate_boundary() because the drawable's
	size may have changed. Fixes bug #132077. Removed call to
	floating_sel_invalidate() which is now redundant.

2004-01-21  Michael Natterer  <mitch@picman.org>

	* app/gui/info-dialog.[ch]: renamed info_dialog_popdown() to
	info_dialog_hide() and info_dialog_popup() to info_dialog_present().
	Added info_dialog_show() which just shows the dialog without
	calling gtk_window_present().

	* app/gui/info-window.c
	* app/gui/view-commands.c
	* app/tools/picmantransformtool.c: changed accordingly.

	* app/tools/picmancroptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: use info_dialog_show() so the dialog
	doesn't grab the focus away from the canvas. Fixes bug #132041.

2004-01-21  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.c: removed the call to
	art_vpath_perturb, since it apparently is responsible for the
	artefacts described in bug #132036. I don't really understand
	why these artefacts were happening in the first place, because
	in theory art_vpath_perturb should not do any harm.
	
	Also properly close closed polygons.

	Hopefully fixes #132036, please test this.

2004-01-20  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: added new command-line options --existing
	and --query. The former allows to get the old behaviour back and
	the latter might be useful one day.

	* docs/picman-remote-1.3.1.in: document the new options.

2004-01-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp-ids.h: added help IDs for the libpicman
	export and unit dialogs.

	* libpicman/picmanexport.c
	* libpicmanwidgets/picmanunitmenu.c: replaced html links by the new
	help IDs.

	* plug-ins/*/*.c: replaced all html help links by help IDs. A
	plug-in's help ID is its procedure name with '_' relaced by '-'.

	(e.g. file_tiff_save's help ID is file-tiff-save)

	Did some random indentation and whitespace cleanup.

2004-01-20  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: when starting a new picman, pass it the
	display picman-remote is running on.

2004-01-20  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: always open a new PICMAN instance when being
	called without any filenames/URLs. This makes it behave better when
	being used from application launchers such as the GNOME panel.

	* docs/picman-remote-1.3.1.in: document the new behaviour.

2004-01-20  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Changed library extension to actually use the correct
	values, and not assume .0.0. 

2004-01-20  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/help.pdb: changed "prog_name" parameter of
	picman_help() to "help_domain". It's useless to pass the plug-in's
	executable name to the core because the core already knows it.
	Instead, enabled accessing arbitrary help domains via the
	PDB. Passing NULL as help_domain will use the domain the plug-in
	registered, or the PICMAN main help domain if it didn't register a
	domain.

	* app/pdb/help_cmds.c
	* libpicman/picmanhelp_pdb.[ch]: regenerated.

	* libpicman/picmanui.c (picman_ui_help_func): pass NULL as help_domain.

2004-01-20  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: made --new the default behaviour and allow
	picman-remote to be called without any image filenames.

	* docs/picman-remote-1.3.1.in: changed accordingly.

	* data/misc/picman.applications 
	* data/misc/picman.desktop.in.in: removed --new option from
	picman-remote calls.

2004-01-20  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/mail.c
	* plug-ins/common/mng.c: use more already translated standard file
	error messages. Some cleanup.

2004-01-20  Michael Natterer  <mitch@picman.org>

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c
	* app/gui/image-menu.c
	* app/gui/menus.c
	* app/gui/plug-in-menus.c: when dynamically creating menu entries,
	pass static_entry == FALSE to picman_item_factory_create_item() so a
	*copy* of the the help_id is attached to the menu item.
	Fixes help for plug-in menu entries.

2004-01-20  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.[ch]: changed member
	"ProcRec *current_temp_proc" to "GList *temp_proc_recs", a stack
	of temporary procedures, just as the "temp_main_loops" member is
	supposed to be the stack of main loops for waiting for the
	temp_procs' return values.

	* app/plug-in/plug-in-run.c (plug_in_temp_run): changed accordingly.

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-run.c
	* libpicman/picman.c: added #define ENABLE_TEMP_RETURN 1.

	Enables return values for temporary procedures. On the libpicman
	side, this just enables the code which returns the values, on the
	app side it enables per-plug-in stacks of proc_recs and main_loops
	and a message handler for the GP_TEMP_PROC_RETURN message.
	A temp_proc's caller now blocks until the proc is finished.
	Fixes bug #50649.

	Left the #ifdefs there so it can be easily disabled if things
	break. Please play with Script-Fu and test this.

2004-01-19  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/ccanalyze.c (analyze): Call picman_drawable_detach()
	after picman_drawable_get() to plug a leak.

2004-01-19  Tor Lillqvist  <tml@iki.fi>

	* app/gui/about-dialog.c (decorate_text): Fix gccism.

2004-01-19  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 2.0pre3 (1.3.26),
	binary age 2, interface age 0.

	* libpicmanbase/picmansignal.h: removed unused definition of
	picman_signal_syscallrestart().

2004-01-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_create_layer): if there
	is a floating selection, anchor it before adding the text layer.
	Fixes bug #127451.

	Also fixed some issues with undo. Addresses, but does not fix
	bug #124969 and bug #130985.

2004-01-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/bz2.c
	* plug-ins/common/gz.c
	* plug-ins/common/hrz.c
	* plug-ins/common/pnm.c
	* plug-ins/sgi/sgi.c: marked some forgotten strings for
	translation and use translated standard file error messages (no
	new strings introduced), some indentation and cleanup.

2004-01-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/bmp/bmpread.c
	* plug-ins/common/gif.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/pcx.c
	* plug-ins/common/pix.c
	* plug-ins/common/pnm.c
	* plug-ins/common/sunras.c
	* plug-ins/common/xpm.c
	* plug-ins/xjt/xjt.c: some more picman_filename_to_utf8().

2004-01-19  Sven Neumann  <sven@picman.org>

	* Made 2.0pre2 release.

2004-01-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/bz2.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/dicom.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c
	* plug-ins/common/gih.c
	* plug-ins/common/gtm.c
	* plug-ins/common/gz.c
	* plug-ins/common/hrz.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/mail.c
	* plug-ins/common/pat.c
	* plug-ins/common/pcx.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/ps.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/sunras.c
	* plug-ins/common/svg.c
	* plug-ins/common/tga.c
	* plug-ins/common/tiff.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xpm.c
	* plug-ins/common/xwd.c
	* plug-ins/faxg3/faxg3.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/picmanressionist/ppmtool.c
	* plug-ins/helpbrowser/domain.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/sgi/sgi.c
	* plug-ins/xjt/xjt.c: use picman_filename_to_utf8() for filenames
	passed to g_message() and picman_progress_init(). Definitely missed
	lots of other places but it's a start...

2004-01-19  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.h: removed inclusion of <stdio.h> and
	"plug-in/plug-in-types.h".

2004-01-19  Sven Neumann  <sven@picman.org>

	* app/*/*.c: include "libpicmanbase/picmanbase.h" where needed; removed
	now unnecessary inclusions of "file/file-utils.h".

2004-01-19  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.[ch]: removed file_utils_filename_to_utf8() ...

	* libpicmanbase/picmanutils.[ch]: ... and added it here as
	picman_filename_to_utf8(). Added some docs that promise less than
	the current implementation holds so that we can change the
	implementation later.

	* app/*/*.c: use picman_filename_to_utf8() where
	file_utils_filenames_to_utf8() has been used before.

	* libpicmanbase/picmanbase.def: changed accordingly.

	* configure.in: reset PICMAN_INTERFACE_AGE.

2004-01-19  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/compose.c (compose)
	* plug-ins/common/decompose.c (decompose): fixed a lack of refresh
	in the layer previews by adding calls to picman_drawable_update()
	where appropriate. Removed redundant picman_drawable_flush() calls.

2004-01-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.[ch]: moved the first hint label
	to a line of its own. fixes bug #127673.

2004-01-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.[ch]: code cleanup; draw in the
	expose_event handler only.

2004-01-18  DindinX  <david@dindinx.org>

	* plug-ins/common/nova.c: fixed a stupid bug which could crashes with
	non square images. Done some cleanup also.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/gui/resize-dialog.c: when scaling an indexed image/layer,
	add a label telling the user that indexed layers are always scaled
	without interpolation. Can't simply make the option menu
	insensitive because channels and layer masks are still scaled with
	the chosen interpolation type. Fixes bug #131779.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaninktool.c (ink_set_paint_area): use
	picman_drawable_bytes_with_alpha().

2004-01-18  Dave Neary  <bolsh@picman.org>

	* NEWS: Updated again.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanstroke.c
	* app/xcf/xcf-load.c: use the PICMAN_TYPE_FOO macros instead of
	picman_foo_get_type(). Minor cleanups.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_add_layer,remove_layer): in the
	spirit of the fix for bug #131721 below, don't try to figure
	manually if "alpha_changed" needs to be emitted but simply compare
	the old and new values of picman_image_has_alpha().

	* app/gui/preferences-dialog.c (prefs_dialog_new): follow
	"foo-window-type" -> "foo-window-hint" change.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch] (picman_image_get_color): also return the
	color's alpha byte if it has alpha, not only the converted RGB
	values.  Return OPAQUE_OPACITY for drawables without alpha.
	Fixes bug #131706.

	* app/core/picmandrawable.c (picman_drawable_get_color_at)
	* app/core/picmanimage-contiguous-region.c
	(picman_image_contiguous_region_by_color)
	* app/core/picmanimage-projection.c (picman_image_projection_get_color_at)
	* app/core/picmanimagemap.c (picman_image_map_get_color_at)
	* app/paint/picmanclone.c (picman_clone_line_image): removed separate
	handling of the alpha byte from all users of picman_image_get_color().

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_get_paint_area): use
	picman_drawable_bytes_with_alpha().

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_set_active_layer): don't allow
	to select anything but the floating selection. Fixes bug #128025.

	(picman_image_set_active_layer,channel,vectors): allow to pass NULL
	to unselect the active item. Removed the silly feature that
	passing some random item of another image would select the first
	item in the list (was unused anyway).

	(picman_image_unset_active_channel): use picman_image_set_active_channel()
	now that it accepts NULL.

	(picman_image_add_layer,channel,vectors): cleaned up / simplified.

	(picman_image_remove_layer,channel,vectors): cleanup,
	simplification, use picman_image_set_active_layer,channel,vectors()
	now that they accept NULL, make sure the item next to the removed
	item becomes the active one (and not the first in the list, which
	was a severe usability problem in the dialogs).

	* app/core/picmanimage-undo-push.c (undo_pop_layer,channel): pass
	NULL to the set_active functions, cleanup.

	* app/core/picmanimage-duplicate.c: attach the floating selection
	before setting the active layer. Code relied on broken
	picman_image_set_active_layer() behaviour before.

	* app/core/picmanlayer-floating-sel.c: no need to set
	gimage->floating_sel before calling picman_image_add_layer(). The
	weird GUI mentioned in the comment existed in 1.2 only.

	* app/display/picmandisplayshell-layer-select.c (layer_select_advance):
	don't assume that setting the active_layer always succeeds.

	* tools/pdbgen/pdb/image.pdb: behave as the documentation says
	and return an execution error if setting the active layer or
	channel failed.

	Unrelated:

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb: removed leftover cruft from the old
	guchar based color API.

	* tools/pdbgen/pdb/channel.pdb: simplified code which handles the
	channel's color.

	* app/pdb/channel_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2004-01-18  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: fixed typo.

2004-01-18  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: make sure we always properly use
	the size of the logo image. Place the text at the bottom
	of the image when the size changes (position of the version
	string needs to be adjusted manually still...).

	* data/images/picman_logo.png: slightly tweaked.

	* data/images/picman1_0_logo.png: added for historical reasons.

2004-01-18  Sven Neumann  <sven@picman.org>

	* app/gui/file-open-dialog.c (file_open_create_thumbnail): redone
	to make it work again.

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_load_thumb): fixed
	stupid mistake that caused thumbnails not to load under certain
	circumstances.

2004-01-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_layer): removed broken
	code which tried to figure manually whether "alpha_changed" should
	be emitted. Instead, simply compare the return values of
	picman_image_has_alpha() before and after adding/removing the
	layer. Fixes bug #131721.

2004-01-17  Henrik Brix Andersen  <brix@picman.org>

	* app/core/picmanimage-snap.c (picman_image_snap_point): forgot to
	change two G_MAXINT to G_MAXDOUBLE.

2004-01-17  Henrik Brix Andersen  <brix@picman.org>

	Finally fixed bug #125864:

	* app/core/picmanimage-guides.c (picman_image_find_guide): iterate
	over the entire list of guides to determine the closest one.

	* app/core/picmanimage-snap.c: use gdoubles instead of gints for
	dist and mindist variables to make sure grid and guides with 1px
	spacings work as expected.

2004-01-17  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c: added more optional debug output
	and did some minor code cleanup.

2004-01-17  DindinX  <david@dindinx.org>

	* plug-ins/pypicman/picmanfu.py: Show the description of params in dialog
	boxes, rather than the internal variable name.  This is more
	consistent with script-fu.  (reported by Florian Traverse)

2004-01-16  Manish Singh  <yosh@picman.org>

	* plug-ins/common/plugindetails.c: some cleanup, restore old internal
	names.

2004-01-17  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/widgets/picmandock.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanwidgets-utils.[ch]
	* app/widgets/widgets-enums.[ch]: GTK+-2.4 will allow to request
	windows to be kept above. This change prepares the code so that we
	can optionally do this for docks and the toolbox as soon as we
	depend on GTK+-2.4 (see bug #131672).

2004-01-16  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/tiff.c: Apply a (modified) patch from Pablo 
	d'Angelo to enable saving of a non-premultiplied alpha channel
	and provide an UI to use it (a checkbox and extra PDB 
	procedure). Fixes bug #131030.

2004-01-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmancroptool.c (crop_recalc): do a proper fix for bug
	#131680.

2004-01-15  DindinX  <david@dindinx.org>

	* app/tools/picmancroptool.c: block some signals before destroying
	the info dialog box, to prevent accessing to freed memory fixes
	bug #131680

2004-01-16  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c (menus_init): fixed typo (bug #131670).

2004-01-16  Dave Neary  <bolsh@picman.org>

	* NEWS: Update NEWS file again.

2004-01-16  Michael Natterer  <mitch@picman.org>

	* app/gui/edit-commands.[ch]: converted tabs to spaces.

	(cut,copy_named_buffer_callback): unref the buffer after adding it
	to picman->named_buffers. Seems we leaked all named buffers...

	Removed code duplication I have just introduced:

	* app/gui/edit-commands.[ch] removed
	edit_paste_into_cmd_callback(). Instead, pass the "paste_into"
	boolean as "guint action" to picman_edit_paste_cmd_callback().

	* app/gui/image-menu.c: changed accordingly.

	* app/widgets/picmanbufferview.c: added utility function
	picman_buffer_view_paste() and call it from the paste and paste_into
	callbacks.

2004-01-15  Manish Singh  <yosh@picman.org>

	* app/text/picmanfontlist.c: Minor cleanup, add note about using
	pango_fc_font_description_from_pattern from pango 1.4 when we
	can.

2004-01-15  DindinX  <david@dindinx.org>

	* plug-ins/common/nova.c: Do not display the color button or the
	"Random Hue" range when applying to a grayscale image.

2004-01-15  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/gui/file-save-menu.c (file_save_menu_update): Removed the
	code that disables save formats conditionally, making all of
	them available. Fixes bug #110610.

2004-01-15  DindinX  <david@dindinx.org>

	* plug-ins/common/nova.c: Re-write some parts of the algorithm.
	This should fix #82464, #71922 and #121966.

2004-01-15  Manish Singh  <yosh@picman.org>

	* app/text/picmanfontlist.c: Set PangoStretch from FC_WIDTH. This
	partially addresses #131561 (namely, the picman side).

2004-01-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/helpbrowser.c: removed
	PICMAN_HELP_DEFAULT_DOMAIN #define...

	* plug-ins/helpbrowser/domain.h: ...and added it here.

	* plug-ins/helpbrowser/domain.c: fixed the fix for bug #128112:
	don't compare the help domain's base uri (which is variable) but
	the help domain's name (which is constant). Re-added removed
	information to the error message while keeping its user
	readability. Marked g_message() strings for translation.

2004-01-15  DindinX  <david@dindinx.org>

	* plug-ins/common/nova.c: Somewhat resurrected the SuperNova plugin.
	Still very buggy, though.

2004-01-15  Michael Natterer  <mitch@picman.org>

	Fixed bug #78732 (don't paste off screen):

	* app/display/picmandisplayshell-transform.[ch]: added new function
	picman_display_shell_untransform_viewport() which returns the
	visible rectangle of the image in image coordinates.

	* app/core/picman-edit.[ch] (picman_edit_paste): added viewport
	parameters and changed positioning of the pasted layer as follows:

	- if there is a selection, center on the selection (just as before).
	- if there is no viewport, center on the active drawable.
	- if the viewport intersects with the active drawable, center
	  on the intersection.
	- if the viewport does *not* intersect with the active drawable,
	  center on the active drawable (off-screen, but better than pasting
	  something that will be invisible due to floating selection clipping).
	- if there is no active drawable, center on the viewport.
	- if there is no active drawable and no viewport, center on the image.

	* app/widgets/picmanbufferview.c (picman_buffer_view_paste_clicked)
	(picman_buffer_view_paste_into_clicked)
	* app/display/picmandisplayshell-dnd.c (picman_display_shell_drop_buffer)
	* app/gui/edit-commands.c (edit_paste_cmd_callback)
	(edit_paste_into_cmd_callback): ask the shell for the viewport
	and pass it to picman_edit_paste().

	* app/display/picmandisplayshell-dnd.c
	(picman_display_shell_drop_drawable): center the created layer on
	the viewport.

	* app/tools/picmanmovetool.c (picman_move_tool_button_release): use
	picman_display_shell_untransform_viewport() (its code was taken from
	here).

	* tools/pdbgen/pdb/edit.pdb: pass "no viewport" to picman_edit_paste().

	* app/pdb/edit_cmds.c: regenerated.

2004-01-15  Dave Neary  <bolsh@picman.org>

	* NEWS: Now that we're in pre-release mode, list all the bugs fixed 
	in this release, rather than features added. Commits which don't fix 
	bugs are listed in the "Other contributions" section. Bugs were added 
	in chronological order according to when the fix was committed (so 
	the first bug in the list was the one committed soonest after the 
	2.0pre1 release).

2004-01-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: moved initialization of the
	gimage->visible[] and gimage->active[] arrays from
	picman_image_new() to picman_image_init(). Use picman_rgba_set()
	to initialize gimage->qmask_color.

2004-01-15  Dave Neary  <bolsh@picman.org>

	* plug-ins/helpbrowser/domain.c: Modify error messages shown when 
	help files cannot be opened. For the main PICMAN help domain, the 
	error message is now "Failed to open help files:\nThePICMAN help files 
	are not installed." and in the general case "Failed to open help 
	files:\nThe requested help file %s could not be opened.\nPlease check 
	your installation." This fixes bug #128112.

2004-01-15  Sven Neumann  <sven@picman.org>

	* data/misc/Makefile.am: added a "validate" rule that attempts to
	validate the generated picman.desktop file using desktop-file-validate
	(from desktop-file-utils). Run it on 'make dist'.

	* tips/Makefile.am: for consistency, moved the existing validation
	code to a rule called "validate".

2004-01-14  Manish Singh  <yosh@picman.org>

	* app/config/picmanconfig-utils.c: #include "file/file-utils.h" for
	file_utils_filename_to_utf8.

2004-01-15  DindinX  <david@dindinx.org>

	* plug-ins/common/plugindetails.c: clean up the code (use
	picman_table_attach_aligned() where needed).

	* plug-ins/dbbrowser/dbbrowser.c:
	* plug-ins/dbbrowser/dbbrowser_utils.c: changed tabs to spaces.

2004-01-14  Dave Neary  <bolsh@picman.org>

	* app/core/picmanimage.c: get the type of the drawable, not the 
	image, when transforming a TempBuf, making dragging & dropping 
	patterns on layer masks work correctly. Fixes bug #131146.

2004-01-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.h: added PICMAN_IMAGE_TYPE_WITHOUT_ALPHA()
	macro as counterpart to PICMAN_IMAGE_TYPE_WITH_ALPHA().

	* app/core/picmandrawable.[ch]: added
	picman_drawable_type_without_alpha() and
	picman_drawable_bytes_without_alpha() convenience functions.

2004-01-14  Michael Natterer  <mitch@picman.org>

	Some code review:

	* app/core/picmanimage.c: named the gint paramater in all
	colormap_changed related functions to "color_index", fixed typo in
	parasite undo description, moved some variables to local scopes,
	changed the layer raise/lower functions to look like the channel
	and vector ones, cosmetics.

	* app/core/picmanimage-colorhash.c: removed trailing whitespace,
	initialize / reset more stuff to 0, cosmetics.

2004-01-14  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: fix typo in the uninstall-local target for
	picman-console.

2004-01-14  DindinX  <david@dindinx.org>

	* plug-ins/common/plugindetails.c: callbacks attached to the "changed"
	signal for of GtkTreeSelection should return void.
	Small cosmetics fixes also.

2004-01-14  Tor Lillqvist  <tml@iki.fi>

	* app/file/file-utils.[ch]: Add new function
	file_utils_filename_to_utf8(), which is to be used when converting
	file names (which are kept in the on-disk encoding) to UTF-8 for
	passing to GTK, or to g_print() etc.

	* app/*/*.c: Call file_utils_filename_to_utf8(). Should fix most
	of the warnings generated by non-UTF8 pathnames. See #130118.

	* libpicmanbase/picmanenv.c: Document that picman_directory() etc return
	strings in the on-disk encoding.

	* libpicmanmodule/picmanmodule.c: Convert filenames to UTF-8 (using
	g_filename_to_utf8()) before passing to g_print().

2004-01-14  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: Fixed small refresh issue.

2004-01-14  Simon Budig  <simon@picman.org>

	* data/images/picman_logo.png: New image for the about dialog by
	Jakub Steiner.

	* app/gui/about-dialog.c: Adjusted to new image. Also could not
	resist to add a fancy effect...

	* data/images/picman1_2_logo.png: Saved the image from 1.2.

2004-01-13  Michael Natterer  <mitch@picman.org>

	Allow invoking the text tool by double clicking a text layer in
	the layers dialog, just like the path tool is invoked when double
	clicking a path.

	* app/tools/picmantexttool.[ch]: added empty
	picman_text_tool_set_layer() stub. Sven, your turn...

	* app/gui/layers-commands.[ch]: added layers_text_tool() which
	invokes the text tool on text layers and falls back to
	layers_edit_layer_query() otherwise.
	Added layers_text_tool_cmd_callback() for the layers menu.

	* app/gui/layers-menu.c: added "Text Tool" menu item and hide
	it for layers which are no text layers.

	* app/gui/dialogs-constructors.c (dialogs_layer_list_view_new):
	use layers_text_tool() as "activate" function.

2004-01-13  Michael Natterer  <mitch@picman.org>

	* app/composite/Makefile.am (AM_CPPFLAGS): G_LOG_DOMAIN should be
	"Picman-Composite", not "Picman-Composition".

	* app/app_procs.c (app_run): register a log handler for the
	"Picman-Composite" domain.

2004-01-13  Michael Natterer  <mitch@picman.org>

	* app/base/base-enums.h: removed PicmanChannelLutType enum and
	export PicmanHistogramChannel to the PDB. The removed enum was just
	there for libpicman compatibility.

	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: added compat cruft.

	* app/pdb/color_cmds.c
	* libpicman/picmancolor_pdb.[ch]
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2004-01-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmancompat.h: fixed definition of picman_use_xshm().

2004-01-13  Michael Natterer  <mitch@picman.org>

	* app/base/picmanhistogram.c: added PicmanHistogramChannel index
	fiddling hacks for GRAYA images to all picman_histogram_get_*()
	functions. The public API now does what their enum values pretend
	to do.

	(picman_histogram_calculate): restructured to reduce indentation depth.

	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanhistogramview.c
	* tools/pdbgen/pdb/color.pdb: removed hacks here and always use
	the unchanged enum values.

	* app/pdb/color_cmds.c: regenerated.

2004-01-13  Michael Natterer  <mitch@picman.org>

	* app/base/picmanhistogram.[ch]: renamed picman_histogram_nchannels()
	to picman_histogram_n_channels().

	* app/core/picmandrawable-histogram.c: removed silly double negation
	logic. Cleanup.

	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanhistogramview.c: adjust the PicmanHistogramChannel
	for GRAYA images to make sure we pick alpha from the right slot.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: removed the same hack here and call
	picman_histogram_view_set_channel() with the correct enum value.

	* tools/pdbgen/pdb/color.pdb (levels, curves, histogram): fiddle
	with enum values here too so GRAY* drawables produce the correct
	results.

	Fixed precondition checks and set "success" in a uniform way all
	over the place.

	Use picman_drawable_calculate_histogram() instead of duplicating its
	code here.

	(started with a patch from Pedro Gimeno. Fixes bug #109078)

	* app/pdb/color_cmds.c: regenerated.

2004-01-12  Michael Natterer  <mitch@picman.org>

	* app/base/picmanhistogram.c (picman_histogram_calculate_sub_region):
	advance the source pointer by 4, not 3 bytes for regions with
	4 bytes (ouch). Cosmetics.

2004-01-12  DindinX  <david@dindinx.org>

	* libpicman/picmanmisc.[ch]: remove these files

	* libpicman/picmanpixelfetcher.c:
	* libpicman/picmanpixelfetcher.h:
	* libpicman/picmanregioniterator.c:
	* libpicman/picmanregioniterator.h: and created these ones.
	  Regarding #125141, picmanmisc was split into picmanpixelfetcher and
	  picmanregioniterator.

	* libpicman/Makefile.am:
	* libpicman/picman.h: modified accordingly.

2004-01-12  Sven Neumann  <sven@picman.org>

	* data/misc/picman.desktop.in.in (Exec): use 'picman-remote-1.3 --new'
	here so that drops on the application icon don't necessarily spawn
	a new instance.

2004-01-12  Michael Natterer  <mitch@picman.org>

	Enabled/fixed moving of channels and layer masks (was something
	between disabled and broken before).

	* app/tools/picmaneditselectiontool.h (enum EditType): added new
	values EDIT_CHANNEL_TRANSLATE and EDIT_LAYER_MASK_TRANSLATE.

	* app/tools/picmanmovetool.c (picman_move_tool_button_press): look at
	the type of the active drawable and invoke PicmanEditSelectionTool
	accordingly.

	(picman_move_tool_cursor_update): don't show the "bad" cursor when
	the active drawable is a channel or layer mask.

	* app/tools/picmaneditselectiontool.c: changed/enabled moving of
	channels and layer masks to work similar to selection mask moving:

	- Show only the item's outline while moving and do the actual move
	  on button_release.
	- Fixed/generalized some code to cope with the fact that we move
	  the linked layers/vectors *while* moving but the moved channel
	  itself *after* moving.
	- Draw the channel's/mask's bounding box instead of its boundary
	  if the boundary is empty (if all its values are either below or
	  above HALF_WAY).

2004-01-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c: converted tabs to spaces, cosmetics.

2004-01-12  Sven Neumann  <sven@picman.org>

	* app/main.c (picman_show_help): changed "compat" to "compatibility".

2004-01-12  Sven Neumann  <sven@picman.org>

	* app/gui/plug-in-menus.c (plug_in_menus_init): only call
	bind_textdomain_codeset() when it is available. Spotted by
	Reinhard Geisler (bug #131215).

2004-01-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-projection.c (picman_image_invalidate): applied
	patch from Pedro Gimeno that makes sure we always invalidate
	complete tiles, not parts of it. Fixes bug #116765.

	* app/display/picmandisplay.c (picman_display_paint_area): calculate
	the image area to invalidate using sub-pixel precision and
	ceil()/floor() the resulting area to make sure we always
	invalidate a superset of the dirty area, not a subset. A rounding
	error here has never been reported but would cause effects similar
	to #116765.

2004-01-12  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmenu.c (picman_image_menu_new): call the callback with
	the selected image which is not necessarily the requested one
	(fixes bug #92586).
	Also changed all menu constructors to always call the registered
	callback even when the value is -1 because the menu is empty.

	* app/gui/plug-in-commands.c (plug_in_run_cmd_callback): run the
	procedure even if there's no active PICMAN display. The display and
	screen is then taken from the current cursor position.

	* app/gui/gui-vtable.c (gui_get_display_name): don't call
	picman_display_get_by_ID() unless gdisp_ID is > 0.

2004-01-12  Manish Singh  <yosh@picman.org>

	* configure.in: we need at least pygtk 1.99.15 for pypicman. Enforce
	this.

2004-01-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CML_explorer.c (parse_line_to_gdouble): use
	g_ascii_strtod() instead of the locale-dependant atof().

2004-01-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CML_explorer.c: render a grayscale preview when
	the plug-in is run on a grayscale drawable (fixes bug #82465).

2004-01-12  Sven Neumann  <sven@picman.org>

	* picmantool-2.0.in: build the version number just like it is done
	for the pkg-config files.

2004-01-11  Manish Singh  <yosh@picman.org>

	* app/widgets/gtkwrapbox.c: Fix wrapped property.

2004-01-11  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmansignal.h
	* plug-ins/gfig/gfig-preview.c: removed remaining EMX ifdefs spotted
	by David Odin.

2004-01-11  DindinX  <david@dindinx.org>

	* plug-ins/common/plugindetails.c: converted GtkCList and GTKCTree to
	GtkTreeModels/Views.  Fixed some memory leaks while I was at it.
	Please note that this is a work in progress. This plug-in was very
	broken, and still needs some work to be useful and less ugly.

2004-01-11  Tor Lillqvist  <tml@iki.fi>

	* app/config/picmanconfig-path.c: Convert to native encoding (if
	requested) only after expanding completely. (Mentioned in #130118,
	patch by Sven.)

	* app/base/tile-swap.c
	* app/pdb/image_cmds.c
	* app/plug-in/plug-in.c
	* libpicman/picman.c
	* libpicmanbase/picmandatafiles.c
	* libpicmanbase/picmanenv.c
	* libpicmanmodule/picmanmoduledb.c
	* plug-ins/common/bz2.c
	* plug-ins/common/gz.c
	* plug-ins/common/mail.c
	* plug-ins/common/ps.c
	* plug-ins/common/url.c
	* plug-ins/gfig/gfig-preview.c
	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/print/print.c
	* plug-ins/script-fu/script-fu-scripts.c
	* tools/pdbgen/pdb/image.pdb: Remove __EMX__ ifdefs. EMX port is
	unmaintained, presumed dead. (#131109)

2004-01-11  Dov Grobgeld  <dov@imagic.weizmann.ac.il>

	* plug-ins/common/CEL.c: fixed bug in registration
	of supported file types for writing and enabled use of 
	export functionality for the unsupported formats (gray
	level).

2004-01-11  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/core/picmandrawable-preview.c (picman_drawable_preview_scale):
	Apply threshold to alpha in the same way as it is applied to the
	image in indexed mode. Fixes bug #115793, at least until the
	alpha thresholds in indexed images are removed.

	* plug-ins/FractalExplorer/Display.c: Fix zoom undo handling
	issues. Closes bug #82478.

2004-01-11  Dave Neary  <bolsh@picman.org>

	* etc/templaterc: Remove unusual "1200x900" template.

2004-01-11  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-scale.c: ensure that
	"fit image to window" really always fits, despite the
	resulting fractions are not as nice compared to the
	fractions from zoom in/out.

2004-01-11  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/fileops.pdb
	* app/pdb/fileops_cmds.c: Make it build.

2004-01-11  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-scale.c: further tweaks.
	now excluding fractions where numerator*denominator > 200
	(only when both are > 1).
	This is a simple heuristic to exclude some absurd looking
	fractions.

	Also ensure that 1/ratio results in b:a, when ratio results
	in a:b.

	IMHO fixes bug #124073.

2004-01-11  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.[ch] (picman_imagefile_update): removed the
	size parameter and do nothing but invalidating the preview.

	* app/gui/file-open-dialog.c
	* app/widgets/picmandocumentview.c: changed accordingly.

	* app/core/picmandocumentlist.c (picman_document_list_deserialize):
	no need for calling picman_imagefile_update() from here.

	* tools/pdbgen/pdb/fileops.pdb
	* app/pdb/fileops_cmds.c (file_load_thumbnail): rewritten using the
	PicmanThumbnail API.

	* app/core/picman.c: cosmetics.

2004-01-11  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-scale.c: calculate the
	fraction from the zoom ratio using continued fractions.
	This prefers smaller numbers in numerator/denominator.

	Adresses bug #124073, but does not completely fix it,
	since scaling up/down does not always result in the same
	ratios.

2004-01-10  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Changed epoch to 2.

2004-01-10  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_zoom_fraction): use G_SQRT2 instead of
	the golden ratio (see bug #124073).

2004-01-10  Michael Natterer  <mitch@picman.org>

	* app/gui/layers-commands.c (layers_alpha_to_selection_cmd_callback):
	no need to check if the layer has an alpha channel because
	picman_channel_select_alpha() handles layers without alpha fine: it
	selects everything that is opaque, which is the entire layer.

	* app/gui/image-menu.c (image_menu_update)
	* app/gui/layers-menu.c (layers_menu_update): don't make the
	"Alpha to Selection" items insensitive for layers without alpha.

2004-01-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/select-to-pattern.scm: changed
	(mostly rewritten) to correctly create patterns from drawables
	with or without alpha. Also work correctly with or without a
	currently active selection. Fixes bug #131088.

2004-01-09  Sven Neumann  <sven@picman.org>

	* app/gui/tips-dialog.c (tips_dialog_create): don't free the
	filename too early.

2004-01-09  Dave Neary  <bolsh@picman.org>

	* app/display/picmandisplayshell-scale.c: Modify behaviour of 
	the magnify tool to always change the zoom factor by the 
	golden ratio, rather than modify the numerator and denominator
	directly. Fixes bug #124073.

2004-01-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c (load_image): applied a patch from 
	Pablo d'Angelo that fixes layer offsets for multipage TIFF files
	(bug #131016).

2004-01-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/add-bevel.scm: fix typo:
	picman-editbucket-fill -> picman-edit-bucket-fill

2004-01-09  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanenv.c: coding style fixes and minor cleanup.

2004-01-09  Tor Lillqvist  <tml@iki.fi>

	* plug-ins/winsnap/Makefile.am (winsnap-win32res.o): Don't try to
	use the no longer included build/win32/compile-resource
	script. Instead, run windres directly.

2004-01-09  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.25, interface_age 1,
	binary age 1.

	* Makefile.am
	* picman-2.0.pc.in
	* picmanthumb-2.0.pc.in
	* picmanui-2.0.pc.in: renamed the pkg-config files.

	* picmantool-2.0.in
	* docs/Makefile.am
	* docs/picmantool-2.0.1.in: renamed picmantool and it's manpage.

	* picman.spec.in
	* m4macros/picman-2.0.m4: changed accordingly.

2004-01-08  RaphaÃ«l Quinet  <quinet@gamers.org>

	* plug-ins/common/jpeg.c: applied a (slightly modified) patch from
	keith@goatman.me.uk, fixing a problem with the save dialog for
	grayscale images and a small rounding error in the JPEG quality
	level.  Fixes bug #130912.

2004-01-08  Henrik Brix Andersen  <brix@picman.org>

	* app/config/picmandisplayconfig.c: added %D* to
	DEFAULT_IMAGE_TITLE_FORMAT.

	Fixes part of bug #120424 - the patch for including a long dirty
	indicator (%B) should be applied for picman-2.2.

2004-01-08  Michael Natterer  <mitch@picman.org>

	* app/gui/user-install-dialog.c: removed explicit newlines from
	all multi-line texts except where neccessary to do paragraph
	breaks. Instead, configure the resp. GtkLabels to do automatic
	line wrapping. Tweaked layout slightly to look better with long
	one-line strings. Fixes bug #130916 and prevents similar bugs to
	occur in the future.

2004-01-08  Dave Neary  <bolsh@picman.org>

	* etc/templaterc: Add some templates for screen sizes, as i
	suggested in bug #130869.

2004-01-08  Michael Natterer  <mitch@picman.org>

	* app/gui/layers-menu.c
	* app/gui/patterns-menu.c
	* app/gui/tool-options-menu.c
	* plug-ins/script-fu/scripts/asc2img.scm: added the last missing
	menu mnemonics. Sorry for the string change but it's IMHO better
	to un-fuzzy these 14 strings now than to carry them around during
	the whole 2.0.x cycle. Finally fixes bug #106991.

	* plug-ins/script-fu/scripts/asc2img.scm: changed "ASCII to Image
	Layer" to "ASCII to Layer". We never use the term "Image Layer".

2004-01-08  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/fileops.pdb: Add notes about menu path requirements
	for Load/Save handlers.

	* plug-ins/common/png.c: Document the behavior here too.

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c: Robustify against NULL menu_path.

	* app/pdb/fileops_cmds.c
	* libpicman/picmanfileops_pdb.c: Regenerated.

2004-01-08  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/png.c (query): only expose
	file_png_save_defaults() in the GUI.

	Fixes bug #130866.

2004-01-08  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/preferences-dialog.c (prefs_dialog_new): moved Default
	Image Grid to top level since it also applies to newly loaded
	images without a grid.

2004-01-07  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/psd.c
	* app/vectors/picmanvectors-import.c
	* tools/pdbgen/pdb/gradients.pdb: removed more double semi-colons.

	* app/pdb/gradients_cmds.c: regenerated.

2004-01-07  Manish Singh  <yosh@picman.org>

	* configure.in: AC_SUBST the EXIF vars, to workaround automake 1.6
	brokenness.

2004-01-07  Simon Budig  <simon@picman.org>

	* app/base/curves.c: copy the positions of the control points
	for a smooth curve into the lookup table, after the points
	inbetween have been interpolated. This ensures that the
	positions of the control points always get respected.

	Fixes bug #35335.

2004-01-07  Henrik Brix Andersen  <brix@picman.org>

	* app/core/picmanimage-contiguous-region.c
	(find_contiguous_segment): applied a patch from Adrian Bunk
	<bunk@fs.tum.de> which fixes a double ;; typo (bug #130828).

2004-01-07  Sven Neumann  <sven@picman.org>

	* picman-1.3.pc.in
	* picmanui-1.3.pc.in: don't use $VERSION because pkg-config and the
	like don't like the 2.0pre version numbers. Instead create a
	parseable version number from major, minor and micro version.
	
	* m4macros/picman-2.0.m4: check for 1.3.24 or newer.

2004-01-07  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumb.def: fixed wrong function name.

2004-01-07  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/script-fu/scripts/beveled-pattern-heading.scm
	* plug-ins/script-fu/scripts/image-structure.scm
	* plug-ins/script-fu/scripts/beveled-pattern-bullet.scm
	* plug-ins/script-fu/scripts/beveled-pattern-hrule.scm
	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/add-bevel.scm
	* plug-ins/script-fu/scripts/line-nova.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/chip-away.scm
	* plug-ins/script-fu/scripts/sphere.scm
	* plug-ins/script-fu/scripts/hsv-graph.scm
	* plug-ins/script-fu/scripts/beveled-pattern-arrow.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/test-sphere.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/beveled-pattern-button.scm:
	s/picman-bucket-fill/picman-edit-bucket-fill/ + whitespace clean-up.

2004-01-07  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb: removed redundant "success = TRUE"
	assignments which simplifies the generated code quite a bit.
	(most of the changed functions always succeed and don't need a
	"success" variable at all)

	* app/pdb/picmanrc_cmds.c: regenerated.

2004-01-07  Sven Neumann  <sven@picman.org>

	* Made 2.0pre1 release.

2004-01-07  Sven Neumann  <sven@picman.org>

	* configure.in: set PICMAN_VERSION to 2.0pre1.

	* HACKING
	* INSTALL
	* NEWS
	* README: updated and changed accordingly.

	* app/widgets/Makefile.am (libappwidgets_a_sources): fixed typo.

2004-01-07  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: Changed the string that is intended
	to be translated to the translators names, to be the same as
	in Gnome. Sorry for the string change.

2004-01-06  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def
	* libpicmanthumb/picmanthumb.def: updated. Patch from Michael Schumacher.

2004-01-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-scale.c (picman_image_scale_check): fixed inline
	docs.

2004-01-06  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/pypicman/plug-ins/sphere.py (python_sphere): use
	picman_edit_bucket_fill() and picman_edit_blend() instead of
	deprecated functions.

2004-01-06  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.[ch]: added new function
	picman_thumbnail_set_from_thumb() which will be useful when writing
	a thumbnail manager based on libpicmanthumb.

2004-01-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: invalidate the description string
	before emitting "info_changed".
	(picman_imagefile_save_thumb): use the enum value's name. not it's
	nick.

2004-01-06  Michael Natterer  <mitch@picman.org>

	Enabled skipping enum values for either the PDB or GType
	registration (don't always skip both targets):

	* tools/picman-mkenums: skip enum values only if there is a literal
	"skip" (don't match "pdb-skip").

	* tools/pdbgen/enumgen.pl: skip only "pdb-skip" values, not "skip"
	ones.

	* app/base/base-enums.h
	* app/core/core-enums.h
	* app/paint/paint-enums.h
	* libpicmanbase/picmanbaseenums.h: use the right "pdb-skip"/"skip"
	combination to skip enum values. Changed comments accordingly.

	Cleaned up the fill functions:

	* app/core/core-enums.[ch]: added PICMAN_PATTERN_FILL enum value to
	the PicmanFillType enum. Don't export PICMAN_NO_FILL to the PDB
	because it's completely useless to export a NOP.

	* app/core/picman-edit.c (picman_edit_fill, picman_edit_fill_internal):
	handle pattern fill requests.

	* app/core/picmandrawable.[ch] (picman_drawable_fill): added PicmanPattern
	parameter and fill with it if it's non-NULL.

	(picman_drawable_fill_by_type): handle pattern fill and pass the
	current pattern to picman_drawable_fill().

	* app/text/picmantextlayer.c: changed accordingly.

	* app/gui/edit-commands.c
	* app/gui/image-menu.c: use picman_edit_fill() instead of
	picman_drawable_bucket_fill() for FG, BG and pattern filling.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: removed NO_IMAGE_FILL compat
	enum value. It should have never been exported to the PDB.

	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2004-01-06  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb: use picman->config; edit_config is
	just for the prefs dialog. This should fix picman_picmanrc_set().

	* app/pdb/picmanrc_cmds.c: regenerated.

2004-01-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: use a global parasite to store the default
	values. Such uglyness doesn't belong into picmanrc.

	* devel-docs/parasites.txt: document the parasite used by the PNG
	plug-in.

2004-01-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantemplateeditor.c: cosmetic.

2004-01-06  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.[ch]: added thumb_size variable to
	the PicmanThumbnail struct. Fixed handling of failed thumbnails.

2004-01-06  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_set_uri): added
	missing casts to gint64.

2004-01-06  Manish Singh  <yosh@picman.org>

	* app/widgets/picmandasheditor.c (picman_dash_editor_new): remove
	unnecessary GTK_WIDGET() cast.

	* app/widgets/picmanstrokeeditor.c (picman_stroke_editor_constructor):
	remove unnecessary G_OBJECT() casts.

	* libpicmanbase/picmanlimits.h: cosmetic cleanup.

	* libpicmanbase/picmanenv.c (picman_toplevel_directory): add (void)
	to prototype.

	* plug-ins/script-fu/script-fu-console.c (script_fu_cc_key_function):
	set cursor to end of line after history navigation.

	* plug-ins/common/struc.c (strucpi): use CLAMP0255.

2004-01-06  Manish Singh  <yosh@picman.org>

	* plug-ins/common/png.c: Implemented default settings, for both
	the UI and the PDB. Settings are stored in picmanrc, but right now
	saving is broken since picman_picmanrc_set is broken right now.

	There are 3 new PDB entry points: file_png_save_defaults, which is
	a save function that only takes drawable and filename info, and
	uses the stored picmanrc settings for the rest of the parameters.
	This is hooked up to the save magic, so using picman_file_save to
	save as png now won't make big files anymore. The other two are
	file_png_get_defaults and file_png_set_defaults, which query
	and set the picmanrc setting respectively.

	I also did some cleanup, and added a comment boolean to the
	file_png_save2 interface. The string serialization to the picmanrc
	is sort of dumb, but it works.

	Next step is to do similar for jpeg and gif.
	
2004-01-06  Sven Neumann  <sven@picman.org>

	Fixes to the new thumbnail code. Will need more changes...
	
	* app/core/picmanimagefile.c: set image information before calling
	picman_thumbnail_save_thumb(). Emit the "info_changed" signal when
	the thumbnail states change.

	* libpicmanthumb/picmanthumbnail.c: redone picman_thumbnail_load_thumb().
	Added some debugging code that is by default disabled.

2004-01-05  Manish Singh  <yosh@picman.org>

	* app/paint-funcs/paint-funcs.c (expand_line): on second thought, just
	make everything signed. There is no reason for any of it to be
	unsigned.

2004-01-05  Manish Singh  <yosh@picman.org>

	* app/paint-funcs/paint-funcs.c (expand_line): cast usage of unsigned
	bytes variable in array subscripting to signed, so we really do get
	a negative value when we need it. Fixes #130398.

2004-01-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CEL.c: fixed coding style issues, removed
	trailing whitespace, use gsize instead of size_t.
	(need_palette): check the return value of fopen() before using it.

2004-01-05  Dov Grobgeld  <dov@imagic.weizmann.ac.il>

	* plug-ins/common/CEL.c: Added read and write support for 
	32-bit CEL files.

2004-01-05  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/misc_tools_cmds.c: forgot to remove this file.

2004-01-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl
	* tools/pdbgen/pdb/misc_tools.pdb: removed the "misc tools" PDB group.

	* tools/pdbgen/pdb/edit.pdb: added picman_edit_bucket_fill() and
	picman_edit_blend().

	* tools/pdbgen/pdb/image.pdb: added picman_image_pick_color().

	* app/pdb/procedural_db.c
	* libpicman/picmancompat.h: added compat stuff.

	* app/pdb/edit_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/misc_tools_cmds.c
	* libpicman/picman_pdb.h
	* libpicman/picmanedit_pdb.[ch]
	* libpicman/picmanimage_pdb.[ch]: regenerated.

	* libpicman/Makefile.am
	* libpicman/picmanmisctools_pdb.[ch]: removed.

	* plug-ins/gfig/gfig.c
	* plug-ins/script-fu/scripts/3dTruchet.scm
	* plug-ins/script-fu/scripts/alien-glow-arrow.scm
	* plug-ins/script-fu/scripts/alien-glow-bar.scm
	* plug-ins/script-fu/scripts/alien-glow-bullet.scm
	* plug-ins/script-fu/scripts/alien-glow-button.scm
	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/beveled-button.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/coffee.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/gradient-example.scm
	* plug-ins/script-fu/scripts/hsv-graph.scm
	* plug-ins/script-fu/scripts/pupi-button.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/sphere.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/test-sphere.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/title-header.scm
	* plug-ins/script-fu/scripts/weave.scm: follow "blend" and "color
	picker" changes. Leave "bucket fill" users unchanged because fill
	and bucket_fill need another cleanup (will follow next...)

2004-01-05  Dave Neary  <bolsh@picman.org>

	* NEWS: Update news.

2004-01-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: applied a modified patch provided by
	Joao S. O. Bueno and Dave Neary. The user can now specify whether
	color values for transparent pixels should be saved or nullified
	(bug #129472).

2004-01-05  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_UNDO_TEXT_LAYER to
	PicmanUndoType enum.

	* app/core/picmanimage-undo-push.[ch]: added new undo function
	picman_image_undo_push_text_layer().

	* app/text/picmantextlayer.[ch]: renamed picman_text_layer_render() to
	picman_layer_text_layer_flush().
	Added new function picman_text_layer_discard().

	* app/text/picmantextlayer-transform.c: changed accordingly.

	* app/gui/image-menu.c
	* app/gui/layers-commands.[ch]	
	* app/gui/layers-menu.c: added menu entries that allow to discard
	the text information of a text layer (bug #118547).

	* app/widgets/picmanpreviewrendererlayer.c
	(picman_preview_renderer_layer_render): treat text layers without a
	text object like ordinary layers.

	* app/widgets/picmanpreviewrenderer-utils.c: include picmanlayer.h
	instead of picmantextlayer.h.

2004-01-04  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Remove last hardcoded -1.3's.

2004-01-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-contiguous-region.c
	(picman_image_contiguous_region_by_seed) 
	(find_contiguous_region_helper)
	(find_contiguous_segment): pass around PicmanImage and PicmanImageType
	parameters. For indexed images, convert the tile data to RGB using
	picman_image_get_color(). Still use the raw tile data for RGB and
	GRAY images so the slowdown for these image types should be
	minimal. Fixes bug #128991.

2004-01-03  Manish Singh  <yosh@picman.org>

	* plug-ins/twain/Makefile.am
	* plug-ins/winsnap/Makefile.am: minor tweaks, to match changes that
	were made in the other Makefiles long ago.

2004-01-03  Manish Singh  <yosh@picman.org>

	* configure.in: fix setting of RT_LIBS.

2004-01-03  Manish Singh  <yosh@picman.org>

	* configure.in: check for shm_open in libc too, and define RT_LIBS
	accordingly.

	* picmantool-1.3.in
	* app/Makefile.am
	* libpicman/Makefile.am
	* plug-ins/*/Makefile.am
	* plug-ins/common/mkgen.pl: use RT_LIBS.

2004-01-03  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c: some cosmetics while reviewing
	the code.

2004-01-03  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.def: updated. Patch from Michael Schumacher.

2004-01-02  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/animationplay.c (build_dialog): NULL-terminate
	the list of strings passed to g_strconcat().

2004-01-02  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c: removed PicmanTool::cursor_update()
	implementation (which was there only to stop drawing the brush
	preview when the mouse leaves the canvas). Instead, look at
	shell->proximity in PicmanTool::oper_update() and just don't start
	drawing the preview if proximity is FALSE.

	* app/display/picmandisplay.c (picman_display_delete): set
	gdisp->shell to NULL *before* gtk_widget_destroy()ing the shell so
	our tool callbacks don't dispatch stuff while the shell is in the
	middle of being destroyed.

	Both changes fix bug #129374, though the latter is the fix for the
	real problem.

2003-12-31  Simon Budig  <simon@picman.org>

	* app/core/picmandrawable-stroke.c
	* app/paint/picmanpaintcore-stroke.c: Don't simplify the border
	of the selection. Quite some people were confused by the
	polygonal look of a stroked ellipse. The old behaviour doesn't
	look good, but the new one isn't really better. Since the
	old behaviour is more predictable, I am reverting this for now
	(Please note that the function to simplify the boundary still
	is available, it just is unused).

	Hopefully at some point it will be possible to have non-integer
	boundary coordinates or even a more sophisticated set of
	"vector-selection" tools.

2003-12-31  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: Fixed missing undo step when
	moving (components of) the path. Don't add an undo step when
	nothing changes.

	Also rephrased the help strings in the statusbar to be shorter
	and encourage the user to try shift. Fixes bug #124025.

2003-12-31  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c (picman_text_options_gui): fixed
	table packing.

2003-12-30  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Do not move anchors in edit mode.

	Fixes bug #124973.

2003-12-30  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: Made it possible to have multiple
	lines of translators in the about dialog. Simply translate
	"<Translators: insert your names here, separated by newline>".

	Fixes bug #58507.

2003-12-30  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-compat.c: When there is a visible
	path, it cannot be stored in the XCF in a portable manner.

	* app/xcf/xcf-save.c: Removed Debug output

2003-12-30  Simon Budig  <simon@picman.org>

	* app/gui/stroke-dialog.c: Save the stroking type (libart /
	paint-tool) so that it can be remembered when the dialog
	gets opened a second time. Fixes Bug #128156.

2003-12-29  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: reshuffle the authors array and
	restart the animation when the dialog gets shown a second
	time. Also render the current version number to the image
	permanently.

2003-12-29  RaphaÃ«l Quinet  <quinet@gamers.org>

	* app/gui/palette-editor-menu.c: Applied patch by David Gowers
	(neota@softhome.net) improving the mnemonics of the palette editor
	commands 'New from FG/BG'.  Fixes bug #130121.

2003-12-29  Simon Budig  <simon@picman.org>

	* app/gui/about-dialog.c: Redone to have a fancy graphical
	effect. Will be tweaked further.

2003-12-28  Simon Budig  <simon@picman.org>

	* app/core/core-enums.h: Some default dash pattern enum.
	* app/core/core-enums.c: regenerated.

	* app/core/picmanstrokeoptions.[ch]: Implement default dash
	patterns, add a signal when the dash pattern changes.

	* app/widgets/picmanstrokeeditor.c: Add an option menu for
	the dash pattern and connect it to the signal mentioned above.

2003-12-28  Simon Budig  <simon@picman.org>

	* app/widgets/picmanstrokeeditor.c: Fixed packing of the widgets.

2003-12-28  Simon Budig  <simon@picman.org>

	* app/widgets/picmandasheditor.[ch]: Added functions to shift the
	dash pattern to the left or right.
	
	* app/widgets/picmanstrokeeditor.c: Improve the appearance of the
	widget and add left/right buttons.

2003-12-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandasheditor.c: some minor cleanups.

2003-12-27  Simon Budig  <simon@picman.org>

	Dashed stroking is here...  :-)
	(fixes bug #129597, although further improvements are desireable)

	* app/core/picmandrawable-stroke.c: actually use the dash pattern
	from the options

	* app/core/picmanscanconvert.c: Normalize the dash pattern, so
	that libart does the right thing.

	* app/core/picmanstrokeoptions.c: Fix default value for dash
	offset, handle the property_get for PROP_DASH_INFO correct.

	* app/widgets/picmandasheditor.[ch]
	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h: New widget to edit a dash
	pattern.

	* app/widgets/picmanstrokeeditor.c: Use it.

2003-12-27  Manish Singh  <yosh@picman.org>

	* app/main.c
	* app/plug-in/plug-in-shm.c
	* libpicman/picman.c: POSIX shared memory tile transport implementation,
	and a little code cleanup of the SysV and Win32 implementations.

	* configure.in: checks for shm_open, default to POSIX shared memory
	transport on OS X.

2003-12-27  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/jigsaw.c (jigsaw): actually don't crash when
	layer previews are disabled. Fixes the crash reported in bug
	#112012, but not the bug itself.

2003-12-26  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_save_thumb): don't crash
	when layer previews are disabled.

2003-12-26  Dave Neary  <bolsh@picman.org>

	* app/base/levels.c: Modify behaviour of levels tool to 
	conserve lightness when using the grey-point color-picker.

2003-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c: forgot to change
	picman_pixel_fetcher_set_edgemode to picman_pixel_fetcher_set_edge_mode
	here.

2003-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_cern.y
	* plug-ins/imagemap/imap_cern_lex.c
	* plug-ins/imagemap/imap_cern_parse.[ch]
	* plug-ins/imagemap/imap_csim.[ly]
	* plug-ins/imagemap/imap_csim_lex.c
	* plug-ins/imagemap/imap_csim_parse.[ch]
	* plug-ins/imagemap/imap_ncsa.[ly]
	* plug-ins/imagemap/imap_ncsa_lex.c	
	* plug-ins/imagemap/imap_ncsa_parse.[ch]: Yosh informed me that
	regenerating the files using recent versions of flex/bison is a
	bad idea. Reverted my changes and redid the most important parts
	manually.

2003-12-26  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.c: set the default value for
	"activate-on-focus" to TRUE. The discussion on this has been
	controversial and I am doing this change now in order to get more
	feedback.

2003-12-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmisc.[ch]: applied a modified version of a patch
	from Maurits Rijk that cleans up the remaining API (bug #125141).

	* plug-ins/common/curve_bend.c
	* plug-ins/common/displace.c
	* plug-ins/common/edge.c
	* plug-ins/common/illusion.c
	* plug-ins/common/shift.c
	* plug-ins/gflare/gflare.c: changed accordingly.

2003-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_edit_area_info.c (create_info_tab):
	removed an unused variable.

	* plug-ins/imagemap/imap_cern.l: include <string.h> for strcpy().

	* plug-ins/imagemap/imap_csim.l
	* plug-ins/imagemap/imap_ncsa.l: include <unistd.h> for isatty().

	* plug-ins/imagemap/imap_cern_lex.c
	* plug-ins/imagemap/imap_ncsa_lex.c
	* plug-ins/imagemap/imap_csim_lex.c: regenerated.

2003-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_cern.y
	* plug-ins/imagemap/imap_csim.y
	* plug-ins/imagemap/imap_ncsa.y
	* plug-ins/script-fu/script-fu-console.c 
	* plug-ins/script-fu/script-fu-server.c: include gtk.h with angle
	brackets, not quotes.

	* plug-ins/imagemap/imap_cern_parse.[ch]
	* plug-ins/imagemap/imap_csim_parse.[ch]
	* plug-ins/imagemap/imap_ncsa_parse.[ch]: regenerated.

	* plug-ins/imagemap/Makefile.am: added y.tab.[ch] (created by bison)
	to CLEANFILES.

2003-12-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_save_thumb): return
	TRUE if thumbnails are disabled. Fixes bug #129921.

2003-12-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-image.c: add undo_group_{start,end} methods.

	* plug-ins/pypicman/foggify.py
	* plug-ins/pypicman/shadow_bevel.py: and use them here, instead of
	deprecated PDB functions.

2003-12-23  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-image.c: remove add/remove_layer_mask
	methods...

	* plug-ins/pypicman/pypicman-drawable.c: ... and put them here, as methods
	of the layer object.

	* plug-ins/pypicman/plug-ins/foggify.py: update for the above new API.

2003-12-22  DindinX  <david@dindinx.org>

	* plug-ins/common/AlienMap.c:
	* plug-ins/common/AlienMap2.c:
	* plug-ins/common/CEL.c:
	* plug-ins/common/aa.c:
	* plug-ins/common/align_layers.c:
	* plug-ins/common/animationplay.c:
	* plug-ins/common/animoptimize.c:
	* plug-ins/common/apply_lens.c:
	* plug-ins/common/autocrop.c:
	* plug-ins/common/blinds.c:
	* plug-ins/common/blur.c:
	* plug-ins/common/borderaverage.c:
	* plug-ins/common/bumpmap.c:
	* plug-ins/common/bz2.c:
	* plug-ins/common/c_astretch.c:
	* plug-ins/common/channel_mixer.c:
	* plug-ins/common/nova.c: small cosmetic changes, such as removing
	tabs.

2003-12-22  DindinX  <david@dindinx.org>

	* app/gui/user-install-dialog.c (user_install_dialog_run): added a
	scrolled window in page 2, since the list of directories is too long
	to fit in a 1024x768 screen.  The user install dialog should now fit
	into a 800x600 screen.  This should close #122211

2003-12-21  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/convmatrix.c: indentation & whitespace cleanup.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.[ch]: added
	picman_display_shell_drop_svg() (untested because there is no place
	to drag an SVG from yet...).

	* app/display/picmandisplayshell.c (picman_display_shell_init):
	connect SVG drops to the new callback.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.[ch]: changed "svg_data" from guchar* to
	gchar*, cleaned up debugging output.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c: some cleanup while hunting
	window positioning bugs.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.c (picman_histogram_view_expose):
	render the selection in "light" histograms correctly (unused and
	untested).

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c: reset container_view->dnd_widget
	in picman_item_tree_view_constructor() instead of
	picman_item_tree_view_new().

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.c: this was starting to bit-rot on
	my disk: added "container" and "context" properties.

	(picman_container_view_set_size_request): fixed scrollbar_width
	calculation for deprecated uses of the widget (should never happen
	but the code should be correct anyway).

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-stroke.c (picman_drawable_stroke_boundary):
	fixed cut'n'paste bug: always use offset_x, not offset_y for x
	coordinates (spotted by Olivier Gondouin).

2003-12-21  Dave Neary  <bolsh@picman.org>

	* NEWS: Updated NEWS.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c: made "item-type" and
	"signal-name" CONSTRUCT_ONLY properties. Configure the DND dests
	in picman_item_tree_view_constructor(), not in
	picman_item_tree_view_new().

2003-12-21  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-export.[ch]: removed the GError parameter
	from picman_vectors_export_string() and implemented this function.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrendererbrush.c: removed trailing
	whitespace and #if 0'ed cruft. Cosmetics.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantooldialog.c (picman_tool_dialog_new): doc fixes.

2003-12-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c: return a boolean indicating success from
	all drop handlers.

	(picman_dnd_data_drop_handle): finish the drop correctly by calling
	gtk_drag_finish() with the above success value.

2003-12-20  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.[ch]: added picman_xml_parser_parse_buffer().

	* app/vectors/picmanvectors-export.[ch]: renamed picman_vectors_export()
	to picman_vectors_export_file() and added a stub called
	picman_vectors_export_string().

	* app/vectors/picmanvectors-import.[ch]: renamed picman_vectors_import()
	to picman_vectors_import_file() and added picman_vectors_import_buffer().

	* app/gui/vectors-commands.c
	* tools/pdbgen/pdb/paths.pdb: changed accordingly.

	* app/pdb/paths_cmds.c: regenerated.

2003-12-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.[ch]: changed unused SVG dnd API to speak in
	terms of "guchar *data", "gint data_len" instead of PicmanVectors.

2003-12-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.h: sanitized DND identifiers
	(e.g. PICMAN_BRUSH -> application/x-picman-brush-name).

	* app/widgets/picmandnd.[ch]: added stubs for SVG DND with
	on-the-fly conversion from/to PicmanVectors. Someone needs to add
	the conversion functions...

2003-12-20  Sven Neumann  <sven@picman.org>

	* app/gui/gradient-editor-commands.c
	(gradient_editor_replicate_response): applied patch from Shlomi Fish
	that fixes an obvious cut'n'paste bug in the code that replicates a
	gradient segment (bug #129738).

2003-12-19  Jakub Steiner <jimmac@ximian.com>

	* data/images/picman_splash.png: it's here! soon!

2003-12-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c: update the crop dialog in
	crop_recalc(), not in picman_crop_tool_draw().

2003-12-19  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: Removed private statusbar
	gdisplay pointer. Now help texts are only shown on the gdisp
	of the tool. Fixes bug #128209

2003-12-19  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb: renamed picman_temp_PDB_name()
	* tools/pdbgen/pdb/procedural_db.pdb: to picman_procedurab_db_temp_name()

	* app/pdb/procedural_db.c
	* libpicman/picmancompat.h: added compat cruft.

	* app/pdb/internal_procs.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* libpicman/picmanplugin_pdb.[ch]
	* libpicman/picmanproceduraldb_pdb.[ch]: regenerated.

	* libpicman/picmanbrushselect.c
	* libpicman/picmanfontselect.c
	* libpicman/picmangradientselect.c
	* libpicman/picmanpatternselect.c: changed accordingly.

2003-12-19  Michael Natterer  <mitch@picman.org>

	* libpicman/picmancompat.h: added some missing #defines.

2003-12-18  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanfileentry.c
	* libpicmanwidgets/picmanpatheditor.c
	* libpicmanwidgets/picmanunitmenu.c (*_class_init): moved signal
	documentation from the gtk-doc templates to comments.

	* libpicmanwidgets/picmanpatheditor.c (picman_path_editor_set_path):
	emit the "path-changed" signal.

	* libpicmanwidgets/picmanpatheditor.[ch]: s/gpe/editor/g.

2003-12-17  Dave Neary  <bolsh@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: Change randomize boolean to 
	boolean *.

	* plug-ins/gflare/gflare.c
	* plug-ins/maze/maze_face.c
	* plug-ins/common/plasma.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c:
	* plug-ins/common/blur.c
	* plug-ins/common/randomize.c: Modify appropriately.

2003-12-17  Dave Neary  <bolsh@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: Change signature of 
	picman_random_seed_new() to allow caller to specify that he wants to 
	use a random seed rather than the specified seed. Previously it was
	up to the caller to initialise the seed.

	* plug-ins/gflare/gflare.c
	* plug-ins/maze/maze_face.c
	* plug-ins/common/plasma.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c: Trivial modifications of call to 
	picman_random_seed_new() with FALSE.

	* plug-ins/common/blur.c
	* plug-ins/common/randomize.c: Modify PDB routines and tool options 
	to allow a random seed to be specified. Useful for scripts. Reverts
	PDB to 1.2 state. Fixes bug #129529.

2003-12-17  Dave Neary  <bolsh@picman.org>

	* plug-ins/script-fu/script-fu-server.c: Destroy widget, not data.

2003-12-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-contiguous-region.c: removed trailing
	whitspace.

2003-12-17  Michael Natterer  <mitch@picman.org>

	* app/display/picmancanvas.c (picman_canvas_gc_new): restore the
	cap_style and join_style properties for the XOR GdkGC to the
	values PicmanDrawTool's GC used to have. Fixes the result of
	gdk_draw_segments().

	* app/tools/picmanfuzzyselecttool.c (picman_fuzzy_select_tool_motion):
	CLAMP the threshold to its possible values when setting it in the
	selection options.

	(picman_fuzzy_select_tool_button_release): restore the original
	threshold after selecting.

2003-12-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.c (picman_session_info_restore): free
	PicmanSessionInfoAux structs using picman_session_info_aux_free()
	instead of g_free() so we don't leak its members.

2003-12-16  Michael Natterer  <mitch@picman.org>

	* app/text/picmantextlayout-render.c (picman_text_layout_render):
	multiply the layout's offsets with PANGO_SCALE, not -PANGO_SCALE.
	Fixes bug #129405.

2003-12-16  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.c (picman_composite_init): fixed
	gtk-doc comment.

	* plug-ins/script-fu/scripts/3d-outline.scm: use enums.

2003-12-16  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c: added more precondition checks, minor
	cleanup.

2003-12-16  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_add_layer_mask)
	* tools/pdbgen/pdb/layer.pdb (layer_add_mask): don't unref the
	mask after adding it because the layer now takes ownership using
	g_object_ref()/picman_item_sink().

	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c: regenerated.

2003-12-16  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c: added API documentation.

2003-12-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.[ch]: draw the selection in
	GTK_STATE_SELECTED's colors, not inverted. Fixed selection
	rendering to snap to value boundaries.

2003-12-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/convmatrix.c (response_callback): destroy "widget",
	not "data". Fixes bug #129364.

2003-12-14  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-image.c: use get_name for the repr instead
	of get_filename, to be more consistent.

2003-12-14  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/Makefile.am
	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/Lighting/lighting_image.[ch]
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/Lighting/lighting_ui.[ch]
	* plug-ins/MapObject/Makefile.am
	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/MapObject/mapobject_image.[ch]
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_shade.c	
	* plug-ins/MapObject/mapobject_ui.[ch]: removed remaining
	references to libgck. Use GdkRGB functionality instead.

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/makefile.msc
	* plug-ins/libgck: removed libgck.

2003-12-14  Sven Neumann  <sven@picman.org>

	* libpicman/picmanui.def: removed picman_plug_in_get_path.

	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/Lighting/lighting_preview.[ch]: minor cleanup.

2003-12-14  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumb-error.c
	* libpicmanthumb/picmanthumb-utils.[ch]
	* libpicmanthumb/picmanthumbnail.c: some code review and addition of
	API documentation. Not finished yet...

2003-12-14  RaphaÃ«l Quinet  <quinet@gamers.org>

	* libpicman/picmanui.h: Removed inclusion of libpicman/picmanmiscui.h,
	which is gone now.  Looks like another forgotten commit.  It was
	breaking the build (ouch! bad DindinX!).  ;-)

2003-12-14  DindinX  <david@dindinx.org>

	* plug-ins/FractalExplorer/Dialogs.c:
	* plug-ins/gfig/gfig.c:
	* plug-ins/gflare/gflare.c: Don't call picman_plug_in_get_path(), since
	it doesn't really help, call picman_picmanrc_query() instead and display
	an error message in case of problem. Aka move the code from
	picmanmiscui back to these plug-ins.

	* libpicman/picmanmiscui.[ch]: removed these file.
	* libpicman/Makefile.am: changed accordlingly.

	* plug-ins/libpicmanoldpreview/picmanoldpreview.c: removed
	picman_plug_in_get_path() from here also, since I forgot to do this in
	my previous commits (ouch! bad DindinX!).

	All this partly close #125141.

2003-12-13  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/procedural_db.pdb: added a hack that allows to
	dynamically allocate the strings returned by a PDB query. Construct
	more useful "blurb" and "help" strings for deprecated procedures.

	* tools/pdbgen/pdb/image.pdb: did the same change manually for
	picman_image_add,remove_layer_mask.

	* app/pdb/procedural_db_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2003-12-13  DindinX  <david@dindinx.org>

	* plug-ins/libpicmanoldpreview/picmanoldpreview.[ch]: fixed the header
	part to reflect the new name of these files.

2003-12-12  Manish Singh  <yosh@picman.org>

	* Makefile.am
	* app/composite/Makefile.am
	* themes/Default/images/Makefile.am: comestics.

	* app/gui/color-notebook.c (color_notebook_new): no need to cast to
	G_OBJECT for g_signal_connect.

	* plug-ins/common/mkgen.pl
	* plug-ins/common/plugin-defs.pl: properly handle the libpicmanoldpreview
	stuff.

	* plug-ins/common/Makefile.am: regenerated.

	* plug-ins/common/decompose.c: cbrt() is in C99, so check for that
	in addition to GNU libc.

2003-12-12  Hans Breuer  <hans@breuer.org>

	[
	 I've postponed my reservations against pangoft2/fontconfig/freetype2
	 usage, so The Picman should now build with msvc without patching it.
	]

	* app/makefile.msc app/text/makefile.msc: use $(PANGOFT2_CFLAGS) etc.

	* libpicmanthumb/makefile.msc: (new file)
	* makefile.msc: added libpicmanthumb

	* libpicmanthumb/picmanthumbnail.c: include picmanwin32-io.h
	* libpicmanthumb/picmanthumb-utils.c: don't compare size pointer
	with PICMAN_THUMB_SIZE_FAIL but *size 

	* plug-ins/makefile.msc: handle libpicmanoldpreview

	* plug-ins/common/decompose.c: define cbrt() if not __GLIBC__

	* plug-ins/common/winclipboard.c: make it compile without picmancompat.h

	* plug-ins/imagemap/imagemap_csim_lex.c: its a generated file
	but still win32/msvc has no unistd.h

	* plug-ins/pypicman/makefile.msc: (new file) to use the binary you 
	need to patch glib, see bug #98737

	* plug-ins/libpicmanoldpreview.c: use <libpicman/picman.h> instead of
	"picman.h"

	* **/Makefile.am: added makefile.msc to EXTRA_DIST

2003-12-12  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanlayer.h: removed preserve_transparency #defines.
	This is the last of the #defines we added before 1.2 to create a
	saner libpicman API (this time, removed the function names that were
	planned to be the new ones, because this one is just nitpicky and
	overly long).

	* libpicman/picmancompat.h: added them here.

	* plug-ins/common/iwarp.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c
	* plug-ins/common/rotate.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/vpropagate.c
	* plug-ins/xjt/xjt.c: changed accordingly.

2003-12-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/gfig/gfig-preview.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/maze/maze_face.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/winsnap/winsnap.c
	* plug-ins/xjt/xjt.c
	* plug-ins/common/*.c: don't set GTK_SHADOW_ETCHED_IN on
	GtkFrames, it's the default and just clutters the code.

2003-12-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanblendoptions.c (picman_blend_options_gui)
	* app/tools/picmancoloroptions.c (picman_color_options_gui)
	* app/tools/picmaninkoptions.c (picman_ink_options_gui): removed calls
	to gtk_frame_set_shadow_type (frame, GTK_SHADOW_ETCHED_IN) because
	that's the default anyway.

2003-12-12  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs.c: remember the size of the color picker dialog.

2003-12-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c (picman_curves_tool_register): call
	picman_color_options_new, not picman_histogram_options_new.

2003-12-11  Manish Singh  <yosh@picman.org>

	* plug-ins/common/destripe.c (destripe_dialog): use the GtkDialog
	vbox instead of an uninitialized one.

2003-12-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c: use PicmanHistogramOptions instead of
	PicmanColorOptions and connect the options to the histogram view.

2003-12-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.[ch]: added a hack that allows to
	render the histogram in a brighter color. Fixed initial range for
	views that are not selectable.
	* app/tools/picmancurvestool.[ch]: replaced the GtkDrawingArea by a
	bright PicmanHistogramView and render the curves tool controls on
	top of the histogram. Fixes bug #71633.

2003-12-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_init): suppress
	button_press events that reach the dockable widget but don't
	originate from the title area.

2003-12-11  DindinX  <david@dindinx.org>

	* libpicman/picmanmiscui.c:
	* libpicman/picmanmiscui.h: removed PicmanOld preview...

	* plug-ins/libpicmanoldpreview/Makefile.am:
	* plug-ins/libpicmanoldpreview/picmanoldpreview.c:
	* plug-ins/libpicmanoldpreview/picmanoldpreview.h: ... and added it there
	as a noinst library, so foreign plug-ins won't use it.

	* configure.in:
	* plug-ins/Makefile.am:

	* plug-ins/common/Makefile.am:

	* plug-ins/common/AlienMap.c:
	* plug-ins/common/AlienMap2.c:
	* plug-ins/common/blinds.c:
	* plug-ins/common/flarefx.c:
	* plug-ins/common/glasstile.c:
	* plug-ins/common/grid.c:
	* plug-ins/common/illusion.c:
	* plug-ins/common/jigsaw.c:
	* plug-ins/common/max_rgb.c:
	* plug-ins/common/nlfilt.c:
	* plug-ins/common/noisify.c:
	* plug-ins/common/nova.c:
	* plug-ins/common/plasma.c:
	* plug-ins/common/polar.c:
	* plug-ins/common/waves.c:
	* plug-ins/common/wind.c: Changed accordingly.

2003-12-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.[ch]: added properties "border-width"
	and "subdivisions". Fixed rendering (it off-by-one worked just
	accidentially because border-width was hardcoded to 1).

	* app/widgets/picmanhistogrambox.c: use the histogram view's border
	width for the color area below the histogram. Conect to the right
	signal to update the area. Added (#ifdef DEBUG_VIEW) debugging
	spinbuttons to change the histogram view's new properties on the
	fly.

2003-12-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.[ch]: applied (modified) patch
	from Ed Halley which adds "quintile marks". Fixes bug #129050.
	Render the histogram on a base_gc background and use text_gc and
	text_aa_gc for rendering the histogram and the helper lines.
	Fixed rendering of the 1px border around the histogram. Removed
	separate drawing of baseline, left and right helper lines and draw
	a rectangle which marks the entire area of possible values. Fixed
	size_request calculation. Added missing getters. Cleanup.

	* app/tools/picmancurvestool.c: use the same color scheme as the
	histogram.

	* app/tools/picmancurvestool.c (curves_load,save_callback)
	* app/tools/picmanlevelstool.c (levels_load,save_callback):
	gtk_window_present() the file dialog if it is already visible.

2003-12-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c (picman_display_shell_events):
	switch off fullscreen mode on Escape key press events only. The shell
	should not react on the key release event it gets when a dialog is
	closed using the Escape key.

2003-12-09  DindinX  <david@dindinx.org>

	* libpicman/picmanmiscui.c:
	* libpicman/picmanmiscui.h:
	* plug-ins/common/AlienMap.c:
	* plug-ins/common/AlienMap2.c:
	* plug-ins/common/blinds.c:
	* plug-ins/common/flarefx.c:
	* plug-ins/common/glasstile.c:
	* plug-ins/common/grid.c:
	* plug-ins/common/illusion.c:
	* plug-ins/common/jigsaw.c:
	* plug-ins/common/max_rgb.c:
	* plug-ins/common/nlfilt.c:
	* plug-ins/common/noisify.c:
	* plug-ins/common/nova.c:
	* plug-ins/common/plasma.c:
	* plug-ins/common/polar.c:
	* plug-ins/common/waves.c:
	* plug-ins/common/wind.c:  Rename PicmanFixmePreview into
	PicmanOldPreview. This is just a prelimirary stuff, before moving it
	into its own, no_inst library.

2003-12-09  DindinX  <david@dindinx.org>

	* plug-ins/common/vpropagate.c (vpropagate_dialog):
	* plug-ins/common/unsharp.c (unsharp_mask_dialog):
	* plug-ins/common/threshold_alpha.c (threshold_alpha_dialog):
	* plug-ins/common/struc.c (struc_dialog):	
	* plug-ins/common/sparkle.c (sparkle_dialog):
	* plug-ins/common/sobel.c (sobel_dialog):
	* plug-ins/common/snoise.c (solid_noise_dialog):
	* plug-ins/common/smooth_palette.c (dialog):
	* plug-ins/common/sharpen.c (sharpen_dialog):
	* plug-ins/common/sel_gauss.c (sel_gauss_dialog):
	* plug-ins/common/scatter_hsv.c (scatter_hsv_dialog):
	* plug-ins/common/ripple.c (ripple_dialog):
	* plug-ins/common/randomize.c (randomize_dialog):
	* plug-ins/common/polar.c (polarize_dialog):
	* plug-ins/common/plasma.c (plasma_dialog):
	* plug-ins/common/pixelize.c (pixelize_dialog):
	* plug-ins/common/oilify.c (oilify_dialog):
	* plug-ins/common/nova.c (nova_dialog):
	* plug-ins/common/noisify.c (noisify_dialog):
	* plug-ins/common/nlfilt.c (pluginCoreIA):
	* plug-ins/common/lic.c (create_main_dialog):
	* plug-ins/common/jpeg.c (save_dialog):
	* plug-ins/common/illusion.c (dialog):
	* plug-ins/common/grid.c (dialog):
	* plug-ins/common/glasstile.c (glass_dialog):
	* plug-ins/common/gauss_rle.c (gauss_rle_dialog):
	* plug-ins/common/gauss_iir.c (gauss_iir_dialog):
	* plug-ins/common/engrave.c (engrave_dialog):
	* plug-ins/common/emboss.c (pluginCoreIA):
	* plug-ins/common/edge.c (edge_dialog):
	* plug-ins/common/destripe.c (destripe_dialog):
	* plug-ins/common/despeckle.c (despeckle_dialog):
	* plug-ins/common/cubism.c (cubism_dialog):
	* plug-ins/common/checkerboard.c (do_checkerboard_dialog):
	* plug-ins/common/bumpmap.c (bumpmap_dialog):
	* plug-ins/common/blur.c (blur_dialog):
	* plug-ins/common/blinds.c (blinds_dialog):
	* plug-ins/common/apply_lens.c (lens_dialog): reverted Maurits'
	patch, to get rid of picman_parameter_settings_new (see #125141)

	* libpicman/picmanmiscui.[ch]: remove this function.

2003-12-09  DindinX  <david@dindinx.org>

	* plug-ins/common/wind.c (pluginCoreIA):
	* plug-ins/common/whirlpinch (whirl_pinch_dialog):
	* plug-ins/common/waves (dialog_box): reverted Maurits' patch,
	to get rid of picman_parameter_settings_new (see #125141)

2003-12-09  DindinX  <david@dindinx.org>

	* plug-ins/common/xpm.c (save_dialog): reverted Maurits' patch,
	to get rid of picman_parameter_settings_new (see #125141)

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-scale.c (picman_image_scale_check): renamed
	variable and added comments to make the calculation clear.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-duplicate.c: Removed unused #includes. Copy
	the colormap using the provided API. Use picman_item_convert()
	instead of picman_item_duplicate() and picman_item_set_image() to
	create layers, channels and vectors for the new image. Don't leak
	the new image's grid. Cleanup.

2003-12-09  Michael Natterer  <mitch@picman.org>

	Fixed memory management of layers and channels which were created
	using the PDB:

	* app/core/picmanitem.[ch]: added "gboolean floating" flag to
	PicmanItem. Items are created with floating == TRUE. Added
	picman_item_sink() which resets the floating flag and unrefs the
	item if it was TRUE.  Added picman_item_is_floating() accessor.

	* app/core/picmanimage.c (picman_image_add_layer,channel,vectors):
	g_object_ref()/picman_item_sink() added items to take ownership of
	them.

	* app/core/picmanlayer.c (picman_layer_add_mask):
	g_object_ref()/picman_item_sink() the mask.

	* app/gui/layers-commands.c
	* app/xcf/xcf-load.c: don't unref layer masks after adding them to
	the layer.

	* tools/pdbgen/pdb/drawable.pdb (drawable_delete):
	picman_item_sink() the drawable if it's floating and fail if it's
	not. Fixes bug #128881.

	* tools/pdbgen/pdb/layer.pdb (layer_create_mask): fixed docs.

	* app/pdb/drawable_cmds.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.c: regenerated.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: removed enum value
	PICMAN_UNDO_GROUP_EDIT_COPY (I have no idea why we used to push an
	undo group around "Copy"...).

	* app/core/picman-edit.c (picman_edit_extract): new utility function
	which does everything needed for cut and copy and does not push an
	undo group for copy.

	(picman_edit_cut,copy): removed lots of duplicated code and call
	picman_edit_extract().

	(picman_edit_paste,paste_as_new): no need to call
	picman_item_set_image() on newly created layers.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.c (floating_sel_attach): changed
	absolutely unclear comment.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_drop_drawable): use
	picman_item_convert() instead of picman_item_duplicate() to create
	the layer for the new image. Cleanup.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager.c (tile_manager_get_memsize): return a
	more exact result.

	* app/core/picmanimage-scale.[ch] (picman_image_scale_check): estimate
	the new memsize by separating parts of the image that are constant
	from parts that will scale. Also take undo logic into account.
	Return the estimated new memsize since it's not trivial to
	calculate.

	* app/gui/image-commands.c (image_scale_callback): use the memsize
	returned by picman_image_scale_check() for the warning message. Free
	allocated strings.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.h: changed PicmanImageScaleCheckType enum
	values to PICMAN_IMAGE_SCALE_*.

	* app/core/picmanimage-scale.c (picman_image_scale_check): return
	PICMAN_IMAGE_SCALE_TOO_BIG only if we are scaling up.

	* app/gui/image-commands.c: changed accordingly. Whitespace and
	indentation cleanup.

2003-12-09  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/spyropicman.scm: added missing parameter
	to picman-gradients-get-gradient-data call.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_list): iterate picman->images
	directly rather than building a (leaked) temp GList using
	picman_container_foreach(). Removed gimlist_cb() utility function.

	* app/pdb/image_cmds.c: regenerated.

2003-12-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.h: export enum PicmanRotationType to libpicman.

	* tools/pdbgen/pdb/image.pdb: added picman_image_rotate() PDB wrapper.

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanenums.h
	* libpicman/picmanimage_pdb.[ch]
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2003-12-08  Manish Singh  <yosh@picman.org>

	* Makefile.am
	* configure.in: added --disable-devel-docs, to skip the devel-docs
	dir entirely. Also, changed --enable-picmandir to --with-picmandir
	since that semantic makes more sense.

2003-12-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: marked picman_image_add_layer_mask()
	and picman_image_remove_layer_mask() as deprecated. Didnn't remove
	them from the PDB because the new functions' signature differs and
	they are used very often in scripts, but removed them from the
	libpicman C wrappers.

	* tools/pdbgen/pdb/layer.pdb: added picman_layer_add_mask() and
	picman_layer_remove_mask().

	* libpicman/picmancompat.h: added compat cruft.

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* libpicman/picmanexport.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/psd.c
	* plug-ins/pypicman/pypicman-image.c
	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/alien-neon-logo.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/carve-it.scm
	* plug-ins/script-fu/scripts/carved-logo.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/chrome-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/fade-outline.scm
	* plug-ins/script-fu/scripts/frosty-logo.scm
	* plug-ins/script-fu/scripts/image-structure.scm
	* plug-ins/script-fu/scripts/news-text.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/slide.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/speed-text.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/weave.scm
	* plug-ins/script-fu/scripts/xach-effect.scm
	* plug-ins/xjt/xjt.c: changed accordingly.

2003-12-08  Dave Neary  <bolsh@picman.org>

	* app/core/core-enums.h:
	* app/core/picmanimage-scale.[ch]: Added the PicmanImageScaleCheckType 
	enum and used it in picman_image_scale_check() which used to be
	picman_image_check_scaling().

	* app/gui/image_commands.c: Used the above when checking 
	scaling parameters to display a message if the image is too big 
	or too small after scaling. Closes bug #21028.

2003-12-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: renamed PDB function
	picman_image_active_drawable() to picman_image_get_active_drawable()
	so it's consistent with all other drawable getters.

	* app/pdb/procedural_db.c
	* libpicman/picmancompat.h: added compat stuff.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.[ch]: regenerated.

	* plug-ins/pypicman/pypicman-image.c
	* plug-ins/script-fu/scripts/add-bevel.scm
	* plug-ins/script-fu/scripts/carved-logo.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/round-corners.scm
	* plug-ins/script-fu/scripts/slide.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm: changed accordingly.

2003-12-08  Michael Natterer  <mitch@picman.org>

	Some PDB fixes/cosmetics before doing real changes again:

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/layer.pdb: changed order of generated functions
	to make more sense.

	* tools/pdbgen/pdb/misc_tools.pdb: doc cosmetics, removed unused
	subroutines.

	* tools/pdbgen/pdb/image.pdb: reordered generated functions as
	above, fixed resolution and unit accessors to use functions
	instead of setting gimage->foo directly, use &image_accessors()
	for the tattoo_state functions, cleanup.

	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]
	* libpicman/picmanmisctools_pdb.c: regenerated.

2003-12-08  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_load_thumb): don't
	scale the pixbuf, always return the pixbuf as loaded from disk.
	
	* app/core/picmanimagefile.c (picman_imagefile_get_description):
	return NULL when being asked for a description on a thumbnail
	without an image_uri.

2003-12-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandatafactory.c: code review / cleanup.

	* app/plug-in/plug-in.c
	* app/plug-in/plug-in-message.c: unified messages about plug-in
	errors. Changed lots of g_warning()s to g_message()s because
	g_warning() is for programming errors and the user should be
	informed that the plug-in was killed and did not simply crash.

2003-12-08  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumb-utils.[ch]: renamed a function, added
	another one.

	* libpicmanthumb/picmanthumb.def
	* libpicmanthumb/picmanthumbnail.c: changed accordingly.

2003-12-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: don't use "alias"es just to rename
	variables, they just clutter the code and there is no reason why
	e.g. a PicmanDisplay variable must be called "gdisp" instead of
	"display". Cleanup.

	* app/pdb/channel_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2003-12-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/fonts.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb: removed comments that
	picman_data_factory_data_init() should return a boolean indicating
	success, since it is highly unclear when to return FALSE. This
	function just always succeeds. Changed docs accordingly. Cleanup.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: minor cleanups.

	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/font_select_cmds.c
	* app/pdb/fonts_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* libpicman/picmanbrushes_pdb.c
	* libpicman/picmanfonts_pdb.c
	* libpicman/picmangradients_pdb.c
	* libpicman/picmanpalettes_pdb.c
	* libpicman/picmanpatterns_pdb.c: regenerated.

2003-12-08  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.24.
        (AC_CONFIG_FILES): added files in devel-docs/libpicmanthumb.

	* picman.spec.in: added files from libpicmanthumb.

2003-12-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmancroptool.c (picman_crop_tool_draw): an XOR line was
	being drawn twice; spotted by Marco Munari.

2003-12-08  Sven Neumann  <sven@picman.org>

	* Makefile.am (SUBDIRS): added libpicmanthumb.

	* libpicmanthumb/picmanthumb-utils.c
	* libpicmanthumb/picmanthumbnail.c: basic functionality is implemented
	and seems to be working.

	* app/Makefile.am: link the application against libpicmanthumb.

	* app/core/core-types.h: include libpicmanthumb/picmanthumb-types.h.

	* app/core/picmanimagefile.[ch]: removed thumbnail handling routines
	and use libpicmanthumb instead. Fixes bug #127914.

	* app/gui/file-open-dialog.c
	* app/widgets/picmandocumentview.c: changed accordingly.

2003-12-07  Dave Neary  <bolsh@picman.org>

	* NEWS: Updated.

2003-12-06  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_delete): fixed "success"
	return value.

	* app/pdb/image_cmds.c: regenerated.

2003-12-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp.c (picman_idle_help): cleanup.

2003-12-06  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-private.h: added "PicmanTattoo tattoo_state" to the
	XcfInfo struct.

	* app/xcf/xcf.c (xcf_load_invoker): initialize it to 0.

	* app/xcf/xcf-load.c (xcf_load_image_props): remember PROP_TATTOO
	in info->tattoo_state instead of setting it directly in the
	PicmanImage struct.

	(xcf_load_image): set the remembered tattoo_state after all items
	are created.

	(Fixes the regression that "open -> don't modify -> save" didn't
	result in 100% identical XCF files).

2003-12-05  Manish Singh  <yosh@picman.org>

	* plug-ins/common/gif.c: always compare using unsigned chars for 7bit
	ASCII check.

2003-12-05  Michael Natterer  <mitch@picman.org>

	* app/pdb/pdb-types.h: added enum PicmanPDBCompatMode which can
	be one of { OFF, ON, WARN }.

	* app/main.c: added --pdb-compat-mode command line option. Renamed
	--enable-stack-trace to --stack-trace-mode. Made default values of
	stack_trace_mode and pdb_compat_mode depend on PICMAN_MINOR_VERSION
	(default to compat ON and stack_trace NEVER for stable releases
	and to compat WARN and stack_trace ASK for unstable ones).

	* app/app_procs.[ch]: pass pdb_compat_mode to picman_new().

	* app/core/picman.[ch]: added pdb_compat_mode to the Picman struct
	and to picman_new().

	* app/pdb/procedural_db.c: leave the compat table empty for
	PICMAN_PDB_COMPAT_OFF.

	* app/plug-in/plug-in-message.c: warn when a deprecated procedure
	is called for PICMAN_PDB_COMPAT_WARN.

	* docs/picman-1.3.1.in: changed accordingly.

2003-12-05  Michael Natterer  <mitch@picman.org>

	Name all PDB procedures which deal with floating selections
	consistently:

	* tools/pdbgen/pdb/image.pdb: renamed
	picman_image_floating_selection() to picman_image_get_floating_sel().

	* libpicman/picmanlayer.h: removed picman_layer_is_floating_selection #define.

	* libpicman/picmancompat.h
	* app/pdb/procedural_db.c: added compat stuff.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.[ch]: regenerated.

	* plug-ins/common/curve_bend.c
	* plug-ins/common/film.c
	* plug-ins/common/rotate.c
	* plug-ins/pypicman/pypicman-image.c
	* plug-ins/xjt/xjt.c: changed accordingly.

2003-12-05  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def: updated.

2003-12-05  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.h
	* libpicman/picmanbrushmenu.h
	* libpicman/picmanbrushselect.[ch]
	* libpicman/picmanfontmenu.[ch]
	* libpicman/picmanfontselect.[ch]
	* libpicman/picmangradientmenu.h
	* libpicman/picmangradientselect.[ch]
	* libpicman/picmanmenu.h
	* libpicman/picmanmisc.[ch]
	* libpicman/picmanmiscui.[ch]
	* libpicman/picmanpatternmenu.h
	* libpicman/picmanpatternselect.[ch]
	* libpicman/picmanpixelrgn.[ch]
	* libpicman/picmanproceduraldb.c
	* libpicman/picmanselection.c
	* libpicman/picmantile.h
	* libpicman/picmantypes.h
	* libpicman/picmanui.h
	* libpicman/picmanuitypes.h
	* libpicman/libpicman-intl.h
	* libpicman/stdplugins-intl.h
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmandatafiles.c
	* libpicmanbase/picmanenv.c
	* libpicmanbase/picmanparasite.[ch]
	* libpicmanbase/picmanparasiteio.[ch]
	* libpicmanbase/picmansignal.[ch]
	* libpicmanbase/picmanutils.c
	* libpicmancolor/picmanadaptivesupersample.[ch]
	* libpicmancolor/picmanbilinear.[ch]
	* libpicmanmath/picmanmath.h
	* libpicmanmath/picmanmathtypes.h
	* libpicmanwidgets/picmanbutton.[ch]
	* libpicmanwidgets/picmanchainbutton.h
	* libpicmanwidgets/picmancolorarea.[ch]
	* libpicmanwidgets/picmancolornotebook.h
	* libpicmanwidgets/picmancolorscale.[ch]
	* libpicmanwidgets/picmancolorscales.h
	* libpicmanwidgets/picmancolorselect.h
	* libpicmanwidgets/picmanoffsetarea.h
	* libpicmanwidgets/picmanpixmap.[ch]: removed trailing whitespace.

2003-12-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: renamed picman_drawable_bytes() to
	picman_drawable_bpp() because all other libpicman API speak in terms
	of "bpp" too.

	* libpicman/picmandrawable.h: removed picman_drawable_bpp #define.

	* app/pdb/procedural_db.c
	* libpicman/picmancompat.h: added compat stuff.

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.[ch]: regenerated.

	* plug-ins/common/pix.c
	* plug-ins/common/psd_save.c: changed accordingly.

2003-12-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: removed picman_image_undo_*() functions...

	* tools/pdbgen/pdb/undo.pdb: ...and added them here. Renamed
	picman_undo_push_group_start,end() to
	picman_image_undo_group_start,end().

	* app/pdb/procedural_db.c
	* libpicman/picmancompat.h: added compat stuff for the old undo group API.

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/undo_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanundo_pdb.[ch]: regenerated.

	* plug-ins/common/align_layers.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/rotate.c
	* plug-ins/common/tile.c
	* plug-ins/common/zealouscrop.c
	* plug-ins/gfig/gfig.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/script-fu/scripts/*.scm: changed accordingly.

2003-12-05  Michael Natterer  <mitch@picman.org>

	Made 3rd party scripts work again after all that PDB function
	renaming:

	* app/core/picman.[ch]: added "GHashTable *procedural_compat_ht" to
	the Picman struct which maps old procedure names to new ones.
	Call new function procedural_db_init_procs() instead of
	internal_procs_init().

	* app/pdb/procedural_db.[ch]: create and destroy the new compat
	hash table. Added new function procedural_db_init_procs() which
	registers the internal procedures and fills the compat hash table.

	(procedural_db_execute): minor fixes.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_run): if
	the requested procedure was not found, try the compat table.

	* tools/pdbgen/pdb/procedural_db.pdb: made all PDB query
	procedures compat aware. For compat procedures, return help
	strings which declare the procedure as deprecated and tell
	the new name of the procedure. Cleanup.

	* app/pdb/procedural_db_cmds.c: regenerated.

2003-12-05  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/psd.c: PICMAN 1.3/2.0 needs its layer/channel
	names to be UTF8 or it fails wackily, so convert the strings from
	the PSD file to UTF8 instead of using them raw.

2003-12-05  Sven Neumann  <sven@picman.org>

	* app/gui/resize-dialog.c: added mnemonics.

2003-12-04  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c: made linked an attribute of
	PicmanDrawable.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/convert.pdb: renamed picman_convert_*() functions
	to picman_image_convert_*().

	* libpicman/picmanimage.[ch]: removed picman_image_convert_* #defines.

	* libpicman/picmancompat.h: added old stuff.

	* app/pdb/convert_cmds.c
	* libpicman/picmanconvert_pdb.[ch]: regenerated.

	* plug-ins/common/gifload.c
	* plug-ins/common/gih.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/winclipboard.c
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/fuzzyborder.scm
	* plug-ins/script-fu/scripts/picman-headers.scm
	* plug-ins/script-fu/scripts/picman-labels.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/spinning-globe.scm: changed accordingly.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/layer.pdb: renamed picman_layer_mask() to
	picman_layer_get_mask().

	* libpicman/picmanlayer.h: removed picman_layer_get_mask_id #define.

	* libpicman/picmancompat.h: added old stuff.

	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* libpicman/picmanexport.c
	* plug-ins/common/curve_bend.c
	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/script-fu/scripts/image-structure.scm
	* plug-ins/xjt/xjt.c: changed accordingly.

2003-12-04  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def: updated.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: renamed picman_drawable_image() to
	picman_drawable_get_image() for symmetry with
	picman_drawable_set_image().

	* libpicman/picmanchannel.h: removed picman_channel_get_image_id #define.
	* libpicman/picmandrawable.h: removed picman_drawable_image_id #define.
	* libpicman/picmanlayer.h:: removed picman_layer_get_image_id #define.

	* libpicman/picmancompat.h: added the old stuff here.

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.[ch]: regenerated.

	* libpicman/picmanmiscui.c
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/film.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/ps.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/warp.c
	* plug-ins/imagemap/imap_cmd_picman_guides.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/maze/maze.c
	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/rcm/rcm_misc.c
	* plug-ins/script-fu/scripts/addborder.scm
	* plug-ins/script-fu/scripts/carve-it.scm
	* plug-ins/script-fu/scripts/weave.scm: changed accordingly.

	* plug-ins/maze/maze.c: completely reindented.

	* plug-ins/script-fu/siod/trace.c: removed trailing whitespace.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-projection.c (picman_image_projection_allocate):
	optimized to reallocate the projection TileManager only if it does
	not match the required width, height and depth.

	* app/core/picmanimage.c (picman_image_size_changed): call
	picman_image_projection_allocate().

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo-push.c: removed calls to
	picman_image_projection_allocate(), since "size_changed" does it
	automatically now.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/dialog.c
	* plug-ins/helpbrowser/domain.[ch]
	* plug-ins/helpbrowser/uri.[ch]: cleanup & whitespace removal.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.h: removed unused "gint proj_level" from the
	PicmanImage struct.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c (lay_set_linked): made it
	compile again.

2003-12-04  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/layer.pdb: removed "linked" API...
	* tools/pdbgen/pdb/drawable.pdb: ...and added it here.

	* app/pdb/drawable_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* libpicman/picmancompat.h: added picman_layer_*_linked compat #defines.

	* plug-ins/xjt/xjt.c: changed accordingly.

2003-12-03  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-image.c
	* plug-ins/pypicman/pypicman-pdb.c
	* plug-ins/pypicman/pypicman-tile.c: some cosmetic changes to error
	messages.

	* plug-ins/pypicman/pypicman-drawable.c: accessors for name, tattoo, and
	visible live in the drawable class now, so layer and channel objects
	inherit it.

2003-12-03  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def: updated.

2003-12-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/pypicman/picmanmodule.c: follow change below.

2003-12-03  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: removed picman_layer_delete() and
	picman_channel_delete() PDB wrappers...

	* tools/pdbgen/pdb/drawable.pdb: ...added picman_drawable_delete().

	* libpicman/picmandrawable.[ch]: removed picman_drawable_delete()
	(having this function work on the PicmanDrawable wrapper and not on
	the drawable_id was more than questionable anyway).

	* libpicman/picmancompat.h: added picman_layer_delete and
	picman_channel_delete cruft #defines.

	* app/pdb/channel_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanchannel_pdb.[ch]
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* plug-ins/script-fu/scripts/add-bevel.scm
	* plug-ins/xjt/xjt.c: changed accordingly.

	* plug-ins/imagemap/imap_main.c: just removed the call to
	picman_channel_delete(), it was wrong anyway.

2003-12-03  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-tile.c: quick fix to make it build with the
	below. Real fix later.

2003-12-03  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: removed duplicated APIs for "name",
	"visible" and "tattoo"...

	* tools/pdbgen/pdb/drawable.pdb: ...and added them as drawable APIs.

	* libpicman/picmandrawable.[ch]: removed faked layer/channel
	polymorphisms, the functions are real drawable functions now.

	* libpicman/picmancompat.h: added the old cruft here.

	* app/pdb/channel_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanchannel_pdb.[ch]
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* libpicman/picmanexport.c
	* libpicman/picmanmenu.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/animoptimize.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gif.c
	* plug-ins/common/gih.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/mng.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c
	* plug-ins/xjt/xjt.c
	* plug-ins/gfig/gfig.c
	* plug-ins/script-fu/scripts/*.scm: changed accordingly.

2003-12-03  Jakub Steiner <jimmac@ximian.com>

	* data/patterns/Stripes1px.pat
	* data/patterns/Stripes2px.pat: rename to Stripes & Stripes Fine

2003-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/nlfilt.c: use G_MAXINT instead of a custom define.

2003-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animoptimize.c: resolved mnemonics conflict,
	removed warnings and cleaned up the code a bit.

2003-12-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/channel_mixer.c: changed float (de)serialization
	to use locale independent g_ascii_* functions (fixes bug #113901).
	Cleaned up the GUI a lot (scale entries and stuff). Some more
	general cleanup.

2003-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ccanalyze.c: use picman_memsize_to_string() to
	display the memory and file size of the image. Minor cleanups.

2003-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CML_explorer.c
	* plug-ins/common/channel_mixer.c: use g_file_test() instead of stat().

2003-12-02  Manish Singh  <yosh@picman.org>

	* plug-ins/common/channel_mixer.c: fix call to picman_dialog_run.

	* plug-ins/common/newsprint.c: remove GINT_POINTER definition hack,
	we always have it now.

2003-12-02  Manish Singh  <yosh@picman.org>

	* plug-ins/common/CML_explorer.c: fix save dialog handling.

2003-12-02  Manish Singh  <yosh@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/channel_mixer.c: Added channel mixer plugin.
	Needs some work still, notably the settings load/save handling.
	Addresses bug #113901.

2003-12-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: applied a modified version of a patch
	submitted by Andrey Kiselev. Implements loading of TIFF files with
	multiple pages (bug #66886).

2003-12-02  Jakub Steiner <jimmac@ximian.com>

	* data/patterns/Makefile.am
	* data/patterns/Stripes1px.pat
	* data/patterns/Stripes2px.pat: simple RGBA stripes patterns.
	  Very useful for the obligatory 'interlace' effect. can be done
	  with the grid plugin currently, but dragging a pattern is by
	  far the fastest.

2003-12-02  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/Makefile.am
	* libpicmanthumb/picmanthumb-error.[ch]: added new files that define the
	PICMAN_THUMB_ERROR domain.

	* libpicmanthumb/picmanthumb-utils.[ch]
	* libpicmanthumb/picmanthumb.h
	* libpicmanthumb/picmanthumbnail.[ch]: finalizing the API.

2003-12-01  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: some code cleanup I've done while
	looking at bug #128146.

2003-12-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: added a default implementation of
	PicmanImage::mode_changed() which reallocates the projection.

	* app/core/picmanimage-convert.c (picman_image_convert)
	* app/core/picmanimage-undo-push.c (undo_pop_image_type): removed
	explicit calls to picman_image_projection_allocate().

2003-12-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-flip.c (picman_image_flip): no need to
	reallocate the image's projection (the image size doesn't change
	when flipping).

2003-12-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.c (picman_colormap_adjustment_changed):
	quick fix for bug #128285. This widget should be redone.

2003-11-30  Sven Neumann  <sven@picman.org>

	* app/main.c: renamed remaining occurences of "use_mmx" to
	"use_cpu_accel".

	* app/paint-funcs/paint-funcs.[ch]: removed unused "use_mmx"
	parameter.

	* app/base/base.c: changed accordingly.

	* docs/picman-1.3.1.in: documented the changed command-line option.

2003-11-30  Helvetix Victorinox  <helvetix@picman.org>

	* configure.in: backed out inadvertant changes.

	* app/composite/picman-composite.c:
	* app/composite/picman-composite.h:
	* app/main.c:
	* app/base/base.c:

	Changed the existing command line option, --no-mmx to
	--no-cpu-accel and propogated the changes necessary to use that
	flag to turn OFF the use of CPU extensions using only the generic
	implementations in app/composite/picman-composite-generic.c

	Nota Bene: All of the previous picman 1.2 code is still available
	and is is enabled by setting the PICMAN_COMPOSITE environment
	variable to zero (PICMAN_COMPOSITE=0x0).  This causes only the 1.2
	code to be used and is helpful for regression testing of the newer
	picman-composite code.  Whether using the new code, or the old code
	there should be absolutely no visible differences.

	The newly renamed option --no-cpu-accel retains its previous
	semantic meaning with the old 1.2 code--turning OFF MMX
	optimisations.

2003-11-30  Sven Neumann  <sven@picman.org>

	* app/batch.c: removed the hack that used to call picman_exit() when
	the batch command matches "(picman-quit 0)". It shouldn't be needed.

	* tools/pdbgen/pdb/misc.pdb
	* app/core/picman.[ch]
	* app/gui/gui.c: renamed "kill_it" parameter to "force". We don't
	kill the application any longer; this option is just about whether
	to ask the user for confirmation or not.

	* app/pdb/misc_cmds.c: regenerated.

	* app/app_procs.c: cosmetics.

2003-11-30  Sven Neumann  <sven@picman.org>

	* app/batch.[ch]: renamed batch_init() to batch_run(). Install an
	Picman::exit handler while batch commands are executed. This handler
	simply calls exit(). Fixes bug #128199.

	* app/app_procs.c: changed accordingly. Removed remaining global
	variables.

2003-11-30  Michael Natterer  <mitch@picman.org>

	* app/paint/picman-paint.c (picman_paint_init): reordered
	PicmanDodgeBurn to the end of the paint info list so the paint tool
	menu in the stroke dialog has same order as the paint tools in the
	toolbox.

2003-11-29  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.c: set the default window type hint for
	docks to Normal.

	* plug-ins/sel2path/sel2path_adv_dialog.c: set the number of
	digits to the same value for all spinbuttons.

2003-11-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c: fix it properly. There's really no
	need to pass the same pointer twice.

2003-11-29  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/common/AlienMap.c: 
	* plug-ins/common/AlienMap2.c: added missing parameter to 
	dialog_response callback.

	* plug-ins/common/blur.c
	* plug-ins/common/randomize.c
	* plug-ins/FractalExplorer/Dialogs.c: fixes #124476 (Remove 
	non-existent URL's and e-mail addresses).

2003-11-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/Makefile.am
	* plug-ins/pypicman/plug-ins/py-slice.py: Added py-slice, a python
	version of perlotine.

2003-11-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c: applied a patch from Adam D. Moss
	that does some minor message cleanups (bug #128061).

2003-11-27  Dave Neary  <bolsh@picman.org>

	* autogen.sh: Return error code to controlling environment if one of 
	the commands we run fails. Makes autogen.sh && make work.

2003-11-27  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/ps.c (create_new_image): don't add the page
	number to the filename of the image corresponsing to the
	postscript file's first page. Enables thumbnail generation
	for PS files.

	Indented function prototypes.

	* app/file/file-open.c (file_open_with_proc_and_display): create a
	thumbnail of the opened image only if the image's uri matches the
	passed uri.

2003-11-27  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/animationplay.c (is_ms_tag): more
	s/toupper/g_ascii_toupper/.

	* plug-ins/common/gee_zoom.c: #include <stdlib.h> for abs().

2003-11-26  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/animoptimize.c: Quieten a couple of harmless
	warnings. See bug #66367.
 
2003-11-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c (load_set_size_callback): fixed SVG import
	preview for portrait SVG images.

2003-11-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c
	* plug-ins/common/animoptimize.c
	* plug-ins/common/gif.c
	* plug-ins/common/gih.c
	* plug-ins/common/pnm.c
	* plug-ins/common/xbm.c
	* plug-ins/flame/libifs.c
	* plug-ins/print/print.c
	* plug-ins/script-fu/siod/slib.c
	* plug-ins/script-fu/siod/sliba.c: don't include ctype.h, use
	g_ascii_* functions from GLib instead.

	* plug-ins/common/film.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gicon.c
	* plug-ins/common/gifload.c
	* plug-ins/common/hrz.c
	* plug-ins/common/pat.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/twain/twain.c
	* plug-ins/winsnap/winsnap.c: removed unused includes (mainly
	ctype.h).

2003-11-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/sel2path/sel2path.c (sel2path_response):
	gtk_widget_destroy() the dialog, not some NULL data pointer.

2003-11-26  Michael Natterer  <mitch@picman.org>

	* configure.in
	* plug-ins/script-fu/siod/Makefile.am
	* plug-ins/script-fu/siod/.cvsignore
	* plug-ins/script-fu/siod/regex.c
	* plug-ins/script-fu/siod/slib.c
	* plug-ins/script-fu/siod/sliba.c
	* plug-ins/script-fu/siod/trace.c
	* plug-ins/script-fu/siod/siod.h
	* plug-ins/script-fu/siod/siodp.h: added new directory for siod.

	* plug-ins/script-fu/Makefile.am
	* plug-ins/script-fu/interp_regex.c
	* plug-ins/script-fu/interp_slib.c
	* plug-ins/script-fu/interp_sliba.c
	* plug-ins/script-fu/interp_trace.c
	* plug-ins/script-fu/siod.h
	* plug-ins/script-fu/siodp.h: removed siod from here.

	* plug-ins/script-fu/script-fu-scripts.[ch]
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/siod-wrapper.c
	* tools/pdbgen/enumcode.pl: changed #includes accordingly.

	* plug-ins/script-fu/script-fu-constants.c: regenerated.
	
	* plug-ins/script-fu/script-fu-scripts.c (script_fu_error_msg):
	use siod-wrapper.c siod_get_error_msg() instead of accessing
	siod's global siod_err_msg variable directly.

2003-11-26  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/Makefile.am
	* libpicmanthumb/picmanthumb-enums.h
	* libpicmanthumb/picmanthumb-utils.[ch] 
	* libpicmanthumb/picmanthumbnail.[ch]: more changes, still unfinished.

2003-11-26  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: eek, it should be
	PICMAN_ADD_ALPHA_TRANSFER_MASK, not PICMAN_ADD_ALPHA_MASK_TRANSFER.

	* app/core/picmanlayer.c (picman_layer_create_mask): changed accordingly.

	* app/pdb/layer_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2003-11-26  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added enum values
	PICMAN_ADD_ALPHA_MASK_TRANSFER and PICMAN_UNDO_GROUP_LAYER_ADD_MASK.

	* app/core/picmanlayer.c (picman_layer_create_mask): applied patch
	from Pedro Gimeno which implements the new ADD_MASK type and
	added undo. Fixes bug #127930.

	* app/gui/layers-commands.c: push an undo group around layer mask
	creation & adding since the creation may change the layer now.

	* app/pdb/layer_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2003-11-26  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumb-utils.[ch]
	* libpicmanthumb/picmanthumbnail.[ch]: added save functionality. Still
	unfinished.

2003-11-26  Sven Neumann  <sven@picman.org>

	* Makefile.am: 
	* configure.in
	* picmanthumb-1.3.pc.in
	* libpicmanthumb/Makefile.am
	* libpicmanthumb/picmanthumb-enums.h
	* libpicmanthumb/picmanthumb-types.h
	* libpicmanthumb/picmanthumb.def
	* libpicmanthumb/picmanthumb.h
	* libpicmanthumb/picmanthumb-utils.[ch]
	* libpicmanthumb/picmanthumbnail.[ch]: added a first draft of
	libpicmanthumb. The API isn't final and the implementation is
	incomplete. It compiles but don't attempt to use it yet.

2003-11-25  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanlimits.h: added PICMAN_MAX_MEMSIZE, an arbitrary
	upper limit for memory sizes. It must be smaller than G_MAXDOUBLE
	since our memsize entry doesn't handle anything larger.

	* app/widgets/picmanpropwidgets.c (picman_prop_memsize_entry_new):
	check against PICMAN_MAX_MEMSIZE, not G_MAXDOUBLE.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c: use PICMAN_MAX_MEMSIZE instead of
	G_MAXULONG. The latter is larger than G_MAXDOUBLE on 64bit
	machines and caused bug #127908.
	
	* libpicmanwidgets/picmanmemsizeentry.c: added casts to guint64.

2003-11-25  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/interp_md5.[ch]: removed these unused files
	from CVS.

2003-11-25  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_scale_mask):
	invalidate the solid brush cache as well. Should fix #127681.

2003-11-25  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_UNDO_EVENT_UNDO_FREEZE
	and PICMAN_UNDO_EVENT_UNDO_THAW.

	* app/core/picmanimage.c: emit undo events in
	picman_image_undo_freeze() and picman_image_undo_thaw().

	* app/widgets/picmanundoeditor.c: made it aware of FREEZE/THAW signals
	and robust against evil stuff like freezing/thawing the undo
	in the middle of an open undo group. Fixes bug #124421.

	* plug-ins/script-fu/scripts/circuit.scm: push and undo group
	instead of disabling/enabling undo.

2003-11-25  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs.c (toplevel_entries): remember the size of the
	levels tool dialog. Fixes bug #127896.

2003-11-25  Sven Neumann  <sven@picman.org>

	* configure.in: applied a patch from Adrian Bunk that changes the
	function to look for when checking for lcms (bug #127893). Also
	added a warning when lcms is not found.

2003-11-25  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.[ch]
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c: some code cleanup (what a mess...).

2003-11-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.[ch]: removed picman_g_object_get_memsize()...

	* app/core/picman-utils.[ch]: ...and added it here along with
	some other memsize utilities for GHashTables and G(S)Lists.

	* app/core/picman.c
	* app/core/picmanimage.c
	* app/core/picmanparasitelist.c
	* app/core/picmanviewable.c
	* app/vectors/picmanstroke.c (PicmanObject::get_memsize): use the new
	functions.

2003-11-25  Dave Neary  <bolsh@picman.org>

	* libpicman/Makefile.am: Applied patch from deaddog@deaddog.org
	(Abel Cheung) to make sure dependencies are built before we build
	libpicman and libpicmanui. Fixes bug #127863.

2003-11-25  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/bmp/bmpread.c: fix for #126366 (bmp - wrong colors loaded)

2003-11-25  RaphaÃ«l Quinet  <quinet@gamers.org>

	* NEWS: Improved the spelling of my name (missing accents) and
	added a mention about animoptimize in the last release.

2003-11-24  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c: Repaired an oversight on
	  the application of hue/color/saturation/value on non-rgb images.
	  Fixes bug #127669

2003-11-24  Sven Neumann  <sven@picman.org>

	* configure.in: (hopefully) fixed the check for the symbol prefix.

2003-11-24  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Fixed path creation typo.

2003-11-24  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_destroy):
	set filter_idle_id to 0, not NULL.

2003-11-24  Michael Natterer  <mitch@picman.org>

	Fixed intra-session position management for file dialogs and newly
	created docks:

	* app/widgets/picmandockable.c (picman_dockable_detach)
	* app/gui/file-dialog-utils.c (file_dialog_new): don't call
	gtk_window_set_position() on session managed dialogs and docks.

	* app/widgets/picmandialogfactory.c (picman_dialog_factory_add_dialog):
	make sure new docks get GDK_HINT_USER_POS set so they remember
	their positions across hide/show.

	* app/widgets/picmandock.c: removed unused disabled code.

2003-11-24  Sven Neumann  <sven@picman.org>

	* Made 1.3.23 release.

2003-11-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-layer-select.c
	* app/widgets/picmantoolbox-indicator-area.c: use
	picman_preview_new_by_types() instead of just picman_preview_new() so
	the new preview code remembers the correct GType.

2003-11-24  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Added depedency for lcms

2003-11-23  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def: symbols changes by a patch from
	Michael Schumacher.

2003-11-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmandatafiles.[ch]
	* libpicmanbase/picmanenv.[ch]
	* libpicmanbase/picmanutils.c
	* libpicmanmodule/picmanmodule.[ch]
	* libpicmanmodule/picmanmoduledb.[ch]
	* libpicmanwidgets/picmancolordisplay.[ch]
	* libpicmanwidgets/picmancolordisplaystack.[ch]
	* libpicmanwidgets/picmancolorselection.[ch]
	* libpicmanwidgets/picmancolorselector.[ch]: use proper LibPICMAN headers.

2003-11-23  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]: made "enabled" an object
	property and removed the "enabled_changed" signal.

	* libpicmanwidgets/picmancolordisplaystack.c
	* app/widgets/picmancolordisplayeditor.c: connect to "notify::enabled"
	instead.

	* libpicmanwidgets/picmanwidgets.def: added new symbols.

2003-11-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]: added new signal
	"enabled_changed"...

	* libpicmanwidgets/picmancolordisplaystack.c: ...which enables optimizing
	away "changed" signals of disabled filters.

	* app/widgets/picmancolordisplayeditor.c: connect to "enabled_changed"
	instead of "changed" to update the toggle column.

2003-11-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplay.c (picman_color_display_clone):
	also clone the "enabled" property.

	* app/widgets/picmancolordisplayeditor.c
	(picman_color_display_editor_init): put the "enabled" toggle
	renderer to its own column so selecting a row doesn't always
	toggle "enabled".

2003-11-23  RaphaÃ«l Quinet  <quinet@gamers.org>

	* plug-ins/common/animoptimize.c: Allow the plug-in to register
	itself twice: once for the old mode (difference only) and once for
	the new mode that improves the 'combine' frames by trying to
	maximize the number of adjacent pixels of the same color.  This
	gives a better compression for GIF, MNG and other formats that
	work on a line-by-line basis (bug #66367).

2003-11-22  Henrik Brix Andersen  <brix@picman.org>

	* picman/app/core/picmanimage-snap.c: behave correctly for grid
	spacing of 1px, whitespace clean up. Fixes the grid part of bug
	#125864.

2003-11-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]: added API to
	enable/disable a filter. A disabled filter has no effect.

	* libpicmanmodule/picmanmodule.h: incremented PICMAN_MODULE_ABI_VERSION.

	* app/widgets/picmancolordisplayeditor.c: added a check column to
	the "Active Filters" tree view so the effect of all filters can
	quickly be toggled. Cleanup.

	* modules/cdisplay_colorblind.c: removed "none" from the enum and
	from the GUI because disabling a filter is implemented generically
	now.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: added mnemonics, cleanup.

2003-11-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgetsmarshal.list
	* libpicmanwidgets/picmancolordisplaystack.[ch]: added signals
	::added(), ::removed() and ::reordered() and emit them in the
	resp. functions.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancolordisplayeditor.[ch]: new widget implementing
	an editable view on a PicmanColorDisplayStack. Most code taken from
	below...

	* app/display/picmandisplayshell-filter-dialog.c: ...and removed
	here. Only creates a PicmanDialog around a PicmanColorDisplayEditor
	now.

2003-11-22  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (color_erase_inten_pixels): handle
	grayscale buffers (bug #127666).

2003-11-22  Sven Neumann  <sven@picman.org>

	Fixed some selection editor problems (bug #127644):

	* plug-ins/sel2path/sel2path.c: use the given image_ID, ignore the
	drawable_ID. This plug-in doesn't operate on a drawable at all.

	* plug-ins/imagemap/imap_main.c: pass a valid image_ID to sel2path.

	* app/gui/vectors-commands.c: don't attempt to create a valid
	drawable_ID for the call to sel2path since it isn't used anyway.

	* app/core/picmandrawable-stroke.c (picman_drawable_stroke_boundary):
	just return when being called with an empty boundary.

2003-11-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def: added symbols for
	PicmanColorDisplayStack.

2003-11-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_get_file_data): when constructing
	an URI list, don't add a newline character after the last item.

2003-11-22  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: let the templates editor expand.

2003-11-21  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplaystack.h: forgot to declare
	picman_color_display_stack_clone().

	* app/display/picmandisplayshell.[ch]: replaced the GList of
	PicmanColorDisplays by a single PicmanColorDisplayStack.

	* app/display/picmandisplayshell-render.c
	(picman_display_shell_render): changed accordingly.

	* app/display/picmandisplayshell-filter.[ch]: reduced API to a
	single function, picman_display_shell_filter_set(), which exchanges
	the whole filter stack. Idle update the display on
	PicmanColorDisplayStack::update().

	* app/display/picmandisplayshell-filter-dialog.[ch]: changed
	accordingly.  Return the created dialog instead of assigning
	shell->filters_dialog.

	* app/gui/view-commands.c (view_display_filters_cmd_callback): set
	shell->filters_dialog here and raise it it if already
	exists. Don't use the dialog factory to create it because it's a
	transient dialog for the display which does not need to be session
	managed.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: removed display filter dialog stuff.

2003-11-21  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmancolordisplaystack.[ch]: new object
	PicmanColorDisplayStack which manages a list of PicmanColorDisplays.
	(unfinished, just for others to look at).

2003-11-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/makefile.msc: s/picmanfileselection/picmanfileentry/ 

2003-11-21  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_proof.c: use a table to align the widgets.

2003-11-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-filter-dialog.c: create the Display
	Filter dialog transient for the display shell and destroy it with
	its parent.

2003-11-21  Henrik Brix Andersen  <brix@picman.org>

	* app/widgets/picmanhelp-ids.h
	* app/gui/preferences-dialog.c: changed "Window Manager" to
	"Window Management" and "Decorations" to "Window Type Hints"

	* themes/Default/images/preferences/window-manager.png: removed...

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/window-management.png: ... and
	added under a new name.

2003-11-21  Sven Neumann  <sven@picman.org>

	* configure.in: if lcms.h cannot be found, try lcms/lcms.h.

	* modules/cdisplay_proof.c: changed accordingly.

2003-11-21  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/window-manager.png: use
	  gnome2 icon for WM

2003-11-21  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: 
	* modules/cdisplay_gamma.c: 
	* modules/cdisplay_high_contrast.c: minor cleanup.

2003-11-21  Michael Natterer  <mitch@picman.org>

	* modules/cdisplay_proof.c: PicmanFileSelection -> PicmanFileEntry,
	cleanup.

2003-11-21  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanfileselection.[ch]: removed...

	* libpicmanwidgets/picmanfileentry.[ch]: ...and added under a new name.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanpatheditor.[ch]
	* app/widgets/picmanpropwidgets.c
	* plug-ins/script-fu/script-fu-scripts.c: changed accordingly.

	* libpicman/picmancompat.h: added compat #defines.

2003-11-21  Sven Neumann  <sven@picman.org>

	* configure.in: added a check for little cms.

	* modules/Makefile.am
	* modules/cdisplay_proof.c: added a color proof display filter
	module contributed by Banlu Kemiyatorn <id@project-ile.net>.

2003-11-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c: added #defines for the data keys used
	for g_object_set_data() and _get_data().

2003-11-21  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: added a "role" property.

	* app/widgets/picmantexteditor.c
	* app/widgets/picmanviewabledialog.c: use it instead of calling
	gtk_window_set_role().

2003-11-21  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_help_domains): argh, need to
	assign strings to (*array_retloc)[i], not just *array_retloc[i].
	Fixes passing of the list of help domains to the help browser.

2003-11-20  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/preferences-dialog.c
	* app/widgets/picmanhelp-ids.h: Added Window Manager tab exposing
	the window manager hint settings to the user, moved the
	activate-on-focus setting to this tab as well.

	* themes/Default/images/preferences/window-manager.png
	* themes/Default/images/preferences/Makefile.am: added empty
	placeholder for Window Manager preferences icon.

2003-11-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandock.c: reverted a small part of my last commit.
	It doesn't seem to be a good idea to unref the context in dispose().
	Do it in destroy() just like we used to do.

2003-11-20  Sven Neumann  <sven@picman.org>

	* app/gui/info-dialog.c (info_dialog_new_extended)
	* app/widgets/picmantooldialog.c (picman_tool_dialog_new): don't set
	the utility window type hint on info and tool dialogs. These are
	not persistent utility windows. See bug #115092.

2003-11-20  Sven Neumann  <sven@picman.org>

	* app/widgets/widgets-enums.[ch]: added PicmanWindowTypeHint enum.

	* app/widgets/picmanwidgets-utils.{ch]: added a utility function
	that translates PicmanWindowTypeHint to GdkWindowTypeHint.

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h: added two new picmanrc options that
	allow to configure which window type hint to set on the toolbox
	and on dock windows.

	* app/widgets/picmandock.[ch}: use the window type hint from picmanrc.
	Introduced construct properties and got rid of picman_dock_construct().

	* app/widgets/picmanimagedock.c
	* app/widgets/picmantoolbox.c: changed accordingly.

	* app/gui/preferences-dialog.c (prefs_dialog_new): let the Themes
	frame expand.

2003-11-20  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.c (picman_display_paint_area): when
	exposing the display, transform the update area using sub-pixel
	accuracy and floor()/ceil() the resulting area to make sure we
	always expose a *super*set of the dirtied area. Makes the code
	robust against sub-pixel differences between coordinate
	transformation and display scaling. Fixes bug #126942.

2003-11-20  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h: added a new picmanrc option
	"activate-on-focus" that allows to configure PICMAN to activate an
	image when the image window receives the focus. Useful for window
	managers using click-to-focus. Defaults to TRUE on OS_WIN32.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: implemented the new behaviour.
	Fixes bug #109527.

2003-11-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.[ch]: changed drag source stuff to allow
	multiple data types. Changed DND source API to speak in terms of
	add()/remove() instead of set()/unset(). Added PicmanDndDragFileFunc
	typedef and picman_dnd_file_source_add().

	Unfortunately GTK+'s DND API lacks symmetry here (no GtkTargetList
	based API for drag sources), so we cannot really change drag
	sources on-the-fly and need to set GtkTargetEntry arrays manually.

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmantoolbox-color-area.c: changed accordingly.

	* app/widgets/picmandocumentview.c: ditto. Additionally offer
	"text/uri-list" so it's possible to drag images from the document
	history to the file manager or browser.

2003-11-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c: cleanup before doing real changes.

2003-11-19  Manish Singh  <yosh@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_open_files): Display an error if we
	still can't convert a filename to a valid uri. Further addresses
	#127424.

2003-11-19  Manish Singh  <yosh@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_open_files): strstr on dnd_crap,
	not filename, since filename will be NULL in that case. Also remove
	doubled declaration of filename. Fixes #127424.

2003-11-19  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	shrink to the size of the monitor, not to the size of the screen
	(for Xinerama setups). Fixes bug #121796.

2003-11-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemfactory.c
	* app/widgets/picmanwidgets-utils.[ch]: moved the
	picman_menu_position() implementation that was used only from
	PicmanItemFactory to picmanitemfactory.c. Added a new function of the
	same name that positions a menu taking into account the monitor
	geometry and the render direction.

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: use picman_menu_position().

	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmanpreview-popup.c: let windows popup on the
	current monitor (for Xinerama setups).

2003-11-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.c
	(picman_layer_tree_view_paint_mode_menu_callback): compress
	successive layer mode undos just as we compress opacity undos.

2003-11-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_browse.c
	* plug-ins/imagemap/imap_file.c: GtkFileSelection cleanup:
	connect to "response" instead of accessing the "ok_button"
	and "cancel_button" members.

2003-11-19  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgetstypes.h: renamed "data" parameter
	of PicmanHelpFunc to "help_data".

	* libpicmanwidgets/picmanhelpui.c: cleanup. API doc fixes.

2003-11-19  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c (picman_context_finalize): don't disconnect
	picman_context_parent_notify() here. The signal will be disconnected
	automatically anyway.

2003-11-19  Sven Neumann  <sven@picman.org>

	* app/app_procs.c (app_run): register a log handler for the
	"Picman-Vectors" domain.

	* app/gui/stroke-dialog.c (stroke_dialog_new): attach the saved
	options to its parent, the user context, not to the picman.

2003-11-18  Sven Neumann  <sven@picman.org>

	* libpicmanmodule/picmanmodule.c (picman_module_open): don't do lazy
	binding on PICMAN modules. We can't recover from missing symbols
	later.

	* libpicmanwidgets/picmanquerybox.[ch]: renamed "help_page" parameter
	to "help_id" and changed the docs accordingly.

	* libpicmanwidgets/picmancolordisplay.[ch]
	* libpicmanwidgets/picmancolorselector.[ch]: renamed the "help_page"
	struct members of PicmanColorDisplay and PicmanColorSelector to
	"help_id".

	* app/gui/color-notebook.c
	* app/widgets/picmancoloreditor.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmancolornotebook.c
	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c
	* modules/*.c: changed accordingly. Specify a help id instead of
	a HTML page.

2003-11-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c (load_image): inform the user when a PNG
	file specifies an offset that causes the layer to be positioned
	outside the image area. Fixes "bug" #127307.

2003-11-18  Michael Natterer  <mitch@picman.org>

	* app/base/colorize.[ch]: changed the range of the "lightness"
	parameter to [-100..+100], where -100 results in pure black and
	+100 in pure white. Default to lightness == 0 so the initial
	transform changes just the colors while keeping the original
	lightness.

	* app/tools/picmancolorizetool.[ch]: changed accordingly. Reordered
	the scales to be in HSL order.

2003-11-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerpopup.[ch]
	* app/widgets/picmanviewablebutton.[ch]: let the button remember
	the popup's preview_size and view_type.

2003-11-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.[ch]
	(picman_dialog_factory_dialog_raise): support '|'-separated lists of
	dialog identifiers and raise any of them if it is already open, or
	the first dialog in the list otherwise.

	* app/gui/dialogs-commands.c (dialogs_create_dockable_cmd_callback):
	removed the same functionality here.

	* app/gui/edit-commands.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmantextoptions.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmantoolbox-indicator-area.c: pass lists of dialog
	identifiers to picman_dialog_factory_dialog_raise().

2003-11-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanselection.c (picman_selection_class_init): use
	PICMAN_STOCK_SELECTION as the viewable class' default stock ID.

	* app/widgets/picmanselectioneditor.c (picman_selection_editor_init):
	create the preview for PICMAN_TYPE_SELECTION, not just
	PICMAN_TYPE_DRAWABLE so the selection icon is used if the editor is
	empty.

2003-11-17  Michael Natterer  <mitch@picman.org>

	* app/gui/file-dialog-utils.[ch]
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradients-commands.c
	* app/gui/vectors-commands.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmantexteditor.c
	* libpicmanwidgets/picmanfileselection.c: don't access the "ok_button"
	and "cancel_button" members of GtkFileSelection. Instead, connect
	to GtkDialog::response(). Feels better and reduces code which
	depends on the to-be-deprecated GtkFileSelection. Changed border
	widths to match the 6px border width of other PICMAN dialogs.
	File selections in plug-ins will follow...

2003-11-17  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/color_enhance.c
	* plug-ins/common/c_astretch.c
	* plug-ins/common/gtm.c: removed potentionally offensive words +
	trailing whitespace. This fixes bug #125668.

2003-11-17  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.h (PICMAN_RGB_INTENSITY): removed the
	addition of 0.001 that isn't correct for use with integers (should
	be 0.5 then) and just plain wrong for use with floats/doubles.

	* app/base/temp-buf.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage.c
	* plug-ins/common/aa.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/newsprint.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/pagecurl/pagecurl.c: add 0.5 to the result of
	PICMAN_RGB_INTENSITY() in all places that use it with integers.

2003-11-17  Michael Natterer  <mitch@picman.org>

	* modules/colorsel_triangle.c (colorsel_triangle_update_previews): 
	s/INTENSITY/PICMAN_RGB_INTENSITY/, removed trailing whitespace.

2003-11-17  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.[ch]: added a PICMAN_RGB prefix to the
	INTENSITY macros.

	* libpicman/picmancompat.h: document this change here.

	* app/base/colorize.c
	* app/base/temp-buf.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage.c
	* plug-ins/common/aa.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/colorify.c
	* plug-ins/common/displace.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/oilify.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/pagecurl/pagecurl.c: changed accordingly.

	* libpicmancolor/picmancolor.h: removed trailing whitespace.

	* app/paint-funcs/paint-funcs.c: fixed indentation.

2003-11-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.[ch]: removed the unused PicmanViewable
	parameter from picman_viewable_calc_preview_size().

	* app/core/picmanbuffer.c
	* app/core/picmanimage-preview.c
	* app/core/picmanimagefile.c
	* app/core/picmanitem-preview.c
	* app/core/picmanundo.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmanpreviewrendererdrawable.c
	* app/widgets/picmanpreviewrendererimage.c: changed accordingly.

	* app/widgets/picmanpreviewrenderer.[ch]: store the viewable_type in
	the preview renderer and use its default stock_id if no viewable
	is set.

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmanundo.c: set a default stock_id.

2003-11-17  Manish Singh  <yosh@picman.org>

	* tools/picman-remote.c (picman_remote_find_window): search for the
	window role "picman-toolbox", since the app sets that instead of
	the class now.

2003-11-17  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_new): simplified.

	* app/core/picman.c (picman_dispose) (picman_finalize): print messages
	if being verbose.

2003-11-17  Sven Neumann  <sven@picman.org>

	* app/main.c: unref the picman object after dumping the
	configuration as a test for Picman::finalize.

	* app/base/base.[ch]: keep a reference on the config object.
	Renamed parameter "use_mmx" to "use_cpu_accel".

	* app/core/picman.[ch]: call base_init() and base_exit() from
	app_procs.c, not from the Picman object.

	* app/app_procs.[ch]: renamed app_init() to app_run() since here's
	where the main loop is run. Actually quit the main loop in
	app_exit_after_callback() instead of just calling exit().

	* app/errors.[ch]: declared fatal error handlers as G_GNUC_NORETURN.

	* libpicman/picman.h: fixed usage of G_GNUC_NORETURN.
	
2003-11-16  Henrik Brix Andersen  <brix@picman.org>

	* app/config/picmanguiconfig.c (DEFAULT_WEB_BROWSER): changed
	DEFAULT_WEB_BROWSER to "mozilla %s"

	* plug-ins/common/webbrowser.c (browser_open_url): quote the url
	here instead

2003-11-16  Michael Natterer  <mitch@picman.org>

	* app/main.c (main): call units_init() before picman_config_dump().

2003-11-16  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins.c: disabled debugging output.

2003-11-16  Sven Neumann  <sven@picman.org>

	* app/gui/themes.c (themes_apply_theme): removed an unused
	variable and trailing whitespace.

	* app/widgets/picmanpropwidgets.c (picman_prop_adjustment_notify):
	fixed a cut'n'paste error and added a warning which would have
	caught it.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c: cosmetics.

2003-11-16  Hans Breuer  <hans@breuer.org>

	* **makefile.msc: updated

	* app/config/picmanconfig-dump.c: include picmanwin32-io.h

	* app/plug-in/plug-ins.c: don't depend on g_print handling %s with
	NULL pointers, it doesn't anymore with glib cvs at least not on
	win32

	* app/widgets/picmanpropwidgets.c
	* libpicmanbase/picmanutils.c 
	* libpicmanwidgets/picmanmemsizeentry.c:	
	sorry about the mess, need to work-around a stupid compiler not
	able to cast from guint64 to double

	* app/widgets/picmanpropwidgets.c (picman_prop_memsize_entry_new) :
	avoid 'overflow in floating-point constant arithmetic' by disabling
	an imho alays questionable g_return_val_if_fail() for _MSC_VER only

	* libpicmanmodule/picmanmodule.def: sorted

	* libpicmanwidgets/picmanfileselection.c: removed unused S_ISDIR 
	definition

	* app/gui/themes.c: filenames in rc files need to be escaped
	
2003-11-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectselecttool.c
	(picman_rect_select_tool_button_release): remove unused variables.

2003-11-16  Michael Natterer  <mitch@picman.org>

	* configure.in
	* themes/Makefile.am
	* themes/Small/.cvsignore
	* themes/Small/Makefile.am
	* themes/Small/gtkrc: added a "Small" theme so users don't have to
	edit their ~/.picman-1.3/gtkrc to get the smaller look.

	* app/widgets/picmandock.c: use "picman-dock-separator", not just
	"dock-separator" as widget name.

	* etc/gtkrc: changed accordingly. Removed small style since it is
	a theme now. Cleanup.

2003-11-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: fixed the default gamma value which I
	broke with my recent change (see bug #120031).

2003-11-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanbaseconfig.h
	* app/config/picmancoreconfig.h: use gint64 for all memsize properties.

	* app/base/tile-manager.[ch] (tile_manager_get_memsize): since
	tiles can be swapped out, a tilemanager can be larger than gsize
	(on 32bit platforms). Use a gint64 to avoid an overflow.

	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmanchannel.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandata.c
	* app/core/picmandatafactory.c
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage-undo.[ch]
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/core/picmanitemundo.[ch]
	* app/core/picmanlayer.c
	* app/core/picmanlist.c
	* app/core/picmanobject.[ch]
	* app/core/picmanpalette.c
	* app/core/picmanparasitelist.c
	* app/core/picmanpattern.c
	* app/core/picmanundo.[ch]
	* app/core/picmanundostack.c
	* app/core/picmanviewable.c
	* app/text/picmantext.c
	* app/text/picmantextlayer.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors.c: use gint64 for picman_object_get_memsize()
	and all its implementations.

	* app/display/picmandisplayshell-title.c
	* app/gui/info-window.c: changed accordingly.

2003-11-16  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/Makefile.am: added libpicmanbase variable definition
	so the below works.

2003-11-16  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am (libpicmanwidgets_1_3_la_LIBADD): added
	libpicmanbase since libpicmanwidgets now depends on it.

2003-11-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.[ch]: exposed picman_object_name_free() and
	added documentation.

	* app/core/picmanlist.[ch] (picman_list_uniquefy_name): use
	picman_object_name_free() when changing the object name silently.
	Renamed "use_set_name" parameter to "notify" and documented the
	function.

2003-11-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.c: fixed a bad oversight in the
	implementation of normalized object names. Introduced the helper
	function picman_object_name_free() that takes care of freeing
	the normalized name. Fixes bug #127075.

2003-11-16  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.c
	* app/gui/images-commands.[ch]
	* app/widgets/picmanimageview.[ch]: implemented the "Raise Displays"
	button's functionality. Fixes bug #127079.

2003-11-15  Daniel Rogers  <daniel@phasevelocity.org>

	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanrectselecttool.[ch]: Includes changes from Sven.
        Fixes a bug with alt-draging ellipse and rect selections
        on small pixel areas.
					
2002-11-16  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanunit.c: doc fixes.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.def
	* libpicmanbase/picmanbase.def: updated for unit changes.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase-private.[ch]
	* libpicmanbase/picmanunit.c: new files implementing PicmanUnitVTable
	(formerly known as PicmanWidgetsVTable). Now the unit functions
	finally live in the same library as their header declarations.

	* libpicmanbase/picmanunit.h: removed comment about being a header for
	two different files.

	* libpicmanwidgets/picmanwidgets-private.[ch]: removed
	PicmanWidgetsVTable.

	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c
	* libpicmanwidgets/picmanwidgets.c: use normal picman_unit functions
	again.

	* libpicman/picmanui.c
	* app/gui/gui.c: removed PicmanWidgetVTable stuff.

	* libpicman/Makefile.am
	* libpicman/picmanunitcache.[ch]: new files.

	* libpicman/picmanunit.c: removed (moved to picmanunitcache.c).

	* libpicman/picman.c (picman_main): initialize PicmanUnitVTable using the
	picman_unit_cache functions.

	* app/Makefile.am
	* app/units.[ch]: new files implementing PicmanUnitVTable.

	* app/libpicman_glue.[ch]: removed.

	* app/app_procs.[ch]: made "the_picman" a static variable. Call
	units_init().

	* app/main.c: changed accordingly.

2003-11-15  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def
	* libpicmancolor/picmancolor.def
	* libpicmanwdidgets/picmanwidgets.def: updated based on a patch from
	Michael Schumacher.

2003-11-15  Sven Neumann  <sven@picman.org>

	* app/config/gimcoreconfig.[ch]	
	* app/plug-in/plug-in-run.c (plug_in_run): removed references to the
	unused gamma value. If we ever implement proper gamma correction, we
	will need individual gamma values for each channel anyway.

2003-11-15  Sven Neumann  <sven@picman.org>

	* libpicman/picmanui.c (picman_ui_init): reverted Yosh's change and
	removed the call to gtk_preview_set_gamma() instead. The gamma
	value isn't used anywhere else so it would only be confusing to
	use it on plug-in previews.

2003-11-15  Manish Singh  <yosh@picman.org>

	* libpicman/picmanui.c: and #undef GTK_DISABLE_DEPRECATED, for
	gtk_preview_set_gamma declaration.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* app/gui/themes.c (themes_get_theme_file): new utility function
	which takes a filename relative to the theme's root directory and
	returns the absolute path to the file in the current theme. It
	falls back to the resp. path in the default theme if the given
	file is not present in the current theme.

	* app/gui/preferences-dialog.c (prefs_notebook_append_page): use it.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanexport.[ch]: added new export capabilities
	PICMAN_EXPORT_CAN_HANDLE_BITMAP and _CAN_HANDLE_LAYER_MASKS and
	export the image accordingly. Code cleanup.

	* plug-ins/common/xbm.c (run): replaced _CAN_HANDLE_INDEXED by
	_CAN_HANDLE_BITMAP. Fixes bug #65788.

	* plug-ins/common/psd_save.c (run): added export stuff so
	layer masks are applied before saving. Fixes bug #119732.

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: link psd_save against GTK+
	and libpicmanui.

2003-11-15  Henrik Brix Andersen  <brix@picman.org>

	* libpicmanmath/picmanmatrix.c (picman_matrix4_to_deg): added an inline
	gtk-doc stub. Someone please fill this in...

	* libpicmanmath/picmanvector.[ch]: reordered the functions in a more
	logical way, touched up the inline gtk-docs

2003-11-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gih.c (gih_load_one_brush): add an alpha channel
	to grayscale layers created from brush pipes.

2003-11-15  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.c (picman_canvas_gc_new): no need to set
	colors on the GCs that use GDK_INVERT.

	* app/display/picmandisplayshell-render.c (picman_display_shell_render):
	micro cleanup.

2003-11-15  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: include <errno.h>.

2003-11-15  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanunitmenu.c: include the documentation of the
	format string in the gtk-doc comment.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/animoptimize.c
	* plug-ins/common/bz2.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/dicom.c
	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c
	* plug-ins/common/gih.c
	* plug-ins/common/grid.c
	* plug-ins/common/gtm.c
	* plug-ins/common/gz.c
	* plug-ins/common/hrz.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/mail.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/pat.c
	* plug-ins/common/pcx.c
	* plug-ins/common/pix.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/ps.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/sunras.c
	* plug-ins/common/svg.c
	* plug-ins/common/tga.c
	* plug-ins/common/tiff.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xwd.c
	* plug-ins/faxg3/faxg3.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/ppmtool.c
	* plug-ins/helpbrowser/domain.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/sgi/sgi.c
	* plug-ins/twain/twain.c
	* plug-ins/winsnap/winsnap.c
	* plug-ins/xjt/xjt.c: removed explicit newlines from messages.
	Made file open/save messages the same all over the place. Reduced
	number of translatable strings by adding some more "standard"
	messages. Removed plug-in names from messages. Added some random
	mnemonics. Unmarked some strings for translation and added some
	that were forgotten. General message cleanup. Removed trailing
	whitespace.

2003-11-15  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: readded a toggle for
	"confirm-on-close" that seems to have been lost some day.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.c: removed newlines from messages,
	removed trailing whitespace.

	* libpicmanmodule/picmanmoduledb.c: removed trailing whitespace.

	* libpicmanwidgets/picmancolorbutton.c: added mnemonics to the
	button's popup menu.

	* app/display/picmandisplayshell.c (picman_display_shell_new): added
	mnemonics to the padding button's additional menu items.

2003-11-15  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/Makefile.am: moved the definition of the symbol prefix to
	the configure script. Set it to '_' for MacOS X and Win32.

	* libpicmanwidgets/picmanwidgets.[ch]: removed the deprecation guards
	again. It doesn't make sense to deprecate these function now.

2003-11-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c: use picman_dialog_new() and connect to
	"response".

2003-11-15  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/screenshot.c: added an optional time out before
	selecting the window to be grabbed. This fixes bug #121783.

2003-11-14  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: add
	picman_int_option_menu_set_sensitive and picman_int_radio_group_set_active,
	tweak docs.

	* app/gui/convert-dialog.c
	* app/gui/layers-commands.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmantexteditor.c: use them.

2003-11-15  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectoroptions.[ch]: Since PicmanVectorTool is no
	PicmanSelectionTool, it does not make sense to have
	PicmanSelectionOptions for it.

	* app/tools/picmanvectoroptions.c
	* app/tools/picmanvectortool.c: Connect the Buttons to the
	Help system and make the to-selection Button modifier
	aware.

2003-11-14  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: guard old functions using
	PICMAN_DISABLE_DEPRECATED. Added a note to the docs what functions
	should be used instead.

2003-11-14  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: add picman_int_option_menu_set_history
	as a wrapper for picman_option_menu_set_history.

	* app/gui/brush-select.c
	* app/gui/resize-dialog.c
	* app/tools/picmancurvestool.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmancolorframe.c
	* libpicmanwidgets/picmanmemsizeentry.c
	* modules/cdisplay_colorblind.c: use the above.

2003-11-14  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: implemented picman_int_option_menu_new
	and picman_int_radio_group_new, which are the same as
	picman_option_menu_new2 and picman_radio_group_new2, but they take
	integers as values to map instead of gpointers, which avoids casts
	in pretty much all uses of it in the tree.

	* app/gui/image-commands.c
	* app/gui/offset-dialog.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmanwidgets-constructors.c
	* libpicmanwidgets/picmanmemsizeentry.c
	* modules/cdisplay_colorblind.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/blinds.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/deinterlace.c
	* plug-ins/common/edge.c
	* plug-ins/common/emboss.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/gif.c
	* plug-ins/common/hot.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/lic.c
	* plug-ins/common/mail.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/mblur.c
	* plug-ins/common/mng.c
	* plug-ins/common/mosaic.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/papertile.c
	* plug-ins/common/pnm.c
	* plug-ins/common/ps.c
	* plug-ins/common/psp.c
	* plug-ins/common/ripple.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/struc.c
	* plug-ins/common/sunras.c
	* plug-ins/common/tiff.c
	* plug-ins/common/waves.c
	* plug-ins/common/wind.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/color.c
	* plug-ins/picmanressionist/orientmap.c
	* plug-ins/picmanressionist/placement.c
	* plug-ins/maze/maze_face.c
	* plug-ins/sgi/sgi.c: Use picman_int_option_menu_new and
	picman_int_radio_group_new.

	* plug-ins/common/CML_explorer.c: make function_graph_new take a
	gpointer *data instead of a gpointer data, and properly pass an
	int through it.

	* plug-ins/common/mng.c: mark menu strings for translation.

	* plug-ins/rcm/rcm.c: remove initialization for Success member
	in RcmParams, since it's gone now.

2003-11-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemtreeview.c: introduced utility function
	picman_item_tree_view_toggle_clicked() and use it for the eye and
	the chain toggles so both show the same behaviour when being
	Shift-clicked.

2003-11-14  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-utils.c
	* app/gui/themes.c: use standard file error message strings.
	Removes two more translatable strings.

2003-11-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c (picman_brush_load_brush): fixed order of
	parameters after message change.

2003-11-14  Sven Neumann  <sven@picman.org>

	* app/gui/info-dialog.c (info_dialog_popup): use gtk_window_present().
	Fixes bug #126941.

2003-11-14  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanquerybox.c
	* app/widgets/picmanwidgets-utils.c: configure the labels in the
	message dialog and the query boxes to do automatic word wrapping
	to be HIG compliant.

	* app/app_procs.c
	* app/batch.c
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-path.c
	* app/config/picmanconfig-utils.c
	* app/config/picmanconfigwriter.c
	* app/config/picmanscanner.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandatafactory.c
	* app/core/picmangradient.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage.c
	* app/core/picmanimagefile.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmanselection.c
	* app/display/picmandisplayshell.c
	* app/file/file-utils.c
	* app/gui/brush-select.c
	* app/gui/dialogs-commands.c
	* app/gui/drawable-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/font-select.c
	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/palette-select.c
	* app/gui/palettes-commands.c
	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c
	* app/gui/select-commands.c
	* app/gui/stroke-dialog.c
	* app/gui/tool-options-menu.c
	* app/gui/vectors-commands.c
	* app/gui/view-commands.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins.c
	* app/text/picmantextlayer-xcf.c
	* app/text/picmantextlayer.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmantransformtool.c
	* app/vectors/picmanvectors-export.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmantemplateview.c
	* app/widgets/picmantooloptionseditor.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/image.pdb: removed explicit newlines from
	messages. Reduced number of translatable strings by making many
	file error messages the same. Quote single words and filenames
	with 'foo', not "foo". Replaced some more "drawable" by "layer".
	General message cleanup and consistency check.

	* app/pdb/image_cmds.c: regenerated.

2003-11-14  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h (CAN_CHANGE_ACCELS_BLURB): applied
	(a slightly modified version) of a patch from Joao S. O. Bueno
	(bug #126966).

2003-11-14  Sven Neumann  <sven@picman.org>

	* app/config/picmanscanner.c	
	* app/config/picmanconfig-deserialize.c: configured the scanner to
	use 64bit integers. This means you must now access value.v_int64
	instead of value.v_int. Fortunately picman_scanner_parse_int() hides
	this ugly detail from you.

	* app/config/picmanconfig-params.[ch]
	* app/config/picmanconfig-types.c: derive PicmanMemsize from guint64
	now that support for 64bit integers is guaranteed by glib.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.[ch]
	* app/widgets/picmanpropwidgets.c: changed accordingly.

	* app/gui/preferences-dialog.c: changed a label.

2003-11-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandevices.c: code review & cleanup.

2003-11-14  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanmemsizeentry.[ch]: changed to use guint64
	instead of gulong.

	* app/core/picmantemplate.c (picman_template_notify): removed unused
	variable.

2003-11-14  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.[ch] (picman_memsize_to_string): take a
	guint64 parameter and handle values beyond a gigabyte.

	* app/core/picmantemplate.[ch]: use a guint64 for the initial memory
	size and removed the gboolean that used to indicate a gulong
	overflow.

	* app/widgets/picmantemplateeditor.[ch]: changed accordingly.

	* app/gui/file-new-dialog.c: don't set the OK button insensitive
	when the initial memory size exceeds GULONG_MAX.

	* app/widgets/picmansessioninfo.c (picman_session_info_deserialize):
	replaced a misleading comment.

2003-11-14  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectoroptions.c: Add two buttons to the
	Tool Options

	* app/tools/picmanvectortool.c: Use them for stroking a path
	and converting a path to a selection, to make this functionality
	more obvious.

2003-11-13  Michael Natterer  <mitch@picman.org>

	* autogen.sh: removed "--copy" from the call to libtoolize.

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansessioninfo.c: only save the screen number to
	the sessionrc if the screen is not the default screen.

2003-11-13  Michael Natterer  <mitch@picman.org>

	* app/gui/info-window.c: added number of layers and size in
	memory.  Changed pixel and unit size labels to "Pixel Dimensions"
	and "Print Size" to be consistent with the scale dialog.
	Fixes two issues of bug #86276.

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansessioninfo.c (picman_session_info_deserialize): 
	restore compatibility with older sessionrc format. No need to
	break everyone's sessionrc again.

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_unknown)
	(picman_config_deserialize_property): unset the scanner scope to
	avoid identifiers that match symbol names to be parsed as symbols.

2003-11-13  Michael Natterer  <mitch@picman.org>

	Made session management multiscreen aware:

	* app/widgets/picmansessioninfo.[ch]: added "gint screen" member
	to struct PicmanSessionInfo.

	(picman_session_info_get_geometry): ask the window for its screen.
	(picman_session_info_restore): place the window on the remembered
	screen if the screen exists.

	(picman_session_info_save)
	(picman_session_info_deserialize): extended "open-on-exit" property
	to include the screen number (e.g. "(open-on-exit 1)" for screen 1).

	This change breaks everybody's sessionrc again...

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/gui/color-history.[ch]
	* app/gui/gui.c
	* app/gui/session.c: moved the color history out of the sessionrc
	into it's own little file called colorrc.

2003-11-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderer.[ch]: multihead fix: added
	picman_preview_renderer_unrealize() which destroys the cached
	GdkGC. This function must be called whenever the widget owning the
	renderer is unrealized.

	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanpreview.c: implement GtkWidget::unrealize() and
	call picman_preview_renderer_unrealize() on all renderers.

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]
	* app/main.c
	* app/core/picman.[ch]
	* app/gui/gui.c
	* app/gui/session.[ch]: allow to pass a session name on the
	command-line. This causes a different sessionrc to be used. This
	is a bit hackish but our power users will probably love it.
	Also removed the useless --restore-session command-line option.

	* docs/picman-1.3.1.in: changed accordingly.

	* app/core/picmanmarshal.list: removed obsolete marshaller.

	* app/config/picmanrc.c (picman_rc_new): improved gtk-doc comment.

2003-11-13  Sven Neumann  <sven@picman.org>

	* app/gui/stroke-dialog.c: remember the stroke settings in a less
	hackish way.

2003-11-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_layer): when trying to
	activate the previously selected layer after a layer removal, also
	look at gimage->layer_stack, just as picman_image_remove_layer()
	does. Should fix regression from 1.2 when there was no avtive
	layer after certain undo operations. Fixes bug #126781.
	Reordered instructions to match picman_image_remove_layer().

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: although the crash triggering bug
	is fixed, the image_map tools should not crash when invoked
	without active drawable: changed all _initialize() functions to
	silently return if there is no active drawable.

	Changed "drawable" to "layer" in all user visible warnings about
	indexed or non-RGB drawables. Cleanup.

2003-11-13  Simon Budig  <simon@picman.org>

	* app/core/picmandrawable-stroke.c: removed erraneous offset by
	0.5 pixels.

	* app/core/picmanstrokeoptions.c: Adjusted default width of libart
	strokes so that a rectangular selection gets stroked with sharp
	edges.

2003-11-12  Henrik Brix Andersen  <brix@picman.org>

	* app/widgets/picmanhelp.c
	* app/config/picmanguiconfig.c
	* app/widgets/widgets-enums.[ch] changed
	PICMAN_HELP_BROWSER_WEBBROWSER to PICMAN_HELP_BROWSER_WEB_BROWSER and
	changed all occurrences of webbrowser to web_browser for
	consistency.

2003-11-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanmemsizeentry.c: fixed a problem with the
	value being clamped to wrong boundaries when setting the value
	prorammatically.

2003-11-12  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanquerybox.c (create_query_box): set proper
	alignments for the GtkImage and GtkLabel of the query_box.

2003-11-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c: set the boundaries for the
	coordinates widget from the property limits.

	* app/widgets/picmangrideditor.c: removed the explicit calls to
	picman_size_entry_set_refval_boundaries().

2003-11-12  Sven Neumann  <sven@picman.org>

	* app/gui/color-history.[ch]: changed COLOR_HISTORY_SIZE to 12 to
	reduce the minimum size of the color selector dialog.

	* app/gui/color-notebook.c (color_notebook_new): changed the
	dialog setup to not depend on COLOR_HISTORY_SIZE being 16.

2003-11-12  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanhelp-ids.h: replaced the last few html help
	links in app/ by help IDs.

2003-11-12  Michael Natterer  <mitch@picman.org>

	Use the correct GTK+ APIs for setting and changing the theme:

	* app/gui/themes.c (themes_apply_theme): don't call gtk_rc_parse()
	but write a new config file "~/.picman-1.3/themerc" which includes
	both the theme's and the user's gtkrc files.

	(themes_init): use gtk_rc_add_default_file() to make themerc known
	to GTK+.

	(themes_theme_change_notify): don't fiddle with toplevel windows
	manually but simply call gtk_rc_reparse_all() after writing the
	new themerc.

	* libpicman/picmanui.c (picman_ui_init): use gtk_rc_add_default_file()
	instead of gtk_rc_parse().

	* app/gui/preferences-dialog.c: cleaned up / beautified the theme
	selector. Added a "Reload Current Theme" button. Simplified
	GtkTreeView column inserting all over the place.

	(prefs_response): destroy the preferences dialog later so we don't
	crash when cancelling a theme change on "Cancel" (workaround for
	bug #126808).

	* app/gui/module-browser.c (module_browser_new): column inserting
	simplification.

2003-11-12  Sven Neumann  <sven@picman.org>

	* app/gui/color-notebook.c (color_notebook_new): added a default
	role used for color selectors not handled by PicmanDialogFactory.
	Fixes bug #126783.

2003-11-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmaneditor.[ch] (picman_editor_set_box_style): new
	utility function which sets a button box' style according to a
	PicmanEditor's style properties.

	* app/widgets/picmancoloreditor.c (picman_color_editor_style_set)
	* app/widgets/picmaneditor.c (picman_editor_style_set): use it.

2003-11-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancoloreditor.c: implement GtkWidget::style_set()
	and update the button box spacing and icons sizes accordingly.

2003-11-12  Michael Natterer  <mitch@picman.org>

	* app/gui/themes.[ch]: split out function themes_apply_theme()
	from themes_init(). Connect to "notify::theme" of picman->config and
	change the theme in the callback. Added themes_list_themes().
	Added "const gchar *theme_name" parameter to
	themes_get_theme_dir().

	* app/gui/gui-vtable.c (gui_get_theme_dir): changed accordingly.

	* app/gui/preferences-dialog.c (prefs_dialog_create): enabled
	theme selection on the "Interface" page. Still has many issues
	(like using a conceptually wrong method of theme changing ;-)
	but it won't get fixed if we cannot change themes on the fly...

2003-11-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.c (picman_data_editor_save_dirty):
	return early if the PicmanData is not dirty.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.c: added API docs for the less obvious
	functions. Gracefully handle attempts to draw on the unrealized
	widget.

	* app/display/picmandisplayshell-selection.c (selection_draw):
	removed the redundant check for a realized canvas widget.

2003-11-11  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gfig/gfig-preview.[ch]
	* plug-ins/gfig/gfig-grid.[ch]: new files.
	
	* plug-ins/gfig/Makefile.am: changed accordingly.

	* plug-ins/gfig/gfig.[ch]: moved preview and grid code to their own
	file.

2003-11-11  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolornotebook.c
	* libpicmanwidgets/picmancolorselection.c
	* libpicmanwidgets/picmandialog.c: minor cleanup, API docs.

2003-11-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: set color buttons to
	continuous update. Minor code cleanup.

2003-11-11  Dave Neary  <bolsh@picman.org>

	* app/widgets/picmandataeditor.c: Save data before disposing of 
	it when closing the dialog. Closes bug #116606.

2003-11-11  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.[ch] (picman_dialog_run): new function
	which does the same as gtk_dialog_run() except it does not make
	the dialog modal.

	* app/gui/resolution-calibrate-dialog.c
	* libpicman/picmanexport.c
	* plug-ins/*/*.c: use picman_dialog_run() instead of gtk_dialog_run().

	* plug-ins/common/grid.c: set update_continuous to TRUE for
	the PicmanColorButtons so this feature gets some testing.

2003-11-11  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorbutton.[ch]: added new API
	picman_color_button_[get|set]_update() which configures the button
	to emit "color_changed" continuously while the color in the color
	selection dialog is being changed. Fixes bug #90091.

	Renamed PicmanColorButton struct member
	"GtkItemFactory *item_factory" to a /*< private >*/ member named
	"gpointer popup_menu". This is ugly but fixes bug #125115,

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c
	* app/widgets/picmancolorpanel.c: changed accordingly.

	* libpicmanwidgets/picmancolorbutton.c: use a PicmanColorSelection
	with a handmade PicmanDialog instead of GtkColorSelectionDialog.

	Enabled module loading for plug-ins so the color selection
	can show the color selectors which are implemented in modules:

	* libpicmanwidgets/picmanwidgets-private.[ch]: added
	PicmanEnsureModulesFunc which can be called by modules users.

	* app/gui/gui.c (gui_libs_init): pass NULL as
	PicmanEnsureModulesFunc since the core loads the modules itself.

	* libpicman/picmanui.c (picman_ui_init): pass new private function
	picman_ensure_modules() which will load the modules upon first
	invocation.

	* libpicman/Makefile.am: link libpicmanui against libpicmanmodule.

	* libpicmanwidgets/picmancolorselection.c: call
	_picman_ensure_modules_func() if it is non-NULL so color selector
	modules are available for plug-ins.

	* tools/pdbgen/pdb/picmanrc.pdb: added new PDB wrapper
	picman_get_module_load_inhibit().

	* app/pdb/picmanrc_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanpicmanrc_pdb.[ch]: regenerated.

2003-11-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-move-to-screen-[16|24].png: added
	new icon drawn by Jimmac.

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c: use the new icon.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.[ch]: added picman_canvas_set_clip_region().

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_expose): if picman_display_shell_pause()
	would cause a redraw, make sure that no XOR drawing happens on
	areas that have already been cleared by the windowing system.
	Fixes bug #115712.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.[ch]: some more cleanup.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplayshell-marching-ants.h: removed this file.

	* app/display/picmancanvas.[ch]: generalized creation of GCs. Added
	styles for drawing the selection and layer boundaries. Also added
	support for changing stipple masks as was used by an older
	implementation of the marching ants (see below).

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: don't create the Selection when
	the canvas is realized but only once when it is created.

	* app/display/picmandisplayshell-selection.[ch]: removed all GC code
	and draw by means of PicmanCanvas. Also resurrected a different
	implementation of the marching ants that was lost since 1.2
	(#undef USE_DRAWPOINTS).

2003-11-11  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-appearance.c: update
	shell->popup_factory only if this is the active display or we will
	change another display's options when creating a new display.
	Fixes bug #126668.

	* app/display/picmandisplayshell-callbacks.c
	* app/gui/view-commands.c
	* app/tools/picmanimagemaptool.c: do the same here. Can't really
	happen in these places but it's more correct to have the check
	for the active display.

	* app/display/picmandisplay.c (picman_display_flush_whenever): get the
	active display from the user_context, not the current_context.

	* app/gui/image-menu.c (image_menu_update): removed unused code.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.[ch]: removed
	non-functional colormap-cycling and simplified the selection code.

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/gui/preferences-dialog.c: removed "colormap-cycling" from
	the preferences.

2003-11-11  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/dicom.c: removed doubly pasted code. Changed
	error/progress messages to use the "standard" strings many plug-ins
	use. Added error message if opening for writing fails. Minor
	cleanups.

2003-11-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/dicom.c: added DICOM file plug-in written by
	Dov Grobgeld.

2003-11-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c
	* app/widgets/picmantooldialog.c: updated gtk-doc comments.

2003-11-11  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.c: New vectors now are invisible by
	default. A quick poll on #picman revealed that this is more
	useful. Also loading images with compatibility paths works
	more as expected.

2003-11-10  Dave Neary  <bolsh@picman.org>

	* app/widgets/picmandataeditor.c: Fix warnings and one error in 
	last commit.

2003-11-10  Dave Neary  <bolsh@picman.org>

	* app/widgets/picmandataeditor.c: Implement save button. Partially
	addresses bug #116606.

2003-11-10  Dave Neary  <bolsh@picman.org>

	* app/tools/picmanimagemaptool.c: Removed some code I'd added 
	earlier and forgot to take out again.

2003-11-10  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.[ch]	
	* app/tools/picmandrawtool.[ch]: moved GC from the the draw tool to
	PicmanCanvas. Added wrappers around GDK drawing functions and do all
	canvas drawing by means of these new functions.

	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.c
	* app/tools/picmancroptool.c
	* app/tools/picmanfuzzyselecttool.c: draw using the new PicmanCanvas
	functions.

2003-11-10  Dave Neary  <bolsh@picman.org>

	* app/tools/picmanimagemaptool.c: Moved assignment of shell to 
	the place where it will be used, preventing a null pointer 
	dereference when it's not used. Fixes bug #126524.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.[ch]: removed color_notebook_new() and
	renamed color_notebook_viewable_new() to color_notebook_new().

	* app/gui/gradient-editor-commands.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmantoolbox-color-area.c: changed accordingly.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorselection.c: added API docs for all
	public functions.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmancolorselection.[ch]: new widget derived from
	GtkVBox. Contains a PicmanColorNotebook, PicmanColorScales and new/old
	color areas as known from the app's color_notebook. Will soon be
	used to replace GtkColorSelection for plug-ins.

	* app/gui/color-notebook.c: removed most code and use a
	PicmanColorSelection widget. Moved the "Reset" button to the
	action_area. Cleanup.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* app/gui/gui-vtable.c: #include "themes.h".

2003-11-10  Michael Natterer  <mitch@picman.org>

	Made plug-ins honor the current PICMAN theme:

	* app/core/picman.[ch]: added PicmanGetThemeDirFunc to the GUI vtable.

	* app/gui/gui-vtable.c: implement it here.

	* tools/pdbgen/pdb/picmanrc.pdb: added new PDB function
	picman_get_theme_dir().

	* libpicman/picmanui.c: use the new function and fall back to
	picman_gtkrc() if it returns NULL.

	* app/pdb/picmanrc_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanpicmanrc_pdb.[ch]: regenerated.

	* app/gui/themes.c: unrelated cleanup.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* app/gui/tools-commands.c (tools_select_cmd_callback): don't
	call tool_manager_initialize_active() with a NULL PicmanDisplay.
	Fixes bug #126462.

2003-11-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.c
	* app/widgets/picmannavigationpreview.c: destroy GdkGCs in
	GtkWidget::unrealize().

2003-11-10  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.[ch]	
	* app/display/picmandisplayshell.c: moved GdkGCs to PicmanCanvas;
	still work in progress...

2003-11-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: removed the
	"Move to Screen" hack.

	* app/gui/dialogs-commands.[ch]
	* app/gui/view-commands.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c: added proper menu items to the
	<Image>/View and the <Dialogs> menus so all image windows and
	docks can be sent to other screens. Hide the menu items when
	there is just one screen.

	* app/widgets/picmanhelp-ids.h: new help IDd for the new menu items.

2003-11-10  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/display/display-types.h
	* app/display/picmancanvas.[ch]: added PicmanCanvas, derived from
	GtkDrawingArea.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]: changed accordingly.

2003-11-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_browse.c: more file selections on the
	right screen.

2003-11-09  Michael Natterer  <mitch@picman.org>

	* app/gui/file-commands.[ch]
	* app/gui/file-dialog-utils.[ch]
	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]
	* app/gui/gradients-commands.c
	* app/gui/vectors-commands.c
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmanerrorconsole.c
	* libpicmanwidgets/picmanfileselection.c: show file selections on
	their parent widget's screen.

2003-11-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush.c (picman_brush_load_brush)
	* plug-ins/common/gbr.c (load_image): use proper conversion from
	16bit float to 8bit integer.

2003-11-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: removed redundant calls to picman_get_data().

	* plug-ins/common/wmf.c: fixed parameter handling and limits and
	initial value of the logarithmic scale entry.

2003-11-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/wmf.c (load_dialog): use a scale_entry instead
	of adding a GtkHScale manually.

2003-11-09  Sven Neumann  <sven@picman.org>

	* configure.in: check for libwmf >= 0.2.8 and build the WMF
	plug-in conditionally.

	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/wmf.c: replaced the WMF plug-in with a plug-in
	using libwmf2 written by Dom Lachowicz and Francis James Franklin.
	Converted the plug-in to the new PicmanDialog API and PICMAN coding
	style. Fixes bug #108653.

2003-11-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.c: (hopefully) fixed bug #126151.

2003-11-08  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c
	* libpicmancolor/picmancmyk.c: fixed gtk-doc comments, removed
	trailing whitespace.

2003-11-08  Dave Neary  <bolsh@picman.org>

	* libpicmancolor/picmancmyk.c: More gtk-docs.

2003-11-08  Dave Neary  <bolsh@picman.org>

	* libpicmancolor/picmancolorspace.c: Finished gtk-docs. The docs for
	these could perhaps include formulae, but for most of the 
	colorspaces that would be the same thing as copying the code 
	into a comment, which seems pointless.

2003-11-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantemplateeditor.c: don't show a radio button for
	PICMAN_NO_FILL; makes the dialog a little less tall.

2003-11-08  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout-render.c (picman_text_layout_render)
	* app/text/picmantextlayout.c (picman_text_layout_position): handle
	the case where the ink rectangle exceeds the logical rectangle.
	Fixes bug #126480.

2003-11-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantooloptionseditor.c
	(picman_tool_options_editor_get_preview): use
	gtk_widget_get_screen() instead of gdk_screen_get_default().

	* app/widgets/picmandatafactoryview.[ch]: added "GtkWidget *parent"
	to PicmanDataEditFunc.

	* app/gui/dialogs-constructors.[ch]
	(dialogs_edit_brush,gradient,palette_func): use the passed parent
	widget for finding the right screen instead of
	gdk_screen_get_default().

	* app/gui/gui.c: minor cleanup.

2003-11-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.[ch]: remember the "create_tearoff"
	passed to picman_item_factory_new() in the PicmanItemFactory struct
	and removed "create_tearoff" from the create_item functions
	(it makes no sense to pass this per create_item).

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c
	* app/gui/image-menu.c
	* app/gui/menus.c
	* app/gui/plug-in-menus.c
	* app/gui/tool-options-menu.c: changed accordingly.

	* app/display/picmandisplayshell.c (picman_display_shell_new): create
	the menu bar without tearoff entries. It is very confusing to have
	both the popup menu (which is global and works on the active
	display) and the menu bar submenus (which are specific to this
	display) be torn off at the same time.

2003-11-08  Sven Neumann  <sven@picman.org>

	* configure.in: renamed version.xml.in to version.in in all API
	reference manuals.

2003-11-08  Manish Singh  <yosh@picman.org>

	* libpicman/picmanui.c (picman_ui_init): #include <stdlib.h> for putenv,
	initialize var_name to NULL so the logic still works if none of
	the #ifdef cases hit.

2003-11-08  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-run.c (plug_in_run): cast the return value
	of picman_get_program_class() for the GPConfig message.

2003-11-08  Michael Natterer  <mitch@picman.org>

	To be multihead safe, each new window or menu needs to be
	associated with a GdkScreen or it will pop up on the default
	screen.

	* libpicmanwidgets/picmanquerybox.[ch]
	* app/display/picmandisplayshell-layer-select.[ch]
	* app/widgets/widgets-types.h
	* app/widgets/picmanitemfactory.[ch]
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmantemplateview.[ch]
	* app/widgets/picmantooldialog.[ch]
	* app/widgets/picmanviewabledialog.[ch]
	* app/gui/channels-commands.[ch]
	* app/gui/color-notebook.[ch]
	* app/gui/convert-dialog.[ch]
	* app/gui/edit-commands.[ch]
	* app/gui/grid-dialog.[ch]
	* app/gui/image-commands.[ch]
	* app/gui/info-dialog.[ch]
	* app/gui/layers-commands.[ch]
	* app/gui/offset-dialog.[ch]
	* app/gui/resize-dialog.[ch]
	* app/gui/stroke-dialog.[ch]
	* app/gui/templates-commands.[ch]
	* app/gui/vectors-commands.[ch]: added "GtkWidget *parent"
	paramaters to all functions which create menus, popups or windows
	and pass "parent" to picman_dialog_new() or one of the various
	wrappers around it. As a side effect, this fixes bug #61092.

	* app/widgets/picmandialogfactory.[ch]: added "GdkScreen *screen"
	instead of "parent" here since there are no possible parent
	windows on startup.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_origin_button_press): added a quick hack to
	send a display to another screen: click the origin button with the
	middle mouse button.

	* app/display/picmandisplayshell.c
	(picman_display_shell_screen_changed): don't chain up
	unconditionally (don't crash).

	* libpicmanwidgets/picmandialog.c (picman_dialog_new_valist): set the
	dialog's screen from a non-GtkWindow parent widget. The rest of
	non-window parent widget handling is still unimplemented.

	* libpicmanwidgets/picmancolorbutton.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmandockable.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmanpreview-popup.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmansessioninfo.c
	* app/widgets/picmantoolbox-color-area.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmantooloptionseditor.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmanwidgets-utils.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmannavigationview.c
	* app/gui/module-browser.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/drawable-commands.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gui-vtable.c
	* app/gui/gui.c
	* app/gui/info-window.c
	* app/gui/palette-import-dialog.c
	* app/gui/palettes-commands.c
	* app/gui/qmask-commands.c
	* app/gui/select-commands.c
	* app/gui/tool-options-commands.c
	* app/gui/view-commands.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c: changed accordingly. Changed all
	menu_position funcs to place the menu on the right screen.

2003-11-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-error.h: added PICMAN_CONFIG_ERROR_VERSION
	to PicmanConfigError enum.

	* libpicmanbase/picmanprotocol.h: renamed GP_VERSION to
	PICMAN_PROTOCOL_VERSION.

	* libpicman/picman.c
	* app/plug-in/plug-in-run.c: changed accordingly.

	* app/plug-in/plug-in-rc.[ch]: write the protocol version to the
	pluginrc and stop parsing when a wrong protocol version is found.

	* app/plug-in/plug-ins.c: pass a GError to plug_in_rc_parse().

2003-11-07  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanprotocol.[ch]: added "wm_name", "wm_class",
	"display_name" and "monitor_number" to the GPConfig message.
	Increased protocol version number.

	* libpicman/picman.[ch] (picman_config): read them from the GPConfig
	message and remember them.
	Added public accessors for the new config values.

	* libpicman/picmanui.c (picman_ui_init): pass wm_name and wm_class to
	gtk_init() and export the display/screen to use to the
	environment.

	* app/core/picman.[ch]: added vtable entries to get the values
	from the GUI.

	* app/gui/gui-vtable.c: implement the vtable entries.

	* app/plug-in/plug-in-run.c: fill in the GPConfig values using
	the new Picman vtable functions.

	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell.c
	* app/gui/about-dialog.c
	* app/gui/channels-commands.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/gui/file-dialog-utils.[ch]
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gradients-commands.c
	* app/gui/grid-dialog.c
	* app/gui/image-commands.c
	* app/gui/info-dialog.[ch]
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/module-browser.c
	* app/gui/offset-dialog.c
	* app/gui/palette-import-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/resize-dialog.c
	* app/gui/splash.c
	* app/gui/stroke-dialog.c
	* app/gui/templates-commands.c
	* app/gui/tips-dialog.c
	* app/gui/vectors-commands.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmandock.c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmantexteditor.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanviewabledialog.[ch]
	* libpicmanwidgets/picmanfileselection.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanunitmenu.c
	* plug-ins/helpbrowser/dialog.c
	* plug-ins/ifscompose/ifscompose.c: replaced all calls to
	gtk_window_set_wmclass() by gtk_window_set_role() and all
	"const gchar *wmclass_name" parameters by "const gchar *role".
	Cleaned up the window role strings.

2003-11-07  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanexport.c: beautified and cleaned up the export
	dialogs.

	* libpicmanwidgets/picmanquerybox.c: cleanups and fixes.

2003-11-07  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.[ch]: New function that appends a
	duplicate of the source vectors strokes to the list of strokes
	of a target vectors object.

	* app/core/picmanimage-merge.[ch]
	* app/core/core-enums.h: Use this new function to merge
	the visible vectors in an Image. New Undo type for vectors merging.

	* app/core/core-enums.c: regenerated.
	
	* app/gui/vectors-menu.c 
	* app/gui/vectors-commands.[ch]
	* app/widgets/picmanhelp-ids.h: New Menu entry + callback to invoke
	the merge functionality. New Help ID for the menu entry.

2003-11-07  Michael Natterer  <mitch@picman.org>

	* app/gui/tool-options-commands.c
	(tool_options_rename_saved_cmd_callback): fixed typo in dialog title.

2003-11-06  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/session.png: use somthing
	  nice
	
2003-11-06  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: fixed/added API docs.

2003-11-06  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.[ch]: removed our own action_area API
	and use GtkDialog's one. Create all dialogs without separator.
	Changed almost everything else too. Fixes bug #125143.

	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanunitmenu.c: changed accordingly.

	* libpicman/picmanexport.[ch]: ditto. Renamed enum PicmanExportReturnType
	to PicmanExportReturn.

	* libpicman/picmancompat.h: added a #define for the old name.

	* themes/Default/gtkrc: increased action_area border to 6 pixels.

	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmanprogress.c
	* app/gui/brush-select.c
	* app/gui/channels-commands.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/gui/file-new-dialog.c
	* app/gui/font-select.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gradient-select.c
	* app/gui/grid-dialog.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/module-browser.c
	* app/gui/offset-dialog.c
	* app/gui/palette-import-dialog.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/resize-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/stroke-dialog.c
	* app/gui/templates-commands.c
	* app/gui/user-install-dialog.c
	* app/gui/vectors-commands.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmantexteditor.c
	* app/widgets/picmantooldialog.[ch]
	* app/widgets/picmanviewabledialog.[ch]
	* app/widgets/picmanwidgets-utils.c: changed accordingly and increased
	the dialogs' outer borders to 6 pixels all over the place.

	* plug-ins/*/*.c: changed accordingly. The plug-ins may be
	arbitrarily broken, I tested none of them.

2003-11-06  Sven Neumann  <sven@picman.org>

	* devel-docs/gbr.txt: documented what I found out about the PICMAN
	brush version 3 file format.

2003-11-06  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: update contributed by Eric Pierce.

2003-11-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush.c (picman_brush_load_brush): read pixmap
	brushes in chunks of 8192 bytes in order to speed up loading.

2003-11-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush.c
	* plug-ins/common/gbr.c: added support for loading cinepaint
	brushes (PICMAN brush version 3).

2003-11-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: rewrote clipping code using
	gdk_rectangle_intersect().

2003-11-05  Sven Neumann  <sven@picman.org>

	* app/widgets/widgets-types.h: removed PicmanFontSelection and
	PicmanFontSelectionDialog typedefs.

2003-11-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): use the 2nd mouse wheel
	for horizontal scrolling. Fixes bug #126288.

2003-11-05  Tor Lillqvist  <tml@iki.fi>

	* libpicmanbase/Makefile.am: Move picmanwin32-io.h to
	libpicmanbase_1_3_la_SOURCES, so that it gets distributed.

	* libpicmanmodule/Makefile.am: Remove empty and meaningless
	EXTRA_HEADERS.

2003-11-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c (picman_text_options_gui): use
	GTK_STOCK_SELECT_FONT stock icon instead of text tool icon.

	* app/text/picmanfont.c: fixed default stock id.

	* app/text/picman-fonts.c (picman_fonts_load): don't leave picman busy
	and the fonts container frozen in case of error.

2003-11-05  Sven Neumann  <sven@picman.org>

	* app/main.c: added new command-line option --no-fonts. Might be
	useful to reduce startup time or if there are problems with the
	font configuration.

	* app/app_procs.[ch]
	* app/main.c
	* app/core/picman.[ch]
	* app/text/picman-fonts.c: don't load any fonts when picman is started
	with --no-fonts.

	* docs/picman-1.3.1.in: documented the new command-line option and
	updated outdated information.

2003-11-05  Sven Neumann  <sven@picman.org>

	* app/app_procs.c: register a log handler for the Picman-Text domain.

	* app/text/picmanfont.c: code cosmetics.

	* app/text/picmantext-compat.c: removed debugging output.

	Let PICMAN work w/o any fonts. Of course you won't get any text
	functionality then:

	* app/text/picmanfontlist.c: don't install any font aliases if no
	fonts were found.

	* app/text/picmantextlayer.c: refuse to render any text layers when
	the PICMAN fonts list is empty.

	* app/tools/picmantexttool.c: removed redundant includes.

	* app/tools/picmantextoptions.c: removed the font selection widget.
	This is a temporary regression that will be cured by improving the
	PicmanFontView widget.

	* app/widgets/Makefile.am
	* app/widgets/picmanfontselection-dialog.[ch]
	* app/widgets/picmanfontselection.[ch]
	* app/widgets/picmanpropwidgets.[ch]: removed the font selection and
	all references to it. Fixes bug #119267.

2003-11-04  Sven Neumann  <sven@picman.org>

	* etc/Makefile.am
	* etc/gtkrc_user: renamed to gtkrc.

	* picman.spec.in: changed accordingly.

	* app/gui/user-install-dialog.c: don't install the sessionrc,
	templaterc and unitrc into the personal picman directory. The files
	are created when PICMAN is quit.

	* app/core/picman-templates.c
	* app/core/picman-units.c	
	* app/gui/session.c: load sessionrc, templaterc and unitrc from
	the systemwide config directory. That way you can restore the
	default setup by removing the respective files from your personal
	picman directory.

2003-11-04  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Desktop files are now installed.

2003-11-04  Michael Natterer  <mitch@picman.org>

	* cursors/dropper.xbm
	* cursors/dropper_mask.xbm: moved the dropper cursor some pixels
	to the bottom left corner so it can be used together with the FG
	and BG cursor modifiers.

	* cursors/picman-tool-cursors.xcf: changed accordingly.

2003-11-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.[ch]: added static "the_dnd_picman" variable
	and don't use the global "the_picman" any more.
	Added picman_dnd_init() to let the DND system know about the GUI's
	Picman instance.

	* app/gui/gui.c (gui_init): call picman_dnd_init().

	* app/app_procs.h: changed the #warning about including
	"app_procs.h" to an #error, like the other headers in app/ do.

2003-11-03  Manish Singh  <yosh@picman.org>

	* app/text/picmantext-vectors.c: use recommended freetype include
	system of #include <ft2build.h> and #include FT_GLYPH_H things.

2003-11-03  Michael Natterer  <mitch@picman.org>

	* configure.in: added -DGTK_MULTIHEAD_SAFE to CPPFLAGS.

2003-11-03  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 1.3.23. Changed the check for
	GTK+ version 2.3.0 to give a less confusing output.

2003-11-03  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/preferences-dialog.c: reverted Svens change (which
	increased vertical spacing) to make the spacing in the preferences
	dialog consistent.

2003-11-03  Sven Neumann  <sven@picman.org>

	* Made 1.3.22 release.

2003-11-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.c: update the histogram on
	"invalidate_preview" instead of "update" because the paint core
	doesn't call picman_drawable_update().

2003-11-02  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c 
	* libpicman/picmanpatternmenu.c: added mnenonic for "Browse...".

2003-11-02  Sven Neumann  <sven@picman.org>

	* m4macros/picman-2.0.m4: rewritten to use pkg-config instead of
	picmantool; closely modeled after gtk-2.0.m4.

	* picman-1.3.pc.in: added picmandatadir and picmanlibdir variables.

2003-11-02  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c 
	* libpicman/picmanpatternmenu.c: use "Browse..." instead of "..."
	(bug #120600).

2003-11-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: handle gamma settings in PNG files using
	the "gamma" parasite (see bug #120031).

2003-11-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandock.c
	* etc/gtkrc_user: draw the separators in normal color but make the
	DND highlight use the bg color of the selected state.

2003-11-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_realize): set a hand
	cursor on the title area to indicate that the dockable can be
	dragged here.

2003-11-02  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: added Histogram to the dialog menus.

2003-11-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancursor.[ch] (picman_cursor_new): added a
	GdkDisplay parameter and added the convenience function
	picman_cursor_set().

	* app/display/picmandisplayshell-cursor.c
	* app/tools/picmancurvestool.c
	* app/widgets/picmandialogfactory.c: changed accordingly.

2003-11-01  Manish Singh  <yosh@picman.org>

	* app/core/picmanpalette.c (picman_palette_load): plug a memleak

2003-11-01  Manish Singh  <yosh@picman.org>

	* plug-ins/print/print_picman.h: don't try to define inline, glib
	does it for us.

	* app/widgets/picmangrideditor.c
	* app/widgets/picmanstrokeeditor.c: remove unnecessary GTK_WIDGET casts.

2003-11-01  Manish Singh  <yosh@picman.org>

	* configure.in: Only add FOO_DISABLE_DEPRECATED flags with GTK+ 2.2.x.
	Add -DGDK_MULTIHEAD_SAFE.

	* app/config/test-config.c: use guints for strlen()

	* app/gui/gui.c
	* app/gui/info-window.c
	* app/gui/menus.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmancursor.c
	* app/widgets/picmandevices.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanitemfactory.c
	* app/widgets/picmannavigationpreview.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmantooloptionseditor.c
	* app/widgets/picmanwidgets-utils.c
	* libpicman/picmanbrushmenu.c
	* libpicman/picmanpatternmenu.c
	* libpicman/picmanui.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/common/screenshot.c
	* plug-ins/picmanressionist/picmanressionist.c: more GDK_MULTIHEAD_SAFE
	fixes.

	* plug-ins/common/wmf.c: #undef GDK_MULTIHEAD_SAFE.. this plug-in
	is going away anyway.

	* app/widgets/picmancursor.h: add #warning about needing a proper
	multihead safe API.

	* app/gui/vectors-commands.c: s/clipoard/clipboard/

2003-11-01  Sven Neumann  <sven@picman.org>

	* app/composite/Makefile.am (EXTRA_PROGRAMS): removed
	test-composite.

2003-11-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogramview.[ch]: removed width and height
	from the API. It can be set using gtk_widget_size_request(). Set a
	mimimum height of 80 pixels.

	* app/widgets/picmanhistogrambox.c: changed accordinly. Reduced size
	of color gradient.
	
	* app/tools/picmancurvestool.c: reduced gradient sizes.

	* app/tools/picmanlevelstool.c: allow the histogram to expand
	vertically.

2003-11-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogramview.c (picman_histogram_view_expose): if
	multiple histogram values fall onto the same pixel, display the
	maximum value.

2003-11-01  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c (picman_histogram_get_mean): forgot to
	also add a range check here.

	* app/widgets/picmanhistogrameditor.c: update the channel menu when
	the image mode changes or an alpha channel is added/removed.

2003-11-01  Sven Neumann  <sven@picman.org>

	Replaced the histogram tool by a histogram dialog:

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-histogram-[16|22].png:
	removed here ...
	
	* themes/Default/images/stock-histogram-[16|22].png: ... and added
	under these new names.

	* libpicmanwidgets/picmanstock.[ch]: register the icons as
	PICMAN_STOCK_HISTOGRAM and removed the histogram tool stock icons.
	
	* app/base/picmanhistogram.c: don't crash when uncalculated values
	are requested from a PicmanHistogram. Allow to reset the histogram
	by calling picman_histogram_calculate() with a NULL region.

	* app/widgets/picmanhistogrambox.[ch]: renamed the PicmanHistogramView
	struct member to "view".

	* app/tools/picmanthresholdtool.c: changed accordingly.

	* app/widgets/picmanhistogramview.[ch] (picman_histogram_view_events):
	return TRUE when events were handled.

	* app/tools/Makefile.am
	* app/tools/picman-tools.c
	* app/tools/picmanhistogramtool.[ch]: removed the histogram tool.

	* app/widgets/Makefile.am
	* app/widgets/picmanhelp-ids.h
	* app/widgets/widgets-types.h
	* app/widgets/picmanhistogrameditor.[ch]: added PicmanHistogramEditor.
	Has some rough edges still...

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/image-menu.c: register the new dialog instead of the
	histogram tool.

2003-10-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/wmf.c: made multi-head safe. The whole tree
	compiles with GDK_MULTIHEAD_SAFE now.

2003-10-31  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: made multi-head safe. Let GTK+ parse the
	command-line before checking for application-specific parameters.

	* docs/picman-remote-1.3.in: document the --display command-line option.

2003-10-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c: some cleanup.

	(picman_move_tool_button_press): removed #if 0'ed experimental cruft
	and the #warning about it.

2003-10-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanfliptool.c (picman_flip_tool_transform): should
	actually call picman_item_flip() on the path to transform.
	Fixes bug #125895.

	* app/tools/picmantransformtool.c (picman_transform_tool_notify_type):
	if the transform tool is in the CREATING state, don't skip the
	whole callback but still copy the transform type and direction
	from the options to the tool. Fixes preview of transformed paths.

2003-10-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmansizeentry.c: moved all signal emissions to
	their resp update() functions (e.g. "value_changed" is emitted
	from picman_size_entry_value_update() now). Should fix all bugs ;)
	for the cost of a few extra signal emissions. We definitely
	emitted too few signals before so it's at least less broken.
	Removed "gboolean value_boundaries" stuff because this fix should
	always update the reference values correctly now.
	
2003-10-30  Michael Natterer  <mitch@picman.org>

	* app/tools/picman-tools.c (picman_tools_init): made Dodge/Burn the
	last paint tool, so Convolve and Smudge are together.

2003-10-30  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.[ch] (picman_histogram_get_count): added a
	missing PicmanHistogramChannel parameter. Fixes wrong values in the
	histogram tool.

	* app/base/levels.c
	* app/base/lut-funcs.c
	* app/pdb/color_cmds.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/tools/picmanhistogramtool.c: update the histogram statistics
	on channel changes.

2003-10-29  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: increased vertical spacing.

2003-10-28  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-layer-select.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmanhistogramview.c
	* app/widgets/picmannavigationpreview.c
	* libpicmanwidgets/picmancolorselect.c
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpickbutton.c: use multihead safe variants of
	the unsafe functions gdk_pointer_ungrab(), gdk_keyboard_ungrab()
	and gdk_device_get_core_pointer().

	* plug-ins/libgck/gck/gck.h
	* plug-ins/libgck/gck/gckcolor.c: made libgck multi-head safe.

	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_ui.c: changed accordingly.

	* plug-ins/common/animationplay.c
	* plug-ins/common/curve_bend.c
	* plug-ins/gfig/gfig.c
	* plug-ins/imagemap/imap_preview.c: use multihead safe GDK API.

2003-10-29  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_tool_events): call
	tool_manager_oper_active_update() also on GDK_ENTER_NOTIFY,
	GDK_LEAVE_NOTIFY, GDK_PROXIMITY_IN and GDK_PROXIMITY_OUT so the
	active tool's state is updated when the current device
	enters/leaves the canvas area.

	* app/tools/picmanmovetool.[ch]: added PicmanTool::oper_update() and
	prelight the guide which will be moved there. Prelight the guide
	only while the while the cursor is in the guide's sensitive area,
	not until another guide is selected.
	Feels better and fixes bug #125474.

	Removed "guide_disp" member from the PicmanMoveTool because
	GipmTool::oper_update() is called reliably now and we don't need
	to worry about guide prelighting across different displays any
	more.

	(picman_move_tool_cursor_update): removed guide prelighting code,
	cleaned up and simplified.

	(picman_move_tool_button_press): never activate the tool after
	calling init_edit_selection(). Fixes more tool control warnings.

	* app/display/picmandisplay-foreach.[ch]: removed
	gdisplays_check_valid().

2003-10-27  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-regression.c: Added functions to
	  print the pixels in their various formats.

	* app/composite/picman-composite-{mmx,sse,sse2,altivec,vis}.c:
	Regenerated.
	
	* app/composite/picman-composite-{mmx,sse,sse2}.c: Removed the dodge
	  optimisation because it has the same problem that the divide
	  optimisation has.

	* app/composite/make-install.py: When generating tests, use a
	  pixel field of random values.

2003-10-27  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am	
	* app/text/picmantextlayer-xcf.[ch]: new files that load and save
	text layers to/from XCF.

	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/text/picmantextlayer.c: removed that code here and use the new
	functions instead.

	* app/text/picmantext-parasite.[ch] (picman_text_from_parasite): added
	a GError parameter.

	* app/text/picmantextlayer.[ch]: store the name of the parasite that
	the text layer was created from (if read from XCF). Remove the
	parasite when the text layer is edited. If a text layer wasn't
	touched, the original parasite is written back to the XCF file.
	
	* app/text/picmantextlayout.c (picman_text_layout_new): handle a NULL
	text string.

	* app/tools/picmantextoptions.c: implement PicmanToolOptions::reset
	and save the text across a reset.

2003-10-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c (picman_dock_style_set): call
	picman_dock_separator_realize() on all drop separators so their
	color follows the theme change. Fixes bug #119735.

2003-10-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanerrorconsole.c (picman_error_console_add): scroll
	to the added message.

2003-10-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanhelpui.c: stop using the deprecated
	GtkTipsQuery widget for context help and implement the needed part
	of its functionality using a grab on a GtkInvisible. Should stop
	PICMAN crashing with Gtk+ HEAD.

	* libpicmanwidgets/picmanhelpui.[ch] (picman_context_help): requires
	a GtkWidget parameter now (finding the correct GdkScreen).

	* app/gui/help-commands.c (help_context_help_cmd_callback):
	changed accordingly.

2003-10-26  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_libs_init): resurrected the runtime check for
	the required Gtk+ version. Depend on Gtk+ >= 2.2.2 and abort if
	the requirement is not met. This is mainly for catching packaging
	errors, as we already compile-time require Gtk+ 2.2.2.

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: removed #warnings and
	workarounds for bugs in Gtk+ < 2.2.2.

	* app/widgets/picmancontainertreeview.c: replaced the #warning about
	the pending fix for bug #115871 by a #warning plus runtime check
	for Gtk+ >= 2.2.3. Did some general cleanups.

2003-10-26  Henrik Brix Andersen  <brix@picman.org>

	* themes/Default/images/preferences/Makefile.am: really committed
	the change this time

2003-10-26  Henrik Brix Andersen  <brix@picman.org>

	* picman/app/widgets/picmanhelp-ids.h
	* picman/app/gui/preferences-dialog.c:
	- moved all session related settings to a new Session Management page
	- moved Web Browser setting to Help System page
	- changed Configure Input Devices to Configure Extended Input Devices

	* picman/themes/Default/images/preferences/Makefile.am
	* picman/themes/Default/images/preferences/session.png: re-added
	session.png

	* picman/app/widgets/picmandevices.h
	* picman/app/widgets/picmandevices.c (picman_devices_clear): function
	added to be consistent with the rest of the session management
	routines. This function needs to be filled in.

	* picman/app/widgets/picmantemplateeditor.c
	* picman/app/widgets/picmangrideditor.c: fixed spacing between widgets

2003-10-26  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added back "box-unit" property; it
	makes sense to have an extra unit for it.

2003-10-26  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c	
	(picman_config_deserialize_fundamental): handle negative float and
	double values similar to how this is done for integers and the
	like.

	* app/config/picmanconfig-params.h: added two new param flags and
	documented all flags in the header file (for now).

	* app/config/picmanconfig-serialize.h: handle the new param flags
	PICMAN_PARAM_DEFAULTS and PICMAN_PARAM_IGNORE.

	* app/text/text-enums.[ch]
	* app/text/picmantext.[ch]: added some properties that we will need
	sooner or later. Mark the new properties and a lot of the existing
	ones as PICMAN_PARAM_DEFAULTS so that their values are not
	serialized unless changed from the default value.

	* app/text/picmantextlayout.c	
	* app/tools/picmantextoptions.c: made all length properties in
	PicmanText depend on a single unit.

2003-10-26  Simon Budig  <simon@picman.org>

	* tools/authorsgen/contributors: Fixed/Added some UTF-8 encoded
	names. Please speak up if I did mess up your name.

	* AUTHORS
	* app/gui/authors.h: regenerated.

2003-10-25  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c: corrected the source of the
	man-page; it's not any longer created by picmanconfig-dump, but by
	'picman --dump-picmanrc-manpage'.

	* docs/picman-1.3.1.in	
	* app/main.c (picman_show_help): Reordered command-line options and
	documented the new --dump-picmanrc option.

2003-10-25  Sven Neumann  <sven@picman.org>

	* app/tools/tools-enums.[ch]: added PICMAN_COLOR_PICK_MODE_NONE to
	the PicmanColorPickMode enum.

	* app/tools/picmancolorpickeroptions.[ch]: removed "update-toolbox"
	property; the new enum value serves this role better.

	* app/tools/picmancolorpickertool.c: handle the new enum value.

	* app/tools/picmancolortool.c: default to PICMAN_COLOR_PICK_MODE_NONE.
	Don't set a cursor modifier for this value. Fixes tool cursor for
	levels and curves tools.

	* app/tools/picmanpainttool.[ch]: added a function to conveniently
	enable the color picker and set the pick mode at the same time.
	
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmansmudgetool.c: use the new function.

	* app/tools/picmanerasertool.c: enabled color picking in the eraser
	tool but set the mode to PICMAN_COLOR_PICK_MODE_BACKGROUND.

2003-10-25  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.[ch] (picman_config_connect): make it
	a two-way connection and added a property_name parameter so it
	can be used to connect only a certain property.

	* app/tools/picmantexttool.c: changed accordingly.

	* app/tools/picmanhistogramoptions.c: use picman_config_connect().
	Changed the default histogram scale to linear.
	
2003-10-25  DindinX <david@dindinx.net>

	* plug-ins/picmanressionist/Makefile.am: added a real dependency for
	picmanressionist.c on logo-pixbuf.h.

2003-10-25  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINUGUAS): added "ms" (Malay) now that all po
	files are there.

	(PANGOFT2_REQUIRED_VERSION) depend on PangoFT2 >= 1.2.2. There are
	a couple of bug-fixes that are needed to make the text tool work.
	Actually you should use at least version 1.2.4.

	(GTK_REQUIRED_VERSION): depend on GTK+ >= 2.2.2. Earlier versions
	had bugs that we don't want to work around any longer.

	* INSTALL: document this change.
	
	* app/gui/gui.c (gui_post_init): removed the GTK+ version check.

	* app/text/picmantext.[ch]: added properties for letter spacing and
	kerning for compatibility with future PICMAN versions implementing
	these features.

2003-10-25  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/Makefile.am: fixed(?) dependencies.

2003-10-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/jpeg.c: disable the progress bar when loading a
	preview for the JPEG dialog.

2003-10-24  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/logo.xpm: removed again. The XPM format
	is deprecated.

	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/picmanressionist/logo.png: added the logo as PNG file and
	added Makfile rules to create an inline pixbuf as logo-pixbuf.h.

	* plug-ins/picmanressionist/picmanressionist.c: changed accordingly.

2003-10-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/picmanressionist/about.c: removed...
	* plug-ins/picmanressionist/logo.xpm: and replaced by new .xpm file so
	that we don't need deprecated GtkPreview widget anymore.
	* plug-ins/picmanressionist/Makefile.am: changed accordingly
	
	* plug-ins/picmanressionist/*.[ch]: replaced gtk_tooltips_set_tip by
	picman_help_set_help_data so that tooltips will not be shown when
	disabled in the PICMAN Preferences.

2003-10-24  Dave Neary  <bolsh@picman.org>

	* tools/pdbgen/pdb/paths.pdb: Applied a patch from 
	Wolfgang Hofer <hof@picman.org> to make picman_path_get_points 
	behave the same as in 1.2.x. Closes bug #125008.

2003-10-24  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-histogram-linear-16.png
	* themes/Default/images/stock-histogram-logarithmic-16.png:
	  touched up a tiny little bit

2003-10-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gfig/gfig_*.[ch]: removed
	* plug-ins/gfig/gfig-*.[ch]: added. Changed all underscores in 
	filenames to hyphens. More code-cleanup.
	* plug-ins/gfig/Makefile.am: updated accordingly

2003-10-24  Sven Neumann  <sven@picman.org>

	* app/errors.c (picman_errors_init): fixed spelling of The PICMAN.

	* app/widgets/picmanhistogramview.c: code cleanup.

2003-10-24  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanhistogramoptions.[ch]: new tool options class
	PicmanHistogramOptions, derived from PicmanColorOptions.

	* app/tools/picmancoloroptions.c (picman_color_options_gui): add
	picman_histogram_options_gui() when called with PicmanHistogramOptions.
	This a bit weird since the class hierarchy is the other way around
	but it makes things easier.

	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c: use PicmanHistogramOptions and
	connect the histogram views to the "histogram-scale" property.
	Perhaps not perfect GUI-wise but it let's you choose the histogram
	scale and stores this setting per tool. Fixes bug #125306.

	* app/widgets/picmanhistogramview.c: prefixed property names with
	"histogram-" so they match the PicmanHistogramOptions property.

	* app/widgets/picmanhistogrambox.c: minor cleanup.

2003-10-24  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-histogram-linear-16.png
	* themes/Default/images/stock-histogram-logarithmic-16.png:
	added placeholders for new icons.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/tools/picmanhistogramtool.c: made the dialog more compact by
	using a stock-box for the histogram scale.

	* app/widgets/picmanhistogramview.c (picman_histogram_view_expose):
	don't invert the histogram view if the full range is selected.

	* app/widgets/picmanhistogrambox.c: moved the range widgets below
	the histogram.

	* app/config/picmanconfig-params.h: added macro
	PICMAN_CONFIG_INSTALL_PROP_RESOLUTION() that installs a double
	property with the suitable range.

	* app/core/picmantemplate.c
	* app/config/picmandisplayconfig.c: use it here.

2003-10-23  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-3dnow.c:
	  Incorrectly reported the inverse of whether not the 3dNow
	  instruction set is supported by the current CPU.

	* app/composite/picman-composite-{mmx,sse}.c:
	  Removed linkage of picman_composite_divide_*.  Something is
	  inexplicably broken, and this will get people working again
	  while I debug.  This should close bug #125101.

2003-10-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sample_colorize.c: made debugging output
	conditional and fixed some user-visible strings.

2003-10-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c: setup size entries in the order
	suggested by the PicmanSizeEntry documentation.

	* libpicmanwidgets/picmansizeentry.c: added an internal flag so the
	size entry knows if the boundaries are set on the value or on the
	reference value.  Needed to make picman_size_entry_update_unit() do
	the right thing.

2003-10-23  Henrik Brix Andersen  <brix@picman.org>

	* picman/app/display/picmandisplayoptions.c
	* picman/app/config/picmanrc-blurbs.h: added blurbs to the remaining
	properties of PicmanDisplayOptions and PicmanDisplayOptionsFullscreen

2003-10-23  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-tools-16.png
	* themes/Default/images/stock-tools-24.png: make the outline
	  more crisp

2003-10-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.[ch] (picman_prop_size_entry_new): take
	the boundaries from the GParamSpec instead of hardcoding them.
	Added a utility function to reduce code duplication.

2003-10-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagedock.c (picman_image_dock_init): set a
	tooltip on the "Auto" button since it isn't obvious what it does.

2003-10-23  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-tools-[16|24].png	
	* themes/Default/images/stock-device-status-24.png
	* themes/Default/images/stock-tool-options-24.png: new icons drawn
	by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs-menu.c: use the new PICMAN_STOCK_TOOLS icon.

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: add the Tools dialog entry here as well.
	
	* app/widgets/picmanhelp-ids: s/TOOL_DIALOG/TOOLS_DIALOG/.
	
2003-10-23  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-appearance.c
	(picman_display_shell_set_padding): avoid potential crash (access
	pointer *after* precondition check).

2003-10-23  Michael Natterer  <mitch@picman.org>

	* app/gui/preferences-dialog.c (prefs_display_options_frame_add):
	properly align the toggle button columns by packing their
	containers expanding, removed ascii art, cleanup.

2003-10-23  Henrik Brix Andersen  <brix@picman.org>

	* picman/app/display/picmandisplayoptions.[ch]: changed
	PROP_SHOW_ACTIVE_LAYER to PROP_SHOW_LAYER_BOUNDARY to be
	consistent with the user interface

	* picman/app/display/picmandisplayshell-appearance.c
	* picman/app/display/picmandisplayshell-callbacks.c
	* picman/app/gui/preferences-dialog.c
	* picman/app/gui/image-menu.c: changed accordingly

2003-10-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooldialog.c (picman_tool_dialog_new): fixed
	inline documentation.

2003-10-22  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Changed the priority
	of ALT vs. CTRL. Resolves an small issue with (broken)
	window managers that grab ALT. Implements the suggestion
	from Raymond Ostertag in bug #124971.

2003-10-22  Dave Neary  <bolsh@picman.org>

	* plug-ins/gfig/gfig.c: Bumped version number to 2.0. Closes 
	bug #125237.

2003-10-22  Dave Neary  <bolsh@picman.org>

	* app/gui/preferences-dialog.c: Add outstanding display options to 
	preferences dialog.

2003-10-22  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h
	* app/display/picmandisplayoptions.h: don't set separate blurbs for
	the fullscreen options. It only means extra work for the translators
	without much (if any) value.

2003-10-22  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplayoptions.[ch]: new files that implement
	a PicmanConfig object with PicmanDisplayShell and PicmanCanvas options.
	Actually two classes, one for the normal view, a derived one with
	different default values for fullscreen mode.

	* app/display/display-enums.[ch]: renamed PicmanDisplayPadding enum
	to PicmanCanvasPadding.

	* app/config/config-types.h: added the PicmanDisplayOptions typedef.

	* app/config/picmanrc-blurbs.h
	* app/config/picmandisplayconfig.[ch]: replaced a bunch of properties
	with two instances of PicmanDisplayOptions.

	* app/display/picmandisplayshell.[ch]: replaced the 
	PicmanDisplayShellAppearance struct with PicmanDisplayOptions.

	* app/display/picmandisplayshell-appearance.[ch]
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.[ch]
	* app/gui/image-menu.c: changed accordingly.

	* app/gui/preferences-dialog.c: added a convenience function that
	creates a view on a PicmanDisplayOptions object. Not all values are
	configurable here yet.

	* docs/picmanrc-1.3.5.in
	* etc/picmanrc: regenerated to document the picmanrc format changes.

2003-10-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: added new function
	picman_rgb_set_gdk_color().

	* app/config/picmanrc.c (picman_rc_load): unlinking the broken picmanrc
	doesn't really help so don't do it. PICMAN will continue to complain
	until the picmanrc is fixed.

2003-10-22  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c: no need to reimplement the default
	PicmanConfigInterface implementation.

	* app/config/picmancoreconfig.c: renamed notify handlers.
	
2003-10-21  Dave Neary  <bolsh@picman.org>

	* app/core/picmanimage-convert.c: Applied a slightly modified 
	patch from Vesa Halttunen <vesuri@jormas.com> to sort generated
	optimum palettes. Closes bug #119824.

2003-10-21  Sven Neumann  <sven@picman.org>

	* base/base.c (base_init)
	* app/errors.c (picman_errors_init): moved the message about
	possible debug messages to picman_errors_init() so that it appears
	before any startup debug output.

	* app/app_procs.c (app_init): register a log handler for the
	PicmanConfig log domain.

	* app/widgets/picmanwidgets-utils.c (picman_message_box)
	* app/core/picman.c (picman_message): added an extra newline when
	sending messages to stderr. Don't output the full progname for
	messages; use a simple "PICMAN" like the GUI message handler does.

	* app/gui/user-install-dialog.c: removed function copy_file()...

	* app/config/picmanconfig-utils.[ch]: ... and added it here as
	picman_config_file_copy(). Also added utility function
	picman_config_file_backup_on_error().

	* app/config/picmanrc.c (picman_rc_load): if the user picmanrc can't be
	parsed, create a backup and if that succeeds unlink the broken one
	to cure the problem.

	* app/gui/session.c: create a backup if sessionrc can't be parsed.

	* config/picmanconfig-deserialize.c (picman_config_deserialize_properties):
	don't set an error when token is G_TOKEN_NONE; it should already
	be set then.

2003-10-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandocked.[ch]: added new virtual function
	PicmanDocked::get_title() which returns a custom title. Added signal
	"title_changed". Added public wrappers around the new stuff.

	* app/widgets/picmandockable.c: implement GtkContainer::add() and
	::remove() and connect to the child's "title_changed" signal. Use
	the PicmanDocked's title if it provides one.

	* app/widgets/picmantooloptionseditor.c: implement
	PicmanDocked::get_title() and return e.g. "Paintbrush Options". Emit
	"title_changed" when the active tool changes. Simplified
	PicmanDocked::get_preview()'s implementation a lot since it does not
	include a label any more.

2003-10-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmancoloroptions.c: changed the default value for
	"sample_average" to TRUE (for Levels and Curves tools).

	* app/tools/picmancolorpickeroptions.c: override the default value
	for "sample_average" and set it back to FALSE (for Color Picker).

2003-10-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooldialog.c: documented picman_tool_dialog_new().

2003-10-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/align_layers.c: don't include the plug-in name
	in error messages; PICMAN takes care of that for us.

2003-10-21  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_init): removed the call to
	cpu_accel_print_results(); should have got enough testing and
	picman-composite outputs the same info anyway.

	* app/Makefile.am: link libappcomposite.a before libappbase.a.

	* app/config/Makefile.am (test_config_LDADD): it's not any longer
	needed to link the test against libappdisplay. and libappwidgets.a.

2003-10-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanvectorstreeview.c: implement
	PicmanItemTreeView::set_image and set the sensitivity of the
	"Selection To Path" button from there. Fixes bug #125058.

2003-10-20  Tor Lillqvist  <tml@iki.fi>

	* libpicmanbase/picmanenv.c (picman_directory): Fix bug that was
	introduced when the call to g_strconcat() was replaced with a call
	to g_build_filename(). The per-user directory in
	picman_data_directory() (which mainly is used on Windows when no
	home directory can be found) is supposed to be
	".picman-1.3.<username>", not ".picman-1.3./<username>".

2003-10-20  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmantooldialog.[ch]: added a simple utility function
	picman_tool_dialog_new() that creates a PicmanVieawableDialog based on
	PicmanToolInfo and registers it with the toplevel dialog factory.
	
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c: use the new functionality; removed
	the shell_identifier since it can be created from the tool name.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.[ch]: removed the shell_identifier
	here as well. Should also be ported to picman_tool_dialog_new().

	* NEWS: removed stuff that isn't new at all.

2003-10-20  Dave Neary  <bolsh@picman.org>

	* NEWS: Updated the NEWS file.

2003-10-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmeasuretool.[ch]: don't use InfoDialog; always
	display pixels and real-world units in the info window.

2003-10-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.c (picman_object_name_collate): must use
	strcmp() not strcoll() on the collation keys obtained from
	g_utf8_collate_key().

2003-10-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gfig/Makefile.am
	* plug-ins/gfig/gfig_dobject.c: new file. More code split from gfig.c
	to a seperate file.
	
	* plug-ins/gfig/gfig_dobject.h 
	* plug-ins/gfig/gfig_*.c
	* plug-ins/gfig/gfig.[ch]: More clean-up

2003-10-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmancropoptions.c
	* app/tools/picmanmoveoptions.c: revert back to "Current".

	* app/tools/tools-enums.[ch]: removed "Active" from the enum value
	descriptions; it was misleading.

2003-10-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c (picman_prop_enum_radio_frame_new)
	(picman_prop_boolean_radio_frame_new): attach the first radio button
	as object data to the returned frame.

	* app/tools/picmanmoveoptions.c: change labels and sensitivity of
	the Tool Toggle frame depending on the selected move-type.

	* app/tools/picmancropoptions.c: use the term "Active Layer" instead
	of "Current Layer". Please object if you dislike this change.

2003-10-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gfig/Makefile.am
	* plug-ins/gfig/gfig_*.[ch]: new files split from gfig.c
	
	* plug-ins/gfig/gfig.c: fix for #124158 (always show both the Paint 
	and Select Tab). Also first attempt to split this hug file into
	smaller pieces to make this plug-in a bit more manageable.

2003-10-19  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/test-config.c: it became impossible to link the test
	because the PicmanRc class pulls in too many symbols. Changed it to
	use a PicmanGrid object instead.

	* app/core/picmangrid.[ch]: reordered properties so they match the
	order they appear in the grid dialog.

2003-10-18  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandbockbook.c: removed the "Select Tab" menu and
	all the evil hacks that were needed to make it work. Now that we
	have an extra dockable menu, the standard menu from GTK+ is good
	enough.

	* app/widgets/picmandockable.c: added a tooltip to the close button
	and removed code that used to hide the "Select Tab" menu.

	* app/gui/dialogs-menu.c (dialogs_menu_entries): removed now unused
	"Select Tab" entry.

2003-10-18  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/despeckle.c
	* plug-ins/common/gqbist.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/maze/maze.c
	* plug-ins/maze/maze.h
	* plug-ins/maze/maze_face.c
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/spyropicman.scm: Made several strings
	translateable, and removed version numbers from window titles and
	plug-in names, following suggestions from Raymond Ostertag. 
	This closes bug #124600.

2003-10-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanerasertool.c (picman_eraser_options_gui): changed
	the "Anti Erase" toggle key from <control> to <alt> because
	<shift> and <control> are used by straight_line mode and should
	behave consistently across all paint tools.

2003-10-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c
	(picman_item_tree_view_docked_iface_init): need to set
	docked_iface->get_preview to NULL explicitly now that the
	interface vtable inheriting is fixed (the layers, channels and
	paths dialogs can't show preview tabs because they don't always
	have a container).

	* app/widgets/picmanimagedock.c (picman_image_dock_get_aux_info):
	fixed typo: s/auctive/active/. Added #defines for the magic
	aux-info identifiers to avoid bugs like that.

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmanpaletteeditor.c. added #defines for aux-info
	identifiers here, too.

2003-10-18  Sven Neumann  <sven@picman.org>

	* app/gui/templates-commands.[ch] (templates_new_template_dialog):
	added an (unused) PicmanTemplate parameter to make this function
	match the PicmanTemplateActionFunc signature.

2003-10-18  Michael Natterer  <mitch@picman.org>

	* app/text/picman-fonts.c (picman_fonts_load): added
	picman_container_freeze() / _thaw() around font list reloading.

	* app/tools/picman-tools.c (picman_tools_init): added missing
	picman_container_freeze().

	* app/widgets/picmancontainerview.c: connect to the container's
	"freeze" and "thaw" signals and empty / refill the view
	accordingly. Ignore "add", "remove" and "reorder" signals while
	the container is frozen. Fixes font list sorting after refresh and
	speeds up refreshing of fonts, brushes, patterns etc.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanfontview.[ch]: new widget for the font list/grid.

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_FONT_REFRESH.

	* app/gui/dialogs-constructors.c: changed accordingly.

	* app/gui/Makefile.am
	* app/gui/fonts-commands.[ch]
	* app/gui/fonts-menu.[ch]: new files: a menu for the font view.

	* app/gui/menus.c (menus_init): register the new <Fonts> menu.

	* app/gui/preferences-dialog.c (prefs_dialog_new): removed the
	fonts refreshing hack from the "Environment" page.

2003-10-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.c (picman_container_view_get_preview):
	we have a bug somewhere; this function shouldn't be called for a
	view w/o a container. Added a g_return_if_fail() to avoid a crash.

2003-10-17  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: reverted most of Maurits changes (not the
	bug-fix though). The tentative feature freeze we are in also
	implies a string freeze.  It's too late for such massive string
	changes.

2003-10-17  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gfig/gfig.c: commented out code for Lock Grid (which
	wasn't implemented). Fixes #124157.

2003-10-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_file_dest_add): according to an
	older mail from Owen, GDK_ACTION_DEFAULT means nothing and should
	not be used.

	* app/widgets/picmancontainertreeview-dnd.c
	(picman_container_tree_view_drop_status): pass 0 to gdk_drag_status()
	instead of GDK_ACTION_DEFAULT.

2003-10-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_file_dest_add): for file drag
	destinations, set GDK_ACTION_DEFAULT and GDK_ACTION_MOVE in
	addition to GDK_ACTION_COPY. Enables DND from Konqueror.

2003-10-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooloptionseditor.c: picman_dnd_viewable_dest_add()
	calls gtk_drag_dest_set() for us so we don't need to do it here.

2003-10-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c: some minor code cleanup.

	* libpicmancolor/picmancolorspace.c: removed trailing whitespace.

2003-10-16  Dave Neary  <bolsh@picman.org>

	* libpicmancolor/picmancolorspace.c: Corrected mistake - two 
	definitions of picman_hsl_value (both static). I changed the 
	latter to picman_hsl_value_int.

2003-10-16  Dave Neary  <bolsh@picman.org>

	* app/base/color-balance.c
	* app/base/hue-saturation.c
	* app/composite/picman-composite-generic.c
	* app/paint-funcs/paint-funcs-generic.h
	* app/tools/picmanhuesaturationtool.c
	* libpicmancolor/picmancolorspace.[ch]: Changed all occurrences of
	picman_rgb_to_hls_int and picman_hls_to_rgb_int to
	picman_rgb_to_hsl_int and picman_hsl_to_rgb_int respectively. This 
	closes bug #124661.

2003-10-16  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbase.def: added picman_any_to_utf8.

	* app/gui/info-window.c
	* app/widgets/picmancolorframe.c: use "n/a" instead of "N/A".

2003-10-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/xpm.c (load_image): check the return value of
	XpmReadFileToXpmImage(). Fixes bug #124766.

2003-10-16  Sven Neumann  <sven@picman.org>

	* plug/ins/script-fu/scripts/*.scm: replaced lots of old school
	constants with their new names.

2003-10-16  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanutils.[ch] (picman_any_to_utf8): new function
	which takes any string and returns UTF-8 (it returns "(invalid
	UTF-8 string)" if all conversion attempts fail).

	* app/core/picmanbrush.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/xcf/xcf-read.c: use it. Fixes bug #79897.

2003-10-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.c: added "realize" and
	"size_allocate" callbacks and cleaned up calling of
	palette_editor_redraw(). Fixes bug #110356 without a complete
	re-write.

	Added PicmanDockedInterface::set_aux_info() and get_aux_info()
	implementations and rememeber the zoom_factor in sessionrc (mainly
	for testing yesterday's fix for interface upchaining).

2003-10-16  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c: increased default undo-size to 4 MB.

	* app/config/picmanrc-blurbs.h (UNDO_SIZE_BLURB): attempt to improve
	the description of the undo-size setting.

	* app/gui/image-menu.c (image_menu_entries): changed the default
	shortcut for Redo from the unergonmic Shift-Ctrl-Z to Ctrl-Y.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmoveoptions.c (picman_move_options_gui): changed
	labels of the "Tool Toggle" toggles to document that guides can't
	be moved in "Move Current Layer or Path" mode. Fixes bug #124693.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-menu.c (dialogs_menu_update): hide the
	"Tab Style" submenu when there is no tab visible (when there is
	only one page in the notebook). Fixes bug #124697.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandocked.c (picman_docked_iface_base_init)
	* app/config/picmanconfig.c (picman_config_iface_base_init): they are
	base_init, not just init functions. Changed implementations to not
	overwrite the parent class' vtable entries with the default
	implementations. Fixes derived interface methods and brings
	back all dockable menus.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/gui/info-window.c: eek. should actually commit what i
	claimed below...

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.c (picman_config_sync): fixed comment.

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/gui/file-new-dialog.c (file_new_dialog_set): sync from the
	given template to the dialog template, not the other way around.

	* app/widgets/picmantemplateeditor.c (picman_template_editor_constructor):
	shouldn't have to call the notify callback from here.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorframe.[ch] (picman_color_frame_set_color):
	made the "PicmanRGB *color" param const.

	Added API docs for all public functions.

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.c (picman_config_diff_internal): minor
	cleanup.

	* app/core/picmantemplate.[ch]: added a comment property.

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: removed "default_comment" property
	and set the default comment on the default image template.

	* app/widgets/picmantemplateeditor.c: added a comment editor widget.

	* app/core/picman.c
	* app/gui/file-new-dialog.c
	* app/gui/preferences-dialog.c
	* app/pdb/picmanrc_cmds.c
	* tools/pdbgen/pdb/picmanrc.pdb: changed accordingly.

	* libpicmanwidgets/picmanmemsizeentry.c (picman_memsize_entry_init):
	increased spacing between the spinbutton and the menu.

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-enums.[ch]: new enum PicmanColorFrameMode.

	* app/widgets/Makefile.am
	* app/widgets/picmancolorframe.[ch]: new widget PicmanColorFrame which
	shows a picked color in an optionmenu-selectable color space.
	Helps getting rid of InfoDialog.

	* app/gui/info-window.c: use it for the "extended" page. Cleaned
	up that page a lot so it can be made dockable in the next step.

	* app/tools/picmancolorpickertool.[ch]: use it here too. Don't use
	InfoDialog any more (and do not depend on gui/ any more).

2003-10-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.c
	(picman_container_view_get_preview): create tab widgets without
	border for both the tools and templates views.

	* app/widgets/picmanviewablebutton.c: removed trailing whitespace.

2003-10-15  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/default-grid.png: nothing fancy
	doable here
	
2003-10-15  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.[ch]: added new function
	picman_size_entry_get_help_widget() to make it possible to set
	tooltips on a PicmanSizeEntry.

	* app/widgets/picmanpropwidgets.c (picman_prop_size_entry_new)
	(picman_prop_coordinates_connect): set tooltips from property blurbs.

	* app/core/picmangrid.c
	* app/core/picmantemplate.c
	* app/gui/preferences-dialog.c: minor string changes.

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantemplateeditor.c: added a hbox to align the
	landscape/portrait buttons so they don't move with the label below.

2003-10-15  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/lighting_ui.c: mark string as translatable
	(bug #124600).

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: some fine-tuning.

2003-10-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.c (picman_config_diff) (picman_config_sync)
	* app/config/picmanconfig.c (picman_config_iface_equal): compare and sync
	aggregate objects recursively.

	* app/core/picmantemplate.c (picman_template_finalize): don't leak the
	filename.

	* app/display/picmandisplayshell-title.c
	* app/config/picmanconfig-dump.c: added %L format identifier for
	verbose layer count. Renamed former %L to %n (layer name).

	* app/config/picmandisplayconfig.c: changed default image title and
	image status format strings.

	* app/gui/dialogs-constructors.c: added a blurb for Templates
	dockables.

	* app/display/picmandisplayshell.h: fixed typo.

2003-10-14  Dave Neary  <bolsh@picman.org>

	* libpicmancolor/picmancolorspace.c: Some more gtkdocs. 

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.h: don't use gtk-doc style comments
	here.

2003-10-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantemplateeditor.c (picman_template_editor_new): 
	fixed warning (missing PICMAN_TEMPLATE() cast).

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c (picman_template_class_init): added blurbs
	for most properties.

	* app/config/picmanrc-blurbs.h: removed an unused blurb.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.c: made "perfect-mouse" the default
	and changed defaults for image title and image statusbar.

2003-10-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c: add the new context to picman->context_list
	in picman_context_constructor(), not in set_property(). Cleanup.

	* app/tools/picmantextoptions.c: added finalizer so we don't leak
	the options' GtkTextBuffer and PicmanText objects. Cleanup.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantemplateeditor.c (picman_template_editor_new):
	set the initial stock icon on the viewable-button.

2003-10-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c
	* app/composite/picman-composite.c:
	  Tweaked a few more documentation comments.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-grid.c
	* app/core/picmanimage.[ch]
	* app/gui/grid-dialog.c: removed the "grid_changed" signal from
	PicmanImage.

	* app/display/picmandisplayshell-handlers.c: connect to
	notifications from the image grid instead.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.[ch]: removed
	picman_config_copy_properties() and added the more intelligent
	picman_config_sync() instead.

	* app/config/Makefile.am
	* app/config/config-types.h
	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: replaced default image properties
	with a single PicmanTemplate object property. Changed the
	set_property function to not replace aggregate objects but call
	picman_config_sync() instead.

	* app/tools/picmantextoptions.c (picman_text_options_set_property):
	same change here.

	* app/config/picmanconfig.[ch]: changed return value of
	picman_config_duplicate() to gpointer to avoid some casts that only
	made the code harder to read.

	* app/widgets/picmantemplateeditor.[ch]: don't keep an internal copy
	here but edit the PicmanTemplate passed when the editor was
	constructed.

	* app/gui/preferences-dialog.c: use a PicmanTemplateEditor to allow
	editing of the default image paramaters.

	* app/config/picmanrc.c
	* app/core/core-types.h
	* app/core/picman.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-grid.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/core/picmantemplate.[ch]
	* app/gui/file-new-dialog.c
	* app/gui/grid-dialog.c
	* app/gui/info-window.c
	* app/gui/resize-dialog.c
	* app/gui/templates-commands.[ch]
	* app/gui/tool-options-commands.c
	* app/text/picmantextlayer.c
	* app/text/picmantextlayer.c
	* app/tools/picmantexttool.c
	* app/widgets/picmantemplateview.c
	* app/xcf/xcf-load.c: changed accordingly.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmangrideditor.[ch]: removed "grid_changed" signal.
	The user of PicmanGridEditor can connect to notifications of the
	grid that is being edited. There is no need for a proxy signal.

	* app/core/picmanimage-grid.c (picman_image_set_grid): don't exchange
	the image's grid object, it is part of the image. Copy all grid
	properties instead.

	* app/core/picmanimage-undo-push.c
	* app/gui/grid-dialog.c: changed accordingly.

2003-10-14  Michael Natterer  <mitch@picman.org>

	Refactored modifier handling of displays and tools. Hopefully
	finally fixes bug #124135.

	* app/tools/picmantool.[ch] (struct PicmanTool): added private members
	"focus_display" and "modifier_state" so tools are aware of their
	modifier state.

	* app/tools/picmantool.[ch]
	* app/tools/tool_manager.[ch]: removed all public modifier_key()
	API and added set_focus_display() and set_modifier_state()
	instead.

	* app/tools/tool_manager.c (tool_manager_select_tool)
	* app/display/picmandisplay.c (picman_display_delete): set the
	active_tool's focus_display to NULL.

	* app/display/picmandisplayshell.[ch] (struct PicmanDisplayShell):
	added almost the whole stuff that used to be static variables of
	picman_display_shell_tool_events(). Cleaned up the struct a bit.

	* app/display/picmandisplayshell-callbacks.c: removed utility
	function picman_display_shell_update_tool_modifiers().

	(picman_display_shell_tool_events):

	- Replaced all calls to picman_display_shell_update_tool_modifiers()
	  and tool_manager_modifier_key_active() by
	  tool_manager_modifier_state_active().

	- Call tool_manager_focus_display_active() before setting the
	  tool's modifier_state. Set the tool's focus_display to NULL when
	  we get a focus_out event.

	- Don't grab/ungrab the keyboard twice when <space>-selecting the
	  move tool.

	- Removed most static variables and use the new members of
	  PicmanDisplayShell. Don't remember any old modifier states since
	  PicmanTool does that by itself now.

2003-10-13  Manish Singh  <yosh@picman.org>

	* libpicman/Makefile.am: add $(libpicman) to libpicmanui_1_3_la_DEPENDENCIES
	so -jN builds work better.

2003-10-14  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/main.c
	* app/config/Makefile.am
	* app/config/makefile.msc
	* app/config/picmanconfig-dump.[ch]: removed the separate
	picmanconfig-dump binary and moved the functionality into picman
	itself. It became a mess to build and seems cleaner this way.

2003-10-13  Dave Neary  <bolsh@picman.org>

	* libpicmancolor/picmancolorspace.c: Added gtk-docs to a few functions. 

2003-10-13  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c:
	* app/composite/picman-composite.[ch]: Updated/improved/organised
	  documentation comments.

2003-10-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmantile.c: code cleanup and some documentation.

2003-10-13  Michael Natterer  <mitch@picman.org>

	* app/main.c (main): call g_set_prgname() in the --no-interface
	case (GDK is doing this for us otherwise).

	Always set a human readable localized application name using
	g_set_application_name().

2003-10-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-color-area.[ch]: cleanup & cruft removal.

2003-10-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c: typo: s/vieport/viewport/g

	(picman_container_grid_view_insert_item): stop idle updating since
	the widget will be exposed anyway.

2003-10-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.[ch]: renamed
	picman_dialog_factories_idle() and _unidle() to
	picman_dialog_factories_set_busy() and _unset_busy().
	Added utility function picman_dialog_factory_set_widget_data() and
	public API picman_dialog_factory_from_widget() so we don't need to
	g_object_[set|get]_data() with magic keys all over the place.

	* app/widgets/picmansessioninfo.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-menu.c
	* app/gui/gui-vtable.c: changed accordingly.

	* app/widgets/picmansessioninfo.c: remember active page of all dock
	notebooks in sessionrc.

	* app/widgets/picmansessioninfo.h: cleaned up the session info structs.

2003-10-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/snoise.c: clamp x and y sizes to sane values.
	Fixes bug #124389.

2003-10-13  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/comic-logo.scm
	(script-fu-comic-logo-alpha): fixed the script (bug #124441).

2003-10-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooloptionseditor.c: set the horizontal scrollbar
	policy to AUTOMATIC; addresses bug #124134.

2003-10-12  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c: split out indexed assignment and
	increment to avoid miscompilation by gcc on ppc and ia64. Fixes
	bug #113144.

2003-10-12  Seth Burgess  <sjburges@picman.org>
	
	* plug-ins/common/glasstile.c: make a minimum grid size of 2 for
	preview.  Fixes bug #72053.

2003-10-12  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/widgets/picmantoolbox.c (picman_toolbox_init): Set the default
	aspect ratio of the toolbox wrap box to 5:6.
	(picman_toolbox_set_geometry): Don't enforce min_height in the
	toolbox window. Fixes bug #116937 and works around bug #113228.

	* plug-ins/common/png.c (save_image): Round the values passed to
	png_set_pHYs so that they don't decrease on every save.

2003-10-12  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: fixed dependencies for test-config.

	* app/config/picmanconfigwriter.[ch]: code cleanup and documentation.

	* app/composite/picman-composite-generic.[ch]: made prototype for
	picman_composite_color_any_any_any_generic() match the implementation.

	* app/composite/picman-composite.c: fixed some issues with the
	comment templates.

2003-10-12  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_interface):
	allow to use mnemonics in SF-TOGGLE.

	* plug-ins/script-fu/scripts/font-map.scm: allow to choose the color
	scheme to use for the font map; added mnemonics.

2003-10-12  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c: removed debugging output that should
	have never been committed.

2003-10-12  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.c (picman_display_reconnect): HALT the
	active tool before reconnecting. Fixes bug #124388.

2003-10-12  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.[ch]: removed function
	picman_config_serialize_comment()...

	* app/config/picmanconfig-utils.[ch]: removed function
	picman_config_string_indent()...

	* app/config/picmanconfigwriter.[ch]: ... and implement both here.
	Added a comment mode to PicmanConfigWriter.

	* app/config/picmanconfig-dump.c: handle PicmanConfig properties.

	* doc/picmanrc-1.3.5.in
	* etc/picmanrc: regenerated by picmanconfig-dump.

2003-10-11  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite.h
	* app/composite/picman-composite-generic.h
	* app/composite/picman-composite-regression.h: Reformatted to include
	  argument names in function prototypes.

	* app/composite/picman-composite.c
	* app/composite/picman-composite-generic.c
	* app/composite/picman-composite-regression.c: Added gtk-doc
	templates for functions.

	* app/composite/make-install.py: migrated to new (trimmer) code and
	  removed dead code.  Some beautification for generated code.

	* app/composite/picman-composite-{mmx,sse,sse2,3dnow,altivec,vis,generic}.{c,h}:
	  All init() functions are also a run-time check and now expected to
	  return TRUE/FALSE if the particular set of compositing functions can
	  be used.

	* app/composite/picman-composite.c: No longer has to determine if 
	  the particular set of compositing functions can be used.

	* app/composite/picman-composite-{mmx,sse,sse2,3dnow,altivec,vis}-{install,test}.c:
	  Regenerated

	* app/composite/test-composite.c: Deprecated, removed.  All tests
	  are automatically generated and the code is in
	  app/composite/picman-composite-{mmx,sse,sse2,3dnow,altivec,vis}-test.c:

	* app/composite/Makefile.am: removed unused references to
	test-composite.c

2003-10-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.[ch]: added utility function
	picman_session_info_aux_new().

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmanimagedock.c (get_aux_info): use it.

2003-10-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-types.h
	* app/widgets/picmansessioninfo.[ch]: added new struct
	PicmanSessionInfoAux which contains "gchar *name" and "gchar *value".
	Changed sessionrc "aux-info" format again to be really extendable
	this time. Also breaks everybody's sessionrc again.

	* app/widgets/picmanimagedock.c
	* etc/sessionrc: changed accordingly.

	Implemented the stuff suggested in bug #122964. Fixes bug #122964
	and bug #52206:

	* app/widgets/picmandataeditor.[ch]: replaced the "Picman" member by a
	"PicmanDataFactory" and changed picman_data_editor_construct()
	accordingly. Implement PicmanDockedInterface::set_aux_info() and
	get_aux_info() and remember the currently edited data across
	sessions.

	* app/gui/gradient-editor-commands.c
	* app/gui/gradient-editor-menu.c
	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

	* app/widgets/picmancoloreditor.c: remember the active color
	selector across sessions.

2003-10-11  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer.c (picman_container_deserialize): when
	deserializing a PicmanContainer child, use the child's PicmanConfig
	implementation, not the container's.

	* app/config/picmanconfig-deserialize.c: documentation fixes.

2003-10-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandocked.[ch]
	* app/widgets/widgets-types.h: renamed PicmanDockedIface to
	PicmanDockedInterface.

	* app/display/picmannavigationview.c
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanimageeditor.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmantooloptionseditor.c: changed accordingly.
	
	* app/config/config-types.h
	* app/config/picmanconfig.[ch]
	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanconfig-serialize.[ch]	
	* app/config/picmanconfig-utils.[ch]: added a PicmanConfig typedef and
	changed the PicmanConfig API to take PicmanConfig instead of GObject
	pointers.

	* app/config/picmanconfig-dump.c
	* app/config/picmanrc.c
	* app/config/test-config.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman.[ch]
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandocumentlist.c
	* app/core/picmangrid.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage.c
	* app/core/picmanparasitelist.c
	* app/core/picmantemplate.c
	* app/core/picmantooloptions.c
	* app/core/picmanviewable.c
	* app/gui/grid-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/stroke-dialog.c
	* app/gui/templates-commands.c
	* app/gui/tool-options-commands.c
	* app/pdb/picmanrc_cmds.c
	* app/text/picmantext-parasite.c
	* app/text/picmantext.c
	* app/text/picmantextlayer.c
	* app/tools/picman-tools.c
	* app/tools/picmantexttool.c
	* app/widgets/picmandevices.c
	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmantemplateview.c
	* tools/pdbgen/pdb/picmanrc.pdb: changed accordingly.

2003-10-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmandocked.[ch]: new files implementing
	PicmanDockedInterface, a GTypeInterface which must be implemented by
	all widgets which want to be packed into a PicmanDockable. Has
	virtual functions similar to the ones PicmanDockable had.

	* app/widgets/picmandockable.[ch]: removed all virtual functions and
	all function pointers from the instance struct (also the ones just
	added in the commit below). Make sure only widgets implementing
	the PicmanDockedIface are added and simply call the child's
	PicmanDocked functions where we used to call our own virtual
	functions and function pointers.

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanimageeditor.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmansessioninfo.c
	* app/widgets/picmantooloptionseditor.c
	* app/display/picmannavigationview.c: implement PicmanDockedIface.

	* app/gui/dialogs-constructors.c: removed all that get_preview_func(),
	set_context_func() etc. cruft since that's done by PicmanDockedIface.
	It's really a file of constructors now.

	* app/gui/dialogs-menu.c: changed accordingly.

	* app/widgets/picmanimagedock.c: forgotten in the commit below.

2003-10-10  Michael Natterer  <mitch@picman.org>

	Cleaned up session management and changed the format of sessionrc
	in a way that allows extensions without changing the format during
	the 2.0 cycle:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmansessioninfo.[ch]: new files implementing the whole
	PicmanSessionInfo stuff (parsing, saving, restoring, utility functions).
	Save / parse the position of PicmanDock's panes (bug #122964).

	* app/widgets/picmandialogfactory.[ch]: removed saving, restoring
	and session related utility functions and use the ones from
	the new files above.

	* app/gui/session.c: removed parsing and use the new stuff.

	* app/widgets/picmandock.[ch]: added new virtual functions
	PicmanDock::set_aux_info() and PicmanDock::get_aux_info():

	* app/widgets/picmanimagedock.c: implement them and handle the
	"auto_follow_active" and "show_image_menu" properties.

	* app/widgets/picmandockable.[ch]: added the same virtual functions
	to the PicmanDockable class. Enables forward-compatible per-dockable
	session management (bug #122964).

	* app/gui/dialogs-commands.c
	* app/gui/gui.c: changed accordingly.

	* etc/sessionrc: ditto. Look at this file and update your own
	sessionrc manually if you don't want to lose it.

2003-10-10  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/burn-in-anim.scm: repaired this script
	(bug #124207).

2003-10-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c (load_image): fixed a typo in the patch
	for bug #123201 that accidentally already committed earlier.

2003-10-10  Henrik Brix Andersen  <brix@picman.org>

	* app/core/picmanimage-grid.[ch]: removed the grid parasite related
	functions from here ...

	* app/core/picmangrid.[ch]: ... and added them here. While I was at
	it I also changed PROP_TYPE to PROP_STYLE and added blurbs to the
	properties

	* app/xcf/xcf-load.c
	* app/display/picmandisplayshell.c: changed accordingly

	* app/widgets/Makefile.am
	* po/POTFILES.in
	* app/widgets/widgets-types.h
	* app/widgets/picmangrideditor.[ch]: added a new PicmanGridEditor
	widget - with a work-around for the fact that
	picman_prop_coordinated_new() doesn't accept boundaries

	* app/gui/grid-dialog.h
	* app/gui/grid-dialog.c (grid_dialog_new): use the new
	PicmanGridEditor widget, take a PicmanImage as function parameter,
	assume PicmanImages always have a PicmanGrid. This simplifies the grid
	dialog.

	* app/gui/image-commands.c
	(image_configure_grid_cmd_callback): changed accordingly

	* app/core/core-types.h: moved typedef PicmanGrid from here ...

	* app/config/config-types.h: ... to here to be able to use it in
	PicmanCoreConfig

	* app/config/picmanrc-blurbs.h
	* app/config/picmancoreconfig.[ch]: added default_grid member

	* app/widgets/picmanhelp-ids.h
	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/default-grid.png
	* app/gui/preferences-dialog.c: added UI for specifying default
	image grid

	* app/core/picmanimage.c (picman_image_new): create a PicmanGrid from
	core_config->default_grid

	* app/gui/image-menu.c (image_menu_update): the grid/guide entries
	in <Image>/View/ should always be sensitive ...

	* app/display/picmandisplayshell.c (picman_display_shell_init):
	... but the grid entries should be disabled by default

2003-10-10  Sven Neumann  <sven@picman.org>

	* app/errors.c (picman_eek)	
	* app/main.c (main) (picman_text_console_exit)
	* app/gui/user-install-dialog.c (user_install_cancel_callback):
	call exit() with EXIT_SUCCESS or EXIT_FAILURE instead of 0 and 1.

2003-10-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview-dnd.c: added auto-scrolling
	when DND-hovering close to the widget's top or bottom border.
	Fixes bug #124231.

	* app/widgets/picmancontainertreeview.h: added some auto-scroll state
	to the PicmanContainerTreeView struct.

	* app/widgets/picmancontainertreeview.c: remove the auto-scroll
	timeout in GtkWidget::unmap().

2003-10-09  Tor Lillqvist  <tml@iki.fi>

	* picman-zip.in: New file, shell script used to build zipfiles for
	distribution of Windows runtime and developer packages.

	* Makefile.am
	* configure.in: Add it, expand it.

	* libpicman*/Makefile.am: On Windows, install and uninstall the .def
	files.

	* app/config/picmanguiconfig.c: On Windows, don't use the internal
	help browser by default, as it isn't there. Don't use a fixed
	guess for Internet Explorer's path on Windows. We don't even need
	to know the path to the web browser, we can use ShellExecute() in
	the webbrowser plug-in.

	* plug-ins/common/webbrowser.c: Use ShellExecute() on Windows.

	* po*/makefile.cygwin: Remove, unmaintained.

	* libpicmanmath/picmanmath.def: Fix typo.

	* libpicman/picman.def: Add picman_rgn_iterator_src_dest.

2003-10-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.[ch]: added new function
	picman_object_name_collate() which compares two object names for
	ordering using the linguistically correct rules for the current
	locale and does some caching to speed up subsequent calls.

	* app/core/picmandatalist.c (picman_data_list_data_compare_func): use
	picman_object_name_collate() from here.

	* app/core/picmanlist.[ch]: added convenience function
	picman_list_sort_by_name.

	* app/text/picmanfontlist.c (picman_font_list_restore): use
	picman_list_sort_by_name() instead of g_utf8_collate.

2003-10-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.h: added PICMAN_VIEWABLE_MAX_BUTTON_SIZE
	PICMAN_VIEWABLE_MAX_MENU_SIZE.

	* app/core/picmanviewable.c (picman_viewable_get_popup_size): smarter
	popup size limitation: limit each axis to 2 * MAX_POPUP_SIZE
	and the area to MAX_POPUP_SIZE ^ 2.

	* app/core/picmanbuffer.c
	* app/core/picmanimage-preview.c
	* app/core/picmanitem-preview.c
	* app/text/picmanfont.c (PicmanViewable::get_popup_size): removed
	all limitations.

	* app/widgets/picmancontainermenu.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanviewablebutton.c: use the new button and menu
	size defines.

2003-10-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added PicmanScanConvert typedef.

	* app/core/picmanscanconvert.h: removed it here.

	* app/core/picmanchannel-select.[ch]: factored out new
	function picman_channel_select_scan_convert().

	(picman_channel_select_polygon)
	(picman_channel_select_vectors): use it.

	(picman_channel_select_alpha): when called on a layer without alpha,
	don't fail but fake the effect of a fully opaque alpha channel.

	* app/tools/picmaniscissorstool.c: some cleanup.

	(iscissors_convert): fixed my latest cleanup (don't cast the
	tool to a PicmanGrawable ;). Don't ignore options->antialias.

2003-10-08  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: fix SF_ADJUSTMENT handling
	when crafting the string to call, since it now gets a PICMAN_PDB_FLOAT.
	(This bug has been there since 1.3.4...)

2003-10-08  Manish Singh  <yosh@picman.org>

        * plug-ins/common/png.c: fix handling and docs of offs, phys, and time
        parameters.

2003-10-08  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Enabled debuginfo packages again.

2003-10-08  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c (picman_edit_fill_internal): new utility
	function which does everything picman_edit_clear() and
	picman_edit_fill() do but doesn't fail to:

	- fill an indexed drawable with white.
	- fill a drawable with alpha with transparency.

	(picman_edit_clear)
	(picman_edit_fill): use picman_edit_fill_internal().

	* app/core/picmandrawable.c (picman_drawable_[apply,replace]_region):
	added more g_return_if_fail(required_parameter != NULL).

2003-10-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.[ch]: added new pure virtual function
	PicmanDock::setup() which configures a dock like a passed template
	dock.

	* app/widgets/picmanimagedock.c: implement it and set
	"show_image_menu" and "auto_follow_active" accordingly.

	* app/widgets/picmandockable.c (picman_dockable_detach): call
	picman_dock_setup() to configure the new dock like the old one.
	Removed inclusion if "picmanimagedock.h".

	* app/gui/dialogs-commands.c: minor code cleanups.

2003-10-08  Michael Natterer  <mitch@picman.org>

	Fixed bug #119423. There was no speed regression with the actual
	painting, just with the display update (which effectively led to
	faster painting, it just felt slower).

	* app/display/picmandisplayshell.c (picman_display_shell_flush): added
	"gboolean now" parameter and update the display immediately if
	it is TRUE.

	* app/display/picmandisplay.c (picman_display_flush_whenever): pass
	the "now" we got passed to the function above, so calling
	picman_display_flush_now() really flushes *now* again.

2003-10-08  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/fileops.pdb (file_load_invoker):
	procedural_db_execute() *must* get the correct number of args, so
	do like file_save_invoker and create a full Argument array with
	the correct number of args and copy our own args into it before
	calling the actual load procedure. Fixes bug #124059.

	* app/pdb/fileops_cmds.c: regenerated.

2003-10-08  Sven Neumann  <sven@picman.org>

	* data/images/picman_splash.png: flatten the splash (bug #124062).

2003-10-07  Sven Neumann  <sven@picman.org>

	* configure.in
	* picman.spec.in: require librsvg >= 2.2.0 for the SVG plug-in.
	Fixes bug #123966.

2003-10-07  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch] (picman_dockable_detach): new
	function.  Need to include ugly stuff for proper PicmanImageDock
	setup.

	* app/widgets/picmandockbook.c (picman_dockbook_menu_end): use
	picman_dockable_detach() and removed the evil includes.

	* app/gui/dialogs-commands.c (dialogs_detach_tab_cmd_callback):
	implement it using picman_dockable_detach().

2003-10-07  Simon Budig  <simon@picman.org>

	* docs/Wilber.svg: Debugged winding rule issue,
	removed redundant paths, added IDs. Indentation madness.

2003-10-07  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-sse2.c (picman_composite_sse2_init):
	really check for CPU_ACCEL_X86_SSE.

	* libpicman/picman.def: added new symbols.

2003-10-07  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.22.

	Moved images used from scripts as suggested by Carol:

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/*.jpg: removed images from scripts
	directory...

	* configure.in
	* plug-ins/script-fu/scripts/images/Makefile.am
	* plug-ins/script-fu/scripts/images/*.jpg: ... and added them here.

	* plug-ins/script-fu/scripts/carved-logo.scm
	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: changed accordingly.

2003-10-06  Manish Singh  <yosh@picman.org>

	* app/gui/image-menu.c
	* app/gui/layers-menu.c
	* etc/ps-menurc: "Imagesize" isn't a real word. Fix to "Image Size".

	* app/paint/picmanpaintcore.c: add declaration for rotate_pointers which
	was inadvertently took out.

	* tools/pdbgen/pdb/layer.pdb: add picman_layer_resize_to_image_size.
	Fix failure reporting logic for picman_layer_delete.

	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* plug-ins/common/tiff.c: always compare using unsigned chars for 7bit
	ASCII check.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_mask_bounds): one
	more fix for bug #107949: don't take the selection into
	account if we are operating on the selection itself.

	Ordered shadow tiles functions together, cleanup.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-stroke.c
	(picman_drawable_stroke_scan_convert): added new local variables to
	hold the drawable's offsets instead of abusing x2 and y2. Use
	existing APIs instead of re-implementing stuff. Removed an
	obsolete call to tile_manager_set_offsets(). Cleanup.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_new_from_alpha): create
	a channel which the size of the layer, not of the image...

	* app/core/picmanchannel-select.c (picman_channel_select_alpha):
	...and take the layer's offsets into account.

	* app/core/picmanscanconvert.[ch] (picman_scan_convert_render): added
	off_x and off_y parameters and don't use the passed TileManager's
	offsets.

	* app/core/picmanchannel-select.c
	* app/core/picmandrawable-stroke.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c (app_init): fixed starting with --no-splash.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: added new virtual functions
	PicmanDrawable::get_active_components(), apply_region() and
	replace_region().

	* app/core/Makefile.am
	* app/core/picmandrawable-combine.[ch]: new files containing
	apply_region()'s and replace_region()'s default implementation.
	They are identical to the ones removed from PicmanImage except that
	they don't mask the selection with itself (bug #107949).

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: implement get_active_components().

	* app/core/picmanchannel.c: implement apply_region() and
	replace_region() and invalidate the channel's boundary
	before upchaining (bug #107949).

	* app/core/picmanimage.[ch]: removed picman_image_apply_image(),
	picman_image_replace_image() and picman_image_get_active_components().

	* app/core/picmanimage-undo-push.c (undo_pop_image): invalidate
	boundary and bounds if the drawable is a channel (bug #107949).

	(undo_pop_mask)
	(undo_pop_channel_mod): finish previous commit :)

	* app/core/picman-edit.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer-floating-sel.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmaninktool.c: changed accordingly.

2003-10-06  Michael Natterer  <mitch@picman.org>

	Treat changes to the selection like changes to any other drawable:

	* app/core/picmanchannel.c
	* app/core/picmanchannel-combine.c: call picman_drawable_update() after
	changing the channel.

	* app/core/picmanimage.[ch]: added struct PicmanImageFlushAccumulator
	with one member "gboolean mask_changed". Connect to "update" of
	the selection and set accum.mask_changed to TRUE in the callback.
	Added default implementation for PicmanImage::flush() and emit
	"mask_changed" there.

	Unrelated:
	* app/core/picmanimage.h: removed PicmanGuide struct...
	* app/core/picmanimage-guides.h: ...and added it here.

	* app/core/picmanimage-undo-push.c (undo_pop_mask)
	(undo_pop_channel_mod): don't distinguish between selection and
	non-selection channels and just call picman_drawable_update().

	* app/core/picmanundo.h
	* app/core/picmanimage-undo.c: removed "gboolean mask_changed" from
	the PicmanUndoAccumulator struct since we don't have to care about
	that signal explicitly any more.

	* app/display/picmandisplay-foreach.[ch]: removed picman_displays_flush().

	* tools/pdbgen/pdb/display.pdb (displays_flush_invoker): call
	picman_image_flush() on all images so the flush accumulator is
	honored.

	This generalization enables the removal of more special purpose
	code which was needed to treat the selection different:

	* app/core/picmanimage-mask-select.[ch]: removed...

	* app/core/picmanchannel-select.[ch]: ...and added under a new name
	because it's not selection specific any more.

	* app/core/picmanimage-mask.[ch]: removed...

	* app/core/picmanselection.[ch]: ...added the two remaining
	functions here. Removed all calls to picman_image_mask_changed().

	* app/core/Makefile.am
	* app/core/picman-edit.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-snap.c
	* app/display/picmandisplayshell.c
	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/gui/select-commands.c
	* app/gui/vectors-commands.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanvectorstreeview.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: changed accordingly.

	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanimage-colormap.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/gui/image-menu.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmancroptool.c
	* app/tools/picmaninkoptions.c
	* app/tools/picmanvectortool.c: removed useless and/or obsolete
	#includes.

	* app/pdb/display_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: guard callbacks
	against being invoked during display destruction. Fixes crashes
	when closing/opening images. Also fixes the crash reported by
	Pedro Gimeno in the comment to bug #117884, but doesn't fix
	#117884 since it's a different issue.

2003-10-06  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c (tool_manager_image_undo_start): HALT
	the tool with the right display. Fixes some random tool crashes.

2003-10-06  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_data_drop_handle): check for
	NULL pointers in the PicmanDndDataDef array before using them.
	Might happen with the changed dockable DND code :(

2003-10-06  Sven Neumann  <sven@picman.org>

	* Made 1.3.21 release.

2003-10-05  Sven Neumann  <sven@picman.org>
	
	* app/widgets/picmandock.c (picman_dock_separator_drag_drop): handle
	dockable drops where the drag source is a PicmanDockable itself.

	* etc/sessionrc: try a new default dialog setup.

2003-10-05  Sven Neumann  <sven@picman.org>

	* app/gui/tool-options-menu.c (tool_options_menu_update): removed
	unused variables.

2003-10-05  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c: set the screen resolution before
	setting the initial scale; update it in GtkWidget::screen_changed.

2003-10-05  Sven Neumann  <sven@picman.org>

	* app/composite/Makefile.am: added missing file.

2003-10-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.[ch]
	* app/widgets/picmandockable.[ch]: hide the PicmanDockbook tabs when
	it holds only a single dockable. Made the title area a drag source
	and let the whole PicmanDockable accept drops of dockables.

2003-10-05  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/paint-funcs/paint-funcs.c (shrink_line): Use gint instead
	of guint. Fixes Debian bug report #205889 (spotted by Falk
	Hueffner).

2003-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c (load_image): applied a patch from Morten
	Eriksen that fixes loading of monochrome images (bug #123886).

2003-10-04  Dave Neary  <bolsh@picman.org>

	* app/tools/picmanhuesaturationtool.c 
	(picman_hue_saturation_tool_initialize): Removed explicit 
	initialisation to PICMAN_ALL_HUES, this is set by default the 
	first time the tool is opened, and shouldn't be set successive 
	times. Fix suggested by edg1@freegates.be in Bugzilla. Fixes 
	bug #123731.

2003-10-02  Sven Neumann  <sven@picman.org>

	* app/app_procs.c (app_exit_after_callback): enabled the call to
	exit() again.

2003-10-02  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/carved-logo.scm: unset the image
	filename.

2003-10-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c (picman_item_convert,picman_item_real_convert):
	set the item's new image *after* converting it because we need the
	old image's colormap for conversions from and to INDEXED.
	Fixes bug #123625.

2003-10-02  Michael Natterer  <mitch@picman.org>

	Cleaned up the app init and exit stuff even more. Also reduces the
	number of missing symbols for picman-console. Added init and exit
	debugging output (only for --verbose).

	* app/core/picmanmarshal.list
	* app/core/picman.[ch]: added new signals "initialize" and
	"restore".  Moved plug_ins_init() to Picman::restore()'s default
	implementation and plug_ins_exit() to Picman::exit()'s default
	implementation. Renamed picman_set_config() to picman_load_config()
	and load PicmanRC here. Moved base_init() and base_exit() to this
	file, too.

	* app/gui/Makefile.am
	* app/gui/gui-vtable.[ch]: new files split out of gui.c. It was
	simply too large.

	* app/gui/gui.[ch]: renamed gui_themes_init() to gui_init(),
	connect to Picman's "initialize" and "restore" signals and create
	the GUI stuff in the callbacks. Removed most other public
	functions since they don't need to be called explicitly any more.
	Moved the whole tool initialization/shutdown code to this file.

	* app/gui/user-install-dialog.[ch]: changed
	user_install_dialog_create() to user_install_dialog_run() and
	added a gtk_main() at the end, so the install dialog's gtk_main()
	and gtk_main_quit() live in the same file.

	* app/app_procs.c: removed lots of stuff. app_init() is much
	simpler now.

2003-10-02  Michael Natterer  <mitch@picman.org>

	* app/gui/tool-options-commands.c
	(tool_options_save_to_cmd_callback): remember the name of the
	saved options and set it again after picman_config_copy_properties().
	Fixes bug #123660.

2003-10-02  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c: added back ellipsis to Display Filters and
	Configure Grid.

2003-10-02  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/mosaic/*: removed mosaic plug-in here...

	* plug-ins/common/Makefile.am
	* plug-ins/common/mosaic.c
	* plug-ins/common/plugin-defs.pl: ...and added it in plug-ins/common.

2003-10-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plugindetails.c
	* plug-ins/common/unsharp.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/scripts/swirly-pattern.scm: tweaked menu items.

2003-10-02  Sven Neumann  <sven@picman.org>

	* app/gui/brushes-menu.c
	* app/gui/channels-menu.c
	* app/gui/colormap-editor-menu.c
	* app/gui/image-menu.c
	* app/gui/templates-menu.c
	* app/gui/vectors-menu.c: added ellipsis back for Edit menu items.
	Added missing ellipsis for Stroke items.

2003-10-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/FractalExplorer/Events.[ch]: splitting the dialogs and the
	events didn't make sense. Code merged with Dialogs.[ch] and files
	removed.

	* plug-ins/FractalExplorer/Dialogs.[ch]
	* plug-ins/FractalExplorer/FractalExplorer.[ch]: major code clean-up.
	Still lots of work to do (remove several deprecated widgets, etc.)

2003-10-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/mosaic/mosaic_logo.h: removed (!) to make the plug-in more
	consistent with other plug-ins.

	* plug-ins/mosaic/Makefile.am
	* plug-ins/mosaic/mosaic.c: changed accordingly + minor code clean-up.
	Plug-in can now be moved to common directory since it's just a single
	file.

2003-10-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def: added new symbols.

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/gui/brushes-menu.c
	* app/gui/channels-menu.c
	* app/gui/colormap-editor-menu.c
	* app/gui/dialogs-menu.c
	* app/gui/documents-menu.c
	* app/gui/image-menu.c
	* app/gui/palettes-menu.c
	* app/gui/templates-menu.c
	* app/gui/toolbox-menu.c
	* app/gui/vectors-menu.c
	* plug-ins/common/uniteditor.c	
	* plug-ins/dbbrowser/dbbrowser.c: followed the HIG advisory on
	labelling menus with a trailing ellipsis and removed some.

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: renamed
	picman_prop_size_entry_connect() to picman_prop_coordinates_connect().
	Added a new property widget that is a single PicmanSizeEntry and is
	connected to size and unit properties.

	* app/widgets/picmantemplateeditor.c: changed accordingly.
	
	* app/widgets/picmanstrokeeditor.c: added a "resolution" property
	and use the new property widget.

	* app/gui/stroke-dialog.c: pass the image resolution to
	picman_stroke_editor_new().

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-altivec.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse2.c
	* app/composite/picman-composite-vis.c: moved includes out of the
	#if __GNUC__ >= 3 to make the code compile on other compilers.

	* app/composite/picman-composite-3dnow.[ch]: added the same stubs here
	for symmetry.

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-unit.[ch]: added small wrappers to ease
	handling of image units and to hide the core PicmanUnit API.

	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-title.c
	* app/display/picmanstatusbar.c
	* app/gui/info-window.c:
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanscaletool.c: use the new functions.

	* app/core/picman-units.c
	* app/vectors/picmanvectors-export.c: use the core PicmanUnit API.

	* app/vectors/picmanvectors.c: no need to include picmanunit.h here.

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.c (picman_config_diff): make it handle
	aggregate object properties by calling itself recursively.

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout.c: pango_font_description_set_size()
	takes points not pixels as the old code assumed.

	* app/text/picmantext.c
	* app/text/picmantextlayout-render.c: fixed includes.
	
2003-10-01  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-altivec.c: added missing code
	snippets to make it compile on PPC.

	* plug-ins/common/destripe.c: avoid division by zero (bug #123592).
	Also made the plug-in remember the state of the history toggle and
	other cleanup. The filter result still looks wrong though...

2003-10-01  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-compat.c (text_get_extents): set a default
	resolution on the fontmap since Pango doesn't seem to do this for us.

2003-10-01  Simon Budig  <simon@picman.org>

	* app/base/boundary.[ch]: a little bit of tweaking.

	* app/paint/picmanpaintcore-stroke.c: Use it here too.

2003-10-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.c (picman_size_entry_update_unit):
	emit "value_changed" again.

2003-10-01  Simon Budig  <simon@picman.org>

	* app/base/boundary.[ch]: Implemented simplify_boundary (),
	which tries to reduce the number of coordinates to get
	better interpolation for stroking.

	The results still need tweaking.

	* app/core/picmandrawable-stroke.c: Use it.

2003-10-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanunitmenu.[ch]:
	* libpicmanwidgets/picmanwidgets.c: added an API to allow for
	sub-pixel sizes in spinbuttons connected to a PicmanUnitMenu.
	Make PicmanUnitMenu emit "unit-changed" when the unit is changed
	programmatically.

	* libpicmanwidgets/picmansizeentry.[ch}: added a similar API here.
	Make PicmanSizeEntry emit "unit-changed" when the unit is changed
	programmatically. The other signals will need similar changes.

	* plug-ins/common/gauss_rle.c
	* plug-ins/common/gauss_iir.c
	* app/widgets/picmanstrokeeditor.c: use the new API.

2003-09-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_new): accept NULL
	as blurb and use the name as fallback for a missing blurb.

	* app/gui/dialogs-constructors.c: removed the "Foo List" and "Foo
	Grid" blurbs. Only left blurbs where the longer name makes sense.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/gui/tool-options-menu.c: added a "Rename Saved Options"
	submenu and factored on-the-fly submenu creation out to a utility
	function.

	* app/gui/tool-options-commands.[ch]: added rename callback.

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_TOOL_OPTIONS_RENAME.

	* app/widgets/picmantooloptionseditor.c
	(picman_tool_options_editor_menu_popup): pass "button = 0" to
	gtk_menu_popup() because we show the menu on button_release, not
	on button_press.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanscanconvert.[ch]: removed "width", "height" and
	"antialias" from the PicmanScanConvert struct and from
	picman_scan_convert_new(). Removed picman_scan_convert_to_channel().
	Added "gboolean antialias" to picman_scan_convert_render().
	Some general cleanup.

	* app/core/picmandrawable-stroke.c
	* app/core/picmanimage-mask-select.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

	* app/core/picmandrawable-stroke.c: renamed
	picman_drawable_stroke_scanconvert_stroke() to
	picman_drawable_stroke_scan_convert() and removed the "gboolean
	use_mask_bounds" parameter since we can't decide if it's the
	selection's boundary which is stroked. Instead use
	picman_channel_is_empty() on the selection which will return FALSE
	while the selection is being stroked.

	* app/paint/picmanpaintcore-stroke.c: cleanup.

	(picman_paint_core_stroke_boundary): don't use "gint i" twice.

	(picman_paint_core_stroke_vectors): no need to manually close a
	closed stroke.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_stroke): pass the channel's
	offsets to picman_paint_core_stroke_boundary().

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: implement
	GtkWidget::popup_menu() and pop up the menu from the selected
	item. If there is no selected item, return FALSE to
	makePicmanDockable pop up the menu from its menu button.

2003-09-30  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs-commands.c (dialogs_create_dockable_cmd_callback):
	accept a list of dialog identifiers and try to raise an existing
	dockable from the list. If that fails, create a new one from the
	first entry.

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: specify alternative dialog identifiers
	where appropriate.
	
	* app/vectors/picmanstroke.c (picman_stroke_interpolate): use NULL
	instead of 0.

2003-09-30  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c:
	(picman_bezier_stroke_interpolate) Accept NULL for ret_closed.

	* app/widgets/picmanpreviewrenderervectors.c: removed "closed"
	variable.

	* app/core/picmandrawable-stroke.[ch]: Factored out the final
	rendering of the scanconvert. Implemented
	picman_drawable_stroke_boundary. Unfortunately the results are
	not really good, since the boundary calculation code is
	too exact for this purpose. I have a rough idea how to fix this.

	* app/core/picmanchannel.c: changed accordingly.

2003-09-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreviewrenderervectors.c: fixed preview of
	closed paths.
	
2003-09-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreviewrenderer.c
	* app/widgets/picmanpreviewrenderervectors.c: simplified drawing
	code to a point where it becomes readable again. Draw centered
	into the draw_area, using the size of the renderer.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-stroke.c: cleanup.

	(picman_paint_core_stroke_boundary): don't push a separate undo
	for each part of the boundary.

	* app/core/picmandrawable-stroke.[ch]: added empty stub
	picman_drawable_stroke_boundary(). Changed
	picman_drawable_stroke_vectors() to take the PicmanStrokeOptions as
	second parameter.

	* app/core/picmanchannel.c (picman_channel_stroke): use it. No need
	to push an undo group around picman_paint_core_stroke_boundary().

	* app/vectors/picmanvectors.c: changed accordingly.

	* app/widgets/picmanselectioneditor.[ch]: added a PicmanStrokeItemFunc
	pointer and use it for stroking.

	* app/gui/edit-commands.[ch] (edit_stroke_selection): a
	PicmanStrokeItemFunc which strokes the selection using the
	stroke-dialog.

	* app/gui/dialogs-constructors.c: use it for the selection editor.

2003-09-30  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.[ch]: replaced
	picman_scan_convert_set_resolution with 
	picman_scan_convert_set_pixel_ratio where you specify the pixel
	ratio (width/height). Also made the stroke-width consistent
	with other places in the picman by using the Y-Resolution as
	the base for the calculations.

	* app/core/picmandrawable-stroke.c: changed accordingly.

2003-09-30  Sven Neumann  <sven@picman.org>

	* NEWS: updated.

2003-09-30  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-stroke.c
	* app/core/picmanstrokeoptions.[ch]
	* app/gui/stroke-dialog.c: removed the resolution property again.
	The object should stay resolution independent. The resolution can
	be taken from the image it is used with.

2003-09-30  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.[ch]: Added support for setting
	X- and Y-resolution for stroking paths. The width of a path
	has to be given in pixels, using X-resolution.

	* app/core/picmanstrokeoptions.[ch]: Added "resolution" property,
	so that conversion between various width-units can happen.
	Should be set to the target images X-resolution.

	* app/gui/stroke-dialog.c: set the resolution of the options.

	* app/core/picmandrawable-stroke.c: Use that stuff, cleanup.

2003-09-30  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picmanitem-preview.[ch]: new files with preview code
	factored out of PicmanDrawable.

	* app/core/picmandrawable-preview.[ch]: code removed here.

	* app/core/picmandrawable.c
	* app/core/picmanitem.c: let PicmanItem implement
	PicmanViewable::get_preview_size and PicmanViewable::get_popup_size.

	* app/widgets/picmanpreviewrenderervectors.c: simple scale to the
	renderer's size; it already respects the aspect ratio.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantooloptionseditor.c: connect to the "add" and
	"remove" signals of the current tool_option's presets container
	and set the "Restore" and "Delete" buttons insensitive when there
	are no saved tool options. Also show the "Enter Name" dialog
	directly instead of popping up a menu with only one item.

2003-09-30  Michael Natterer  <mitch@picman.org>

	* app/gui/tool-options-menu.[ch] (tool_options_menu_setup): new
	function for stuff which needs to be done once, not on every
	tool_options_menu_update(). Cleanup.

	* app/gui/menus.c: register it as setup_func of <ToolOptions>.

	* app/gui/tool-options-commands.c: removed the "Reset"
	implementations and activate PicmanToolOptionsEditor's buttons
	accordingly.

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_TOOL_OPTIONS_DELETE.

	* app/widgets/picmantooloptionseditor.[ch]: moved "Reset"
	implementations to this file. Added "Delete" button. Pop up the
	"Save", "Restore" and "Delete" submenus of the <ToolOptions>
	item_factory when the resp. buttons are clicked.

2003-09-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmantoolinfo.[ch]: added a PicmanContainer of tool
	options presets.

	* app/core/picmantooloptions.[ch] (picman_tool_options_set_property):
	silently accept setting the *same* tool_info again.

	(picman_tool_options_build_filename): is public now.

	* app/tools/picman-tools.c (picman_tools_restore,save): load and save
	the presets container.

	* app/gui/tool-options-dialog.[ch]: removed.

	* app/gui/tool-options-commands.[ch]
	* app/gui/tool-options-menu.[ch]: new files implementing a menu
	for the new PicmanToolOptionsEditor widget. Has submenus for saving,
	loading, and deleting tool options to/from the
	tool_info->options_presets container.

	* app/gui/Makefile.am
	* app/gui/dialogs-constructors.c
	* app/gui/menus.c: changed accordingly.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmantooloptionseditor.[ch]: the tool options dialog
	as proper widget. The "Load" and "Save" buttons still do the same
	stuff as before. Will make them use the new presets since making
	them do something useful was the reason for this whole change.

	* app/widgets/picmanhelp-ids.h: added missing help IDs for the tool
	options dialog.

2003-09-29  Michael Natterer  <mitch@picman.org>

	Fixed handling of G_PARAM_CONSTRUCT_ONLY properties:

	* app/config/picmanconfig.c (picman_config_iface_duplicate): build
	a GParameter array of G_PARAM_CONSTRUCT_ONLY properties and
	use g_object_newv() instead of g_object_new() to create the
	copy.

	* app/config/picmanconfig-utils.c
	(picman_config_copy_properties)
	(picman_consif_reset_properties): don't try to copy/reset
	G_PARAM_CONSTRUCT_ONLY properties because it is impossible.

	(picman_config_connect_notify): ditto. Also don't try to read
	from unreadable or write to unwritable properties.

2003-09-29  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c: minor cleanups.

	(picman_crop_tool_modifier_key): s/crop-type/crop-mode/. Fixes tool
	toggling which was broken after my PicmanCropMode change.

	(crop_tool_crop_image): replaced parameter "gboolean crop_layers"
	by "PicmanCropMode crop_mode". Makes its callers simpler and more
	readable.

2003-09-29  Simon Budig  <simon@picman.org>

	* app/widgets/picmanpreviewrenderervectors.c: Fixed a bad crash
	(Thanks to Sven for spotting that). Minor cleanups.

2003-09-29  Simon Budig  <simon@picman.org>

	* app/widgets/picmanpreviewrenderervectors.c: Made the preview
	respect the aspect ratio and resolutions of the image. There
	apparently still is an off-by-one error in it.

	* app/tools/picmanvectortool.c: (Hopefully) fixed a crash when a new
	image gets opened with the vectors tool active.

2003-09-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreviewrenderer.[ch]: made draw a virtual method
	of PicmanPreviewRenderer. Draw the border in the wrapper function.

	* app/widgets/picmanpreviewrenderervectors.c: implement
	PicmanPreviewRenderer::draw instead of PicmanPreviewRenderer::render.

2003-09-29  Simon Budig  <simon@picman.org>

	* app/widgets/picmanpreviewrenderervectors.c: Made these widgets
	show a preview of the vectors object. Does not work everywhere
	right now, also most probably has scaling issues for non-square
	images.

	* app/tools/picmandrawtool.c: Fixed Svens fix.

2003-09-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanstrokeoptions.[ch]: removed "dash-unit" property and
	renamed "width-unit" to "unit".

	* app/core/picmandrawable-stroke.c
	* app/widgets/picmanstrokeeditor.c: changed accordingly.

2003-09-28  Ville PÃ¤tsi <drc@picman.org>

	* themes/Default/images/stock-join-bevel-16.png: Properly corrected
	the icon.
	
2003-09-29  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.c: Fixed glitch to enable dashed
	strokes with width < 1.0.

	* app/core/picmandrawable-stroke.c: Actually pass the miter
	limit to picman_scan_convert_stroke ().

2003-09-28  Ville PÃ¤tsi <drc@picman.org>

	* picman/themes/Default/images/stock-join-bevel-16.png: Corrected the
	icon.

2003-09-28  Sven Neumann  <sven@picman.org>

	* app/gui/stroke-dialog.c (stroke_dialog_new): as a temporary hack,
	let the Stroke Dialog remember the last used stroke options.

2003-09-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-duplicate.c (picman_image_duplicate): also
	duplicate vectors and grid.

2003-09-28  Ville PÃ¤tsi <drc@picman.org>

	* picman.spec.in: Removed post install processing to finally completely
	disable stripping.

2003-09-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c (picman_scan_convert_free)
	(picman_scan_convert_finish): plugged memleaks and added some sanity
	checks.

	* app/base/pixel-region.c
	* app/core/picmandrawable-preview.c: removed trailing whitespace.

	* app/tools/picmandrawtool.c (picman_draw_tool_on_vectors_curve):
	picman_stroke_nearest_point_get() doesn't set cur_pos when there are
	no strokes; don't use the uninitialized variable.

2003-09-28  Ville PÃ¤tsi <drc@picman.org>

	* themes/Default/images/stock-join-round-16.png
	* themes/Default/images/stock-join-miter-16.png
	* themes/Default/images/stock-join-bevel-16.png
	* themes/Default/images/stock-cap-square-16.png
	* themes/Default/images/stock-cap-round-16.png
	* themes/Default/images/stock-cap-butt-16.png: Changed these icons.

2003-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanvector.c: fixed inline documentation.

2003-09-28  Simon Budig  <simon@picman.org>
            Fabian Franz  <debian@fabian-franz.de>

	Ok, this time for real - I did not expect to be still awake
	at 7:30 am...   :-)

	* plug-ins/common/animoptimize.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/tile.c: Fixed Undo issues. Plugins creating
	new images should create an empty undo history. Sprinkeling
	picman_image_enable_undo() at the end of the plugins operations
	does the trick. It makes sense to do this *before* you add
	a display to the image, otherwise the UI gets out of sync.

2003-09-28  Simon Budig  <simon@picman.org>

	"The last of the Oldenburg commits"

	Thanks to the team of the Oldenburg Linux Developers Meeting 2003
	for providing a nice hacking environment.

	* app/vectors/picmanvectors.c: Add a default stock_id.

	* app/widgets/picmanpreviewrenderervectors.[ch]: New Widget
	to render the preview of vectors. Just renders a stock item
	now, since I was unable to figure out how to properly draw
	in the GtkWidget.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h: Changed accordingly.

	* app/widgets/picmanpreviewrenderer-utils.c: Use the new widget.

	* app/core/picmanscanconvert.c
	* app/core/picmandrawable-stroke.c: Use higher prescision for
	libart-stroking vectors. Reduces artefacts.

	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.c: Regenerated after Tors changes.

2003-09-28  Tor Lillqvist  <tml@iki.fi>

	* tools/pdbgen/pdb/paths.pdb: Fix some documentation strings.

2003-09-28  Sven Neumann  <sven@picman.org>

	* app/gui/resolution-calibrate-dialog.c (resolution_calibrate_ok):
	use the PICMAN_COORDINATES_CHAINBUTTON() macro instead of trying to
	get it using a hardcoded and misspelled identifier.

2003-09-28  DindinX <david@dindinx.net>

	* libpicmanmath/picmanmatrix.[ch]:
	* libpicmanmath/picmanmd5.[ch]:
	* libpicmanmath/picmanvector.[ch]:
	* libpicmanmath/test-md5.c: Removed tabs and trailing whitespaces.

2003-09-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_transform_temp_buf): use a much
	simpler and shorter method of determining how to transform the
	TempBuf.

2003-09-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-bucket-fill.c
	(picman_drawable_bucket_fill_full): some more small cleanups.

2003-09-28  DindinX <david@dindinx.net>

	* libpicmanmath/picmanvector.[ch]: added documentation and fixed
	  small typos.

2003-09-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-bucket-fill.c
	(picman_drawable_bucket_fill_full): set the transformed color's
	alpha to OPAQUE so it works with color_region().

	* app/core/picmandrawable-stroke.c (picman_drawable_stroke_vectors):
	no need to transform the color into a newly allocated array,
	simply use guchar[MAX_CHANNELS] instead.

	Cleaned up both functions to use RED_PIX, GREEN_PIX and BLUE_PIX
	instead of 0, 1 and 2.

2003-09-27  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: added new functions
	color_region_mask() which works like color_region() but takes an
	additional maskPR parameters and pattern_region() which fills
	destPR with a TempBuf of *matching color depth*.

	* app/paint-funcs/paint-funcs-generic.h: added corresponding
	color_pixels_mask() and pattern_pixels().

	* app/core/picmanimage.[ch] (picman_image_transform_temp_buf): new
	function which transforms a TempBuf to a specified drawable's
	color space.

	* app/core/picmandrawable-bucket-fill.c: the functions were factored
	out here. Removed them and use the new stuff.

	* app/core/core-enums.[ch]: added enum PicmanStrokeStyle which can
	be one of { SOLID, PATTERN }.

	* app/core/picmanstrokeoptions.[ch]: added "PicmanStrokeStyle style"
	property, cleanup.

	* app/core/picmandrawable-stroke.c: honor the new "style" property
	and call the new color_region_mask() and pattern_region()
	functions accordingly, cleanup.

	* app/widgets/picmanstrokeeditor.c: added a GUI for the stroke
	style. Ugly but works.

	* app/gui/stroke-dialog.c: undefine "foreground" and "pattern" and
	set the user context as parent context so we get these properties
	from the global settings.

2003-09-27  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-cap-[butt|round|square]-16.png
	* themes/Default/images/stock-join-[miter|round|bevel]-16.png:
	added placeholders for PicmanCapStyle and PicmanJoinStyle icons.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/widgets/picmanstrokeeditor.c: made "options" a construct-only
	property of the editor and create the widgets in a constructor
	method. Use stock boxes with the new icons.

	* app/gui/stroke-dialog.c (stroke_dialog_new): let the Cancel
	button destroy the dialog instead of itself.

2003-09-27  Simon Budig  <simon@picman.org>

	* app/core/picmandrawable-stroke.[ch]: changed the API of
	picman_drawable_stroke_vectors to accept PicmanStrokeOptions
	instead of lots of individual parameters.

	* app/vectors/picmanvectors.c: changed accordingly.

2003-09-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanstrokeoptions.[ch]: added unit properties for
	stroke width and dashes. Use convenience macros from PicmanConfig to
	register the properties. Removed init function since all values
	are construct properties.

	* app/vectors/picmanvectors.c: respect the stroke width unit.

	* app/widgets/picmanstrokeeditor.c: added a unit menu here.

2003-09-27  Michael Natterer  <mitch@picman.org>

	* app/gui/stroke-dialog.[ch]: made it a view on the PicmanItem to
	stroke, not on the image, so the dialog goes away automatically if
	the item is removed from the image. Don't pass a PicmanStrokeOptions
	to stroke_dialog_new() until we figured how to handle a list of
	presets or at least the last used options object. Also don't pass
	a PicmanDrawable, get the active_drawable in the "ok" callback
	instead. Attach less pointers to the dialog and simplified stuff.

	* app/gui/vectors-commands.c (vectors_stroke_vectors): changed
	accordingly, removed commented out cruft.

2003-09-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpaintinfo.[ch]: derive it from PicmanViewable.

	* app/core/picmantoolinfo.c (picman_tool_info_new): set the
	paint_info's stock_id from the tool_info's stock_id.

	* app/widgets/widgets-types.h: resurrected PicmanItemStrokeFunc.

	* app/widgets/picmanvectorstreeview.[ch]: added a item_stroke_func
	pointer and use it instead of implementing stroking here.

	* app/gui/vectors-commands.[ch]: added vectors_stroke_vectors()
	which has the signature of a PicmanItemStrokeFunc.

	* app/gui/dialogs-constructors.c: use it for the paths dialog.

	* app/gui/stroke-dialog.[ch]: extended to handle both libart and
	PicmanPaintCore stroking. Use a PicmanContainerMenu view on the
	picman->paint_info_list container to select the paint core to use.

2003-09-27  Sven Neumann  <sven@picman.org>

	* app/gui/info-window.c (info_window_update): improved readability
	of this code by introducing a local PicmanImage* variable.

	* app/composite/picman-composite-regression.c: use a matching format
	string for an u_long variable (should probably use gulong instead).

	* app/composite/make-installer.py: output a short note about what
	tests are going to be run.

	* app/composite/picman-composite-3dnow-test.c
	* app/composite/picman-composite-altivec-test.c
	* app/composite/picman-composite-mmx-test.c
	* app/composite/picman-composite-sse-test.c
	* app/composite/picman-composite-sse2-test.c
	* app/composite/picman-composite-vis-test.c: regenerated.

2003-09-27  Michael Natterer  <mitch@picman.org>

	* app/gui/info-window.c (info_window_update): honor the
	default-resolution-unit when displaying the image's resolution.
	Fixes bug #123336.

2003-09-26  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-altivec-test.c
	* app/composite/picman-composite-mmx-test.c
	* app/composite/picman-composite-mmx-installer.c
	* app/composite/picman-composite-sse-test.c
	* app/composite/picman-composite-sse-installer.c
	* app/composite/picman-composite-sse2-test.c
	* app/composite/picman-composite-sse2-installer.c
	* app/composite/picman-composite-vis-test.c
	* app/composite/picman-composite-vis-installer.c:
	  Regenerated.

	* app/composite/picman-composite-altivec.[ch]
	* app/composite/picman-composite-mmx.[ch]
	* app/composite/picman-composite-sse.[ch]
	* app/composite/picman-composite-sse2.[ch]
	* app/composite/picman-composite-vis.[ch]
	* app/composite/make-installer.py:
	  Make it such that when a test is run on the wrong kind of
	  machine, don't fail without an explanation.

2003-09-27  Simon Budig  <simon@picman.org>

	This still is very much in progress. I just want to commit this
	to avoid lossage. It kind of works but there definitely is
	code in the wrong place now.

	* app/gui/stroke-dialog.[ch]: New files implementing a dialog
	containing Svens PicmanStrokeEditor-Widget.

	* app/gui/Makefile.am: changed accordingly.

	* app/gui/vectors-commands.c: Open the StrokeOptions-Dialog when
	the "stroke" menu entry gets selected.

	* app/vectors/picmanvectors.c: Remove bad #ifdef hacks and use
	Libart/Paintcore-Stroking depending on the type of the stroke_desc
	Parameter.

	* app/core/picmanstrokeoptions.c: Proper handle the Enum-Properties.

	* app/core/picmanscanconvert.[ch]: make the antialias-parameter
	to picman_scan_convert_new a gboolean.

	* app/tools/picmaniscissorstool.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmanimage-mask-select.c: Changed accordingly.

2003-09-26  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h	
	* app/widgets/picmanstrokeeditor.[ch]: added a (yet rudimentary)
	widget to view/edit a PicmanStrokeOption.

	* app/widgets/picmantemplateeditor.[ch]: derive it directly from
	GtkVBox; it doesn't need any PicmanEditor functionality.

2003-09-26  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paths.pdb: apply Simon's changes (PICMAN_OBJECT
	casts) to here, since they are generated files.

2003-09-26  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: #include
	"widgets/picmanwidgets-utils.h" for picman_button_menu_position().

2003-09-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/Makefile.am: don't scan "app/tools/tools-enums.h"
	for PDB types since the PDB doesn't depend on app/tools/ any more.

	* app/tools/tools-enums.h: removed lengthy "skip" vs. "pdb-skip"
	comment. Removed "pdb-skip" from all enums. Renamed PicmanCropType
	to PicmanCropMode, renamed the enum's values to PICMAN_CROP_MODE_*.

	* app/tools/tools-enums.c: regenerated.

	* app/tools/picmancropoptions.[ch]
	* app/tools/picmancroptool.c: changed accordingly.

2003-09-26  Simon Budig  <simon@picman.org>

	* app/core/picmanstrokeoptions.[ch]: New Object, holding the
	Options for a Libart-Stroke.

	* app/core/Makefile.am
	* app/core/core-types.h: Changed accordingly.

	* app/core/picmanitem.[ch]: Changed the signature of
	picman_item_stroke() to accept a PicmanObject instead of a
	PicmanPaintInfo. This enables us to pass PicmanStrokeOptions
	to it. To be cleaned up for 2.2.

	* app/core/picmanselection.c
	* app/core/picmanchannel.c
	* app/vectors/picmanvectors.c: Changed accordingly

	* app/gui/edit-commands.c
	* app/gui/vectors-commands.c
	* app/pdb/edit_cmds.c
	* app/pdb/paths_cmds.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanvectorstreeview.c: Fixed warnings by
	casting the PicmanPaintInfo to PicmanObject.

2003-09-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.c: removed inclusion of
	"picmantoolbox-color-area.h".

2003-09-26  Michael Natterer  <mitch@picman.org>

	Cleaned up all places which pick colors to work consistently: the
	concept of an "active color" has disappeared, instead <ctrl> picks
	the BG color all over the place (fixes bug #122931).

	* app/tools/tools-enums.[ch]: added enum PicmanColorPickMode which
	can be one of { FOREGROUND, BACKGROUND }. Reordered enums so
	non-registered ones are at the end of the file. Removed trailing
	whitespace.

	* app/tools/picmancolorpickeroptions.[ch]: added a "pick-mode"
	property and a GUI for it. Renamed the "update-active" property to
	"update-toolbox".

	* app/tools/picmancolorpickertool.c: honor the new option. Toggle
	pick-mode on <ctrl>.

	* app/tools/picmancolortool.[ch]: added pick_mode member and change
	the cursor accordingly.

	* app/widgets/picmancolormapeditor.[ch]: added "GdkModifierType
	state" to the "selected" signal. Removed the signal's default
	implementation.

	* app/gui/dialogs-constructors.c: fixed the signal handler which
	lives here and set BG if <ctrl> was pressed.

	* app/widgets/picmanpaletteeditor.c: removed weird <ctrl> <->
	active_color interaction and pick BG on <ctrl>. Don't change the
	toolbox color when editing a color in the palette.

	* app/widgets/picmantoolbox-color-area.[ch]: made the whole
	active_color stuff private. Will remove these artefacts soon...

	* app/gui/colormap-editor-menu.c
	* app/gui/palette-editor-menu.c: added separate menu entries
	for adding a color from the current FG and BG.

	* app/gui/colormap-editor-commands.c
	* app/gui/palette-editor-commands.[ch]: changed callbacks
	accordingly.

	* cursors/background.xbm
	* cursors/background_mask.xbm
	* cursors/foreground.xbm
	* cursors/foreground_mask.xbm
	* cursors/picman-tool-cursors.xcf: moved the FG/BG cursor modifiers
	closer to the upper right corner.

	* app/widgets/picmancursor.c: ignore the cursor modifiers' hotspots
	since they are not relevant and I didn't save the hotspot in the
	updated cursor files for that reason.

2003-09-26  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.[ch]: Add some parameters to
	picman_scan_convert_stroke () to expose the Miter-Setting
	and enable dashing of vectors.

	* app/core/picmandrawable-stroke.c: Use the dashing feature.

	* app/vectors/picmanvectors.c: Expose a bad hack (opacity
	controls the libart-stroke width) in a #define. Default
	is not enabled.

2003-09-25  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picman.def
	* libpicman/picmanui.def: Add a couple of missing entries.

2003-09-25  DindinX <david@dindinx.net>

	* plug-ins/print/picman_main_window.c: small gui fixes in the
	select printer dialog.

2003-09-25  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c (picman_xml_parser_parse_io_channel):
	removed debugging output.

	* app/vectors/picmanvectors-import.c: simplified viewport handling
	and make it adhere to the spec again (hopefully my interpretation
	of the spec is right).

2003-09-25  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: more robust detection of svg
	nesting level; made scale-to-image work for non-pixel dimensions.

2003-09-25  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.[ch]: optionally scale the
	imported SVG to fit the image.

	* app/gui/vectors-commands.c: changed accordingly.

	* tools/pdbgen/pdb/paths.pdb: export the new scale parameter to
	the PDB.

	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

	* plug-ins/common/svg.c: scale the imported vectors to image size.
	This makes them always fit :)

2003-09-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/illusion.c: applied rest of patch from 
	yeti@physics.muni.cz to solve #72874

2003-09-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmisc.[ch]: code indentation

	* plug-ins/common/illusion.c: fix for #72874 (Incorrect RGBA 
	resampling in Illusion plug-in) plus code clean-up.

	* plug-ins/common/sinus.c: fix for #122379. Removed logo from UI.

	* plug-ins/common/diffraction.c
	* plug-ins/common/polar.c
	* plug-ins/common/ripple.c: code clean-up

2003-09-24  Sven Neumann  <sven@picman.org>

	* NEWS: list what's new since the last release.

	* app/core/core-enums.h: fixed a typo.

2003-09-24  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/jpeg.c: Set default value for toggle, and 
	only have it span one table cell.

2003-09-24  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.c (dialogs_get_view_menu_func):
	using picman_container_view_get_by_dockable() was a bad idea since
	not all our PicmanEditor subclasses actually are PicmanContainerViews.
	Find the right PicmanEditor manually instead (fixes missing popup
	menus).

	* app/gui/colormap-editor-menu.c (colormap_editor_menu_update):
	make the menu entries insensitive if the image is not indexed.
	fixes bug #123066.

2003-09-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_menu_position)
	* app/widgets/picmancontainerpopup.c (picman_container_popup_show):
	more menus which pop up correctly with RTL languages.

2003-09-24  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_table_attach_aligned): use a
	hbox instead of an alignment.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/gui/resize-dialog.c
	* app/widgets/picmantemplateeditor.c
	* plug-ins/common/svg.c: use horizontal boxes instead of alignments.
	Fixes dialog layout for RTL rendering.

	* plug-ins/common/png.c (save_dialog): only set the comment toggle
	active if there's a comment to save.

2003-09-23  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/jpeg.c: Fixed minor mistake in last commit.

2003-09-23  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/jpeg.c: Allow discarding of exif data if 
	HAVE_EXIF is enabled and the user doesn't want to keep it. 
	Closes bug #118384.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: added a utility function
	that positions a menu that pops up from a button widget.

	* app/display/picmandisplayshell-callbacks.c
	* app/widgets/picmandockable.c: use the new utility function instead
	of duplicating the code.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanlayertreeview.c (picman_layer_tree_view_init):
	pack the widgets without using an alignment. Looks better and
	works in RTL mode as well.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.[ch]: added the title pango layout to
	the PicmanDockable struct. Made picman_dockable_menu_position() handle
	RTL layout correctly.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_origin_menu_position): handle RTL layout.

2003-09-23  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanchainbutton.c (picman_chain_button_draw_lines): 
	fixed rendering for RTL layout.

2003-09-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanmenufactory.[ch]: added a "menu_title" which is
	registered with each menu.

	* app/widgets/picmanitemfactory.[ch]: added the title to the
	constructor and to the PicmanItemFactory struct.

	* app/gui/menus.c: register titles with all menus.

	* app/widgets/picmandockable.[ch]: show the tab menu, not the
	contained dialog's menu when clicking on the menu button.
	Embed the dialog's menu as submenu. Use the item_factory's
	title and the dockable's stock_id for the submenu entry.

	* app/widgets/picmaneditor.c: removed GtkWidget:popup_menu()
	implementation since that's done by PicmanDockable now.

	* app/widgets/picmandockbook.c: set the new menu item invisible
	when showing the menu as tab menu.

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_DOCK_TAB_DETACH
	and renamed _TAB_REMOVE to _TAB_CLOSE.

	* app/gui/dialogs-menu.c: added the new menu entry for showing the
	dialog's sub-menu. Added a "Detach" menu item, renamed "Remove" to
	"Close". Accept both a PicmanDockbook and a PicmanDockable pointer as
	"data" in dialogs_menu_update().

	* app/gui/dialogs-commands.[ch]: changed accordingly. Never use
	gtk_item_factory_popup_data_from_widget() but always the "data"
	passed to the callbacks. Take care to not set the already active
	preview_size, tab_style and list/grid type in the resp. callbacks
	to avoid being called from dialogs_menu_update().

	* app/gui/dialogs-constructors.c: removed separate
	set_context_funcs and get_menu_funcs for PicmanContainerView and
	PicmanContainerEditor widgets and simply use
	picman_container_view_get_by_dockable() to find the right widget.

2003-09-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c
	(picman_dialog_factories_restore_foreach): pass the menu_factory of
	the newly created dock to picman_dockbook_new(), not the one of the
	dialog_factory we are restoring (doesn't matter since we have only
	one global_menu_factory, but this code should still not do wrong
	things)

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/config/picmanscanner.c (picman_scanner_new_file): workaround for
	GLib bug #116617: set PicmanConfigError before calling g_strerror().
	Fixes bug #122939.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c (menus_last_opened_add): add a shortcut of
	Ctrl-0 for the 10th entry.

	* app/config/picmanguiconfig.c: increased the default
	last-opened-size from 4 to 10; increased the max-new-image-size
	from 32M to 64M.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c (parse_svg_viewbox): fixed the
	direction of the translation applied for viewBox offsets.

2003-09-23  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-menu-12.png: removed...

	* themes/Default/images/stock-menu-left-12.png
	* themes/Default/images/stock-menu-right-12.png: and added again
	together with a flipped version.

	* libpicmanwidgets/picmanstock.[ch]: register PICMAN_STOCK_MENU_LEFT and
	PICMAN_STOCK_MENU_RIGHT instead of PICMAN_STOCK_MENU and swap the
	images for RTL layout.

	* app/widgets/picmandockable.c: use PICMAN_STOCK_MENU_LEFT here.

	* app/display/picmandisplayshell.c: replaced the arrow in the
	display origin with the PICMAN_STOCK_MENU_RIGHT icon.

2003-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: show the pixel size specified by the SVG
	file and inform the user if it failed to provide one.

2003-09-23  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-close-12.png
	* themes/Default/images/stock-menu-12.png: perhaps the last
	  version looked too much like a disabled item.

2003-09-23  Sven Neumann  <sven@picman.org>

	* app/gui/resize-dialog.c (ratio_callback): removed redundant
	calculations.

	* plug-ins/common/svg.c: use a default size to handle the case
	when librsvg cannot determine the SVG size.

2003-09-23  Jakub Steiner <jimmac@ximian.com>

	* data/images/picman_splash.png: a tiny tribute to the path tool

2003-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: added ratio entries and a chain button so
	you can scale the SVG file while keeping the aspect ratio intact.
	Query the SVG pixel size on resolution changes.

2003-09-23  Simon Budig  <simon@picman.org>

	* app/core/picmandrawable-stroke.c: Fixed vectors stroking on
	GRAY* and INDEXED* layers.

	* app/tools/picmanvectortool.c: Made the polygonal mode more
	consistent.

2003-09-23  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-close-12.png
	* themes/Default/images/stock-menu-12.png: nicer, but hopefully
	  still theme indepenedent somehow

2003-09-22  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb: UTF-8 validate the value set using
	picmanrc_set(); mention this in the documentation.

	* app/pdb/picmanrc_cmds.c
	* libpicman/picmanpicmanrc_pdb.c: regenerated.
	
	* app/config/picmanconfig-path.c (picman_config_path_expand): added
	inline docs since this function is really not self-explanatory.

2003-09-22  Henrik Brix Andersen  <brix@picman.org>

	Replaced the netscape-dependent web browser plug-in with a user
	configureable plug-in. This fixes bug #119120:

	* app/config/picmanguiconfig.[ch]: added gchar *web_browser member

	* app/config/picmanrc-blurbs.h: added web browser blurb

	* etc/picmanrc
	* docs/picmanrc-1.3.5.in: regenerated using picmanconfig-dump

	* app/gui/preferences-dialog.c (prefs_dialog_new): added UI for
	specifying external web browser

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/webbrowser/.cvsignore
	* plug-ins/webbrowser/Makefile.am
	* plug-ins/webbrowser/README
	* plug-ins/webbrowser/web-browser.scm
	* plug-ins/webbrowser/webbrowser.c : removed the old netscape-dependent
	web browser plug-in

	* po-plug-ins/POTFILES.in
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/webbrowser.c: added a new web browser plug-in

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am: regenerated

	* app/widgets/picmanhelp.c
	* app/widgets/widget-enums.[ch]
	* plug-ins/helpbrowser/dialog.c
	* plug-ins/maze/maze_face.c: changed accordingly + whitespace
	clean-up

	* po-script-fu/POTFILES.in
	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/web-browser.scm: use the new web
	browser plug-in to add menu entries to <Toolbox>/Help/

2003-09-22  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c (menus_restore) (menus_save): removed picmanrc
	checks; let the functions always do what they are supposed to do.
	
	* app/gui/gui.c: check picmanrc settings here and decide what to
	restore on startup and save on exit. Fixes bug #122930.

2003-09-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.c (picman_viewable_get_popup_size):
	constrain popup size to PICMAN_VIEWABLE_MAX_POPUP_SIZE but keep the
	aspect ratio intact. Fixes bug #122923.

	* app/text/picmanfont.c: use a smaller font size for popups so we
	don't exceed the maximum size.

2003-09-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: added a hack to work around the
	insufficiency of the librsvg API. Still unfinished ...

2003-09-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: added a title bar showing the
	dockable's name, a "close" and a "menu" button. Not quite
	finished, but almost...

	* app/gui/dialogs-constructors.c: changed accordingly.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-close-12.png
	* themes/Default/images/stock-menu-12.png: new icons for the above.

	* libpicmanwidgets/picmanstock.[ch]: register them.

	* themes/Default/gtkrc: remove any focus spacing from the
	dockables' new buttons since they can't get the focus anyway.

2003-09-21  Michael Natterer  <mitch@picman.org>

	* app/gui/images-menu.c (images_menu_update): fixed typo.

2003-09-21  Simon Budig  <simon@picman.org>

	* app/xcf/xcf-save.c: Enable the new save code by default.

2003-09-21  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.c: Adjusted to make sure that
	no successive LINETOs to the same coordinate are in the
	path. Libart chokes on that.

	* app/core/picmandrawable-stroke.c: Respect the offsets of the
	target drawable.

	* app/tools/picmanvectortool.c: Removed status message in
	VECTORS_FINISHED mode as requested by Ville PÃ¤tsi.

	* app/vectors/picmanvectors.c: Determine the stroke parameters
	from the current context (opacity/color/paint_mode).
	The other parameters are not yet supported.

2003-09-21  Dave Neary  <bolsh@picman.org>

	* app/gui/image-menu.c: Changed default shortcut for Redo to
	Ctrl-Shift-Z, following a reccommendation of the GNOME HIG.

2003-09-21  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb: added a preliminary PDB API for
	vectors import. Will change when the new vectors PDB API gets
	added.

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

	* plug-ins/common/svg.c: allow to import paths when rendering a
	SVG file.
	
2003-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: added a resolution entry and implemented
	PDB parameter parsing.

2003-09-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c
	(picman_container_grid_view_init): removed the useless padding from
	the label which shows the name of the selected item, so it's
	properly aligned with the widget's left border now.

2003-09-21  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: renamed new enums to use "style" instead
	of the overloaded term "type". Also renamed PicmanGridType while I was
	on it.

	* app/core/picmandrawable-stroke.[ch]
	* app/core/picmangrid.[ch]
	* app/core/picmanscanconvert.[ch]
	* app/display/picmandisplayshell.c
	* app/vectors/picmanvectors.c
	* app/gui/grid-dialog.c: changed accordingly.

2003-09-21  Simon Budig  <simon@picman.org>
            Dave Neary  <bolsh@picman.org>

	* app/core/picmandrawable-stroke.c: picman_image_apply_image () must
	not get the pixel Region twice, use NULL for src1_tiles, which
	then defaults to the drawables tiles. Also pixel_region_init()
	does not take the offsets set by tile_manager_set_offsets into
	account. Use 0,0 instead of x1,y1. Fixes bad crashes.

	* app/core/picmanscanconvert.c: fixed crash for the same reason.

	* app/vectors/picmanvectors.c: Enabled the new stroking by default.
	Of course there should be a dialog to tweak the settings...  :-)

2003-09-20  Simon Budig  <simon@picman.org>
            Dave Neary  <bolsh@picman.org>

	First steps towards Libart stroking. Right now the code
	crashes and thus is disabled by default. If you want to
	test it, change the #define LIBART_STROKE  in
	app/vectors/picmanvectors.c. Then a click on the stroke button
	in the paths dialog invokes the new code.
	The crash is in picmandrawable-stroke.c - apparently I did not
	yet get the TileManager stuff correctly.

	* app/core/picmanscanconvert.[ch]: Rewritten to be more clear
	and have an easier API. Now can handle open Paths and
	libart-stroke the (open/closed) polygons defined earlier.

	* app/core/core-enums.h: Added Enums for LineJoin-Type and
	EndCap-Type for stroking.

	* app/core/core-enums.c: regenerated.
	
	* app/core/picmanimage-mask-select.c: Use the new API of
	PicmanScanConvert where appropriate.
	
	* app/vectors/picmanvectors.c: Added #define to enable the libart
	stroking. Disabled by default because of the crash mentioned
	above...

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors.[ch]: Removed Libart stuff here.
	Libart usage now lives exclusively in PicmanScanConvert.
	
	* app/core/picmandrawable-stroke.[ch]: New files for the libart
	stroking (right now just vector objects).
	* app/core/Makefile.am: changed accordingly.

	* app/Makefile.am: Needed to tweak linking.  :-/

2003-09-20  Henrik Brix Andersen  <brix@picman.org>

	* app/config/picmanconfig-dump.c (dump_picmanrc): removed reference to
	the "module-load-inhibit" property

2003-09-19  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-mmx.c
	  (picman_composite_difference_rgba8_rgba8_rgba8_mmx): Replaced the
	  improper use of the pminub instruction with the macro which does the
	  same using only mmx instructions.

2003-09-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: added framework for size negotiation. Not
	really useful yet but compiles and sortof works even.

2003-09-19  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c: made "closed" a construct_only property
	and make sure that notify is emitted correctly when it is changed.

2003-09-19  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c (parse_svg_viewbox): revert to
	the old implementation that is ugly but should work more reliably
	in locales that use ',' as the decimal separator. Disable rendering
	of elements with a zero viewBox.
	(parse_svg_length): fixed handling of width and height parameters.

2003-09-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c (load_image): do not rely on librsvg
	setting GError on failure, it doesn't :(

2003-09-19  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_device_change_notify): session_info->widget
	is not a PicmanDeviceStatus but its parent PicmanDockable. Use the
	dockable's child instead. Fixes bug #122684.

2003-09-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolorpickertool.c: moved the call to
	picman_color_tool_enable() from PicmanTool::initialize() to
	GObject::constructor() so the right cursor is shown before the
	first button_press. Fixes bug #122693.

2003-09-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.c: changed the hex entry to look
	and feel like the hex entry in the PicmanColorScales widget. Fixes
	bug #122692.

2003-09-19  Michael Natterer  <mitch@picman.org>

	Fix for bug #122695:

	* app/widgets/picmancolormapeditor.c
	(picman_colormap_hex_entry_activate): call picman_image_flush() after
	picman_image_set_colormap_entry() so the projection gets updated.

	Cleanup / consistency with other dialogs:

	* app/widgets/picmanhelp-ids.h: added help IDs for the colormap
	editor's menu items and buttons.

	* app/gui/colormap-editor-menu.c (colormap_editor_menu_entries):
	use the new help IDs.

	* app/widgets/picmancolormapeditor.[ch]: added buttons for "Edit Color"
	and "Add Color" and moved the color_notebook code to this file.

	* app/gui/colormap-editor-commands.[ch]: removed almost all code
	and simply emit "clicked" from the editor's buttons so their
	callbacks are invoked.

2003-09-19  Seth Burgess <sjburges@picman.org>

	* tools/pdbgen/pdb/selection.pdb: corrected order of parameters for 
	picman_image_mask_select_channel (used by picman-channel-combine-masks, 
	picman-selection-combine).  

	* app/pdb/selection_cmds.c: regenerated.

2003-09-19  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: Show a little help in the
	status bar. Maybe the functions I implemented to track
	the status of the status bar should live in a parent class.
	Still behaves a little weird, but I need help to fix it and it
	does not crash, so I committed it anyway...  :-)

2003-09-18  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanbezierstroke.c
	(picman_bezier_stroke_nearest_point_get): removed compiler warning.

	* app/vectors/picmanvectors-export.c: small formatting change.

2003-09-18  Simon Budig  <simon@picman.org>

	* app/tools/tools-enums.h: Renamed the modes of the vector tools:
	    - Design  (creative stuff: placing of new anchors /
	                               moving anchors/segments)
	    - Edit    (technical stuff: inserting/deleting anchors/segments)
	    - Move    (moving strokes/vectors)
	
	Jimmac: These need icons...  :-)

	* app/tools/tools-enums.c: regenerated

	* app/tools/picmanvectoroptions.c
	* app/tools/picmanvectortool.c: changed accordingly.

2003-09-18  Michael Natterer  <mitch@picman.org>

	* app/paint/Makefile.am
	* app/paint/paint.[ch]: removed...
	* app/paint/picman-paint.[ch]: ...and added.

	* app/core/picman.c: changed accordingly.

	* app/tools/Makefile.am
	* app/tools/tools.[ch]: removed...

	* app/tools/picman-tools.[ch]: ...and added. Added
	picman_tools_restore() and picman_tools_save() and moved the entire
	tool registering and tool_options loading/saving code here. Call
	tool_manager_init() from picman_tools_init() and tool_manager_exit()
	from picman_tools_exit().

	* app/tools/tool_manager.[ch]: removed the code which now lives
	in picman-tools.[ch]. The tool manager now has no knowledge about
	individual tools any more and just handles the active_tool
	and the tool part of tool <-> display interaction.
	Removed tool_manager_get_info_by_type().

	* app/tools/picmanvectortool.c (picman_vector_tool_register): the
	tool's identifier is "picman-vector-tool", not "picman-path-tool".

	* app/app_procs.c
	* app/display/picmandisplayshell-callbacks.c
	* app/gui/vectors-commands.c
	* app/tools/picmanpainttool.c: changed accordingly.

2003-09-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (create_image): rewritten pixel
	transfer from pixbuf to drawable; doesn't need a tile cache any
	longer.

	* plug-ins/common/svg.c: same change here together with a bunch of
	other changes in preparation for viewport negotiation.

2003-09-18  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: (picman_stroke_nearest_point_get)
	added the endpoint of the segment to the list of returned values.

	* app/tools/picmandrawtool.[ch]: (picman_draw_tool_on_vectors_curve)
	return the endpoint also.

	* app/tools/picmanvectortool.[ch]: Use that to activate the
	to-be-changed anchors when dragging on the curve directly.

	* app/tools/picmanmovetool.[ch]: changed accordingly.

2003-09-18  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.[ch]: cosmetics.

2003-09-18  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-export.c (picman_vectors_export): always
	save the image size; default to centimeters.

2003-09-18  Sven Neumann  <sven@picman.org>

	* configure.in: added a check for librsvg-2.0.

	* plug-ins/common/mkgen.pl
	* plug-ins/common/svg.c: added SVG import plug-in. This plug-in
	was written by Dom Lachowicz and used to live in the librsvg source
	tree (bug #103039).

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: regenerated.

2003-09-18  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Cursor keys now move the currently
	active anchors, SHIFT and CTRL increase the steps.

	* MAINTAINERS: Added myself in an attack of hubris...

2003-09-18  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-export.c: save the vectors (or rather
	image) dimensions in the exported SVG.

	* app/vectors/picmanvectors-import.c: added SVG units parser and
	finished viewport handling. The parser now respects the size
	specified in the SVG and the image resolution. Should also handle
	nested SVGs correctly, but this is untested. 

2003-09-18  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am (picman_1_3_LDFLAGS): specifying one symbol per
	object file we force to be linked in is sufficient.

2003-09-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmanpaletteeditor.[ch]
	* app/widgets/picmantemplateview.[ch]: order the button boxes in
	these dialogs like the entries their popup menus: The default
	(double click) action is the first menu entry / button. In an
	attack of consistency, also reordered functions and function
	parameters all over the place to match the new order.

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c
	* app/gui/dialogs-constructors.c: changed accordingly.

2003-09-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c
	(picman_edit_selection_tool_arrow_key): initialize undo_type to shut
	up the compiler.

2003-09-17  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: Changed picman_*_anchor_select to
	accept the selection state as an argument.

	* app/tools/picmandrawtool.[ch]: Added "exclusive" boolean parameter
	to picman_draw_tool_on_vectors_handle(), so that you can specify
	that you just get exactly the type of anchor you want to have.

	* app/tools/picmanvectortool.[ch]: Handling of multiple selected
	anchors: Shift-Clicking in Extend mode selects them, you can
	move them together.

2003-09-17  Michael Natterer  <mitch@picman.org>

	* app/tools/tools.c (tools_init): moved the path tool after the
	selection tools.

2003-09-17  Manish Singh  <yosh@picman.org>

	* app/Makefile.am: special case windows for leading underscores in
	symbol names.

2003-09-17  Ville PÃ¤tsi  <drc@picman.org>

	* configure.in: Added AC_SUBST to required version numbers.
	* picman.spec.in: Changed the requires to use the version numbers from
	configure.in

2003-09-17  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: smallish change to enable
	dragging out of handles again. It is now dragging handles
	out of anchors, when click/dragging on them in Insert/Delete
	mode. Deletion of nodes now requires the SHIFT modifier.

2003-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sparkle.c: some code cleanup.

2003-09-17  Michael Natterer  <mitch@picman.org>

	Added nomis' favorite feature ;)

	* app/paint/picmanpaintcore.[ch]: added picman_paint_core_cancel()
	which can be called instead of picman_paint_core_finish().
	It simply copies core->undo_tiles back to the drawable instead of
	pushing them to the undo stack.

	* app/tools/picmanpainttool.c (picman_paint_core_button_release): call
	_cancel() instead of _finish() if the right mouse button is
	pressed.

2003-09-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.[ch]: added "PicmanVectorMode saved_mode"
	to the PicmanVectorTool struct.

	(picman_vector_tool_modifier_key): use it to correctly keep track of
	the modifier state.

	* app/tools/picmanselectiontool.c (picman_selection_tool_modifier_key):
	moved variable to local scope.

2003-09-17  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-path.c (picman_config_path_expand): fixed
	the fix.

2003-09-17  Michael Natterer  <mitch@picman.org>

	* cursors/hand.xbm
	* cursors/hand_mask.xbm: removed.

	* cursors/hand_small.xbm
	* cursors/hand_small_mask.xbm: ...and added under new names.

	* cursors/Makefile.am
	* cursors/picman-tool-cursors.xcf: changed accordingly.

	* app/widgets/widgets-enums.h
	* app/widgets/picmancursor.c: removed HAND from the PicmanCursorModifier
	enum and added it to the PicmanToolCursorType enum. We don't have a
	hand tool but this way the hand cursor (which is in the lower
	right corner) can be used together with other cursor modifiers
	(which are in the upper right corner).

	* app/tools/picmanmovetool.c
	* app/tools/picmanvectortool.c: show cursor modifers with the hand
	cursor where appropriate.

2003-09-16  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-{mmx,sse,sse2,altivec,vis}.c:
	Regenerated.

	* app/composite/picman-composite-regression.[ch]: Ensure all ints
	  are now unsigned longs.

	* app/composite/picman-composite-sse2.c
	(picman_composite_addition_rgba8_rgba8_rgba8_sse2):
	  Enclosed the troublesome (rather dense) asm construct in
	  __OPTIMIZE__ in which case the compiler can successfully
	  allocate enough registers to load up the asm()

2003-09-17  Seth Burgess <sjburges@picman.org>

	* plug-ins/common/sparkle.c: use the rowstride of a pixel region
	because you never know when you're starting on a selection.  Fixes
	bug #50911.
	
2003-09-17  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Ok, since the obsolete undo
	step is invalid the undo_event of the image probably should be
	PICMAN_UNDO_EVENT_UNDO_EXPIRED. This fixes at least the undo
	history...

2003-09-17  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: Restored Mitchs favourite
	feature :-)  (now the cursor indicates if you hover over
	a vectors object when no other one is active...). Also added
	more descriptive Undo names and RMB-Cancel for the Vectors tool.

	Please note, that the RMB-Cancel is implemented using the Undo
	System. I do not really have a clue on that and so right now
	there is an oddity - the undo-object popped from the undo
	stack does not get removed from e.g. the Undo History Dialog.

	Someone with a clue please have a look at that...  :-)

2003-09-16  Dave Neary  <bolsh@picman.org>

	* app/config/picmanconfig-path.c: Fixed a seg fault in an earlier
	commit.

2003-09-16  Michael Natterer  <mitch@picman.org>

	* app/gui/brushes-menu.c
	* app/gui/colormap-editor-menu.c
	* app/gui/dialogs-menu.c
	* app/gui/documents-menu.c
	* app/gui/gradients-menu.c
	* app/gui/palettes-menu.c
	* app/gui/patterns-menu.c: suppress more standard GTK+ stock item
	accelerators in popup menus by specifying "" instead of NULL as
	accelerator.

2003-09-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmoveoptions.[ch]: changed "gboolean move_mask" to
	"PicmanTransformType move_type" and added an "Affect:" stock radio
	box so it offers the same LAYER,SELECTION,PATH choice as the other
	transform tools.

	* app/tools/picmanmovetool.[ch]: honor the new tool option, made
	cursor_update() show more different cursors which describe the
	state of the tool more closely, fixed some cases where the
	PicmaneditSelectionTool was invoked with meaningless values
	(like requesting a selection transform when there is no
	selection).

	Changed modifiers:

	- Made <Shift> toggle "move current layer".
	- Made <Control> switch to path moving.
	- <Alt> switched to selection moving as before.

	* app/tools/picmaneditselectiontool.[ch]: added EDIT_VECTORS_TRANSLATE
	operation mode and honor it all over the place. Unified the code
	which transforms layers and vectors since it's essentially the same.

	(picman_edit_selection_tool_cursor_key): simplified selection moving
	code and added support for moving paths (using <Control>).

2003-09-16  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2.c: Removed code that caused
	  gcc to complain can't find a register in class `GENERAL_REGS'. To
	  be revisited later.

2003-09-16  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-generic.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse2.c
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-path.c
	* app/config/picmanconfig-serialize.c
	* app/core/cpercep.c
	* app/core/picmanunit.c
	* app/gui/palette-import-dialog.c
	* app/gui/plug-in-menus.c
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c
	* app/pdb/procedural_db.c
	* app/text/picmantextlayout-render.c
	* app/tools/picmanfuzzyselecttool.c
	* app/widgets/picmancursor.c: some trivial code cleanups: avoid
	casts that discard const qualifiers and avoid useless comparisons
	on unsigned variables. Also reordered qualifiers in function
	declarations (static comes before const).

2003-09-16  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.[ch]: Fixed stupid bug (for getting
	the bounding box you also have to use MAX...).

2003-09-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_translate): transform the
	channel's bounding box later so we really update the channel's new
	*and* old area.

2003-09-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c: changed buffer size and improved
	encoding detection.

2003-09-15  Helvetix Victorinox  <helvetix@picman.org>

	* picman-composite-mmx-{test,installer}.c
	* picman-composite-sse-{test,installer}.c
	* picman-composite-sse2-{test,installer}.c
	* make-installer.py: sort test output by mode name

	* picman-composite-sse2.[ch]: New compositing mode implementations
	  darken
	  difference
	  grain_extract
	  lighten

	* picman-composite-x86.h: added

	* picman-composite-{sse,mmx,sse2}.[ch]: Tightening declarations of
	clobbered registers.

2003-09-16  Manish Singh  <yosh@picman.org>

	* app/Makefile.am: use -u to prevent garbage collection of symbols
	prematurely. I wonder if this works everywhere...

	* app/pdb/Makefile.am
	* app/vectors/Makefile.am: remove gross hacks

2003-09-16  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.[ch]: Implemented an (unused/untested)
	picman_vectors_bounds () that returns the bounding box of an vectors
	object.

	* app/tools/picmandrawtool.[ch]: made picman_draw_tool_on_vectors()
	ignore handles/anchors, since they are not visible when that
	function gets used.

2003-09-15  Simon Budig  <simon@picman.org>

	* app/core/picmanimage.c: fixed bogus
	picman_item_set_image (PICMAN_ITEM (vectors), NULL);

	* app/tools/picmandrawtool.[ch]: added picman_draw_tool_on_vectors:
	checks if the given coordinate is on any vectors object of the image.

	* app/tools/picmanvectortool.[ch]: Changed the tool modes.
	VECTORS_SELECT_VECTORS now is active when the tool does not
	have a current vectors object or the gdisplay is different
	than the one the tool is drawing on. Also the Move mode now
	uses it, when clicking outside the current vectors object.

	Factored out the sanity check of the internal state
	(picman_vector_tool_verify_state).

2003-09-15  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform-utils.[ch]: removed...

	* app/core/picman-transform-utils.[ch]: ...and added under new names
	because these functions are not at all related to PicmanDrawable.
	Changed the function names accordingly.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.

	* app/pdb/transform_tools_cmds.c: regenerated.

2003-09-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanedit.[ch]
	* app/core/picmanmodules.[ch]
	* app/core/picmanunits.[ch]
	* app/text/picmanfonts.[ch]: removed...

	* app/core/picman-edit.[ch]
	* app/core/picman-modules.[ch]
	* app/core/picman-units.[ch]
	* app/text/picman-fonts.[ch]: ...and added with new names because
	these files operate on members of a Picman instance and are
	therefore methods of the Picman object.

	* app/core/Makefile.am
	* app/text/Makefile.am
	* app/display/picmandisplayshell-dnd.c
	* app/gui/edit-commands.c
	* app/gui/module-browser.c
	* app/gui/preferences-dialog.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmantoolbox-dnd.c
	* app/app_procs.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/fonts.pdb: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/fonts_cmds.c: regenerated.

	* app/core/picman.c (picman_init): don't create picman->fonts.
	(picman_initialize): call picman_fonts_init().
	(picman_restore): call picman_fonts_load() instead of _init().

	* app/text/picman-fonts.c (picman_fonts_init): don't call
	picman_fonts_load(), just create picman->fonts and connect to
	"notify::font-path" of picman->config.

2003-09-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c: fixed inline documentation.

	* app/vectors/picmanstroke.h: added a missing newline.

2003-09-15  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/config-types.h
	* app/config/picmanxmlparser.[ch]: new files that hold a simple XML
	parser based on GMarkupParser. It's not a full-featured XML parser;
	it only adds transparent handling of encodings to GMarkupParser
	and provides a convenient API to deal with files or IO channels.

	* app/vectors/picmanvectors-import.c: use the new PicmanXmlParser.
	
	* app/vectors/picmanvectors-export.c: write encoding attribute.

	* app/tips-dialog.c
	* app/tips-parser.c: use the new PicmanXmlParser.

	* app/vectors/Makefile.am: had to add one of those truly ugly
	hacks here in order to get the application linked.
	
2003-09-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_constructor): 
	order the "visible" and "linked" columns by inserting them with
	the right index, not by reordering code.

	(picman_item_tree_view_set_container): set the handler_ids to 0
	after disconnecting them.

2003-09-15  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: name the vectors after the
	path id as found in the SVG.

	* app/vectors/picmanvectors-export.c: further improved formatting.

2003-09-15  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-export.c: Save an id-attribute
	using the vector objects name. Slightly adjusted formatting.

2003-09-15  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c (picman_vectors_import): stop
	creating an extranous vectors object.

2003-09-14  Manish Singh  <yosh@picman.org>

	* app/gui/gui.c: changed to a runtime check for gtk version.

2003-09-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2.c
	  (picman_composite_swap_rgba8_rgba8_rgba8_sse2):
	  Removed clobbered register declaration in an attempt to get this
	  to compile with gcc 3.2.3

2003-09-13  Sven Neumann  <sven@picman.org>

	* app/gui/vectors-commands.c (vectors_export_ok_callback): no need
	to flush the image after exporting vectors.

	* app/vectors/picmanvectors-import.c: improved error handling.

2003-09-13  Helvetix Victorinox  <helvetix@picman.org>

	* picman-composite-sse2-installer.c, picman-composite-sse2-test.c:
	  regenerated with new functions.

	* picman-composite-sse.c, picman-composite-sse2.c:
	  Distinguish between 64bit and 128bit constants with a little
	  faux hungarian notation.

	* picman-composite-sse2.[ch]: Added implementations of
	  addition_rgba8_rgba8_rgba8, subtract_rgba8_rgba8_rgba8, and
	  swap_rgba8_rgba8_rgba8

	* picman-composite-generic.c:
	  Some formating beautification

2003-09-13  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/grid.xpm: removed

	* plug-ins/imagemap/Makefile.am: removed grid.xpm from distribution

	* plug-ins/imagemap/imap_stock.[ch] 
	* plug-ins/imagemap/imap_toolbar.c: use picman stock icon for grid

2003-09-13  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmiscui.[ch]
	* libpicman/picmanmisc.[ch]: a few more reusable routines extracted from
	several plug-ins.

	* plug-ins/common/align_layers.c: 
	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c
	* plug-ins/common/blur.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/cubism.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/destripe.c
	* plug-ins/common/edge.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/grid.c
	* plug-ins/common/illusion.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/lic.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/noisify.c
	* plug-ins/common/nova.c
	* plug-ins/common/oilify.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/plasma.c
	* plug-ins/common/polar.c
	* plug-ins/common/randomize.c
	* plug-ins/common/ripple.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sobel.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/struc.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/tileit.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c
	* plug-ins/common/xpm.c: use new stuff from libpicman/picmanmiscui.[ch]
	plus some minor cleanup like removing unused header files (for 
	example signal.h)

2003-09-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]
	* app/vectors/picmanvectors-import.c: add vectors in an undo-group.

	* app/gui/vectors-commands.c: added simple file selection dialogs
	for vectors import and export.
	
2003-09-13  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: simplified the parser and
	make it optionally create multiple vectors again.

2003-09-13  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def
	* libpicmanmath/picmanmath.def
	* libpicmanwidgets/picmanwidgets.def: used nm to regenerate these
	files from libraries built on Linux. There were quite some symbols
	missing.

2003-09-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemtreeview.c: moved the visibility toggle
	before the linked toggle again.

	* app/core/picmandrawable.c (picman_drawable_configure)
	* app/core/picmanitem.c (picman_item_init): quick fix for bug #122153:
	don't make the item visible in picman_drawable_configure() since that
	breaks duplicate(); instead create all items as visible.
	
2003-09-13  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: rewrote large parts of the SVG
	parser. It now handles nested groups and transformations. Still not
	perfect but close.

2003-09-12  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.[ch]: Added a proper
	implementation of the BEHIND drawing mode.  This should fix bug
	#121889

	* app/composite/picman-composite-generic-installer.c: regenerated

2003-09-12  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c (parse_svg_viewbox): return a
	transformation matrix in preparation for nested transforms.

2003-09-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]: added new functions
	picman_draw_tool_on_vectors_handle() and _on_vectors_curve()
	so they can be used by all PicmanDrawTool subclasses.

	* app/tools/picmanvectortool.[ch]: removed the _on_handle() and
	_on_curve() functions here. Connect to "active_vectors_changed" of
	the active_vector's image, so once it has been avtivated, the tool
	follows the path which is selected in the paths dialog.

2003-09-12  Sven Neumann  <sven@picman.org>

	* app/core/picmanselection.c
	* app/gui/images-menus.c
	* app/gui/session.c: string fixes.

	* app/gui/images-commands.[ch]: changed the function names
	accordingly..
	
2003-09-12  Christian Neumair  <chris@gnome-de.org>

	* app/gui/dialogs-menu.c: added missing ngettext calls to MENU_BRANCH
	calls' argument.

2003-09-12  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmatrix.[ch]: added picman_matrix3_affine().

	* app/vectors/picmanvectors-import.c: added (yet unused) funtion to
	parse SVG transform attributes.

	* app/vectors/picmanvectors-export.c: fixed a stupid bug.

2003-09-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.c (picman_image_mask_select_vectors)
	* app/paint/picmanpaintcore-stroke.c (picman_paint_core_stroke_vectors)
	* app/display/picmandisplayshell.c (picman_display_shell_draw_vector)
	* app/tools/picmandrawtool.c (picman_draw_tool_real_draw)
	* app/tools/picmantransformtool.c (picman_transform_tool_draw)
	* app/tools/picmanvectortool.c (picman_vector_tool_vectors_visible)
	(picman_vector_tool_draw): all callers of picman_stroke_interpolate():
	don't leak the returned PicmanCoords array and don't crash if it's
	NULL.

	* app/tools/picmanvectortool.[ch]: added VECTORS_SELECT_VECTOR state
	which enables activating any visible PicmanVectors on any display.

	(picman_vector_tool_on_handle)
	(picman_vector_tool_on_curve): added a PicmanVectors parameter so we
	can check for vectors which are not vector_tool->vectors.

	(picman_vector_tool_oper_update): iterate gdisp->gimage->vectors
	to figure if we are hovering any visible vectors and set
	VECTORS_SELECT_VECTOR.

	(picman_vector_tool_button_press): catch VECTORS_SELECT_VECTOR and
	start editing the selected vectors. Also make it the image's
	active_vectors.

	(picman_vector_tool_button_release): removed unneeded call to
	picman_viewable_invalidate_preview(vectors).

	Random cleanup all over the place.

2003-09-12  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-export.c: Don't lose the last
	segment of closed paths when exporting...

2003-09-12  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-export.c: Implemented more useful
	SVG export.

2003-09-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c: removed all calls to
	picman_tool_control_set_preserve() so the tool doesn't get
	confused by the image being dirtied.

	Made it aware of visible vectors:

	(picman_vector_tool_draw): don't draw the stroke itself if the
	current vectors is visible.

	(picman_vector_tool_vectors_visible): new callback which just draws
	the stroke itself when the vectors changes visibility.

	(picman_vector_tool_set_vectors): connect the new callback.

2003-09-12  Michael Natterer  <mitch@picman.org>

	Added support for permanently showing the visible vectors, not
	only when the vectors tool is active:

	* app/display/picmandisplayshell.[ch]: added
	picman_display_shell_draw_vector() which draws a single PicmanVectors
	object and picman_display_shell_draw_vectors() which draws all
	visible ones. Added "gint paused_count" and new functions
	picman_display_shell_paunse()/resume(). Pause/resume the active tool
	and draw/undraw the visible vectors when paused_count changes from
	0 to 1 and from 1 to 0.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c: call the new
	freeze()/thaw() functions instead of calling the tool_manager
	directly. Removes the tools/ dependency from the scale and scroll
	files. Also draw the vectors once when the canvas is realized so
	XOR drawing is in the correct state.

	* app/display/picmandisplayshell-handlers.c: connect to
	image->vectors' "add" and "remove" signals and to the "freeze",
	"thaw" and "visibility_changed" signals of all vectors in
	image->vectors and update vectors drawing accordingly.

2003-09-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: removed "visible" and all its API...

	* app/core/picmanitem.[ch]: ...and added it here.

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]: changed the drawable
	visibility undo to be an item visibility undo.

	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c: save it in PROP_VECTORS and changed channel
	and layer loading/saving accordingly.

	* app/core/picmanimage-merge.c
	* app/core/picmanimage-preview.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/core/picmanselection.c
	* app/text/picmantextlayer.c
	* app/gui/channels-commands.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c: regenerated.

	* app/widgets/picmandrawabletreeview.[ch]: removed the eye icon...

	* app/widgets/picmanitemtreeview.[ch]: ...and added it here.

2003-09-11  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/folders-fonts.png:
	* themes/Default/images/preferences/folders-scripts.png:
	  proper icons
	
2003-09-11  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-transparency-[16|24].png: new icon.

	* libpicmanwidgets/picmanstock.[ch]: register as PICMAN_STOCK_TRANSPARENCY.

	* app/gui/image-menu.c
	* app/gui/layers-menu.c: use the new icon for "Add Alpha Channel".

	* app/widgets/picmanlayertreeview.c: replaced the "Keep Trans."
	button with a check button plus the new icon (bug #121784).

2003-09-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem-linked.[ch]: made picman_item_linked_get_list()
	and the PicmanItemLinkedMask enum public. Hiding them just causes
	code duplication.

	* app/tools/picmandrawtool.[ch]: added a GList of PicmanVectors and a
	PicmanMatrix3 transformation matrix for them. Just set them with
	picman_draw_tool_set_vectors() and picman_draw_tool_set_transform()
	and chain up in your tools's PicmandrawTool::draw() implementation
	to get the vectors drawn.

	* app/tools/picmaneditselectiontool.c: use
	picman_item_linked_get_list() instead of traversing image->layers,
	->channels and ->vectors manually to find the linked items.
	Use picman_draw_tool_set_vectors() and _set_transform() to show
	the linked vectors while moving.

	(picman_edit_selection_tool_arrow_key): transform all linked items,
	not just the linked layers.

2003-09-11  Michael Natterer  <mitch@picman.org>

	* app/gui/brushes-menu.c
	* app/gui/buffers-menu.c
	* app/gui/channels-menu.c
	* app/gui/colormap-editor-menu.c
	* app/gui/gradients-menu.c
	* app/gui/images-menu.c
	* app/gui/layers-menu.c
	* app/gui/palette-editor-menu.c
	* app/gui/palettes-menu.c
	* app/gui/patterns-menu.c
	* app/gui/templates-menu.c
	* app/gui/vectors-menu.c: made the default (== double click)
	action the first menu entry as suggested by the HIG and
	added/removed separators where appropriate.

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am: removed PANGO_DISABLE_DEPRECATED again since
	we have to use Pango API that is deprecated in the HEAD branch.

2003-09-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c: merged in enhancements done by
	Alexey Dyachenko: support for LAB colorspace and an option to
	decompose into layers instead of multiple images.

2003-09-11  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.[ch]: Implemented
	picman_bezier_stroke_arcto () that creates an elliptical arc
	in the way SVG works.

	* app/vectors/picmanvectors-import.c: use it.

2003-09-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: removed lots of redundant casts.

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-export.[ch]: allow to optionally export
	all paths from an image into a single SVG file.

	* app/gui/vectors-commands.c: changed accordingly.

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am: define PANGO_DISABLE_DEPRECATED.

	* app/text/picmantext-compat.c: avoid deprecated API.

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform-utils.[ch]: added new function
	picman_drawable_transform_matrix_flip().

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.c: don't push the complex PicmanItem
	transformation API down to PicmanStroke. Instead setup the matrices
	in PicmanVectors and use a simpler API for PicmanStroke.

	* app/vectors/picmanvectors-import.c: changed accordingly.

	* app/vectors/picmanvectors-export.c: close the <path> element.

2003-09-11  Sven Neumann  <sven@picman.org>

	* configure.in: link the screenshot plug-in explicitely against X11
	(bug #121942).

2003-09-11  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/themes.[ch]: new files.

	* app/gui/gui.[ch]: code taken from here. It was getting too large.

	* app/gui/preferences-dialog.c; changed accordingly.

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/vectors/Makefile.am (INCLUDES): replaced GTK_CFLAGS by
	GDK_PIXBUF_CFLAGS.

	* app/vectors/picmanvectors-export.c: added a first draft of 
	PicmanVectors SVG export.

	* app/gui/vectors-commands.c (vectors_export_cmd_callback): call
	picman_vectors_export() with a hardcoded filename.

2003-09-10  Manish Singh  <yosh@picman.org>

	* app/text/picmanfonts.c: include text-types.h instead of core-types.h

2003-09-11  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.[ch]	
	* app/gui/vectors-commands.c: allow to optionally create a
	PicmanVectors object per <path> element. Made this the default until
	there's a GUI for this.

2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added lots more "PicmanFooFunc gui_foo_func"
	vtable entries to the Picman struct and wrapper function for them.
	They cover plug-in menu creation and plug-in progress utilities.

	* app/gui/gui.c: fill in the funtion pointers and dispatch
	to the actual functions.

	* app/pdb/Makefile.am (libapppdb_a_LIBADD): removed most hacks
	since the symbols are referenced within libappgui.a now.

	Removed any GTK+ dependency from the plug-ins/ directory:

	* app/plug-in/Makefile.am (INCLUDES): replaced GTK_CFLAGS by
	GDK_PIXBUF_CFLAGS.

	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-ins.c: replaced gui function calls to create
	menus and progress bars by calls to the wrappers.

	* app/plug-in/plug-in.c (plug_in_close): check dangling PDB
	dialogs using the new wrapper.

	* app/plug-in/plug-in-def.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c: removed trailing whitespace.

2003-09-10  Manish Singh  <yosh@picman.org>

	* configure.in: AC_SUBST the GDK_PIXBUF vars, to workaround automake
	1.6 brokenness.

2003-09-10  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: finished basic SVG path import.

2003-09-10  Manish Singh  <yosh@picman.org>

	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am: add a dependency on libpicmanbase.la so
	they get rebuilt when the version number changes.

	* Makefile.am: build libpicmanbase before the above

2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-layer-select.c: switch layers
	immediately, not when finishing layer_select, so the layer
	boundary and the layers dialog are updated, which makes this
	feature much more useful. Fixes bug #119234.

2003-09-10  Sven Neumann  <sven@picman.org>

	* app/gui/vectors-commands.c (vectors_import_cmd_callback): call
	picman_vectors_import(). Hardcoded filename to path.svg for now.

	* app/vectors/picmanvectors-import.c: more work on the SVG parser.
	
2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-save.c: changed the various xcf_write_*_error()
	macros to take an XcfInfo pointer as first parameter, not
	info->fp. Simplifies all callers a bit since they don't have to
	dereference it themselves.

2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-save.c: enabled error checking for PicmanParasite
	saving and factored PicmanParasiteList saving out to a new
	function. Cleaned up the (still disabled) PROP_VECTORS saving
	code and save the vector's parasites.

	* app/xcf/xcf-load.c: changed PROP_VECTORS loading accordingly.

	Note that the PROP_VECTORS changes are completely untested since
	Simon can judge its correctness much better than myself.

2003-09-10  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: started to add framework for
	SVG parser.

2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf.c (xcf_save_invoker): when opening fails, show the
	same error message as all file plug-ins.

2003-09-10  Sven Neumann  <sven@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/picmanvectors-export.[ch]
	* app/vectors/picmanvectors-import.[ch]: added stubs for
	import/export of paths.

	* app/vectors/picmanvectors-preview.h: cosmetics.

2003-09-10  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c
	* app/xcf/xcf-read.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf-seek.c
	* app/xcf/xcf-write.c
	* app/xcf/xcf.c: whitespace cleanup.

2003-09-10  Tor Lillqvist  <tml@iki.fi>

	* config.h.win32: Tell it's outdated.

	* app/errors.c (picman_eek): [Win32] Use full_prog_name, show also
	reason.
	
	* app/xcf/xcf.c (xcf_load_args, xcf_save_arge): Document that
	filename is in the on-disk charset and encoding, and raw_filename
	is just the basename, in UTF-8.
	(xcf_save_invoker): Convert filename to UTF-8 before passing to
	g_message().

2003-09-10  Michael Natterer  <mitch@picman.org>

	* configure.in: require fontconfig >= 2.2.0 (bug #121752), check
	for gdk-pixbuf-2.0 explicitly, added --enable-picman-console
	configure option, bumped version number to 1.3.21.

	* app/core/Makefile.am: replaced GTK_CFLAGS by GDK_PIXBUF_CFLAGS.

	* app/Makefile.am: removed -export-dynamic from LDFLAGS since we
	don't export symbols to modules or libraries any more. Reordered
	SUBDIRS a bit.

	If --enable-picman-console is given, try to build a second binary
	called picman-console-1.3 which does not link against GTK+.
	Of course this fails badly since core/ui separation is not
	complete yet, but the output of the failing linker is a nice list
	of what needs to be done.

2003-09-09  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c (menus_last_opened_add): removed redundant
	"Picman" parameter, cleanup.

	* app/gui/image-menu.c (image_menu_setup)
	* app/gui/toolbox-menu.c (toolbox_menu_setup): changed accordingly.

2003-09-09  Michael Natterer  <mitch@picman.org>

	Got rid of the last global variables except the_picman:

	* app/Makefile.am
	* app/appenv.h: removed this file.

	* app/errors.[ch] (picman_errors_init): new function which lets the
	error system know about "full_prog_name", "stack_trace_mode" and
	"debug_handlers". Remember these values privately.

	* app/app_procs.[ch] (app_init): added "full_prog_name" and
	"stack_trace_mode" parameters here too.

	* app/main.c (main): call picman_errors_init() and pass the
	additional parameters to app_init().

2003-09-09  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-compat.[ch]: Made
	picman_vectors_compat_get_points accept more paths gracefully. It
	now is sufficient if there is up to one open stroke in the
	vectors object - it does not have to be the last one.

	Added function to determine if all vectors can be saved in
	compatibility mode.

	* app/vectors/picmananchor.[ch]: Made PicmanAnchor a boxed type.
	* app/vectors/picmanstroke.[ch]: Add two properties to picmanstroke:
	"closed" and "control-points" (the latter is
	G_PARAM_CONSTRUCT_ONLY). Added functions to get the points that
	determine the shape of the stroke - necessary for proper saving.

	* app/xcf/xcf-private.h: added new PROP_VECTORS and XcfStrokeType.

	* app/xcf/xcf-load.c: Be able to load PROP_VECTORS, make loading
	of PROP_PATHS ignore empty paths.

	* app/xcf/xcf-save.c: Added code for saving PROP_VECTORS,
	disabled by default. Define NEW_SAVE_CODE if you want to test
	it. No guarantees are made about the forward compatibility of
	the format used.

2003-09-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (create_image): need to detach from
	the drawable or the tile cache won't be flushed (bug #121788).

2003-09-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c
	* app/display/picmannavigationview.c
	* app/gui/resolution-calibrate-dialog.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanpreview-popup.c
	* app/widgets/picmanwidgets-utils.c: get the size from the current
	screen, not always from the default one.

	* plug-ins/common/wmf.c: ask PICMAN for the monitor resolution instead
	of taking the value from GDK.

2003-09-09  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added "gboolean console_messages" to the
	Picman struct and to picman_new() since plug-in messages go directly
	through picman_message() now and need to honor "console_messages"
	too.

	* app/app_procs.[ch]: added "gboolean console_messages" to
	app_init() and pass it to picman_new().

	* app/appenv.h: removed global variable "console_messages".

	* app/main.c: added it to main()'s scope and pass it to app_init().

	* app/errors.c: changed accordingly.

2003-09-08  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/animoptimize.c: Disable the (pdb interfaces
        to the) semi-broken background/foreground stuff unless
        EXPERIMENTAL_BACKDROP_CODE is defined.

2003-09-08  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Remove all references to *gck*

2003-09-08  Sven Neumann  <sven@picman.org>

	* Made 1.3.20 release.

2003-09-07  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-preview.c
	* plug-ins/fp/fp_gtk.c: got rid of compiler warnings.

2003-09-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-desaturate.h: image_desaturate() does not
	exist.

2003-09-07  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/gui/Makefile.am
	* app/paint/Makefile.am
	* app/pdb/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am
	* app/xcf/Makefile.am (INCLUDES): removed $(LIBART_CFLAGS) again.

2003-09-07  Dave Neary  <bolsh@picman.org>

	* app/vectors/picmanvectors.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: Cleanup - removed libart 
	from the included headers in the .h files, don't pass around 
	libart objects any more. Still stub code. 

2003-09-07  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: accept URLs with https protocol.

2003-09-07  Michael Natterer  <mitch@picman.org>

	* app/tools/airbrush_blob.[ch]: removed the last traces of
	xinput_airbrush.

2003-09-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/aa.c: set the tile cache size to speed up pixel
	transfers.

2003-09-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (create_image): boost performance
	by setting a reasonable tile cache size.

2003-09-07  Michael Natterer  <mitch@picman.org>

	* app/display/display-types.h
	* app/tools/tools-types.h
	* app/vectors/vectors-types.h
	* app/widgets/widgets-types.h: removed some forgotten cruft.

	* app/vectors/picmanbezierstroke.h
	* app/vectors/picmanstroke.h
	* app/vectors/picmanvectors.h: added class struct typedefs here.

2003-09-07  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors.[ch]: redid the fix for the compiler
	warning: made picman_vectors_to_art_vpath() take a const PicmanVectors
	again, but don't freeze/thaw it since it isn't changed anyway.

2003-09-06  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse2.c:
	  Convert "unsigned long" to guint32 in preparation for 64bit
	  machinery.

2003-09-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderertextlayer.[ch]: removed.

	* app/widgets/picmanpreviewrendererlayer.[ch]: new renderer which
	renders all kinds of layers and uses PICMAN_STOCK_FLOATING_SELECTION
	for floating selections.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpreviewrenderer-utils.c: changed accordingly.

2003-09-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.[ch]: display the floating
	selection's name in italic letters. Added the bold and italic
	PangoAttrLists to the PicmanLayerTreeView struct so we can unref
	them properly.

	* app/widgets/picmandrawabletreeview.c: some cleanup while stealing
	code.

2003-09-06  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-floating-selection-*.png: new icon
	drawn by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]: register the new icon.

2003-09-06  Michael Natterer  <mitch@picman.org>

	To optimize duplicate and/or wrong image updates away, introduced
	new policy that a child object must never explicitly update or
	invalidate its parent object (just like the GUI is not updated
	explicitly by the core):

	* app/core/picmandrawable.[ch]: added new signal
	PicmanDrawable::update(). Never update or invalidate the image when
	the drawable is updated or invalidated.

	(picman_drawable_set_visible): don't picman_drawable_update() the
	drawable since its pixels have not changed.

	* app/core/picmanimage.[ch]: connect to the "add" and "remove"
	signals of the layers and channels containers. Also connect to the
	"update" and "visibility_changed" signals of all drawables in
	these containers (optimizes away updates issued by drawables which
	are not yet added to the image and updates of the selection
	mask). Also, don't propagate updates to the image if the emitting
	drawable is invisible (optimizes away updates issued by invisible
	drawables).

	(picman_image_add_layer,channel)
	(picman_image_remove_layer,channel): don't update the image since
	that's done by our "add" and "remove" handlers now.

	(picman_image_position_layer,channel): update just the image, not
	the drawable since its pixels have not changed.

	(picman_image_real_colormap_changed)
	(picman_image_set_component_visible): always call
	picman_image_update() *and* picman_viewable_invalidate_preview() to
	get everything updated, since update and invalidate of images are
	not connected.

	* app/core/picmanimage-undo-push.c (undo_pop_layer,channel): don't
	update the drawable since (a) its pixels don't change and (b) the
	image updates itself upon adding/removing now.

	(undo_pop_layer_mod): replaced picman_image_update() by
	picman_drawable_update() (just for consistency with other similar
	functions).

	* app/core/picmanlayer.c: connect to "update" of the layer mask and
	issue updates on the layer if the mask update has any effect on
	the projection.
	(picman_layer_create_mask): don't set the mask's offsets here since
	they may be different when we later add the mask to the layer.

	* app/core/picmanlayermask.c (picman_layer_mask_set_layer): set the
	mask offsets here instead.

	* app/core/picmanchannel.c (picman_channel_translate): update the
	channel even if push_undo == FALSE.

	* app/paint/picmanpaintcore.c (picman_paint_core_finish)
	* app/tools/picmaninktool.c (ink_finish): invalidate both the
	drawable and the image preview since invalidating the drawable
	doesn't invalidate the image any more.

	* app/text/picmantextlayer.c (picman_text_layer_render_now): also
	update the new extents of the text layer, not only the old one.

	(picman_text_layer_render_layout): don't update the drawable since
	picman_drawable_fill() already updated it.

2003-09-06  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: removed compiler warnings, cleaned
	up coding style issues,

2003-09-06  Dave Neary  <bolsh@picman.org>

	Ooops! Sorry for the oversight.
	* app/vectors/picmanvectors.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: Changed include order 
	to conform to the coding standards in devel-docs/includes.txt
	(which should really be integrated into HACKING).

2003-09-06  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/gui/Makefile.am
	* app/paint/Makefile.am
	* app/pdb/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am
	* app/xcf/Makefile.am (INCLUDES): add $(LIBART_CFLAGS) here too.

2003-09-06  Dave Neary  <bolsh@picman.org>

	* app/vectors/Makefile.am: Include libart headers
	* app/vectors/picmanvectors.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.[ch]: Committing unfinished, 
	useless stub code for converting a PicmanVectors object to a 
	libart vector path. Will pad this out later.
 
2003-09-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_fill): made my last
	commit compile. Sorry.

2003-09-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c: code cleanup.
	(picman_drawable_fill): use the INTENSITY() of the passed PicmanRGB to
	fill PICMAN_GRAY drawables, not just the RED_PIX. Cleanup.

	* app/core/picmanimage.c (picman_image_transform_color):
	added assertion for src_type != PICMAN_INDEXED.

2003-09-05  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_draw_grid):
	access the grid structure directly instead of using g_object_get()
	and leaking the returned values. Release the GC object instead of
	leaking it (the GC should probably become part of the display).

	* app/gui/grid-dialog.c (grid_dialog_new): removed an extraneous
	reference count from grid_backup.

2003-09-05  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: removed function map_to_color()
	since it does not belong here and the two places using it look much
	cleaner when doing that stuff themselves.

	* app/core/picmandrawable-preview.c: cleanup.
	(picman_drawable_preview_scale): do the indexed palette lookup here
	instead of calling map_to_color().

	* app/core/picmanimage.c (picman_image_get_color): transform the
	colors here instead of calling map_to_color().

	* app/core/picmanimage.[ch] (picman_image_get_color): reordered
	parameters so src parameters are before dest parameters.
	Made the src color const.

	(picman_image_transform_color): reordered so src parameters are
	*after* dest parameters (since this function operates on the dest
	image and it makes sense to have the dest parameters
	together). Made the src color const here, too.

	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer.c
	* app/core/picmanpalette-import.c
	* app/paint/picmanclone.c
	* app/paint/picmanpaintcore.c: changed accordingly.

	* app/core/picmanedit.c (picman_edit_cut,copy): simplified by
	moving the "cropped" variable to a local scope.

	* app/core/picmanimage-mask.c: calling picman_image_update() followed
	by picman_viewable_invalidate_preview(drawable) is equal to calling
	picman_drawable_update() directly.

2003-09-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanpreviewcache.[ch]: code cleanup. Removed the
	PreviewCache struct that used to wrap TempBuf but didn't add any
	additional information. Actually free the cached temp_buf when
	removing an entry from cache. Free the GSList when invalidating
	the preview cache.

2003-09-05  Helvetix Victorinox  <helvetix@picman.org>

	* app/paint-funcs/paint-funcs.c (initial_sub_region): Fixed
	  another bug in initialising the compositing context for the
	  special case of dissolve mode.  A further attempt to fix bug
	  #121438.
 
	* app/composite/picman-composite-generic.c
	  (picman_composite_dissolve_any_any_any_generic): Fixed bug in
	  calculating whether the destination has an alpha channel (or
	  not).

2003-09-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.c (picman_image_merge_layers): unref
	the parasite list before assigning a copy.

2003-09-05  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c (temp_buf_new_check): fixed loop boundaries,
	spotted by Wolfgang Hofer (bug #121521).

2003-09-05  Sven Neumann  <sven@picman.org>

	* app/base/picmanlut.[ch] (picman_lut_free): free the memory allocated
	for the PicmanLut structure. Removed trailing whitespace.

	* app/core/picmanbuffer.c: cosmetics.

	* app/core/picmanedit.[ch]: let picman_edit_cut() and picman_edit_copy()
	return a pointer to the global cut buffer instead of creating a
	PicmanBuffer which was leaked by most callers.

	* app/gui/edit-commands.c: changed accordingly.

	* libpicmanwidgets/picmanquerybox.[ch] (string_query_box_ok_callback):
	removed a superfluous g_strdup(); made PicmanQueryStringCallback take
	a const gchar* pointer.

	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/palettes-commands.c
	* plug-ins/gflare/gflare.c: changed accordingly.

2003-09-05  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_interface):
	don't fiddle with the spin-buttons, the defaults are fine.
	Removed trailing whitespace.

2003-09-04  Manish Singh  <yosh@picman.org>

	* app/base/cpu-accel.c: null-terminate string for vendor comparisons.

2003-09-04  Manish Singh  <yosh@picman.org>

	* app/base/cpu-accel.[ch]: rewrote the x86 tests, moved debug printout
	from base.c to here.

	* test-cpu-accel.c: simple test program to test the above.

	* app/base/base.c: use cpu_accel_print_results ()

	* app/base/Makefile.am: added test-cpu-accel to TESTS.

	* data/Makefile.am: make site local font directory on install.

2003-09-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/font-map.scm (script-fu-font-map):
	Render the specified text by default, added optional font labels.

2003-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch]: removed picman_channel_load().

	* app/core/picmanimage-mask.[ch]: removed picman_image_mask_load()
	and _save().

	* app/core/picmanselection.[ch]: added picman_selection_load() and
	_save() since these functions are specific to the selection.

	* app/core/picmanimage-qmask.c
	* app/gui/select-commands.c
	* app/widgets/picmanselectioneditor.c
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/selection_cmds.c: regenerated.

2003-09-04  Sven Neumann  <sven@picman.org>

	* libpicman/Makefile.am: forgot to add picmanfonts_pdb.[ch].

2003-09-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/font-map.scm (script-fu-font-map):
	Keep text layers instead of merging them down. Allow to specify a
	text to render in place of the font names.

2003-09-04  Sven Neumann  <sven@picman.org>

	* autogen.sh (LIBTOOL_WIN32): changed to 1.5 since win32 libtool
	doesn't seem to be reporting the micro version number.

2003-09-04  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/paths.pdb: init path_list to quell gcc warning.

	* app/pdb/paths_cmds.c: regenerated.

2003-09-04  Manish Singh  <yosh@picman.org>

	* app/text/picmantextlayer-transform.c: use
	picman_drawable_invalidate_boundary now.

2003-09-04  Manish Singh  <yosh@picman.org>

	* configure.in: #define ARCH_X86 on x86-64 too.

	* app/composite/picman-composite-sse2.c: dererference pointers outside
	of asm() construct.

	Now this stuff builds on x86-64, but fails some of the tests. Need
	to fix it later.

2003-09-04  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/fonts.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb: init pattern_list to quell gcc
	warning.

	* app/pdb/brushes_cmds.c
	* app/pdb/fonts_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/patterns_cmds.c: regenerated.

2003-09-04  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb (plugins_query): use regfree()
	instead of accessing regex_t directly.

	* app/pdb/plug_in_cmds.c: regenerated.

2003-09-04  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmancontainer-filter.[ch]: added filter functionality
	for PicmanContainers.

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/fonts.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb: made the picman_foo_get_list()
	PDB function somewhat useful by adding a filter parameter that
	allows to specify a regular expression to be used on the list.

	* app/pdb/Makefile.am: had to uglify the ugly hack even more :(

	* app/pdb/brushes_cmds.c
	* app/pdb/fonts_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/patterns_cmds.c
	* libpicman/picmanbrushes_pdb.[ch]
	* libpicman/picmanfonts_pdb.[ch]
	* libpicman/picmangradients_pdb.[ch]
	* libpicman/picmanpalettes_pdb.[ch]
	* libpicman/picmanpatterns_pdb.[ch]: regenerated.

	* plug-ins/gflare/gflare.c
	* plug-ins/pypicman/picmanmodule.c: changed accordingly.

	* plug-ins/script-fu/scripts/font-map.scm: replaced the font list
	parameter with a more useful regexp filter on the available fonts.

2003-09-04  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer.[ch] (picman_container_get_name_array):
	fixed a bug in the implementation.
	Changed picman_container_foreach() to take a const container.

2003-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch]
	* app/core/picmanselection.c: reordered PicmanChannel::is_empty()
	after PicmanChannel::boudary() and PicmanChannel::bounds() because it
	belongs to that group of functions.

2003-09-04  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: Bah. Fixed stupid error from
	my last commit.

2003-09-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/font-map.scm: ported from picman-text
	to picman-text-fontname API.

2003-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanchannel-combine.[ch]: new files split out of
	picmanchannel.[ch].

	* app/core/picmanchannel.[ch]: removed the combine functions here.

	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanimage-mask-select.c
	* tools/pdbgen/pdb/channel.pdb: changed #includes accordingly.

	* app/pdb/channel_cmds.c: regenerated.

2003-09-04  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer.[ch]: added new function
	picman_container_get_name_array().

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/patterns.pdb: use the new PicmanContainer function
	instead of duplicating this code over and over again.

	* app/pdb/brushes_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/patterns_cmds.c
	* libpicman/picmangradients_pdb.c: regenerated.

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/fonts.pdb: added new file that defines a simple
	PDB API for fonts.

	* tools/pdbgen/groups.pl
	* app/pdb/Makefile.am
	* app/pdb/fonts_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picman_pdb.h
	* libpicman/picmanfonts_pdb.[ch]: (re)generated.

2003-09-04  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: Changed the direct dragging
	of a segment a bit, so that close to one endpoint only one
	handle gets moved.

2003-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: removed the _push_undo() and
	_invalidate() wrappers.

	* app/core/picmanimage-mask-select.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanlayer-floating-sel.c
	* app/tools/picmantransformtool.c: changed accordingly.

2003-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: added new pure virtual function
	PicmanDrawable::invalidate_boundary().

	* app/core/picmanlayer.[ch]: implement it and removed public
	function picman_layer_invalidate_boundary().

	* app/core/picmanchannel.[ch]: implement it.

	* app/core/picmanselection.[ch]: implement it and removed public
	function picman_selection_invalidate().

	* app/core/picmanimage-mask.c (picman_image_mask_invalidate)
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/text/picmantextlayer.c: changed accordingly.

	* app/core/picmanchannel.[ch]: made picman_channel_push_undo() a
	public function and made it call
	picman_drawable_invalidate_boundary(). Added undo_desc strings for
	all undo pushing functions to PicmanChannelClass.

	* app/core/picmanselection.[ch]: removed picman_selection_push_undo()
	since after the change above it was identical to
	picman_channel_push_undo().  Don't push any undo here since
	upchaining does the right thing now.  Override PicmanChannelClass'
	undo_desc strings to say "Selection".

	* app/core/picmanimage-mask.c (picman_image_mask_push_undo): changed
	accordingly.

2003-09-04  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb (path_get_points): lookup the vectors
	by name instead of always using the active path (bug #121401).
	Made all functions use the convenience function
	picman_image_get_vectors_by_name() instead of the PicmanContainer API.

	* app/pdb/paths_cmds.c: regenerated.

	* app/core/picmanimage.c: simplified the picman_image_get_foo_by_name
	functions by making use of picman_container_get_child_by_name().

2003-09-04  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Cleanup. Properly freeze/thaw
	the vectors.

2003-09-03  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.c
	* app/vectors/picmanbezierstroke.c: Two small hacks to make the
	editing behave more symmetric (no more a user visible difference
	between extending to the start or to the end of a stroke).

	* app/tools/picmanvectortool.c: Use dashed lines for the connection
	between the anchor and the handles. Looks great IMHO.

2003-09-03  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: properly keep track of the
	active anchor and retrieve that information after a _thaw () so
	that proper editing is possible after an undo. Now the
	vector_tool->cur_* variables are constantly updated in
	_oper_update () so that we don't need to determine them in
	_button_press () again.

	On request by Jimmac and Joao connecting two stroke-ends now
	works by activating one endpoint and clicking on the other
	endpoint in Insert/Delete Mode.

2003-09-03  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/ccanalyze.c (analyze): use Alpha channel and
	selection channel info when available to build the histogram and
	to include/exclude colors in the color count. Fixes bug #121097
	and handling of INDEXEDA images which was broken.
	(histogram, insertcolor, fillPreview): updated to use gdoubles
	where appropriate.

2003-09-03  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/ccanalyze.c: Changed from CR/LF style to LF
	style in preparation for the next batch of changes.

2003-09-03  Manish Singh  <yosh@picman.org>

	* autogen.sh: fix case for uname checks (needs to be in all CAPS).

2003-09-03  Sven Neumann  <sven@picman.org>
 
	* HACKING
	* autogen.sh: require libtool version 1.5.0 or newer when building
	on Win32. Completely untested but it should fix bug #120953.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: removed the _bounds() and
	_boundary() wrappers.

	* app/core/picmandrawable.c
	* app/display/picmandisplayshell-selection.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmantransformtool.c
	* app/xcf/xcf-save.c: changed accordingly.

2003-09-03  Sven Neumann  <sven@picman.org>

	* devel-docs/gbr.txt
	* plug-ins/common/gbr.c: applied a patch from Guillermo S. Romero
	that fixes loading of v1 brushes and documents the difference
	to version 2 of the brush file format (bug #121304).

2003-09-03  Sven Neumann  <sven@picman.org>

	* app/tools/picmanclonetool.c: Ctrl only sets the clone source when
	Shift isn't pressed at the same time (fixes bug #121324).

2003-09-03  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h (dissolve_pixels)
	* app/composite/picman-composite-generic.c	
	(picman_composite_dissolve_any_any_any_generic): fixed a bug in the
	dissolve algorithm (bug #121305).

2003-09-03  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Added epoch 1.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: removed the _value() and
	_is_empty() wrappers.

	* app/display/picmandisplayshell.[ch]: removed
	picman_display_shell_mask_value() since it is not used.

	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/gui/image-menu.c
	* app/gui/vectors-menu.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/misc_tools.pdb: changed accordingly.

	* app/pdb/misc_tools_cmds.c: regenerated.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.[ch]: removed the _clear() wrapper.

	* app/core/picmanimage-mask.[ch]: changed accordingly. Added
	"const gchar *undo desc" parameter to
	picman_image_mask_select_vectors().

	* app/core/picmanimage-qmask.c
	* app/gui/vectors-commands.c
	* app/text/picmantext-compat.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanrectselecttool.c
	* app/widgets/picmanvectorstreeview.c
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly. Also
	replaced some wrappers which still exist.

	* tools/pdbgen/pdb/paths.pdb: stroke using picman_item_stroke().

	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: removed the feather(), sharpen(),
	all(), invert(), border(), grow() and shrink() wrappers.

	* app/core/picmanselection.[ch]: changed picman_selection_invalidate()
	and picman_selection_push_undo() to take PicmanChannel parameters, not
	PicmanSelection ones. They will be made virtual PicmanChannel
	functions anyway.

	* app/core/picmanedit.c
	* app/gui/select-commands.c
	* app/widgets/picmanselectioneditor.c
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/selection_cmds.c: regenerated.

2003-09-03  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolor.def: added picman_rgb_to_cmyk_int().

2003-09-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: don't include the plug-in name in
	messages; PICMAN takes care of this for us.

2003-09-03  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Moved some essential config files from the 
	devel package to the main one. Oops.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: removed the _translate()
	and _stroke() wrappers.

	* app/gui/edit-commands.c
	* app/tools/picmaneditselectiontool.c
	* app/widgets/picmanselectioneditor.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

	* app/core/picmanselection.c: implement PicmanItem::scale(), resize(),
	flip() and rotate().

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c: no need to call
	picman_image_mask_invalidate() and/or picman_image_mask_changed()
	manually after scale, resize, flip and rotate, since PicmanSelection
	updates itself correctly.

2003-09-03  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_init): s/extension/plug_in/ for Script-Fu
	procedures to get batch mode working again.

2003-09-02  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite.c (picman_composite_init): Turn on
	  SSE, SSE2, and 3dnow instruction sets.

	* app/paint-funcs/paint-funcs.c (initial_sub_region): Fixed
	  uninitialised data in the special case for dissolve.
	  This is the cause of Bug #121213.

2003-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch]: made all functions which push an
	undo step virtual and added them all as default implementations.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanselection.[ch]: new object which is a PicmanChannel
	subclass and implements all of its virtual functions, pushes
	an image_mask undo and chains up with "push_undo = FALSE".

	* app/core/picmanimage-mask.[ch]: made most functions simple
	wrappers like picman_channel_invert(picman_image_get_mask(gimage));
	so the API stays the same for now.

	* app/core/picmanimage.[ch]: create a PicmanSelection object
	as gimage->selection_mask. Removed "gboolean mask_stroking"
	since it is in PicmanSelection now.

	* app/xcf/xcf-load.c (xcf_load_channel_props): added an evil hack
	which turns a PicmanChannel into a PicmanSelection once we figured the
	loaded channel is the selection.

	* app/core/picmanlayer.c (picman_layer_create_mask):
	picman_channel_clear() takes an additional "const gchar *undo_desc"
	parameter now.

	* app/core/picmanscanconvert.c (picman_scan_convert_to_channel): set
	mask->bounds_known to FALSE before returning the new channel

	* app/tools/picmaniscissorstool.c (iscissors_convert): no need to
	call picman_channel_invalidate_boundary() on the channel returned by
	the above function.

	* app/core/picmanchannel.[ch]: removed
	picman_channel_invalidate_boundary() since it is no longer needed.

2003-09-03  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.[ch] (picman_rgb_to_cmyk_int): made
	pullout a percentage instead of a maximal value.
	(picman_rgb_to_cmyk): added a pullout parameter here as well.

	* app/gui/info-window.c
	* plug-ins/common/newsprint.c: changed accordingly.
	
	* modules/colorsel_cmyk.c: allow to specify the amount of black
	pulled out when converting to CMYK.

2003-09-03  Dave Neary  <bolsh@picman.org>

	* NEWS: Changed slightly - I overestimated/overanticipated 
	some things.

	* HACKING: Updated to fix some indentation issues, and clear 
	up some small points (like not building as root) following 
	suggestions from Emmet Caulfield <emmet@netrogen.com>

2003-09-02  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c (picman_rgb_to_cmyk_int): allow to
	specify the amount of black pullout. Documented the function.

	* plug-ins/common/newsprint.c: use the RGB to CMYK routine from
	libpicmancolor.

2003-09-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]: added new function
	picman_draw_tool_draw_dashed_line().

2003-09-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_init): default to
	PICMAN_TAB_STYLE_PREVIEW.
	(picman_dockable_new): fall back to _ICON if
	dockable->get_preview_func is NULL.

	* app/widgets/picmandialogfactory.c
	(picman_dialog_factories_restore_foreach): ditto.

2003-09-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c (init_edit_selection): removed
	a superfluous call to g_object_ref().

	* app/vectors/picmanvectors.c (picman_vectors_copy_strokes): free the
	old list of strokes.

2003-09-02  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout-render.c (picman_text_layout_render)
	* app/widgets/picmanfontselection.c (picman_font_selection_set_fontname)
	* app/widgets/picmantexteditor.c (picman_text_editor_new)
	* app/gui/file-save-dialog.c (file_save_ok_callback): plugged
	some memleaks found using memprof.

	* app/vectors/picmanvectors.c: implemented the finalize method.

	* app/vectors/picmanstroke.c: minor code cleanup.

	* app/core/picmandrawable.c (picman_drawable_finalize)
	* app/core/picmanlayer.c (picman_layer_finalize)
	* app/core/picmanparasitelist.c (picman_parasite_list_finalize):
	removed useless assertions.

2003-09-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanmodules.c (picman_modules_load): silently ignore a
	non-existing modulerc.

2003-09-02  Michael Natterer  <mitch@picman.org>

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: removed "module-load-inhibit"
	property since the PicmanModuleDB stores this value.

	* app/config/picmanconfigwriter.[ch] (picman_config_writer_new_file):
	renamed parameter "gboolean safe" to "gboolean atomic".

	* app/core/picmanmodules.c: ported modulerc parsing/writing to
	GScanner and PicmanConfigWriter (apparently it was forgotten during
	picmanrc cleanup). Makes keeping modules from being loaded work
	again. Reported by Michael Schumacher on #picman.

2003-09-02  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.c: duplicate the closed property too.
	fixes Bug #120961.

2003-09-02  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c: coding style and indentation.

2003-09-01  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c: Dereference all pointers
	  from *outside* of asm() construct.

	* app/paint-funcs/paint-funcs.c: Fixed bug where dissolve opacity
	  was incorrectly set, and dissolve mask was garbage. This should
	  fix Bug #121213

2003-09-01  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/domain.c: fixed help domain parsing.

2003-09-01  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c: Replaced all memory
	  references in asm() constructs to references to "input" parameters
	  to the asm().  This should take care of any name mangling issues
	  (see bug #120893)

	  Beautified more code to conform to the picman style guidelines.

	  No longer doing pointer math in assembly.  This should ease some
	  of the issues of compiling on 64bit machines.

	* app/composite/picman-composite-sse-installer.c
	* app/composite/picman-composite-sse-test.c: Removed reference to
	  picman_composite_overlay_* because this code is suspect.
	
2003-09-01  Dave Neary  <bolsh@picman.org>

	NEWS: Updated NEWS.

2003-09-01  Manish Singh  <yosh@picman.org>

	Font configuration stuff: You can rescan for fonts on the fly now.
	A couple caveats: the text tool font dialog doesn't get updated, but
	that's supposed to be going away. The new font dock doesn't resort
	on update, but mitch is supposed to fix that. :)

	Some nice stuff for advanced font users: PICMAN local font directories,
	and an optional site and user fonts.conf.

	I thought about supporting the auto-resan feature in fontconfig,
	but it might take too much time to do a scan so I haven't implemented
	it. Another thing I want to do is create fontconfig caches in the
	local dirs.

	* text/picmanfonts.[ch]: picman_fonts_init/load/reset implementation.

	* text/Makefile.am: added picmanfonts.[ch]

	* app/core/picman.c: use picman_fonts_init/reset.

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: added font-path config setting.

	* app/gui/preferences-dialog.c: Add a Font Folders section for the
	above. Also added a Rescan Font List button, which goes in the
	Environment section. Not sure if this is the right place...
	it also looks kinda ugly all by its lonesome.

	* app/gui/user-install-dialog.c: mention the fonts directory.

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders-fonts.png: dummy icon for
	font folders pref, probably a folder with a little "T" in the corner
	would be good.

2003-09-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added new virtual function
	PicmanItem::stroke().

	* app/core/picmanchannel.c
	* app/vectors/picmanvectors.c: implement PicmanItem::stroke().

	* app/core/picmanimage-mask.[ch] (picman_image_mask_stroke): changed
	signature to match picman_item_stroke() (the selection mask *really*
	should be a PicmanChannel subclass).
	Removed global variable "gboolean picman_image_mask_stroking"...

	* app/core/picmanimage.[ch]: ...and added "gboolean mask_stroking"
	to the PicmanImage struct.

	* app/gui/vectors-commands.[ch]: removed vectors_stroke_vectors().

	* app/widgets/widgets-types.h: removed PicmanStrokeItemFunc typedef.

	* app/widgets/picmanvectorstreeview.[ch]: removed "stroke_item_func"
	member and use picman_item_stroke() instead.

	* app/gui/dialogs-constructors.c (dialogs_vectors_list_view_new)
	* app/gui/edit-commands.c (edit_stroke_cmd_callback)
	* app/gui/vectors-commands. (vectors_stroke_cmd_callback)
	* app/widgets/picmanselectioneditor.c
	(picman_selection_editor_stroke_clicked)
	* tools/pdbgen/pdb/edit.pdb (picman_edit_stroke): changed accordingly.

	* app/pdb/edit_cmds.c: regenerated.

	Note that there is no GUI for "stroke channel", although it would
	be utterly cool to have one, since currently slelection stroking
	cannot be masked by a selection (because we stroke the selection).
	Anyway, if anyone has an idea how to trigger "stroke channel" with
	another drawable active (the one to stroke to), please let me
	know...

2003-09-01  Manish Singh  <yosh@picman.org>

	* app/gui/preferences-dialog.c: added a shadow around the comment
	entry box, looks nicer.

2003-09-01  Michael Natterer  <mitch@picman.org>

	We really don't need that global variable overkill from appenv.h
	just to pass these values from main() to app_init():

	* app/app_procs.[ch] (app_init): added tons of parameters that
	used to be global variables before.
	Replaced app_init_update_status() by two functions, one which
	actually updates the splash, and one which does nothing, so we
	don't need global variables in the status callback.

	* app/appenv.h: removed variable declarations here. Some are still
	left, will get rid of this entire file soon...

	* app/main.c: added them as local variables to main() and
	pass them to app_init().

	* app/batch.c: removed the global "batch_cmds", they are passed
	the same way as the stuff above now.

2003-09-01  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: added simplistic undo, needs polishing.

2003-09-01  Michael Natterer  <mitch@picman.org>

	* app/gui/channels-menu.c
	* app/gui/layers-menu.c
	* app/gui/vectors-menu.c: removed accelerators from popup menus.
	The HIG says nono and we will use the global <Image> accelerator
	table all over the place soon. First part of fix for bug #119878.

2003-09-01  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/edge.c (run): fixed check for the number of
	arguments (don't always fail). Fixes bug #121176.

2003-08-31  Manish Singh  <yosh@picman.org>

	* app/paint/picmanpaintcore.c: inlined rotate_pointers, made it specific
	to gulongs (made more sense to me than adding casts)

2003-09-01  Simon Budig  <simon@picman.org>

	* app/vectors/picmancoordmath.[ch]: Introduced function to compare
	two picmancoords

	* app/vectors/picmanstroke.[ch]: virtualized picman_stroke_close.

	* app/vectors/picmanbezierstroke.c: made the _close function check,
	if there is an unneeded segment (ACCA-Sequence with all the same
	coordinates) at the gap to be closed. If so, remove it.

2003-09-01  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Update.

	* app/composite/picman-composite-mmx.c: For some reason the gcc&gas
	combination used on Win32 wants identifiers prefixed with
	underscores in the asm sequences.

	* plug-ins/common/ps.c (ps_open): [Win32] Don't write the gs
	executable name into the indirect command line file. Do write the
	quoted form of the filename to it.
	(my_shell_quote): New funcion. Use instead of g_shell_quote() on
	Windows, as g_shell_quote() always uses single quotes, which don't
	mean anything to the Windows shell (or C runtime startup
	code). (This might be argued to be a bug in GLib, maybe
	g_shell_quote should behave differently accoring to platform.)

	* etc/picmanrc.win32: Remove, generate with picmanconfig-dump.

	* */makefile.mingw.in: Remove, unmaintained.

2003-09-01  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c: removed excessive path debugging output.

	* app/text/picmantext-vectors.c: always close strokes created from
	text outlines.

2003-09-01  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: fixed it to create proper strokes...

2003-09-01  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-vectors.c: use the new bezier stroke API.

	* app/vectors/picmanbezierstroke.c (picman_bezier_stroke_new_moveto):
	pass a NULL anchor to the first call of picman_bezier_stroke_extend().

2003-08-31  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.[ch]: Implemented moveto/lineto/
	conicto/curveto-Interface.
	Moved helper functions to calculate with PicmanCoords into...

	* app/vectors/picmancoordmath.[ch]: ...these new files.

	* app/vectors/Makefile.am: Changed accordingly.

2003-08-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/bz2.c: make it behave more like the gzip plug-in
	and attempt to load and save files even if there's no sensible
	extension.

	* plug-ins/common/gz.c: minor string change for consistency.

2003-08-31  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: applied an old patch from Carl Adams that
	was updated for 1.3 by Tino Schwarze. The patch fixes the isometric
	grid so that its mathematical properties can be exploited (#34825).

2003-08-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gz.c: applied a patch from Raphael Quinet that
	adds '-n' to the gzip command-line (bug #72791). Did some minor
	code cleanup and fixed a problem introduced by the latest change
	that caused a crash when loading remote gzipped files.

2003-08-31  Manish Singh  <yosh@picman.org>

	* plug-ins/helpbrowser/dialog.c (io_handler): g_io_channel_read_chars
	takes a gsize.

2003-08-31  Manish Singh  <yosh@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_layer): gsize is unsigned,
	reflect that in the g_prints.

	* tools/pdbgen/pdb/color.pdb: case to PICMAN_BASE_CONFIG for the call
	to picman_histogram_new, #include "core/picmandrawable-histogram.h"

	* app/pdb/color_cmds.c: regenerated.

2003-08-31  Sven Neumann  <sven@picman.org>

	* app/gui/layers-commands.[ch]	
	* app/gui/layers-menu.c: added "Merge Visible Layers..." and
	"Flatten Image" menu entries as suggested in bug #120959.

	* app/text/picmantext-vectors.c: fixed function declaration; we are
	passing a PangoGlyph here, not a (PangoGlyph*).

2003-08-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c: applied a modified version of a patch
	from Andy Wallis that is supposed to fix bug #68538.

2003-08-31  Manish Singh  <yosh@picman.org>

	* configure.in: added a prominent comment for translators to make
	sure they have all 4 po files before adding to ALL_LINGUAS.

	* app/gui/plug-in-menus.c: remove redudant #include of picmanenv.h

	* tools/pdbgen/pdb/plug_in.pdb: picman_strip_uline menu_path before
	passing it up.

	* app/pdb/plug_in_cmds.c: regenerated.

	* plug-ins/common/mng.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c: use G_N_ELEMENTS

	* plug-ins/common/screenshot.c: use GDK_WINDOWING_* for #includes
	too. GDK cursor enums are ok to pass to XCreateFontCursor.

	* plug-ins/dbbrowser/dbbrowser_utils.c: minor cleanups, also use
	gtk_cell_renderer_text_set_fixed_height_from_font as an optimization.

	* plug-ins/libgck/gck/gckcolor.c: #undef GDK_DISABLE_DEPRECATED and
	add warning.

	* plug-ins/pypicman/picmanfu.py: remove some redundant import gtk's

2003-08-31  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c: applied a patch from S. Mukund
	that fixes the picman_hsv_to_rgb_int() and picman_rgb_to_hsv_int()
	functions (bug #115626).

2003-08-31  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/color.pdb: applied a patch from Shawn Willden
	that adds the new PDB function levels_auto.

	* app/pdb/color_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmancolor_pdb.[ch]: regenerated.

2003-08-31  Raphael Quinet  <quinet@gamers.org>

	* data/palettes/Makefile.am (palettedata_DATA): fixed the spelling
	of Khaki.gpl after Sven's last commit.

2003-08-31  Danilo Å egan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-08-31  Sven Neumann  <sven@picman.org>

	* data/palettes/Kahki.gpl: removed ...
	* data/palettes/Khaki.gpl: ... and readded under the correct name.
	Misspelling spotted by Roman FroÅow.

2003-08-31  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/ccanalyze.c (analyze): Fix bug preventing the
	plug-in from working properly with rectangular selections. It
	still doesn't work properly with arbitrarily-shaped selections.

2003-08-31  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_translate_func):
	make a copy of dgettext() results from full_path in all cases, since
	it might return our original string. Fixes #121083.

2003-08-31  Michael Natterer  <mitch@picman.org>

	Removed libgck from the public libpicman API:

	* plug-ins/libgck/gck/Makefile.am: don't build and install a
	shared library and any header files. Instead, build a
	noinst_LIBRARY.

	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am: link against the uninstalled
	libgck.a convenience lib.

2003-08-30  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c: made "tool-info" a G_PARAM_CONSTRUCT_ONLY
	property.

	* app/tools/tool_manager.c (tool_manager_tool_changed): pass it to
	g_object_new() instead of setting it after tool creation.

	* app/tools/picmanpainttool.[ch]
	* app/tools/picmantransformtool.[ch]: removed ugly
	"gboolean notify_connected" hacks and connect to the signals in
	GObject::constructor().

	* app/tools/picmanpainttool.c (picman_paint_tool_contstructor): create
	paint_tool->core here from tool->tool_info->paint_info->paint_type.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmansmudgetool.c: changed accordingly. Removed lots of
	useless class_init functions. Converted tabs to spaces. Cleanup.

2003-08-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch] (picman_channel_boundary)
	* app/core/picmanimage-mask.[ch] (picman_image_mask_boundary)
	* app/core/picmanlayer-floating-sel.[ch] (floating_sel_boundary):
	return const BoundSeg arrays because they are cached and not newly
	allocated.

	* app/base/boundary.[ch] (sort_boundary)
	* app/tools/picmandrawtool.[ch] (picman_draw_tool_draw_boundary):
	take const BoundSeg arrays.

	* app/core/picmanimage-mask.c (picman_image_mask_stroke)
	* app/display/picmandisplayshell-selection.c
	* app/tools/picmaneditselectiontool.c (init_edit_selection):
	changed accordingly.

2003-08-30  Michael Natterer  <mitch@picman.org>

	Fixed & cleaned up paint function registration to work without
	GUI. Finishes core/GUI separation for the paint tools:

	* app/core/picmanpaintinfo.[ch]: removed "gchar *pdb_string" all over
	the place since we don't stroke using the PDB any more.
	(picman_paint_info_new): create paint_info->paint_options here so
	the paint system is fully initialized when there is no GUI.

	* app/paint/paint.c: removed pdb_string stuff here, too.

	* app/core/picmantoolinfo.[ch]: create tool_info->tool_options
	only if tool_info->tool_options_type is not the same type
	as paint_info->paint_options_type (if we are no paint tool).

	* app/core/picmantooloptions.c: removed G_PARAM_CONSTRUCT_ONLY from
	the "tool-info" property. Instead, changed
	picman_tool_options_set_property to ensure that it is only set once.

	* app/core/picman.c (picman_initialize): moved paint_init() after
	data_factory creation (was in picman_init()), since PicmanPaintInfo
	now creates the PicmanPaintOptions, which are PicmanContexts, which
	need picman->*_factory to be constructed.

	* app/tools/tool_manager.c: don't create tool_info->tool_options
	here (it's not the job of the tool_manager to set up the core
	paint system correctly, it must be already initialized before any
	tool_manager function is called).

	Made "Stroke Selection" and "Stroke Path" work the same way:

	* app/paint/picmanpaintcore-stroke.[ch]: added new function
	picman_paint_core_stroke_boundary() which strokes without using
	the PDB.

	* app/core/picmanimage-mask.c (picman_image_mask_stroke): use it
	instead of using the PDB. Enables all available paint options for
	stroke operations. Fixes bug #119411.

	* app/gui/vectors-commands.c (vectors_stroke_vectors)
	* app/core/picmanimage-mask.c (picman_image_mask_stroke): removed all
	code which tries to figure how to stroke and simply look at the
	active tool's tool_info->paint_info, since it is always set up
	correctly now.

2003-08-30  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: fixed stupid int vs. float
	error that caused rounding errors when moving in a zoomed view.
	Fixed drawing artefact when connecting strokes did not succeed.

2003-08-29  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: further modifier changes.
	Mail to picman-devel will follow.

2003-08-29  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: Do not modify the selection
	state of the anchors. When extending EXTEND_EDITABLE return
	the anchor created (not the handle at the end of the list)

	* app/tools/tools-enums.h: Added new mode-enum for the vector tool.
	* app/tools/tools-enums.c: regenerated
	
	* app/tools/picmanvectortool.[ch]: Implemented moving (Shortcuts
	ALT and ALT+CTRL. The whole assignment of modifiers right now
	gets revised. Right now you have to use the Tool options to
	switch between the modes of operation. Connecting strokes now
	works in Insert/Delete mode by clicking on startpoint and
	dragging to target endpoint.

	I will write a mail to picman-devel when the shortcuts are
	setteled a bit more. Sorry for the inconvenience.

2003-08-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c (picman_text_options_gui): move the
	mnemonic from the old font selection widget to the new one. The
	old one will die soon. Fixes bug #120963.

2003-08-29  Sven Neumann  <sven@picman.org>

	* configure.in: removed be (Belarusian) from ALL_LINGUAS until all
	be.po files are provided.

2003-08-29  Dmitry G. Mastrukov  <dmitry@taurussoft.org>

	* configure.in: Added Belarusian to ALL_LINGUAS.

2003-08-28  Larry Ewing  <lewing@ximian.com>

	* app/text/picmantext-vectors.c (conicto): interpolate the position
	of the cubic control points correctly and set the previous control
	point.
	(cubicto): set the previous control point to the new value then
	add remaining points.

2003-08-28  Manish Singh  <yosh@picman.org>

	* plug-ins/common/screenshot.c: cleanups. sizeof() isn't valid
	in preprocessor land. Use GDK_WINDOWING_* instead of G_OS_WIN32.
	XFreeCursor when we're done with it.

2003-08-28  Manish Singh  <yosh@picman.org>

	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmanimage-snap.c
	* app/core/picmanpattern.c
	* app/core/picmanundostack.c
	* app/display/picmandisplayshell.c
	* app/gui/grid-dialog.c
	* plug-ins/common/CML_explorer.c: cleanup, remove unnecessary casts.

2003-08-28  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.20.

2003-08-28  Dave Neary <bolsh@picman.org>

	* NEWS: Updated the NEWS file.

2003-08-28  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/screenshot.c: rewrote a large part of the
	screenshot plug-in. The plug-in now no longer depends on the xwd
	utility, but uses Xlib/GDK functionality to obtain the screen shot.

	The window to shoot is now selected prior to the time out. This
	fixes bug #103852.

	The ability to obtain a screen shot of a window without
	decorations has had to go since this can not be done using plain
	Xlib/GDK (one would have to depend on libXmu to do this).

	The source is prepared for G_OS_WIN32 but the win32 specific code
	is yet to be written.

	* tools/pdbgen/pdb/plug_in.pdb (picman_progress_update): improved the
	inline documentation

	* app/pdb/plug_in_cmds.c
	* libpicman/picmanplugin_pdb.c: regenerated

2003-08-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): free the
	colormap and set colormap size to 0 after converting from indexed.
	Should make picman_image_get_cmap() behave as advertised again.
	Fixes #121033.

	* tools/pdbgen/pdb/image.pdb: use picman_image_get_colormap_size()
	instead of accessing gimage->num_cols directly.

	* app/pdb/image_cmds.c: regenerated.

2003-08-28  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/xjt/xpdb_calls.[ch]: removed

	* plug-ins/xjt/Makefile.am
	* plug-ins/xjt/xjt.c: major clean-up. All calls that were in
	xpdb_calls.[ch] are already available in the various libpicman
	routines.

2003-08-28  Michael Natterer  <mitch@picman.org>

	Completed the new help infrastructure. Needs some polishing but
	basically works as proposed:

	* tools/pdbgen/pdb/plug_in.pdb: changed picman_plugin_help_register()
	to take a "domain_name" (which is the XML namespace) and a
	"domain_uri" (which is the root of the plug-in's help pages).

	* tools/pdbgen/pdb/help.pdb: changed picman_help() to take help_id
	instead of a non-UTF-8 help_path.

	* app/plug-in/plug-in-def.[ch]
	* app/plug-in/plug-in-proc.[ch]
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.[ch]: remember the plug-ins' help_domain
	and help_uri instead of just help_path. Changed all plug-in APIs
	to reflect this change.

	* app/widgets/picmanhelp.[ch]: on helpbrowser startup, pass it the
	whole list of help domains. The actual help request is now made
	using the browser's temporary procedure.

	* app/core/picman.h
	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c
	* app/gui/plug-in-menus.[ch]
	* app/widgets/picmanitemfactory.c: changed accordingly.

	* app/pdb/help_cmds.c
	* app/pdb/plug_in_cmds.c
	* libpicman/picmanhelp_pdb.[ch]
	* libpicman/picmanplugin_pdb.[ch]: regenerated.

	Changed the help broser to load the pages according to the
	new system:

	- moved the browser window stuff to dialog.[ch]
	- moved help domain handling to domain.[ch]
	- added picman-help.xml parsing to domain.c
	- tons of cleanup

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/dialog.[ch]
	* plug-ins/helpbrowser/domain.[ch]: new files.
	* plug-ins/helpbrowser/helpbrowser.c: chopped.

2003-08-28  Simon Budig  <simon@picman.org>

	* app/core/picmanimage-mask-select.c
	* app/vectors/picmanbezierstroke.c: Fixed two crashes when a path
	with a single node in a stroke got converted to a selection or got
	stroked.

2003-08-28  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c (picman_context_real_set_foreground)
	(picman_context_real_set_background): keep the context colors always
	opaque. Fixes bug #120912.

2003-08-28  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: removed a historical enum constraint
	that caused bug #120915.

	* app/pdb/image_cmds.c: regenerated.

2003-08-28  Simon Budig  <simon@picman.org>

	* app/tools/picmantransformtool.c: Modified the test when to paint
	the grid or not. It now checks for convexity of the bounding
	polygon.

2003-08-28  Ville PÃ¤tsi  <drc@picman.org>

	* Makefile.am: Add picman.spec to EXTRA_DIST to add it to
	the dist tarball.

2003-08-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.c
	(picman_layer_tree_view_alpha_changed): update the button states if
	the layer which changed alpha was the active one.
	Fixes bug #120864.

2003-08-27  Michael Natterer  <mitch@picman.org>

	Enabled type-preserving DND of all kinds of items between
	different images. Fixes bug #119983.

	* app/core/picmanitem.[ch]: added new virtual function
	PicmanItem::convert() which duplicates an item for another image.

	* app/core/picmanlayer.[ch]: removed picman_layer_new_from_drawable()
	and made it a PicmanItem::convert() implementation.

	* app/vectors/picmanvectors.[ch]: removed picman_vectors_convert() and
	made it a PicmanItem::convert() implementation.

	* app/widgets/picmanitemtreeview.[ch]: removed PicmanConvertItemFunc
	typedef and function pointer in PicmanItemTreeViewClass since
	we can simply call picman_item_convert() now.

	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c
	* app/display/picmandisplayshell-dnd.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

2003-08-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_translate_func):
	removed debugging output.

2003-08-27  Sven Neumann  <sven@picman.org>

	* Made 1.3.19 release.

2003-08-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c (run): made the PDB interface backward
	compatible by allowing the last parameter to be omitted.

2003-08-27  Dave Neary  <bolsh@picman.org>

	* NEWS: Update NEWS file, split path tool improvements into
	user-visible chunks.

2003-08-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/curve_bend.c: (partly) applied patch from 
	hof@picman.org. Fixes both #119937 and #119938. Some cleanup of the 
	code.

2003-08-27  Michael Natterer  <mitch@picman.org>

	Cleaned up my "To Selection" cleanup:

	* app/gui/channels-commands.[ch]
	* app/gui/layers-commands.[ch]
	* app/gui/vectors-commands.[ch]: removed the separate
	cmd_callbacks for REPLACE,ADD,SUBTRACT,INTERSECT and pass the
	operation as "guint action" to the callback.

	* app/gui/channels-menu.c
	* app/gui/image-menu.c
	* app/gui/layers-menu.c
	* app/gui/vectors-menu.c: changed accordingly.

2003-08-27  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: Implemented function to
	connect two strokes.

	* app/tools/picmanvectortool.[ch]: Use it. Right now you have
	to click on one endpoint, and then SHIFT+CTRL+ALT-Click on
	the other endpoint.

	Suggestions on how to solve that more sanely are welcome...

2003-08-27  Michael Natterer  <mitch@picman.org>

	* app/composite/picman-composite-generic.c
	(picman_composite_generic_init): added missing g_rand_free().

	* app/widgets/picmanitemfactory.[ch]: fixed all leaks in
	picman_item_factory_translate_func(). Added
	item_factory->translation_trash for the pathological cases. Free
	the trash after each call to gtk_item_factory_create_item().

2003-08-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c: applied patch from Guillermo S. Romero
	that moves the newly added PDB parameter to the end and documents
	the former default value.

	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/circuit.scm
	* plug-ins/script-fu/scripts/lava.scm
	* plug-ins/script-fu/scripts/predator.scm: changed accordingly by
	Guillermo S. Romero.

2003-08-27  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am (EXTRA_DIST)
	* libpicmanbase/makefile.msc (EXTRA_DIST): removed picmanversion.h.in.

	* app/composite/Makefile.am (libappcomposite_a_built_sources):
	removed picman-composite-*-installer.h.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp-ids.h: added some toolbox and dock related
	help IDs.

	* app/gui/dialogs-menu.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmantoolbox.c: use them.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/helpbrowser/helpbrowser.c: some cleanup and fixes before
	porting to the new help ID based system. Definitely broken at the
	moment.

2003-08-26  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h: use PICMAN_GRADIENT as prefix for the
	PicmanGradientType enum.

	* app/core/core-enums.c
	* app/pdb/misc_tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmandrawable-blend.c
	* app/tools/picmanblendoptions.c
	* plug-ins/pypicman/plug-ins/sphere.py
	* plug-ins/script-fu/scripts: changed accordingly.

	* libpicman/picmancompat.h	
	* plug-ins/script-fu/siod-wrapper.c: added compatibility defines
	for the old enum values.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformoptions.c
	(picman_transform_options_class_init): it's PICMAN_INTERPOLATION_LINEAR,
	not just PICMAN_LINEAR, argh. Fixes part 1 of bug #120424.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/helpbrowser.c (open_browser_dialog): we
	can't rely on "eek.png" from the help system being installed.
	Use "stock-wilber-eek-64.png" from the default theme instead
	because it is always available.

2003-08-26  Michael Natterer  <mitch@picman.org>

	Bye bye, "crappy/foo.html":

	* app/widgets/picmanhelp-ids.h: replaced "crappy/foo.html" by
	"picman-proper-identifier".

	* app/plug-in/plug-in-proc.[ch] (plug_in_proc_def_get_help_id):
	added "const gchar *help_path" parameter and return a help ID
	ready for attaching to a menu item.

	The help ID is no longer constructed from the plug-in's executable
	name but from the *procedure* name with '_' replaced by '-'. This
	means we can now have help for each script-fu script and for each
	of a plug-in's individual procedures.

	* app/gui/plug-in-menus.c: removed even more duplicated wrong code
	since plug_in_proc_def_get_help_id() is implemented correctly now.

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c: ditto. Reorder the "XCF" menu item
	before the separator and added PICMAN_STOCK_WILBER.

	* app/gui/file-dialog-utils.c: added a mnemonic to the
	"Determine File Type:" label.

2003-08-26  Simon Budig  <simon@picman.org>

	* app/vectors/picmananchor.h: Intruduce casting macro PICMAN_ANCHOR.

	* app/tools/picmanvectortool.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanvectors-compat.c: Use it for code readibility.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.c: added picman_dockbook_help_func()
	which shows the help for the active page.

	(picman_dockbook_tab_button_press): grab the focus when a notebook
	tab is clicked. Still not perfect since GtkNotebook does it
	slightly different, but feels much better than before.

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/gui/info-window.c
	* app/widgets/picmanfontselection.c
	* app/widgets/picmanfontselection-dialog.c: replaced the last
	hardcoded html links by help IDs. Removed trailing whitespace.

2003-08-26  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: Minor code cleanup that
	automagically makes SHIFT while curve-dragging work...

2003-08-26  Michael Natterer  <mitch@picman.org>

	* app/gui/grid-dialog.c: use PICMAN_HELP_IMAGE_GRID.

	* app/gui/image-menu.c: fixed some help ID copy & paste bugs.

	* app/widgets/picmandockable.c: forgot to actually set the help ID
	with picman_help_set_help_data().

2003-08-26  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: Implemented direct moving of the
	curve. Whee!  :-)

	* app/tools/picmanvectortool.[ch]: Use it.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added enum PicmanContainerPolicy.

	* app/core/picmancontainer.[ch]: removed it here.  Added new virtual
	function PicmanContainer::clear() which removes all items. Cleanup.

	* app/core/picmanlist.c: implement PicmanContainer::clear(). Cleanup.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.[ch]
	* app/widgets/picmanmenufactory.[ch]: added a help_id to
	PicmanItemFactory.  It's basically the code I removed some days ago,
	but this time it's used as default help_id for the factory (e.g.
	if F1 is pressed over a separator), and not to construct html
	links.

	* app/widgets/picmanhelp-ids.h: added some missing help IDs.

	* app/gui/menus.c: register a help IDs with each item factory.

	* app/display/picmandisplayshell.c
	* app/gui/dialogs-menu.c: some more forgotten help IDs.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp-ids.h
	* app/widgets/picmanpaletteeditor.c
	* app/gui/palette-editor-menu.c: help IDs for the palette editor.

	* app/gui/toolbox-menu.c: forgot some dialog help IDs.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.[ch] (plug_ins_temp_proc_def_add): removed
	the "locale_domain" and "help_path" parameters since the function
	can figure them by itself.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install):
	changed accordingly.

	* app/plug-in/plug-in-proc.[ch] (plug_in_proc_def_get_help_id):
	new function which will soon be implemented correctly :-)

	* app/gui/file-open-menu.c (file_open_menu_setup)
	* app/gui/file-save-menu.c (file_save_menu_setup)
	* app/gui/plug-in-menus.c (plug_in_menus_create_entry): use it
	here instead of duplicating broken code.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_TEXT_EDITOR_DIALOG.

	* app/widgets/picmantexteditor.c: use it.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: added "gchar *help_id" member to
	the PicmanDockable struct and "const gchar *help_id" parameter to
	picman_dockable_new().

	* app/widgets/picmanhelp-ids.h: added help IDs for the tool list/grid
	and the palette editor.

	* app/widgets/picmandockbook.c
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs-menu.c: changed accordingly.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c: added "Select->To Path" menu entry, using
	the right stock_id and help_id.

	* plug-ins/sel2path/sel2path.c: don't install a menu_path.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/text/picmantext.[ch]: derive it from PicmanObject and added
	PicmanObject::get_memsize() implementation.

2003-08-25  Sven Neumann  <sven@picman.org>

	Fixed some issues with the PDB thumbnail functions spotted by
	Wolfgang Hofer and loosely based on patches he provided:
	
	* tools/pdbgen/pdb/fileops.pdb (file_load_thumbnail): keep a
	reference on the PicmanImagefile as long as we need the associated
	preview temp_buf. Call picman_imagefile_update() before requesting
	the preview.

	* app/pdb/fileops_cmds.c: regenerated.

	* app/base/temp-buf.c (temp_buf_new_check): use a checkerboard
	algorithm similar to the one the displayshell-render code uses.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.[ch]: changed PicmanObject::get_memsize() to
	return a second value named "gui_size", where the primary return
	value is the "constant" actual size (as long as no operation is
	performed on the object), and the second "gui_size" return value
	is the size of temporary stuff like preview caches or boundary
	segments (which may change asynchronously, even if the object is
	on the undo stack).

	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmanchannel.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandata.c
	* app/core/picmandatafactory.c
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage-undo.c
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/core/picmanlayer.c
	* app/core/picmanlist.c
	* app/core/picmanpalette.c
	* app/core/picmanparasitelist.c
	* app/core/picmanpattern.c
	* app/core/picmanundo.c
	* app/core/picmanundostack.c
	* app/core/picmanviewable.c
	* app/text/picmantextlayer.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors.c: changed get_memsize() implementations
	accordingly.

	* app/display/picmandisplayshell-title.c
	* app/gui/debug-commands.c
	* app/widgets/picmanpreview.c: changed callers accordingly.

	* app/core/picmanimage-undo-push.c: changed layer, channel, vectors
	and layer_mask undo steps to add/subtract the size of the
	resp. objects whenever they take/drop ownership of them. Ignore
	the objects' "gui_size" to get identical sizes on
	adding/subtracting. Fixes bug #120429.

2003-08-25  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: forgot this one.

2003-08-24  Seth Burgess <sjburges@picman.org>

	* plug-ins/rcm/rcm_callback.c: add in a call to 
	gdk_window_process_updates to keep the screen 
	updating properly.  Remove one redraw from 
	previous commit.

2003-08-24  Seth Burgess <sjburges@picman.org>

	* plug-ins/rcm/rcm_callback.c: do redraws instead
	of trying to erase.  Also redraw upon release. Mostly
	fixes bug #118177.

2003-08-24  Simon Budig  <simon@picman.org>

	* data/brushes/feltpen.gih
	* data/brushes/hsparks.gih: Marked as binary.

2003-08-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmannavigationview.c
	* app/gui/dialogs-menu.c
	* app/gui/documents-menu.c
	* app/gui/error-console-menu.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gradient-editor-menu.c
	* app/gui/image-menu.c
	* app/gui/select-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox-menu.c
	* app/gui/vectors-menu.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmaneditor.[ch]
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantemplateview.c
	* app/widgets/picmanundoeditor.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmanhelp-ids.h: added and updated more help IDs.

2003-08-24  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels): removed
	some debugging output that I accidentally committed a while ago.
	Fixes bug #120576 (slowness of smudge on alpha layers).

2003-08-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgetstypes.h: changed PicmanHelpFunc typedef:
	- renamed "const gchar *help_data" to "const gchar *help_id".
	- added "gpointer help_data".

	* libpicmanwidgets/picmanhelpui.[ch]: added "gpointer help_data" to
	picman_help_connect(). Removed all fiddling with html links and
	treat all help IDs as opaque identifiers.

	* app/core/picmantoolinfo.[ch]: changed "help_data" member to
	"help_id".

	* app/widgets/picmanitemfactory.[ch]: removed the "help_path"
	parameter from picman_item_factory_new() since we don't fiddle with
	html file paths any more. Simplifies menu item help a lot.
	Renamed "help_data" member of struct PicmanItemFactoryEntry to
	"help_id".

	* app/gui/plug-in-menus.c: changed accordingly. 3rd party
	plug-ins' menu item help IDs are now encoded as
	"help_path:help_id".

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c: when constructing the <Load> and
	<Save> menus, take the resp. procedures' locale_domain and
	help_path into account. Fixes translation of 3rd party menu items.
	Also do the right thing for load/save procs which are implemented
	as temporary procedures (they are impossible to implement
	currently but it's nice to do the right thing anyway...).

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_MAIN identifier.

	* libpicmanwidgets/picmandialog.[ch]
	* libpicmanwidgets/picmanwidgets.[ch]
	* libpicman/picmanui.c
	* app/display/picmandisplayshell.c
	* app/gui/gui.c
	* app/gui/about-dialog.c
	* app/gui/color-notebook.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-dialog-utils.[ch]
	* app/gui/gradients-commands.c
	* app/gui/help-commands.c
	* app/gui/image-menu.c
	* app/gui/menus.c
	* app/gui/preferences-dialog.c
	* app/gui/tips-dialog.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmanhelp.[ch]
	* app/widgets/picmanmenufactory.[ch]
	* app/widgets/picmantexteditor.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanviewabledialog.[ch]
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_main.c: changed accordingly. Removed
	trailing whitespace all over the place.

2003-08-22  Manish Singh  <yosh@picman.org>

	* configure.in: disallow libpicmanprint >= 4.3.0, addresses bug #120162.

	* configure.in: reverted previous change, until all po directories
	are filled for ms.po

2003-08-22  Hasbullah Bin Pit  <sebol@ikhlas.com>

	* configure.in(ALL_LINGUAS): Added "ms" (Malay).

2003-08-22  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c
	* app/vectors/picmanbezierstroke.c: OK, now valgrind is happy.

2003-08-22  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors-preview.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: Added missing checking for NULL
	return values. Hopefully this fixes the crashes others are
	observing.

2003-08-22  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: fixed crash when deleting
	the last segment of a closed curve.

2003-08-21  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-regression.[ch]: New function to
	initialise a PicmanCompositeContext

	* app/composite/Makefile.am: do not generate the test form of
	picman-composite-generic.c

	* app/composite/picman-composite-generic-test.c: unused, removed.

	* app/composite/make-installer.py app/composite/*-test.c: New
	tests were broken because the byte-for-byte checks checked the
	same buffer against itself.

2003-08-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c
	* app/gui/brush-select.c
	* app/gui/channels-menu.c
	* app/gui/convert-dialog.c
	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c
	* app/gui/font-select.c
	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/image-menu.c
	* app/gui/layers-menu.c
	* app/gui/menus.c
	* app/gui/palette-import-dialog.c
	* app/gui/palette-select.c
	* app/gui/palettes-commands.c
	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/qmask-menu.c
	* app/gui/templates-commands.c
	* app/gui/toolbox-menu.c
	* app/gui/vectors-menu.c
	* app/tools/[all tools].c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmanitemfactory.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanhelp-ids.h: added, fixed and updated lots of
	help IDs. Still unfinished.

2003-08-22  Sven Neumann  <sven@picman.org>

	* tools/picmanblendtool.c
	* tools/picmancroptool.c
	* tools/picmaneditselectiontool.c: use picman_tool_push_status_coords()
	for the initial status in order to reduce work for translators.

2003-08-22  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c: added
	picman_(bezier_)stroke_open that opens up a stroke (possibly
	returns a new one if it falls apart).

	* app/tools/picmanvectortool.[ch]: make it possible to break
	up a stroke by deleting (CTRL-Clicking in Insert/Delete mode)
	the curve between two anchors.

2003-08-21  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/selection.pdb (selection_load,combine): use
	picman_image_mask_select_channel() instead of
	picman_image_mask_load().  Removes the restriction that the channel
	to select has to have the same size as the image. Changed help
	texts accordingly.

	* app/pdb/selection_cmd.c
	* libpicman/picmanselection_pdb.c: regenerated.

2003-08-21  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]: added _is_empty () that checks
	if a stroke is empty.

	* app/vectors/picmanbezierstroke.c: Implemented _anchor_delete ()

	* app/vectors/picmanvectors.[ch]: added _stroke_remove ()

	* app/tools/picmanvectortool.[ch]: implemented the deletion of
	anchors. CTRL-Click on the anchor in Insert/Delete mode does
	the trick. Also did some renaming to the Vector tool
	(now Path tool) and set the Tooltip to something sane.

	Folks, I think the new path tool is no longer a regression
	against the 1.2 bezier select tool!

2003-08-21  Henrik Brix Andersen  <brix@picman.org>

	* app/tools/picmanmovetool.c (picman_move_tool_control): test
	picman_display_shell_get_show_guides() before drawing guide. Fixes
	guide artefact seen when disabling drawing of guides while a guide
	is selected by the move tool.

2003-08-21  Henrik Brix Andersen  <brix@picman.org>

	* app/widgets/picmantoolbox.c: #include "libpicmanbase/picmanbase.h"

2003-08-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanhelp-ids.h: new file defining the available help
	topics. Work in progress and totally unusable for matching to the
	help system. Stay tuned...

	* app/gui/about-dialog.c
	* app/gui/brushes-menu.c
	* app/gui/buffers-menu.c
	* app/gui/channels-commands.[ch]
	* app/gui/channels-menu.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradients-commands.c
	* app/gui/gradients-menu.c
	* app/gui/image-menu.c
	* app/gui/layers-commands.[ch]
	* app/gui/layers-menu.c
	* app/gui/module-browser.c
	* app/gui/offset-dialog.c
	* app/gui/palettes-menu.c
	* app/gui/patterns-menu.c
	* app/gui/resize-dialog.c
	* app/gui/select-commands.c
	* app/gui/templates-menu.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox-menu.c
	* app/gui/vectors-commands.[ch]
	* app/gui/vectors-menu.c: replaced literal HTML file paths by help
	IDs from picmanhelp-ids.h. Renamed some menu callbacks to be
	consistent with similar ones. This is just an intermediate commit
	and not finished.

	While browsing all the menus, I noticed that our "x to selection"
	functions are not consistent at all. They should all offer the
	REPLACE,ADD,SUBTRACT,INTERSECT options:

	* app/core/picmanchannel.[ch]: added new function
	picman_channel_new_from_alpha(). Removed picman_channel_layer_alpha()
	and picman_channel_layer_mask().

	* app/core/picmanimage-mask.[ch]: added
	picman_image_mask_select_alpha() and
	picman_image_mask_select_component() which offer the full set of
	operation, feather and feather_radius parameters as the other
	selection functions.

	* app/core/picmanimage-mask-select.[ch]: removed
	picman_image_mask_layer_alpha() and picman_image_mask_layer_mask().

	* app/gui/channels-commands.c (channels_channel_to_selection): use
	picman_image_mask_select_component() instead of implementing it
	here.

	* app/gui/image-menu.c
	* app/gui/layers-commands.[ch]: offer the full choice of
	REPLACE,ADD,SUBTRACT,INTERSECT with "Alpha to Selection" and "Mask
	to Selection".

	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/selection_cmds.c: regenerated.

2003-08-21  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-bezier-select-[16|22].png
	* themes/Default/images/tools/stock-tool-path-[16|22].png: renamed
	the tool-bezier-select icons to tool-path.

	* libpicmanwidgets/picmanstock.[ch]: dropped PICMAN_STOCK_TOOL_BEZIER_SELECT.

2003-08-21  Jay Cox  <jaycox@picman.org>

	* app/paint/picmanpaintcore.c: paint_core_interpolate now takes care
	of setting core->last_coords.  Don't reset core->distance in
	paint_core_start (fixes problem with shift-click brush strokes).
	Improved brush placement for stroked selections in
	paint_core_interpolate.
	* app/paint/picmanpaintcore-stroke.c: dont need to set
	core->last_coords anymore.
	* app/tools/picmanpainttool.c: dont need to set core->last_coords
	anymore.  Set core->distance in picman_paint_tool_button_press.

2003-08-21  Sven Neumann  <sven@picman.org>

	* m4macros/picman-2.0.m4: set the default minimum version to 1.3.18.

2003-08-21  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Don't allow to create a new stroke
	when in in Insert/Delete Mode.

2003-08-21  Simon Budig  <simon@picman.org>
	
	* app/tools/tools-enums.h: Added enum for vector tool operation
	mode
	
	* app/tools/tools-enums.c: regenerated

	* app/tools/picmanvectoroptions.[ch]: Use new enum.
	Add "Polygonal" Option

	* app/tools/picmanvectortool.c: New Option "Polygonal" that
	places all newly generated handles at the position of their
	anchor, effectively ensuring that only polygons can be created.
	
	Cleaned up the editing states. It is now possible to move anchors
	in the Insert/Delete mode. Cleaned up the associated cursors.

	Fixed warning when Shift+Ctrl-Clicking on an inactive Anchor.

2003-08-20  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]: Add hooks for insertion of points
	(and testing if insertion is possible)

	* app/vectors/picmanbezierstroke.c: Implement it for BezierStrokes

	* app/tools/picmanvectoroptions.c: Adjusted Options-GUI.
	
	* app/tools/picmanvectortool.[ch]: Detect if the pointer is over
	the curve. Make it possible to insert points in the curve.
	Select the "Insert/Delete Nodes" mode in the tool options and
	click on the curve.
	
2003-08-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.c
	(picman_image_mask_select_channel): fixed PICMAN_CHANNEL_OP_INTERSECT
	for channels which are smaller than the selection (create a temp
	channel like rect and ellipse select do). Also, don't modify the
	input channel when feathering.

2003-08-20  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c
	* app/text/picmantextlayer-transform.c
	* app/widgets/picmanitemfactory.c: some changes for legacy compilers
	based on a patch from Avi Bercovich (bug #120251).

2003-08-19  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c: Enabled erase mode for
	all pixel formats instead of just RGBA8.

	* app/composite/: Regenerated installers and testers.
	
	* app/composite/make-install.py: increased tests of pixels to
	1024*1024+1

	* app/composite/picman-composite-mmx.c
	(picman_composite_overlay_rgba8_rgba8_rgba_mmx): Backed out of the
	current build.  Although the unit tests all pass, the emperical
	evidence is that something is wrong with it.

	* Removed wayward printf() of a debugging message.

2003-08-19  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/app.pl: Default all strings to validate UTF-8, use
	no_validate to disable. Also added a null_ok parameter which does
	validate UTF-8, but allows NULL.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/parasite.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/unit.pdb: removed utf8, added no_validate and
	null_ok where appropriate.

	* app/pdb/brush_select_cmds.c
	* app/pdb/font_select_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2003-08-19  Sven Neumann  <sven@picman.org>

	* app/gui/toolbox-menu.c: use the new icons here as well.

2003-08-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c
	(picman_paint_tool_oper_update,cursor_update): always look for the
	active drawable, not for the active layer. Fixes line and brush
	preview drawing for channels.

2003-08-19  Michael Natterer  <mitch@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h: added "gboolean show_brush_outline".

	* app/gui/preferences-dialog.c (prefs_dialog_new): added it to the
	"Pointer Movement Feedback" frame.

	* app/tools/picmanpainttool.[ch]: connect to
	"notify::show-brush-outline" and toggle brush outline display
	accordingly. Fixes bug #120084.

2003-08-19  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-indexed-palette-[16|24].png
	* themes/Default/images/stock-undo-history-[16|24].png: added new
	icons drawn by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c: register and use them.

2003-08-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_reorder_item): when reordering the
	selected item, don't just scroll to its position but call
	picman_container_view_select_item(), so the views' state
	(e.g. raise/lower buttons) updates correctly. Fixes bug #120177.

2003-08-19  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.h
	* app/vectors/picmanstroke.[ch]: removed temp_anchor stuff. I don't
	think that this is needed. Added virtual function to determine the
	closest point on the curve to a given target point.

	* app/vectors/picmanbezierstroke.c: implemented
	picman_bezier_stroke_nearest_point_get () - up to now untested and
	unused.

2003-08-19  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpickbutton.c: fixed color picking from other
	screens.

2003-08-18  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c: updated for new gradient sample API,
	"reverse" is an optional parameter which defaults to FALSE.

2003-08-18  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs-menu.c: please the compiler.

2003-08-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/unit.pdb: UTF-8 validate all strings except
	filenames. Does not work yet for string params which may be NULL.
	They currently don't get checked because I still don't understand
	pdbgen enough :)

	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/channel_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/font_select_cmds.c
	* app/pdb/picmanrc_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/unit_cmds.c: regenerated.

2003-08-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c: cleaned up PicmanTool, PicmanDrawTool
	and vectors_tool->vectors state handling a lot. Still does weird
	things when switching between images and/or displays but it's
	better than before...

2003-08-18  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c
	* libpicmanbase/picmanenv.c: changed prefix of environment variables
	to PICMAN2 (bug #118553).

	* docs/picmanrc-1.3.5.in: regenerated.

2003-08-18  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite: Various beautifications, dead code removal.

2003-08-18  Michael Natterer  <mitch@picman.org>

	Finished the addition of "gboolean reverse" to the gradient API:

	* tools/pdbgen/pdb/gradients.pdb: added "reverse" params to
	picman_gradients_sample_uniform(), sample_custom() and
	get_gradient_data().

	* app/pdb/gradients_cmds.c
	* libpicman/picmangradients_pdb.[ch]: regenerated.

	* libpicman/picmangradientmenu.c: changed accordingly.

	Made everything compile with the new API:

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.[ch]: got lost in
	"reverse" adding, whitespace removal and general code cleanup.
	I better commit this now before continuing, even though "reverse"
	adding is not finished.

	* plug-ins/common/sample_colorize.c: removed own gradient
	reversing code, use "reverse" instead.

	* plug-ins/common/gradmap.c
	* plug-ins/flame/flame.c
	* plug-ins/gflare/gflare.c
	* plug-ins/pagecurl/pagecurl.c: simply pass reverse == FALSE and
	added #warnings that more work needs to be done. Some whitespace
	removal and minor cleanup.

2003-08-18  Sven Neumann  <sven@picman.org>

	* app/composite/Makefile.am: cleaned up whitespace.

2003-08-17  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2-test.c: added

	* app/composite/Makefile.am: Removed 'test' target

	* app/composite/picman-composite-dispatch.[ch]: retired and removed.

	* app/composite/Makefile.am: The 'test' target now builds and runs
	  all the tests in TESTS

	  Fixed typos of mismatched parenthesis in 'regenerate' target

	* app/composite/Makefile.am: TESTS now include ss2 and 3dnow
	  instruction sets.

	* app/composite/make-picman-composite-dispatch.py: retired and removed.

	* app/composite/picman-composite.c: call the installers of all the
	  various instruction sets supplied by x86 type processors.

	* app/base/base.c (base_init): Call picman_composite_init() *before*
	  paint_funcs_setup() (preparation for retiring
	  app/paint-funcs/paint-funcs.c)

	* app/composite/picman-composite-sse2.[ch]
	* app/composite/picman-composite-3dnow.[ch]
	* app/composite/picman-composite-sse2-installer.c
	* app/composite/picman-composite-3dnow-installer.c:
	  Added

	* app/composite/make-installer.py: generate regression test
	  programmes that take the command line arguments --iterations and
	  --n-pixels for the number of iterations of a set of tests, and the
	  number of pixels to use in each test, respectively.

	  Conditionally compile tests in order to build and run tests on
	  machines that can actually perform the tests.

	  Failing a regression test now causes remaining tests to be
	  skipped and a non-zero exit code by the programme.

2003-08-18  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Minor fix.

2003-08-17  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite.c (picman_composite_init): make
	picman-composite functions the default.

	* app/composite/make-installer.py: changed option --n_pixels
	to --n-pixels

2003-08-17  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/app.pl: reorg, fix reverse logic for parasite utf8
	checks.

2003-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c (iwarp_frame): this time fix bug #120083
	without breaking the fix for #119440.

2003-08-17  Michael Natterer  <mitch@picman.org>

	Fixed bug #79897 for all parasite procedures:

	* tools/pdbgen/app.pl: UTF-8 validate parasite->name.

	* tools/pdbgen/pdb/parasite.pdb: UTF-8 validate parasite names which
	are passed separately from the parasite struct.

	* app/pdb/parasite_cmds.c: regenerated.

2003-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c (iwarp_frame): fixed handling of
	drawables without alpha channel (bug #120083).

2003-08-17  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-{mmx,sse,altivec,vis}-installer.c
	* app/composite/picman-composite-{mmx,sse,altivec,vis}-test.c:
	regenerated.

	* app/composite/picman-composite-sse.c
	(picman_composite_overlay_rgba8_rgba8_rgba8_sse): fixed (rewrote).

	* app/composite/make-installer.py: command line option --iterations
	to set the number of iterations for a test. command line option
	--n_ixels to set the number of pixels for a test.
 
	* app/composite/picman-composite-mmx.c
	(picman_composite_grain_merge_rgba8_rgba8_rgba8_mmx): fixed (rewrote).
	(picman_composite_overlay_rgba8_rgba8_rgba8_mmx): fixed (rewrote).
	(picman_composite_value_rgba8_rgba8_rgba8_mmx): new testing shows it to
	be broken (temporarily removed from use).

2003-08-17  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_init): added some newlines.

	* data/patterns/brick.pat	
	* data/patterns/leopard.pat: replaced with retouched versions done
	by Guillermo S. Romero (bug #118796).

2003-08-17  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-layer-select.[ch]: made the layer
	cycling circular. Removed the static layer_select variable and
	allocate a new struct for each use. Made it use Ctrl+Tab for
	forward cycling and Ctrl+Shift+Tab for backward so it doesn't use
	Alt any more. Cleanup.

	* app/display/picmandisplayshell-callbacks.c: changed it from Alt to
	Ctrl here, too.

	Fixes all the stuff mentioned in bug #119236. 

2003-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c: applied a patch from S. Mukund that fixes
	handling of transparent background (bug #117148).

2003-08-17  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.[ch]: Virtualized
	picman_bezier_stroke_extend, added picman_stroke_is_extendable.

	* app/text/picmantext-vectors.c: changed accordingly.

	* app/vectors/picmanvectors.[ch]: added picman_vectors_anchor_select.

	* app/tools/picmanvectoroptions.[ch]: dummy switch for future
	extensions
	
	* app/tools/picmanvectortool.[ch]: Major overhaul. Made use of
	picman_vector_tool_oper_update, cleaned up
	picman_vector_tool_button_press a lot and finally have a
	working cursor_update. Still buggy, but I wanted to have it
	in CVS.
	
2003-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c: warn the user if loading or saving
	fails (bug #119940).

2003-08-17  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh (AUTOCONF_REQUIRED_VERSION): check for version 2.54.

2003-08-17  Manish Singh  <yosh@picman.org>

	* configure.in: bump up minimum autoconf requirement to 2.54 for
	new features

2003-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c (read_16bit): fixed bug that was
	introduced during code cleanup (spotted by yourst, bug #120038).

2003-08-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c: added PicmanTool::oper_update()
	implementation and moved stuff from button_press() and
	cursor_update() there. Fixed the state of the tool to be only
	ACTIVE while button1 is pressed. Cleanup.

2003-08-16  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): if the canvas has no
	focus on button_press, set it explicitly instead of asuming that
	focus_in will follow anyway. Should once more fix bug #85202.

	Grab the keyboard while button1 is down so the focus can't go away
	while the tool can't receive modifier events. Should fix more
	#85202-alike bugs.

2003-08-16  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_coordinates_callback): moved
	the g_signal_stop_emission_by_name() right before the calls to
	picman_size_entry_set_refval() so we only block the duplicate
	"value_changed" signal, not all of them. Fixes bug #107633.

2003-08-16  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/blur.c
	* plug-ins/common/sharpen.c: replaced const strings (with version
	number) for window title with translatable strings.

	* plug-ins/common/spheredesigner.c: fix for #119936

2003-08-15  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am
	* app/text/picmantextlayer-transform.[ch]: new files that hold yet
	unused PicmanItem transform methods.

	* app/text/picmantextlayer.[ch]: export picman_text_layer_render().

	* app/text/picmantext-bitmap.[ch]
	* app/text/picmantext-private.h
	* app/text/picmantext-vectors.c
	* app/text/picmantextlayout-render.c: use the transformation matrix.
	This doesn't change anything since it's still always the identity
	matrix.

2003-08-15  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-vis.c
	* app/composite/Makefile.am: Use ARCH_SPARC and USE_VIS to
	conditionally compile VIS optimisations.

	* app/composite/picman-composite-vis.c: named picman_composite_vis_init()

2003-08-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-enums.[ch]: extended PicmanTabStyle enum so we
	are able to distinguish icon and preview tabs.

	* app/widgets/picmandockable.[ch]: renamed PicmanDockableGetIconFunc
	to PicmanDockableGetPreviewFunc. Always create stock icons for
	"icon" tab styles and use the get_preview_func only for "preview"
	tab styles.

	* app/gui/dialogs-constructors.c: changed accordingly.

	* app/gui/dialogs-menu.c: Added "Current Status" options to the
	"Tab Style" menu and grey them out if the dockable has no
	get_preview_func.

2003-08-15  Sven Neumann  <sven@picman.org>

	* LICENSE: cosmetics.
	
	* Makefile.am (EXTRA_DIST): include LICENSE.

	* libpicman/Makefile.am (EXTRA_DIST): include COPYING.

2003-08-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/make-installer.py: generate smaller tables and
	less code.  Now takes real command line options:
	options:
	  --version                        show program's version number
	  -h, --help                       show this help message and exit
	  -f FILE, --file=FILE             the input object file
	  -t, --test                       generate regression testing code
	  -r REQUIRES, --requires=REQUIRES cpp #if conditionals

	See Makefile.am for how I use these options to generate the code.

	* app/composite/picman-composite-altivec-{installer,test}.c:
	* app/composite/picman-composite-generic-{installer,test}.c:
	* app/composite/picman-composite-mmx-{installer,test}.c
	* app/composite/picman-composite-sse-{installer,test}.c:
	* app/composite/picman-composite-vis-{installer,test}.c: regenerated
	with smaller tables and less ode.
	

2003-08-14  Tor Lillqvist  <tml@iki.fi>

	* app/base/base.c (base_init): If a development version (odd
	PICMAN_MINOR_VERSION), print a warning that debug messages may
	appear. Only print the CPU acceleration messages on development
	versions. On Win32, tell people not to close the console
	window. (#119786)

2003-08-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-mmx-installer.c
	* app/composite/picman-composite-sse-installer.c:
	* app/composite/picman-composite-sse.c:
	Conditional compilation matching the conditional compilation in
	picman-composite-{mmx,sse}.c

2003-08-14  Michael Natterer  <mitch@picman.org>

	* app/text/picmantextlayer.c: removed trailing whitespace.
	(picman_text_layer_render): fixed warning by adding a cast.

2003-08-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_button_press): call
	picman_image_update() after calling picman_image_add_vectors() so the
	menus get updated correctly. Fixes bug #119412.

2003-08-14  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c (image_menu_entries): applied a patch from
	Alan Horkan <horkana@tcd.ie> which adds an "Undo History..." menu
	entry below the "Undo" and "Redo" ones. Fixes bug #119662.

2003-08-14  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_subsample_mask): use
	g_new0() instead of g_malloc() followed by memset(). Some coding
	style cleanups.

2003-08-14  Sven Neumann  <sven@picman.org>

	* configure.in: bumped the version number to 1.3.19.

2003-08-14  Jay Cox  <jaycox@picman.org>

	* app/paint/picmanpaintcore.c: Eliminate the rounding errors that
	were in picman_paint_core_subsample_mask.  Fixes bug #118741

2003-08-14  Helvetix Victorinox  <helvetix@picman.org>

	* composite/ modularisation of the automatic compositing function
	"wiring" to construct the table of compositing functions at
	run-time instead of compile time.

	The environment variable PICMAN_COMPOSITE is a hexadecimal number
	representing a bit-field used to set/reset options in the
	picman-composite code.
 
	* picman-composite-altivec.[ch]: added
	* picman-composite-altivec-installer.[ch]: added
	* picman-composite-vis.[ch]: added
	* picman-composite-vis-installer.[ch]: added
	* picman-composite-mmx-installer.[ch]: added
	* picman-composite-sse-installer.[ch]: added
	* picman-composite-altivec-test.[ch]: added
	* picman-composite-vis-test.[ch]: added
	* picman-composite-mmx-test.[ch]: added
	* picman-composite-sse-test.[ch]: added
	* make-installer.py: Added meta programme for generating code to
	  1) construct a table of compositing functions indexed by
	  operation, and the pixel formats of the sources and destination,
	  and 2) generating code for regression testing of these compositing
	  functions against the same functions in picman-composite-generic.c
 
	* picman-composite-mmx.c (xxxpicman_composite_overlay_rgba8_rgba8_rgba8_mmx):
	  removing from the current set of optimisations because it appears
	  to be broken.
 
	* Makefile.am: modified regression testing targets to now build
	  picman-composite-*-test where * is any of generic, mmx, sse,
	  altivec, and vis.
 
	* picman-composite.c: moved in initialisation code
	  picman_composite_init() from picman-composite-dispatch.c
 
	* picman-composite.c: removed picman_composite_unsupported().
 
	* picman-composite.c: use cpu_accel() to determine at run-time which
	  set of optimisations are to be used.
 
	* picman-composite.c: conditionally compile code for ARCH_X86.

	* make-picman-composite-dispatch.c: retired.  See make-installer.py
 
	* picman-composite-mmx.c (op_overlay): namespace cleanup, op_overlay()
	  and all of the constant values are now static

	* picman-composite-mmx.c, picman-composite-sse.c: fixed bug with the
	  alpha mask being the address of the alpha mask, not the mask
	  itself.

	* app/paint-funcs/paint-funcs.c: Check picman_composite_options.use
	to see if we should use the new code or the old code.

2003-08-14  Manish Singh  <yosh@picman.org>

	* configure.in: libpicmanbase/picmanversion.h is now only updated if
	its contents actually change. This should prevent rebuilding
	everything if only configure is run.

	* libpicmanbase/picmanversion.h.in: no longer needed

2003-08-13  Jay Cox  <jaycox@picman.org>

	* app/widgets/picmanbrushfactoryview.c: Reduced the range of the
	spacing scale widget for convenience.  Extreme values may still be
	entered in the spin box.

2003-08-14  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picman.def: Add picman_image_is_dirty.

2003-08-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/plugindetails.c (get_plugin_info): convert the
	stuff returned by strftime() to UTF-8 before displaying it. Fixes
	bug #119316.

2003-08-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreview.c (picman_preview_button_press_event): 
	return early if the widget is not realized to enable destroying
	the widget from an external "button_press_event" handler which
	returns FALSE (as done in PicmanContainerGridView).
	Fixes bug #119413.

	Some paranoia fixes for similar (although unseen) problems:

	* app/widgets/picmanpreview.[ch]: remember if we own a grab and
	remove it in GtkWidget::unmap().

	* app/widgets/picmanpreview-popup.c: destroy the popup when the
	parent widget gets unmapped.

2003-08-14  Danilo Å egan  <dsegan@gmx.net>

	* ChangeLog, po/ChangeLog, po-libpicman/ChangeLog: Fixed UTF-8
	encoding which was broken by dolfin's commit.

2003-08-13  Manish Singh  <yosh@picman.org>

	* pypicman/Makefile.am: slight include file ordering tweak

	* plug-ins/pypicman/plug-ins/colorhtml.py: add a sanity check

	* plug-ins/pypicman/plug-ins/sphere.py
	* plug-ins/pypicman/plug-ins/whirlpinch.py: minor cleanups for
	Python 2.3

	* plug-ins/webbrowser/web-browser.scm: change script to reflect
	new pdb name of the web-browser.

2003-08-13  Gil "Dolfin" Osher  <dolfin@rpg.org.il>

	* configure.in: Added "he" (Hebrew) to ALL_LINGUAS.

2003-08-13  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_restore): pop up a warning dialog if the
	GTK+ version is < 2.2.2. Forgot to commit this at PicmanCon...

2003-08-13  Jakub Steiner <jimmac@ximian.com>

	* ./data/images/picman_splash.png: new post-cccamp splash

2003-08-13  Tor Lillqvist  <tml@iki.fi>

	* libpicmanbase/picmanbase.def: Add picman_strip_uline.

2003-08-12  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/image-menu.c (image_menu_update): have the grid/guide
	menu entries reflect the presence of grid/guides in the image (as
	suggested by jimmac)

	* app/display/picmandisplayshell.c (picman_display_shell_snap_coords):
	snap to grid/guides even if the grid/guides are hidden (as
	suggested by jimmac)

2003-08-12  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/gifload.c: revert one of Sven's -pedantic
	changes from July which caused GIF-loading bogosity.

2003-08-12  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Disable separate debug packages

2003-08-12  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/grid-dialog.c (grid_dialog_new): made changes to the
	grid apply instantly

2003-08-11  Henrik Brix Andersen  <brix@picman.org>

	* picman/app/widgets/picmanwidgets-utils.[ch]: removed function
	picman_menu_path_strip_uline() ...

	* picman/libpicmanbase/picmanutils.[ch]: ... and added it here under the
	name picman_strip_uline()

	* picman/devel-docs/libpicmanbase/libpicmanbase-sections.txt: added
	picman_strip_uline to picmanutils section

	* picman/app/plug-in/plug-in.c
	* picman/app/widgets/picmanitemfactory.c
	* picman/app/widgets/picmantoolbox.c
	* picman/app/gui/plug-in-menus.c: changed accordingly

	* picman/plug-ins/script-fu/script-fu-scripts.c
	(script_fu_interface): use picman_strip_uline() to strip mnemonics
	from script-fu menu paths

	* picman/app/gui/vectors-menu.c
	* picman/app/gui/templates-menu.c
	* picman/app/gui/qmask-menu.c
	* picman/app/gui/palettes-menu.c
	* picman/app/gui/palette-editor-menu.c
	* picman/app/gui/images-menu.c
	* picman/app/gui/gradients-menu.c
	* picman/app/gui/gradient-editor-menu.c
	* picman/app/gui/documents-menu.c
	* picman/app/gui/dialogs-menu.c
	* picman/app/gui/colormap-editor-menu.c
	* picman/app/gui/channels-menu.c
	* picman/app/gui/buffers-menu.c
	* picman/app/gui/brushes-menu.c
	* picman/app/gui/layers-menu.c
	* picman/plug-ins/pypicman/plug-ins/clothify.py
	* picman/plug-ins/pypicman/plug-ins/shadow_bevel.py
	* picman/plug-ins/pypicman/plug-ins/whirlpinch.py
	* picman/plug-ins/pypicman/plug-ins/foggify.py
	* picman/plug-ins/script-fu/scripts/*.scm
	* picman/plug-ins/script-fu/script-fu.c: added mnemonics fixing more
	of bug #106991

	* picman/app/gui/error-console-menu.c (error_console_menu_update):
	updated menu item names, added mnemonics

	* picman/plug-ins/common/animoptimize.c *
	picman/plug-ins/common/animationplay.c: don't prepend every menu
	entry with "Animation"

2003-08-10  Dave Neary  <bolsh@picman.org>

	* Made 1.3.18 release.

2003-08-10  Dave Neary  <bolsh@picman.org>

	* NEWS: Updated NEWS file for 1.3.18.

2003-08-10  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Revert package name change. Causes too much trouble.

2003-08-10  Ville PÃ¤tsi  <drc@picman.org>

	* picman.spec.in: Changed package name from picman to picman1.3, to 
	  keep combatibility with PICMAN 1.2 packages.

2003-08-10  Ville PÃ¤tsi  <drc@picman.org>

	* configure.in: Added picman.spec.
	* picman.spec.in: Brought up to date.

2003-08-09  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/iwarp.c (iwarp): added undo group to fix #119438.

2003-08-09  Raphael Quinet  <quinet@gamers.org>

	* configure.in: Print a warning if the version of GTK+ is lower
	than 2.2.2.  The next stable release will probably require 2.2.2
	or later but for the moment we only issue a warning.

2003-08-09  Sven Neumann  <sven@picman.org>

	* configure.in: added devel-docs/app.

	* app/core/picmanitem.c
	* app/widgets/picmandialogfactory.c: more documentation fixes.

2003-08-09  Sven Neumann  <sven@picman.org>

	* app/app_procs.c
	* app/batch.c
	* app/main.c: moved global variables out of main.c.

2003-08-09  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/iwarp.c: Fixed bug #119440 with Raphael Quinet. 
	The bug was caused by missing a channel in the dest drawable when 
	the original drawable didn't have an alpha channel.

2003-08-08  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/blinds.c: fix for #83970 (blinds filter: strange 
	behaviour after changing selection)

2003-08-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig.c
	* app/config/picmanrc.c
	* app/core/picmanitem.[ch]
	* app/display/picmanprogress.[ch]
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmanenummenu.c
	* app/widgets/picmanfontselection.c
	* app/widgets/picmanwidgets-utils.c: documentation fixes.

2003-08-08  Simon Budig  <simon@picman.org>

	* app/tools/picmanpainttool.c: Added changing the opacity via
	cursor keys. Left/Right: +- 1%, UpDown: +- 10%.

	I am just committing this, because jimmac will kill me if I dont...

2003-08-07  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.c: Moved transformations code to
	picmanstroke, so that the picmanvector no longer fiddles in
	the stroke internals.

2003-08-07  Raphael Quinet  <quinet@gamers.org>

	* app/composite/Makefile.am (test_composite_SOURCES): added
	missing header file, should fix bug #119204.

2003-08-06  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preview.c (render_indexed_image): fixes
	#119192 (undefined behavior in imap_preview.c)

	* plug-ins/common/AlienMap.c: 
	* plug-ins/fp/fp_gtk.c
	* plug-ins/fp/fp.h
	* plug-ins/common/exchange.c: added mnemonics + minor code clean-up

2003-08-05  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/common/jpeg.c (DEFAULT_QUALITY): increase the default
	quality setting from 0.75 to 0.85, as requested in bug #61088 and
	in bug #63610.  This seems to be a more reasonable default for
	most users.  The correct way to solve this problem would be to
	implement the persistent preferences as described in bug #63610,
	but this quick fix should take care of the most annoying problem.

2003-08-05  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/common/align_layers.c
	* app/gui/image-menu.c
	* plug-ins/fp/fp.c
	* plug-ins/common/compose.c
	* plug-ins/common/ccanalyze.c: added even more mnemonics to fix more of
	#106991. Many more to follow...

2003-08-04  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/image-menu.c (image_menu_entries): reverted change to
	web-separator which accidentially slipped in with last commit

	* app/gui/plug-in-menus.c (plug_in_menus_update)
	* app/plug-in/plug-in.c (plug_in_get_undo_desc): use
	picman_menu_path_strip_uline() to strip plug-in mnemonics from
	undo/redo, repeat and re-show menu entries

2003-08-04  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/pypicman/plug-ins/sphere.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py
	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/maze/maze.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/gfig/gfig.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/flame/flame.c
	* plug-ins/dbbrowser/dbbrowser.c
	* plug-ins/common/CML_explorer.c
	* app/gui/image-menu.c: added even more mnemonics to fix more of
	#106991. Still more to follow...

2003-08-02  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]: implemented picman_stroke_close.

	* app/vectors/picmanbezierstroke.c: only extend a stroke if
	it is not closed.

	* app/tools/picmanvectortool.c: ALT-Click on an anchor now
	closes the stroke. Will evolve to the ability to connect
	two strokes.

2003-08-01  Henrik Brix Andersen  <brix@picman.org>

	* plug-ins/rcm/rcm.c
	* plug-ins/print/print.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/gflare/gflare.c
	* plug-ins/common/mapcolor.c
	* app/gui/toolbox-menu.c: added more mnemonics to fix bug
	#106991. More will follow soon...

2003-07-31  Manish Singh  <yosh@picman.org>

	* libpicman/picmancompat.h: removed references to PICMAN_ADD_INVERSE_*

2003-07-31  Henrik Brix Andersen  <brix@picman.org>

	* app/core/core-enums.h (PicmanGridType): added more intuitive
	decribtions

	* app/core/core-enums.c: regenerated

	* app/display/picmandisplayshell.c (picman_display_shell_draw_grid):
	use gdk_draw_point() instead of gdk_draw_line() for dots-only mode

	* .cvsignore: added picmantool-win32.c

2003-07-30  Manish Singh  <yosh@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/ccanalyze.c: new plug-in, Colorcube Analysis
	(counts colors in an image, an often requested feature)

2003-07-30  Tor Lillqvist  <tml@iki.fi>

	* app/plug-in/plug-in.c (plug_in_close): [Win32] Plug handle leak,
	call CloseHandle().

2003-07-30  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/app.pl: fixed UTF-8 reversed check.

	* libpicman/picmantexttool_pdb.c: regenerated (doc string changes, forgot
	to commit from previous change)

2003-07-30  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: tweaked some blurbs.

2003-07-30  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: fixed UTF-8 check.

	* app/pdb/text_tool_cmds.c: regenerated.

2003-07-30  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/edge.c: Trivial clean-up.

2003-07-29  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/app.pl: added a utf8 option for string input
	parameters, and validate them.

	* tools/pdbgen/pdb/text_tool.pdb: make the text parameter use it.
	Partially addresses #79897. Also remove references to XLFD in the
	doc text.

	* app/pdb/text_tool_cmds.c: regenerated

	* configure.in: Really bump the version number

2003-07-29  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/edge.c: Added several new edge detection 
	algorithms. There are more complicated ways these could be 
	done (using the rotations of the kernels in the plug-in) but 
	this is a nice mix between speed and complexity. The 
	algorithms, heavily modified, come from iccii's thin_line 
	plug-in.

2003-07-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_set_active_layer): moved the
	code which manipulates gimage->layer_stack and the call to
	picman_layer_invalidate_boundary() inside the if(layer != active_layer)
	branch so it is called less often. Fixes the slowness of bug #104440
	for most cases since we don't need to recalculate the selection
	boundary in the next step.

	(picman_image_set_active_channel): call
	picman_layer_invalidate_boundary() before setting the active_layer
	to NULL. Fixes stale layer boundary when switching to a channel.

	* app/display/picmandisplay.c (picman_display_flush_whenever): when
	there are no updates, we still need to restart the selection.
	Fixes missing layer boundary when switching from a channel to
	a layer.

2003-07-29  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_ants_speed_notify_handler): use the
	picman_display_shell_selection_control() wrapper instead of
	calling picman_display_shell_selection_*() functions directly.
	Don't #include "picmandisplayshell-selection.h".

2003-07-29  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_[hv]ruler_button_press): skip double clicks by
	checking event->type == GDK_BUTTON_PRESS. Brings press and release
	events sent to the move tool back in sync and fixes bug #75351.

2003-07-29  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.18.

	* INSTALL: documented new option --with-gif-compression.

2003-07-29  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/gif.c: Trivial -- tabs-to-spaces.

2003-07-29  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/gif.c: Include a patch by Cameron Gergory 
	<cameron@bloke.com> which allows a compile-time choice of the 
	comression algorithm to be used in the gif plug-in.

	* configure.in: Added --with-gif-compression option to allow 
	specification of compression algorithm via configure.

2003-07-28  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/Makefile.am:
	Made the explicit target "regenerate" to regenerate the source
	files using the Python meta-generator.
	
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-mmx.h
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse.h:
	Now bounded by the conditional "#if __GNUC__ >= 3".  This is a
	coarse fix to enable app/composite to build on a wider variety of
	platforms.  Ideally, this will be refined to encompass different
	versions of the compiler(s) supporting inline assembly code.

2003-07-28  Henrik Brix Andersen  <brix@picman.org>

	* app/core/core-enums.h (PicmanGridType): renamed
	PICMAN_GRID_TYPE_INTERSECTION to PICMAN_GRID_TYPE_INTERSECTIONS, added
	PICMAN_GRID_TYPE_DOTS

	* app/core/core-enums.c: regenerated

	* app/gui/grid-dialog.c
	* app/core/picmangrid.c: changed accordingly

	* app/display/picmandisplayshell.c (picman_display_shell_draw_grid):
	added code to draw the dots-only grid

2003-07-28  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (initial_sub_region)
	(combine_sub_region): use g_alloca() instead of alloca().

2003-07-28  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am (EXTRA_HEADERS): added picmanwin32-io.h.

	* libpicmanbase/picmandatafiles.c: properly include the new header.

2003-07-28  Manish Singh  <yosh@picman.org>

	* libpicman/Makefile.am: add libpicmancolor to libpicmanui's LIBADD,
	should fix bug #118475.

2003-07-28  Michael Natterer  <mitch@picman.org>

	* app/text/picmantext-vectors.c: define FT_GLYPH_FORMAT_OUTLINE as
	ft_glyph_format_outline if it doesn't exist so it compiles with
	older freetype versions.

2003-07-28  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c (image_menu_entries): add the
	PICMAN_STOCK_GRID icon to the "Configure Grid..." menu item and set
	it insensitive if there is no image.

2003-07-28  Michael Natterer  <mitch@picman.org>

	* libpicman/picmancompat.h: removed the name from the
	PicmanOrientationType[Compat] enum. The enums in this header are
	just anonymous mappings and not types by themselves.

2003-07-27  Tor Lillqvist  <tml@iki.fi>

	* picmantool-win32.c.in (get_prefix): Use g_find_program_in_path().

	* configure.in: Expand picmantool-win32.c.

	* Makefile.am: Distribute picmantool-win32.c.in.

	* plug-ins/*/Makefile.am: Use -mwindows on Win32.

2003-07-27  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/image-menu.c (image_menu_entries): moved Configure Grid
	entry to the <Image>/Image branch

	* app/gui/view-commands.[ch] (view_configure_grid_cmd_callback):
	removed function

	* app/gui/image-commands.[ch] (image_configure_grid_cmd_callback):
	added function here

	* app/gui/grid-dialog.c: removed snap and show options from the
	dialog

2003-07-27  Henrik Brix Andersen  <brix@picman.org>

	* app/base/tile-swap.c: re-added fallback definitions for
	_O_BINARY and _O_TEMPORARY

2003-07-27  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picman.def
	* libpicman/picmanui.def: Move picman_{brush,font,gradient,pattern}_
	select_{destroy,new} back to picman.def (and actually add some of
	the _destroy entries). The files where these are defined go in
	libpicman, not libpicmanui (see Makefile.am). Sort the .def files.

	* plug-ins/common/xpm.c: Merge from stable: On Win32 (with no
	X11), don't include <X11/Xlib.h>. (Do include <X11/xpm.h>, though,
	as such a file is provided by the libXpm-noX package.)
	(parse_colors): If XPM_NO_X (Win32), use GDK to parse color names.
	
2003-07-26  Tor Lillqvist  <tml@iki.fi>

	* plug-ins/libgck/gck/Makefile.am: Use -no-undefined on Windows.

2003-07-26  Hans Breuer  <hans@breuer.org>

	* libpicman/picmancompat.h : renamed PicmanOrientationType
	with Compat postfix to avoid name clashing when using
	this header together with libpicman/picmanenums.h

	* app/composite/makefile.msc : (new file)
	  **/makefile.msc : updated

	* libpicman/picman.c : use static defined _tile<widht|height>
	in this file instead of function call

	* libpicman/picman.def libpicman/libpicmanui.def : moved from former
	to latter : picman_<brush|font|gradient|pattern>_select_<new|destroy>
	added to former picman_<brushes|gradients|patterns>_popup

	* app/paint/picmanpaintcore.h : removed double semicolon
	which gave msvc error C2059: syntax error : ';'

	* libpicmanbase/picmanwin32-io.h : (new file) compatibilty defines 
	which were spread over multiple files to make up mostly for 
	missing unistd.h

	* app/base/tile-swap.c app/core/picmanimagefile.c 
	  libpicmanbase/picmandatafiles.c
	  plug-ins/FractalExplorer/FractalExplorer.c : use new header

	* plug-ins/gflare/gflare.c 
	  plug-ins/flame/flame.c 
	  plug-ins/FractalExplorer/Dialogs.c :
	removed #ifdef G_OS_WIN32 special casing, not needed anymore
	due to g_file_test() usage

	* app/text/*.* : changes required for build with PangoWin32, 
	but not commited ...

2003-07-26  Adam D. Moss  <adam@picman.org>

	* LICENSE: (new file) Explain the mix of licenses within
	the PICMAN distribution, and make an explicit statement clarifying
	our position on invoking methods in GPL-implemented code from
	non-GPL plugins/extentions via libpicman and/or the pdb (ie. that
	this does not automatically GPL-infect the program doing the
	invoking, which is otherwise an ambiguity in the GPL).

2003-07-25  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: slight fix for arg handling, shouldn't
	have any functional difference. This code should be redone at some
	point.

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman.h
	* plug-ins/pypicman/pypicman-pdb.c: constify

	* plug-ins/pypicman/plug-ins/sphere.py: use new blend pdb interface

2003-07-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c (picman_image_remove_layer)
	* app/core/picmanimage.c (undo_pop_layer)
	* app/text/picmantextlayer.c (picman_text_layer_render):
	picman_layer_invalidate_boundary() must be called whenever a layer
	gets translated, resized or removed. Fixes stale layer outlines in
	the canvas padding area.

2003-07-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolornotebook.c (picman_color_notebook_class_init):
	added blurbs for the style properties. These show up as descriptions
	in the generated documentation.

2003-07-25  Sven Neumann  <sven@picman.org>

	* Made 1.3.17 release.

2003-07-25  Sven Neumann  <sven@picman.org>

	* configure.in: fixed the --without-aa option I added lately.

2003-07-24  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmiscui.c (picman_fixme_preview_do_row): minor optimisations

	* plug-ins/common/polar.c: undeprecated gtk stuff + minor clean-up

	* plug-ins/imagemap/imap_menu.c (make_help_menu): no more right
	alignment for Help menu (fixes #118081).
	
2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp.c (picman_help_internal): added a static
	boolean "busy" variable to make sure we handle only one help
	request at a time. Together with the now synchronous
	PICMAN_EXTENSION starting this keeps us from showing multiple help
	browsers.

	Pass the help_locale around instead of hardcoding it to "C" at the
	bottom (now it's hardcoded a few functions above ;)

2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c: removed some old #if 0'ed
	code.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c: renamed "Edit/Stroke" to "Edit/Stroke
	Selection" and added "Edit/Stroke Active Path". Added some missing
	mnemonics to the "Edit" menu.

2003-07-24  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_create_vectors): set
	the vectors offset from the text layer's offset.

	* app/text/picmantext-vectors.c: removed debugging output.
	
2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.[ch]: removed the brush outline members
	since we have no chance to really cache them without duplicating
	PicmanPaintCore's brush change notification code.

	* app/paint/picmanpaintcore.[ch]: added the outline here and really
	cache it this time. The paint_core doesn't create or use the
	outline but frees and NULLifies it whenever the brush changes.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-stroke.c
	(picman_paint_core_stroke_vectors): honor the destination drawable's
	offsets and stroke multi-stroke vectors correctly.

2003-07-24  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-error.[ch]: moved code from picmanconfig.[ch]
	to these new files.

	* app/config/picmanconfig-utils.[ch]: moved picman_config_string_indent()
	here from picmanconfig.[ch].

	* app/config/picmanconfig.[ch]
	* app/config/picmanconfigwriter.c
	* app/config/picmanrc.c
	* app/config/picmanscanner.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/widgets/picmandevices.c: changed accordingly.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/text/picmantext-vectors.c: added control points.
	Looks correct now.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/test-sphere.scm: added image, layer,
	channel and drawable menus for testing.

2003-07-24  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-vectors.c: more work on glyph decomposition.

	* app/tools/picmantextoptions.c
	* app/tools/picmantexttool.c: added button to create a path from text.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanmenu.c: removed the GWeakNotify stuff again and free
	the ID arrays after creating the menu. Pass the ID as user_data to
	the "activate" callback using GINT_TO_POINTER().  Added previews
	to picman_image_menu_new(). More cleanup.

2003-07-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmantooloptions.c (picman_tool_options_serialize): 
	add the name of the tool to the header and footer strings.

2003-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_selection.c (selection_update): moved
	variable declarations inside the #ifdef branch where they are used.

	* plug-ins/picmanressionist/sizemap.c: commented out unused function
	update_sizemap_dialog().

2003-07-24  Sven Neumann  <sven@picman.org>

	* app/composite/Makefile.am: fixed build rules. There must not be
	a dependency that causes picman-composite-dispatch.[ch] to be
	regenerated since we don't want to depend on Python for our build.

	* app/core/picmandrawable-blend.c (gradient_fill_region)
	(gradient_put_pixel): fixed a problem with the new gradient
	dithering on grayscale drawables (bug #118141).

2003-07-24  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-dispatch.[ch]: regenerated new code
	taking advantage of simplified function prototypes.

	* app/composite/picman-composite-test.c: New regression testing
	driver.  This file is automatically generated, but it's included
	in the cvs tree for expediency.

	* app/composite/ns.py: hopeful checks for which OS is currently
	running as a hint to what nm(1) is available.

	* app/composite/picman-composite-mmx.[ch]
	* app/composite/picman-composite-sse.[ch]
	* app/composite/picman-composite-generic.[ch]: function prototype
	cleanup.

2003-07-23  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/make-picman-composite-dispatch.py: generates code to
	test compositing functions.

	* app/composite/picman-composite-regression.[ch]: support for
	automatically testing compositing functions.

2003-07-23  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanmenu.h: changed the return value of
	PicmanConstraintFunc from gint to gboolean.

	* libpicman/picmanmenu.c: fixed bug introduced by my latest cleanup:
	Don't free the drawable arrays after creating the menus since they
	are used in the callbacks. Instead, free them using a GWeakNotify
	on the menu. Factored menu and item creation out to utility
	functions to reduce code duplication. Cleanup.

2003-07-22  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-bitmap.c
	* app/text/picmantextlayout-render.c: define FT_LOAD_TARGET_MONO to
	FT_LOAD_MONOCHROME if it is undefined. This avoids a dependency on
	recent versions of Freetype (bug #118066).

2003-07-22  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient.[ch]: added "gboolean reverse" to
	picman_gradient_get_color_at() so all gradients can be used
	reversed.

	* app/core/picmandrawable-blend.[ch] (picman_drawable_blend)
	* app/core/picmanpalette-import.[ch] (picman_palette_import_from_gradient):
	added "gboolean reverse".

	* app/paint/paint-enums.[ch]: removed enum PicmanGradientPaintMode
	since it is identical to PicmanRepeatMode, except for the now
	obsolete ONCE_BACKWARD value.

	* app/paint/picmanpaintcore.[ch]: removed
	picman_paint_core_get_color_from_gradient()...

	* app/paint/picmanpaintoptions.[ch]: ...and added
	picman_paint_options_get_gradient_color(), which is much more
	general. Added a "reverse" property to PicmanGradientOptions and
	changed the type of the "repeat" property to PicmanRepeatMode.

	* app/paint/picmanpaintbrush.c: use
	picman_paint_options_get_gradient_color().

	* app/tools/picmanblendoptions.[ch]: removed the "repeat" property
	since it is in the parent class now.

	* app/gui/gradient-select.c
	* app/gui/palette-import-dialog.c
	* app/widgets/picmangradienteditor.c
	* app/tools/picmanblendtool.c
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/misc_tools.pdb: changed accordingly.

	* app/tools/picmanpaintoptions-gui.c: added a "Reverse" toggle right
	of the gradient preview.

	* app/widgets/picmanpreviewrenderergradient.[ch]: added "gboolean
	reverse" member and picman_preview_renderer_gradient_set_reverse()
	API.

	* tools/pdbgen/pdb/paint_tools.pdb: fixed the paintbrush invoker
	to set PicmanPaintOption's "use-fade" and "use-gradient" properties
	correctly.

	* app/pdb/gradients_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* libpicman/picmanenums.h
	* libpicman/picmanmisctools_pdb.[ch]
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: removed PicmanGradientPaintMode
	here too since it was only exported accidentially (it's not used
	by any external API).

	* plug-ins/script-fu/scripts/3dTruchet.scm
	* plug-ins/script-fu/scripts/alien-glow-arrow.scm
	* plug-ins/script-fu/scripts/alien-glow-bar.scm
	* plug-ins/script-fu/scripts/alien-glow-bullet.scm
	* plug-ins/script-fu/scripts/alien-glow-button.scm
	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/beveled-button.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/coffee.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/gradient-example.scm
	* plug-ins/script-fu/scripts/pupi-button.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/sphere.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/test-sphere.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/title-header.scm
	* plug-ins/script-fu/scripts/weave.scm: pass "reverse" to
	picman_blend(). Pass FALSE in most cases and added script
	parameters were it makes sense.

2003-07-22  Jakub Steiner <jimmac@ximian.com>

	* data/images/picman_splash.png: special Picmancon splash

2003-07-22  Sven Neumann  <sven@picman.org>

	* configure.in: check for freetype-config and set FREETYPE_LIBS.

	* app/Makefile.am: link explicitely against freetype.

2003-07-22  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.[ch]: picman_composite_dispatch()
	doesn't have a return value, made it a void function.

2003-07-21  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/make-picman-composite-dispatch.py: big code cleanup.

	* app/composite/Makefile.am: removed references to $(builddir)

	* app/composite/test-composite.c: cleanup, preparation for
	transition to automatically generated regression testing code.

	* app/composite/picman-composite.c: Clean up of typedef usage

	* app/composite/picman-composite-regression.[ch]: added foundation
	for regression testing.

2003-07-21  Sven Neumann  <sven@picman.org>

	* data/images/picman_splash.png: use a simpler URL for the camp.

2003-07-21  Sven Neumann  <sven@picman.org>

	* autogen.sh: fix for Solaris /bin/sh (bug #118002).

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.[ch]: the Forte compiler doesn't
	like the use of global variables in inline functions. Applied a
	patch from Damien Carbery that fixes this (bug #118002).

2003-07-21  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.[ch]
	* app/tools/picmanblendoptions.[ch]
	* app/tools/picmanblendtool.c
	* tools/pdbgen/pdb/misc_tools.pdb
	* plug-ins/script-fu/scripts/: applied a slightly modified patch
	from Alastair M. Robinson that adds dithering to the blend tool
	(bug #97777).

	* app/pdb/misc_tools_cmds.c
	* libpicman/picmanmisctools_pdb.[ch]: regenerated.

2003-07-21  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am (picmanconfig_libs): added libpicmanmath.

	* app/composite/Makefile.am (libappcomposite_a_sources)
	* libpicman/Makefile.am (libpicman_1_3_la_SOURCES): fixed typos.

	* app/widgets/picmandevicestatus.c: removed an unused function.

2003-07-20  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picman.def
	* libpicman/picmanui.def
	* libpicmancolor/picmancolor.def 
	* libpicmanmath/picmanmath.def: Updates.

	* libpicman/picman.c (picman_config): [Win32] Use picman_tile_width() and
	_height() instead of now nonexistent _picman_tile_width and _height
	variables.

2003-07-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-vectors.c: more work on the framework.

2003-07-20  Tor Lillqvist  <tml@iki.fi>

	* picmantool-win32.c.in: New file, from stable branch. (Haven't
	checked yet what changes might be needed to it here in HEAD.)

2003-07-20  Sven Neumann  <sven@picman.org>

	Generalized text rendering and added a framework for creating
	PicmanVectors objects with text outlines.

	* app/text/Makefile.am
	* app/text/picmantext-bitmap.[ch]: new files with bitmap render
	function.

	* app/text/picmantext-vectors.[ch]: new files for rendering to
	vectors.

	* app/text/picmantextlayout-private.h: removed ...
	* app/text/picmantext-private.h: ... and readded with this name.

	* app/text/picmantextlayout-render.[ch]: reduced to the generic parts
	of text rendering.

	* app/text/picmantextlayer.c
	* app/text/picmantextlayout.c: changed accordingly.

2003-07-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: fixed confusion of PicmanImageType and
	PicmanImageBaseType enums that broke the plug-in for non-RGB images.

2003-07-20  Sven Neumann  <sven@picman.org>

	* configure.in: changed the gettext domain prefix to picman20.

	* m4macros/Makefile.am
	* m4macros/picman-1.4.m4: removed this file ...
	* m4macros/picman-2.0.m4: ... and readded it with a new name.
	Changed the macro to AM_PATH_PICMAN_2_0().

	* configure.in: added --without-aa option as a way to work around
	broken aalib installations.

	* INSTALL: document --without-aa and --without-mng.

2003-07-20  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/rendermap.scm: applied a patch from
	Alastair M. Robinson that fixes the name of the default gradient
	(bug #117851).

2003-07-19  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolornotebook.c: added style properties
	"tab_border" and "tab_icon_size" just as they exist for
	PicmanDockbook. Factored page creation out to the new
	picman_color_notebook_add_page() utility function.  Added fancy menu
	items for the popup menu and translate them.

	* etc/gtkrc_user
	* themes/Default/gtkrc: use the same tab style for PicmanDockbooks
	and PicmanColorNotebooks.

2003-07-19  Dave Neary  <bolsh@picman.org>

	* app/paint/picmanclone.c: Fixed a mistake in the code which does
	a pattern clone. Closes bug #117433.

	* app/widgets/picmanbrushfactoryview.c: Added a tooltip for the 
	Spacing slider.

2003-07-19  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolornotebook.c: save some space by showing
	the stock_id instead of the colorselector's name.

	* libpicmanwidgets/picmancolorselect.c
	* modules/colorsel_cmyk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: removed now unused mnemonics.

	* app/widgets/picmancoloreditor.c: no need to strip mnemonics from
	the name here any longer.

2003-07-18  Sven Neumann  <sven@picman.org>

	* app/gui/info-window.c: show CMYK color values.

	* app/tools/picmancolorpickertool.c: reduced code duplication.

2003-07-18  Michael Natterer  <mitch@picman.org>

	* app/composite/make-picman-composite-dispatch.py: made generated
	output compile again and cleaned it up a bit.

	* app/composite/picman-composite-dispatch.c: regenerated.

	* app/paint-funcs/paint-funcs.c (combine_sub_region): don't use
	tabs please.

2003-07-18  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite.[ch],
	* app/composite/make-picman-composite-dispatch.py
	stubbed out the 32bit-per-channel pixel formats.

	* app/composite/picman-composite-sse.[ch],
	* app/composite/Makefile.am
	Broke-out and added the SSE versions of the MMX code.

	* app/composite/picman-composite.[ch],
	* app/paint-funcs/paint-funcs.c,
	* app/composite/make-picman-composite-dispatch.py
	Use of the new picman_composite code is now turned on via the
	environment variable PICMAN_COMPOSITE with a non-zero value.  For
	example:
	% PICMAN_COMPOSITE=1 picman-1.3

2003-07-18  Michael Natterer  <mitch@picman.org>

	* app/config/picmanrc-blurbs.h
	* app/config/picmandisplayconfig.[ch]: added separate properties for
	the fullscreen appearance of the display (menubar, rulers,
	scrollbars, statusbar and padding). Default to everything
	invisible and black padding.

	* app/display/picmandisplayshell.[ch]: renamed struct
	PicmanDisplayShellVisibility to PicmanDisplayShellAppearance and added
	the canvas padding stuff.

	* app/display/picmandisplayshell-appearance.[ch]: made
	picman_display_shell_set_padding() fullscreen-aware. Added
	picman_display_shell_get_padding().

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/gui/image-menu.c: changed addordingly.

	* app/gui/preferences-dialog.c: added the new options and moved
	the display appearance stuff to its own page. Minor cleanups.

2003-07-17  Sven Neumann  <sven@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/picmananchor.[ch]: added a simple PicmanAnchor API.

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c: use the new functions.

2003-07-17  Jakub Steiner <jimmac@ximian.com>

	* plug-ins/common/*.c: added mnemonics for plugins

2003-07-17  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-params.[ch]: added "gboolean allow_percent"
	to picman_param_spec_unit() and to the PICMAN_CONFIG_INSTALL_PROP_UNIT()
	macro. Changed value validation accordingly.

	* app/config/picmanconfig-types.c (string_to_unit): parse "percent"
	correctly.

	* app/widgets/picmanpropwidgets.c (picman_prop_unit_menu_new): show
	the "Percent" menu entry if the param_spec allows percent.

	* app/config/picmancoreconfig.c
	* app/core/picmangrid.c
	* app/core/picmantemplate.c
	* app/text/picmantext.c: pass FALSE to disallow percent.

	* app/paint/picmanpaintoptions.c
	* app/tools/picmanselectionoptions.c: pass TRUE. Brings back the
	percent feature for fade_length, gradient_length and fixed_size
	rect/ellipse select.

	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanmagnifyoptions.c
	* app/tools/picmanselectionoptions.c
	* app/tools/picmantransformoptions.c: don't call the the reset()
	functions from the GUI constructors (and reset the options just
	deserialized from disk). Instead, added set_defaults() functions
	which do everything the old reset() functions did (except
	upchaining) and call set_defaults() from reset() and from the GUI
	constructors.

2003-07-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandevicestatus.c (picman_device_status_init): 
	disconnect the PicmanDeviceInfo::changed() signal handlers when
	the dialog goes away. Fixes bug #117609.

2003-07-16  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors.c (picman_vectors_transform): invert the
	matrix for direction == PICMAN_TRANSFORM_BACKWARD. Fixes corrective
	transformation of paths.

2003-07-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_draw): add a small
	EPSILON to the brush coordinates before rounding them (fixes
	off-by-one floating point rounding fnord for "hard edge" painting
	where e.g. (5.0 - (3.0 / 2.0)) was rounded to 3.0 instead of 4.0).

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_boundary): use
	RINT() instead of floor() to round the transformed boundary to
	GdkSegments.

2003-07-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.[ch]: implemented transforming of
	paths. Cleaned up initialize() and button_press() to activate the
	tool correctly. Use the transform tool's CREATING state *only*
	before the first mouse click (when there is no grid displayed).
	Preview the active path while transforming. Cache the transform
	direction in the PicmanTransformTool struct so we can switch it
	while previewing the path. Lots of path transform related changes
	and cleanup.

2003-07-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_draw): don't
	draw the grid when the bounding box becomes concave.

2003-07-15  Jakub Steiner <jimmac@ximian.com>

	* etc/templaterc: add PAL and NTSC templates

2003-07-16  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.[ch]: added utility function
	picman_paint_options_get_fade() which calculates an opacity
	value from paint_core->pixel_dist.

	* app/paint/picmanpaintbrush.c: removed the same code here and use
	picman_paint_options_get_fade().

	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmansmudge.c: enabled fade for all paint tools, along
	with a general opacity cleanup:

	Use the opacity from picman_context_get_opacity() *only* for the
	image_opacity. In particular, *never* use it as initial value for
	calculating the brush_opacity. Instead, start calculating the
	brush_opacity from picman_paint_options_get_fade() and return early
	if it returns 0.0, if not, multiply tool specific opacity sources
	like the current pressure.

	(This changes the effect of the paint tools for particular opacity
	values, but makes the impact of opacity on the final rendering
	linear and more intuitive)

	* app/tools/picmanpaintoptions-gui.c: enabled the "Fade" frame for
	the tools above.

	* app/paint/picmanpaintcore.c: purely cosmetic cleanup.

2003-07-15  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c (prefs_dialog_new)
	* app/widgets/picmanviewabledialog.c (picman_viewable_dialog_new): 
	use a large font instead of extra-large.
	
2003-07-15  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-dispatch.c: added to cvs AGAIN.

	* app/composite/test-composite.c: by default check each
	compositing function 1 time, with a 500001 pixel array.

	* app/composite/picman-composite-generic.h: Use
	PicmanCompositeFunction as the type for all compositing functions.
 
	* app/composite/Makefile.am: picman-composite.c is no longer
	dependant upon picman-composite-dispatch.c
 
	* app/composite/picman-composite-dispatch.[ch]
	app/composite/make-picman-composite-dispatch.py: Fixed type
	mismatches.
 
	* app/composite/test-composite.c: Fixed bit-rot in not keeping up
	with the changes in the surrounding .h files.
 
	* app/composite/picman-composite-mmx.c: Incipient cleanup in marking
	some asm constructs as volatile.

2003-07-15  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.[ch]: took the fade options out of
	PicmanGradientOptions and added them to the new PicmanFadeOptions
	struct. Added a GObject::finalize() implementation.

	* app/paint/picmanpaintbrush.[ch]: changed accordingly. Made
	picman_paintbrush_motion() a protected function and renamed it to
	_picman_paintbrush_motion() added a "gdouble opacity" parameter so
	an initial brush opacity can be passed in by subclasses.

	* app/paint/picmanairbrush.[ch]: derive it from PicmanPaintbrush so it
	gets all its rendering features. Removed own rendering code and
	use _picman_paintbrush_motion(), passing airbrush_options->pressure
	as initial opacity. Removed all static variables.

	* app/tools/picmanairbrushtool.[ch]
	* app/tools/picmanpenciltool.[ch]: derive them from PicmanPaintbrushTool.

	* app/tools/picmanpaintoptions-gui.c: changed accordingly. Added the
	full paintbrush options overkill to the airbrush GUI. Cleanup.

	* app/tools/picmanerasertool.c: forgot to remove the "Hard Edge"
	toggle here.

2003-07-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c: use the new CMYK->RGB conversion routine to
	handle CMYK in PSD files.

2003-07-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: applied PICMAN coding style. UTF8-validate
	the image description before accepting it as a comment. Check for
	ASCII-only comment before saving it as an image description.

2003-07-15  Sven Neumann  <sven@picman.org>

	* modules/colorsel_cmyk.c: use a range from 0 to 100 for CMYK values.

2003-07-15  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolor.h: include <libpicmancolor/picmancmyk.h>.

	* modules/Makefile.am
	* modules/colorsel_cmyk.c: added a simple CMYK color selector.

2003-07-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpattern.c (picman_pattern_load): fixed pattern depth
	check to allow RGBA patterns again. Removed trailing whitespace.

2003-07-14  Sven Neumann  <sven@picman.org>

	* libpicmancolor/Makefile.am
	* libpicmancolor/makefile.msc
	* libpicmancolor/picmancmyk.[ch]: new files that define a PicmanCMYK
	structure similar to PicmanRGB.

	* libpicmancolor/picmancolortypes.h: added the PicmanCMYK typedef.

	* libpicmancolor/picmancolorspace.[ch]: added conversions between RGB
	and CMYK. This implementation is the naive approach without any
	color calibration whatsoever.

	* libpicmancolor/picmanhsv.[ch]
	* libpicmancolor/picmanrgb.[ch]: purely cosmetic changes.

2003-07-14  Michael Natterer  <mitch@picman.org>

	Argh...

	* app/paint/Makefile.am
	* app/paint/picmanpencil.[ch]: added it again as PicmanPaintbrush
	subclass and override nothing but the user visible undo name and
	the paint_options type.

	* app/paint/paint.c
	* app/tools/tool_manager.c
	* app/tools/picmanpenciltool.c
	* tools/pdbgen/pdb/paint_tools.pdb: reverted my last changes.

	* app/pdb/paint_tools_cmds.c: regenerated.

2003-07-14  Michael Natterer  <mitch@picman.org>

	* app/paint/Makefile.am
	* app/paint/picmanpencil.[ch]: removed.

	* app/paint/picmanpenciloptions.[ch]: new files. Does nothing except
	setting the default value of "hard" to TRUE.

	* app/paint/paint.c
	* app/tools/tool_manager.c: changed accordingly.

	* app/tools/picmanpenciltool.c
	* tools/pdbgen/pdb/paint_tools.pdb: use the paintbrush core for
	pencil drawing.

	* app/pdb/paint_tools_cmds.c: regenerated.

	* app/tools/picmanpaintoptions-gui.c: show all paintbrush options
	except "Hardness" for the pencil tool.

2003-07-14  Michael Natterer  <mitch@picman.org>

	* app/paint/picmaneraseroptions.[ch]: removed "gboolean hard"
	member/property...

	* app/paint/picmanpaintoptions.[ch]: ...and added it here. Added
	picman_paint_options_get_brush_mode() utility function.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.h
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c: use the new utility funtion where
	appropriate. Removed trailing whitespace.

	* app/tools/picmandrawtool.[ch] (picman_paint_tool_draw_boundary):
	changed offset parameters from gint to gdouble so we can show the
	brush preview at sub-pixel positions.

	* app/tools/picmanpainttool.c: use sub-pixel coordinates for the
	brush preview if paint_options->hard is FALSE (doesn't work for
	the pencil yet).

	The new brush preview unveiled that the positioning of even-sized
	brushes if off by 0.5 for soft brush application mode and off by
	1.0 for hard application mode:

	* app/paint/picmanpaintcore.[ch] (picman_paint_core_subsample_mask):
	offset painting by 0.5 pixels on the brushes' even sized axes by
	shuffling the subsample matrices around.

	Added "subsampling" for HARD brush application mode since a pixel
	of an even sized brush can snap to up to four different image
	pixels depending on the sub-pixel coordinates of the stroke.

2003-07-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpaintoptions-gui.c: removed double semicolons.

2003-07-14  Michael Natterer  <mitch@picman.org>

	* tools/kernelgen.c: cleanup. Removed trailing whitespace in
	generated output.

	* app/paint/picmanpaintcore-kernels.h: regenerated.

2003-07-14  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c: check if the active_tool is a
	PicmanDrawTool before casting & accessing its members.

2003-07-14  Sven Neumann  <sven@picman.org>

	* configure.in: use AM_PROG_AS instead of defining CCAS and
	CCASFLAGS manually. Changed the assembler checks to use inline
	assembly as we do in app/composite/picman-composite-mmx.c.

	* app/composite/Makefile.am: build the MMX code again; we need it
	to be tested. If you have any problems, please report them. You can
	quick-fix your build using the --disable-mmx configure option.

	* app/paint-funcs/Makefile.am: reverted Helvetix' change ...
	* app/paint-funcs/paint-funcs.c: ... and include
	"composite/picman-composite.h" instead of "picman-composite.h".

2003-07-14  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_init): include composite/picman-composite.h.

	* app/paint-funcs/paint-funcs.c: enforce PICMAN coding style on the
	code that Helvetix added.

2003-07-13  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-dispatch.[ch]: are in CVS although
	they are generated files.  This is preparation for building the
	table at run-time, instead of compile time.

2003-07-13  Manish Singh  <yosh@picman.org>

	* app/composite/Makefile.am: remove bogus trailing slash

	* libpicman/picman.c: use raise() instead of kill() with getpid()

2003-07-13  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/Makefile.am: fixed typo with trailing backslash.

	* app/paint-funcs/Makefile.am: include files from app/composite/

	* app/paint-funcs/paint-funcs.c: stubbed out code for using
	picman_composite.  To enable the use of picman_composite, set the
	value of picman_composite_use_old to 0 (zero).

	* app/base/base.c: calls picman_composite_init() hook to initialse
	all the picman_composite "stuff."

	* app/composite/make-picman-composite-dispatch.py: now generates
	picman-composite-dispatch.h

	* app/composite/picman-composite-dispatch.[ch]: are in CVS although
	they are generated files.  This is preparation for building the
	table at run-time, instead of compile time.

	* app/composite/picman-composite.c: doesn't #include the main
	dispatch table.  This is preparation for building the table at
	run-time, instead of compile time.  

	* app/composite/Makefile.am: doesn't compile picman-composite-mmx.c
	(until the various remaining gcc problems and configuration issues
	are worked out).
	  

2003-07-11  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.c (picman_config_reset): don't return stuff
	from a void function (spotted by Jimmer on #picman). Removed
	trailing whitespace.

2003-07-11  Michael Natterer  <mitch@picman.org>

	* app/gui/user-install-dialog.c: lots of purely cosmetic stuff
	(spacing, separator removal, bold labels, icons in the
	installation log, ...).

2003-07-11  Sven Neumann  <sven@picman.org>

	* app/base/boundary.c (find_empty_segs): silence the compiler.

2003-07-11  Dave Neary  <bolsh@picman.org>

	* devel-docs/parasites.txt: Document jpeg-exif-data
	parasite.

2003-07-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-transform.[ch]: removed
	picman_display_shell_transform_boundary() again...

	* app/tools/picmandrawtool.[ch]: ...and added as
	picman_draw_tool_draw_boundary(). Removed the PicmanDrawToolState enum
	and the "draw_state" member since they were redundant. Cleanup.

	* app/tools/picmaneditselectiontool.c: changed accordingly.

	* app/tools/picmanpainttool.[ch]: added a brush preview so we
	finally see where we will paint. Fixes bug #32498. Cleanup.

	* app/tools/tool_manager.c: also look at draw_tool->gdisp, not
	only at tool->gdisp when deciding whether the active tool has to
	be suspended/resumed/halted. Fixes a couple of fnords with the
	line preview and the new brush preview.

	* app/tools/picmancolortool.c: minor cleanup.

2003-07-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmancurvestool.c
	* app/tools/picmantool.c
	* app/tools/tool_manager.c: removed trailing whitespace.

2003-07-10  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.[ch]: added "guchar threshold" parameters all
	over the place instead of always using 127. Made the HALF_WAY
	#define public.
	(find_empty_segs): don't crash if PR->tiles is NULL but treat
	PR->data as the entire buffer so the function can be used on
	PixelRegions of TempBufs.

	* app/core/picmanchannel.c
	* app/core/picmanlayer-floating-sel.c
	* app/tools/picmanfuzzyselecttool.c: pass HALF_WAY to
	find_mask_boundary().

2003-07-10  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-mmx.c: only compile this code if
	USE_MMX is defined.

2003-07-10  Dave Neary  <bolsh@picman.org>

	* app/core/picmanbrush-header.h
	* app/core/picmanpattern-header.h: Replace guint by guint32
	just in case we're on a platform with 16 bit ints.

	* app/core/picmanpattern.c: Uncomment a check for
	colourdepth of the pattern. There are no other values
	possible outside the range 1-4, but it serves as a
	sanity check in case people do odd things.

	* configure.in: Add a --enable-profile configure flag to
	allow profiling support. Adds -pg to the CFLAGS.

2003-07-09  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-transform.[ch]: added new function
	picman_display_shell_transform_boundary() which takes an array of
	BoundSegs and returns an array of GdkSegments.

	* app/tools/picmaneditselectiontool.c: use it.

2003-07-09  Manish Singh  <yosh@picman.org>

	* devel-docs/Makefile.am: add gbr.txt and pat.txt

2003-07-09  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/gtkcons.py: don't do anything if run
	standalone and given a -picman command line option. (Sanity against
	#117074)

2003-07-09  Dave Neary  <bolsh@picman.org> 

	* devel-docs/pat.txt: Documented the pat version 1 file
	format while I was at it.

2003-07-09  Dave Neary  <bolsh@picman.org> 

	* devel-docs/gbr.txt: Documented the gbr version 2 file
	format, after some confusion with Cinepaint's version.

2003-07-09  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb: applied a modified patch from Joao
	S. O. Bueno <gwidion@mpc.com.br> that adds the new PDB function
	picman_path_to_selection().

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

2003-07-09  Sven Neumann  <sven@picman.org>

	* app/composite/tester.c: removed ...
	* app/composite/test-composite.c: ... and readded under a new name.

	* app/composite/Makefile.am: added a check target that builds and
	runs the test program.

	* app/composite/picman-composite-generic.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-util.h
	* app/composite/picman-composite.[ch]
	* app/composite/make-picman-composite-dispatch.py: made it fit
	better into the PICMAN source tree:
	- do not include any files from headers
	- don't use types from <sys/types.h> but use what glib provides
	- coding style ...

2003-07-09  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/composite/Makefile.am: some Makefile fixes, more to come.

2003-07-08  Helvetix Victorinox  <helvetix@picman.org>

	* Added app/composite for the new compositing mechanism.

	* Modified configure.in to build app/composite/Makefile

	* Added app/composite to app/Makefile.am

2003-07-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c: added a hack that ensures that
	the toolbox is always first in all dialog_factories_foreach calls.
	This way the toolbox appears first in sessionrc and first on screen.

	* etc/sessionrc: updated the sample sessionrc, tweaked it a little.

2003-07-08  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders-scripts.png: new icon
	(just a copy of folders.png for now).

	* app/gui/preferences-dialog.c: added a GUI for the Script-Fu
	path.  Fixes bug #96282.

2003-07-08  Michael Natterer  <mitch@picman.org>

	Added configurable styles for dockable tabs (fixes bug #87376):

	* app/widgets/widgets-enums.[ch]: added new enum PicmanTabStyle
	which can be one on { ICON, NAME, ICON_NAME, ICON_BLURB }.

	* app/widgets/picmandockable.[ch]: added a PicmanTabStyle member to
	the PicmanDockable struct which defaults to PICMAN_TAB_STYLE_ICON.
	Renamed "short_name" to "name" and "name" to "blurb". Renamed
	PicmanDockableGetTabFunc to PicmanDockableGetIconFunc. Implemented all
	tab styles in picman_dockable_real_get_tab_widget() and use the
	"get_icon_func" only for creating the tab's icon, not the entire
	tab widget.

	* app/widgets/picmandockbook.[ch]: changed accordingly. Create the
	menu widgets and the DND icon using picman_dockable_get_tab_widget()
	with tab_style == PICMAN_TAB_STYLE_ICON_BLURB instead of duplicating
	tons of code. Made picman_dockbook_get_tab_widget() public because
	it's needed for exchanging tabs on-the-fly.

	* app/widgets/picmanimagedock.c: changed accordingly.

	* app/widgets/picmandialogfactory.c: remember the dockables' tab
	style in sessionrc.

	* app/gui/dialogs-menu.c: added a submenu to select the tab style
	for each dockable.

	* app/gui/dialogs-commands.[ch]: new callback
	dialogs_tab_style_cmd_callback().

	* app/gui/dialogs-constructors.[ch]: added stock_ids to all
	dockables, swapped the "name" and "blurb" parameters, reordered
	functions, cleanup.

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: use PICMAN_STOCK_DEFAULT_COLORS for the
	color editor dockable and renamed it to "FG/BG Color".

2003-07-08  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added PicmanGradientSegment typedef.

	* app/core/picmangradient.h: removed it here.

	* app/core/picmangradient.c: no need to cast the return value
	of g_object_new().

2003-07-08  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-wilber-32.png
	* themes/Default/images/stock-wilber-48.png
	* themes/Default/images/stock-wilber-64.png: a nicer Wilber with
	a brush and drop shadow.

2003-07-08  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_from_layer): replace
	the layer in the global item hash table, fixes bug #116936.

	* libpicman/picmanexport.c (picman_export_image): added a warning that
	would have helped to resolve above bug.

2003-07-08  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_create): don't ignore the delete event
	on the splash screen, but quit picman immidiately by calling exit().

	* app/xcf/xcf-load.c (xcf_load_layer): reduced code duplication.

2003-07-08  Sven Neumann  <sven@picman.org>

	* app/gui/file-commands.c (file_save_cmd_callback): warn if the
	image has no active drawable instead of silently returning. Not
	sure if this is correct, but it could help to resolve #116936.

2003-07-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmancolorpickertool.c: show the alpha value in percent
	as well (as suggested in bug #116384).

2003-07-07  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmatrix.[ch]: added picman_matrix2_mult().

2003-07-07  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbasetypes.h: include <libpicmanmath/picmanmathtypes.h>.

	* libpicmanmath/picmanmathtypes.h
	* libpicmanmath/picmanmatrix.[ch]: added PicmanMatrix2 struct definition
	and new function picman_matrix2_identity().

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-params.[ch]
	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-types.[ch]
	* app/config/picmanconfig.c
	* app/config/picmanscanner.[ch]: added a boxed type around PicmanMatrix2.

	* app/text/picmantext.[ch]: added new property "transformation".

2003-07-07  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanvector.[ch]: added const qualifiers.
	
2003-07-07  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmathtypes.h
	* libpicmanmath/picmanvector.h: moved struct declarations.

	* libpicmanmath/picmanmatrix.[ch]: made PicmanMatrix3 and PicmanMatrix4
	structs instead of typedefs for arrays. Pass them by reference,
	not by value. Added lots of const qualifiers.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform-utils.[ch]
	* app/core/picmandrawable-transform.[ch]
	* app/core/picmandrawable.c
	* app/core/picmanitem-linked.[ch]
	* app/core/picmanitem.[ch]
	* app/core/picmanlayer.c
	* app/pdb/transform_tools_cmds.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantransformtool.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.

2003-07-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c: applied a patch from S. Mukund that fixes
	a problem with newer versions of libmng (bug #115544).

2003-07-07  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/device-status-dialog.[ch]: removed...

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmandevicestatus.[ch]: ...added here as widget. The
	thing is narrower now but not nicer and needs some polishing.

	* app/widgets/picmanpropwidgets.[ch]: added picman_prop_color_area_new()
	and picman_prop_stock_image_new() (the latter is still unused).

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: made the device status a dockable.

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: changed accordingly.

	* app/gui/gui.c: update the device status dialog indirectly now
	using the new gui_device_change_notify() callback.

2003-07-06  Sven Neumann  <sven@picman.org>
	
	* app/text/Makefile.am
	* app/text/picmantextlayout-private.h
	* app/text/picmantextlayout-render.[ch]: new files that implement
	text rendering. Right now it's basically code copied from PangoFT2
	but having it here will allow me to implement text transformations.

	* app/text/picmantextlayout.[ch]
	* app/text/picmantextlayer.c: changed accordingly.

2003-07-06  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: an updated version from Eric Pierce.

2003-07-04  Henrik Brix Andersen  <brix@picman.org>

	Added persistent storage of image grid in XCF files.
	
	* app/core/picmanimage.[ch]: removed picman_image_get_grid() and
	picman_image_set_grid() ...

	* app/core/Makefile.am
	* app/core/picmanimage-grid.[ch]: ... and added them to these new
	files. Added picman_grid_parasite_name(), picman_grid_to_parasite()
	and picman_grid_from_parasite() functions.
	
	* app/core/picmanimage-snap.c
	* app/gui/grid-dialog.c: #include "picmanimage-grid.h"

	* app/core/picmanimage-undo-push.c: #include "picmanimage-grid.h".
	(picman_image_undo_push_image_grid) mark image as dirty.
	
	* app/xcf/xcf-save.c (xcf_save_image_props): save PicmanGrid object
	as a parasite.
	
	* app/xcf/xcf-load.c (xcf_load_image): load PicmanGrid from
	parasite.
	
	* devel-docs/parasites.txt: documented the new "picman-image-grid"
	parasite.

	* app/core/picmandrawable-bucket-fill.c
	(picman_drawable_bucket_fill_full): applied a patch from Pedro
	Gimeno <pggimeno@wanadoo.es> which fixes segmentation fault when
	using <Image>/Edit/Fill with [FB]G Color.

2003-07-04  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/base/base.c
	* app/base/cpu-accel.c: added (untested) check for altivec assembly
	and enabled the run-time altivec check.

2003-07-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_set_color): use
	PICMAN_COLOR_AREA_SMALL_CHECKS instead of _FLAT so the color's alpha
	is visible. Lookup GTK_ICON_SIZE_MENU's dimensions instead of
	hardcoding 16x16.

2003-07-04  Sven Neumann  <sven@picman.org>

	* app/base/colorize.c (colorize_init): use more inspiring initial
	values.

2003-07-04  Sven Neumann  <sven@picman.org>

	* plug-ins/gdyntext/*: removed from CVS.

2003-07-04  Jakub Steiner <jimmac@ximian.com>

	* app/gui/image-menu.c: fix clashing mnemonics 

2003-07-04  Sven Neumann  <sven@picman.org>

	* configure.in: redone target platform detection and MMX assembly
	checks. Basically copied from DirectFB.

	* app/Makefile.am
	* app/arch/i386/mmx/detect_mmx.S
	* app/arch/i386/mmx/paint_funcs_mmx.S
	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs-mmx.h
	* app/paint-funcs/paint-funcs-simd.S: removed the old MMX routines.
	New ones will come instead.

	* app/base/Makefile.am
	* app/base/detect-mmx.[Sh]: removed these two files...

	* app/base/cpu-accel.[ch]: ... and added new ones that do more
	fine-grained cpu acceleration detection. Again taken from DirectFB
	but the code is originally from mpeg2dec.

	* app/base/base.c: print results from cpu feature tests.

2003-07-04  Dave Neary  <bolsh@picman.org>

	* app/core/picmandrawable-bucket-fill.c: Add alpha channel
	to temp buffer from picmanimage if there's an alpha
	channel in the pattern being applied.

2003-07-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c (save_image): refuse to write comments that
	contain non-ASCII characters.

2003-07-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: added a toggle that allows to disable
	saving of the image comment.

2003-07-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/blur.c
	* plug-ins/common/gifload.c
	* plug-ins/common/gih.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/pcx.c
	* plug-ins/common/png.c
	* plug-ins/common/ps.c
	* plug-ins/common/psd.c
	* plug-ins/common/psp.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c
	* plug-ins/common/tga.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/fp/fp.h
	* plug-ins/fp/fp_gdk.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/paper.c
	* plug-ins/picmanressionist/ppmtool.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/ifscompose/ifscompose_utils.c
	* plug-ins/script-fu/script-fu-server.c		
	* plug-ins/xjt/xjt.c: fixed some minor code issues found compiling
	with -pedantic.

2003-07-03  Manish Singh  <yosh@picman.org>

	* configure.in: remove picman.spec stuff (leave picman.spec.in in CVS
	for now as reference, maybe update it with the freshrpms spec at
	some point)

2003-07-03  Manish Singh  <yosh@picman.org>

	* plug-ins/common/jpeg.c: fix spelling of "quality" in comment

	* tools/pdbgen/*.pl: update copyright strings to 2003

	* libpicman/picmanenums.h
	* libpicman/*_pdb.[ch]
	* app/pdb/*_cmds.[ch]
	* app/pdb/internal_procs.[ch]
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c: regenerated

2003-07-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: added support for reading and writing
	comments. Handles tTXt (ISO-8859-1) and, if your libpng supports
	it, iTXt (UTF-8) chunks.

2003-07-02  Sven Neumann  <sven@picman.org>

	* RPM/*: removed these files, they are of no purpose any longer.

2003-07-02  Sven Neumann  <sven@picman.org>

	* app/gui/edit-commands.c	
	* app/gui/image-menu.c: added "Fill with Pattern" menu entry as
	suggested in bug #116365.

	* app/base/temp-buf.c
	* app/base/tile-swap.c
	* app/config/picmanbaseconfig.c
	* app/config/picmanconfig-types.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell.c
	* app/file/file-utils.c
	* app/paint-funcs/paint-funcs-types.h
	* app/tools/picmandrawtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.h
	* app/tools/picmantextoptions.c
	* app/paint-funcs/paint-funcs-types.h
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c
	* app/vectors/picmanvectors.c	
	* app/vectors/vectors-types.h
	* libpicman/picmanbrushmenu.c
	* libpicman/picmanmisc.h	
	* libpicmanmodule/picmanmodule.c: fixed some minor issues found
	compiling with -pedantic.

	* app/pdb/misc_tools_cmds.c
	* tools/pdbgen/pdb/misc_tools.pdb: adapt to the changed order of
	arguments for picman_image_pick_color().

2003-07-02  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbasetypes.h: changed PicmanDatafileLoaderFunc to
	take a separate "gpointer user_data" parameter (passing user_data
	in a struct was a quite nonstandard API design). Made the
	PicmanDatafileData pointer const.

	* libpicmanbase/picmandatafiles.[ch]: removed user_data from the
	PicmanDatafileData struct and added "const gchar *basename" so we
	don't need to g_path_get_basename() in many callbacks.

	* libpicman/picmanmiscui.[ch]: changed picman_plug_in_parse_path() to
	picman_plug_in_get_path() and return the unparsed path.

	* app/core/picmandatafactory.c
	* app/core/picmanenvirontable.c
	* app/gui/gui.c
	* app/plug-in/plug-ins.c
	* libpicmanmodule/picmanmoduledb.c
	* plug-ins/script-fu/script-fu-scripts.c: changed accordingly.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.[ch]
	* plug-ins/FractalExplorer/Globals.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c: use picman_datafiles_read_directories()
	instead of fiddling with g_dir_open() manually. Random cleanups.

2003-07-02  Sven Neumann  <sven@picman.org>

	* plug-ins: last bunch of plug-ins adapted to libpicman changes.

2003-07-02  Michael Natterer  <mitch@picman.org>

	* app/gui/grid-dialog.c: s/Appearence/Appearance/g, changed
	color_notebook titles to say "Change Foo Color" instead of
	just "Foo Color".

	* app/widgets/picmanlayertreeview.c: irrelevant code review.

2003-07-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-types.h: added PicmanMenuPositionFunc typedef.

	* app/widgets/picmanwidgets-utils.[ch]: made picman_menu_position()
	a PicmanMenuPositionFunc.

	* app/widgets/picmanitemfactory.[ch]
	(picman_item_factory_popup_with_data): added position_func and
	position_data parameters. Use picman_menu_position() if no
	position_func is given.

	* app/display/picmandisplayshell-callbacks.c: removed
	picman_display_shell_origin_menu_popup() and call
	picman_item_factory_popup_with_data() directly from
	picman_display_shell_popup_menu(), using
	picman_display_shell_origin_menu_position() as position_func.

	* app/widgets/picmaneditor.[ch]: added a GtkWidget::popup_menu()
	implementation so all context menus are keyboard accessible.
	Added "gpointer factory_data" member so the menu can be popped up
	in the right context.

	* app/gui/channels-menu.c
	* app/gui/layers-menu.c
	* app/gui/vectors-menu.c: make them work without an active image
	since they can be popped up at any time now.

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: cleanup.

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmanerrorconsole.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanpaletteeditor.c: pass NULL, NULL as
	position_func and position_data so the default implementation is
	used.

2003-07-02  Sven Neumann  <sven@picman.org>

	* plug-ins: more plug-ins adapted to libpicman changes.

2003-07-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.c: misc cleanup.
	(picman_item_factory_create_item): use picman_menu_path_strip_uline()
	here too.

2003-07-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch] (picman_menu_path_strip_uline):
	new function which takes menu_paths with mnemonics and removes
	them so they can be used as identifiers.

	* app/gui/plug-in-menus.c: use the new function. Enables mnemonics
	for plug-in menu entries. Removed plug_in_escape_uline() which
	implemented disabling them.

	* app/widgets/picmantoolbox.c (toolbox_create_tools): use it here
	too, made the function more robust.

2003-07-02  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/lib.pl: constify input strings, colors, and arrays

	* libpicman/*_pdb.[ch]: regenerated

2003-07-02  Sven Neumann  <sven@picman.org>

	* plug-ins: more plug-ins adapted to libpicman changes.

2003-07-01  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushselect.c
	* libpicman/picmanfontselect.c
	* libpicman/picmangradientselect.c
	* libpicman/picmanpatternselect.c
	* libpicman/picmanpixelrgn.c: added const qualifiers.

	* libpicman/picmanmiscui.c: reverted a bogus change from my last commit.

2003-07-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common: first set of plug-ins adapted to the constified
	libpicman API.

2003-07-01  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch]
	* libpicman/picmanchannel.[ch]
	* libpicman/picmandrawable.[ch]
	* libpicman/picmanimage.[ch]
	* libpicman/picmanlayer.[ch]
	* libpicman/picmanmisc.[ch]
	* libpicman/picmanmiscui.[ch]
	* libpicman/picmanpixelrgn.[ch]
	* libpicman/picmanproceduraldb.[ch]: added const qualifiers to the
	libpicman API. Will cause lots of compiler warnings until the
	generated PDB code has been constified as well.

	* libpicmanbase/picmanparasite.[ch]: use gconstpointer, not const
	gpointer.

2003-07-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ripple.c (average_four_pixels): fixed the
	non-alpha case (bug #116470).

2003-07-01  Jakub Steiner <jimmac@ximian.com>

	* app/gui/image-menu.c
	* app/gui/plug-in-menus.c
	* app/gui/toolbox-menu.c
	* app/tools/picman*tool.c: Added mnemonics (bug #106991). 
	  Plug-ins and Script-Fus next.

2003-07-01  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.[ch]
	* plug-ins/ifscompose/ifscompose_utils.c: use Pango to draw text.

	* plug-ins/ifscompose/ifscompose_storage.c: minor code cleanup.

2003-07-01  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.17.

2003-07-01  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanmenu.[ch]: removed all brush, font, gradient
	and pattern related code.

	* libpicman/picmanbrushselect.[ch]
	* libpicman/picmanfontselect.[ch]
	* libpicman/picmangradientselect.[ch]
	* libpicman/picmanpatternselect.[ch]: new files containing the
	wrappers around their resp. _pdb.[ch] files. Changed function
	names to picman_*_select_new(). Added picman_*_select_destroy()
	functions so we're not forced to leak all wrappers. Cleanup.

	* libpicman/picmanbrushmenu.h
	* libpicman/picmanfontmenu.h
	* libpicman/picmangradientmenu.h
	* libpicman/picmanpatternmenu.h: new files. Changed function names
	here too.

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpatternmenu.c: changed accordingly. Free the
	foo_select wrappers when they are no longer needed (generally,
	free everthing instead of leaking everything). Lots of cleanup.

	* libpicman/Makefile.am
	* libpicman/picman.def
	* libpicman/picmanui.def: changed accordingly.

	* libpicman/picman.h
	* libpicman/picmanui.h: include the new headers.

	* libpicman/picmancompat.h: added the old function names here.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/film.c
	* plug-ins/gfig/gfig.c
	* plug-ins/script-fu/script-fu-scripts.c: changed accordingly.

2003-07-01  Sven Neumann  <sven@picman.org>

	* tools/authorsgen/contributors: removed a duplicate entry, added
	some new ones.

	* AUTHORS
	* app/gui/authors.h: regenerated.

2003-07-01  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h
	* app/paint/paint-enums.h
	* app/tools/tools-enums.h: use /*< pdb-skip, skip >*/, updated the
	comment that explains how to use the trigraph sequences.

	* app/tools/tools-enums.c: regenerated.
	
2003-06-30  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs.c
	* app/gui/module-browser.c
	* app/gui/toolbox-menu.c: changed "Module Browser" to "Module
	Manager" as suggested in bug #116171.

2003-06-29  Manish Singh  <yosh@picman.org>

	* tools/picman-mkenums: handle options with -'s in them

	* tools/pdbgen/enumgen.pl: redo a bunch of logic for the below

	* app/core/core-enums.h: use /*< pdb-skip, skip >*/ for skipping
	in both picman-mkenums and enumgen.pl

	* app/core/core-enums.c: regenerated

2003-06-29  Michael Natterer  <mitch@picman.org>

	Getting rid of some legacy filenames:

	* app/core/Makefile.am
	* app/core/picmantooloptions.[ch]: new files.

	* app/paint/picmanpaintoptions.h: changed #include accordingly.
	#define PICMAN_PAINT_OPTIONS_CONTEXT_MASK here.

	* app/tools/paint_options.[ch]
	* app/tools/tool_options.[ch]: removed these files.

	* app/tools/picmanpaintoptions-gui.[ch]
	* app/tools/picmantooloptions-gui.[ch]: new files.

	* app/tools/picmanpainttool.h: removed PICMAN_PAINT_TOOL_OPTIONS_MASK
	define again.

	* app/tools/Makefile.am
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancoloroptions.[ch]
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancropoptions.[ch]
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanflipoptions.[ch]
	* app/tools/picmaninkoptions.c
	* app/tools/picmanmagnifyoptions.[ch]
	* app/tools/picmanmeasureoptions.[ch]
	* app/tools/picmanmoveoptions.[ch]
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanselectionoptions.[ch]
	* app/tools/picmansmudgetool.c
	* app/tools/picmantextoptions.[ch]
	* app/tools/picmantransformoptions.[ch]
	* app/tools/tool_manager.c
	* app/gui/tool-options-dialog.c: changed accordingly.

	* app/tools/tools.c: moved the vector tool before iscissors.

2003-06-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanvectorstreeview.c
	(picman_vectors_tree_view_toselection_extended_clicked): added
	missing picman_image_flush(). Fixes bug #116190.

2003-06-29  Manish Singh  <yosh@picman.org>

	* configure.in: fix --enable-default-binary

2003-06-28  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/pat.c: Save patterns with alpha
	channels, and remove warning while loading patterns
	with an alpha channel.

	* app/core/picmanpattern.c
	* app/core/picmandrawable-bucket-fill.c
	* app/paint/picmanclone.c: Make cloning from a pattern
	source, and bucket filling with a pattern, work when
	there's an alpha channel present in the pattern.

	I'm not particularly happy with this, because the only
	way to tell whether there's an alpha channel or not is 
	by the number of bytes in the TempBuf the clone and 
	bucketfill routines get passed, which is rather 
	restrictive. It would be nice if a TempBuf had a 
	_has_alpha () method.

2003-06-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.h: removed enum PicmanContextPropType and
	enum PicmanContextPropMask.

	* app/core/core-enums.[ch]: added them here.

	* app/core/picmantoolinfo.[ch]: replaced "gboolean tool_context"
	member by "PicmanContextPropMask context_props" so each tool can
	specify exactly which context properties it wants to have
	persistently remembered.

	* app/tools/tools-types.h: changed typedef PicmanToolRegisterCallback
	accordingly.

	* app/tools/tool_manager.[ch] (tool_manager_register_tool): ditto.

	Removed the "global_tool_context" and initialize all tool info
	objects from the user_context after creation. Removed the
	PAINT_OPTIONS_MASK #define and use the new context_props stored in
	tool_info insted.

	* app/tools/picmanpainttool.h: #define the common properties of the
	paint tools as PICMAN_PAINT_TOOL_OPTIONS_MASK (which is OPACITY |
	PAINT_MODE | BRUSH).

	* app/tools/[all tools].c (picman_*_tool_register): replaced the
	"use_context" boolean by the actual mask of context properties the
	tools need.

2003-06-27  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.py: Missing self. reference. Fixes #115714.

	* plug-ins/pypicman/picmanui.py: Move item.show() in Selector so that all
	items are shown. Fixes bug #115715. Thanks to Dave Corrie for catching
	both these.

	* plug-ins/pypicman/picmanfu.py: Always register as type PLUGIN, to
	reflect the recent changes in semantics.

	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py: s/extension/plug_in/ to 
	reflect above, for consistency.

	* plug-ins/pypicman/picmanfu.py: Add a fail method which uses
	picman.message and then raises an error.

	* plug-ins/pypicman/picmanmodule.c: remove declarations for
	picman_extension_ack and picman_extension_process, they are in picman.h.

	* plug-ins/pypicman/picmanfu.py
	* plug-ins/pypicman/picmanui.py
	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py: Added pygtk.require('2.0').
	Fixes bug #115545.

2003-06-28  Henrik Brix Andersen  <brix@picman.org>

	* app/gui/grid-dialog.c (cancel_callback): removed unneeded
	variable.

2003-06-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch] (picman_draw_tool_is_active): new
	function which returns (draw_tool->gdisp != NULL).

2003-06-27  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs.c (toplevel_entries): added an entry for the
	text tool editor.

	* app/tools/picmantexttool.c (picman_text_tool_editor): register
	the editor window with the dialog factory so it becomes
	session-menaged.

2003-06-27  Michael Natterer  <mitch@picman.org>

	* app/gui/grid-dialog.c: #include "config/picmanconfig.h"

2003-06-26  Sven Neumann  <sven@picman.org>

	* Made 1.3.16 release.

2003-06-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainergridview.c: select items on
	"button_press_event" not on "clicked". Makes the grid view behave
	like the list view and fixes bug #115797.

2003-06-26  Sven Neumann  <sven@picman.org>

	* app/gui/file-new-dialog.c (file_new_dialog_new): don't set the
	focus on the size_entry. This change allows to accept the default
	values by pressing OK. Fixes bug #115876.

2003-06-26  Michael Natterer  <mitch@picman.org>

	* app/gui/user-install-dialog.c (user_install_dialog_create):
	update copyright notice to "1995-2003". Fixes bug #116026.

2003-06-26  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: rewrote picman_bezier_stroke_extend
	for the case when the neighbor is not really an end point of the
	stroke, but close enough to the end to still be acceptable.

	* app/tools/picmanvectortool.c: Make the tool behave sanely
	and more symetrically (both ends of a stroke behave basically the
	same now), picman_draw_on_handle () now prefers the anchor passed
	into it via the *ret_anchor parameter over other preferred anchors.

2003-06-25  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-parasite.c (picman_text_from_gdyntext_parasite):
	attempt to convert text from locale encoding.

	* app/vectors/picmanvectors-compat.c (picman_vectors_compat_new):
	allow paths with zero points (bug # 115955).

	* plug-ins/script-fu/script-fu-server.c: if a connection to a
	client is lost, invalidate file descriptors in the command queue.
	Plugged a couple of memleaks.

2003-06-25  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-xlfd.[ch]: added convenience function
	picman_text_set_font_from_xlfd(). Improved and documented XLFD parsing.

	* app/text/picmantext-parasite.c: use the new function.

2003-06-25  Michael Natterer  <mitch@picman.org>

	* modules/cdisplay_colorblind.c (cdisplay_colorblind_load_state)
	* modules/cdisplay_gamma.c (cdisplay_gamma_load_state)
	* modules/cdisplay_highcontrast.c (cdisplay_contrast_load_state):
	picman_parasite_data() returns a pointer to const data now.

2003-06-25  Sven Neumann  <sven@picman.org>

	* configure.in: removed "id" from ALL_LINGUAS until all required
	po files have been added.

2003-06-25  Mohammad DAMT  <mdamt@bisnisweb.com>

	* po/id.po: Added Indonesian translation
	* configure.in: Added "id" to ALL_LINGUAS

2003-06-25  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: If an control handle gets
	converted to an edge simply move it to its next anchor.

	* app/tools/picmanvectortool.c: Improved interactive handling
	of vectors. Still work in progress, esp. I am not sure about
	the assignment of the modifier keys. Right now it is:

	   Drag (Anchor/Handle): Regular Movement
	   Shift-Click (Anchor): select multiple anchors (does not work yet)
	   Shift-Drag: (Handle): move opposite handle symmetrically
	   Ctrl-Drag (Anchor): Drag out control point
	   S-C-Click: (Anchor/Handle): Convert to Edge

2003-06-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.[ch]: added new function
	picman_config_serialize_to_fd() for the sake of completeness and
	since it's a nice way to generate debugging output.

	* app/text/Makefile.am
	* app/text/picmantext-xlfd.[ch]: new files with routines to handle X
	Logical Font Descriptions in an attempt to improve backwards
	compatibility.

	* app/text/picmantext-parasite.[ch]
	* app/xcf/xcf-load.c: promote layers with GDynText parasite to
	PicmanTextLayer. Work in progress, we need to improve font matching.

2003-06-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_select_item): put back the hack which
	calls gtk_tree_selection_select_iter() in addition to
	gtk_tree_view_set_cursor() until bug #115871 is fixed.

2003-06-24  Sven Neumann  <sven@picman.org>

        Added persistent storage of text layers in XCF files. We use a 
	parasite in order to keep the file format backwards compatible.
	Fixes bug #111781.

	* app/text/Makefile.am
	* app/text/picmantext-parasite.[ch]: new files that hold functions
	to convert a PicmanText object to a PicmanParasite and back.
	
	* app/text/picmantextlayer.[ch]: added an ugly hack that allows to
	convert a normal layer to a text layer.

	* app/xcf/xcf-save.c: when saving a text layer, store an extra
	parasite that holds all information about the text. 

	* app/xcf/xcf-load.c: if a "picman-text-layer" parasite is found and
	it can be successfully deserialized to a PicmanText object, convert
	the layer to a text layer and remove the parasite.

	* app/Makefile.am: had to change linkage order.

	* devel-docs/parasites.txt: documented the new "picman-text-layer"
	parasite.

	* app/gui/session.c (session_save): plugged a minor memory leak.

2003-06-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanscanner.c: store file descriptor and filename in
	a private struct instead of using internals of GScanner. Should
	fix problems on Win32 reported by Hans Breuer.

2003-06-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/spyropicman.scm
	* plug-ins/script-fu/scripts/trochoid.scm: replaced Trochoid
	script with the more advanced Spyropicman (bug #115290).

	* plug-ins/script-fu/scripts/grid-system.scm: renamed menu entry.

2003-06-24  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: changed the maximum preview
	dimensions in picman_image_get_thumbnail() to the limit implied by
	the core preview system (PICMAN_VIEWABLE_MAX_PREVIEW_SIZE). Fixes
	bug #115464.
	
	* libpicman/picmanimage_pdb.c
	* app/pdb/image_cmds.c: regenerated.

2003-06-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_image_grid)
	* app/core/picmanimage.c (picman_image_set_grid): ref/unref the grid.

	* app/gui/view-commands.c (view_configure_grid_cmd_callback): set
	the dialog transient for the shell, make shell->grid_dialog a
	weak pointer of the grid dialog.

	* app/gui/grid-dialog.c: don't set shell->grid_dialog to NULL
	here, attach the grid using g_object_set_data_full() and don't
	unref it explicitely. Use picman_config_is_equal_to() instead of
	picman_config_diff().

2003-06-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/grid.c (dialog): update the preview when the
	intersection color changes.

2003-06-24  Henrik Brix Andersen  <brix@picman.org>

	* app/core/picmangrid.[ch]: derive PicmanGrid from PicmanObject (not
	GObject) allowing us to use picman_object_get_memsize(). Added
	missing copyright notice.

	* app/core/picmanimage.c: only call picman_object_get_memsize() if
	gimage->grid != NULL.

	* app/gui/grid-dialog.c: added mnemonics, set shell->grid_dialog
	to NULL when destroyed.

	* app/gui/view-commands.c (view_configure_grid_cmd_callback):
	added call to gtk_window_present()

	* app/core/picmanimage-undo-push.c (undo_pop_image_grid): removed
	superflous call to picman_image_grid_changed().
	
2003-06-23  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.[ch]
	* app/config/picmanconfigwriter.[ch]
	* app/config/picmanscanner.[ch]: added support for serializing to
	and deserializing from strings. Had to do some smaller changes to
	the PicmanConfig API.

	* app/config/test-config.c: added a simple test for the new
	functions.

	* app/config/picmanconfig-dump.c
	* app/config/picmanrc.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picmanunits.c
	* app/gui/session.c
	* app/plug-in/plug-in-rc.c
	* app/tools/tool_options.c
	* app/widgets/picmandevices.c: follow PicmanConfig API changes.

	* libpicmanbase/picmanparasite.[ch]: declared the return value of
	picman_parasite_data() as gconstpointer.

2003-06-23  Henrik Brix Andersen  <brix@picman.org>

	Added a per image configurable grid.  This fixes bug #65198.
	
	* app/core/Makefile.am
	* app/core/core-types.h: 
	* app/core/picmangrid.[ch]: added new class PicmanGrid.

	* app/core/core-enums.[ch]: added new enum PicmanGridType.

	* app/core/picmanimage-guides.[ch]: removed the picman_image_snap_*()
	functions...

	* app/core/picmanimage-snap.[ch]: ...and added them here since they
	are no longer guide specific.
	
	* app/core/picmanimage-undo-push.[ch]: added
	picman_image_undo_push_image_grid()

	* app/display/picmandisplayshell-handlers.c:
	* app/core/picmanimage.[ch]: added grid member to _PicmanImage. Added
	new signal "grid_changed", added picman_image_grid_changed(),
	picman_image_get_grid() and picman_image_set_grid().

	* app/display/picmandisplayshell-appearance.[ch]: added
	picman_display_shell_set_show_grid(),
	picman_display_shell_get_show_grid(),
	picman_display_shell_set_snap_to_grid() and
	picman_display_shell_get_snap_to_grid().

	* app/display/picmandisplayshell-callbacks.c: added call to
	picman_display_shell_draw_grid()
	
	* app/display/picmandisplayshell.[ch]: added grid member to
	_PicmanDisplayShellVisibility, added snap_to_grid and grid_dialog
	members to _PicmanDisplayShell, added
	picman_display_shell_draw_grid(), modified
	picman_display_shell_snap_coords() to use the new
	picman_image_snap_*() functions.

	* app/gui/image-menu.c: added grid entries to
	image_menu_entries[].
	
	* app/gui/view-commands.[ch]: added
	view_configure_grid_cmd_callback(),
	view_toggle_grid_cmd_callback() and
	view_snap_to_grid_cmd_callback().

	* app/gui/Makefile.am
	* app/gui/grid-dialog.[ch]: added a grid dialog.

2003-06-23  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.[ch]: added separate GMainLoops for waiting
	for extension_ack and for procedure_run's return value. The stack
	of main loops is currently unused, it will be used for temp_proc
	return values (which are currently disabled for no good reason).
	Removed the boolean "recurse" and "starting_ext" states because
	they are redundant now (we check for the presence of the dedicated
	main loops instead).

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-run.c: changed accordingly.

2003-06-23  Sven Neumann  <sven@picman.org>

	* data/misc/picman.desktop.in.in: announce the fact that we
	understand URI lists as command-line parameters.
	
2003-06-23  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c (app_init): enabled passing of file: URIs
	as command line parameters.

2003-06-23  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* data/misc/Makefile.am: renamed --with-gnome-datadir configure
	option to --with-desktop-dir because it is not GNOME specific.

	* configure.in: removed "sr" and "sr@Latn" from ALL_LINGUAS until
	all required po files have been added.

2003-06-23  Danilo ÃÂ egan  <dsegan@gmx.net>

	* configure.in: Added "sr" and "sr@Latn" to ALL_LINGUAS.

2003-06-23  Sven Neumann  <sven@picman.org>

	* configure.in: simplified exif check by using PKG_CHECK_MODULES().

	* plug-ins/common/mkgen.pl: allow for multiple library dependencies.

	* plug-ins/common/plugin-defs.pl: added exif dependency to the
	jpeg plug-in.

	* plug-ins/common/Makefile.am: regenerated.

2003-06-22  Dave Neary  <bolsh@picman.org>

	* configure.in
	* plug-ins/common/Makefile.am
	* plug-ins/common/jpeg.c: Added support for the keeping of EXIF
	information in jpeg files. This is step 1 in the overall plan to
	an all-singing, all-dancing metadata editor. Next step is to do
	the same thing for TIFFs, then to do both properly as a number of
	parasites rather than one big one, and then to allow a generic
	metadata editor, as well as (possibly) adding a nice way to
	manipulate exif data in the jpeg plug-in while saving.

	This is a modified patch of one posted to the devel list by Lutz 
	Muller in February 2002, and subsequently added to bug #56443. 
	Sorry it took so long Lutz.

2003-06-22  Dave Neary  <bolsh@picman.org>

	* app/config/picmanbaseconfig.c: Increased default tile cache size
	to 64 MB.

2003-06-22  Sven Neumann  <sven@picman.org>

	* data/misc/picman.desktop.in.in: added Encoding, StartupNotify and
	Bugzilla entries.

2003-06-22  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: an updated version of PotatoShop keybindings
	contributed by Eric Pierce <epierce@sdf.lonestar.org>.

2003-06-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: disable workarounds for
	bugs #110737 and #108956 for GTK+ >= 2.2.2. Will remove them as
	soon as we depend on 2.2.2.

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_select_item): disabled optimization
	which didn't select an already selected iter because it broke the
	fix for #108956. Cleanup.

2003-06-21  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c (picman_hsv_to_rgb_int): removed
	calls to ROUND() in two places where they should not have been
	added. Fixes bug #115626.

2003-06-20  Dave Neary  <bolsh@picman.org>

	* app/config/picmandisplayconfig.c: Enable menus on image windows by
	default.

2003-06-20  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/message.pdb (message): use
	plug_in_get_undo_desc() instead of duplicating its code.

	* app/pdb/message_cmds.c: regenerated.

2003-06-20  Michael Natterer  <mitch@picman.org>

	* app/gui/plug-in-commands.c (plug_in_run_cmd_callback): pass the
	gdisp_ID to plug_in_run() again. Broke this with my last commit...

2003-06-20  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c (picman_config): fixed error messages.

	* app/widgets/picmanwidgets-utils.c (picman_message_box): use a
	selectable label so you can copy from message dialogs.

2003-06-20  Michael Natterer  <mitch@picman.org>

	Really commit the changes this time:

	* configure.in: bumped version number to 1.3.16.

	* libpicmanbase/picmanprotocol.h: increased protocol version number so
	old extensions will refuse to load.

2003-06-19  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch]: documentation fixes.

2003-06-19  Michael Natterer  <mitch@picman.org>

	Changed the semantics of PICMAN_EXTENSION and (to some extent)
	of PICMAN_PLUGIN:

	The old meaning of EXTENSION was "I live in the toolbox" and
	PLUGIN meant "I take RUN-MODE,IMAGE,DRAWABLE args (but only if I
	am invoked interactively)". This is completely useless, since
	living in the toolbox means having "<Toolbox>" in the menu_path
	and taking RUN-MODE,IMAGE,DRAWABLE means just that, regardless of
	what type of procedure we are.

	The new meaning of PICMAN_PLUGIN is just "I am an ordinary procedure,
	I am invoked, do my job and finish", while PICMAN_EXTENSION means
	"I will install temporary procedures and I will keep running to
	keep them available".

	(A PICMAN_EXTENSION *must* call picman_extension_ack() now to tell the
	core that it's ready to run, or the core will block waiting for
	the message !!!).

	* configure.in: bumped version number to 1.3.16.

	* libpicmanbase/picmanprotocol.h: increased protocol version number so
	old extensions will refuse to load.

	* app/gui/plug-in-commands.c (plug_in_run_cmd_callback): don't
	blindly pass RUN-MODE,IMAGE,DRAWABLE to PICMAN_PLUGIN procedures but
	look at their parameters and pass them either RUN-MODE, or
	RUN-MODE,IMAGE, or RUN-MODE,IMAGE,DRAWABLE.

	* app/pdb/procedural_db.c: cleaned up, better error reporting,
	replaced an impossible error message by g_return_if_fail()

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install):
	better error messages.

	* app/plug-in/plug-in-params.c: allocate parameter arrays using
	g_new0() so we don't have to worry about uninitialized stuff
	later.

	* app/plug-in/plug-in-run.c (plug_in_run): wait for
	picman_extension_ack() installation confirmation for ALL extensions,
	not just for automatically started ones.

	* app/plug-in/plug-ins.c: cleanup.

	* libpicman/picman.[ch]: cleaned up and API-documented massively. Made
	all magic values given in the GPConfig message static and added
	accessor functions for them. Added picman_tile_width()/height().
	Added new function picman_extension_enable() which turns on
	asynchronous processing of temp_proc run requests without having
	to enter an endless picman_extension_process() loop. Moved all
	private functions to the end of the file. Added tons of
	g_return_if_fail() all over the place.  Call picman_run_procedure2()
	from picman_run_procedure() instead of duplicating the
	code. Indentation, spacing, stuff...

	* libpicman/picmantile.[ch]: removed picman_tile_width()/height().

	* libpicman/picmandrawable.c
	* libpicman/picmanpixelrgn.c
	* libpicman/picmantile.c: use the picman_tile_width()/height() accessor
	functions.

	* libpicman/picman.def: added picman_extension_enable.

	* libpicman/picmanmenu.c: removed evil code which connected to
	_readchannel manually and use picman_extension_enable() for watching
	temp_procs.

	* plug-ins/helpbrowser/helpbrowser.c: removed the same evil code
	here and call picman_extension_enable(). Call picman_extension_ack()
	to let the core know that the temp_proc is installed.

	* plug-ins/script-fu/script-fu.c: made all procedures except the
	permanently running "extension_script_fu" ordinary PICMAN_PLUGIN
	procedures.

	* plug-ins/common/curve_bend.c
	* plug-ins/common/plugindetails.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/winclipboard.c
	* plug-ins/dbbrowser/dbbrowser.c
	* plug-ins/gfli/gfli.c
	* plug-ins/twain/twain.c
	* plug-ins/webbrowser/webbrowser.c
	* plug-ins/winsnap/winsnap.c: made them all ordinary PICMAN_PLUGIN
	procedures and renamed them from "extension_*" to "plug_in_*".
	Random cleanups.

	* app/widgets/picmanhelp.c
	* plug-ins/maze/maze_face.c: call "plug_in_web_browser" now.

2003-06-19  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmenu.c: when idle dispatching calls to plug-ins, use
	the data from the last call, not the first one. This fixes some
	weird behaviour that the brush/font/gradient/pattern selection
	widgets showed under certain circumstances.

	* plug-ins/gfig/gfig.c (select_brush_callback): removed debugging
	output that I forgot to remove before my last commit.

2003-06-19  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/film.c
	* plug-ins/script-fu/script-fu-scripts.c: adapt to libpicman API
	changes.

2003-06-19  Hans Breuer  <hans@breuer.org>

	* makefile.msc : replace the win9x specific cd ....
	with the portable cd ..\..\..

	* **/makefile.msc : updated

	* plug-ins/xjt/xjt.c plug-ins/common/psd_save.c :
	there is still no unistd.h with msvc build

2003-06-17  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: raise the brush selection dialog if there
	is one already; various code cleanups. Fixes #82475.

2003-06-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/select-to-brush.scm: added a missing
	call to picman-drawable-fill for the RGB case. Fixed description,
	restore selection and delete the temporary channel. Fixes bug
	#115350.

2003-06-17  Sven Neumann  <sven@picman.org>

	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanmenu.h: minor cleanups.

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanpatternmenu.c: destroy the popup window instead of
	hiding it on button_release.

2003-06-17  Sven Neumann  <sven@picman.org>

	* app/gui/brush-select.c (opacity_scale_update): update the
	BrushSelect "object" when the brush opacity is changed.

	* libpicman/picmanmenu.[ch]
	* libpicman/picmanbrushmenu.c
	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpatternmenu.c: raise selection dialogs when being
	called again, marked strings for translation, added lots of const
	qualifiers, cleaned up code.

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/patterns.pdb: use g_memdup() instead of
	g_memmove().

	* app/pdb/brushes_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/patterns_cmds.c: regenerated.

2003-06-16  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/gif.c: Attempt to use the palette colour
	closest to that of the PICMAN's current brush background colour
	for the GIF file's background index hint for non-transparency-aware
	image viewers.  NOTE that this is merely a hint and may be
	ignored by this plugin for various (rare) reasons that
	would usually entail writing a somewhat larger image file.

2003-06-16  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c: Applied a patch from S. Mukund
	<muks@mukund.org> fixing rounding problems that caused bug #55261.

2003-06-16  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush_select.pdb (brush_args): don't fail on
	brush_spacing values < 0, but behave as documented (use the
	brush's own spacing).

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb

	* tools/pdbgen/pdb/pattern_select.pdb: gtk_window_present() the
	dialog on each set_popup(). This way the dialogs can be risen via
	the PDB by setting the already selected object. Replaced
	unreadable variable names by verbose ones.

	* app/pdb/brush_select_cmds.c
	* app/pdb/font_select_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/pattern_select_cmds.c: regenerated.

2003-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: minor GUI cleanups.

2003-06-16  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/psd.c: Avoid memory corruption when things
	get shot to hell in the image unpacking phase.

2003-06-16  Sven Neumann  <sven@picman.org>

	* app/gui/file-open-dialog.c (file_open_dialog_set_type): don't
	call file_dialog_update_name() here. Fixes bug #112273.

2003-06-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c: minor cleanups.
	(struct dbbrowser_t): use PicmanDBBrowserApplyCallback type instead
	of duplicating its signature when specifying the "apply_callback"
	member.  Minor cleanups

2003-06-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_find_scripts):
	use picman_datafiles_read_directories() instead of doing the same
	manually.

	* plug-ins/script-fu/siod-wrapper.c (siod_init): s/gint/gboolean/.

2003-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c
	(script_fu_console_interface): set focus on the entry widget.

2003-06-14  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_entries): removed duplicate of
	Threshold menu entry.

2003-06-13  Sven Neumann  <sven@picman.org>

	* app/gui/info-window.c
	* libpicmancolor/picmancolorspace.c
	* libpicmancolor/picmanrgb.c
	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c: use ROUND() where appropriate.

	* libpicmanwidgets/picmancolorarea.c (picman_color_area_render): use
	picman_rgb_get_uchar().

2003-06-13  Michael Natterer  <mitch@picman.org>

	Cleaned up and improved the message system:

	* app/core/picman.[ch]: added "const gchar *domain" to
	PicmanMessageFunc (a NULL domain means the message is from the PICMAN
	core, everything else is a plug-in).

	* app/errors.c: pass "domain == NULL" to picman_message().

	* tools/pdbgen/pdb/message.pdb: derive the message domain from the
	current plug-in's menu_path (evil hack but works reasonably well).

	* app/pdb/message_cmds.c: regenerated.

	* app/widgets/picmanwidgets-utils.[ch] (picman_message_box): added a
	header showing the message domain and changed the dialog layout to
	follow the HIG more closely.

	* app/gui/error-console-dialog.[ch]: removed.

	* app/widgets/picmanerrorconsole.[ch]
	* app/gui/error-console-commands.[ch]
	* app/gui/error-console-menu.[ch]: new files containing a
	re-implementation of the error console dialog.

	* app/gui/Makefile.am
	* app/gui/dialogs-constructors.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h: changed accordingly.

	* app/display/picmanprogress.c: added more spacing and removed the
	separator (more HIG compliant).

	* plug-ins/[most plug-ins].c: Changed lots of messages and
	progress strings:

	- Removed plug-in names from messages since that's automatically
	  covered by "domain" now.
	- Put all filenames in ''.
	- Changed "Loading" to "Opening".
	- Added "..." to all progress messages.
	- Cleaned up all file open/save error messages to look the
	  same and include g_strerror(errno).
	- Removed special casing for progress bars and *always* show them,
	  not only if run_mode != PICMAN_RUN_NONINTERACTIVE (we can't expect
	  all plug-ins to do this correctly but need to hack the core to
	  sort out unwanted progress bars).

	Unrelated:

	- Cleaned up indentation, spacing, #includes, coding style and
	  other stuff while I was at all these files.

2003-06-13  Sven Neumann  <sven@picman.org>

	* app/gui/file-save-dialog.c (file_save_ok_callback): removed
	code for the slimy-easter-egg that was unveiled some time ago.

2003-06-13  Sven Neumann  <sven@picman.org>

        Attempt to finally fix Smudge tool problems (bug #115057):

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels): added an
	implementation for the non-alpha case.

	* app/paint/picmansmudge.c (picman_smudge_start): added back code that
	used to prefill the buffer if the inital area was clipped.

2003-06-13  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c (picman_template_create_image): fixed a
	typo I introduced yesterday.

2003-06-12  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/tga.c: Applied a patch from Yohei Honda
	<yoh2@d2.dion.ne.jp> to handle 16 bit TGAs which use the
	spare bit to do alpha. Closes bug #114913.

2003-06-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_configure): removed the
	check again because adding e.g. GRAY drawables to RGB images is
	prefectly ok as long as they are channels/masks.

2003-06-12  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.c (picman_drawable_configure): check if the
	drawable type fits to the image. This assertion would have catched
	the problem below.

	* app/core/picmantemplate.c (picman_template_create_image): handle all
	fill types, fixes bug #114979.

2003-06-11  Sven Neumann  <sven@picman.org>

	* app/gui/info-window.c
	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c: applied some slightly modified
	patches from Michael Bushey that fix rounding errors when
	converting between color values in gdouble and guchar
	representation (bug #109241).

	* libpicmancolor/picmancolorspace.c
	* libpicmancolor/picmanrgb.c: similar fixes here.

2003-06-11  Michael Natterer  <mitch@picman.org>

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: removed "tool-plug-in-path" property.

	* app/gui/preferences-dialog.c: changed accordingly. Some
	preparation for more HIG compliance.

2003-06-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorselect.c: handle all mouse buttons
	equally, cleaned up code, fixed return values from event handlers.

2003-06-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_mask_bounds): added some
	more g_return_if_fail() to avoid NULL pointer dereferencing.

2003-06-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/pnm.c (pnm_load_raw): improved handling of
	invalid PGM files by clamping all pixel values to the specified
	maximum value (see Debian bug #195066).

2003-06-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox.[ch]: added a container that keeps
	references to the buttons which are not added to the wrap box.
	Just to make sure they are destroyed on exit.

2003-06-11  Sven Neumann  <sven@picman.org>

	* etc/Makefile.am
	* etc/sessionrc: added a sample sessiorc which will be used after
	user installation.
	
	* app/gui/user-install-dialog.c (tree_items): install the sample
	sessionrc.

2003-06-11  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels): fixed my
	latest fix. Fixes bug #114882.

2003-06-10  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: added utility function
	picman_rgb_get_gdk_color(), documented picman_get_screen_resolution().

	* app/widgets/picmanpreviewrenderer.c
	(picman_preview_renderer_set_border_color)
	* app/display/picmandisplayshell-appearance.c
	(picman_display_shell_set_padding): use the new function.

2003-06-10  Sven Neumann  <sven@picman.org>

	* app/gui/tools-commands.c (tools_select_cmd_callback): expects
	the tool identifier as a GQuark now.

	* app/gui/image-menu.c: changed accordingly. Removed code that
	used to move the menu entries for the color correction tools to
	the Layers menu. Added the respective menu entries by hand. Added
	a menu entry for arbitrary rotations and one for Select by Color.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: register the color correction
	tools in the Tools menu.

	* app/tools/picmantransformtool.c: added an initialize method and
	moved most initalization code from button_press to this place.

2003-06-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/film.c: treeviewized and undeprecated. Enabled
	multiple selection and DND reordering.

2003-06-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/coffee.scm: added an undo group
	around all operations.

	* plug-ins/script-fu/scripts/distress-selection.scm: replaced
	undo disable/enable by an undo group.

	Together fixes bug #114493. Removed weird spacing and indented
	both scripts to make them readable.

2003-06-09  Sven Neumann  <sven@picman.org>

	* Made 1.3.15 release.

2003-06-09  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/Makefile.am: use automake conditionals for
	subdirectories so that they will always be included in the
	tarball.
	
2003-06-09  Sven Neumann  <sven@picman.org>

	* app/paint/picmansmudge.c (picman_smudge_start): now that
	blend_pixels() behaves correctly, we can simply initialize the
	smudge buffer with transparent pixels.

2003-06-09  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels): weight
	pixels by their alpha value. Fixes the smudge tool (bug #72879).

2003-06-09  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_interface):
	use a PicmanScaleEntry for SF_SLIDER adjustments (bug #114509).

2003-06-08  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_csim_parse.h
	* plug-ins/imagemap/imap_csim_lex.c: regenerated. Should now finally
	fix #113445.
	
	* plug-ins/imagemap/Makefile.am: Added rules for regenerating 
	csim_xxx_parse.h files.

2003-06-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfontselection-dialog.c
	(picman_font_selection_dialog_new): pack the main table expanding,
	not shrinking. Fixes bug #114656.

2003-06-06  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanmemsizeentry.c: added a default spacing of
	two pixels between the entry end the menu. Random cleanups.

2003-06-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmantoolbox-dnd.[ch]: new files containing the
	toolbox' drop callbacks. Exports picman_toolbox_dnd_init().

	* app/widgets/picmantoolbox.c: removed the callbacks and all the
	"core/" includes they needed and call picman_toolbox_dnd_init().

2003-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmantoolinfo.[ch]: added "in_toolbox"; defaults to TRUE.

	* app/tools/tool_manager.c: set "in_toolbox" to FALSE for tools
	derived from PicmanImageTool.

	* app/widgets/picmantoolbox.c: respect the new flag when constructing
	the toolbox.

2003-06-06  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-smudge-16.png
	* themes/Default/images/tools/stock-tool-smudge-22.png: make it
	more clear it's a smudge tool, not a path tool.

2003-06-06  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c (confirm_save_dialog): fixed button order.

2003-06-06  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/message.pdb: UTF-8 validate messages before
	passing them to g_message().

	* app/pdb/message_cmds.c
	* libpicman/picmanmessage_pdb.c: regenerated.

2003-06-06  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/script-fu/scripts/addborder.scm: fix for #114495
	(Script-Fu: Add Border can't be (complete) undone.)

2003-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c (gfig_save_callbk): fixed broken usage of
	g_strconcat() that caused a crash (bug #114564).

2003-06-06  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: moved the convenience items which
	create new docks from the "Dialogs/" level to a new
	"Dialogs/Create New Dock/" sub-menu.  Fixes bug #111278.

	* app/gui/dialogs-commands.[ch] (dialogs_create_data_cmd_callback):
	new convenience constructor callback. Factored out duplicated
	code to the new dialogs_create_dock() utility function.

2003-06-06  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c: added CW/CCW to the "Rotate" menu entries
	as suggested in bug #57797. Cleaned up image_menu_update().

2003-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CML_explorer.c (CML_save_to_file_callback): use
	gtk_window_present() instead of reimplementing its functionality.

2003-06-06  Maurits  <lpeek.mrijk@consunet.nl>

	* plug-ins/script-fu/scripts/old-photo.scm: fix for #114496
	(Script-Fu: Old Photo can't be completely undone)

	* plug-ins/common/CML_explorer.c: fix for #83947 (CML explorer: 
	multiple instantiations of Load Parameters dialog)

2003-06-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_set_label):
	use gtk_label_set_text_with_mnemonic() instead of just
	gtk_label_set_text().

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: added mnemonics for all sub-menus.
	Fixes bug #106991.

	* app/gui/image-menu.c: cleaned up the "Layers" menu: moved
	sub-menus together. Changed the "Stack" menu's labels and
	accelerators and added "Select Top/Bottom Layer" for consistency
	(bound to Home/End).

	* app/gui/layers-commands.[ch]: changed accordingly. Added the
	new select top/bottom callbacks.

2003-06-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmancolortool.c: removed unneeded includes.

	* app/tools/picmancurvestool.c: simplified by using the functions
	inherited from PicmanColorTool.

2003-06-05  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.c (picman_drawable_get_color_at):
	* app/core/picmanimage-projection.c (picman_image_projection_get_color_at):
	use OPAQUE_OPACITY instead of 255.

	* app/core/picmanimage-pick-color.[ch]: factored out code that
	averages over colors so it can be used from PicmanImageTool.

	* app/tools/picmanimagemaptool.[ch]: derived from PicmanColorTool and
	added a PicmanColorTool::pick implementation.

	* app/tools/picmancoloroptions.c
	* app/tools/picmancolorpickeroptions.c: add the toggle for
	"sample_merged" in picman_color_picker_options_gui().

	* app/tools/picmancolortool.c (picman_color_tool_cursor_update): check
	if the cursor is over the active drawable or if "sample_merged" is
	active.

	* app/tools/picmanlevelstool.c: simplified since all color-picking is
	now handled by the parent classes. Fixes bug #112668.

2003-06-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmancoloroptions.c: changed the default radius.

	* app/tools/picmancolortool.[ch]: pass PicmanColorOptions to
	picman_color_tool_enable(). Added picman_color_tool_disable() and
	picman_color_tool_is_enabled().

	* app/tools/picmancolorpickertool.c: changed accordingly.

	* app/tools/picmanpainttool.[ch]: derived PicmanPaintTool from
	PicmanColorTool and removed most color picking code.

	* app/tools/picmandodgeburntool.c (picman_dodgeburn_tool_modifier_key)
	* app/tools/picmanerasertool.c (picman_eraser_tool_modifier_key):
	chain up to the parent class.

	* app/tools/picmanpaintbrushtool.c: purely cosmetic change.

2003-06-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_bounds): always return
	channel->x1,y1,x2,y2, *not* tx1,ty1,tx2,ty2 since the latter
	contain bogus values if the mask is empty. Fixes bug #114419.

	* plug-ins/script-fu/scripts/unsharp-mask.scm: cleaned up
	while searching the bug.

2003-06-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/predator.scm (script-fu-predator): 
	moved picman-undo-push-group-end to the end of the script.
	Fixes bug #114416.

2003-06-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanmarshal.list: added VOID: ENUM, BOXED, INT.

	* app/tools/picmancolortool.[ch]: added a default implementation for
	PicmanColorTool::pick. Emit a "picked" signal when a color was
	successfully picked.

	* app/tools/picmancolorpickertool.c: simplified a lot since
	PicmanColorTool does most of the work for us now. 

2003-06-04  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): undraw the cursor on
	GDK_PROXIMITY_OUT. Always set shell->proximity to FALSE *before*
	calling picman_display_shell_update_cursor().

2003-06-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/film.c: use a font selection widget (bug #113884).

2003-06-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-pick-color.[ch]: reordered arguments.

	* app/tools/picmancolorpickertool.c
	* app/tools/picmanpainttool.c: changed accordingly.

2003-06-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/film/film.c: moved the "Reset" button to the "Advanced"
	page since it only resets this page. Fixed widget packing and
	spacing. Added more stock icons and mnemonics. Cleanup.

2003-06-04  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmancoloroptions.[ch]
	* app/tools/picmancolortool.[ch]: new files that implement base
	classes moved out of PicmanColorPickerOptions and PicmanColorPickerTool.

	* app/tools/picmancolorpickeroptions.[ch]
	* app/tools/picmancolorpickertool.[ch]: derive from the new obejcts.

	* app/tools/picmanimagemaptool.h
	* app/tools/picmanpainttool.c
	* app/tools/tools-types.h: moved typedefs into the types file.

2003-06-04  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_reconnect):
	call picman_display_shell_scale_setup() instead of
	picman_display_shell_shrink_wrap() so window size, zoom factor and
	scroll offsets are preserved across File->Revert if possible.
	Fixes bug #114383.

2003-06-04  Sven Neumann  <sven@picman.org>

	* plug-ins/xjt/xjt.c: applied a patch from Wolfgang Hofer that
	makes the plug-in use locale-independant code to convert floats to
	strings and back.

2003-06-03  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-compat.c (text_get_extents): need to get
	ascent and descent from a PangoLayoutLine. Report negative descent
	so the function behaves like it used to in 1.2.

2003-06-03  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-path-16.png
	* themes/Default/images/stock-path-22.png
	* themes/Default/images/stock-paths-16.png
	* themes/Default/images/stock-paths-22.png: make distinct

2003-06-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-rotate.c (picman_image_rotate_item_offset):
	fixed offset calculation for 90 and 270 degree rotations.

	* app/core/picmanimage-flip.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c: increase the progress also when
	transforming the selection. Makes the progress appear more
	continuous. Also cleaned up and simplified the progress code
	in all files.

	* app/core/picmanimage-resize.[ch]: added a progress like in the
	files above.

	* app/gui/image-commands.c (image_resize_callback): changed
	accordingly.

	(image_scale_implement): clened up and simplified a lot.

	* tools/pdbgen/pdb/image.pdb: changed accordingly.

	* app/pdb/image_cmds.c: regenerated.

2003-06-03  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/gifload.c: When initializing the LZW state,
	watch out for a completely bogus input_code_size [based on fix
	by Raphael Quinet]  Also, fix a stupid old bug when clearing the
	code table between subimages.  (Enables us to deal better with errors
	when the stream is corrupted pretty early in a subimage.) [me]

2003-06-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanvectorstreeview.h
	* app/widgets/widgets-types.h: moved function definitions to the
	widgets-types header file.

	* app/gui/dialogs-constructors.c
	* app/widgets/picmanselectioneditor.[ch]: added a "Selection to
	Path" button as suggested in bug #112448.

2003-06-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_scale, resize): make sure
	channels end up at (0, 0) after scaling and resizing.
	Fixes bug #114213.

2003-06-02  Michael Natterer  <mitch@picman.org>

	Implemented DISSOLVE_MODE the way it should have always been.
	Fixes bug #107402.

	* app/paint-funcs-generic.h (struct apply_layer_mode_struct): added
	"guchar *mask" so it can be used by the layer mode.

	(dissolve_pixels): take an additional "mask" parameter and
	dissolve the pixels according to the *combined* opacity of the
	pixel's alpha, the opacity and the mask. Removed a wrong comment
	about why we call g_rand_int() x times before we start to use its
	values.

	(layer_dissolve_mode): pass the mask to dissolve_pixels(). No need
	to call add_alpha_pixels() since we overwrite the dest buffer
	entirely in dissolve_pixels().

	* app/paint-funcs.c (initial_sub_region, combine_sub_region):
	allocate the buffer large enough for DISSOLVE (which always needs
	an alpha channel). Pass the mask to the layer mode functions.
	Discard opacity and mask after applying DISSOLVE since it
	"consumes" all transparency.

2003-06-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/grid.c: fixed swapped horizontal/vertical
	parameters (bug #114225). Always update the preview as soon as a
	grid parameter is changed.

2003-05-31  Tor Lillqvist  <tml@iki.fi>

	* plug-ins/Makefile.am: Handle twain and winsnap subdirs normally.

	* configure.in: Set TWAIN and WINSNAP on Win32. Expand
	Makefiles in these dirs.

	* plug-ins/twain/Makefile.am
	* plug-ins/winsnap/Makefile.am: New files, from stable branch.
	
	* plug-ins/winsnap/winsnap.c: Make it build with GTK2.

	* README.win32: Update.

	* plug-ins/makefile.cygwin
	* plug-ins/makefile.mingw.in: Remove. Unmaintained for a long time.

	* app/picman.sym: Remove. No picman library uses symbols from the
	picman executable any longer, says Mitch.

	* app/Makefile.am: Remove related stuff from here, too.

2003-05-31  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.[ch]: added enum PicmanTransformType which
	can be one of { LAYER, SELECTION, PATH }

	* app/tools/picmantransformoptions.[ch]: added a PicmanTransformType
	property to PicmanTransformOptions. Added a GUI for the new
	option.

	* app/tools/picmanflipoptions.[ch]: derive it from
	PicmanTransformOptions and add the GUI here, too.

	* app/tools/picmanfliptool.c
	* app/tools/picmantransformtool.[ch]: added support for transforming
	the selection. Added framework for transforming paths (still
	unimplemented).

	* app/tools/picmanselectionoptions.c: small cleanup.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-path-16.png
	* themes/Default/images/stock-path-22.png
	* themes/Default/images/stock-selection-16.png: new icons for the
	new transform options buttons. Simply copied existing ones...

2003-05-30  Tor Lillqvist  <tml@iki.fi>

	* configure.in: As picman uses fontconfig directly, check for it.

	* app/Makefile.am: And link with it.

	* app/picman.sym: Remove dead symbols.

	* libpicman/picman.def
	* libpicmanwidgets/picmanwidgets.def: Move picman_standard_help_func.

	* plug-ins/common/wmf.c (load_image): Remove the message asking
	the user to send files with unhandled opcodes to me. I'm really
	not interested in getting them currently... (BTW, the wmf plug-in
	really should be rewritten to use libwmf.)

	* plug-ins/xjt/xjt.c: Use _mkdir() on Win32.

2003-05-30  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/gflare/gflare.c: fixed type in mnemonics for edit dialog 
	and removed unused typedef.

2003-05-30  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/common/film.c (film_dialog): fix for #113882 (Clean-up Film 
	plug-in interface). Also added mnemonics to UI + minor code clean-up.

2003-05-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c
	(picman_edit_selection_tool_button_release): don't stop the active
	tool, the tool manager did this already when the edit-selection
	tool was pushed.

2003-05-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lic.c: removed the possibility to let the
	plug-in create a new image (see bug #113615).

2003-05-29  Michael Natterer  <mitch@picman.org>

	* app/main.c (main): removed the calls to g_log_set_handler().

	* app/app_procs.[ch] (app_init): added the g_log_set_handler()
	calls and pass them the global Picman instance as user_data.
	Renamed app_gui_init() to app_gui_libs_init().

	* app/errors.c: use the passed Picman pointer instead of using
	"the_picman". Don't #include "app_procs.h".

	* app/gui/gui.[ch]: removed gui_get_screen_resolution().

	* app/widgets/picmanwidgets-utils.[ch]: added
	picman_get_screen_resolution().

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.c
	* app/gui/preferences-dialog.c
	* app/gui/user-install-dialog.c: changed accordingly.

	* app/display/picmandisplayshell.c: don't #include "gui/gui.h".

2003-05-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): remove
	main_column->editable_widget on each button_press_event. Should
	fix more (if not all) stale editing widgets.

2003-05-28  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantextoptions.c
	* app/tools/picmantransformtool.c
	* app/tools/paint_options.c
	* app/tools/tool_manager.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmantoolbox-color-area.c:
	don't #include "gui/dialogs.h" to get the global factories but use
	picman_dialog_factory_from_name() instead.

2003-05-28  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]: wrap gui_libs_init() so we don't need to
	include gui.h from main.c

	* app/main.c: changed accordingly.

	* app/gui/gui.[ch]: added a GdkScreen parameter to
	gui_get_screen_resolution(). Use NULL if you want the default
	screen.

	* app/gui/preferences-dialog.c
	* app/gui/user-install-dialog.c: changed accordingly.

	* app/display/picmandisplayshell-scale.c: use the monitor resolution
	stored in the PicmanDisplayShell object.

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.c: get the monitor resolution for
	the widget's GdkScreen. Set it in the realize method so it gets
	changed when the image window is migrated to another screen.

2003-05-28  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c
	* app/gui/palette-editor-menu.c
	* app/gui/view-commands.[ch]
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanpaletteeditor.[ch]: changed all places to show
	zoom menu items and icons in ZOOM_OUT, ZOOM_IN order. In an attack
	of consistency, also reordered all callbacks accordingly.

2003-05-28  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: don't let the navigation
	_popup_ auto-resize itself and don't allocate a minimum size
	because that makes sense for the navigation _tab_ only. Fixes
	popup size and positioning.

2003-05-28  Sven Neumann  <sven@picman.org>

	* README: updated info about mailing lists.

2003-05-27  Sven Neumann  <sven@picman.org>

	* app/gui/vectors-commands.c (vectors_selection_to_vectors): don't
	mark a string for translation which should never be used.

2003-05-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmanrectselecttool.[ch]: added the possibility to
	<alt>+drag the whole selection preview line *while* creating the
	selection. Used a modified version of
	http://aeropc5.hut.fi/~mjkorhon/picman-move-selection.patch (found
	in the mailing list archives). Fixes bug #87688.

2003-05-27  Michael Natterer  <mitch@picman.org>

	* app/gui/select-commands.c (select_save_cmd_callback): switch
	to the "Channels" tab after adding the new channel.
	Fixes bug #101970.

2003-05-27  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Don't warn about webbrowser and picman-remote not
	being built on non-X11. Webbrowser does build on Win32, and
	anyway, anybody who builds on Win32 should know that some plug-ins
	are platform-dependent. Do set WEBBROWSER on Win32, too.

2003-05-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c (export_merge): check that the merged layer
	has image width and height and resize it if necessary. Fixes bug
	#113639.

2003-05-26  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager-private.h: added "gint ref_count" to the
	TileManager struct.

	* app/base/tile-manager.[ch]: replaced tile_manager_destroy()
	by tile_manager_ref() and tile_manager_unref().

	* app/core/picmanimage-undo-push.c: ref the tile managers stored in
	the undo system and DON'T destroy them if no undo could be pushed.
	Should fix the remaining crashes with undo disabled like in
	bug #9350.

	(!!!) Note that the tiles passed to picman_image_undo_push_image()
	and picman_drawable_push_undo() as well as the tile managers of
	drawables passed to picman_image_undo_push_[layer|channel]_mod()
	must be unref'ed by the caller now.

	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste):
	don't take ownership of the passed tiles but ref them if needed.

	(!!!) Callers must unref the passed tiles themselves now.

	* app/core/picmanbuffer.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/paint/picmanpaintcore.c
	* app/text/picmantextlayer.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmantransformtool-undo.c
	* app/tools/picmantransformtool.c: changed accordingly.

2003-05-26  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/imagemap/Makefile.am: Moved the -i flag for lex.
	* plug-ins/imagemap/imap_csim.y: Modified the grammar a bit in
	order to allow the attribute nohref="nohref".  Fixes the last
	part of bug #87687.

2003-05-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.[ch]
	* app/gui/palette-editor-commands.[ch]
	* app/gui/palette-editor-menu.c: started to clean up the palette
	editor: added buttons for all menu items and menu items for all
	buttons. Improved selected palette entry handling. Moved all code
	to picmanpaletteeditor.c and call it from the menu callbacks.  Lots
	of cleanup (unfinished).

2003-05-26  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/tools/picmaneditselectiontool.c (selection_transform_segs):
	Fix off-by-one when dragging the selection. Fixes the last pending
	issue of bug #17904. Use temporary variables for clamp values.

	* app/display/picmandisplayshell-selection.c
	(selection_transform_segs): Perform the clamping that fixes
	bug #110014 here instead of in the callers. Solves a rare case
	that was not properly handled before.
	(selection_render_points, selection_generate_segs): Remove the
	clamping code from here.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_rectangle): More
	clampings to avoid overflow of 16-bit coordinates.

2003-05-25  Maurits Rijk <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_csim_parse.[ch]: regenerated
	* plug-ins/imagemap/imap_main.c (save_as_csim): write quoted WIDTH,
	HEIGHT and BORDER tags.
	* plug-ins/imagemap/Makefile.am: added -i flag to lex to generate 
	case-insensitive scanners.
	* plug-ins/imagemap/imap_csim.y: parse now accepts both tag=FLOAT and
	tag="FLOAT" to support both old and newstyle HTML. Should fix #113445.

	* plug-ins/common/lic.c: minor code clean-up

2003-05-25  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.[ch] (tool_manager_set,get): Use
	g_object_[set|get]_qdata(), not just _data() to speed up tool
	manager access.

	Removed tool_manager_active_get_help_data() and
	tool_manager_help_func().

	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c: use picman_standard_help_func and
	tool->tool_info->help_data instead. Don't #include "tool_manager.h".

2003-05-25  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanhelpui.[ch] (_picman_help_init): changed again
	to take no paramaters and use _picman_standard_help_func from
	picmanwidgets-private.

	* libpicmanwidgets/picmanwidgets-private.[ch]: removed the palette
	functions from PicmanWidgetVTable. Instead, pass them as
	PicmanGetColorFunc to picman_widgets_init() and make them available as
	_picman_get_foreground_func and _picman_get_background_func.

	* libpicmanwidgets/picmancolorbutton.c
	* libpicman/picmanui.c: changed accordingly.

	* app/libpicman_glue.[ch]: removed the palette functions.

	* app/gui/gui.c: added gui_get_foreground_func() and
	gui_get_background_func() and pass them to picman_widgets_init().

2003-05-25  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanhelpui.[ch]: added a PicmanHelpFunc parameter to
	_picman_help_init(). Implement picman_standard_help_func() here and
	use the function pointer passed to _picman_help_init().

	* libpicmanwidgets/picmanwidgets-private.[ch]: removed
	standard_help_func from PicmanWidgetsVTable. Require it as paramater
	to picman_widgets_init() and pass it to _picman_help_init().

	* libpicmanwidgets/picmanunitmenu.c: use picman_standard_help_func
	directly again.

	* app/libpicman_glue.[ch]: removed picman_standard_help_func().

	* libpicman/Makefile.am
	* libpicman/picmanhelp.c: removed this file (containing
	picman_standard_help_func()).

	* app/gui/gui.c: added private picman_help_func() and pass it to
	picman_widgets_init().

	* libpicman/picmanui.c: added private picman_ui_help_func() and pass it
	to picman_widgets_init().

2003-05-25  Michael Natterer  <mitch@picman.org>

	* data/misc/Makefile.am: forgot some hardcoded "1.3" here.

2003-05-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/uniteditor.c (unit_editor_dialog): removed a
	left over GTK_CHECK_VERSION(2,2,0).

2003-05-24  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc **/*.def : updated win32 (msvc) build

	* plug-ins/twain/twain.c plug-ins/winsnap/winsnap.c :
	add the extra parameter to picman_main() calls

2003-05-23  Manish Singh  <yosh@picman.org>

	* libpicman/picman.[ch]: picman_main now takes a PicmanPlugInInfo *,
	and PLUG_IN_INFO is now a static variable set from that. This
	removes all the special casing for the Win32 and OS/2 ports around
	this. Also added a debugging hook for quit procs.

	* plug-ins/common/mng.c: moved MAIN() to the end so PLUG_IN_INFO is
	declared.

	* plug-ins/picmanressionist/picmanressionist.c: pass &PLUG_IN_INFO
	to picman_main.

	* plug-ins/pypicman/picmanmodule.c: Here too. Also add a message
	function.

2003-05-24  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-rotate.c (picman_image_rotate): fixed offset of
	layers and vectors after rotation (bug #113611).

2003-05-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/lic.c (compute_image): always flush the
	displays, not only when creating a new image.

2003-05-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/lic.c (create_main_dialog): actually connect
	the "Create New Image" toggle with its value. Fixes bug #113610.
	Cleaned up a bit.

2003-05-23  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets-private.[ch]: new files. Moved
	picman_widgets_init() here and added a vtable parameter. The vtable
	has entries for all the symbols that are either provided by libpicman
	or picman itself depending on who is using the library.

	* libpicmanwidgets/libpicman-glue.c: removed this file that used to
	provide a Win32 only hack that is now not any longer needed.

	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c
	* libpicmanwidgets/picmanwidgets.[ch]: don't call the offending
	functions directly, but use the vtable entries. This is ugly but
	the ugliness is restricted to our code. There are plans to clean
	this up further... (Fixes #113410 once more.)

	* app/gui/gui.c (gui_libs_init)
	* libpicman/picmanui.c (picman_ui_init): initialize libpicmanwidgets with
	the proper vtable.

2003-05-23  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/imagemap/Makefile.am: added rules for rebuilding the
	source .c files from the .l (lex/flex) and .y (yacc/bison) files.
	Fixes a non-critical part of bug #113445.

2003-05-23  Michael Natterer  <mitch@picman.org>

	* modules/Makefile.am: Always provide interlibrary
	dependencies, not just on Win32.

	* Makefile.am
	* app/Makefile.am
	* app/config/Makefile.am
	* data/misc/Makefile.am
	* docs/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanmodule/Makefile.am
	* libpicmanwidgets/Makefile.am
	* tools/Makefile.am: replaced many hardcoded "1.3" strings by
	$(LT_RELEASE). Hopefully didn't break the Win32 build...

2003-05-23  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c
	* app/tools/picmanpainttool.c: applied a patch from Henning Makholm
	<henning@makholm.net> that improves drawing of narrow straight lines
	by moving the endpoints to pixel centers. Fixes bug #84145.

2003-05-23  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.c (color_notebook_new_internal): don't
	call picman_dialog_factory_add_foreign() with a NULL dialog_factory.

	* app/widgets/picmancolorpanel.c: removed the color_notebook_active
	boolean state and *always* call color_notebook_show() when the
	user clicks the button. This way the notebook is automatically
	deiconified or risen.

2003-05-23  Sven Neumann  <sven@picman.org>

	* docs/keybindings.txt
	* app/gui/image-menu.c (image_menu_entries): changed the default
	shortcut for "Zoom In" to '+'. Fixes bug #56108.

2003-05-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandrawabletreeview.c
	(picman_drawable_tree_view_eye_clicked): implement <shift>+click on
	the eye icon the same way it was in 1.2 (hide all other drawables
	if any is visible, show them all otherwise). Fixes bug #113479.

2003-05-22  Michael Natterer  <mitch@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/picmanvectors-compat.[ch]: new files implementing a
	compatibility API for converting old XCF and PDB point arrays
	to PicmanVectors and vice versa.

	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/paths.pdb: use the new functions instead of
	having slightly different, but equally ugly code twice.

	* app/xcf/xcf-load.c: cleaned up path loading a lot. Removed the
	path_point loading utility functions.

	* app/pdb/paths_cmds.c: regenerated.

	* app/Makefile.am: link vectors/libappvectors.a after
	xcf/libappxcf.a so the compat functions (which are not needed in
	vectors/) are found.  Also reverted an accidentially checked in
	change to the libpicmanwidgets link order.

2003-05-22  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/common/Makefile.am: changed link order as suggested in
	bug #111351.

2003-05-22  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/fileops.pdb: convert filename to a uri for
	find_utils_find_proc.

	* app/pdb/fileops_cmds.c: regenerated

2003-05-22  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/imagemap/Makefile.am (EXTRA_DIST): added missing lex
	files (imap_cern.l, imap_csim.l, imap_ncsa.l)

2003-05-21  Manish Singh  <yosh@picman.org>

	* libpicman/Makefile.am
	* libpicmanwidgets/Makefile.am: Always provide interlibrary
	dependencies, not just on Win32. Fixes bug #113410.

2003-05-21  Michael Natterer  <mitch@picman.org>

	Removed the old paths and the remaining legacy stuff it needed.
	Fixes bug #104471.

	* Makefile.am
	* configure.in
	* pixmaps/*: removed the pixmaps/ directory.

	* app/ops_buttons.[ch]
	* app/path.[ch]
	* app/pathP.h
	* app/path_transform.h
	* app/gui/paths-dialog.[ch]
	* app/tools/picmanbezierselecttool.[ch]: removed these files.

	* app/Makefile.am
	* app/gui/Makefile.am
	* app/tools/Makefile.am: changed accordingly.

	* app/core/core-types.h: removed the Path* types.

	* app/core/picmanimage.[ch]
	* app/core/picmanimage-duplicate.c: removed gimage->paths.

	* app/gui/about-dialog.c: inline wilber2_xpm for now.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c
	* app/gui/menus.c: removed the old paths dialog.

	* app/gui/gui.c: removed gui_rotate_the_shield_harmonics() hack
	which was broken anyway.

	* app/tools/picmantransformtool.c: #if 0 path_transform preview stuff.

	* app/tools/picmaniscissorstool.c: removed useless include.

	* app/tools/tools.c: removed the bezier select tool.

	* app/vectors/picmanvectors.c (picman_vectors_real_stroke_add): use
	g_list_append(), not g_list_prepend() so some ugly side conditions
	of legacy path loading are honored.

	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c: load and save only PicmanVectors.

2003-05-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: added PicmanDrawable::alpha_changed()
	signal.

	* app/core/picmanimage-undo-push.c
	* app/core/picmanlayer.c: emit it when alpha is removed from or
	added to a layer.

	* app/widgets/picmancontainertreeview.[ch]: added a
	"name_attributes" column to the list store which provides a
	PangoAttrList for the name column.

	* app/widgets/picmanlayertreeview.[ch]: connect to all layers'
	"alpha_changed" and set the BG layer's name to bold.

	* app/widgets/picmandrawabletreeview.c: removed redundant assertions.

2003-05-21  Simon Budig  <simon@picman.org>

	* app/core/picmanscanconvert.[ch]: Extended to be able to handle
	multiple polygons in a sane way.

	* app/core/picmanimage-mask-select.c: Use this to convert
	multiple-stroke vectors objects to selections. Libart rocks!

	* app/tools/picmaniscissorstool.c: Changed accordingly.

2003-05-20  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmancolorspace.[ch]: removed redundant functions
	picman_rgb_to_hsv_double() and picman_hsv_to_rgb_double().

	* app/core/picmandrawable-blend.c: use picman_rgb_to_hsv() and
	picman_hsv_to_rgb() instead.

	* plug-ins/fp/fp.[ch]
	* plug-ins/fp/fp_misc.c: ditto. Deuglyfied the changed functions'
	coding style a lot.

2003-05-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c (undo_pop_layer_mod): call
	picman_layer_invalidate_boundary() because the layer extents may
	change.

	* app/core/picmanitem-linked.c: pass clip_result == TRUE when
	rotating linked channels.

	* app/core/picmandrawable-transform.c: implement clip_result so
	linked channels can be rotated without leaving the image in an
	inconsistent state. Added utility function
	picman_drawable_transform_rotate_point().

2003-05-20  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-callbacks.c: removed padding_gc from
	the PicmanDisplayShell struct. Don't draw the padding color manually.

	* app/display/picmandisplayshell-appearance.c
	(picman_display_shell_set_padding): set the canvas background color
	using gdk_window_set_background().

2003-05-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-rotate.c (picman_image_rotate): fixed a harmless
	compiler warning.

2003-05-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_rotate): don't default to
	clip_result == TRUE (unlike the other transform functions).

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_rotate): fixed offset calculation.

	* app/core/picmanimage-rotate.c: change the image size *after* all items
	are rotated. Adjust all items' offsets after rotation. Rotate the
	resolutions too. Seems to work now and fixes bug #6101.

	* app/core/picmanimage.c (picman_image_size_changed): emit
	"size_changed" on all vectors.

	* app/core/picmanitem-linked.[ch]: added picman_item_linked_rotate().

	* app/gui/drawable-commands.c: flip and rotate linked items too.

	* app/vectors/picmanvectors.c (picman_vectors_rotate): fixed rotation
	angles.

	Unrelated:

	* app/core/picmanimage-merge.c: don't #include "path.h".

2003-05-20  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_rotate): fixed algorithm for
	PICMAN_ROTATE_180.

2003-05-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-flip.c: no need to include picman-intl.h.
	
	* app/core/picmanimage-rotate.c: change the image size if needed;
	implemented rotation of guides.

	* app/vectors/picmanvectors.c: implemented rotation of vectors.

2003-05-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.c: remember the guide's orientation
	in the guide undo. Needed for picman_image_rotate().

2003-05-20  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added new enum PicmanRotationType.

	* app/core/Makefile.am
	* app/core/picmanimage-rotate.[ch]: new files.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform.[ch]
	* app/core/picmandrawable.c
	* app/core/picmanitem.[ch]
	* app/core/picmanlayer.c
	* app/vectors/picmanvectors.c: added PicmanItem::rotate. Still work in
	progress.

	* plug-ins/common/rotate.c: don't install any menu entries. The
	plug-in is only kept around to provide plug_in_rotate for backward
	compatibility.

	* app/gui/drawable-commands.[ch]
	* app/gui/image-commands.[ch]
	* app/gui/image-menu.c: use the new rotate implementation and use
	stock icons for the menu entries. Fixes bug #57797.

2003-05-20  Michael Natterer  <mitch@picman.org>

	Some color API cleanup:

	* libpicmancolor/picmancolortypes.h: added struct PicmanHSL. All values
	are doubles in a [0.0..1.0] range.

	* libpicmancolor/picmancolorspace.[ch]: changed the PicmanRGB <-> HSL
	functions to use the new struct instead of separate hue, saturation
	and lightness doubles. Note that the hue range has changed from
	[0.0..360.0] to [0.0..1.0].

	* app/base/colorize.c (colorize_calculate)
	* plug-ins/common/AlienMap2.c (transform): changed accordingly.

2003-05-19  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/script-fu-console.c: Add SIOD banner to console
	startup.

2003-05-19  Michael Natterer  <mitch@picman.org>

	* app/gui/drawable-commands.h: eek, forgot to commit this file.

2003-05-19  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c: moved the image flip entries to the
	Image->Transform submenu and added flip entries to
	Layer->Transform. Cleaned up the transform submenus.

	* app/gui/drawable-commands.[ch]: added
	drawable_flip_cmd_callback().

	* tools/pdbgen/pdb/image.pdb: added a PDB wrapper for
	picman_image_flip().

	* libpicman/picmanimage_pdb.[ch]
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c: regenerated.

2003-05-19  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c (temp_buf_to_color) (temp_buf_to_gray):
	fixed sense of assertions; argh.

2003-05-19  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmancolorspace.c (picman_hsl_to_rgb): fixed to work
	like picman_hls_to_rgb_int() (does the right thing now for the
	saturation == 0 case). Some minor cleanups.

	Implemented "Colorize" as suggested in bug #20509. It's not a
	toggle in the "Hue/Saturation" tool dialog (which would be a gross
	hack IMHO) but a separate tool. Fixes bug #20509.

	* app/base/Makefile.am
	* app/base/base-types.h
	* app/base/colorize.[ch]: the actual mapping function lives
	here. Its algorithm was taken from the "colorify" plug-in.

	* app/tools/Makefile.am
	* app/tools/picmancolorizetool.[ch]: the tool.

	* app/tools/tools.c: register it.

	* app/gui/dialogs.c: session-manage its dialog.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-colorize-16.png
	* themes/Default/images/tools/stock-tool-colorize-22.png: new
	icons from Jimmac.

	Unrelated:

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: don't #include "tool_manager.h"

2003-05-19  Manish Singh  <yosh@picman.org>

	* configure.in: remove glibconfig.h inline check, it hasn't worked
	for a long time.

	* tools/authorsgen/contributors: added George J. Carrette, author of
	SIOD.

2003-05-19  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-flip-horizontal-16.png:
	* themes/Default/images/stock-flip-vertical-16.png: fix shadows
	  a little
	
2003-05-19  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.[ch]: Implemented closed paths. Not
	yet available in a sane manner via the UI. Added the last missing
	line from picman_bezier_stroke_interpolate ().
	
	* app/tools/picmanvectortool.c: Changed accordingly

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: removed Tabs.

2003-05-19  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_channel): set gimage->qmask_state
	to TRUE if a channel's name is "Qmask". Fixes bug #113240.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-guides.c (picman_image_snap_rectangle): snap
	correctly to the bottom and right sides of the rectangle. Also
	snap to the closer guide if we snap twice on one axis.
	Fixes bug #113233.

	All snapping functions: use ROUND() instead of truncating the
	double coords.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): update the cursor on
	GDK_ENTER_NOTIFY.

	* app/display/picmandisplayshell-cursor.c
	(picman_display_shell_update_cursor): argh, "0" coordinates are
	*inside* the canvas.

	Together fixes bug #113239.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.c (color_palette_target_table): 
	removed PICMAN_TARGET_PALETTE. Fixes bug #113237.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): push a
	colormap undo if the image was INDEXED. Fixes bug #113236.
	Minor Cleanups.

2003-05-18  Michael Natterer  <mitch@picman.org>

	Implemented "Flip Image". Fixes bug #23179:

	* app/core/core-enums.[ch]: added PICMAN_UNDO_GROUP_IMAGE_FLIP.

	* app/core/Makefile.am
	* app/core/picmanimage-flip.[ch]: new files implementing
	picman_image_flip().

	* app/gui/image-menu.c
	* app/gui/image-commands.[ch]: added it to the "Image" menu.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-flip-horizontal-16.png
	* themes/Default/images/stock-flip-vertical-16.png
	* libpicmanwidgets/picmanstock.[ch]: added icons for the new
	menu items.

	Bugs found while hacking the stuff above:

	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste):
	only call picman_layer_add_alpha() if the pasted tiles have alpha.

	* app/core/picmanimage-undo-push.c (undo_pop_channel_mod): fixed to
	do the right thing if the channel is the selection mask.

2003-05-18  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/psd_save.c: Translated Spanish comments to
	English and globally cleaned-up to ease further manipulation.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanbezierstroke.[ch]
	(picman_bezier_stroke_new_from_coords): changed to expect all points
	(also the first one) in "H, A, H" order.  Ignore the first coord
	in the array for now. Added "gboolean closed" parameter.

	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/paths.pdb: shuffle the legacy path point arrays
	around before creating strokes so they match the new order.

	* app/pdb/paths_cmds.c: regenerated.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.[ch]
	* app/display/picmandisplayshell.c: enabled dropping of vectors to
	the display to copy them between images.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanmarshal.list: added BOOLEAN: OBJECT, POINTER.

	* app/widgets/picmancontainerview.[ch]: added a boolean return
	value to PicmanContainerView::select_item() which indicates if
	the select operation was successful.

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c: changed accordingly.

	* app/widgets/picmandrawabletreeview.c: ditto. Removed the
	tree_view's select_function because it was only constraining the
	widget, not the underlying select operation. Instead, implement
	PicmanContainerView::select_item() and disallow anything but the
	floating selection to be selected. Also re-enabled the
	"floating_selection_changed" callback and explicitely set the
	active item so the button states get updated. Fixes bug #112487.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors.[ch]: added new function
	picman_vectors_convert() which duplicates a PicmanVectors for another
	image.

	* app/widgets/picmanvectorstreeview.c
	(picman_vectors_tree_view_class_init): use it as
	PicmanItemTreeView::convert_item() implementation. Enables
	DND-copying of vectors between images.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c
	* app/tools/picmantransformtool-undo.[ch]: removed old path undo stuff.

2003-05-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_new_from_drawable): call
	picman_item_set_image() on the new layer's mask too if it exists.

2003-05-17  Michael Natterer  <mitch@picman.org>

	Fixed File->Revert, which was completely broken before:

	* app/gui/file-commands.c (file_revert_confirm_callback): set the
	new image on all PicmanContexts which had the old image set.  Unref
	the new image after the displays are reconnected.

	Added some paranoia code for similar future situations (the
	functions below were not broken, but affected by the above bug):

	* app/display/picmandisplay-handlers.c (picman_display_disconnect):
	set gdisp->gimage to NULL before unrefing the image.

	* app/widgets/picmanimagedock.c (picman_image_dock_image_changed):
	unref the gimage pointer returned by g_object_get() only if it is
	non-NULL. Cleanup.

2003-05-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_set_filename): treat the empty
	string as NULL filename. Fixes bug #113179.

2003-05-17  Dave Neary  <bolsh@picman.org>

	* plug-ins/script-fu/scripts/alien-glow-button.scm
	* plug-ins/script-fu/scripts/beveled-button.scm
	* plug-ins/script-fu/scripts/beveled-pattern-button.scm: 
	Applied patch from Tor Lilliqvist <tml@iki.fi> which
	fixes the same problem as that reported in bug #77572.

2003-05-16  Dave Neary  <bolsh@picman.org>

	* plug-ins/script-fu/scripts/pupi-button.scm: Applied
	patch from Tor Lilliqvist <tml@iki.fi> to fix bug #77572.

2003-05-16  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/edge.c
	* plug-ins/common/tiff.c
	* plug-ins/common/mail.c
	* plug-ins/webbrowser/webbrowser.c: Removed GPL
	conflicting parts of permission notices on these files,
	in line with what has been said in bug #83362. 

2003-05-16  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/nlfilt.c: Changed licence for Graeme
	Gill's code in this filter. Fixes part of bug #83362.

2003-05-16  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanbezierstroke.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors-preview.c
	* app/vectors/picmanvectors.[ch]: massive cleanup / code review:
	Made default implementations real ones. Don't add "const" to
	call-by-value parameters. Iterate lists using for() loops. Moved
	variables to local scopes. Removed tabs. Indentation. Stuff...

	* app/vectors/picmanstroke.[ch]: added unused "gboolean closed"
	member.

2003-05-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch] (picman_image_mask_extract): added
	"gboolean cut_image" parameter so we can float selections
	without cutting them from the original drawable.

	* app/gui/select-commands.c
	* tools/pdbgen/pdb/selection.pdb: pass cut_image == TRUE.

	* app/pdb/selection_cmds.c: regenerated.

	* app/tools/tools-enums.[ch]: added SELECTION_MOVE_COPY value
	to the SelectOps enum.

	* app/tools/picmanselectiontool.c: use the new mode when
	<ctrl>+<alt>-dragging a selction (yes, this is evil but there are
	no modifiers left).

	* app/tools/picmaneditselectiontool.[ch]: extended EditType enum by
	EDIT_MASK_COPY_TO_LAYER_TRANSLATE and pass cut_image == FALSE if
	it's passed to init_edit_selection().

	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanrectselecttool.c: pass the new mode to
	PicmanEditSelectionTool.

2003-05-16  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.[ch]: added dialog_factory and
	dialog_identifier parameters to the constructors and register the
	color_notebook with the passed factory as foreign dialog.

	* app/widgets/picmancolorpanel.c: changed accordingly.

	* app/gui/dialogs.c
	* app/gui/colormap-editor-commands.c
	* app/gui/gradient-editor-commands.c
	* app/gui/palette-editor-commands.c
	* app/widgets/picmantoolbox-color-area.c: added session management for
	the color notebooks created here.

2003-05-16  Michael Natterer  <mitch@picman.org>

	* app/gui/vectors-commands.c (vectors_sel_to_vectors_cmd_callback): 
	call vectors_selection_to_vectors() instead of #warning about
	being unimplemented.

2003-05-16  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/paths.pdb: fixed some bugs and warnings in
	the ported functions.

	* app/pdb/paths_cmds.c: regenerated.

2003-05-16  Sven Neumann  <sven@picman.org>

	* app/pdb/fileops_cmds.c
	* tools/pdbgen/pdb/fileops.pdb: this change should fix
	file_load_thumbnail() for images with alpha channel by blending
	the resulting tempbuf on a checkerboard (bug #113033).

2003-05-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl (declare_args): removed generation of
	includes for enums since including "pdb-types.h" is sufficient
	now.

	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/paths.pdb: removed PDB access to the old paths
	and ported everything to PicmanVectors. Note that everything except
	picman_path_set_points() is untested and that
	picman_path_get_point_at_dist() is currently unimplemented. Changed
	order of the generated functions and fixed some help texts.

	* tools/pdbgen/app.pl: removed $tools_eek and $paint_eek hacks
	because pdb/ doesn't include stuff from tools/ any more and paint/
	no longer depends on GTK+.

	* app/pdb/paint_tools_cmds.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

2003-05-15  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_affine): fixed typo: use x1 instead
	of the uninitialized variable x.

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.[ch]: removed unused variable
	has_alpha from blend_pixels() function.

	* app/base/temp-buf.c: cosmetics.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* app/gui/vectors-commands.[ch]: added new function
	vectors_selection_to_vectors() which invokes the sel2path Plug-In.

	* app/gui/dialogs-constructors.c: make the new function known to
	PicmanVectorsTreeView.

	* app/widgets/picmanvectorstreeview.[ch]: Added a "Selection to Path"
	button and call the new function.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/sel2path/sel2path.c: don't clear the selection after
	creating the path. Minor cleanups.

2003-05-15  Sven Neumann  <sven@picman.org>

	* app/pdb/fileops_cmds.c
	* tools/pdbgen/pdb/fileops.pdb: fixed docs for file_save_thumbnail
	(bug #113033).

2003-05-15  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c: added some sanity checks to temp_buf
	conversion routines.

	* tools/pdbgen/pdb/fileops.pdb (file_load_thumbnail_invoker): use
	PicmanImagefile to load a thumbnail. Only works for RGB images yet.
	This adresses bug #113033.

	* app/pdb/fileops_cmds.c: regenerated.

	* app/file/file-utils.[ch]: removed file_utils_readXVThumb(). It
	is not needed any longer since PicmanImagefile also handles the
	old-style .xvpics.

	* plug-ins/script-fu/scripts/copy-visible.scm: fixed typo.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-save.c: cleaned up the old path saving functions
	just as the old path loading ones. Don't use g_slist_foreach() but
	do everything in one functions. Added error checking for path
	saving.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_old_path): the old paths actually
	*do* support multiple strokes, they are just all in one curve.
	Added support for loading them as separate PicmanBezierStrokes.

2003-05-15  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanbezierstroke.c
	(picman_bezier_stroke_new_from_coords): actually increment the coord
	index when iterating the coords array. Fixes bug #113049.

2003-05-14  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/blur.c (blur): Ported a change from STABLE
	branch that might fix bug #84731.

	* plug-ins/picmanressionist/picman.c
	* plug-ins/picmanressionist/picmanressionist.c: Don't destroy the
	global random-state variable before rendering. Fixes bug #113007.

2003-05-14  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c: load the old paths into new PicmanVectors
	objects. Old paths are still created because new vectors can't be
	saved yet. Renamed all old path loading functions to
	xcf_load_old_path*(). Added prototypes for them and reordered them
	to match the order of the rest of the file. Changed their
	signatures to match the rest of the file and indented them.

2003-05-14  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/screenshot.c: Attach default comment to
	image made by screenshot. Fixes bug #51164

2003-05-14  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picman-utils.[ch]: new file for utility functions.
	Contains picman_rectangle_intersect() for now.

	* app/core/picmandrawable-transform.c: removed the function here.

	* app/core/picmandrawable.c (picman_drawable_resize): use it to
	determine the amount of pixels to copy between the old and new
	tile managers. Removed restriction that forced the areas to
	overlap by at least one pixel.

	* app/core/picmanitem.c (picman_item_real_transform): removed the
	restriction here, too.

	* app/core/picmanlayer.c (picman_layer_create_mask): use the new
	function to decide how much to copy from the selection when
	creating a mask from it.

2003-05-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.[ch]: changed the TileManager
	variable names to "orig_tiles" and "new_tiles" in the whole file.

	(picman_drawable_transform_tiles_flip): implement "clip_result".
	Enables flipping of linked channels.

2003-05-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanimagedock.c (picman_image_dock_book_removed):
	chain up to parent_class->book_removed(), not book_added().  Fixes
	dock destruction on last book removal.

2003-05-12  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/csource.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/tiff.c: If no comment is set on a
	PicmanImage when it arrives to be saved, don't attach one.
	Fixes bug #98490 - and removes code which does what is
	suggested in bug #98485 as correct behaviour.

2003-05-13  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_channel_props)
	* app/xcf/xcf-save.c (xcf_save_channel_props): store the channel's
	"linked" state in the XCF. Older PICMANs will complain, but still
	load the file as if the new property was not there.

2003-05-13  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c: bolsh got permission from David Koblas
        to relicense the prehistoric code that begat the original PICMAN GIF
	plugin, so Koblas' mildly-GPL-unfriendly license boilerplate can
	finally rest in peace.

2003-05-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added "gboolean clip_result" to
	PicmanItem::flip().

	* app/vectors/picmanvectors.c
	* app/tools/picmanfliptool.c: changed accordingly.

	* app/core/picmandrawable.c: implement PicmanItem::flip() and
	PicmanItem::transform().

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: chain up in flip() and transform() and do
	only the layer/channel specific stuff here.

	* app/core/picmandrawable-transform.[ch]: fixed indentation.
	(picman_drawable_transform_tiles_flip): added "gboolean clip_result"
	and warn that it is not yet implemented.
	(picman_drawable_transform_tiles_affine): when transforming a
	channel set bg_color to transparent. Clip channels (but not layer
	masks) only if the passed tiles have bpp == 1 (the channel is
	unfloated).
	(picman_drawable_transform_affine): clip all unfloated channels.

	* app/core/picmanitem-linked.[ch]: added picman_item_linked_get_list()
	utility function to avoind iterating all layers/channels/vectors
	in all functions.

	* app/tools/picmantransformtool.c: clip all unfloated channels.

	The clipping fixes above together fix bug #112858.

2003-05-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.c (picman_image_mask_extract):
	s/bg/bg_color/g, cleanup.

2003-05-13  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in.c (plug_in_close): wait 10 ms before killing
	the plug-in just like the comment says. The code used to wait 0.1 ms
	only.

2003-05-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_invalidate_preview_handler): use a low-priority
	timeout for updating the WM icon.

2003-05-12  Michael Natterer  <mitch@picman.org>

	Added support for transforming linked layers, channels
	and vectors. Fixes bug #86277.

	* app/core/picmandrawable-transform.[ch]
	(picman_drawable_transform_tiles_flip): added "gdouble axis" and
	calculate the resulting drawable offset.
	(picman_drawable_transform_flip): calculate the axis and pass it to
	the function above.
	(picman_drawable_transform_[tiles_]affine): reordered parameters.

	* app/core/picmanitem.[ch]: added virtual functions PicmanItem::flip()
	and PicmanItem::transform().

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c
	* app/vectors/picmanvectors.c: implement flip() and transform().
	Note that all functions always transform the whole item,
	regardless of a present selection.

	* app/core/Makefile.am
	* app/core/picmanitem-linked.[ch]: new files containing utility
	functions which translate, flip and transform all linked items.

	* app/tools/picmanfliptool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/layer.pdb: use the new picman_item_linked_*()
	functions to translate, flip and transform all linked items.

	* tools/pdbgen/pdb/transform_tools.pdb: follow
	picman_drawable_transform_affine() API change.

	* app/pdb/layer_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2003-05-12  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c (tool_manager_tool_changed): make sure
	that active_tool->tool_info is non-NULL before dereferencing it.
	(Spotted by Ville PÃ¤tsi).

2003-05-11  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/guides.pdb: added a missing break that broke
	picman_image_find_next_guide(). Fixes bug #112717.

	* app/pdb/guides_cmds.c: regenerated.
	
2003-05-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanselectioneditor.[ch]: added a "Stroke Selection"
	button to the selection editor as suggested in bug #112448.

2003-05-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_button_release):
	initialize scale to please the compiler.

2003-05-09  Pedro Gimeno  <pggimeno@wanadoo.es>

	* plug-ins/common/jigsaw.c: Pass the buffer size to all functions
	using the buffer.
	(DRAW_POINT, DARKEN_POINT, LIGHTEN_POINT): Use buffer size to
	avoid buffer overflows. Fixes bug #100122.

2003-05-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added "gboolean push_undo" to
	PicmanItem::translate() and don't push and undo in
	picman_item_translate().

	* app/core/picmanchannel.[ch]: removed public function
	picman_channel_translate() and implement PicmanItem::translate().

	* app/core/picmanimage-mask.c
	* app/core/picmanlayer.c: changed accordingly.

	* app/vectors/picmanvectors.c: actually translate the vectors
	in translate().

	* app/gui/channels-commands.c (channels_new_channel_query): removed
	useless call to picman_channel_translate().

	* app/tools/picmaneditselectiontool.c
	* tools/pdbgen/pdb/layer.pdb: when translating a linked layer,
	also translate all linked channels and vectors. Cleanup.

	Note that the "linked" behaviour has changed: before this change,
	moving a layer moved all linked layers unconditionally. Now,
	linked layers/channels/vectors are moved *only* if the moved layer
	is also linked (the linked items behave as a group now and moving
	something not in the group does not affect the group).

	* app/pdb/layer_cmds.c: regenerated.

2003-05-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-crop.c (picman_image_crop)
	* app/core/picmanimage-resize.c (picman_image_resize)
	* app/core/picmanimage-scale.c (picman_image_scale):
	don't #include "picmanchannel.h". Moved code around so they all do
	their stuff in the same order (improves readability when comparing
	the functions). Use PicmanItem variables instead of PicmanChannel or
	PicmanLayer ones. Lots of cleanup.

2003-05-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-crop.c (picman_image_crop): resize all vectors
	here, too.

2003-05-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c: added default implementations for scale()
	and resize() which just set the resulting width/height and offset
	values.

	* app/core/picmandrawable.c: chain up in scale() and resize().

	* app/vectors/picmanvectors.[ch]: buncha vectors changes/features:

	- Removed unused "linked" and "locked" members.
	- Removed "changed" signal.
	- Added "freeze" and "thaw" signals and functions to emit them.
	- Added "freeze_count" member so we emit only one freeze/thaw pair
	  even when doing nested changes.
	- Added PicmanItem::translate() implementation.
	- Actually scale and resize the vectors in scale() and resize().
	- Added undo for scale() and resize().
	- Added freeze()/thaw() pairs around all modifying functions.
	- Changed picman_vectors_copy_strokes() to work as needed.

	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c: resize and scale all vectors.
	Fixes bug #36491.

	* app/core/picmanimage-undo-push.c (undo_pop_vectors_mod): added
	freeze()/thaw() around the vectors-modifying code. Also restore
	width, height and offsets.

	* app/tools/picmanvectortool.c: connect to "freeze" and "thaw"
	and pause()/resume() vectors drawing accordingly.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: removed "linked" member and API...

	* app/core/picmanitem.[ch]: ...and added it here.

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]: changed layer_linked undo
	types and functions to be item_linked ones.

	* app/tools/picmaneditselectiontool.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

	* app/widgets/picmanlayertreeview.[ch]: removed "linked" icon and
	functions...

	* app/widgets/picmanitemtreeview.[ch]: and added them here. Setting
	channels or vectors to "linked" does nothing yet.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added picman_item_translate() and
	virtual function PicmanItem::translate().

	* app/core/picmanlayer.[ch]: removed public function
	picman_layer_translate() and implement PicmanItem::translate()
	instead.

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]: changed layer_displace undo
	types and functions to be item_displace ones.

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-resize.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/layers-commands.c
	* app/tools/picmaneditselectiontool.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: removed the remaining layer scale API.

	* app/core/picmanitem.[ch]: added the same functions here.

	* app/core/picmanimage-scale.c
	* app/gui/layers-commands.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch] (picman_item_configure): added width,
	height, offset_x and offset_y parameters.

	* app/core/picmandrawable.c
	* app/vectors/picmanvectors.c: changed accordingly.

	* app/tools/picmanfliptool.c: removed unused variable.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: removed picman_drawable_offsets().

	* app/core/picmanitem.[ch]: added picman_item_offsets().

	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-histogram.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-mask-select.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-pick-color.c
	* app/core/picmanimage-preview.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-transform.c
	* app/display/picmandisplayshell.c
	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb: changed accordingly.

	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c: regenerated.

2003-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: removed picman_drawable_width,height().

	* app/core/picmanitem.[ch]: added picman_item_width,height().

	* app/core/picmanchannel.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-preview.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanscanconvert.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell.c
	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmansmudge.c
	* app/text/picmantextlayer.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/drawable_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

2003-05-08  Michael Natterer  <mitch@picman.org>

	More transform virtualization preparation:

	* app/core/picmandrawable.[ch]: removed "width", "height", "offset_x"
	and "offset_y"...

	* app/core/picmanitem.[ch]: ...and added them here.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/text/picmantext-compat.c
	* app/text/picmantextlayer.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanpreviewrendererdrawable.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

2003-05-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_create_mask): when adding a
	layer mask from selection, don't crash if the layer is not
	entirely inside the image boundary but clip the copy_region()
	accordingly. Fixes bug #112409. Added a local PicmanDrawable variable
	so we don't need to PICMAN_DRAWABLE(layer) all the time.

2003-05-07  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors.c: forgot to commit this one.

2003-05-07  Michael Natterer  <mitch@picman.org>

	More transform stuff virtualization:

	* app/core/picmanitem.[ch]: added new virtual function
	PicmanItem::resize().

	* app/core/picmanchannel.[ch]
	* app/core/picmanlayer.[ch]: removed public resize functions
	and implement resize() instead.

	* app/core/picmandrawable.c: implement resize() which contains
	the common parts of layer/channel resizing.

	* app/vectors/picmanvectors.c: added empty resize() implementation.

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-resize.c
	* app/gui/layers-commands.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

2003-05-07  Michael Natterer  <mitch@picman.org>

	Started to abstract item transformation so we can easily
	transform multiple linked items later:

	* app/core/picmanitem.[ch]: added new virtual function
	PicmanItem::scale() with the same signature as the former
	picman_layer_scale_lowlevel().

	* app/core/picmandrawable.c: implement scale() and do the
	common parts of layer/channel scaling here.

	* app/core/picmanchannel.[ch]
	* app/core/picmanlayer.[ch]: implement scale() for the
	channel/layer specific parts of scaling.

	* app/core/picmanlayer.[ch]: renamed picman_layer_scale() to
	picman_layer_scale_by_origin().

	* app/vectors/picmanvectors.c: added empty scale() implementation.

	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo-push.c
	* app/gui/layers-commands.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c: regenerated.

	Unrelated:

	* app/core/picmanimage-undo-push.c: fixed item rename undo to
	take the size of the saved name into account. Removed old
	path_undo stuff.

2003-05-06  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.[ch]: removed PicmanToolState (ACTIVE,
	INACTIVE).

	* app/tools/picmantoolcontrol.[ch]: replaced "PicmanToolState state"
	by "gboolean active".

	* app/tools/picmantool.c (picman_tool_control)
	* app/tools/tool_manager.c (tool_manager_control_active): check
	for picman_tool_control_is_active() before calling
	picman_tool_control_halt().

2003-05-06  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_motion): added
	g_return_if_fail (picman_tool_control_is_active (tool->control))
	since that's a basic constraint of tool event handling.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanrectselecttool.c (picman_*_tool_motion):
	removed checks for picman_tool_control_is_active().

2003-05-05  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/core/picmandrawable-blend.c: Cleanups.
	(gradient_calc_linear_factor): Apply the gradient to both sides
	when Repeat is set to Sawtooth Wave. Fixes bug #112106.

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_affine): Fix copy'n'paste slip in
	coordinates calculation for supersampling code. Transform the
	pixel centers properly. Fixes bug #10466.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_rectangle,
	picman_draw_tool_draw_arc): Ported the fix for bug #17904 from the
	STABLE branch (off-by-one when drawing the rectangle/ellipse
	previews).

	* app/tools/picmaneditselectiontool.c: Renamed
	picman_edit_selection_tool_snap to
	picman_edit_selection_tool_calc_coords, as it is no longer used for
	snapping.
	(picman_edit_selection_tool_calc_coords): Use floor instead of
	rounding. Callers changed to remove rounding, as it deals with
	gdoubles directly. Thanks to Mitch for the help refining this
	one. Fixes bug #17906.

2003-05-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scale.c: some more code cleanup.

2003-05-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scale.[ch]
	(picman_display_shell_scale_zoom_fraction): new utility function
	which takes PicmanZoomType and zooms "scalesrc" and "scaledest".
	(picman_display_shell_scale_calc_fraction): new utility function
	which takes an exact double scale factor and calculates "scalesrc"
	and "scaledest".

	(picman_display_shell_scale): use the first.
	(picman_display_shell_scale_fit): use the second.

	* app/tools/picmanmagnifytool.[ch]: use the first to click-zoom and
	the second to area-zoom. Fixes bug #112115. Removed zoom_in() and
	zoom_out() utiliy functions. Removed "PicmanZoomType op" from the
	PicmanMagnifyTool struct. Cleanup.

2003-05-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_snap_coords):
	don't change the passed PicmanCoords if we didn't snap.

2003-05-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c: set GDK_HINT_USER_POS for all
	session managed dialogs, not only for those which already have
	saved session info. This way the dialogs keep their position
	acrosss hide/show within the same session, even if they have never
	been used before.

	* app/gui/dialogs.c: added entries for the file open/save dialogs.
	Fixed some entries.

	* app/gui/file-dialog-utils.[ch]
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: register the file dialogs with
	the dialog factory.

2003-05-03  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): Update the splash before
	calling plug_in_query() and plug_in_init() (applied a modified
	patch from Raphael Quinet). Fixes bug #112156.

2003-05-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.[ch]: added "dockable_added",
	"dockable_removed" and "dockable_reordered" signals and emit them.

	* app/widgets/picmanimagedock.[ch]: implement PicmanDock::book_added()
	and PicmanDock::book_removed(). Connect to the above signals and
	update the window title as proposed in bug #111971. Idle-update
	the title so subsequent changes are compressed. Fixes bug #111971.

	* app/widgets/picmandock.c: cleanup.

2003-05-03  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanmeasuretool.c: register their dialogs too.

2003-05-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.[ch]: added new function
	picman_dialog_factory_add_foreign() which adds a dialog that was not
	created by the factory itself. Its identifier however must be
	registered with the factory. Connect to all toplevel dialogs'
	"configure_event" and remember the resulting window geometry so we
	get session management for *all* dialogs, not only for those which
	were open on exit.

	* app/gui/dialogs.c: added the "File New" dialog. Added foreign
	entries (without constructor) for all dialogs opened by tools.

	* app/gui/dialogs-constructors.[ch]: added a constructor for
	the file_new dialog.

	* app/gui/file-new-dialog.[ch]: renamed file_new_dialog_create()
	to file_new_dialog_new() and removed the gimage and template
	paramaters. Added new function file_new_dialog_set() to set
	gimage and template after creation.

	* app/gui/file-commands.c
	* app/gui/templates-commands.c: changed accordingly.

	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmantransformtool.[ch]: added
	"const gchar *shell_identifier" to the tool structs. Register the
	tool dialogs using picman_dialog_factory_add_foreign().

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmanthresholdtool.c: set "shell_identifier" so the
	dialogs become session managed. Fixes bug #61091.

	* app/tools/picmancroptool.c: register the crop dialog with the
	dialog factory. Fixes bug #52849.

	* app/tools/picmancolorpickertool.c: ditto.

	Unrelated:

	* app/tools/picmantool.c: no need to cast the return value of
	g_object_new().

2003-05-02  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/paint/picmanpaintcore-stroke.c (picman_paint_core_stroke,
	picman_paint_core_stroke_vectors): Save brush pointer before first
	stroke and restore it after. Fixes bug #102162.

	* plug-ins/common/flarefx.c (FlareFX): Use
	picman_fixme_preview_do_row instead of memcpy. Fixes bug #112042 for
	this plug-in.

	* plug-ins/common/jigsaw.c: Several cleanups.
	(jigsaw_values_changed): New function as a result of the cleanups.
	(jigsaw): Use picman_fixme_preview_do_row instead of memcpy.
	Together with the fix to flarefx, fixes bug #112042.
	(draw_jigsaw): Warn if passed a NULL buffer (solves the crash
	reported in bug #112012 but not the bug itself).

	* plug-ins/picmanressionist/orientation.c: Slightly reformatted.
	(create_orientationpage): Modify orientfirst/orientlast instead of
	sizefirst/sizelast in the corresponding adjustments. Fixes
	bug #112061.

2003-05-01  Manish Singh  <yosh@picman.org>

	* app/text/picmanfontlist.c: Query fontconfig directly for the font
	list, avoiding scanning the internal fontconfig list over and over
	again. There are differences in the font list that the old and new
	code produce however. The new code will generate descriptions for
	more fonts, and some of the styles will be different. Also, pango
	font description strings aren't specific enough for all cases, so
	a font name may appear more than once in the list. I'm not sure
	how to solve this best, but this code is Good Enough (TM) for now.

2003-04-30  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/widgets/picmangradienteditor.c (control_compress_range): Don't
	try to compress the left and right ends. Fixes bug #89274.

2003-04-30  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_image_props): skip guides with
	negative positions. Fixes warning since picman_image_add_[hv]guide()
	doesn't allow positions < 0 any more.

2003-04-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): when editing an object's
	name, make sure we really edit its name, not its description.

2003-04-29  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/paint-funcs/paint-funcs.c (shrink_line): Serialize access to
	source and destination memory to reduce the chance of cache misses
	when dealing with large images. Enable some assertions temporarily
	to ensure that the algorithm works properly before backporting it.

2003-04-28  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/jpeg.c: default to not showing the in-display
	JPEG preview and warn the user that enabling it will modify
	the image's undo history. Fixes bug #109464.

2003-04-27  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/paint-funcs/paint-funcs.c (shrink_line): Mostly rewritten to
	improve accuracy. Fixes bug #104693.

2003-04-25  Pedro Gimeno  <pggimeno@wanadoo.es>

	* app/paint-funcs/paint-funcs.c: Some reformattings to improve
	readability.
	(shrink_line): Added some explanatory comments.
	(border_region): Fixed wrong (though harmless) allocation bug:
	used sizeof(gint16 *) where sizeof(gint16) was needed.

2003-04-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/url.c (query): register the plug-in for https
	as well. Most wget installations seem to handle this nowadays.

2003-04-21  Pedro Gimeno  <pggimeno@wanadoo.es>

	* configure.in: Removed the plug-ins/tools/Makefile line that was
	left over when the tool plug-ins were removed.

2003-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/old-photo.scm: applied a modified
	version of a patch from Branko Collin that makes the border size
	configurable (bug #62087).

2003-04-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-contiguous-region.c
	(find_contiguous_region_helper): applied patch from Pedro Gimeno
	that fixes bug #51883.

	* plug-ins/common/bumpmap.c (bumpmap): applied patch from Pedro
	Gimeno that fixes bug #52543.

2003-04-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-guides.c (picman_image_snap_x,y): new functions
	snapping to one axis only.
	(picman_image_snap_rectangle): use them to enable snapping the
	rectangle to all its corners, not just the NW and SE one.

2003-04-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantoolcontrol.[ch]: added an API to specify a
	"snap_offset" and a "snap_width/height". Needed for tools which
	want to snap to a rectangle and/or a position which is not the
	current cursor position.

	* app/display/picmandisplayshell.[ch]: removed
	picman_display_shell_find_guide(), picman_display_shell_snap_point()
	and picman_display_shell_snap_rectangle().
	Added picman_display_shell_snap_coords() which works on PicmanCoords
	and gets passed the above snap offsets.

	* app/display/picmandisplayshell-callbacks.c: use the new snap
	function, using the values from PicmanToolControl.

	* app/tools/picmancroptool.c: set snap offsets so the handles can be
	guide-aligned after creating. Fixes bug #110957.

	* app/tools/picmaneditselectiontool.c: removed snapping code (which
	was broken anyway) and set appropriate snap offsets in
	init_edit_selection().

2003-04-16  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_main_window.c: 64-bit cleaniless cleanup.

2003-04-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantemplateeditor.c (picman_template_editor_init):
	modify the focus chain so it doesn't go line-by-line, but
	spinbuttons first, then the widgets right of them.

2003-04-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c: check for PICMAN_IS_DISPLAY(gdisp) again.

	* app/tools/picmantool.h: don't #include "picmantoolcontrol.h"

	* app/tools/[all tools].c: #include "picmantoolcontrol.h"

2003-04-15  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmantoolgui.[ch]
	* app/tools/picmantoolmodule.[ch]: removed unused files.

2003-04-15  Sven Neumann  <sven@picman.org>

	Removed support for pluggable tools:

	* configure.in: bumped version number to 1.3.15.

	* Makefile.am 
	* libpicmanproxy
	* libpicmantool
	* plug-ins/Makefile.am
	* plug-ins/plugin-helper
	* plug-ins/tools: removed libpicmanproxy, libpicmantool and plug-ins
	that used it.

	* tools/Makefile.am
	* tools/picman-mkproxy: removed tool that used to generate
	libpicmanproxy.

	* app/core/core-enums.h
	* app/core/picmanchannel.h
	* app/display/display-types.h
	* app/widgets/widgets-enums.h: removed proxy-skip/resume stuff.

	* app/core/picmanobject.c: use picman marshallers.

	* app/tools/Makefile.am
	* app/tools/picmantool.h	
	* app/tools/tools-enums.[ch]: moved these files back from
	libpicmantool.

	* app/tools/picmantool.c
	* app/tools/picmantoolcontrol.h: merged back functionality from
	libpicmantool.
	
	* app/Makefile.am
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/gui/tools-commands.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbucketfilltool.h
	* app/tools/picmandrawtool.h
	* app/tools/picmanimagemaptool.h
	* app/tools/picmaninktool.h
	* app/tools/picmantoolmodule.c
	* app/tools/tool_manager.c
	* app/tools/tools-types.h
	* app/tools/tools.c
	* tools/pdbgen/Makefile.am: changed accordingly.

2003-04-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.[ch]: added a "selected_item"
	pointer to the PicmanContainerGridView struct so we don't need to
	remember it using g_object_[set|get]_data(). Also make sure that
	the selected item doesn't get out of sight when resizing the view
	and that it is always visible initially.

2003-04-15  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): make sure all progress
	bars end at 1.0. Build the list of extension procedures to start
	before starting them (and don't start them while iterating the
	list of procedures because the list changes if we start an
	extension).

2003-04-15  Michael Natterer  <mitch@picman.org>

	* app/tools/paint_options.c (picman_paint_options_gui): use a smaller
	preview size for the gradient popup than for the button.

2003-04-14  Sven Neumann  <sven@picman.org>

	* Made 1.3.14 release.

2003-04-14  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: don't request viewable previews with
	a width or height of 0 and don't crash if no preview is returned.

	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmandrawable_pdb.c: regenerated.

2003-04-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.[ch]: made
	picman_vector_tool_clear_vectors() private. Connect to the vector's
	"changed" signal (and do nothing in the callback for now...).
	Alwayws set tool->gdisp in button_press(). Use for() loops to
	iterate strokes. Fixed picman_vector_tool_set_vectors() to hopefully
	do the right thing in all cases now. s/ptr/list/g. Cleanup.

2003-04-14  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors.[ch]: made "changed" a real signal,
	don't crash when iterating a NULL stroke list, cleanup.

2003-04-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_get_tab_widget): check
	for !PICMAN_IS_PREVIEW(widget), not for GTK_WIDGET_NO_WINDOW(widget)
	when deciding whether to put the tab_widget in a GtkEventBox
	because PicmanPreview is NO_WINDOW now but still handles events.
	Fixes dockable DND.

2003-04-14  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: don't try to reparent the children
	of GtkInputDialog but simply pop up the dialog as provided by
	GTK+. Looks ugly but shouldn't crash any longer. Fixes bug #104423.

2003-04-14  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: Changed vectors->strokes to a
	GList and removed stroke->next. Implemented stuff for duplicating
	strokes. Duplicating a vector works now.

	* app/tools/picmanvectortool.c: added not-yet-used function to
	determine where a click has been. Refcounting stuff changed.

	* app/core/picmanimage-mask-select.c
	* app/paint/picmanpaintcore-stroke.c: Changed accordingly.

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c: connect to "realize" of the
	scrolled window's viewport and scroll to the correct item
	(because GtkViewport is too dumb to this by itself).

	* app/widgets/picmancontainerpopup.[ch]: added a "view_type"
	parameter.

	* app/widgets/picmanviewablebutton.[ch]: added new function
	picman_viewable_button_set_view_type() and pass the view_type
	to the PicmanContainerPopup.

	* app/widgets/picmantemplateeditor.c: default to PICMAN_VIEW_TYPE_GRID
	for the stock icon popup.

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-desaturate.c (picman_drawable_desaturate):
	Added g_return_if_fail (picman_drawable_is_rgb (drawable)), cleanup.

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmantemplate.c (picman_template_notify): invalidate
	the preview when the stock_id changes.

	* app/widgets/picmantemplateeditor.[ch]: added an optional entry
	to edit the template's name.

	* app/widgets/picmantemplateview.[ch]: added a "duplicate" button and
	function pointers for creating templates, editing templates and
	creating images from templates.

	* app/gui/file-new-dialog.[ch] (file_new_dialog_create): added an
	optional template parameter.

	* app/gui/file-commands.c: pass template == NULL.

	* app/gui/templates-menu.c: added a "Duplicate Template" menu entry.

	* app/gui/templates-commands.[ch]: added the callback for the
	duplicate menu item. Added "New Template" and "Edit Template"
	dialogs. Added a function which opens a file_new_dialog with
	a template preselected.

	* app/gui/dialogs-constructors.c: let PicmanTemplateView know
	about the functions.

2003-04-13  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintoptions.c: changed the "fade-length" and
	"gradient-length" minimum values to 0.0 for compatibility with
	the PDB API.

	* app/paint/picmanpaintcore.c (picman_paint_core_get_color_from_gradient):
	check that gradient_length > 0.0 before dividing by it.

	* plug-ins/gfig/gfig.c (gfig_paint_callback): push an undo group
	around the paint operations (bug #110446).

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantemplateview.c: made the names editable in the
	tree view.

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_deserialize_property)
	* app/core/picmancontainer.c (picman_container_deserialize): g_free()
	the string returned by picman_scanner_parse_string(). Replace
	NULL object names by "".

2003-04-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c (init_edit_selection):
	g_memdup() the segments returned by picman_image_mask_boundary().
	Just caching the pointers leads to bug #22375 because the image's
	mask boundary changes while we live-move stuff.

	* app/tools/picmanmovetool.c (picman_move_tool_button_press): pause
	the selection when starting to move a guide, since we also resume
	it when we're finished.

	(both bugs tracked down by Pedro Gimeno).

2003-04-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.c (picman_stock_button_pixbufs): register
	missing icon for PICMAN_STOCK_GRAVITY_WEST.

2003-04-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerpopup.[ch]
	* app/widgets/picmanviewablebutton.[ch]: added "preview_size" and
	"preview_border_width" parameters to the constructors and use them
	when creating the popup.

	* app/tools/picmantextoptions.c
	* app/tools/paint_options.c
	* app/widgets/picmantemplateeditor.c: changed accordingly. Create the
	icon popup without borders.

2003-04-12  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-params.h: made object properties
	G_PARAM_READWRITE by default. Added flag PICMAN_PARAM_AGGREGATE
	which indicates that an object property is not a reference but a
	real part of its owner.

	* app/config/picmanconfig-deserialize.c: g_object_set_property()
	object properties only if they are not PICMAN_PARAM_AGGREGATE.

	* app/config/picmanconfig-utils.c (picman_config_copy_properties,
	picman_config_reset_properties): copy and reset PICMAN_PARAM_AGGREGATE
	object properties correctly.

	* app/config/picmanconfig-serialize.c: don't call
	picman_config_writer_open/close() for properties which are handled
	by a PicmanConfigIface::serialize_property() implementation.

	* app/core/picmancontext.c: removed exlicit G_PARAM_WRITABLE from
	object properties since that's the default now. Call
	picman_config_writer_open/close() when serializing properties.

	* app/core/picmanviewable.c (picman_viewable_get_property): use
	picman_viewable_get_stock_id().
	(picman_viewable_set_stock_id): set stock_id to NULL if the new
	stock_id is the same as viewable_class->default_stock_id.
	Added serialize_property() which skips stock_id serialization
	if it is NULL.

	* app/tools/picmantextoptions.c: made the "text" property
	PICMAN_PARAM_AGGREGATE. Added picman_text_options_set_property()
	(which does nothing).

	* app/widgets/picmantemplateeditor.[ch]: added an optional
	PicmanViewableButton to change the template's icon.

	* app/gui/file-new-dialog.c: create it with the icon button so it
	gets some testing.

2003-04-12  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/png.c (save_image):
	Fixed a bug caused by myself previously. png saving
	should now work reasonably correctly with alpha on indexed 
	images.

2003-04-12  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	applied a patch from Pedro Gimeno that plugs a memleak in Script-Fu.

2003-04-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_dialog): fixed fnord that caused the
	dialog to sometimes show a ratio of 0:0.

2003-04-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_get_icon_size): return
	GTK_ICON_SIZE_INVALID for non-existant icons.

	* app/widgets/picmanpreviewrenderer.c: handle GTK_ICON_SIZE_INVALID.

2003-04-11  Michael Natterer  <mitch@picman.org>

	* app/gui/file-new-dialog.c: s/NewImageInfo/FileNewDialog/g,
	cleanup.

2003-04-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: derive it from GtkBin, not from
	GtkVBox. Removed "content_spacing" style property.

	* app/widgets/picmancontainerview-utils.c
	* etc/gtkrc_user
	* themes/Default/gtkrc: changed accordingly.

2003-04-11  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/flame/flame.c (dialog): restore the original input
	range from 1 to 4 for the Spatial Oversample parameter, and reset
	the number of decimals to 0.  Fixes bug #110443.

2003-04-11  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-template-24.png
	* themes/Default/images/stock-video-[16|24].png
	* themes/Default/images/stock-web-[16|24].png: new icons by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* etc/templaterc: use Web icons for the web banner templates.

2003-04-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmantemplateeditor.[ch]: new widget chopped out
	of file-new-dialog.c

	* app/gui/file-new-dialog.c: use it.

2003-04-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreviewrenderer.c (picman_preview_renderer_create_gc):
	lookup the border color in the window's colormap.

2003-04-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreview.[ch]
	* app/widgets/picmanpreviewrenderer.[ch]: moved background
	functionality into the renderer. Removed some PicmanPreview
	functions that used to wrap PicmanPreviewRenderer functionality.

	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmannavigationview.c
	* app/gui/dialogs-constructors.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmanpreview-popup.c
	* app/widgets/picmanselectioneditor.[ch]: changed accordingly.

2003-04-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmannavigationpreview.c: set the cursor on
	preview->event_window, not widget->window. Use
	preview->renderer->viewable, not preview->viewable.

2003-04-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreview.[ch]: made PicmanPreview a NO_WINDOW
	widget that draws on the parent window. Added an INPUT_ONLY window
	for events.

	* app/widgets/picmannavigationpreview.c: take the widget's
	allocation into account when rendering the marker and grab the
	mouse on the preview's event_window.

	* app/widgets/picmanpreviewrenderer.[ch]: pass GdkRectangles as const.

2003-04-10  Michael Natterer  <mitch@picman.org>

	* app/gui/file-new-dialog.c: added Portrait/Landscape radio
	buttons which follow the state of the width/height entered and can
	be used to swap them.

2003-04-10  Sven Neumann  <sven@picman.org>

	* etc/templaterc: added more standard paper sizes.
	
2003-04-10  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c 
	* app/xcf/xcf-save.c: some cosmetic changes before I do any real ones.

2003-04-10  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/interp_sliba.c
	* plug-ins/script-fu/scripts/selection-round.scm: applied a patch
	from Pedro Gimeno that adds the trunc() function to our scheme
	interpreter and fixes bug #109475 the right way.

2003-04-10  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-portrait-16.png
	* themes/Default/images/stock-landscape-16.png: new icons by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/widgets/widgets-enums.[ch]: added new enum PicmanAspectType.

2003-04-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.[ch]: added picman_context_type_to_prop_name().

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanviewablebutton.[ch]: new widget implementing
	the wheel-scrollable preview button.

	* app/tools/picmantextoptions.c
	* app/tools/paint_options.[ch]: removed the code implementing the
	same and use PicmanViewableButton.

	* app/tools/tool_manager.c: added the font to the context
	properties which are remembered per tool. Added an evil hack
	using g_object_set_data() to pass the global_dock_factory to
	tool option GUI constructors.

2003-04-09  Sven Neumann  <sven@picman.org>

	* app/text/text-enums.[ch]
	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added some more text properties that
	can't be accessed from the GUI yet.

2003-04-09  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c
	(picman_edit_selection_tool_button_release): fixed boolean logic bug
	introduced by the fix for bug #110173. Spotted by Pedro Gimeno.

2003-04-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushgenerated.c: fixed algorithm that calculates
	the brush size, some code cleanup.

2003-04-09  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_setup): don't try to hide the
	tearoff menu item if tearoff menus are disabled in the prefs.

2003-04-09  Michael Natterer  <mitch@picman.org>

	* app/file/file-save.[ch] (file_save_as): added "gboolean
	set_image_clean" and call picman_image_clean_all() only if it
	was passed as TRUE.
	(file_save): pass TRUE.

	* app/gui/file-save-dialog.c: pass TRUE from the "Save as" and
	FALSE from the "Save a Copy" dialog (bug #109464).

2003-04-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_remove_channel): say
	"Remove Channel" when pushing the undo, not "Remove Layer".

2003-04-09  Michael Natterer  <mitch@picman.org>

	* app/tools/paint_options.[ch]: added
	paint_options_container_scrolled() utility function which
	wheel-scrolls a container. Use it for the brush and pattern
	previews. Added a gradient preview.

	* app/tools/picmanblendoptions.c: removed the gradient preview here.

	* app/tools/picmantextoptions.c: use the new function to scroll
	the font list.

2003-04-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbucketfilloptions.c: removed the pattern preview...

	* app/tools/paint_options.c: ...and added it here so all paint
	tools can use it if needed. Added a pattern preview to the clone
	tool options.

2003-04-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: Added "gpointer get_tab_data" to
	PicmanDockableGetTabFunc and to picman_dockable_new().

	* app/gui/dialogs-constructors.c: changed accordingly. Replaced
	dialogs_[brush,pattern,gradient,palette,font]_tab_func() by
	dialogs_viewable_tab_func() which gets passed the GType as
	get_tab_data.

2003-04-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added virtual function
	PicmanViewable::get_description() which returns the string that
	should be presented to the user plus an optional tooltip with more
	information. The default implementation just returns the object's
	name and no tooltip.

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmanimage.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmantoolinfo.c: implement get_description().

	* app/core/picmanimagefile.[ch]: ditto. Renamed
	picman_imagefile_get_description() to
	picman_imagefile_get_desc_string(). Well, um, gimme a better name...

	* app/gui/file-open-dialog.c: changed accordingly.

	* app/file/file-utils.[ch]: renamed readXVThumb() to
	file_utils_readXVThumb().

	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/widgets/widgets-types.h: removed PicmanItemGetNameFunc typedef.

	* app/widgets/picmancontainerview-utils.[ch]: removed the actual
	get_name_funcs. They now live in the core as
	PicmanViewable::get_description() implementations.

	* app/widgets/picmancontainermenu.[ch]
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmanmenuitem.[ch]
	* app/widgets/picmanviewabledialog.c: removed get_name_func stuff
	and use picman_viewable_get_description().

	* app/widgets/picmancontainermenu.[ch]: added "preview_border_width"
	to picman_container_menu_set_preview_size().

	* app/widgets/picmanimagedock.c: changed accordingly.

	* app/pdb/fileops_cmds.c: regenerated.

2003-04-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanbrushfactoryview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmancontainertreeview.[ch]
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmanimageview.[ch]
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmantemplateview.[ch]: removed "min_item_x" and
	"min_item_y" parameters all over the place. Added
	"preview_border_width" instead.

	* app/widgets/picmanmenuitem.c: ensure that all menu items have the
	same height.

	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanundoeditor.c
	* app/gui/brush-select.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/font-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c: changed accordingly.

	* app/gui/dialogs-constructors.c: removed the borders from the tool
	and template lists.

2003-04-08  Michael Natterer  <mitch@picman.org>

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h: added "gboolean save_accels" and
	"gboolean restore_accels".

	* app/gui/menus.[ch]: added menus_restore(), menus_save() and
	menus_clear().

	* app/gui/session.[ch]: added session_clear().

	* app/gui/gui.c: call menus_restore() and menus_save().

	* app/gui/preferences-dialog.c: brought the full core config
	options overkill to the GUI. Needs to be simplified. Cleaned
	up the "Interface" page a bit.

2003-04-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c (selection_transform_segs):
	another patch from Pedro Gimeno that addresses problems displaying
	the selection border (bug #110014).

2003-04-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c
	(picman_edit_selection_tool_button_release): applied a patch from
	Pedro Gimeno that removes the confusing misfeature of anchoring
	the floating selection if it wasn't moved (bug #110173).

2003-04-07  Sven Neumann  <sven@picman.org>

	* plug-ins/sgi/sgi.h
	* plug-ins/sgi/sgilib.c: applied a patch from marek@aki.cz that
	adds support for reading SGI files in little-endian format. Fixes
	bug #106610.

2003-04-07  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c: applied a (modified) patch
	from Pedro Gimeno that fixes bug #110115.

2003-04-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_apply_mask): call
	picman_viewable_invalidate_preview() on the layer, not on the image
	(fixes bug #108960).

2003-04-06  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c (make_color_map): get the
	gradient_samples here if they are NULL. Fixes crash in
	noninteractive mode (patch from Raphael Quinet, bug #103470).

2003-04-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlist.[ch]: added picman_list_uniquefy_name() utility
	function.

	* app/core/picmandatalist.c
	* app/core/picmanitem.c: use it here instead of duplicating almost
	the same code.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmantemplateview.[ch]: new widget for editing the
	template list.

	* app/gui/dialogs-constructors.c: use it.

	* app/gui/Makefile.am
	* app/gui/templates-commands.[ch]
	* app/gui/templates-menu.[ch]: new files implementing the context
	menu for the template list.

	* app/gui/menus.c: register the new menu with the menu factory.

	* app/gui/file-commands.c (file_new_template_callback): uniquefy
	the new template's name.

	* app/gui/documents-commands.c: fixed typo.

2003-04-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient.c (picman_gradient_get_color_at): fixed bug
	spotted by Pedro Gimeno by moving the alpha calculation to the
	bottom so it is not affected by rgb->hsv->rgb conversions
	(bug #110053).

2003-04-05  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-utils.c (picman_config_reset_properties):
	reset object properties only if they are PICMAN_PARAM_SERIALIZABLE.

	* app/core/picmancontext.[ch]: added a PicmanTemplate property.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: added a template dialog.

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: and menu entries to open it.

	* app/widgets/picmandnd.[ch]: added DND for PicmanTemplates.

2003-04-05  Manish Singh  <yosh@picman.org>

	* themes/Default/gtkrc: remove gtk-can-change-accels setting, since
	there is a UI for it (that overrides it)

2003-04-05  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c: cosmetic.

2003-04-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainermenuimpl.c; keep the "(none)" item at
	the top of the menu, not at the bottom.

2003-04-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainermenu.c
	(picman_container_menu_item_selected): call
	picman_container_menu_select_item() before notifying the context of
	the change.

2003-04-05  Michael Natterer  <mitch@picman.org>

	* app/core/picman-templates.c (picman_templates_load):
	picman_list_reverse() after loading so it is in the right order.

2003-04-05  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: applied a patch from
	Pedro Gimeno that fixes incorrect drawing of the selection border
	caused by overflowing 16bit X coordinates (bug #110014).

2003-04-04  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-gradient-bilinear-16.png
	* themes/Default/images/stock-gradient-conical-asymmetric-16.png
	* themes/Default/images/stock-gradient-conical-symmetric-16.png
	* themes/Default/images/stock-gradient-linear-16.png
	* themes/Default/images/stock-gradient-radial-16.png
	* themes/Default/images/stock-gradient-shapeburst-angular-16.png
	* themes/Default/images/stock-gradient-shapeburst-dimpled-16.png
	* themes/Default/images/stock-gradient-shapeburst-spherical-16.png
	* themes/Default/images/stock-gradient-spiral-anticlockwise-16.png
	* themes/Default/images/stock-gradient-spiral-clockwise-16.png
	* themes/Default/images/stock-gradient-square-16.png
	* libpicmanwidgets/picmanstock.[ch]: added new icons drawn by Jimmac.
	
	* app/tools/picmanblendoptions.c (picman_blend_options_gui): use the
	new icons in the gradient type menu.

2003-04-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.[ch]: removed
	tree_view->preview_border_width.

	* app/widgets/picmancontainermenu.[ch]
	* app/widgets/picmancontainerview.[ch]: and added it here so it is
	configurable in all views. Synced the changes in both classes.

	* app/widgets/picmancontainermenuimpl.[ch]
	* app/widgets/picmanmenuitem.[ch]: made preview_border_size
	configurable here, too.

	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanimagedock.c
	* app/gui/palette-import-dialog.c: changed accordingly.

	* app/gui/file-new-dialog.c: Removed the border from the template
	menu previews.

2003-04-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanundo.h: #define PICMAN_UNDO_PREVIEW_SIZE 64

	* app/core/picmanundo.c (picman_undo_create_preview_private): 
	* app/widgets/picmanundoeditor.c (picman_undo_editor_init): use it.

2003-04-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.c: made stock_id a property of the
	PicmanViewable object.

2003-04-04  Sven Neumann  <sven@picman.org>

	* etc/Makefile.am
	* etc/templaterc: added a short templaterc.

	* app/gui/user-install-dialog.c: copy templaterc to ~/.picman-1.3
	and create a templates directory on user installation.

2003-04-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmannavigationpreview.c
	(picman_navigation_preview_move_to): applied another patch from Pedro
	Gimeno that fixes even the most evil zoom ratios.

	(picman_navigation_preview_draw_marker): fixed marker drawing for
	very large zoom ratios.

2003-04-04  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_memsize_to_string): this should
	work on 64bit system as well.

2003-04-04  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanlimits.h: reduced PICMAN_MAX_IMAGE_SIZE to 2^18.

	* libpicmanbase/picmanutils.[ch]: added picman_memsize_to_string()
	utility function (which is definitely broken on 64bit systems).

	* app/core/picmanimage-new.[ch]: removed
	picman_image_new_get_memsize_string() and picman_image_new_create_image().
	Renamed picman_image_new_template_new() to
	picman_image_new_get_last_template().

	* app/core/picmanimagefile.c
	* app/display/picmandisplayshell-title.c: changed accordingly.

	* app/core/picman-templates.c: changed filename from "templates"
	to "templaterc".

	* app/core/picman.[ch]
	* app/core/picmanimage-duplicate.c: don't include "picmanimage-new.h".

	* app/core/picmantemplate.[ch]: removed
	picman_template_calc_memsize().  Instead, added the size and a
	boolean indicating that it is valid to the PicmanTemplate
	struct. Added GObject::notify() implementation and update the
	values there.

	* app/widgets/picmanpropwidgets.c: connect to the unit property
	correctly.

	* app/gui/file-new-dialog.c: changed accordingly. Disconnect
	from the template's "notify" signal while changing all values.

2003-04-04  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_set_zoom)
	* app/gui/view-commands.c (view_zoom_other_cmd_callback): fixed
	an issue with the new Zoom Ratio dialog.

2003-04-04  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c: include stdlib.h for abs().

2003-04-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: applied a patch from
	Pedro Gimeno that fixes the display render problems at high zoom
	levels (bug #109933).

2003-04-04  Sven Neumann  <sven@picman.org>

	Applied a patch from Ã?yvind KolÃÂ¥s that adds supersampling to the
	transform operations (bug #109817):

	* app/base/tile-manager-private.h
	* app/base/tile-manager.[ch]: cache the last accessed tile and use
	it to optimize read_pixel_data_1().

	* app/core/picmandrawable-transform-utils.c	
	* app/core/picmandrawable-transform.c: changed the resampling
	behavior when scaling down.

2003-04-04  Michael Natterer  <mitch@picman.org>

	* app/tools/paint_options.c (pressure_options_gui): the "color"
	option's label was saying "Size". Changed it to "Color".

2003-04-04  Michael Natterer  <mitch@picman.org>

	* app/gui/documents-menu.c: use "", not NULL for "no accelerator",
	since NULL will show the stock_item's accelerator.

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: added a "Document History..." menu item
	at the bottom of the "Open Recent" submenus.

	* app/gui/menus.c (menus_last_opened_add): reorder the dynamically
	created entries to the top of the menu. Cleanup.

2003-04-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_fit): extended range of possible zoom
	ratios like in the other scaling routines.

	* app/display/picmandisplayshell-scale.[ch]
	* app/display/picmandisplayshell.[ch]
	* app/gui/image-menu.c
	* app/gui/view-commands.[ch]: added a dialog to manually enter the
	zoom ratio. Fixes bug #65057.

2003-04-03  Michael Natterer  <mitch@picman.org>

	Added preliminary support for image templates. Not finished
	yet. Addresses bug #96059. Now we need a volunteer to create
	a nice collection of default templates...

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmantemplate.[ch]
	* app/core/picman-templates.[ch]: new files implementing the new
	PicmanTemplate object and the list of available image templates.

	* app/core/picman.[ch]: keep a container of templates around.

	* app/core/picmanimage-new.[ch]: ported to use PicmanTemplate. Removed
	struct PicmanImageNewValues.

	* app/widgets/picmancontainermenuimpl.c: changed to show the
	"(none)" item for a NULL selection also, not only for an empty
	container.

	* app/widgets/picmanpropwidgets.[ch]: added
	picman_prop_size_entry_connect() which connects an externally
	created PicmanSizeEntry to object properties. Fixed the size entry
	code to actually work.

	* app/gui/image-menu.c
	* app/gui/file-commands.[ch]: added "Save as Template" which
	creates a new template from any image's properties.

	* app/gui/file-new-dialog.c: use prop_widgets and PicmanTemplate.
	Offer the available templates in a menu at the top of the dialog.

2003-04-03  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c (picman_move_tool_button_release): don't
	forget to resume the selection after cancelling a guide drag.
	Spotted by Pedro Gimeno.

2003-04-03  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-template-16.png
	* themes/Default/images/stock-texture-64.png: new icons by Jimmac.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/widgets/picmanpreview.[ch]: added the possibility to set a
	background pixmap on the preview widget.

	* app/gui/dialogs-constructors.c
	* app/display/picmannavigationview.[ch]
	* app/widgets/picmanselectioneditor.[ch]: set a background on the
	navigation and selection previews when layer previews are disabled
	in the preferences.

2003-04-03  Sven Neumann  <sven@picman.org>

	* docs/keybindings.txt: updated list of keybindings provided by
	Owen <oc@webone.com.au>.

	* docs/Makefile.am
	* docs/cheat_sheet.txt: removed this hopelessly outdated file.

2003-04-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c: applied a patch from S. Mukund. that
	makes the MNG plug-in use picman_temp_name() for the temporary files
	it creates.

2003-04-02  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-text-dir-rtl-24.png: improved icon.

2003-04-02  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscales.c: set the hex entry's width to 8
	chars (works around bug #109594). Set the hex entry to its old
	value if the user typed in unparseable garbage.

2003-04-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c: reverted my last "fix" and fixed the
	real bug: "tEXt::Thumb::Size" is optional, so don't fail if it's
	not present. Plugged some memleaks.

2003-04-01  Nathan Summers  <rock@picman.org>

	* app/photoshop/*: committed full source to Adobe Photoshop for IRIX.
	Thanks, Adobe!

2003-04-01  Manish Singh  <yosh@picman.org>

	* app/gui/menus.c: turns out we can override the XSetting.. do so.

	* app/gui/preferences_dialog.c: Remove GNOME2 warning, it should work
	fine now.

2003-04-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.h: #define PICMAN_VIEWABLE_MAX_PREVIEW_SIZE
	here.

	* app/widgets/picmanpreview.h
	* app/widgets/picmanpreviewrenderer.h: removed the #defines here.

	* app/core/picmanviewable.c (picman_preview_get[_popup]_size): check
	the return values to be within bounds.

	* app/text/picmanfont.c
	* app/display/picmandisplayshell-render.c: use the new constant
	instead of the magic "1024".

	* app/core/picmandrawable-preview.c: #include our own header file.

	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenu.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmanpreviewrenderer.c: changed accordingly.

2003-04-01  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/tileblur.scm (script-fu-tile-blur):
	push an undo group instead of disabling undo on the image. Fixes
	bug #109681.

2003-04-01  Sven Neumann  <sven@picman.org>

	* app/gui/toolbox-menu.c (toolbox_menu_entries): removed some
	debug entries which are not needed any longer. Fixes bug #109680.

	* app/gui/Makefile.am
	* app/gui/test-commands.[ch]: removed these files from CVS.

2003-04-01  Michael Natterer  <mitch@picman.org>

	* app/config/picmandisplayconfig.[ch]: added gboolean show_scrollbars
	to be consistent with show_menubar etc.

	* app/config/picmanrc-blurbs.h: added its blurb and made all
	SHOW_FOO_BLURBs consistent.

	* app/display/picmandisplayshell.c: take the scrollbar visibility
	default value from PicmanDisplayConfig.

	* app/gui/preferences-dialog.c: GUI for the new property.

2003-04-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanmarshal.list: added VOID__DOUBLE_DOUBLE

	* app/widgets/picmannavigationpreview.[ch]: applied patch from
	Pedro Gimeno that fixes mapping of preview scroll offsets to
	image scroll offsets. Changed the x, y, width, height members
	from gint to gdouble. Changed the external API to use exact
	doubles instead of rounded ints.

	* app/display/picmannavigationview.c: speak to the navigation
	preview in exact double values.

	Alltogether fixes bug #109648.

2003-04-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmaneditor.c: factored button_box creation out to a
	utility function.

2003-04-01  Manish Singh  <yosh@picman.org>

	* app/config/picmanguiconfig.[ch]: added gboolean can_change_accels

	* app/config/picmanrc-blurbs.h: blurb for the above

	* app/gui/preferences-dialog.c: UI for the above. Has warning about
	not working in GNOME2 yet (pending resolution of Bug #109653)

	* app/gui/menus.c: use can_change_accels. It simply parses the rc
	string gtk-can-change-accels = [0|1] depending on the state
	of can_change_accels in the gui config.

	* etc/picmanrc
	* docs/picmanrc-1.3.5.in: regenerated

2003-04-01  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-compat.c (text_render): strip the size from
	the font name before using it.

2003-04-01  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c: use a fixed size for the popup and clamp to
	a maximum size (should actually use PICMAN_PREVIEW_MAX_SIZE here).

	* app/text/picmantext.c
	* app/tools/picmantextoptions.c: minor string changes.

2003-03-31  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-text-dir-ltr-24.png:
	* themes/Default/images/stock-text-dir-rtl-24.png: replace
	  placeholder artwork

2003-03-31  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.[ch]: when the user has changed the layer
	name from the layers dialog, don't change it with the text any longer.

	* app/tools/picmanmovetool.c: removed redundant include.

	* app/widgets/picmancontainerpopup.c
	* app/widgets/widgets-enums.[ch]: fixed spelling.

2003-03-31  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-text-dir-ltr-24.png
	* themes/Default/images/stock-text-dir-rtl-24.png: placeholders
	for new icons.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* themes/Default/gtkrc: tweak GtkDialog in "picman-default-style".

	* app/text/text-enums.[ch]
	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added new enum PicmanTextDirection and
	use it instead of PangoDirection.

	* app/widgets/widgets-types.h
	* app/widgets/picmantexteditor.[ch]: made PicmanTextEditor a real widget
	and added buttons to switch the text direction.

	* app/tools/picmantextoptions.[ch]
	* app/tools/picmantexttool.c: moved creation of the text editor to the
	text tool options, take care of PicmanText::base-direction here.

2003-03-31  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-list-16.png:
	* themes/Default/images/stock-grid-16.png: make more apparent

2003-03-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanenummenu.[ch]: added "icon_size" parameters
	to picman_enum_stock_box_new[_with_range]().

	* app/tools/picmancurvestool.c
	* app/widgets/picmanpropwidgets.c: changed accordingly.

	* app/widgets/picmaneditor.[ch]: added picman_editor_add_stock_box().

	* app/widgets/widgets-enums.[ch]: register PicmanViewType with
	the type system.

	* app/widgets/picmancontainerpopup.c: use a stock box for the
	view as list/grid buttons.

2003-03-31  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/xpm.c (save_image): free the original cmap
	pointer, not the one we used for iteration (fixes bug #109567).

2003-03-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform-utils.c
	(picman_drawable_transform_matrix_perspective): applied patch from
	Ã?yvind KolÃÂ¥s that fixes bug #109570.

2003-03-30  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/mng.c: added MNG save plug-in written by
	S. Mukund <muks@mukund.org>.

2003-03-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanbrusheditor.c: increased the upper limit for the
	brush radius to 1000. Fixes bug #109434.

2003-03-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-resize.c (picman_image_resize): shut up compiler.

2003-03-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-resize.c (picman_image_resize): fixed to check
	the *new* guide position to be within bounds, not the old
	one. Cleanup.

	* app/core/picmanimage-undo-push.c (undo_pop_image_guide): undo
	guide removal and moves manually instead of calling
	picman_image_[add|move]_guide() because the latter may run into
	g_return_if_fail(position <= gimage->width/height) if the undo
	step is part of a resize or crop undo group.

2003-03-30  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_origin_menu_popup): set the active display
	before showing the menu (fixes bug #109472).

2003-03-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-guides.c
	* tools/pdbgen/pdb/guides.pdb: fixed to accept guide->position ==
	image->width/height. Guides live *between* pixels, so they must be
	able to exist right of/below the image's rightmost/bottom pixel.

	* app/core/picmanimage-crop.c (picman_image_crop_adjust_guides): 
	fixed guide iteration to not crash when the current guide is
	removed from the image (fixes bug #109533).

	* app/pdb/guides_cmds.c: regenerated.

2003-03-29  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/interp_slib.c
	* plug-ins/script-fu/interp_sliba.c: patch from Pedro Gimeno to fix
	printing of floating point numbers in script-fu. (Bug #109505)

2003-03-29  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.[ch]
	* app/vectors/vectors-types.h: More vector tool stuff. Control
	handles start to behave...

2003-03-28  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added a "base-direction" property to
	PicmanText and set it on the PangoContext when rendering the text.

2003-03-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_select_item): call
	gtk_tree_selection_select_iter() in addition to
	gtk_tree_view_set_cursor() so we get the focus *and* the selection
	right in all cases.

2003-03-28  Sven Neumann  <sven@picman.org>

	* app/gui/Makefile.am
	* app/gui/font-select.[ch]: added font selection GUI to be used
	through the PDB.

	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c: unified preview and dialog sizes.

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/font_select.pdb: added new file that provides
	PDB accessors to the font selection GUI.

	* app/pdb/font_select_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picman_pdb.h
	* libpicman/picmanfontselect_pdb.[ch]
	* tools/pdbgen/groups.pl: regenerated.
	
	* libpicman/Makefile.am
	* libpicman/picmanfontmenu.c
	* libpicman/picmanmenu.[ch]: added a simple font selection widget to
	be used by plug-ins and scripts.

	* plug-ins/script-fu/script-fu-scripts.c: use the new font
	selection widget. Fixes bug #105610.

2003-03-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-guides.[ch]: added "position" and "push_undo"
	parameters to picman_image_add_[vh]guide(). Start with a refcount
	of 1, not 0 (EEK). Added picman_image_guide_[un]ref(). Added
	"position" parameter to picman_image_add_guide(). Added new
	function picman_image_move_guide(). All functions push guide
	undos correctly and call picman_image_update_guide() so this
	doesn't need to be done by callers.

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/tools/picmanmeasuretool.c
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/guides.pdb: greatly simplyfied all places which
	modify guides: don't fiddle with undo and guide properties
	manually but simply use the API provided.

	* app/tools/picmanmovetool.[ch]: ditto. Changed everything to
	create/move the guide on button_release, not button_press. Enable
	canceling the operation by clicking button3 before releasing
	button1. Keep the guide drawn at its old position until the move
	is finished (fixes bug #75349 and bug #109267).

	* app/pdb/guides_cmds.c: regenerated.

2003-03-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_save_thumbnail):
	call picman_imagefile_update() on success. Ensures that the
	previews are updated whenever we write the thumbnail.

2003-03-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancellrenderertoggle.c
	(picman_cell_renderer_toggle_activate)
	* app/widgets/picmancellrendererviewable.c
	(picman_cell_renderer_viewable_activate): allow keyboard activation.

	* app/widgets/picmancellrendererviewable.c
	(picman_cell_renderer_viewable_render): fixed the if() which resets
	the renderer's border color to black. Fixes layer borders to be
	always correct now.

2003-03-28  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancellrenderertoggle.c
	(picman_cell_renderer_toggle_activate): check for event != NULL to
	avoid crashing when the cell is activated using the keyboard.

2003-03-28  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-compat.c: respect the antialias parameter.

	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added autohint property that allows
	to force the use of the Freetype auto-hinter.

	* app/tools/picmantextoptions.c: added check buttons for autohint
	and antialias. You need to patch PangoFT2 if you want to the
	antialias setting to have any effect (see #109370).

2003-03-27  Jakub Steiner <jimmac@ximian.com>

	* data/images/picman_splash.png: lighten up a bit

2003-03-27  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.[ch]: added hinting and antialias properties.

	* app/text/picmantextlayout.c: rewrote some parts using the
	PangoFontMap API. Respect hinting and antialias properties.
	(PangoFT2 does not allow to switch antialias off, so that has no
	effect yet.)

	* app/tools/picmantextoptions.c: added a check button that controls
	hinting.

2003-03-27  Sven Neumann  <sven@picman.org>

	* configure.in: require PangoFT2 >= 1.2.0.

	* app/text/picmanfontlist.c: use the PangoFontMap API to list
	available fonts.

2003-03-27  Michael Natterer  <mitch@picman.org>

	* app/gui/channels-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c: use layer, channel, ... icons for
	the new layer, channel, ... dialogs.

2003-03-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanlist.[ch]: added new function picman_list_sort().
	
	* app/text/picmanfontlist.c (picman_font_list_restore): sort the list
	after all fonts have been added instead of keeping the list in
	order while inserting fonts.

2003-03-27  Michael Natterer  <mitch@picman.org>

	Someone produces icons faster than I can commit...

	* themes/Default/images/stock-channel-alpha-16.png
	* themes/Default/images/stock-channel-alpha-24.png: updated.

	* themes/Default/images/stock-channel-alpha-32.png
	* themes/Default/images/stock-channel-alpha-48.png: new.

	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.[ch]: added them to the stock system.

	* app/widgets/picmancontainerpopup.c: use the new "view as list" and
	"view as grid" icons.

2003-03-27  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]
	* app/core/picmanimage.c: fixed typos spotted by Janne (bug #109322).

2003-03-27  Michael Natterer  <mitch@picman.org>

	More great icons from Jimmac:

	* themes/Default/images/stock-channel-16.png
	* themes/Default/images/stock-channel-24.png
	* themes/Default/images/stock-channel-blue-16.png
	* themes/Default/images/stock-channel-blue-24.png
	* themes/Default/images/stock-channel-gray-16.png
	* themes/Default/images/stock-channel-gray-24.png
	* themes/Default/images/stock-channel-green-16.png
	* themes/Default/images/stock-channel-green-24.png
	* themes/Default/images/stock-channel-red-16.png
	* themes/Default/images/stock-channel-red-24.png: updated.

	* themes/Default/images/stock-channel-32.png
	* themes/Default/images/stock-channel-48.png
	* themes/Default/images/stock-channel-blue-32.png
	* themes/Default/images/stock-channel-blue-48.png
	* themes/Default/images/stock-channel-gray-32.png
	* themes/Default/images/stock-channel-gray-48.png
	* themes/Default/images/stock-channel-green-32.png
	* themes/Default/images/stock-channel-green-48.png
	* themes/Default/images/stock-channel-red-32.png
	* themes/Default/images/stock-channel-red-48.png
	* themes/Default/images/stock-grid-16.png
	* themes/Default/images/stock-image-32.png
	* themes/Default/images/stock-image-48.png
	* themes/Default/images/stock-layer-32.png
	* themes/Default/images/stock-layer-48.png
	* themes/Default/images/stock-list-16.png
	* themes/Default/images/stock-text-layer-16.png
	* themes/Default/images/stock-text-layer-24.png
	* themes/Default/images/stock-text-layer-32.png
	* themes/Default/images/stock-text-layer-48.png: new ones.

	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.[ch]: added them to the stock system.

	* app/text/picmantextlayer.c: use PICMAN_STOCK_TEXT_LAYER.

2003-03-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanmarshal.list: added a new marshaller.

	* app/widgets/picmancontainergridview.[ch]: added a "move_cursor"
	signal and added keybindings for PageUp/PageDown and Home/End.

2003-03-27  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_property): allow object properties to be
	set again if they are G_PARAM_WRITABLE. Fixes active brush,
	pattern etc. deserialization.

2003-03-27  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "yi" to ALL_LINGUAS again. Po files for
	libpicman, plug-ins, and script-fu have now been provided.

2003-03-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantexteditor.c: enlarged it a little.

2003-03-26  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/tools/stock-tool-*-16.png: new small tool
	icons from Jimmac.

	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.c: added them to the stock system.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c (picman_font_get_popup_size): added an upper
	limit for the popup size to avoid a crash when PICMAN_PREVIEW_MAX_SIZE
	is exceeded.

2003-03-26  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINGUAS): removed "yi" until po files were
	added to po-libpicman, po-plug-ins and po-script-fu.

2003-03-26  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "yi" to ALL_LINGUAS.

2003-03-26  Manish Singh  <yosh@picman.org>

	* plug-ins/common/max_rgb.c: fixed status return to succeed sometimes.
	Honor max_p in non-interactive mode too.

2003-03-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.[ch]: added
	picman_container_view_construct(). The new function calls
	picman_container_view_set_preview_size() instead of simply assigning
	view->preview_size (Fixes wrongly-sized toggle cells spotted by
	Jimmac).

	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanitemtreeview.c: call it when creating a view.

	* app/widgets/picmanchanneltreeview.c: check view->component_editor
	for being non-NULL before accessing it.

2003-03-26  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: include X11/Xmu/WinUtil.h after including
	the GTK+/GDK headers.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainergridview.c: implemented GtkWidget::focus.
	Makes grid views keyboard-navigatable and fixes bug #95120.

2003-03-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.[ch]: added the scrolled_win
	to the PicmanContainerView struct. Create it in init().
	Added picman_container_view_set_size_request() which adds the
	scrolled_window's scrollbar and frames sizes correctly.

	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmancontainertreeview.[ch]: removed scrolled windows
	here and use the one from the parent_instance. Use the new utility
	function.

	* app/widgets/picmancontainertreeview.c: enable searching in the
	name column. Grab the focus in button_press.

	* app/widgets/picmancontainerpopup.[ch]: added a button_box containing
	zoom in/out, view as list/grid and a button to show the permanently
	open dialog. Added more parameters to picman_container_popup_new().

	* app/tools/picmanblendoptions.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmantextoptions.c
	* app/tools/paint_options.c: changed accordingly.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/gui/tool-options-dialog.c (tool_options_dialog_restore_callback):
	reset the tool-options before loading the user settings. Don't warn if
	loading fails.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c
	(picman_font_selection_dialog_set_font_desc): fixed braino that
	caused the wrong family to be selected.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c: connect the preview on the
	context's font object with the font property of the text object
	associated to the text tool options.

2003-03-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.[ch]: added PicmanFont DND.

2003-03-26  Michael Natterer  <mitch@picman.org>

	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: removed cut'n'paste-duplicated
	accelerators from the new font selection menu entries.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c (picman_text_options_gui): added a
	picman_prop_preview on the font property. Doesn't do anything yet
	but has a nice popup...

2003-03-26  Michael Natterer  <mitch@picman.org>

	* app/text/picmanfont.c: a nicer popup preview featuring five
	dozen liquor jugs.

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/text/picmanfontlist.c: implemented picman_font_list_restore().

2003-03-26  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c (picman_font_get_new_preview): sort of works now.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/text/picmanfontlist.[ch]: added picman_font_list_restore()
	which loads the fonts (not yet).

	* app/core/picman.c: call it.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: added font list and grid views.

	* app/gui/menus.c: cosmetic.

2003-03-25  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c: made the PangoContext an object property of
	PicmanFont.

2003-03-25  Sven Neumann  <sven@picman.org>

	* picmanui-1.3.pc.in: require gtk+ >= 2.2.

	* app/text/picmanfont.[ch]: implemented basic preview functionality.

	* app/text/picmantextlayout.c: changed a comment.
	
2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/config/picmancoreconfig.[ch]: added "gchar *default_font".
	* app/config/picmanrc-blurbs.h: and its blurb.

	* app/core/picman.[ch]: keep a PicmanFontList around.

	* app/core/picmancontext.[ch]: added a PicmanFont and all needed
	functions to let it work like brush, pattern etc.

	* app/core/picmandatalist.c: cosmetic.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/text/Makefile.am
	* app/text/text-types.h
	* app/text/picmanfontlist.[ch]: new PicmanList subclass. Unused...

	* app/text/picmanfont.[ch]: added picman_font_get_standard().

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c: added PICMAN_CONTEXT_PATTERN_MASK to the
	context properties which are remembered per tool options.

	* app/tools/paint_options.[ch]
	* app/tools/picmanblendoptions.c: attach the brush and gradient
	preview to the GtkTable that holds opacity and paint mode.

	* app/tools/picmanbucketfilloptions.c: added a pattern preview
	and popup.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/text/Makefile.am
	* app/text/text-types.h
	* app/text/picmanfont.[ch]: new object. Does nothing yet.

2003-03-25  Sven Neumann  <sven@picman.org>

	* libpicmantool/Makefile.am
	* libpicmantool/picmantoolenums.c: include libpicman-intl.h here.

2003-03-25  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.c: include locale.h for setlocale().
	
	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am
	* app/paint/Makefile.am
	* app/text/Makefile.am
	* app/widgets/Makefile.am: changed rules that generate enums code
	to include picman-intl.h instead of libpicman-intl.h.

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/*.pdb: include picman-intl.h.

2003-03-25  Sven Neumann  <sven@picman.org>

	* libpicman/Makefile.am
	* libpicman/picmanintl.h: removed this header file.

	* libpicman/picmanmiscui.c: include libpicman-intl.h.

	* libpicman/picman.c (picman_main): call setlocale() and bind to the
	libpicman textdomain so that plug-ins don't need to do that
	explicitely.

	* libpicman/stdplugins-intl.h: added the functionality that used to
	live in picmanintl.h and removed the libpicman related stuff. Got rid
	of the INIT_I18N_UI() macro.

	* plug-ins/*/*.c: removed all occurances of INIT_I18N_UI().
	Plug-ins simply call INIT_I18N() once in their run() function.

	* plug-ins/script-fu/script-fu-intl.h: added the functionality
	that used to live in picmanintl.h and removed the libpicman related
	stuff.

	* app/Makefile.am
	* app/picman-intl.h: new file that defines the gettext macros for
	the PICMAN core.

	* app/*/*.c: include picman-intl.h instead of libpicman/picmanintl.h.
	
	* plug-ins/script-fu/scripts/test-sphere.scm: fixed typos.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added new functions
	picman_image_active_[layer|channel|vectors]_changed() which emit the
	resp. signals.

	* app/core/picmanimage-undo-push.c (undo_pop_layer,channel,vectors):
	fixed them to not leave the image's active layer, channel, vectors
	pointers undefined (fixes bug #109110). Call picman_item_removed()
	from all of them.

	* app/core/picmanimage-qmask.c: cleanup.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c (app_init): cast batch_cmds to (const gchar **)
	when passing them to batch_init().

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): moved the call just added
	inside the if(view->container) because it will fail if selecting
	the item destroyed the widget.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerpopup.c
	(picman_container_popup_real_confirm): don't use
	picman_context_copy_property() but picman_context_get_by_type()
	followed by picman_context_set_by_type() because PicmanContext's
	"copy" functions are special and skip the normal parent_context
	logic intentionally (fixes bug #109115).

2003-03-25  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/Makefile.am: removed traces of gap which was moved to a
	separate CVS module and bumped the version to 1.3.14.
	
	* pixmaps/Makefile.am: removed a couple of pixmaps that are not
	used any longer.

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): need to call
	gtk_tree_view_column_cell_set_cell_data() again after fiddling
	with the GtkTreeView (fixes bug #109121).

2003-03-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): ignore double clicks on
	toggle cells (fixes bug #109114).

2003-03-24  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanenummenu.[ch]: added new functions
	picman_enum_menu_set_stock_prefix() and
	picman_enum_option_menu_set_stock_prefix() that allow to
	conveniently add stock icons to enum menus.

	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.c: use the new functions here.

2003-03-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c (picman_dock_separator_drag_drop): don't
	try to reorder dockables in a dock containing exactly one dockable
	(fixes bug #109042)

2003-03-24  Michael Natterer  <mitch@picman.org>

	* app/paint/paint-enums.[ch]: register PicmanPaintApplicationMode
	with the type system.

	* app/paint/picmanpaintoptions.[ch]: replaced "gboolean incremental"
	with "PicmanPaintApplicationMode application_mode"

	* app/paint/picmanairbrush.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpencil.c: changed accordingly.

	* tools/pdbgen/pdb/paint_tools.pdb: ditto. Set all paint options
	values using g_object_set().

	* app/widgets/picmanpropwidgets.[ch]: added
	picman_prop_enum_check_button_new() which can represent two
	specified enum values and renders itself "inconsistent" for all
	other values.

	* app/tools/paint_options.c: use it for the "Incremental" toggle.

	* app/pdb/paint_tools_cmds.c
	* tools/pdbgen/enums.pl: regenerated.

2003-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c: added some stock icons to the dialog.

2003-03-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: use PICMAN_STOCK_IMAGE as default_stock_id.

	* app/widgets/picmanpreviewrendererimage.[ch]: use PicmanChannelType
	to specify the channel to render and convert it to the pixel index
	using picman_image_get_component_index() when needed. Use the new
	red, green, blue, gray and alpha icons when layer_previews is
	FALSE.

	* app/widgets/picmancomponenteditor.c: changed accordingly.

2003-03-24  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-image-[16|24].png: new icons by Jimmac.

	* themes/Default/images/stock-images-16.png: changed by Jimmac to
	make it look different than the new image icon.

	* themes/Default/images/stock-channel-red-[16|24].png
	* themes/Default/images/stock-channel-green-[16|24].png
	* themes/Default/images/stock-channel-blue-[16|24].png
	* themes/Default/images/stock-channel-gray-[16|24].png
	* themes/Default/images/stock-channel-alpha-[16|24].png: new icons
	derived from the generic channel icon.

	* themes/Default/images/stock-channel-[16|24].png: changed the
	color so they look different than the new green channel icon.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

2003-03-24  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-preview.[ch]: moved the image preview code
	to separate files.

	* app/core/picmanimage.c: removed the functions here. Removed the
	new utility function picman_image_previews_resize() because it
	did exactly what picman_image_size_changed() should do. Moved
	the missing bits to picman_image_size_changed().

	* app/core/picmanlayer.c (picman_layer_apply_mask): call
	picman_viewable_invalidate_preview() only if we don't call
	picman_drawable_update(). Calling them both is redundant.

2003-03-23  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c
	* app/gui/image-menu.c
	* app/gui/layers-menu.c: there doesn't seem to be a good reason to
	disallow the creation of layer masks on indexed images.

2003-03-23  Sven Neumann  <sven@picman.org>

	* Made 1.3.13 release.

2003-03-23  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_new_from_component): use
	picman_image_get_component_index() instead of doing the switch()es
	manually.

2003-03-22  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-preview.c
	* app/core/picmanimage.c (get_preview_size): return square
	dimensions in config->layer_previews is FALSE (except if the size
	is requested for a popup).
	(get_popup_size): don't create popups if config->layer_previews
	is FALSE.

	* app/core/picmanimage.c: added utility function
	picman_image_previews_resize() and call it on "notify::layer-previews".
	Calls picman_viewable_size_changed() on all drawables of the image
	and on the image itself. Ensures that drawable/image previews
	toggle their size correctly when toggling layer_previews.

	* app/widgets/picmanselectioneditor.c: create the selection preview
	as a popup so it keeps the image's aspect ratio when
	layer_previews is FALSE.

2003-03-22  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-channels-24.png
	* themes/Default/images/stock-images-24.png
	* themes/Default/images/stock-layers-24.png
	* themes/Default/images/stock-paths-22.png: added larger versions of
	some icons (provided by Jimmac).

	* libpicmanwidgets/picmanstock.c: added the new icons. Register icons
	in dialog size first.

2003-03-22  Sven Neumann  <sven@picman.org>

	* app/gui/layers-commands.c: always flush the image when applying
	or discarding a layer mask. The active drawable may change and
	make a menu update necessary (fixes bug #108958).

	* app/widgets/picmanlayertreeview.c: call picman_image_flush() when
	switching between layer and mask editing so the menus get updated.

2003-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainereditor.c: allow to create a
	PicmanContainerEditor without a popup menu.

	* app/widgets/picmancellrendererviewable.c: free the event we
	got from gdk_get_current_event().

	* app/widgets/picmancontainerview.c: check view->hash_table for
	being non-NULL before using it. Be prepared to be destroyed as
	a result of calling picman_context_set_foo(view->context, foo).

	* app/widgets/picmancontainertreeview.[ch]: added
	tree_view->editable_cells and handle *all* mouse clicks in
	picman_container_tree_view_button_press() (by returning TRUE). Start
	editing on double-click only. Use gtk_tree_view_set_cursor()
	instead of gtk_tree_selection_select_path() to avoid
	selected/focus confusion when the focus enters the widget. Be
	prepared to be destroyed as a result of item selection.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancontainerpopup.[ch]: new GtkWindow derived
	widget which pops up a selection of any PicmanContainer/PicmanContext
	combo.

	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanitemtreeview.c: add the name cell to
	tree_view->editable_cells so it becomes editable.

	* app/tools/picmanblendoptions.c
	* app/tools/paint_options.c: use the new container popup for
	selecting brushes and gradients.

2003-03-22  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-linked-12.png:
	* themes/Default/images/stock-eye-12.png: sharp icons

2003-03-21  Manish Singh  <yosh@picman.org>

	* plug-ins/common/ps.c: always quote the filename, since system/popen
	uses the shell. Also, never quote the filename if we are reading from
	a parameter file (only in the win32 case). Fixes #108648.

	* plug-ins/dbbrowser/dbbrowser_utils.c: double click on a list item
	files Apply, if applicable. Remove the existing model in the treeview
	(which will deallocate it) instead of clearing it.

2003-03-22  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-channel-16.png
	* themes/Default/images/stock-channel-24.png
	* themes/Default/images/stock-layer-16.png
	* themes/Default/images/stock-layer-24.png: new icons provided by
	Jimmac.

	* themes/Default/images/stock-eye-12.png
	* themes/Default/images/stock-linked-12.png: tiny visibility and
	linked icons that I created from Jimmac's small versions by
	scaling them down. Should probably be redone.

	* libpicmanwidgets/picmanstock.[ch]: allow to register multiple sizes
	for the same stock_id. Added new icons.

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: set default stock_ids so the new icons are
	used when layer previews are disabled.

2003-03-21  Sven Neumann  <sven@picman.org>

	* widgets/picmandockbook.c: renamed "tab_size" style property to
	"tab_icon_size" for consistency.

	* etc/gtkrc_user: changed accordingly.

2003-03-21  Sven Neumann  <sven@picman.org>

	* plug-ins/mosaic/mosaic_logo.h
	* plug-ins/mosaic/mosaic.c: converted the logo to pixbuf inline data
	and replaced the GtkPreview with a GtkImage.

	* plug-ins/print/picman_main_window.c: replaced some deprecated calls.

2003-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderer.c
	(picman_preview_renderer_set_viewable)
	(picman_preview_renderer_size_changed): don't rely on
	picman_preview_renderer_set_size() to invalidate the
	renderer. Instead, call picman_preview_renderer_invalidate() after
	resizing the renderer.

2003-03-21  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in.c (plug_in_open): added
	G_SPAWN_CHILD_INHERITS_STDIN to the flags passed to g_spawn_async().
	Needed to get batch-mode working again.

	* app/batch.[ch]: some cleanup.

	* plug-ins/script-fu/script-fu-text-console.c: improved error
	reporting.

2003-03-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c: don't emit the "scaled"
	signal from picman_display_shell_scale_setup(). Emit it explicitely
	from picman_display_shell_scale_resize() instead.

	* app/display/picmandisplayshell-scroll.c: call
	picman_display_shell_scale_setup() after scrolling in order to
	update scrollbars and rulers.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c: emit the "scaled" signal
	explicitely.

	* app/display/picmandisplayshell-render.c: minor optimizations.

	* app/display/picmandisplayshell.c: minor cleanup.

2003-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancellrendererviewable.c
	(picman_cell_renderer_viewable_clicked): show the popup preview
	again.

	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmantoolbox.c: removed useless #includes.

2003-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmaneditor.[ch]: added a PicmanItemFactory to the
	PicmanEditor struct. Added picman_editor_create_menu().

	* app/widgets/picmancolormapeditor.[ch]
	* app/widgets/picmancomponenteditor.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandataeditor.[ch]
	* app/widgets/picmanitemtreeview.[ch]: removed item_factory pointers
	and lots of inalizers which just unref'ed the item_factory.  Use
	picman_editor_create_menu() instead.

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

2003-03-20  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: implement GtkDialog::close() and
	synthesize a "delete_event" unconditionally.

	* app/widgets/picmanviewabledialog.c: emit "close" instead of
	synthesizing "delete_event".

	* app/widgets/picmanpreview.[ch]: removed "extended_clicked" signal
	and added "GdkModifierType state" to "clicked"'s signature.

	* app/gui/file-open-dialog.c
	* app/gui/test-commands.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmantoolbox-indicator-area.c: changed accordingly.

2003-03-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-new.c (picman_image_new_values_new): default
	the fill_type to PICMAN_BACKGROUND_FILL (as in picman_initialize()).

	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c: made more dialogs transient for their
	parent window.

	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanimageeditor.c
	* app/widgets/picmanundoeditor.c: simplified a little bit.

2003-03-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanbutton.[ch]: pass the modifier mask as
	GdkModifierType instead of guint.
	
	* app/core/picmanmarshal.list
	* app/widgets/picmancellrenderertoggle.c
	* app/widgets/picmancellrendererviewable.c
	* app/widgets/picmanpreview.c: use proper marshallers for signals
	that take flags as parameters.

	* app/core/picmancontext.c: added the G_SIGNAL_TYPE_STATIC_SCOPE flag
	to the PicmanRGB signal parameter.

2003-03-20  Michael Natterer  <mitch@picman.org>

	Removed deprecated and broken list views
	based on GtkList[Item] (fixes bug #90965):

	* app/widgets/picmanchannellistitem.[ch]
	* app/widgets/picmanchannellistview.[ch]
	* app/widgets/picmancontainerlistview.[ch]
	* app/widgets/picmandrawablelistitem.[ch]
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmanitemlistitem.[ch]
	* app/widgets/picmanitemlistview.[ch]
	* app/widgets/picmanlayerlistitem.[ch]
	* app/widgets/picmanlayerlistview.[ch]
	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanvectorslistview.[ch]: removed.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/widgets-enums.h
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmandatafactoryview.c
	* app/gui/channels-commands.c
	* app/gui/channels-menu.c
	* app/gui/drawable-commands.c
	* app/gui/layers-commands.c
	* app/gui/layers-menu.c
	* app/gui/palettes-commands.c
	* app/gui/test-commands.c
	* app/gui/vectors-commands.c
	* app/gui/vectors-menu.c: changed accordingly.

	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c: removed the term "tree" from all user visible
	places and create tree views when lists are requested.

2003-03-20  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.[ch]: removed gdisp->draw_guides
	and gdisp->snap_to_guides.

	* app/display/picmandisplayshell.[ch]: added shell->snap_to_guides.
	Added the state of guide, selection and active_layer visibility to
	the PicmanDisplayShellVisibility struct so they can be configured
	separately for fullscreen mode. Update the popup_factory in
	picman_display_shell_real_scaled() only if this is the active
	display.

	* app/display/picmandisplayshell-appearance.[ch]: added accessors
	for selection, active_layer and guide visibility.

	* app/display/picmandisplayshell-selection.[ch]: changed
	accordingly.  Changed the selection and active_layer toggle
	functions to *_set_hidden().

	* app/display/picmandisplayshell-callbacks.c
	* app/gui/image-menu.c
	* app/gui/view-commands.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmovetool.c: changed accordingly.

	* app/gui/gui.c (gui_display_new): update the menubar_factory
	*after* making the new display the active one.

2003-03-20  Sven Neumann  <sven@picman.org>

	* INSTALL: some minor updates.

2003-03-20  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]
	Fixed crashes and weird problems when the tool changed images or
	images got closed. Fixes Bug #108318.

	* app/vectors/vectors-types.h: More sane names for the
	PicmanAnchorType enum.

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c: changed accordingly.

2003-03-19  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_UNDO_GROUP_MASK.

	* app/tools/picmaneditselectiontool.c: use it for mask moving.
	Made the "undo_desc" strings more specific.

	* app/core/picmanundo.c: add it to the list of undo types for
	which mask previews are created.

	* app/core/picmanimage.c: s/Add Layer to Image/Add Layer/g etc.

2003-03-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancomponenteditor.c: need to connect to the cell
	renderer's "clicked" signal because "toggled" is not emitted any
	longer.

	* app/widgets/picmandrawabletreeview.c: removed debugging output.

	* app/widgets/picmanitemtreeview.[ch]: added "const gchar *reorder_desc"
	to the class scruct and use it as undo_desc for DND reordering.

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c: set reorder_desc.

2003-03-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancellrenderertoggle.[ch]
	* app/widgets/picmancellrendererviewable.[ch]: added public
	functions to emit the "clicked" signal.

	* app/widgets/picmancontainertreeview.c: use them instead of
	g_signal_emit_by_name().

	* app/widgets/Makefile.am
	* app/widgets/picmancontainertreeview-dnd.[ch]: new files
	implementing DND for tree views.

	* app/widgets/picmancontainertreeview.[ch]: added virtual
	functions drop_possible() and drop().

	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c: implement drop_possible()
	and drop().

2003-03-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandatafactoryview.c: enable in-place name
	editing for tree views.

2003-03-19  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-render.c: #include
	"core/picmanimage-colormap.h".

2003-03-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c: tweaked the dialog layout a little.

2003-03-18  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/java.xpm
	* plug-ins/imagemap/link.xpm
	* plug-ins/imagemap/Makefile
	* plug-ins/imagemap/imap_stock.[ch]: added 2 new icons.

	* plug-ins/imagemap/imap_edit_area_info.c: start at implementing 
	enhancement #91396 and #92635.

2003-03-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch] (picman_image_mask_translate)
	* app/core/picmanlayer.[ch] (picman_layer_translate): added
	"gboolean push_undo" parameters.

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-resize.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/layers-commands.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

	* app/core/picmanimage-undo-push.c (undo_pop_layer_displace): call
	picman_layer_translate() with "push_undo == FALSE" instead of
	duplicating picman_layer_translate()'s code. Use PicmanItemUndo for
	PICMAN_UNDO_MASK.

	* app/tools/picmaneditselectiontool.c
	(picman_edit_selection_tool_cursor_key): check if the top undo on
	the stack is of exactly the same type as the undo we would push
	and just don't push it then (compresses layer translate undos and
	fixes bug #86362). Changed stuff work with CAPS_LOCK or other
	modifiers pressed.

2003-03-18  Michael Natterer  <mitch@picman.org>

	Added an API for image colormap manupulation and made colormap
	changes undoable (fixes bug #25963).

	* app/core/Makefile.am
	* app/core/picmanimage-colormap.[ch]: new files implementing
	colormap getters/setters. The setters push undos using the
	new function below.

	* app/core/core-enums.[ch]: added PICMAN_UNDO_IMAGE_COLORMAP.

	* app/core/picmanimage-undo-push.[ch]: added
	picman_image_undo_push_image_colormap(). Use PicmanItemUndo even more
	often. Cleanup.

	* app/core/picmanimage.[ch]: removed picman_image_get_colormap() here.

	* app/core/picmanimage-convert.c
	* app/gui/colormap-editor-commands.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/image.pdb: use the new API.

	* app/pdb/image_cmds.c: regenerated.

	* plug-ins/common/vinvert.c: removed the comment about the bug,
	cosmetic cleanup.

	Unrelated:

	* app/gui/splash.c: added a frame around the splash. Please eek
	if it doesn't please you.

2003-03-17  Sven Neumann  <sven@picman.org>

	* data/images/picman_splash.png: new splash thanks to Jimmac.

2003-03-17  Michael Natterer  <mitch@picman.org>

	Made drawable/layer properties (visibility, opacity etc.)
	undoable (fixes bug #73893).

	* app/core/core-enums.[ch]: added undo types/groups for
	visibility, mode, opacity, linked and preserve_trans.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanitemundo.[ch]: new PicmanUndo subclass which holds a
	ref'ed PicmanItem pointer so (1) this doesn't need to be done by all
	undo steps related to an item and (2) the item the undo step is
	for can be determined from outside the undo system.

	* app/core/picmanimage-undo.[ch]: added picman_image_undo_push_item()
	which returns a new PicmanItemUndo.

	* app/core/picmanimage-undo-push.[ch]: use it for all item related
	undo steps. Removed lots of PicmanItem, PicmanLayer, PicmanDrawable
	and PicmanVectors pointers from the private undo structs. Added
	undo push functions for the new undo types added above.

	* app/core/picmandrawable.[ch] (picman_drawable_set_visible): added
	"gboolean push_undo" parameter.

	* app/core/picmanlayer.[ch] (picman_layer_set_opacity, _mode,
	_preserve_trans, _linked): added "gboolean push_undo" parameters.

	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanlayer-floating-sel.c
	* app/tools/picmanmovetool.c
	* app/xcf/xcf-load.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c: changed accordingly.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: ditto. Added '$undo' paramaters to
	the foo_accessors() functions. Removed $func from foo_accesors()
	because we don't manipulate items without using getters/setters
	any longer.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c: regenerated.

	* app/widgets/picmancellrenderertoggle.[ch]: added "clicked" signal
	which carries an additional "GdkModifierType state" parameter as
	in PicmanCellRendererViewable .

	* app/widgets/picmancontainertreeview.c: emit "clicked" from
	the toggle renderer, not "toggled" so the callbacks get the
	modifier state.

	* app/widgets/picmandrawabletreeview.c: resurrected the "exclusive
	visible by <shift>+click" feature as in 1.2.

	* app/widgets/picmanlayertreeview.c: compress layer opacity undos by
	looking at the top of the undo stack and not pushing an undo if
	there already is a PICMAN_UNDO_DRAWABLE_OPACITY for the active
	layer.

2003-03-17  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c (run): put the actual effect
	and the attachment of a parasite into an undo group so that only a
	single undo step is pushed when the plug-in is run.

2003-03-17  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.[ch]: added the new function
	picman_config_string_append_escaped(), see inline docs.

	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfigwriter.c
	* app/core/picmancontainer.c: use the new function instead of
	g_strescape().

2003-03-17  Sven Neumann  <sven@picman.org>

	Applied patches from David Necas <yeti@physics.muni.cz> that fix
	incorrect RGBA resampling in a number of plug-ins:

	* plug-ins/common/fractaltrace.c: fixes bug #72873.
	* plug-ins/common/tiler.c: fixes bug #72875.
	* plug-ins/common/waves.c: fixes bug #72870.
	* plug-ins/common/whirlpinch.c: fixes bug #72871.

2003-03-17  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_UNDO_CHANNEL_COLOR.

	* app/core/picmanchannel.[ch]: added "gboolean push_undo" to
	picman_channel_set_color().

	* app/core/picmanimage-undo-push.[ch]: added
	picman_image_undo_push_channel_color().

	* app/core/picmanimage-qmask.c
	* app/gui/qmask-commands.c
	* app/widgets/picmanchannellistitem.c
	* tools/pdbgen/pdb/channel.pdb: changed accordingly.

	* app/gui/channels-commands.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c: ditto. Use picman_item_rename().

	* app/pdb/channel_cmds.c: regenerated.

2003-03-17  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: use picman_item_rename for set_name.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c: regenerated

	* libpicmanproxy/Makefile.am: use $(top_srcdir)

2003-03-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added virtual function rename() which
	pushes an item rename undo. Added "default_name" and "rename_desc"
	to the PicmanItemClass struct which are used as default values.

	* app/core/picmanlayer.c: implement it and special-case floating
	selections. set item_clas->default_name and item_class->rename_desc.

	* app/core/picmanchannel.c
	* app/vectors/picmanvectors.c: set item_class->default_name and
	item_class->rename_desc.

	* app/widgets/picmanitemtreeview.[ch]: removed rename_item() virtual
	function and call picman_item_rename().

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c: changed accordingly.

2003-03-16  Sven Neumann  <sven@picman.org>

	* app/gui/file-save-dialog.c (file_save_overwrite): set the dialog
	transient to the file selection dialog (see bug #61092).

	* app/gui/info-dialog.c: set a window type hint of
	GDK_WINDOW_TYPE_HINT_UTILITY for info windows (fixes bug #92175).

	* app/tools/picmancolorpickertool.c: give the color area more space.

2003-03-16  Sven Neumann  <sven@picman.org>

	* configure.in: check for gdk-pixbuf-csource and allow to override
	it by setting the GDK_PIXBUF_CSOURCE environment variable.

	* themes/Default/images/Makefile.am: use the gdk-pixbuf-csource
	executable that was found at configure time.

	* app/base/levels.c: cosmetic change.

	* app/tools/picmanlevelstool.c: allow to pick white, gray and black
	point for all channels. Allows for easy white-point balancing.

	* plug-ins/script-fu/scripts/3dTruchet.scm: restore the foreground
	color when the script is done (see bug #108473).

2003-03-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.[ch]: added utility function
	picman_container_tree_view_find_click_cell(). Don't select the
	row if one of tree_view->toggle_cells was clicked. Removed
	"GList *toggle_columns" from the struct.

	* app/widgets/picmandrawabletreeview.[ch]: added a
	GtkTreeSelectionFunc which ensures that nothing but the floating
	selection can be selected. Removed the "eye_column" from the
	struct.

	* app/widgets/picmanitemtreeview.[ch]: added virtual function
	rename_item() and a default implementation.

	* app/widgets/picmanlayertreeview.[ch]: implement rename_item() and
	special case floating selections. Added
	picman_layer_tree_view_mask_update() utility function to factor out
	duplicated code. Removed "chain_column" from the struct. Cleanup.

2003-03-16  Michael Natterer  <mitch@picman.org>

	Added GtkTreeView versions of layers/channels/vectors:

	* app/core/core-enums.[ch]: renamed PICMAN_UNDO_GROUP_LAYER_PROPERTIES
	to PICMAN_UNDO_GROUP_ITEM_PROPERTIES.

	* app/core/picmancontainer.c (picman_container_reorder): don't try
	to reorder containers with num_children == 1.

	* app/core/picmanmarshal.list: added VOID: STRING, UINT marshaller.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanchanneltreeview.[ch]
	* app/widgets/picmandrawabletreeview.[ch]
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmanlayertreeview.[ch]
	* app/widgets/picmanvectorstreeview.[ch]: new widgets.

	* app/widgets/picmancellrenderertoggle.c: draw the frame only if the
	cell is prelit.

	* app/widgets/picmancellrendererviewable.[ch]: added "clicked"
	signal, unref the renderer in finalize(). Set the renderer's
	border color to black if the cell is not selected (a hack that
	saves tons of code in PicmanLayerTreeView).

	* app/widgets/picmancomponenteditor.c: no need to gtk_list_store_set()
	stuff we just got from the store.

	* app/widgets/picmancontainertreeview.[ch]: added lots of state used
	by the new subclasses to the PicmanContainerTreeView struct.  Create
	the GtkListStore/GtkTreeView in GObject::constructor() and only
	collect parameters in init() so subclasses can modify store/view
	creation. Do most of the button_press_event stuff manually and
	return TRUE from the handler.
	
	* app/widgets/picmancontainerview.c: cleanup.

	* app/widgets/picmanitemlistview.h
	* app/widgets/picmanvectorslistview.h: temp hacks before they die.

	* app/widgets/picmanpreviewrenderer.[ch]: added
	picman_preview_renderer_update_idle() which idle-emits "update"
	without invalidating.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: added constructors for the new dialogs.

	* app/gui/channels-commands.c
	* app/gui/channels-menu.c
	* app/gui/layers-commands.c
	* app/gui/layers-menu.c
	* app/gui/vectors-commands.c
	* app/gui/vectors-menu.c: accept tree views as callback data.

2003-03-15  Sven Neumann  <sven@picman.org>

	* app/base/levels.c (levels_adjust_by_colors): implemented this
	function which used to be a an empty stub.

	* app/tools/picmanlevelstool.c: implemented the missing
	functionality behind the color picker buttons I added some time
	ago.

2003-03-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_translate_func):
	simplified.

	* app/gui/image-menu.c: some minor menu cleanups.

2003-03-14  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-curve-free-16.png
	* themes/Default/images/stock-curve-smooth-16.png: added new icons
	provided by Tuomas Kuosmanen <tigert@picman.org>.

	* libpicmanwidgets/picmanstock.[ch]: register the new icons.

	* app/tools/picmancurvestool.[ch]: use radio buttons with the new
	curve type icons.

2003-03-14  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.[ch]	
	* app/base/curves.[ch]: changed CurvesType enum to PicmanCurveType
	and register it with the type system.

	* app/tools/picmancurvestool.c: use an enum menu here.

2003-03-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandock.c: fiddle with the color of the dock
	separator to make the drop area stand out. Added a tooltip.

	* etc/gtkrc_user: document how the color can be customized.

2003-03-14  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: let PicmanColorArea optionally
	draw a thin border around itself.

	* app/widgets/picmanitemfactory.c (picman_item_factory_set_color): use
	a PicmanColorArea instead of a deprecated GtkPreview.

2003-03-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.[ch]: some cleanup to event handling
	and drawing code. Doesn't draw outside the expose_event handler
	any longer but could still be improved.

2003-03-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancomponenteditor.c: disable expensive column
	auto-resizing and call gtk_tree_view_columns_autosize() in
	picman_component_editor_set_preview_size().

	* app/widgets/picmancontainertreeview.[ch]: ditto. Changed the
	GtkListStore pointer in the PicmanContainerTreeView struct to
	GtkTreeModel.

2003-03-13  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_create): suppress notifcation of
	startup completion from the splash screen.

	* app/widgets/picmantoolbox.c (picman_toolbox_init): set a window type
	hint of GDK_WINDOW_TYPE_HINT_NORMAL for the toolbox since UTILITY
	doesn't match here.

2003-03-13  Sven Neumann  <sven@picman.org>

	* app/gui/channels-commands.c: don't expose the internal term
	"component", use "channel" instead.

2003-03-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancellrenderertoggle.c
	* app/widgets/picmancellrendererviewable.c: handle RTL layout.

2003-03-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancellrenderertoggle.c: fixed size calculation,
	removed padding and the spacing between the icon and the frame
	around it.

	* app/widgets/picmanwidgets-utils.[ch]: added picman_get_icon_size()
	which returns the best matching icon size for a given allocation.

	* app/widgets/picmancomponenteditor.[ch]: adjust the eye icon's
	size according to the preview_size.

	* app/widgets/picmanpreviewrenderer.c
	(picman_preview_renderer_default_render_stock): use picman_get_icon_size()

	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainertreeview.c: iterate the tree model
	using a for() loop instead of nested if() { do { } while() }
	stuff.

2003-03-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h: made the PicmanPreviewSize enum values a
	little bit smaller. What used to be small is now called medium.

	* app/config/picmancoreconfig.c
	* app/gui/dialogs.c: changed accordingly.

2003-03-12  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancellrenderertoggle.[ch]: added a new cell_renderer
	derived from GtkCellRendererToggle.

	* app/widgets/picmancomponenteditor.c: use the new cell_renderer.

	* app/widgets/picmancellrendererviewable.[ch]: fixed a few typos and
	removed some redundant casts.

2003-03-12  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c: reordered the View menu, moved all
	Zoom-related entries into a submenu. Use radio items for the zoom
	ratio as suggested in bug #74385.

	* app/gui/view-commands.c (view_zoom_cmd_callback): only call
	picman_display_shell_scale() if the item is active and the current
	scale is different from the requested one.

	* app/display/picmandisplayshell.c (picman_display_shell_real_scaled):
	update the image menu so that the zoom ratio is displayed correctly.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_realize): don't call
	picman_display_shell_scale_setup(), since it is done in the configure
	event handler already.

2003-03-12  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added descriptions to the
	PicmanChannelType enum.

	* app/core/picmanimage.[ch]: added picman_image_get_component_index()
	utility function which does the PICMAN_RED_CHANNEL -> RED_PIX etc.
	mapping. Use it in all component getters/setters.

	* app/widgets/picmancomponenteditor.[ch]: new widget implementing
	the component list using GtkListStore/GtkTreeView. Still a bit
	ugly because it uses the standard check instead of the eye icon.

	* app/widgets/picmancomponentlistitem.[ch]: removed.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanvectorslistview.c: changed accordingly.

	* app/widgets/picmanchannellistview.[ch]: create a PicmanComponentEditor
	and removed the old GtkList based stuff.

	* app/widgets/picmanitemlistview.[ch]: keep around a pointer to the
	PicmanMenuFactory passed to the constructor.

	* app/gui/channels-menu.c (channels_menu_update): do the right
	thing if "data" is a PicmanComponentEditor.

	* app/gui/channels-commands.[ch]: ditto. Implemented duplicating
	of components and component to selection (bug #61018).

2003-03-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandock.c (picman_dock_init): set a window type hint
	of GDK_WINDOW_TYPE_HINT_UTILITY for dock windows (fixes bug #94669).

	* app/gui/splash.c (splash_create): set a window type hint of
	GDK_WINDOW_TYPE_HINT_SPLASHSCREEN.

2003-03-12  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel.[ch]: added picman_channel_new_from_component()
	which creates a new PicmanChannel from an image's color component.

	* app/gui/channels-commands.[ch]: added
	channels_duplicate_component_cmd_callback().

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.[ch]: added code to extract a color
	component from a PixelRegion (untested!).

	* plug-ins/common/checkerboard.c: cosmetics.

2003-03-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_create_thumbnail),
	(picman_imagefile_save_thumbnail)
	* app/gui/file-open-dialog.c (file_open_create_thumbnails): don't
	create thumbnails if core_config->layer_previews is FALSE
	(bug #107242).

	* app/file/file-save.c (file_save_as): call
	picman_imagefile_save_thumbnail() unconditionally since it does all
	the needed checks itself.

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/paint/picmanairbrush.c (picman_airbrush_paint): removed a
	leftover warning (bug #97214).

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: improved a few blurbs.

2003-03-11  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplayshell-appearance.[ch]: new files
	implementing canvas padding, fullscreen toggling and utility
	functions to show/hide PicmanDisplayShell components (menubar,
	statusbar, ...) Added the possibility to show/hide the scrollbars.

	* app/display/picmandisplayshell.[ch]: added struct
	PicmanDisplayShellVisibility which stores the GUI components'
	visibility. Added two such structs to the PicmanDisplayShell struct:
	one for normal mode and one for fullscreen mode. Default to
	"everything invisible" for fullscreen.  Fixes bug #74383.

	* app/display/picmandisplayshell-callbacks.c: fiddle with the
	two visibility structs when toggling fullscreen.

	* app/display/picmandisplayshell-handlers.c: #include
	"picmandisplayshell-appearance.h"

	* app/gui/image-menu.c
	* app/gui/view-commands.[ch]: added a "Show Scrollbars" menu entry,
	use the new widget show/hide utility functions.

2003-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_color_window.c (picman_dither_algo_callback):
	set the default dither algorithm as a fallback in case no
	algorithm matched (fix suggested by Ari Pollak). Fixes bug #102457.

	* plug-ins/print/picman_main_window.c: fixed wrong display of paper
	border that was introduced by my latest changes to the preview code.

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: made picman_image_get_active_components()
	a static function and changed its behaviour so that the image's
	active components are only used for layers, not for channels.
	Fixes bug #108083.

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/gui/session.c (session_info_deserialize): improved error
	handling.

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.[ch]
	* app/gui/image-menu.c
	* app/gui/view-commands.c: rewrote the fullscreen mode
	implementation so that it doesn't loop infinitely.

2003-03-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.[ch]
	* app/gui/image-menu.c
	* app/gui/view-commands.[ch]: added a fullscreen mode for the
	image display by means of gtk_window_fullscreen/unfullscreen.
	Depends on the window manager implementing _NET_WM_STATE_FULLSCREEN.

	* app/tools/picmancroptool.c: made picman_crop_tool_draw() static.

	* app/tools/picmantexttool.[ch]: derive from PicmanDrawTool, no real
	changes yet.

2003-03-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/xpm.c: don't add a transparent color entry for
	images that don't have an alpha channel (fixes bug #108034).

2003-03-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanscanner.[ch]: removed picman_scanner_parse_string_list()
	since the format it read wasn't proper s-expressions syntax.

	* app/config/picmanconfigwriter.c: a couple of minor cleanups.

	* app/gui/color-history.[ch]
	* app/gui/session.c
	* app/widgets/picmandialogfactory.[ch]: use PicmanConfigWriter to
	write the sessionrc. Had to do some minor changes to the file
	format.
	
2003-03-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette.[ch]: added PicmanData::duplicate()
	implementation so read-only palettes can be edited again by
	duplicating them first.

	* app/gui/dialogs-constructors.c: pass the <Palettes>, not the
	<Gradients> menu identifier to the palette grid and tree view
	constructors (spotted by Tigert).

2003-03-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfigwriter.[ch]: fixed creation of config file,
	added new function picman_config_writer_string() and improved
	picman_config_writer_linefeed().

	* app/config/picmanconfig-serialize.c
	* app/core/picmancontext.c
	* app/core/picmandocumentlist.c: use picman_config_writer_string()
	instead of escaping the string manually.

	* app/core/picmanunits.c (picman_unitrc_save): use a PicmanConfigWriter.

	* app/plug-in/plug-in-rc.[ch] (plug_in_rc_write)
	* app/plug-in/plug-ins.c: use a PicmanConfigWriter.

2003-03-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.[ch]: added "gboolean data_editable"
	which gets set in picman_data_editor_real_set_data(). Set the name
	entry insensitive if the data is not editable.

	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmangradienteditor.c: look at editor->data_editable
	instead of duplicating the logic in all subclasses.

	* app/widgets/picmanpreview.[ch]: added "gboolean expand" and
	picman_preview_set_expand() like in GtkPreview bacause smooth auto
	resizing can only be done by the widget itself, not via external
	callbacks.

	* app/display/picmannavigationview.c
	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanselectioneditor.c: set expand == TRUE. Removed
	"size_allocate" callbacks. They resize *much* smoother now.
	Various cleanups.

	* app/widgets/picmannavigationpreview.c: recalculate the preview
	coordinates when the size changes.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpreviewrenderer-utils.c
	* app/widgets/picmanpreviewrenderergradient.[ch]: new renderer which
	is much faster because it projects the gradient without creating
	intermediate buffers. Rendering can be restricted to an interval
	from [left...right].

	* app/widgets/picmangradienteditor.[ch]: undeprecated by using
	PicmanPreview instead of GtkPreview. Cleanup.

	* app/gui/gradient-editor-commands.c: changed accordingly.

2003-03-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c: resolved conflicts in tool
	keybindings (bug #107975).

2003-03-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmandatalist.c (picman_data_list_uniquefy_data_name): use
	picman_data_list_data_compare_func(), not just strcmp(), so the
	ordering of internal items is correct.

2003-03-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/deinterlace.c
	* plug-ins/common/pixelize.c: added parentheses where gcc
	suggested them.

2003-03-07  Sven Neumann  <sven@picman.org>

	* app/base/hue-saturation.[ch]: changed the hue_saturation()
	function as suggested by Martin Weber in bug #94067.  Changed the
	function signature to use a typed instead of a void pointer.

	* app/tools/picmanhuesaturationtool.c (picman_hue_saturation_tool_map):
	cast the hue_saturation() function pointer to a PicmanImageMapApplyFunc
	here.
	
2003-03-07  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/guides.pdb: allow to add guides with an offset
	of 0 (spotted by Paul Doidge, bug #90629).

	* app/pdb/guides_cmds.c: regenerated.

2003-03-07  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scroll.c: need to update the
	scrollbars now that the call to picman_display_shell_scale_setup()
	was commented out.  Removed the commented stuff and don't #include
	"picmandisplayshell-scale.h".  Resume the active tool *after*
	calling gdk_window_process_updates() to skip more useless drawing
	operations.

2003-03-06  Manish Sing  <yosh@picman.org>

	* tools/pdbgen/pdb/guides.pdb: fix find_next_guide to return 0 on
	the last guide as documented, instead of failing.

	* app/pdb/guides_cmds.c: regenerated

2003-03-06  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/stock-delete-16.png
	* themes/Default/images/stock-lower-16.png
	* themes/Default/images/stock-new-16.png
	* themes/Default/images/stock-paste-16.png
	* themes/Default/images/stock-raise-16.png
	* themes/Default/images/stock-refresh-16.png: removed these files
	since we use the icons provided by GTK+ now.

	* themes/Default/gtkrc
	* themes/Default/images/Makefile.am: removed them here hoo.

	* libpicmanwidgets/picmanstock.[ch]: reordered stuff to be consistent
	in the header and the .c file. Added PICMAN_STOCK_ERROR and
	PICMAN_STOCK_QUESTION which are available in all sizes (unlike
	GTK_STOCK_DIALOG_ERROR and GTK_STOCK_DIALOG_QUESTION).

	* app/core/picmanviewable.c
	* app/display/picmandisplayshell.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-save-dialog.c
	* app/widgets/picmanwidgets-utils.c
	* app/widgets/picmandatafactoryview.c: use the new stock IDs.

	* app/config/picmancoreconfig.[ch]: renamed "preview_size" to
	"layer_preview_size" and added "gboolean layer_previews" which
	switches layer previews on/off independent of their size.

	* app/config/picmanrc-blurbs.h: added/changed their blurbs.

	* app/core/core-enums.[ch]: removed PICMAN_PREVIEW_SIZE_NONE.

	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable.c
	* app/core/picmanimage.c: return NULL previews if
	core_config->layer_previews is FALSE. Invalidate all layer/channel
	previews whenever "layer_previews" changes.

	* app/widgets/picmanpreviewrendererdrawable.c
	* app/widgets/picmanpreviewrendererimage.c: render the stock_id
	if the drawable/image returns a NULL preview. Fixes bug #107242.

	* app/display/picmandisplayshell-handlers.c: don't set the
	sensitivity of the navigation button because it can no longer be
	disabled.

	* app/display/picmandisplayshell-layer-select.c
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c
	* app/gui/paths-dialog.c: changed accordingly.

	* app/gui/preferences-dialog.c: added a toggle button for the new
	"layer_previews" boolean.

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerlistview.c: chain up unconditionally
	in PicmanContainerView::clear_items().

	* app/widgets/picmancontainertreeview.c: ditto. Made the reorder()
	implementation lengthy and eeky (but working) again... Stop signal
	emission on double clicks so GtkTreeView doesn't re-select the
	item we are about change.

	* app/widgets/picmancontainerview.c
	(picman_container_view_real_clear_items): need to use
	g_hash_table_new_full() here too or everything will b0rk.

	* app/widgets/picmanpreviewrenderer.c
	(picman_preview_renderer_default_render_stock): use
	gtk_widget_render_icon() instead of gtk_icon_set_render_icon().

	* tools/pdbgen/enums.pl: this file wanted to be regenerated...

2003-03-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanparasitelist.c: fixed parasite serialization that
	I broke yesterday.

	* app/widgets/picmanenummenu.c: added support for mnemonics.

	* app/core/core-enums.h: removed the inverted variants from the
	PicmanAddMaskType enum. Registered the enum with the type system.

	* app/core/picmanlayer.c: changed accordingly.

	* app/gui/layers-commands.c (layers_add_mask_query): use an enum
	frame and added a check button that allows to invert the inital
	layer mask.

	* tools/pdbgen/pdb/layer.pdb: updated documentation for the
	picman-layer-create-mask PDB function.

	* plug-ins/script-fu/siod-wrapper.c: removed new enum values from
	the compatibility defines.

	* app/core/core-enums.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanenums.h
	* libpicman/picmanlayer_pdb.c
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2003-03-06  Sven Neumann  <sven@picman.org>

	* HACKING
	* INSTALL: updated for GTK+ 2.2.

2003-03-05  Manish Singh  <yosh@picman.org>

	* configure.in: require GTK+ 2.2. The 2.0.x series is no longer
	maintained, and there are some very real bugs that won't go away.

	* app/gui/about-dialog.c
	* app/widgets/picmanpreviewrenderer.c
	* app/widgets/picmantoolbox-color-area.c
	* plug-ins/common/uniteditor.c: remove special casing for GTK+ 2.0
	vs. 2.2

	* app/widgets/gtkwrapbox.[ch]
	* app/widgets/gtkhwrapbox.[ch]
	* app/widgets/gtkvwrapbox.[ch]: remove deprecated functions

	* app/gui/gui.c: free return value of gdk_get_display ()

	* app/widgets/picmancontainertreeview.c: use gtk_list_store_move_before()
	for reordering.

2003-03-05  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfigwriter.[ch]: new files featuring a simple
	config file writer.

	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig.[ch]: changed the serialize routines to
	use a PicmanConfigWriter instead of passing around a file descriptor
	and the indentation level.

	* app/config/config-types.h
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-dump.c
	* app/config/picmanconfig-utils.c
	* app/config/picmanrc.c
	* app/config/picmanscanner.c
	* app/config/test-config.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c
	* app/gui/test-commands.c
	* app/tools/tool_options.c
	* app/widgets/picmandevices.c: changed accordingly.

	* libpicmanwidgets/picmanwidgets.c: documentation updates.

	* app/core/picmanitem.c: removed a redundant type-check.

2003-03-05  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/stock-channels-16.png
	* themes/Default/images/stock-device-status-16.png
	* themes/Default/images/stock-images-16.png
	* themes/Default/images/stock-layers-16.png
	* themes/Default/images/stock-paths-16.png: new icons from Jimmac.

	* themes/Default/imagerc
	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.[ch]: add them to the stock system.

	* app/gui/dialogs-menu.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: use them.

2003-03-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanbrusheditor.[ch]: undeprecated and simplified a
	lot by using PicmanPreview instead of handmade preview stuff.

2003-03-05  Michael Natterer  <mitch@picman.org>

	* app/file/file-save.[ch]: added GError reporting, removed
	g_message() stuff.

	* app/gui/file-commands.c
	* app/gui/file-save-dialog.c: g_message() here if file_save_*()
	returns an error.

	* app/file/file-open.c: use the G_FILE_ERROR quark and the
	GFileError enum for reporting errors. Removed g_message() if the
	passed in GError** pointer is NULL (passing NULL as error return
	location should never mean "show the error message yourself").

	* app/app_procs.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandocumentview.c: g_message() here if file_open_*()
	returns an error.

2003-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c
	* plug-ins/fp/fp.c
	* plug-ins/rcm/rcm.c: moved these plug-ins to the Filters menu
	(fixes bug #107587).

	* app/gui/image-menu.c (image_menu_entries): removed a menu
	separator which is not needed any longer.

2003-03-04  Sven Neumann  <sven@picman.org>

        Based on suggestions by Michael J. Hammel <mjhammel@graphics-muse.org>:

	* app/gui/preferences-dialog.c: use US english spelling, fixed a
	typo.

	* app/config/picmanrc-blurbs.h: rephrased some blurbs so they fit
	better as tooltips.

2003-03-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.[ch]: set the active color from
	PicmanColormapEditor::selected so you can pick colors from an
	indexed palette again.

2003-03-04  Michael Natterer  <mitch@picman.org>

	* app/file/file-save.[ch]: added new function file_save_as() which
	always uses the uri and file_proc parameters passed and never
	looks at the image's uri and file_proc. Renamed "gboolean set_uri"
	to "set_uri_and_proc" and always set them both if the save
	succeeded.  Fixes bug #97835.  Removed most parameters from
	file_save() and made it a small wrapper around file_save_as().

	* app/gui/file-commands.c (file_save_cmd_callback): changed
	accordingly.

	* app/gui/file-save-dialog.c: call file_save_as(), renamed
	"set_uri" variables to "set_uri_and_proc".

2003-03-03  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanpaintcore.c:
	s/paint_options != NULL/PICMAN_IS_PAINT_OPTIONS (paint_options)/g

2003-03-03  Hans Breuer  <hans@breuer.org>

	* app/text/makefile.msc (new file)
	  */makefile.msc */*/makefile.msc : updated

	* app/core/picmandata.c : define access() constants
	for G_OS_WIN32 case

	* app/text/picmantext.c : <stdlib.h> for getenv()

	* libpicman/picman.def libpicman/picmanui.def : updated externals

	* libpicmanwidgets/libpicman-glue.c : make dynamic_resolve
	actually work again for 'my' DLL naming convention

	* plug-ins/gap/gap_pdb_calls.c : reflect renaming
	of PICMAN_VERTICAL to PICMAN_ORIENTATION_VERTICAL

2003-03-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderer.[ch]: made the default buffer
	and stock rendering functions public so derived renderers
	can use them. Renamed picman_preview_renderer_render_preview()
	to picman_preview_renderer_render_buffer().

	* app/widgets/picmanpreviewrendererbrush.c
	* app/widgets/picmanpreviewrendererdrawable.c
	* app/widgets/picmanpreviewrendererimage.c: changed accordingly.

	* app/widgets/picmanpreviewrenderertextlayer.[ch]: new renderer
	for text layers which always renders the stock icon.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpreviewrenderer-utils.c: changed accordingly.

2003-03-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c (edge): fixed a typo in the kernel for
	sobel vertical edge detection spotted by Sunil Mohan Adapa (bug
	#107441).

2003-03-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderer.[ch]: removed the constructors
	with a PicmanViewable parameter and always create renderers from
	viewable types only. Made picman_preview_renderer_update() emit only
	the "update" signal and added the new function
	picman_preview_renderer_invalidate() which does what the old
	_update() did (invalidating and adding an idle function which
	emits "update"). Added picman_preview_renderer_remove_idle() so
	renderer updating can be fully controlled using public functions.

	* app/widgets/picmanpreviewrendererbrush.[ch]: no need to remember
	the widget for the brushpipe animation, simply call
	picman_preview_renderer_update() in the animation timeout.

	* app/widgets/picmanpreview.[ch]
	* app/widgets/picmancontainertreeview.c: changed accordingly. Call
	picman_preview_renderer_remove_idle() after setting the initial
	viewable because we will be updated anyway by the first expose.

	* app/widgets/picmanpreview.[ch]: Added a size_request()
	implementation. Removed picman_preview_update(). Added new
	constructor picman_preview_new_full_by_types() to make the
	constructor API symmetric. Removed code duplication by calling the
	_by_types() constructors from the ones taking PicmanViewable
	parameters.

	* app/gui/palette-import-dialog.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmanselectioneditor.c: changed accordingly.

2003-03-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_create_mask): don't try to
	convert a grayscale layer to grayscale. Fixes bug #107422.

2003-03-02  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanbilinear.[ch]
	* libpicmancolor/picmancolor.def: applied a patch from David Necas
	<yeti@physics.muni.cz> that adds picman_bilinear_pixels_8(), a new
	function that computes the bilinear interpolation of four pixels.

2003-03-02  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/guides.pdb
	* app/pdb/guides_cmds.c: fixed picman_image_find_next_guide() which
	was broken for the case when the image had no guides at all. Fixes
	the hanging rotate plug-in (bug #106823).

2003-03-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreviewrenderer.[ch]: added "gint bytes" to the
	PicmanPreviewRenderer struct and pass it to
	picman_preview_render_to_buffer().

	* app/widgets/picmanpreviewrendererbrush.[ch]: render the indicators
	to the renderer's buffer, not to the TempBuf so they always appear
	in the corner again.

	Misc cleanups:

	* app/core/picmanbuffer.c (picman_buffer_get_new_preview)
	* app/core/picmanpattern.c (picman_pattern_get_new_preview): no need
	to center the TempBuf if smaller than requested because
	PicmanPreviewRenderer::render()'s default implementation adjusts the
	offsets itself.

	* app/widgets/picmanpreview.c (picman_preview_set_viewable): no need
	to update ourselves after we changed the renderer because the
	renderer's signal will update us.

	* app/widgets/picmanpreviewrenderer.c (picman_preview_renderer_draw):
	replaced my stupid buf_rect calculation overkill by something
	simple that does the same.

2003-03-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbuffer.c: don't scale the preview up if the
	buffer is too small.

	* app/core/picmanpattern.c: don't add a white border around the
	preview if the pattern is too small.

	* app/widgets/picmanpreviewrenderer.[ch]: new object. A buffer
	that updates itself on PicmanViewable changes and can render
	itself to any widget. Basically PicmanPreview reduced to the
	render and draw code.

	* app/widgets/picmanpreview.[ch]: removed all rendering and drawing
	code and keep a PicmanPreviewRenderer instance. Connect to its
	"update" signal for queuing draws on the preview.

	* app/widgets/picmancellrendererviewable.[ch]
	* app/widgets/picmancontainertreeview.c: same here: removed
	rendering and drawing code and keep PicmanPreviewRenderers in the
	list store.  Delays preview creation for GtkTreeViews until the
	buffer is really needed for drawing and adds idle preview updating
	on viewable changes.

	* app/widgets/picmanpreview-utils.[ch]
	* app/widgets/picmanbrushpreview.[ch]
	* app/widgets/picmanbufferpreview.[ch]
	* app/widgets/picmandrawablepreview.[ch]
	* app/widgets/picmanimagepreview.[ch]: removed...

	* app/widgets/picmanpreviewrenderer-utils.[ch]
	* app/widgets/picmanpreviewrendererbrush.[ch]
	* app/widgets/picmanpreviewrendererdrawable.[ch]
	* app/widgets/picmanpreviewrendererimage.[ch]: ...and converted to
	PicmanPreviewRenderer subclasses.

	* app/display/picmannavigationview.c
	* app/gui/palette-import-dialog.c
	* app/widgets/Makefile.am
	* app/widgets/widgets-enums.h
	* app/widgets/widgets-types.h
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmannavigationpreview.[ch]
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanvectorslistview.c: changed accordingly.

2003-03-01  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanblendtool.c: removed useless includes.

2003-02-28  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c (picman_context_class_init): oops.

2003-02-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.[ch]: transparently serialize
	and deserialize object properties that implement the
	PicmanConfigInterface.

	* app/config/picmanconfig-utils.c (picman_config_reset_properties):
	call reset recursively if properties are itself objects that
	implement the PicmanConfigInterface.

	* app/config/picmanconfig-dump.c: adapt to API changes.

	* app/config/picmanconfig-params.h: made object properties installed
	using PICMAN_CONFIG_INSTALL_PROP_OBJECT() be not writable by default.

	* app/core/picmancontext.c (picman_context_class_init): made objects
	properties explicitely writeable.

	* app/tools/picmantextoptions.c: made the PicmanText object a property
	of PicmanTextOptions and removed lots of special handling which is
	now transparently done by PicmanConfigInterface.

2003-02-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.[ch]: renamed
	picman_config_serialize_changed_properties() to
	picman_config_serialize_properties_diff() and added a new function
	picman_config_serialize_changed_properties() that saves only
	properties that have been changed from their default values.
	
	* app/config/picmanrc.c: follow the function name change.

	* app/core/picmancontext.c: override PicmanConfigInterface::serialize
	with picman_config_serialize_changed_properties() so we store only
	tool_options that have been changed from their default values.

2003-02-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.c
	(picman_config_serialize_changed_properties): simplified by using
	picman_config_serialize_property() instead of doing it all by hand.

2003-02-27  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/doc/Makefile.am: make clean shouldn't clean disted
	files

2003-02-27  Manish Singh  <yosh@picman.org>

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninkoptions.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmancellrendererviewable.c
	* app/widgets/picmancontainertreeview.c: remove unecessary G_OBJECT()
	from g_object_set calls.

	* plug-ins/common/bumpmap.c: use g_signal_handlers_(un)block_by_func
	instead of gtk_signal_handler_(un)block_by_data.

2003-02-27  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.c: fixed picman_rgb_intensity_uchar() which
	used to return 0 or 1 instead of 0 to 255. Fixes bug #107202.

2003-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-undo-push.c (undo_push_layer_mask): fixed
	typo which caused layer mask undo to fail.

2003-02-27  Raphael Quinet  <quinet@gamers.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/alien-neon-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/bovinated-logo.scm
	* plug-ins/script-fu/scripts/chalk.scm
	* plug-ins/script-fu/scripts/chip-away.scm
	* plug-ins/script-fu/scripts/chrome-logo.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/frosty-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/glowing-logo.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/neon-logo.scm
	* plug-ins/script-fu/scripts/script-fu-util.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/t-o-p-logo.scm
	* plug-ins/script-fu/scripts/textured-logo.scm: applied a slightly
	modified version of the patch provided by Chauk-Mean PROUM to fix
	the behavior of some alpha-to-logo scripts when the layer has a
	non-zero offset or if a selection exists.  Fixes bug #73891.
	
2003-02-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added virtual function
	get_popup_size() which returns a boolean indicating if a popup is
	needed and its size.

	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmandrawable-preview.[ch]
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmanundo.c: implement it.

	* app/widgets/picmanpreview.[ch]: removed virtual functions
	needs_popup() and create_popup(). Removed the code which creates
	the popup and the popup members of the PicmanPreview struct.

	* app/widgets/picmanpreview-popup.[ch]: new files providing the
	utility function picman_preview_popup_show() which can show popups
	from any widget, not just from a PicmanPreview. Checks if a popup is
	needed using picman_viewable_get_popup_size().

	* app/widgets/picmancellrendererviewable.c: show popups here too.

	* app/widgets/picmanbrushpreview.c
	* app/widgets/picmanbufferpreview.c
	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmanimagepreview.c: removed needs_popup() and
	create_popup() implementations.

	* app/widgets/picmannavigationpreview.c: removed empty render()
	implementation.

	* app/widgets/picmanundoeditor.c: use a tree instead of a list view.

	* app/widgets/picmangradientpreview.[ch]
	* app/widgets/picmanpalettepreview.[ch]
	* app/widgets/picmanpatternpreview.[ch]: removed because they only
	implemented the removed popup functions.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanpreview-utils.c: changed accordingly

2003-02-26  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.c (picman_config_serialize_properties):
	don't insert an extra line-break after a serialized property.

	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-dump.c
	* app/gui/tips-parser.c: use g_string_truncate (str, 0) instead of
	assigning an empty string.

	* app/tools/picmantextoptions.c: override the serialize and
	deserialize methods of the PicmanConfig interface and save/restore
	the associated PicmanText object instead of PicmanTextOptions.

	* app/tools/tool_options.c (picman_tool_options_build_filename):
	don't append ".default" if no extension is given.

2003-02-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c: removed debugging output.

2003-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.[ch]: added a writeable field to PicmanData and
	set it from picman_data_set_filename().

	* app/gui/brushes-menu.c
	* app/gui/gradients-menu.c
	* app/gui/palettes-menu.c
	* app/gui/patterns-menu.c
	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmangradienteditor.c: look at data->writeable when
	setting widgets sensitivity.

	* app/gui/user-install-dialog.c (user_install_dialog_create): reduce
	some of the dialog clutter by not showing the directories created for
	plug-ins.

	* app/core/picmanviewable.[ch]: added a default_stock_id to
	PicmanViewableClass so we don't need to hold a copy in each instance.
	Added accessor functions to set and get the stock_id.

	* app/core/picmantoolinfo.c
	* app/gui/dialogs-constructors.c
	* app/gui/image-menu.c
	* app/tools/picmancroptool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmancellrendererviewable.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmantoolbox.c: use picman_viewable_get_stock_id().

	* app/text/picmantextlayer.c: set a text icon as default stock_id.

2003-02-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added "gchar *stock_id" to the
	PicmanViewable struct. It is used by the GUI if the get_preview()
	functions return NULL. Default to GTK_STOCK_DIALOG_QUESTION.

	* app/core/picmantoolinfo.[ch]: set the tool's stock_id. Removed
	the cached GdkPixbuf. Don't implement any preview function
	so the GUI uses the stock_id.

	* app/tools/tool_manager.c: removed GdkPixbuf creation, removed
	the #warning about the buggy way we created the pixbuf.

	* app/gui/dialogs-constructors.c
	* app/gui/image-menu.c
	* app/tools/picmancroptool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmantoolbox.c: use viewable->stock_id instead
	of tool_info->stock_id.

	* app/core/picmanbrush.c
	* app/core/picmangradient.c
	* app/core/picmanimagefile.c
	* app/core/picmanundo.c: simplified get_preview() implementations:

	- never scale previews up, only down.
	- don't render white or checks backgrounds but simply return
	  TempBufs with alpha and let the preview system do its job.
	- don't add padding but simply return previews smaller than
	  requested.

	* app/display/picmandisplayshell-render.[ch]: added
	"render_blend_white", a 2d lookup table for blending on white,
	just as the check lookup tables. Added "render_white_buf".

	* app/widgets/picmanpreview.[ch]: changed a lot:

	- don't render the preview's border into the buffer.
	- added "GdkGC *border_gc" and draw the preview's border in expose()
	  using gdk_draw_rectangle().
	- added "GdkPixbuf *no_preview_pixbuf" and create it in
	  picman_preview_real_render() if picman_viewable_get_preview()
	  returned NULL.
	- factored the actual preview rendering out to
	  picman_preview_render_to_buffer(). Added configurable background
	  rendering for the preview itself and it's padding area
	  (the area the preview is larger than the buffer returned
	  by picman_viewable_get_preview()).
	- changed picman_preview_render_and_flush() to
	  picman_preview_render_preview() and added "inside_bg" and
	  "outside_bg" parameters.
	- use the new render buffers for blending on white.

	* app/widgets/picmanbrushpreview.c
	* app/widgets/picmanbufferpreview.c
	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmangradientpreview.c
	* app/widgets/picmanimagepreview.c
	* app/widgets/picmanpalettepreview.c
	* app/widgets/picmanpatternpreview.c: don't create large white
	TempBufs to center the previews in but simply set the TempBuf's
	offsets to get them centered. Simplified & cleaned up many preview
	render functions. Pass the correct PicmanPreviewBG modes to
	picman_preview_render_preview().

	* app/widgets/picmancellrendererviewable.[ch]: new GtkCellRenderer
	class derived from GtkCellRendererPixbuf which knows how
	to use picman_viewable_get_preview_size() and renders the
	viewable's stock item if no preview can be created.

	* app/widgets/picmancontainertreeview.c: added a GtkTreeCellDataFunc
	which creates the preview pixbuf if needed so we don't create it
	unconditionally upon item insertion. Fixed preview size assertion
	to use PICMAN_PREVIEW_MAX_SIZE, not "64". Block "selection_changed"
	while reordering the selected item.

	* app/widgets/picmancontainerview.c: cosmetic.

	* app/widgets/picmanimagefilepreview.[ch]
	* app/widgets/picmantoolinfopreview.[ch]
	* app/widgets/picmanundopreview.[ch]: removed because the default
	implementation is good enough.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpreview-utils.c: changed accordingly.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: register grid and tree view variants
	of the document history.

	Unrelated:

	* app/gui/gui.c (gui_exit_finish_callback): disconnect from
	signals earlier.

	* app/gui/user-install-dialog.c: create the "tool-options" subdir
	of the user's ~/.picman-1.3 directory.

2003-02-26  Sven Neumann  <sven@picman.org>

	* autogen.sh: moved the call to libtoolize before automake.

	* libpicmanwidgets/picmancolorscale.c: added some inline docs.

	* libpicmanwidgets/picmanwidgets.[ch]: changed picman_spin_button_new(),
	picman_scale_entry_new() and picman_color_scale_entry_new() to take
	doubles instead of floats for the adjustment values.

2003-02-25  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.[ch]
	* app/display/picmandisplayshell.c: override GtkWidget::popup_menu()
	so we popup the Image menu on the default shortcut (Shift F10).

	* app/gui/image-menu.c (image_menu_entries): removed or replaced
	shortcuts that use the Alt key. Added access keys to all toplevel
	entries of the Image menu (see bug #106991).

	* app/gui/tools-commands.[ch]: removed "Swap Contexts" functionality.

	* app/widgets/picmanselectioneditor.[ch]: moved "Invert" button.

2003-02-25  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: replaced the "gboolean
	title_dirty" in PicmanDisplayShell by "guint title_idle_id".
	(picman_display_shell_flush): Call picman_display_shell_update_title()
	unconditionally. Don't call info_window_update().

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-scale.c: ditto.

	* app/display/picmandisplayshell-title.c: update the title in an
	idle function. Call info_window_update() from the idle function.

2003-02-25  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/display/picmandisplayshell.c
	* app/gui/preferences-dialog.c: applied a modified version of a
	patch from Toralf Lund <toralf@kscanners.no> that adds a new
	preferences option to choose the inital zoom ratio. Fixes bug
	#106730 and in my opinion also #103547.

2003-02-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: replaced the GtkList with a
	GtkTreeView/Model, replaced all deprecated GTK+ calls.

	* plug-ins/common/uniteditor.c: cosmetics.

2003-02-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.c (picman_container_view_remove):
	remove the insert_data from the hash table *after* calling the
	virtual remove_item() functions because PicmanContainerTreeView's
	GtkTreeIters are freed by the hash table when removing them.

2003-02-25  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h
	* app/gui/preferences-dialog.c: tried to improve the explanations
	of the new undo limits.

2003-02-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectselecttool.c (picman_rect_select_tool_motion):
	if in free select mode set width and height in the tool options.

	* app/tools/picmanselectionoptions.c: relaxed the limits for the
	fixed-width and fixed-height properties.

2003-02-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): the gtk_tree_model_get()
	argument list ends with -1, not NULL.

2003-02-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: code cosmetics.

2003-02-24  Sven Neumann  <sven@picman.org>

	* autogen.sh: prefer automake-1.7 over automake-1.6.

	* configure.in: removed the call to AC_PROG_RANLIB again since
	according to automake it is rendered obsolete by AC_PROG_LIBTOOL.

2003-02-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.[ch]: added "GDestroyNotify
	insert_data_free" to the PicmanContainerViewClass struct. Pass it as
	"value_destroy_func" to g_hash_table_new_full().

	* app/widgets/picmancontainertreeview.[ch]: set g_free() as
	insert_data_free, so we don't leak the GtkTreeIters used as
	insert_data. Added DND stuff (you can drag any item without
	selecting it using mouse button 2). Lots of cleanup and changes.

	* app/widgets/picmancontainereditor.c: cosmetic.

2003-02-24  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.[ch]
	* app/text/picmantextlayout.c: added a language property to PicmanText
	which defaults to the language derived from the users locale. Set
	the language on the PangoContext.

2003-02-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mblur.c: added parentheses to please the
	compiler and to make the code more legible.

2003-02-24  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-commands.c (dialogs_toggle_view_cmd_callback):
	fixed strstr() call so we can switch back from tree views again.

2003-02-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay-foreach.[ch]: removed
	picman_displays_invalidate() again.

	* app/display/picmandisplayshell-render.c: don't call it.

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_check_notify_handler): put the call to
	picman_display_shell_expose_full() back I "optimized" away a few
	days ago.

2003-02-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: some code cleanup, fixed
	preview drawing, use PicmanColorButtons and stock icons.

2003-02-23  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* README.perl: removed this file.

	* INSTALL
	* README
	* README.i18n
	* picman.spec.in: removed traces of picman-perl and added some
	pointers to the new CVS module.

2003-02-23  Sven Neumann  <sven@picman.org>

	* app/gui/convert-dialog.c (convert_to_indexed): set the correct
	default value for the palette type menu (fixes bug #106798).

2003-02-22  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c: documented picman_rc_save().

2003-02-22  Dave Neary  <bolsh@picman.org>

        * plug-ins/common/png.c: Fixed bug #105360. Previously,
        alpha was taking up an index entry even if there were
        no transparent entries. Sorry about that :)

2003-02-21  Manish Singh  <yosh@picman.org>

	* configure.in: oops, put back in perl binary location stuff for
	pdbgen.

2003-02-21  Manish Singh  <yosh@picman.org>

	* Makefile.am
	* plug-ins/Makefile.am: perl remnants here too

2003-02-21  Manish Singh  <yosh@picman.org>

	* configure.in: remove perl stuff

	The actual code has been removed from CVS as well, and moved to the
	picman-perl module.

2003-02-21  Manish Singh  <yosh@picman.org>

	* app/gui/about-dialog.c
	* app/widgets/picmanimagefilepreview.c
	* app/widgets/picmantoolbox-color-area.c: use gdk_draw_pixbuf with
	GTK+ 2.2 or higher instead of gdk_pixbuf_render_to_drawable.
	That function will be deprecated in GTK+ 2.4. We should remove the
	fallback at some point when we start depending on GTK+ 2.2 for other
	stuff.

2003-02-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay-foreach.[ch]: added new function
	picman_displays_invalidate() which queues a redraw on all displays
	by calling picman_display_shell_expose_full().

	* app/display/picmandisplayshell-render.c (render_setup_notify):
	invalidate all displays when the transparency type or size changes.

	* app/tools/picmantexttool.c (text_tool_button_press): readded some
	code I accidentally removed in my last commit.

	* app/text/picmantextlayout.c (picman_text_layout_new): always set the
	font size but make sure it is at least 1.

2003-02-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewabledialog.c: added missing cast.

	* app/widgets/picmancontainertreeview.c: do not include a non-existant
	header file.

2003-02-21  Michael Natterer  <mitch@picman.org>

	Started migration from GtkList to GtkTreeView:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancontainertreeview.[ch]: new PicmanContainerView
	subclass using GtkListStore/GtkTreeView.

	* app/widgets/widgets-enums.h: added PICMAN_VIEW_TYPE_TREE to
	the PicmanViewType enum.

	* app/widgets/picmancontainereditor.c: added PicmanContainerTreeView
	to the switch() which selects the view type.

	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c: added tree view versions of many dialogs.

	* app/widgets/picmanpreview.[ch]: removed the get_size() virtual
	function and picman_preview_calc_size().

	* app/core/picmanviewable.[ch]: added virtual function
	get_preview_size() and picman_viewable_calc_preview_size().

	* app/core/picmanbuffer.c
	* app/core/picmandrawable-preview.[ch]
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage.c
	* app/core/picmanpalette.c: added get_preview_size() implementations.

	* app/widgets/picmanbufferpreview.c
	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmangradientpreview.c
	* app/widgets/picmanimagepreview.c
	* app/widgets/picmanpalettepreview.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanundopreview.c
	* app/display/picmannavigationview.c: changed accordingly, removed
	get_size() implementations.

	* app/widgets/widgets-types.h: changed the first param of
	PicmanItemGetNameFunc from GtkWidget to GObject.

	* app/widgets/picmancontainerview-utils.c: accept a PicmanViewable as
	object in the built-in get_name funcs.

	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c: changed accordingly.

2003-02-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scroll.c (picman_display_shell_scroll):
	don't wait for graphics expose events. Commented out the call to
	picman_display_shell_scale_setup() since it should not be needed.

2003-02-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c (render_image_rgb):
	replaced a for-loop with a call to memcpy().

	* app/display/picmandisplay.c: use g_memdup() instead of g_new()
	followed by memcpy().

2003-02-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformoptions.c
	(picman_transform_options_class_init): the default value of "clip"
	is FALSE, not TRUE. Fixes bug #106644.

2003-02-21  Michael Natterer  <mitch@picman.org>

	Refactored the PicmanDisplayShell update/draw code:

	* app/display/picmandisplayshell.[ch]: removed the display_areas
	list which used to hold the PicmanAreas to update. Instead, simply
	queue draws using gtk_widget_queue_draw[_area]() in
	picman_display_shell_expose_area(), _expose_full() and
	_expose_guide(). Made all _draw() functions public because they
	are now called from the "expose_event" handler.  Removed rendering
	from picman_display_shell_flush() because stuff is now flushed
	automatically by the gtk idle renderer.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_expose): draw everything here (the code
	removed from picman_display_shell_flush() without the PicmanArea list).
	(picman_display_shell_canvas_tool_events): return "return_val", not
	TRUE if picman->busy is TRUE. Fixes unupdated (windowk bg color)
	display areas. Fixes bug #106595.

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-cursor.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-selection.c
	* app/gui/view-commands.c: changed accordingly. Removed calls to
	picman_display_shell_flush() all over the place.

	* app/display/picmandisplayshell-scroll.c: replaced lots of code by
	a single call to gdk_window_scroll().

2003-02-21  Sven Neumann  <sven@picman.org>

	* INSTALL: fixed URL of libart package, spotted by Michael J. Hammel.

2003-02-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.[ch] (picman_table_attach_stock):
	added a colspan parameter and fixed packing of the stock icon.

	* app/tools/picmanselectionoptions.c
	* app/tools/picmantextoptions.c: improved dialog layout.

2003-02-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c
	* app/widgets/picmanfontselection.c: connect the dialog to the font
	selection widget and block the signal handler when the font is
	changed from the dialog. Fixes weird behaviour noted by Jimmac.

2003-02-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: always start with an empty text.

2003-02-20  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_utf8_strtrim): trim the string
	only if necessary.

	* app/text/picmantext.c: changed the default text to NULL.

	* app/widgets/picmantexteditor.[ch]: replaced Cancel and OK buttons
	with a single Close button and removed the callback.

	* app/widgets/picmanpropwidgets.c: gtk_text_buffer_set_text()
	doesn't like NULL pointers, pass it an empty string instead.

	* app/tools/picmantexttool.c: create a new text layer as soon as the
	user starts editing.

2003-02-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimageeditor.[ch]: new PicmanEditor subclass adding
	a PicmanImage pointer and a virtual set_image() function.

	* app/widgets/picmancolormapeditor.[ch]
	* app/widgets/picmanselectioneditor.[ch]
	* app/widgets/picmanundoeditor.[ch]: derive them from PicmanImageEditor.
	Removed the public set_image() functions.

	* app/gui/colormap-editor-commands.c
	* app/gui/colormap-editor-menu.c: changed accordingly.

	* app/gui/dialogs-constructors.c: removed lots of code duplication
	and use the uniform PicmanImageEditor API. Misc cleanups.

2003-02-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanmarshal.list: reduced to the set of marshallers we
	actually use.

	* libpicmanwidgets/picmanwidgetsmarshal.list: documented.

2003-02-20  Michael Natterer  <mitch@picman.org>

	Reimplemented the undo history:

	* app/Makefile.am
	* app/undo_history.[ch]: removed.

	Changes/cleanups to the undo system to enable/simplify the new
	undo history implementation:

	* app/core/core-types.h: removed enum undo_event_t. Removed the
	PicmanImage parameter from PicmanUndoPopFunc and PicmanUndoFreeFunc
	because PicmanUndo has a PicmanImage pointer now (see below).

	* app/core/core-enums.[ch]: added enum PicmanUndoEvent. Added an
	enum value for REDO_EXPIRED.

	* app/core/picmanimage.[ch]: added a PicmanUndo pointer to the
	"undo_event" signal which needs to be passed for all events except
	UNDO_FREE.

	* app/display/picmandisplayshell-handlers.c: changed accordingly.

	* app/core/picmanundo.[ch]: added a PicmanImage pointer to the
	PicmanUndo struct. Removed PicmanImage parameters all over the
	place. Added preview stuff. The preview creation needs to be
	triggered explicitly using picman_undo_create_preview() because the
	PicmanUndo can't know when it's possible to create the preview.

	* app/core/picmanimage-undo-push.c
	* app/paint/picmanpaintcore-undo.c
	* app/tools/picmantransformtool-undo.c: changed accordingly, cleanup.

	* app/core/picmanundostack.[ch]: ditto. Return the freed undo from
	picman_undo_stack_free_bottom(). Removed unused container signal
	handlers.

	* app/core/picmanimage-undo.c: free the redo stack the same way old
	undos are freed (from bottom up). Emit "undo_event" with event ==
	REDO_EXPIRED for each removed redo.

	* app/core/picmanmarshal.list: added new marshallers.

	New undo history implementation:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanundoeditor.[ch]
	* app/widgets/picmanundopreview.[ch]: new widgets for the undo
	step previews and the history itself.

	* app/widgets/picmanpreview-utils.c: added PicmanUndoPreview to the
	list of possible preview types.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs-menu.c
	* app/gui/dialogs.c
	* app/gui/image-menu.c
	* app/gui/toolbox-menu.c: removed the old and added the new undo
	history to the dialog factory and the various dialog menus.

	* app/widgets/picmandnd.[ch]: don't warn if a GType has no
	corresponding DND type. Instead, return FALSE from the function
	that failed.

	* app/widgets/picmanpreview.c: check the return value of picmandnd
	functions.  Not only add drag sources but also remove them when no
	longer needed.

	* app/widgets/picmanselectioneditor.h: removed unneeded inclusion of
	"gui/gui-types.h".

2003-02-19  Tor Lillqvist  <tml@iki.fi>

	* libpicmanbase/picmanbase.def: Add picman_utf8_strtrim. Sort. Remove
	commented-out entries.

	* libpicmanproxy/Makefile.am: On Win32, add libpicmanbase to LIBADD.

	* libpicmantool/picmantool.def: Add picman_transform_grid_type_get_type.

2003-02-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: added a new widget constructor
	picman_prop_opacity_entry_new() which is a scale entry with a display
	factor of 100.0.

	* app/tools/paint_options.c: use the new opacity scale for opacity
	controls.

2003-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/uniteditor.c: fixed typo.

	* plug-ins/helpbrowser/helpbrowser.c: generate HTML with proper
	encoding information, fixes bug #106543.

2003-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/laplace.c: changed MIN to MAX as suggested by
	Sunil Mohan Adapa in bug #106474.

2003-02-19  Sven Neumann  <sven@picman.org>

	* configure.in: use AC_PROG_LIBTOOL and AC_PROG_RANLIB as
	suggested in bug report #106499.

2003-02-18  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in-shm.c: #include <sys/types.h> for ipc/shm
	headers. (Bug #106461)

	* app/plug-in/plug-in.c: remove unneeded includes of ipc/shm headers.

2003-02-18  Sven Neumann  <sven@picman.org>

	Applied patches from David Necas <yeti@physics.muni.cz> that fix
	incorrect RGBA resampling in a number of plug-ins:

	* libpicmancolor/picmanbilinear.c (picman_bilinear_rgba): fixes RGBA
	resampling in Map Object and Lighting Effects plug-ins (#72876 and
	#105496).

	* plug-ins/common/curve_bend.c: fixes bug #72863.
	* plug-ins/common/deinterlace.c: fixes bug #72856.
	* plug-ins/common/gauss_iir.c: fixes bug #72848.
	* plug-ins/common/gauss_rle.c: fixes bug #72849.
	* plug-ins/common/iwarp.c: fixes bug #72865 (except preview, see
	comment).
	* plug-ins/common/mblur.c: fixes bug #72850.
	* plug-ins/common/pixelize.c: fixes bug #72851.
	* plug-ins/common/polar.c: fixes bug #72866.
	* plug-ins/common/ripple.c: fixes bug #72868.

2003-02-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: added picman_prop_preview_new().

	* app/tools/picmanblendoptions.c
	* app/tools/paint_options.c: use it.

2003-02-18  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/procedural_db.pdb
	* app/pdb/procedural_db_cmds.c: use regfree() to free the regex
	pattern buffer.

	* app/widgets/picmandnd.c (picman_dnd_data_dest_add): unref the
	GtkTargetList after adding it to the widget.

	* app/core/picmanimage.c (picman_image_get_new_preview): initialize
	all fields of the mask pixel_region.

	* app/core/picmanviewable.c (picman_viewable_get_new_preview_pixbuf):
	pass a destroy notifier to gdk_pixbuf_new_from_data() so that the
	pixel data is freed with the pixbuf.

	* libpicmantool/picmantool.c (picman_tool_class_init): register a
	finalizer that unrefs the PicmanToolControl object.

	* app/widgets/picmanenummenu.c (picman_enum_stock_box_new_with_range):
	free the generated stock_id.

2003-02-18  Sven Neumann  <sven@picman.org>

	* data/images/picman_splash.png: flattened the splash image.

2003-02-18  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.[ch]: added plug_ins_proc_def_find() which
	takes a ProcRecord and returns the corresponding PlugInProcDef.

	* app/plug-in/plug-in.[ch]: added a ProcRecord pointer to the
	PlugIn struct so we know which procedure the plug-in is
	executing. Replaced "gboolean in_temp_proc" by
	"ProcRecord *current_temp_proc". Added plug_in_get_undo_desc()
	which uses the new ProcRecord members and plug_ins_proc_def_find()
	to return a human readable string.

	* app/plug-in/plug-in-run.c: pass the ProcRecord to plug_in_new().
	Set plug_in->current_temp_proc while executing a temp_proc.
	(The latter won't work since we don't run temp_procs recursively
	at the moment).

	* app/gui/plug-in-menus.c: translate the plug-in's menu_path
	before chopping it for the "Repeat" and "Reshow" menu items.

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/undo.pdb: use plug_in_get_undo_desc() when
	pushing plug-in undos.

	* app/pdb/drawable_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2003-02-17  Jay Cox  <jaycox@picman.org>

	* app/paint-funcs/paint-funcs.c: Fixed an initialization error
	in fatten_region and thin_region discovered by hans_meine@gmx.net

2003-02-18  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/Makefile.am: add enumcode-py.pl to EXTRA_DIST

2003-02-18  Sven Neumann  <sven@picman.org>

	* Made 1.3.12 release.

2003-02-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/ripply-anim.scm: fixed typo.

2003-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch] (picman_image_position_*): added
	"undo_desc" parameters.

	* app/core/picmanimage-undo-push.c: changed accordingly.

	* app/widgets/picmanitemlistview.[ch]: moved the item stack
	manipulation function pointers from the instance to the class
	struct. Added lots of descriptive strings to be used by tooltips
	and undo steps.

	* app/widgets/picmanchannellistview.c
	* app/widgets/picmanitemlistitem.c
	* app/widgets/picmanlayerlistview.[ch]
	* app/widgets/picmanvectorslistview.c
	* app/gui/dialogs-constructors.c
	* app/gui/layers-commands.[ch]
	* app/gui/vectors-commands.c: changed accordingly. Cleanup.

2003-02-17  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c (picman_color_scale_size_allocate):
	calculate the size of the handle (the small triangles) from the
	scale's requisition, not from its allocation. Spotted by drc.

2003-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c: s/"Add Mask to Layer"/"Add Layer Mask"/
	to match an already existing string,

2003-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanedit.c (picman_edit_fill): pass more detailed
	undo_desc strings instead of always "Fill".

	* app/core/picmanimage-mask-select.c: changed undo_desc strings
	to match the already existing blurbs of the selection tools.

2003-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-merge.[ch]: added "const gchar *undo_desc" to
	picman_image_merge_layers() so the undo steps say "Merge Down",
	"Flatten Image" etc. instead of always "Merge Layers".

2003-02-15  Larry Ewing  <lewing@ximian.com>

	* app/tools/picmaninkoptions.c (picman_ink_options_gui): add a new
	variable to hold the brush vbox so the we return the correct
	widget.

2003-02-14  Michael Natterer  <mitch@picman.org>

	Fixed most of the bugs the Script-Fu logo scripts triggered:

	* app/core/picmandrawable-bucket-fill.[ch]
	(picman_drawable_bucket_fill): added "gboolean do_seed_fill"
	parameter instead of assuming TRUE.
	(picman_drawable_bucket_fill_full): moved "color" and "pattern"
	parameters to the end.

	* app/tools/picmanbucketfilltool.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmandrawablelistview.c: changed accordingly.

	* tools/pdbgen/pdb/misc_tools.pdb: only pass TRUE if the selection
	is empty. Restores old PDB behaviour.

	* app/core/picmanimage-undo.c (picman_image_undo_group_end): return
	early if gimage->undo_on is FALSE. Fixes bogus criticals.

	* app/core/picmanimage.c (picman_image_add_[layer|channel|vectors]):
	clamp the passed position to sane values before calling
	picman_container_insert() (Scripts adding layers at wrong indices
	are broken but should not crash the core).

	* tools/pdbgen/pdb/paint_tools.pdb: need to copy the relevant
	paint parameters from the current context now that the paint
	options are contexts themselves.

	* tools/pdbgen/pdb/palette.pdb: removed useless includes.

	(Mostly) fixed text PDB functions:

	* app/text/picmantext-compat.[ch] (text_render): don't set
	text->font_size = -1 but get the size from the PangoFontDescrition.
	(text_get_extents): return the logical_rect, not the ink_rect
	because the size of the created text layer will be the logical_rect.

	* tools/pdbgen/pdb/text_tool.pdb: removed text_fontname_create()
	utility function and the usage of pass_through and implement all
	invokers in-place, using the correct parameters.

	* plug-ins/script-fu/siod-wrapper.c: fixed BG-IMAGE-FILL compat
	define so we can BG fill again. Cleaned up color handling code.

	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/land.scm
	* plug-ins/script-fu/scripts/lava.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: use new gradient names.

	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/text_tool_cmds.c: regenerated.

2003-02-14  Michael Natterer  <mitch@picman.org>

	Moved the undo step implementations to the core and pass around
	lots of "const gchar *undo_desc". Fixes bug #104367.

	* app/Makefile.am
	* app/undo.[ch]: removed...

	* app/core/Makefile.am
	* app/core/picmanimage-undo-push.[ch]: ...and added here.

	* app/paint/Makefile.am
	* app/tools/Makefile.am
	* app/paint/picmanpaintcore-undo.[ch]
	* app/tools/picmantransformtool-undo.[ch]: new files for the
	paint and transform undos.

	* app/core/picmanpaintinfo.[ch]: added a blurb.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/paint/paint-types.h
	* app/paint/paint.c: pass the blurb when registering the core.

	* app/core/picmandrawable.[ch]
	* app/core/picmanimage.[ch]
	* app/core/picmanimage-mask-select.[ch]
	* app/core/picmanimage-mask.[ch]
	* app/core/picmanimagemap.[ch]
	* app/core/picmanlayer-floating-sel.[ch]: added "undo_desc" parameters
	to all undo pushing helper functions.

	* app/undo_history.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-desaturate.c
	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-invert.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo.c
	* app/core/picmanitem.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/display/picmandisplayshell-dnd.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/gui/channels-commands.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/paths-dialog.c
	* app/gui/select-commands.c
	* app/gui/vectors-commands.c
	* app/text/picmantext-compat.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanselectioneditor.c
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/guides.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: changed accordingly: pass
	"undo_desc" strings, changed includes or simply removed inclusion
	of "undo.h". Some random cleanups.

	* tools/pdbgen/pdb/guides.pdb: cleaned up a lot. Fixed
	picman_image_find_next_guide() to not return guides with
	position < 0 (and made it shorter and readable).

	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2003-02-14  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayermask.c (picman_layer_mask_duplicate): return the
	duplicate, not the original mask. Fixes bug #106010.

2003-02-13  Raphael Quinet  <quinet@gamers.org>

	* docs/make-todo: fix the address of the PICMAN bug database so that
	it is possible to use bug references like <bugs>#106008</bugs> in
	TODO.xml.  Fixes bug #106008.

2003-02-13  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb: fixed plugins_query() I broke
	recently.

	* app/pdb/plug_in_cmds.c: regenerated.

2003-02-13  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: changed FOO_UNDO enum values to
	PICMAN_UNDO_FOO.

	* app/undo.[ch]: removed the undo group wrappers.

	* app/undo_history.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo.c
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/channels-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/paint/picmanpaintcore.c
	* app/text/picmantext-compat.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/undo.pdb: changed accordingly. Pass meaningful
	undo names to picman_image_undo_group_start().

	* app/pdb/layer_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2003-02-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h: fixed use of proxy-resume and proxy-skip
	trigraphs. We should get rid of these, they are so confusing.

	* app/core/core-enums.c: regenerated.

	* libpicmanproxy/picmanproxytypes.h: this file was regenerated for no
	good reason.

2003-02-12  Michael Natterer  <mitch@picman.org>

	Moved the undo system to the core: Keep PicmanUndoStack objects as
	undo and redo stack. Use PicmanUndo objects as members of the
	stacks. PicmanUndoStack is derived from PicmanUndo and keeps undo
	groups, so undo group handling is much simpler than before
	(the whole group is just a single PicmanUndo object on the
	stack and not everything between group boundary markers).

	* app/Makefile.am
	* app/undo_types.h: removed.

	* app/config/picmancoreconfig.[ch]: added "gulong undo_size".
	* app/config/picmanrc-blurbs.h: and its blurb.

	* app/core/core-enums.[ch]: added PicmanUndoMode and PicmanUndoType.

	* app/core/core-types.h: removed UndoType, added PicmanUndoAccumulator,
	PicmanUndoPopFunc and PicmanUndoFreeFunc.

	* app/core/picmanundo.[ch]: do everything the old "Undo" struct did.
	Removed the virtual push() function and added free().

	* app/core/picmanundostack.[ch]: keeps the new undo/redo stacks
	and also acts as undo group.

	* app/core/picmanimage-undo.[ch]: moved the undo apparatus here.

	* app/core/picmanimage.[ch]: removed the old stuff.

	* app/core/picmanmarshal.list: added marshaller needed for PicmanUndo.

	* app/undo.[ch]: removed the whole undo mechanism. Only the
	actual undo pushing functions are left.

	* app/undo_history.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/image-menu.c
	* app/gui/preferences-dialog.c
	* app/tools/picmaneditselectiontool.c: changed accordingly.

2003-02-12  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/path_bezier.[ch]
	* app/path_curves.[ch]
	* app/tools/Makefile.am
	* app/tools/picmanpathtool.[ch]
	* app/tools/path_tool.[ch]: removed the abandoned path tool
	prototype.

2003-02-12  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/path_toolP.h: removed this unused header file.

2003-02-11  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* TODO: removed. Fixes bug #105835.

2003-02-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added new virtual function duplicate()
	as replacement for all picman_*_copy() functions.

	* app/core/picmanchannel.[ch]
	* app/core/picmandrawable.[ch]
	* app/core/picmanlayer.[ch]
	* app/core/picmanlayermask.[ch]
	* app/vectors/picmanvectors.[ch]: replaced public copy() functions
	by duplicate() implementations.

	* app/text/picmantextlayer.c: added a duplicate() implementation.

	* app/widgets/picmanitemlistview.[ch]: removed the "copy_item_func"
	and simply call picman_item_duplicate().

	* app/undo.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-qmask.c
	* app/gui/channels-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

2003-02-11  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_color_window.c
	* plug-ins/print/picman_main_window.c: fixed some obvious problems
	like drawing outside the expose_event handler and not returning a
	value from event handlers. This code really is a mess :(

2003-02-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/uniteditor.c: argh, the "cell-background-gdk"
	property was introduced in GTK+-2.2. Added a run-time version check.

2003-02-11  Michael Natterer  <mitch@picman.org>

	* app/core/picman.h: added lots of members for the complete
	state of the plug-ins.

	* app/plug-in/plug-in-types.h: added PlugInShm typedef.

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-rc.[ch]
	* app/plug-in/plug-in-run.[ch]
	* app/plug-in/plug-in-shm.c
	* app/plug-in/plug-in.[ch]
	* app/plug-in/plug-ins.[ch]: removed all global & static variables
	and pass around more "Picman" pointers.

	* app/plug-in/plug-in-debug.c: use G_N_ELEMENTS().

	* app/gui/image-menu.c
	* app/gui/plug-in-commands.c
	* app/gui/plug-in-menus.c
	* app/gui/toolbox-menu.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2003-02-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/uniteditor.c: more code cleanup.

2003-02-10  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in-debug.c: remove a couple unused vars.

	* plug-ins/common/spheredesigner.c: G_OBJECT casts not needed
	for g_signal_connect.

2003-02-10  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in.[ch]: added hooks for running plug-ins under
	a memory debugger. Also, removed the args array from the PlugIn
	structure, replacing with simply a variable for the path to the
	plug-in (and one for a precalculated basename).

	* app/plug-in/plug-in-debug.[ch]: helper routines for the above

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-proc.c
	* app/plug-in/plug-in-progress.c: reflect new and renamed args members

	* app/plug-in/Makefile.am: added plug-in-debug.[ch]

	* app/core/core-types.h: added forward declaration for PicmanPlugInDebug

	* app/core/picman.[ch]: added structure member for PicmanPlugInDebug

	* devel-docs/debug-plug-ins.txt: documented new feature

2003-02-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/uniteditor.c: use the "cell-background-gdk"
	property to mark system units which can't be changed.

2003-02-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/vpropagate.c: applied a patch from David Necas
	<yeti@physics.muni.cz> that fixes bug #105741.

2003-02-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c (DoExtension)
	* plug-ins/common/jpeg.c (load_image): UTF-8 validate the comment
	before setting it as a parasite.
	
2003-02-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/distress_selection.scm
	* plug-ins/script-fu/scripts/old_photo.scm
	* plug-ins/script-fu/scripts/select_to_brush.scm
	* plug-ins/script-fu/scripts/select_to_image.scm
	* plug-ins/script-fu/scripts/spinning_globe.scm: removed.

	* plug-ins/script-fu/scripts/distress-selection.scm
	* plug-ins/script-fu/scripts/old-photo.scm
	* plug-ins/script-fu/scripts/select-to-brush.scm
	* plug-ins/script-fu/scripts/select-to-image.scm
	* plug-ins/script-fu/scripts/spinning-globe.scm: new filenames
	with '-' instead of '_'.

	* plug-ins/script-fu/scripts/Makefile.am: changed accordingly.

2003-02-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/select-to-pattern.scm: added new
	script from Cameron Gregory. Closes bug #105624.

	* plug-ins/script-fu/scripts/select_to_brush.scm
	* plug-ins/script-fu/scripts/select_to_image.scm: cleaned them up.

2003-02-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-utils.[ch]: added new utility functions
	picman_config_connect() and picman_config_disconnect() and documented
	most functions.

	* app/tools/picmantexttool.c (picman_text_tool_connect): use the new
	PicmanConfig utility functions.

2003-02-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_query): allow to query for picman
	paths (like "picman_dir") as it used to work in 1.2.

	* libpicmanwidgets/picmanunitmenu.[ch]: minor code cleanup.

2003-02-10  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_options.[ch]: added a "const gchar *extension"
	parameter to picman_tool_options_[de]serialize(). Default to
	"default" if NULL is passed.

	* app/tools/tool_manager.[ch]: load the tool_options from the
	default files in tool_manager_restore(), added tool_manager_save()
	which saves the default files.

	* app/app_procs.c: call tool_manager_save() on app exit.

	* app/gui/tool-options-dialog.c: pass "user" when loading/saving
	the user defaults. Changed tooltips of the load & save buttons.

2003-02-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaninktool.c: take the drawable offset into account
	when painting (spotted by tigert).

2003-02-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.[ch]: connect to PicmanTransformOptions'
	"notify" signal and update grid and path drawing accordingly.

	* app/tools/picmantransformoptions.c: removed the same stuff here.
	Doesn't depend on the tool_manager any more.

	* app/tools/picmanselectionoptions.c
	* app/tools/paint_options.c: don't #include "tool_manager.h"

2003-02-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: changed PicmanOrientationType from
	PICMAN_HORIZONTAL to PICMAN_ORIENTATION_HORIZONTAL etc.

	* tools/pdbgen/pdb/guides.pdb: changed accordingly. Don't subtract
	1 from guide->orientation because InternalOrientationType no
	longer exists.

	* tools/pdbgen/stddefs.pl: chop the whole PICMAN_ORIENTATION_UNKNOWN
	value from the enum, not just UNKNOWN.

	* app/pdb/guides_cmds.c
	* app/pdb/transform_tools_cmds.c
	* libpicman/picmanenums.h
	* libpicman/picmanguides_pdb.c
	* plug-ins/script-fu/script-fu-constants.c
	* plug-ins/pypicman/picmanenums.py
	* tools/pdbgen/enums.pl: regenerated.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: added compat enums.

	* plug-ins/imagemap/imap_cmd_picman_guides.c
	* plug-ins/xjt/xjt.c
	* plug-ins/xjt/xpdb_calls.c
	* plug-ins/common/gih.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/rotate.c: changed accordingly.

2003-02-09  Manish Singh  <yosh@picman.org>

	* libpicman/picman.c: implemented plug-in debugging hooks. Also, use
	G_LOG_DOMAIN instead of hardcoding "LibPicman" for g_log_set_handler.

	* devel-docs/debug-plug-ins.txt: documented here

	* devel-docs/Makefile.am: add new file

2003-02-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.[ch]: simplified everything a lot by
	merging the public PicmanContextPropType enum with the internal
	anonymous object property id enum. Removed the internal copy_prop
	functions and handle property copying in a big switch() in
	picman_context_copy_property(). Removed the separate signal
	connections for each property of the parent context and do the
	same using a single "notify" handler. Emit "notify" signals all
	over the place.  Removed internal arrays which are no longer
	needed due to enum merge and copy_property simplification.
	Removed the array of signal names and use g_signal_name().
	Removed picman_context_unset_parent() and allow "parent" being NULL
	in picman_context_set_parent().

	* app/tools/tool_manager.c
	* app/widgets/picmandevices.c: changed accordingly.

	* libpicmantool/picmantooltypes.h: changed PicmanToolOptionsGUIFunc to
	return a GtkWidget (the created tool options widget).

	* libpicmantool/picmantoolmodule.c: #include <gtk/gtk.h>

	* app/tools/tool_options.[ch]: removed the "main_vbox" from the
	PicmanToolOptions struct. Changed picman_tool_options_gui() to create
	and return the main_vbox.

	* app/tools/tool_manager.c: create the "This Tool has no Options"
	label here if NULL was passed as "options_gui_func". Attach the
	options widget to the tool_options object using
	g_object_set_data().

	* app/gui/tool-options-dialog.c: changed accordingly.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendoptions.[ch]
	* app/tools/picmanbucketfilloptions.[ch]
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickeroptions.[ch]
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancropoptions.[ch]
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanflipoptions.[ch]
	* app/tools/picmaninkoptions.[ch]
	* app/tools/picmanmagnifyoptions.[ch]
	* app/tools/picmanmeasureoptions.[ch]
	* app/tools/picmanmoveoptions.[ch]
	* app/tools/picmanselectionoptions.[ch]
	* app/tools/picmansmudgetool.c
	* app/tools/picmantextoptions.[ch]
	* app/tools/picmantransformoptions.[ch]
	* app/tools/picmanvectoroptions.[ch]
	* app/tools/paint_options.[ch]: return the options vbox from
	all tool_options_gui functions.

2003-02-08  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanselectionoptions.c
	* app/tools/picmantextoptions.c: use N_() instead of _() with blurbs
	of object properties. PicmanConfig wants the untranslated string as
	well.

	* app/widgets/picmanenummenu.c
	* app/widgets/picmanpropwidgets.c: added gettext() calls.

	* app/config/picmanconfig-serialize.c: document the fact that
	picman_config_serialize_comment() only handles ASCII comments.

2003-02-09  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_options.[ch]: added
	picman_tool_options_[de]serialize() utility functions.

	* app/gui/tool-options-dialog.c: use them, cleanup.

2003-02-09  Michael Natterer  <mitch@picman.org>

	* app/config/picmanscanner.c: allow G_CSET_DIGITS in identifiers so
	we can parse e.g. (foo-1 bar).

2003-02-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/ (lots of scripts): applied a patch
	from Carol Spears that changes all font names to the new style.
	Fixes bug #102306.

2003-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_utf8_strtrim): fixed stupid bug.

2003-02-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanselectioneditor.c: changed include to follow
	selection options change. Don't use the tool_manager to find
	by_color_select's options.

2003-02-08  Michael Natterer  <mitch@picman.org>

	* app/tools/transform_options.[ch]
	* app/tools/selection_options.[ch]: removed...

	* app/tools/picmanselectionoptions.[ch]
	* app/tools/picmantransformoptions.[ch]: ...and added here.

	* app/tools/Makefile.am
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectoroptions.h: changed accordingly.

	* app/tools/picmaninkoptions.[ch]: renamed "sensitivity" to
	"size_sensitivity". Reordered properties. Added utility
	constructors blob_button_new() and brush_widget_new().

	* app/tools/picmaninktool.c: changed accordingly.

2003-02-08  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/enumcode-py.pl: use True and False if available.
	Ditch PICMAN_ prefixes since we have real namespaces in python.

	* tools/pdbgen/Makefile.am: generate python enums too

	* tools/pdbgen/enumcode.pl: cosmetic cleanup

2003-02-08  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmiscui.c (picman_fixme_preview_fill): fixed
	initialization of PicmanPixelRegion (#105572 spotted by David Necas).

2003-02-08  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-serialize.c (picman_config_serialize_property):
	the virtual serialize_property() returning FALSE doesn't mean the
	serialization failed but that the function didn't handle the 
	property, so don't error but continue with the default
	implementation. Print newlines after properties only if
	indent_level == 0.

	* app/gui/tool-options-dialog.c: added tool options saving/loading
	as quickly hacked proof-of-concept.

	* app/paint/paint-enums.[ch]: added enum PicmanInkBlobType.

	* app/tools/picmaninkoptions.[ch]: ported to object properties,
	cleanup.

	* app/tools/picmaninktool.c: changed accordingly.

2003-02-08  Sven Neumann  <sven@picman.org>

	* HACKING: added a note about generating the developers
	documentation and how to disable it in case of problems.

2002-02-08  Manish Singh  <yosh@picman.org>

	* app/paint-funcs/paint-funcs.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/sample_colorize.c: 64-bit cleaniless cleanups.

2003-02-07  Michael Natterer  <mitch@picman.org>

	Added object properties for almost all tool_options values
	and registered lots of enums with the type system:

	Part I (enum and type cleanup):

	* app/core/core-enums.[ch]
	* app/core/core-types.h: removed InternalOrientaionType and
	register PicmanOrientationType. Register PicmanChannelOps.
	Removed PicmanToolOptionsGUIFunc.

	* app/xcf/xcf-private.h: added XcfOrientationType with the
	same values as the old InternalOrientationType

	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c: translate between PicmanOrientationType and
	XcfOrientationType.

	* app/core/picmandrawable-transform-utils.[ch]
	* app/core/picmandrawable-transform.[ch]
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.h
	* app/display/picmandisplayshell.c
	* tools/pdbgen/stddefs.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.

	* app/pdb/guides_cmds.c
	* app/pdb/transform_tools_cmds.c
	* libpicman/picmanenums.h
	* libpicmanproxy/picmanproxytypes.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmantool/picmantoolenums.[ch]: added PicmanTransformGridType.

	* libpicmantool/picmantooltypes.h: removed PicmanToolOptionsResetFunc,
	added PicmanToolOptionsGUIFunc.

	Part II (tool options changes):

	* app/config/picmanconfig-utils.c (picman_config_reset_properties):
	don't reset object properties because they have NULL as default
	value.

	* app/widgets/picmanpropwidgets.[ch]: added
	picman_prop_[enum|boolean]_radio_frame_new(),
	picman_prop_paint_mode_menu_new() and picman_prop_scale_entry_new(),
	which are all needed by the new tool options GUI code.

	* app/tools/tool_options.[ch]: removed the "reset_func" since
	the virtual reset() method is used now.

	* app/paint/picmanairbrushoptions.[ch]
	* app/paint/picmancloneoptions.[ch]
	* app/paint/picmanconvolveoptions.[ch]
	* app/paint/picmandodgeburnoptions.[ch]
	* app/paint/picmaneraseroptions.[ch]
	* app/paint/picmanpaintoptions.[ch]
	* app/paint/picmansmudgeoptions.[ch]: added properties all over the
	place and removed the widget and default_value members from
	the structs. Renamed some values (e.g. s/type/clone_type/).
	Don't #include <gtk/gtk.h>.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/paint/paint-types.h
	* app/paint/paint.c: changed accordingly. Don't #include <gtk/gtk.h>.

	* tools/pdbgen/pdb/paint_tools.pdb: changed accordingly.

	* app/pdb/paint_tools_cmds.c: regenerated.

	* app/tools/picmanblendoptions.[ch]
	* app/tools/picmanbucketfilloptions.[ch]
	* app/tools/picmancolorpickeroptions.[ch]
	* app/tools/picmancropoptions.[ch]
	* app/tools/picmanflipoptions.[ch]
	* app/tools/picmaninkoptions.c
	* app/tools/picmanmagnifyoptions.[ch]
	* app/tools/picmanmeasureoptions.[ch]
	* app/tools/picmanmoveoptions.[ch]
	* app/tools/picmantextoptions.c
	* app/tools/paint_options.[ch]
	* app/tools/selection_options.[ch]
	* app/tools/transform_options.[ch]: ditto: added properties and
	removed widget and default_value stuff. Removed most reset functions.
	Use picman_prop widgets all over the place, renamed some values
	as above.

	* app/tools/Makefile.am
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectoroptions.c: changed accordingly. Ported
	the paint_options GUI constructors to picman_prop widgets.

	* app/widgets/picmanselectioneditor.c
	* app/gui/tool-options-dialog.c: changed accordingly.

2003-02-07  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c
	* app/text/picmantextlayout.[ch]: render an empty layer for an empty
	text layout.

2003-02-06  Sven Neumann  <sven@picman.org>

	* libpicman/picmanui.c
	* libpicman/picmanunit.c
	* libpicmanbase/picmanenv.c
	* libpicmanmodule/picmanmodule.c
	* libpicmanmodule/picmanmoduledb.c
	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmandialog.c
	* libpicmanwidgets/picmanfileselection.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c
	* libpicmanwidgets/picmanwidgets.c: documentation fixes / improvements.

2003-02-06  Sven Neumann  <sven@picman.org>

	Switched to DocBook XML for the developers documentation:
	
	* configure.in: check for gtk-doc >= 1.0.

	* tools/pdbgen/lib.pl: replace <, > and & in comments with their
	XML entities.

	* libpicman/picmandrawable_pdb.c
	* libpicman/picmanpicmanrc_pdb.c
	* libpicman/picmanpainttools_pdb.c
	* libpicman/picmanselection_pdb.c: regenerated.

	* libpicmanbase/picmansignal.c: did the same manually here.

2003-02-06  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c (image_menu_entries): removed /Filters/Text
	menu branch now that we don't install any plug-in there and
	picman-freetype is becoming obsolete.

2003-02-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/randomize.c: applied a patch from David Necas
	<yeti@physics.muni.cz> that fixes bug #105339.

2003-02-05  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanutils.[ch]: added new files that hold the new
	picman_utf8_strtrim() routine; it might be useful in more places.

	* libpicmanbase/picmandatafiles.c (picman_datafiles_read_directories):
	silently ignore directories in the path that can't be opened.

	* app/core/picmanobject.c (picman_object_set_name_safe): use
	picman_utf8_strtrim().

	* app/widgets/picmanwidgets-utils.[ch]
	* app/tools/picmantextoptions.c: try to make the text tool options
	look more like all other tool options. Still needs work; I'll
	leave this up to Mitch ...

        This byte --> <-- is the millionth in this file!

2003-02-05  Manish Singh  <yosh@picman.org>

	* plug-ins/common/jpeg.c (run): if the quality level is close to zero
	in non-interactive mode, use default settings. This is hack until
	the PDB gets default arguments, so picman-file-save works sanely with
	jpeg.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.c (picman_object_set_name_safe): replaced with
	an UTF-8 safe rewrite.

	* app/widgets/picmanwidgets-utils.c (picman_table_attach_stock): hacked
	to allow being used with non-existent stock_ids (for prototyping).

	* app/widgets/picmanenummenu.c: set the radio button mode correctly.

	* app/widgets/picmanfontselection.c: tweaked spacing.

	* app/tools/picmantextoptions.c: added controls for justification and
	indentation. Removed letter-spacing control for now.

	* app/text/picmantextlayer.[ch]: rerender the text layer from a low
	priority idle function.

2003-02-05  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c
	* app/tools/paint_options.c: use PICMAN_CONTEXT(tool_options)
	instead of picman_get_current_context(). Cleanup.

2003-02-05  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.c: should have gone with my
	previous checkin.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanobject.[ch]
	* app/text/picmantextlayer.c: improved the code that trims the text
	before setting it as layer name and moved it to PicmanObject as
	picman_object_set_name_safe().

	* app/text/picmantext.[ch]: removed fixed_height and gravity again.

	* app/text/picmantextlayout.c: much simpler positioning that has the
	advantage that it actually works.

	* libpicmanproxy/picmanobject.[ch]: this crap was regenerated.

2003-02-05  Michael Natterer  <mitch@picman.org>

	Made PicmanToolOptions a PicmanContext subclass and objectified
	all tool options types.

	* app/core/core-types.h: replaced PicmanToolOptionsNewFunc by
	PicmanToolOptionsGUIFunc.

	* libpicmanproxy/picmanproxytypes.h: regenerated.

	* app/core/picmanpaintinfo.[ch]: added "GType paint_options_type".

	* app/core/picmantoolinfo.[ch]: added "GType tool_options_type",
	removed tool_info->context since PicmanToolOptions are a PicmanContext
	now. Added "gboolean use_context" as a temp_hack.

	* libpicmantool/picmantooltypes.h: added the tool_options_type to
	the tool registering callback.

	* app/tools/tool_options.[ch]: is a real PicmanContext subclass now.

	* app/paint/paint-types.h
	* app/paint/paint.c: added the paint_options_type to the paint
	registering stuff.

	* app/paint/picmanpaintoptions.[ch]: is a real PicmanToolOptions
	subclass now.

	* app/paint/Makefile.am
	* app/paint/picmanairbrushoptions.[ch]
	* app/paint/picmancloneoptions.[ch]
	* app/paint/picmanconvolveoptions.[ch]
	* app/paint/picmandodgeburnoptions.[ch]
	* app/paint/picmaneraseroptions.[ch]
	* app/paint/picmansmudgeoptions.[ch]: new files holding
	PicmanPaintOptions subclasses.

	* app/paint/picmanairbrush.[ch]
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.[ch]
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpencil.[ch]
	* app/paint/picmansmudge.[ch]: removed paint options stuff, lots
	of related changed & cleanups.

	* tools/pdbgen/pdb/paint_tools.pdb: changed accordingly.

	* app/pdb/paint_tools_cmds.c: regenerated.

	* app/tools/Makefile.am
	* app/tools/picmanblendoptions.[ch]
	* app/tools/picmanbucketfilloptions.[ch]
	* app/tools/picmancolorpickeroptions.[ch]
	* app/tools/picmancropoptions.[ch]
	* app/tools/picmanflipoptions.[ch]
	* app/tools/picmaninkoptions.[ch]
	* app/tools/picmanmagnifyoptions.[ch]
	* app/tools/picmanmeasureoptions.[ch]
	* app/tools/picmanmoveoptions.[ch]
	* app/tools/picmantextoptions.[ch]
	* app/tools/picmanvectoroptions.[ch]: new files holding the various
	tool options classes.

	* app/tools/selection_options.[ch]
	* app/tools/transform_options.[ch]: made them objects.

	* app/tools/paint_options.[ch]: contains only the paint_options
	GUI and reset stuff.

	* app/tools/tools-types.h: removed SelectionOptions typedef for
	now.

	* app/tools/[all tools]: removed the tool options stuff except
	some GUI constructors. Tons of related changes.

	* app/tools/tool_manager.[ch]: changed tool registration / restore /
	switching accordingly.

	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanselectioneditor.c: changed accordingly.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.c: added some blurbs that will show up as
	tooltips in the text tool options. Tweaked default values.
	
	* app/text/picmantextlayout.c (picman_text_layout_position): if
	gravity is none (the default), position the layout according to its
	justification.

	* app/widgets/picmanenummenu.[ch]: added new functions that create a
	hbox of radio buttons with icons from an enum type.

	* app/widgets/picmanpropwidgets.[ch]: added a property widget
	constructor for the new enum_stock_box.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/text/text-enums.[ch]
	* app/text/picmantext.[ch]: replaced PicmanTextAlignment with
	PicmanTextJustification. Added indentation property.

	* app/text/picmantextlayout.c: implemented text justification,
	indentation and line spacing as far as supported by Pango.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c
	* app/tools/picmantexttool.c: fixed includes.

2003-02-05  Sven Neumann  <sven@picman.org>

	* app/paint/Makefile.am: fixed rules for generated sources.

	* app/text/Makefile.am
	* app/text/text-enums.[ch]: added new files with text-related enums.

	* app/text/picmantext.[ch]: added text alignment property.

	* app/text/picmantext-render.[ch]: removed

	* app/text/text-types.h
	* app/text/picmantextlayout.[ch]: added new files that define
	PicmanTextLayout, a wrapper around PangoLayout. Moved render code to
	this file.

	* app/text/picmantextlayer.c: changed accordingly.

2003-02-04  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/max_rgb.c: fixed bug with previewing images
	with alpha channel.

2003-02-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemfactory.c (picman_item_factory_item_key_press):
	made the ugly hack that prevents users from reassigning the F1
	shortcut even more ugly but fixed bug #105068.

2003-02-04  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/picmanressionist.h
	* plug-ins/picmanressionist/*.c
	* plug-ins/imagemap/imap_rectangle.c: fixed includes to make it
	compile again.
	
2003-02-04  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/polar.c (dialog_update_preview): use 
	picman_get_bg_guchar routine.

	* libpicman/picmanmiscui.[ch]: extracted a few reusable routines from
	plasma.c and put them in here.

	* plug-ins/common/plasma.c: fix for #105062 plus the usual code
	clean-up.

2003-02-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c: use gtk_window_present()
	to raise the dialog; some code cleanup.

2003-02-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.[ch]
	* app/tools/picmanblendtool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c: misc trivial changes and cleanup.

	* app/widgets/picmanpropwidgets.[ch]: added picman_prop_unit_menu_new()
	and removed the scale widget again.

	* app/tools/picmantexttool.c: replaced the size scale entry with a
	spinbutton and made the unit menu working.

	* app/text/picmantext.c: increased the upper boundary for the font
	size again now that we don't use a scale any longer.

2003-02-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c: changed the text used in
	the preview.
	
	* app/widgets/picmanfontselection.[ch]: removed the yes/no image
	that used to signal a valid font but stopped working a long time
	ago.

	* app/widgets/picmanpropwidgets.c: added a property widget for fonts.

	* app/tools/picmantexttool.c: use the new prop_widget.

2003-02-03  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: fixed the "TAB toggles
	dialogs" feature.

	(picman_display_shell_get_event_coords,device_coords): CLAMP() all
	extended axes to be safe against crappy XInput drivers and provide
	default values for not existing axes.

2003-02-03  Michael Natterer  <mitch@picman.org>

	* app/config/picmanscanner.c (picman_scanner_parse_int): handle
	negative integers.

	(picman_scanner_parse_string[no_validate]): return NULL for empty
	strings (don't simply leave the return location untouched).

2003-02-03  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_fundamental): handle negative integers.

	* app/core/picman.c (picman_edit_config_notify): commented out
	debugging output.

2003-02-03  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: applied another patch from
	David Necas <yeti@physics.muni.cz> that fixes #82470. Added some
	stock icons and mnemonics.

2003-02-03  Michael Natterer  <mitch@picman.org>

	* app/undo.c: unified some comments, some cleanup.

	* app/pdb/procedural_db.c: some cleanup & comments to clarify
	what PICMAN_PDB_PASS_THROUGH does.

2003-02-03  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am: removed the "truly ugly hack"...

	* app/Makefile.am: ...and changed the linking order instead.

	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/paint/Makefile.am
	* app/widgets/Makefile.am: fixed typo.

2003-02-03  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: removed picman_main_loop() and
	picman_main_loop_quit() because they were a temp_hack until plug-ins
	have their own main loops. Added picman_threads_enter() and
	picman_threads_leave() instead.

	* app/gui/gui.c: ditto: removed the main loop stuff and added
	functions which call GDK_THREADS_ENTER() and GDK_THREADS_LEAVE()
	instead.

	* app/app_procs.c: create the main GMainLoop here and use
	picman_threads_enter,leave().

	* app/plug-in/plug-in.[ch]: added a ref_count per plug-in so the
	plug-in is not destroyed under our feet while running a recursive
	main loop. Added plug_in_ref(). Changed plug_in_destroy() to
	plug_in_unref(). Don't destroy the plug-in if plug_in_open()
	fails. Call picman_threads_enter,leave() around g_main_loop_run().
	Changed the way plug_in_push,pop() are used: "current_plug_in" is
	no longer the plug-in which currently uses the wire, but the
	plug-in which currently preforms a PDB call (the former meaning
	was needed when wire callbacks had no plug-in context but needed
	to get the plug-in from the global "current_plug_in" variable).
	Removed all calls to plug_in_push,pop() from this file.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_run): added
	plug_in_push,pop() around procedural_db_execute(). No need
	to construct an error return value if the procedure was not found
	because procedural_db_execute() already does this.

	Removed all other plug_in_push,pop(). Added more checks to plug-in
	message handlers and kill the plug-in if it misbehaves. Cleanup.

	* app/plug-in/plug-in-progress.c (plug_in_progress_cancel): if the
	plug-in runs synchronously, provide a PICMAN_PDB_CANCEL return value
	so we don't see error messages about the "failed" procedure.

	* app/plug-in/plug-in-run.c: removed plug_in_push,pop() stuff.
	Set the new plug_in->starting_ext boolean while starting an
	extension so the extension_ack handler knows that it wasn't called
	from a buggy plug-in. Cleanup.

	* app/plug-in/plug-ins.c: Cleanup.

2003-02-03  Sven Neumann  <sven@picman.org>

	Some code cleanup while trying to fix bug #105062:

	* libpicman/picmanmisc.[ch]: moved the declaration of the
	PicmanPixelFetcher struct to the .c file since noone should ever
	access it directly.

	* libpicman/picmanmiscui.c: cosmetics.

	* plug-ins/common/plasma.c: code cleanup, doesn't fix #105062.

2003-02-02  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: fixed some issues (mainly
	coding style) with the new load and save routines.

2003-02-02  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: applied a large patch from
	David Necas <yeti@physics.muni.cz> that fixes a couple of bugs and
	adds some additional features. Fixes bugs #82466, #82472 and
	#82473 and addresses bug #82470.

2003-02-02  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorbutton.c (picman_color_button_clicked):
	fixed usage of gtk_color_selection_set_has_opacity_control().

2003-02-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmiscui.[ch]: factored out more preview stuff from
	several plug-ins.

	* plug-ins/common/waves.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c 
	* plug-ins/common/noisify.c: more code clean-up

2003-02-01  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.[ch]
	* app/config/picmanconfig-utils.[ch]: added a reset method to
	PicmanConfigInterface. Added the new function picman_config_reset()

	* app/text/picmantext.c: added a PicmanConfigInterface to PicmanText.

	* app/widgets/Makefile.am
	* app/widgets/picmantexteditor.[ch]: new files that hold the simple
	text editor dialog used by the text tool.

	* app/widgets/picmanpropwidgets.[ch]: added new widget constructor
	picman_prop_scale_entry_new().

	* app/tools/picmantexttool.[ch]: replaced old-style ToolOptions with
	a PicmanText object. Connect text layers to the text tool by means
	of their PicmanText objects. Still work in progress ...

2003-02-01  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_position_layout):
	handle PICMAN_GRAVITY_NONE.

2003-02-01  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.c: fixed a comment.

2003-01-31  Manish Singh  <yosh@picman.org>

	* app/text/picmantextlayer.c: #include <string.h>

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_GRAVITY_NONE.

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c: don't use picman_drawable_configure() to
	resize the text layer, it should only ever be called once. Take
	the logical rectangle into account when calculating the layer size
	and text position.

	* app/tools/picmantexttool.[ch]: added basic text editing
	functionality. Needs more work ...
	
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-gravity-east-24.png
	* themes/Default/images/stock-gravity-north-24.png
	* themes/Default/images/stock-gravity-north-east-24.png
	* themes/Default/images/stock-gravity-north-west-24.png
	* themes/Default/images/stock-gravity-south-24.png
	* themes/Default/images/stock-gravity-south-east-24.png
	* themes/Default/images/stock-gravity-south-west-24.png

	* themes/Default/images/stock-gravity-west-24.png: added new icons
	for yet-to-written PicmanGravityChooser(?) widget. Artwork
	shamelessly taken from Jimmac's XFree cursors.

	* libpicmanwidgets/picmanstock.[ch]: added stock items for the new icons.

2003-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: added picman_item_configure() and
	picman_item_copy().

	* app/core/picmandrawable.c (picman_drawable_configure,copy): use them.

	* app/vectors/picmanvectors.[ch]: added picman_vectors_new(),
	picman_vectors_copy() and picman_vectors_copy_points(). Use the new
	PicmanItem functions just as PicmanDrawable does. Added a
	get_memsize() implementation.

	* app/vectors/picmanstroke.[ch]: made it a PicmanObject and added
	a get_memsize() implementation.

	* app/undo.c: implemented vectors undo as if the new PicmanVectors
	functions above worked.

	* app/gui/dialogs-constructors.c
	* app/gui/vectors-commands.c
	* app/tools/picmanvectortool.c: use picman_vectors_new,copy().

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.[ch]: added offset_x and offset_y to
	picman_drawable_configure().

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c: changed accordingly.

	* app/text/picmantextlayer.[ch]: update the layer when the associated
	PicmanText object changes.

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection.c: allow NULL as context parameter
	in picman_font_selection_new(). The widget then uses a default
	PangoFT2Context.

	* app/tools/picmantexttool.c (text_tool_options_new): call
	picman_font_selection_new() with a NULL context. The text tool now
	doesn't know about Pango any longer.

	* app/paint/Makefile.am
	* app/tools/Makefile.am (INCLUDES): removed PANGOFT2_CFLAGS.

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added new enum PicmanGravityType.

	* app/text/picmantext.[ch]
	* app/text/picmantextlayer.[ch]: added support for specifying a
	fixed layer size and how to position the text inside the layer.

	* app/text/picmantext-compat.c
	* app/tools/picmantexttool.c: changed accordingly.

2003-01-31  Michael Natterer  <mitch@picman.org>

	* app/gui/file-dialog-utils.[ch] (file_dialog_update_menus): removed.

	* app/gui/file-save-menu.[ch] (file_save_menu_update): added here.

	* app/gui/menus.c: register it as non-automatic update_func.

	* app/gui/file-save-dialog.c: changed accordingly.

2003-01-31  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.h

	* app/config/picmancoreconfig.c: added a pixels parameter to the
	PICMAN_CONFIG_INSTALL_PROP_UNIT() macro.

	* app/core/Makefile.am
	* app/core/picmanimage-text.[ch]: removed these two files.

	* app/text/Makefile.am
	* app/text/picmantext-compat.[ch]: new files with compatibility
	routines that provide the old text API (solely for PDB calls).

	* app/text/picmantext-render.[ch]: new files with text rendering
	routines (not much yet).

	* app/text/text-types.h
	* app/text/picmantextlayer.[ch]: new object derived from PicmanLayer.

	* app/text/picmantext.[ch]: prepared for future improvements.

	* app/pdb/text_tool_cmds.c
	* app/tools/picmantexttool.c
	* tools/pdbgen/pdb/text_tool.pdb: changed accordingly.

2003-01-30  Manish Singh  <yosh@picman.org>

	* app/undo_history.c
	* libpicman/picmanmenu.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/screenshot.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gflare/gflare.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_polygon.c: changed gtk_{timeout,idle} stuff
	to their glib equivalents. Minor cleanups also with support code.

	* plug-ins/dbbrowser/dbbrowser_utils.c (picman_db_browser): use
	gtk_entry_set_activates_default()

2003-01-30  Seth Burgess <sjburges@picman.org>
	
	* plug-ins/common/laplace.c: fixed off-by-1 error that caused 
	picman_pixel_rgn_get_row() critical warnings (but managed to work).

2003-01-30  Pablo Saratxaga  <pablo@mandrakesoft.com>

	* configure.in: Added Vietnamese (vi) to ALL_LINGUAS

2003-01-30  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/ps.c (save_dialog): corrected small error with
	mnemonic.

2003-01-30  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/c_astretch.c
	* plug-ins/common/edge.c
	* plug-ins/common/cubism.c: code clean-up, plugged a few memory leaks

2003-01-30  Sven Neumann  <sven@picman.org>

	* libpicman/picmancompat.h: removed PICMAN_ENABLE_COMPAT_CRUFT guards.
	The file needs to be included explicitely anyway.

2003-01-30  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.[ch]: renamed plug_in->busy to
	plug_in->in_temp_proc. Added a stack of GMainLoops to each
	plug-in. Added the "current_return_vals" to the PlugIn
	struct. Renamed plug_in_kill() to plug_in_exit(). Removed
	the stuff added below. Cleanup.

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-message.[ch]
	* app/plug-in/plug-in-run.[ch]
	* app/plug-in/plug-in-shm.[ch]: new files taking out functionality
	from the overloaded plug-in.c. Added the code back in that implements
	temp proc return messages (inside an #ifdef) because i don't
	really get why it was removed on Sep 19 1998.

	* app/plug-in/plug-ins.c: changed accordingly.

	* app/plug-in/plug-in-def.c
	* app/plug-in/plug-in-params.c: removed inclusion of <gtk/gtk.h>.

	* app/gui/file-save-dialog.c
	* app/gui/paths-dialog.c
	* app/gui/plug-in-commands.c
	* app/gui/plug-in-menus.c
	* app/pdb/procedural_db.c
	* app/widgets/picmanhelp.c: changed plug-in includes accordingly.

	* app/gui/plug-in-commands.c: don't use "the_picman" from
	"app_procs.h" but get it from the PicmanItemFactory that invoked the
	plug-in callback.

2003-01-30  Nathan Summers  <rock@picman.org>

	* app/tools/picmantoolgui.[ch]: PicmanToolGui, a new class descended 
	from PicmanObject to be used to separate GUI from logic.  Heavily
	inspired by PicmanDrawTool.  Not actually used by anything yet.

2003-01-29  Manish Singh  <yosh@picman.org>

	* plug-ins/common/jpeg.c (load_image): don't divide by zero if
	we get all zero resolution info when we load the jpeg.

2003-01-29  Sven Neumann  <sven@picman.org>
	
	* configure.in
	* app/Makefile.am
	* app/text/Makefile.am: added new directory text.

	* app/text/text-types.h
	* app/text/picmantext.[ch]: moved PicmanText object here.
	
	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimage-text.c
	* app/tools/picmantexttool.c: changed accordingly.

2003-01-29  Michael Natterer  <mitch@picman.org>

	Fixed bug #97449:

	* app/core/picmanchannel.c (picman_channel_scale,resize)
	* app/core/picmanlayer.c (picman_layer_scale,resize)
	* app/undo.c (undo_pop_layer_mod,channel_mod): emit "size_changed"
	whenever the size has changed. Cleaned up the two undo_pop
	functions.

	* app/core/picmanimage.c (picman_image_size_changed): emit
	"size_changed" on all layers/channels so their previews are
	updated correctly on image resize and image resize undo. Don't
	invalidate layers/channels previews here because it's the
	layers'/channels' job to invalidate themselves if needed.

2003-01-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: removed unused function
	picman_prop_enum_option_menu_new_with_values() which caused problems
	on some platforms (fixes bug #102514).

	* app/gui/preferences_dialog.c: removed some unused code.

2003-01-29  Michael Natterer  <mitch@picman.org>

	* app/gui/module-browser.c: pack the button box non-expanding,
	removed cruft from the ModuleBrowser struct.

2003-01-28  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/color_enhance.c: 
	* plug-ins/common/gradmap.c: minor code clean-up

2003-01-28  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picmanui.def: Add missing entry points.

	* plug-ins/common/plugin-defs.pl: Mark bz2, mail, screenshot and
	url as optional (not built on Win32). Ditto for winclipboard and
	winprint (Win32 only).

	* plug-ins/common/mkgen.pl: Use -mwindows on Win32.

	* plug-ins/common/Makefile.am
	* plug-ins/common/.cvsignore: Regenerated.

	* configure.in: Correspondingly conditionally define BZ2, MAIL,
	SCREENSHOT, URL, WINCLIPBOARD and WINPRINT, and AC_SUBST them.
	Set XJT to empty always on Win32 (uses tar, mv and bzip2, which
	aren't usually available).
	
2003-01-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/sample_colorize.c: code clean-up, added a few more
	mnemonics to dialogs.

	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/FractalExplorer/FractalExplorer.c: use new
	picman_plug_in_parse_path routine.

	* libpicman/picmanmiscui.[ch] (picman_plug_in_parse_path): new routine used
	in several plug-ins.

2003-01-27  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: commented out debugging output.

2003-01-27  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/mpeg.c: removed the MPEG plug-in. It has been
	broken, unmaintained and caused nothing but trouble (#51400,
	#104522).

2003-01-26  Tor Lillqvist  <tml@iki.fi>

	* libpicmantool/picmantool.def
	* libpicmanwidgets/picmanwidgets.def: Add some missing entry points.

2003-01-26  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushpipe.c
	* app/gui/about-dialog.c: plugged some obvious memleaks related to
	the use of GRand.

2003-01-26  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c
	* libpicman/libpicman-intl.h
	* libpicmanwidgets/picmanstock.c
	* plug-ins/perl/Picman.xs
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/script-fu-intl.h: replaced all remaining
	"picman14" by GETTEXT_PACKAGE.

2003-01-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: added a tooltip describing the
	compression level scale as suggested in #68485.

2003-01-26  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: removed the description of the image
	title format string from the blurb ...
	
	* app/config/picmanconfig-dump.c: ... and added it here.  Slightly
	improved manpage formatting.

	* app/config/picmanconfig-deserialize.c: fixed a typo.

	* docs/picmanrc-1.3.5.in
	* etc/picmanrc: regenerated.

2003-01-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c: add a tooltip if a param_spec has
	a non-NULL blurb. Addresses bug #68485.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanrc-blurbs.h: marked some blurbs as translatable.

	* Makefile.am
	* app/config/Makefile.am: added dist-hooks so the system picmanrc
	and picmanrc manpage get generated when doing a release.
	
	* libpicmanwidgets/picmanmemsizeentry.[ch]: added the spinbutton to
	the PicmanMemsizeEntry struct so we can access it in order to add
	a tooltip.

2003-01-25  Sven Neumann  <sven@picman.org>

	* app/widgets/widgets-enums.h: added a new enum to specify how to
	display histograms.

	* app/widgets/widgets-enums.c: regenerated.

	* app/widgets/picmanhistogramview.[ch]: added a scale property and
	made channel a property. Added support for linear histograms based
	on a patch from Akkana (see bug #72951).

	* app/widgets/picmanhistogrambox.c: redraw the gradient when the
	histogram view notifies it that the displayed channel has changed.

	* app/tools/picmanhistogramtool.c: added a menu to configure the
	histogram scale.

2003-01-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmandocumentlist.[ch]
	* app/core/picmanimagefile.[ch]: added "Picman" pointers so we don't
	need to use "the_picman" from "app_procs.h".

	* app/core/core-types.h
	* app/core/picman.c
	* app/gui/file-open-dialog.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c: regenerated.

2003-01-23  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: use bpl (line pitch) when
	iterating over the buffer. Added a simple color cache that speeds
	up the filter for images that only use a few colors.

2003-01-23  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: moved some intialisation code out
	of the convert method. Added NONE as possible choice of deficiency
	so you can switch the filter on and off more easily.	

2003-01-23  Sven Neumann  <sven@picman.org>

	* docs/picman-1.3.1.in
	* docs/picman-remote-1.3.1.in
	* docs/picmantool-1.3.1.in: applied a patch from Carol that unifies
	the spelling of PICMAN in the man-pages.

2003-01-23  Michael Natterer  <mitch@picman.org>

	* modules/cdisplay_colorblind.c: Bob Dougherty <bobd@stanford.edu>
	and Alex Wade <wade@ski.org> added the code needed to make this
	filter actually do something useful. Thanks for this contribution.
	Addresses bug #101256.

2003-01-23  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c: added default values for brush,
	pattern, palette, gradient and theme.

	* app/config/picmanconfig-dump.c: set a value for module-load-inhibit
	so it gets documented as well.

	* docs/picmanrc-1.3.5.in
	* etc/picmanrc: regenerated using picmanconfig-dump.

2003-01-22  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c
	* app/config/picmanrc-blurbs.h: applied a patch from Carol that adds
	missing help blurbs and fixes spelling.

	* docs/picmanrc-1.3.5.in
	* etc/picmanrc: regenerated using picmanconfig-dump.

2003-01-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhelp.c (picman_help_internal): "no display ID"
	is "-1", not "0".

2003-01-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/AlienMap2.c: applied patch from Martin Weber
	that removes an outdated link (#103976).

2003-01-20  Sven Neumann  <sven@picman.org>

	* app/gui/info-dialog.c (info_dialog_add_label): made labels in
	the info dialog selectable as suggested in #103991.

2003-01-20  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-progress.[ch]: renamed plug_in_progress_init()
	to plug_in_progress_start() so it matches plug_in_progress_end().
	Added g_return_if_fail() to all functions.

	* app/plug-in/plug-in.[ch]: plug_in_new(): require the passed
	path to be absolute. Removed plug_in_search_in_path(). Replaced
	some if(plug_in){...} by g_return_if_fail(plug_in!=NULL). Cleanup.

	* app/plug-in/plug-ins.c: plug_ins_def_add_from_rc(): refuse to
	add plug_in_defs with non-absolute paths (should never happen).
	Misc cleanup all over the place like s/GSList *tmp/GSList *list/.

	* app/plug-in/plug-in-params.c: cleanup.

	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/plug_in_cmds.c: regenerated.

	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c: some code review & cleanup.

2003-01-19  Tor Lillqvist  <tml@iki.fi>

	* libpicman/picman.def: Add picman_show_tool_tips.

2003-01-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/screenshot.c
	* plug-ins/common/ps.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/xbm.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gtm.c
	* plug-ins/common/csource.c: added mnemonics to dialogs.

2003-01-19  Sven Neumann  <sven@picman.org>

	* app/main.c: just a minor string change.

	* modules/Makefile.am: minor cleanup

	* plug-ins/libgck/gck/gck.h
	* plug-ins/libgck/gck/gckcolor.c: removed unused functions.

2003-01-18  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/CML_explorer.c (CML_next_value): g_rand_new is a
	terribly expensive function, not something you want to execute
	several million times! Fixes #103025

2003-01-17  Michael Natterer  <mitch@picman.org>

	One more Plug-In cleanup, it's still a mess...

	* app/plug-in/plug-in-def.[ch]: renamed "gboolean query" field
	to "needs_query". Added setters for all values. Added
	g_return_if_fail() stuff to all functions.

	* app/plug-in/plug-in-proc.[ch]: added plug_in_proc_def_new().
	Removed the "gboolean data_only" parameter from
	plug_in_proc_def_destroy() and renamed it to
	plug_in_proc_def_free().  Added plug_in_proc_def_get_progname()
	which handles PICMAN_TEMPORARY procedures correctly.

	* app/plug-in/plug-in-rc.c: use the new stuff above.

	* app/plug-in/plug-in.[ch]: renamed field "user_data" to
	"plug_in_def" and added a comment that it is valid only during
	query() and init().  Use the new APIs above. Pass meaningful
	locale_domains and help_paths when adding temporary procedures
	(fixes Scrip-Fu menu translation the right way (TM)). Cleanup.

	* app/plug-in/plug-ins.[ch]: renamed plug_ins_def_add() to
	plug_ins_def_add_from_rc(). Renamed plug_ins_proc_def_[add|remove]()
	to plug_ins_temp_proc_def_[add|remove](). Added "Picman" parameters
	to plug_ins_help_path() and plug_ins_locale_domain(). Removed
	unused pre-1.2 cruft "picmanrc_prof_defs" and plug_ins_image_types().
	Reverse picman->load_procs and picman->save_procs after all procedures
	are registered. Removed Script-Fu translation hack. Reordered stuff.

	* app/gui/plug-in-menus.[ch]: changed accordingly. Named all
	public functions plug_in_menus_*(). Fixed Script-Fu menu translation
	by using plug_in_proc_def_get_progname(). Cleanup.

	* app/gui/file-open-menu.c
	* app/gui/file-save-menu.c: don't g_slist_reverse() picman->load_procs
	and picman->save_procs here.

	* app/gui/toolbox-menu.c
	* app/gui/image-menu.c
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/help_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

	Unrelated:

	* app/gui/image-menu.c
	* app/widgets/picmanitemfactory.c: s/"tearoff1"/"tearoff"/g. I don't
	get why the "1" was there. Minor cleanup.

2003-01-17  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/sinus.c: fixes #81966 plus some code clean-up.

2003-01-17  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c: moved the creation of the
	histogram object to the initialize method because we can't access
	tool_info->picman in tool_init().

2003-01-15  Sven Neumann  <sven@picman.org>

	Fixed bug #103561:

	* app/base/picmanhistogram.[ch]: cleaned up multi-processor code,
	added a PicmanBaseConfig parameter to picman_histogram_new().

	* app/core/picmandrawable-equalize.c
	* app/pdb/color_cmds.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/base/pixel-processor.c: some cleanup to the multi-processor
	code; use the global base_config variable :(

2003-01-14  Manish Singh  <yosh@picman.org>

	* app/core/picmanchannel.h
	* app/core/picmanitem.c
	* app/display/picmannavigationview.c
	* app/gui/paths-dialog.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanscaletool.c
	* app/widgets/picmanlistitem.c
	* libpicman/picmanpixelrgn.c
	* libpicmanwidgets/picmanunitmenu.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/aa.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/psd.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/snoise.c
	* plug-ins/common/spread.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/xjt/xjt.c: some minor code cleanup

	* plug-ins/common/csource.c: 64-bit cleanliness

2003-01-14  Manish Singh  <yosh@picman.org>

	* configure.in: Oops, the configure.in change below didn't actually
	work. Refactored so it does.

2003-01-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c (picman_toolbox_set_geometry): added
	GDK_HINT_USER_POS again since it's set by gtk_window_parse_geometry()
	in picmandialogfactory.c and we don't want to reset it.

2003-01-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanrectselecttool.c: must use N_() instead of _()
	when registering tool menu entries.

2003-01-14  Sven Neumann  <sven@picman.org>

	* app/gui/image-menu.c
	* plug-ins/common/threshold_alpha.c: applied a patch from Henrik
	Brix Andersen that changes the Alpha menu to Transparency (#89275).

2003-01-13  Manish Singh  <yosh@picman.org>

	* configure.in: Partially address #102058 with a --with-shm configure
	option. Defaults to sysv except on OS X, where it is none.

2003-01-13  Michael Natterer  <mitch@picman.org>

	* app/gui/brushes-menu.[ch]
	* app/gui/buffers-menu.[ch]
	* app/gui/channels-menu.[ch]
	* app/gui/colormap-editor-menu.[ch]
	* app/gui/dialogs-menu.[ch]
	* app/gui/documents-menu.[ch]
	* app/gui/file-open-menu.[ch]
	* app/gui/file-save-menu.[ch]
	* app/gui/gradient-editor-menu.[ch]
	* app/gui/gradients-menu.[ch]
	* app/gui/image-menu.[ch]
	* app/gui/images-menu.[ch]
	* app/gui/layers-menu.[ch]
	* app/gui/palette-editor-menu.[ch]
	* app/gui/palettes-menu.[ch]
	* app/gui/patterns-menu.[ch]
	* app/gui/qmask-menu.[ch]
	* app/gui/toolbox-menu.[ch]
	* app/gui/vectors-menu.[ch]: new files, one per PicmanItemFactory,
	containing the menu entries and their setup and update funcs.

	* app/gui/brushes-commands.[ch]
	* app/gui/patterns-commands.[ch]: removed because they contained
	only update funcs.

	* app/gui/Makefile.am: changed accordingly. Split the huge
	SOURCES list in smaller ones for menus and dialogs.

	* app/gui/menus.[ch]: removed the menu entries and setup funcs.
	Added MENU_SEPARATOR() and MENU_BRANCH() macros to the header.
	Made some utility functions public.

	* app/display/picmandisplayshell.[ch]
	* app/gui/buffers-commands.[ch]
	* app/gui/channels-commands.[ch]
	* app/gui/colormap-editor-commands.[ch]
	* app/gui/dialogs-commands.[ch]
	* app/gui/documents-commands.[ch]
	* app/gui/gradient-editor-commands.[ch]
	* app/gui/gradients-commands.[ch]
	* app/gui/images-commands.[ch]
	* app/gui/layers-commands.[ch]
	* app/gui/palette-editor-commands.[ch]
	* app/gui/palettes-commands.[ch]
	* app/gui/qmask-commands.[ch]
	* app/gui/vectors-commands.[ch]: removed the update funcs.

	* app/gui/plug-in-menus.[ch]: renamed plug_in_set_menu_sensitivity()
	to plug_in_menus_update(). Cleanup.

	* app/gui/paths-dialog.[ch]: added the <Paths> entries here
	so they will go away together with these files.

	* app/gui/dialogs-constructors.c
	* app/gui/drawable-commands.c: removed useless #includes.

2003-01-13  Sven Neumann  <sven@picman.org>

	Changed my mind again and decided that picmanconfig-dump should
	create picmanrc-1.3.5.in and have configure process it.
	
	* app/config/Makefile.am
	* app/config/picmanconfig-dump.c: create picmanrc-1.3.5.in to be
	processed by configure.

	* configure.in
	* docs/Makefile.am
	* docs/picmanrc-1.3.5: removed again ...
	* docs/picmanrc-1.3.5.in: ... and replaced with a new version
	generated by picmanconfig-dump.

2003-01-13  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-dump.c
	* app/config/picmanconfig-serialize.c: more work on picmanconfig-dump.

	* configure.in
	* docs/Makefile.am
	* docs/picmanrc-1.3.5.in: removed ...
	* docs/picmanrc-1.3.5: ... and replaced with a new version generated
	using picmanconfig-dump (although it's not perfect yet).

2003-01-12  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/plugin-def.pl
	* plug-ins/common/psd_save.c
	* plug-ins/common/Makefile.am
	* plug-ins/common/.cvsignore: Finally added PSD save support 

2003-01-12  Manish Singh  <yosh@picman.org>

	* plug-ins/common/plugin-def.pl
	* plug-ins/common/Makefile.am
	* plug-ins/common/.cvsignore: Commented out the psd_save.c bit for
	now, looks like bolsh forgot to cvs add the file.

2003-01-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemlistview.c: pass the PicmanItemListView as
	"data" to the item_factory callbacks, not just a "Picman" pointer.

	* app/display/picmandisplayshell.c: use
	gtk_window_add_accel_group(), not picman_window_add_accel_group()
	because we now attach the menubar's accel group, which has the
	PicmanDisplay as callback data.

	* app/display/picmandisplayshell-callbacks.c: pass the PicmanDisplay
	as "popup_data" to *_item_factory_popup_with_data().

	* app/gui/channels-commands.c
	* app/gui/drawable-commands.c
	* app/gui/layers-commands.c
	* app/gui/vectors-commands.c: changed accordingly.

	* app/widgets/picmanwidgets-utils.[ch]: removed
	picman_window_[add|remove]_accel_group() and
	picman_widget_get_callback_context() because they were evil hacks
	which are no longer needed now that all item_factories have proper
	callback data (no just Picman pointers).

2003-01-12  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/plugin-def.pl
	* plug-ins/common/psd_save.c
	* plug-ins/common/Makefile.am
	* plug-ins/common/.cvsignore: Added PSD save support (alpha) to
	devel branch, from a plug-in written by Monignotes (?). This 
	should be integrated into the main PSD plug-in before 1.4 - or 
	should at least use the same PsdImage structure.

2003-01-11  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: reverted my latest change since it broke
	the build in a fresh CVS checkout. Instead added make targets to
	create a man-page and a default picmanrc that take care of building
	picmanconfig-dump.

	* app/config/picmanconfig-dump.c: started to work on the man-page
	dump functionality.

2003-01-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c
	* app/widgets/picmantoolbox.c: removed GDK_HINT_USER_POS and
	GDK_HINT_USER_SIZE again because they caused problems with some
	window managers. Instead, set the window's position with
	gtk_window_parse_geometry().

2003-01-11  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: always build picmanconfig-dump.

	* app/config/picmanconfig-params.[ch]: added an enum to specify the
	type of path with PICMAN_PARAM_SPEC_PATH.

	* app/config/picmanconfig-dump.c: document the different types of
	paths differently.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c: register the path types.

	* etc/picmanrc: generated a new system picmanrc.

	* plug-ins/common/tiff.c: added missing spaces in warning and
	removed trailing newlines in strings passed to g_message().

2003-01-10  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiff.c (load_image): fix compilation error and
	split warning string over multiple lines.

2003-01-10  Sven Neumann  <sven@picman.org>

	* app/app_procs.c (app_init)
	* app/core/picman.c (picman_set_config): delayed the activation of
	picmanrc-autosave so we don't write the monitor resolution obtained
	from GDK back to the picmanrc on each startup.

	* app/gui/gui.c (gui_get_screen_resolution): round values to get
	rid of rounding errors introduced earlier. Looks better in the
	prefs dialog.

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	merged fix for bug #94979 from stable branch. Go even further and
	don't limit the zoom ratio between 1:16 and 16:1.

	* app/display/picmandisplayshell.c (picman_display_shell_new): merged
	fix for bug #103030 from stable branch.

2003-01-10  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiff.c: trivial fix for #95737. Plug-in now displays
	a message when 16 bits per channel images are converted to 8 bits.

2003-01-10  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiff.c (load_image): improved fix for #96611

2003-01-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandataeditor.c: pass the editor widget as
	callback_data to GtkItemFactory callbacks, not a "Picman" pointer.

	* app/gui/buffers-commands.c
	* app/gui/colormap-editor-commands.c
	* app/gui/data-commands.c
	* app/gui/documents-commands.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gradients-commands.c
	* app/gui/images-commands.c
	* app/gui/palette-editor-commands.c
	* app/gui/palettes-commands.c
	* app/gui/patterns-commands.c: simply cast the passed "data"
	pointer instead of calling picman_widget_get_callback_context().
	Don't #include "widgets/picmanwidgets-utils.h".

2003-01-10  Michael Natterer  <mitch@picman.org>

	Move away from creating all item_factories statically in
	menus_init() but create a new one for each place where one is
	needed:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanmenufactory.[ch]: new factory which creates and
	configures the PicmanItemFactories it knows about on-the-fly.

	* app/widgets/picmanitemfactory.[ch]: added
	picman_item_factory_update() which calls the "update_func". Added
	"gboolean update_on_popup" so item_factories can be configured to
	require manual updates (used for the <Image> factory).

	* app/gui/menus.[ch]: create a "global_menu_factory" and register
	all menus we have with it. Added various setup functions which
	do stuff like adding the "Open Recent" menu or reorder plug-in
	menu entries. Removed the debugging stuff...

	* app/gui/Makefile.am
	* app/gui/debug-commands.[ch]: ...and added it here.

	* app/gui/gui.c: create the <Toolbox>, the popup-<Image> and the
	<Paths> factories here because they are still global.

	* app/gui/plug-in-menus.[ch]: changed the "image_factory"
	parameters to "item_factory" and create/update the entries for the
	passed item_factory only. Makes the whole stuff much more
	straightforward.

	* app/plug-in/plug-ins.c: don't call plug_in_make_menu().

	* app/display/picmandisplay.[ch]
	* app/display/picmandisplayshell.[ch]: added "menu_factory" and
	"popup_factory" parameters to picman_display_new() and
	picman_display_shell_new(). Create the menubar_factory and the
	qmask_factory dynamically. Pass the shell, not a Picman to the QMask
	callbacks. Changed picman_display_shell_set_menu_sensitivity() to
	picman_display_shell_menu_update() and don't call it directly (it's
	a PicmanItemFactory update_func now). Call picman_item_factory_update()
	on the resp. factories instead.

	* app/gui/qmask-commands.c
	* app/display/picmandisplayshell-callbacks.c
	* app/tools/picmanimagemaptool.c: changed accordingly.

	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmanbrushfactoryview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancolormapeditor.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandataeditor.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandialogfactory.[ch]
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.[ch]
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmangradienteditor.[ch]
	* app/widgets/picmanimageview.[ch]
	* app/widgets/picmanitemlistview.[ch]
	* app/widgets/picmanpaletteeditor.[ch]: pass around lots of
	PicmanMenuFactory pointers and menu_identifiers so all views can
	create their item_factories themselves. Unref the factories when
	they are no longer needed because they belong to the views now.

	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c
	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c: changed accordingly.

	* app/gui/file-dialog-utils.[ch] (file_dialog_new): require
	menu_factory and menu_identifier parameters.

	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]: removed file_*_dialog_menu_init()
	(they went to menus.c as setup_funcs). Added file_*_dialog_set_type()
	and moved the <Load> and <Save> factory callbacks to file-commands.c

	* app/gui/file-commands.[ch]: changed accordingly.

	* app/gui/view-commands.c: changed the statusbar, menubar, rulers
	and guides callbacks to do their job only if the setting has
	actually changed. Don't update whole item factories afterwards.
	Instead, just change the state of the items that actually need
	update.

	Unrelated:

	* app/core/picmanchannel.c (picman_channel_init): set "bounds_known"
	and friends to FALSE since we don't know that the new channel will
	be empty (fixes QMask and probably other stuff).

	* app/gui/image-commands.c
	* app/gui/vectors-commands.c: cleanup.

2003-01-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.c (picman_stock_init): fixed my last commit.

2003-01-10  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiff.c (load_image): added handling of 
	TIFFTAG_ORIENTATION tag (fixes #96611).

2003-01-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_button_press):
	create a new PicmanVectors object if the tool has none. Cleanup.

2003-01-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.[ch]: prefixed ALL, NONE, GROW and
	SHRINK with SELECTION_ since they should only be used for in a
	selection context. Register a few icons in dialog size as well.

	* app/gui/menus.c
	* app/widgets/picmanselectioneditor.c: changed accordingly.

	* themes/Default/images: renamed icons accordingly.

	* plug-ins/common/uniteditor.c: use stock items.

2003-01-10  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: fixed a compiler warning.

	* plug-ins/gfig/gfig.c: fixed preview code so that the plug-in is
	at least a bit useful again. Misc minor cleanups, still a mess.

2003-01-09  Sven Neumann  <sven@picman.org>

	* app/app_procs.c: fixed typos.

	* app/tools/xinput_airbrush.[ch]: removed from CVS; can always be
	resurrected from the Attic. The files kept getting in the way when
	grepping the source.
	
2003-01-09  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/mblur.c: fixes #83968 (Motion Blur filter: disable 
	parameters that have no effect)

2003-01-09  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: fixed typo.

	* app/pdb/procedural_db.c (procedural_db_run_proc): always set the
	number of returned values, even in case of an error.

	* app/widgets/picmanhelp.c: fix #65789 similar to how Tor did it in
	the stable branch.

2003-01-09  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/images/Makefile.am
	* plug-ins/gfig/images/stock-logo.png: new Gfig logo courtesy of
	Owen <oc@webone.com.au>.

	* plug-ins/gfig/gfig-stock.[ch]
	* plug-ins/gfig/gfig.c: use the new logo icon.

	* plug-ins/gfig/pix_data.h: removed the old one.

2003-01-09  Jakub Steiner <jimmac@ximian.com>

	* data/images/picman_splash.png: new splash

2003-01-09  Sven Neumann  <sven@picman.org>

	* app/main.c (main)
	* app/app_procs.c (app_init): combined console output into single
	messages to allow for better translation.

2003-01-09  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.c (picman_drawable_configure): use _("Unnamed")
	if no name was given. Fixes bug #89328 in a more general way.

	* plug-ins/common/psd.c: simply pass NULL as layer and channel
	name if the PSD file provides none.

2003-01-08  Manish Singh  <yosh@picman.org>

	* app/gui.[ch]: make gui_libs_init() use gtk_init_check() and return
	a gboolean on success or failure.

	* app/main.c: reorganized so that --help and --version never need
	the gui to be initialized. Print a proper message when the gui cannot
	be initialized (perhaps recommend --no-interface?). Return nonzero
	exit status on failures.

2003-01-08  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/psd.c (do_layer_record): setting the layer name to
	"unnamed" when it's NULL. Fixes #89328.

2003-01-08  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/psd.c: removed MAX_LAYERS and MAX_GUIDES. Memory
	is now allocated dynamically. Fixes #91282. MAX_CHANNELS is still set
	to 30.

2003-01-08  Simon Budig  <simon@picman.or>

	* tools/picman-remote.c: Implemented a heuristics that tries to
	start the picman in the same directory as picman-remote-1.3.
	If this fails it falls back to the regular PATH search.

	For sanity checks this feature requires that the command name
	starts with "picman-remote". If you do weird symlinks the heuristics
	will fall back to the PATH search silently.

2003-01-08  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/images/stock-*.png: a new set of icons drawn by
	Jimmac; fixes bug #92473.

2003-01-08  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_init): work around a
	canvas size bug by setting an empty text to the progressbar.

2003-01-07  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/Makefile.am: add picmanmemsizeentry.h to HEADERS
	(Fixes #102789)

2003-01-07  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: don't try to initialize the showtooltips
	member in the selvals struct; it's gone.

2003-01-07  Michael Natterer  <mitch@picman.org>

	Fixed bug #13296:

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	don't do evil stuff but simply call gtk_window_resize(). Gtk+ will
	automatically place the window onscreen if it would be invisible
	after resizing.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_configure): don't call
	picman_dislpay_shell_scale_resize() to avoid recursion but do the
	two needed calls manually.

2003-01-07  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanhelpui.[ch]: removed picman_help_init() and
	picman_help_free(). Added _picman_help_init() instead.

	* libpicmanwidgets/picmanwidgets.def: changed accordingly.

	* libpicmanwidgets/picmanwidgets.c (picman_widgets_init): call
	_picman_help_init() so it doesn't need to be done in all plug-ins
	manually.

	* libpicman/picmancompat.h: added picman_help_init() and picman_help_free()
	here as COMPAT_CRUFT.

	* app/gui/gui.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/blur.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/gtm.c
	* plug-ins/common/illusion.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/plasma.c
	* plug-ins/common/polar.c
	* plug-ins/common/ps.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/warp.c
	* plug-ins/common/wind.c
	* plug-ins/gap/gap_arr_dialog.c
	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/maze/maze_face.c
	* plug-ins/print/picman_main_window.c
	* plug-ins/sel2path/sel2path.c: removed the calls to
	picman_help_init() and picman_help_free().

	Fixed bug #81017:

	* libpicmanbase/picmanprotocol.[ch]: added "guint8 show_tool_tips"
	to the GPConfig message. Increased the protocol version number.

	* app/plug-in/plug-in.c: pass the value of gui_config->show_tool_tips.

	* libpicman/picman.[ch]: added picman_show_tool_tips() to get the value
	which was passed in the GPConfig message.

	* libpicman/picmanui.c (picman_ui_init): disable the tooltips
	if show_tool_tips is FALSE.

	* plug-ins/MapObject/mapobject_main.[ch]
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/jigsaw.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gfig/gfig.c: removed all plug-in specific GUI for
	enabling/disabling tooltips.

2003-01-07  Sven Neumann  <sven@picman.org>

	* plug_ins/common/Makefile.am
	* plug_ins/common/plugin_defs.pl: added back spheredesigner so it
	gets some testing again. Needs a good bunch of UI cleanup.

	* plug-ins/common/spheredesigner.c (loadit): use
	locale-independent functions to parse doubles.

2003-01-06  Manish Singh  <yosh@picman.org>

	* lots of files in plug-ins: cleanup, removed unecessary
	G_OBJECT() casts.

2003-01-07  Sven Neumann  <sven@picman.org>

	* common/hrz.c
	* common/plugindetails.c
	* common/spheredesigner.c
	* picmanressionist/orientmap.c
	* picmanressionist/sizemap.c
	* plugin-helper/color_picker.c
	* plugin-helper/iwarp.c
	* winsnap/winsnap.c: ported to GObject signal API.

2003-01-07  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/gfig/Makefile.am
	* plug-ins/gfig/images/Makefile.am: added a new directory with PNG
	images for the GFig plug-in.

	* plug-ins/gfig/images/*.png: placeholder images that need to be
	replaced (see bug #92473).

	* plug-ins/gfig/gfig-stock.[ch]: new files that register the
	images as stock icons.

	* plug-ins/gfig/gfig.c: use stock icons for the buttons on the
	left side of the dialog.

	* plug-ins/gfig/pix_data.h: removed obsoleted images. The
	remaining ones should get converted as well.

2003-01-06  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_selection.c: replaced all gtk_signal_connect
	by g_signal_connect.

2003-01-06  Tor Lillqvist  <tml@iki.fi>

	* plug-ins/script-fu/script-fu-server.c: Bypass whole file on
	Win32.

2003-01-06  Michael Natterer  <mitch@picman.org>

	* plug-ins/gfig/gfig.c: even more undeprecated, some cleanup.

2003-01-06  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c: made it a lot less deprecated. Removed
	gazillions of unneeded casts and changed others to the more
	portable GINT_TO_POINTER() / GPOINTER_TO_INT() macros. Still more
	work to be done ...

2003-01-06  Michael Natterer  <mitch@picman.org>

	* libpicmantool/picmantoolenums.[ch]: added enum PicmanRectSelectMode
	which can be one of "free", "fixed-size" and "fixed-ratio".

	* app/tools/selection_options.[ch]: replaced the "Fixed Size /
	Aspect Ratio" toggle by a menu offering the choices above.

	* app/tools/picmanrectselecttool.[ch]: changed accordingly. Removed
	the possibility to <shift>-switch from "fixed-size" to
	"fixed-ratio" mode. Fixes bug #100320.

2003-01-06  Michael Natterer  <mitch@picman.org>

	* etc/gtkrc_user: give an example (commented out) how to change
	the F1 help binding. Fixes bug #6920.

2003-01-06  Sven Neumann  <sven@picman.org>
	    Michael Natterer  <mitch@picman.org>

	* tools/picman-remote.c (picman_remote_find_window): re-wrote this
	function without looking at the original source, so it is finally
	free from non-GPL copyright issues.

2003-01-06  Sven Neumann  <sven@picman.org>

	* docs/picman-1.3.1.in
	* docs/picmantool-1.3.1.in: removed incorrect copyright clauses and
	updated information about bug reporting.

2003-01-06  Sven Neumann  <sven@picman.org>

	* app/gui/gradient-editor-commands.c
	* libpicman/picmanexport.c: don't split translatable sentences into
	multiple messages (bug #85828).

2003-01-05  Manish Singh  <yosh@picman.org>

	* app/core/picmanobject.c: cast memsize to a guint instead of format
	change. Problem perhaps if get_size really is > 4 GB?

2003-01-05  Manish Singh  <yosh@picman.org>

	* many files in app, modules and libpicman*: cleanup, removed unecessary
	G_OBJECT() casts. Should do the same for plug-ins, when more of them
	get undeprecated.

2003-01-05  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/interp_regex.c: same as below for here.

2003-01-05  Manish Singh  <yosh@picman.org>

	* app/core/picmanimage-new.c: oops, cast here instead of changing the
	format string so we're ok on 32-bit too.

2003-01-05  Manish Singh  <yosh@picman.org>

	* app/undo_history.c
	* app/core/picmanbrush.c
	* app/core/picmanimage-new.c
	* app/core/picmanobject.c
	* app/core/picmanpalette-import.c
	* app/core/picmanpattern.c
	* app/plug-in/plug-in.c
	* app/tools/picmanbezierselecttool.c
	* libpicmanwidgets/picmanunitmenu.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/tiff.c
	* plug-ins/flame/flame.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/general.c
	* plug-ins/picmanressionist/orientation.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/picmanressionist/size.c
	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/maze/algorithms.c
	* plug-ins/script-fu/interp_regex.c
	* plug-ins/script-fu/interp_sliba.c
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/webbrowser/webbrowser.c: added GINT_TO_POINTER and friends,
	fixed format strings, for 64-bitness.

	* modules/colorsel_triangle.c
	* plug-ins/tools/tool-safe-mode-plug-in.c: #include missing header
	files

2003-01-05  Michael Natterer  <mitch@picman.org>

	* configure.in: changed --with-gnome-desktop to --with-gnome-datadir

	* data/misc/picman.applications
	* data/misc/picman.keys: added mime info files from Hadess
	<hadess@hadess.net> so gnome-vfs can associate various mime types
	with PICMAN.

	* data/misc/Makefile.am: install everything into the right
	subdirectories of GNOME_DATADIR.

2003-01-05  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/script-fu/scripts/starscape-logo.scm
	(apply-starscape-logo-effect): fixes #73894. A channel was removed
	but never added to the image.

2003-01-05  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmisc.c (picman_pixel_fetcher_get_pixel2): x and y
	coordinates have to be clamped on image width/height - 1. Fixes
	#102562

2003-01-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanchainbutton.[ch]
	* libpicmanwidgets/picmancolorarea.[ch]
	* libpicmanwidgets/picmancolorbutton.[ch]
	* libpicmanwidgets/picmandialog.c
	* libpicmanwidgets/picmanfileselection.[ch]
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpickbutton.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanwidgets.c: added more API documentation.
	Declared picman_scale_entry_new_internal() as static.

	* libpicmanwidgets/picmanwidgets.def: changed accordingly.

2003-01-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanmemsizeentry.[ch]: made PicmanMemsizeEntry a
	widget which doesn't use a GtkAdjustment to store the value.  The
	latter caused problems on 64bit machines since a gdouble doesn't
	provide enough precision for G_MAXULONG.

	* libpicmanwidgets/picmanwidgets.[ch]
	* libpicmanwidgets/picmanwidgetstypes.h
	* app/widgets/picmanpropwidgets.c: changed accordingly.

2003-01-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.c (picman_image_merge_layers): redid the
	fix for bug #101036. Instead of temporarily changing the layer
	mode, just use a different mode for combine_regions().

2003-01-05  Sven Neumann  <sven@picman.org>

	* app/gui/qmask-commands.c (qmask_channel_query): don't free the
	options structure twice (fixes bug #102515).

2003-01-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c: (picman_prop_enum_option_menu_new):
	pass NULL, not 0 to fix compilation on Alpha (bug #102514).

2003-01-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerlistview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanitemlistview.c: check preview sizes to be
	smaller than PICMAN_PREVIEW_MAX_SIZE instead of using a hardcoded
	and much too small value of 64.

	* app/widgets/picmandialogfactory.c: check that the preview size is
	in range of the PicmanPreviewSize enum when parsing the sessionrc.

2003-01-04  Sven Neumann  <sven@picman.org>

	* app/base/tile-swap.c (tile_swap_find_offset): use off_t to
	return the offset. Finally allows to handle swap files larger than
	2 GB (fixes bug #74478).

2003-01-03  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c 
	* plug-ins/bmp/bmp.[ch]: added mnemonics to save dialog. Minor code
	clean-up.

2003-01-03  Sven Neumann  <sven@picman.org>

	* configure.in: bumped the version number to 1.3.12.

	* app/display/Makefile.am
	* app/display/picmandisplayshell-cursor.[ch]
	* app/display/picmandisplayshell-title.[ch]
	* app/display/picmandisplayshell-transform.[ch]: new files with code
	that used to live in picmandisplayshell.c.

	* app/display/picmandisplay-foreach.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmandisplayshell.[ch]
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmantool.c: changed accordingly.

2003-01-03  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c (tool_manager_image_undo_start): don't
	HALT the active tool if it is in "preserve" mode. Fixes crashes
	when e.g. the transform tool was pushing an undo group and
	implicitly HALTing itself in the middle of the transform
	operation.

2003-01-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c
	* app/widgets/picmantoolbox.c: convince more window managers to
	actually use the specified window positions/sizes by adding
	GDK_HINT_USER_POS and GDK_HINT_USER_SIZE to the windows'
	geometry hints.

2003-01-03  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantoolcontrol.c (picman_tool_control_halt): don't
	set paused_count to 0.

	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/tools/tool_manager.c: removed comments about doing so.

2003-01-02  Manish Singh  <yosh@picman.org>

	* app/base/base.c (base_init): terminate g_object_set args with NULL.

2003-01-02  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.[ch]
	* libpicmanmodule/picmanmoduledb.[ch]: added API docs, removed cruft.
	Fixes bug #5746.

2003-01-02  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preview.[ch]: fix for #102303

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_object.c
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_polygon.c
	* plug-ins/imagemap/imap_edit_area_info.c
	* plug-ins/imagemap/imap_cmd_*.c: code clean-up

	* plug-ins/imagemap/imap_cmd_*.h: removed. All prototypes are now
	in imap_commands.h

	* plug-ins/imagemap/imap_commands.h: new file with command prototypes

	* plug-ins/imagemap/Makefile.am: updated accordingly

2003-01-02  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.[ch]: added PICMAN_MODULE_ABI_VERSION
	define and a "guint32 abi_version" field to PicmanModuleInfo.  When
	querying a module, check if it was compiled against the same ABI
	version as the code loading it. Fixes bug #5744.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: changed accordingly.

2003-01-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewabledialog.c (picman_viewable_dialog_close):
	just a small cleanup.

2003-01-02  Michael Natterer  <mitch@picman.org>

	Replaced Garry's fix for bug #98843 by a more general solution
	which stops the active tool when an undo group start is pushed:

	* app/core/picmanimage.[ch]: removed the "layer_merge" signal
	and added "undo_start" instead.

	* app/undo.c: emit "undo_start" in undo_push_group_start()
	_before_ checking if gimage->undo_on is TRUE.

	* app/tools/tool_manager.c: connect to "undo_start" and HALT the
	active tool if neccessary.

	* app/core/core-types.h: added EDIT_COPY_UNDO_GROUP.

	* app/core/picmanedit.c: push an undo group around the copy
	operation. Will probably have to add more undo group types to wrap
	other critical image modifications with.

	* app/core/picmanimage-merge.c
	* app/gui/convert-dialog.c
	* app/gui/edit-commands.c
	* app/gui/test-commands.c
	* app/tools/picmanimagemaptool.c: removed all special code to
	stop the active tool.

2003-01-02  Michael Natterer  <mitch@picman.org>

	* app/gui/user-install-dialog.c: replaced the 0755 by properly
	or'ed symbolic values (undid this change from Sven accidentially).

2003-01-01 Garry R. Osgood <grosgood@rcn.com>
	
	* MAINTAINERS: Updated my CVS.
	* app/undo.c: Check if LayerUndo object provides a previous 
	layer before setting such active; in some cases the result of a
	redo is an empty image, and prev_layer is not populated. Part of
	bug # 98843.
	* app/undo_history.c: undo_history_new () Increments reference 
	count on PicmanImage in undo_history_st; 
	undo_history_shell_destroy_callback () dereferences. Before,
	with undo history dialog active on application exit, the PicmanImage
	ref count would already be zero, with memory reclaimed, when
	picman_dialog_factory_dispose () invoked 
	undo_history_shell_destroy_callback (). See stack dumps in 
	bug # 98843; in part closes same.
	* app/core/picmanimage-merge.c : picman_image_merge_layers ()
	Regardless of merge type, temporarily set composition mode
	of bottom layer to NORMAL, then merge. Closes bug #101036.
	Issues LAYER_MERGE signal (see bug #98843); listeners thaw
	undo stack (image map tools, usually) in part closes this bug.
	* app/core/picmanimage.[ch] Define and implement a LAYER_MERGE
	signal. 
	* app/tools/picmanimagemaptool.c: picman_image_map_tool_initialize ()
	connects its associated PicmanImage with dialog's cancel callback
	via the PicmanImage's LAYER_MERGE signal. picman_image_map_tool_finalize ()
	disconnects. Dismisses dialog in layer merges. In part closes
	bug # 98843.
	* app/widgets/picmanviewabledialog.c: picman_viewable_dialog_close () 
	Check if the widget has a non-null reference to a window before
	using it to synthesize a cancel event.

2003-01-01  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c (image_entries): changed some menu entries as
	suggested in bug #101974.

	* app/display/picmandisplayshell.c: changed accordingly. 

2003-01-01  Hans Breuer  <hans@breuer.org>

	* libpicmanbase/picmandatafiles.c : when checking for
	'excecutable' make sure it is a regular file too
	(on win32 even directories carry the IXUSR flag)

	* app/app_procs.h : there is still no #warning with
	msvc, special case to make it build with non GCC

	* makefile.msc */makefile.msc */*/makefile.msc : updated

	* app/gui/user-install-dialog.c : get prototype for mkdir

	* libpicmanwidgets/libpicman-glue.c : make it compile without
	LT_RELEASE being defined

	* modules/module.def : removed
	  modules/Makefile.am : no export file needed when 
	functions get exported by G_MODULE_EXPORT

2003-01-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_about.c
	* plug-ins/imagemap/imap_file.c
	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_polygon.[ch]
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_stock.[ch]
	* plug-ins/imagemap/imap_edit_area_info.[ch] 
	* plug-ins/imagemap/imap_statusbar.[ch]
	* plug-ins/imagemap/imap_cmd_copy.[ch]: removed use of deprecated GTK 
	widgets and routines plus some code clean-up.

2003-01-01  Tor Lillqvist  <tml@iki.fi>

	* modules/Makefile.am: On Win32, use -no-undefined, and add
	dependent libraries to the LIBADDs.

2002-12-31  Simon Budig  <simon@picman.org>

	* app/vectors/vectors-types.h: New Type: PicmanVectorExtendMode

	* app/tools/picmanvectortool.c
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.[ch]: More stuff on the path
	(pun intended) to a better path tool...

	Thanks to Sven for being my host in Berlin!

2002-12-31  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/fileops.pdb (picman_temp_name): need to expand the
	temp_path before using it.

	* app/pdb/fileops_cmds.c: regenerated.

2002-12-30  Sven Neumann  <sven@picman.org>

	* Made 1.3.11 release.

2002-12-30  Michael Natterer  <mitch@picman.org>

	* app/gui/user-install-dialog.c: some more cleanup: check the
	return value of fclose() in copy_file(), added an enum for the
	notebook pages, added '' around displayed filenames, update the
	GUI while creating the user directory, misc stuff.

2002-12-30  Sven Neumann  <sven@picman.org>

	* data/environ/Makefile.am
	* etc/Makefile.am: fixed EXTRA_DIST rules.

2002-12-30  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_png_thumb_path): use
	proper defines to specify the permissions when calling mkdir().

	* app/file/file-utils.c: removed redeclaration of mkdir() for
	Win32 since we don't call mkdir() here.

	* app/gui/user-install-dialog.c (user_install_run): rewrote
	copy_file() to use GError for error reporting. Use the same code
	for the user installation on all platforms. Also fixes bug #102015.

	* data/misc/Makefile.am
	* data/misc/user_install
	* data/misc/user_install.bat: removed obsoleted scripts.

2002-12-30  Simon Budig  <simon@picman.org>

	* app/vectors/picmananchor.h
	* app/vectors/vectors-types.h: anchors now have an enum as type and
	have the "selected" property.

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanbezierstroke.c	
	* app/vectors/picmanvectors-preview.c: additional functions to get
	information about the graphical representation of the stroke and
	to be able to select anchors.

	* app/tools/picmanvectortool.c: semi-usable interface, better
	graphical representation of what is going on. Make use of the
	"selected" property of the anchors to just display a subset of the
	control handles.

2002-12-30  Sven Neumann  <sven@picman.org>

	* app/config/picmanpluginconfig.[ch]
	* app/config/picmanrc-blurbs.h: added "script-fu-path" back to picmanrc.

2002-12-30  Sven Neumann  <sven@picman.org>

	* app/app_procs.c
	* app/core/picman.c
	* app/gui/gui.c
	* app/widgets/picmanitemfactory.c: removed debugging output.

	* app/plug-in/plug-ins.c: need to expand the plug_in_path before
	using it.

	* app/gui/plug-in-menus.c (plug_in_menus_init): removed an
	unneeded assertion.

	* plug-ins/imagemap/Makefile.am (EXTRA_DIST): removed references
	to files that were removed some time ago.

2002-12-30  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanpluginconfig.[ch]: new files that define plug-in
	specific configuration.

	* app/config/config-types.h
	* app/config/picmanrc-blurbs.h
	* app/picmanrc.[ch]: derive PicmanRc from PicmanPluginConfig.

	* etc/picmanrc: regenerated (picman-config-dump --system-picmanrc).

2002-12-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: another fix for #102016.

2002-12-29  Sven Neumann  <sven@picman.org>

	* configure.in: check for app/core/picman.c instead of etc/picmanrc.in
	which no longer exists.

	* app/gui/user-install-dialog.c: use the term Folder instead of
	Directory (fixes bug #102016).

2002-12-29  Sven Neumann  <sven@picman.org>

	* configure.in
	* etc/Makefile.am
	* etc/picmanrc.in
	* etc/picmanrc_user.in: removed templates for picmanrc files.

	* etc/picmanrc: added this file as generated by picman-config-dump.

	* app/gui/user-install-dialog.c
	* data/misc/user_install: don't install an empty user picmanrc.

	* app/config/Makefile.am
	* app/config/picmanconfig-substitute.[ch]: removed these files.
	* app/config/picmanconfig-path.[ch]: and added them again with
	reduced functionality. Paths found in config files are now
	basically handled like standard strings by the config system.
	Users of the PicmanConfig path variables need to expand the path
	themselves.

	* app/config/picmanbaseconfig.c
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-dump.c
	* app/config/picmanconfig-utils.c
	* app/config/picmanconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmanrc.c:
	* app/base/base.c
	* app/base/temp-buf.c
	* app/core/picman.c
	* app/core/picmandatafactory.c
	* app/core/picmanmodules.c
	* app/gui/user-install-dialog.c
	* app/plug-in/plug-in.c
	* app/tools/tools.c
	* app/widgets/picmanpropwidgets.c: changed accordingly.
	
2002-12-29  Simon Budig  <simon@picman.org>

	* app/core/picmanimage-mask-select.c
	* app/paint/picmanpaintcore-stroke.c
	* app/tools/picmanvectortool.c
	* app/vectors/picmanbezierstroke.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors-preview.c: some more stuff for the
	vectors tool: bezier interpolation is available, we have preview
	generation. Usage is still weird.

2002-12-28  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: untested and unused stuff
	for the interpolation of bezier curves. More to come soon.

2002-12-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/smooth_palette.c (dialog): fix for #82490 (Smooth 
	Palette: use standard PICMAN size entry) and #101902 (Smooth Palette 
	crashes on 1x1 image). Minimum width for Smooth Palette is set to
	2, since in the code g_rand_int_range (gr, 0, width - 2) is used.
	Allowing a width of 1 results in an assertion in g_rand_int_range.
	
2002-12-26  Tor Lillqvist  <tml@iki.fi>

	* app/Makefile.am: On Win32, create export file picman.exp.
	(EXTRA_DIST): Drop makefile.mingw{,.in}.
	(LDFLAGS): Add -mwindows.
	(LDADD): Link with picman.exp.

	* app/picman.sym: Remove all old entries (seemed to be obsolete).
	Instead, add the ones linked to from libpicmantool and
	libpicmanwidgets.

	* app/gui/user-install-dialog.c (user_install_run): On Win32, use
	similar code as in PICMAN 1.2, i.e. don't run a script to do the
	mkdirs and copying, but do it ourselves. Markup the tree_items
	elements accordingly to direct the action.

	* libpicman/picman.c: Define LIBPICMAN_COMPILATION.
	(picman_main) [Win32] Use g_ascii_strcasecmp().

	* libpicman/picman.def: Add _readchannel (used by libpicmanui).

	* libpicman/picman.h: Fix minor typo in comment

	* libpicmanproxy/Makefile.am
	* libpicmantool/Makefile.am
	* libpicman/Makefile.am: Similar additions for Win32 as in the other
	libpicman*/Makefile.am files: Use -no-undefined. Conditionally link
	to ../lib*/*.la as needed. Use the .def file. Produce MS style
	import library if possible. Install and uninstall import
	libraries.

	* libpicman/Makefile.am
	* modules/Makefile.am
	* plug-ins/Makefile.am: Don't distribute makefile.mingw{,.in}.

	* libpicmanproxy/picmanproxy.def
	* libpicmantool/picmantool.def: New files.

	* libpicmantool/glue.c: New file. Used on Win32 to be able to link
	at run-time against entries in the main executable that has loaded
	the libpicmantool DLL. (If I understand correctly how things are
	supposed to work, this will be either picman.exe or
	tool-safe-mode.exe, but that doesn't matter.)

2002-12-23  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmiscui.c (picman_fixme_preview_new): make sure preview
	structure is correctly initialized.

	* libpicman/picmanmisc.[ch] (picman_pixel_fetcher_put_pixel): added new
	routine to picmanmisc.

2002-12-23  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/plasma.c: better use of libpicman routines, code
	clean-up

	* plug-ins/common/grid.c (doit): fixed small problem in preview when
	displaying images with an alpha channel.

	* plug-ins/Lighting/lighting_main.c (run): fixed #81479 ("Repeat Last" 
	incorrectly enabled if Lighting Effects plug-in is cancelled)

2002-12-23  Tor Lillqvist  <tml@iki.fi>

	* configure.in: When bulding with GCC for Win32, use either
	-fnative-struct or -mms-bitfields depending on GCC version. Don't
	output the build/.../Makefiles, the build subdir isn't needed here
	any longer (see 2001-02-17 entry by Hans Breuer). Don't output the
	*/makefile.mingw as they are seriously obsolete anyway.

	* Makefile.am (SUBDIRS): Remove build subdir here, too.

	* libpicmancolor/Makefile.am (EXTRA_DIST)
	* libpicmanmath/Makefile.am (EXTRA_DIST)
	* libpicmanbase/Makefile.am (EXTRA_DIST): Drop makefile.mingw{,.in}.

	* libpicmanmodule/Makefile.am (INCLUDES): Add GMODULE_CFLAGS.
	(LIBADD): Add GMODULE_LIBS.

	* libpicmanwidgets/Makefile.am: Similar additions for Win32 as in
	the other libpicman*/Makefile.am files: Use -no-undefined. Use the
	.def file. Produce MS style import library if possible. Install
	and uninstall import libraries.
	(AM_CPPFLAGS) Define LT_RELEASE and LT_CURRENT_MINUS_AGE.
	(libpicmanwidgets_1_3_la_sources) Include libpicman-glue.c

	* libpicmanwidgets/libpicman-glue.c: Bypass whole file unless Win32.
	(dynamic_resolve): Try both the libtool style DLL name and Hans
	Breuer's naming scheme.
	(picman_*) Replace duplicated code snippets with calls of a
	preprocessor macro.

2002-12-21  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_csim.l: add "<string.h> to remove warning.

	* plug-ins/imagemap/imap_csim_parse.[ch]: regenerated 

	* plug-ins/imagemap/imap_csim.y: fix for #97776 (Imagemap can't read 
	CSIM files after itself)

2002-12-20  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-blurbs.h: removed ...
	
	* app/config/picmanrc-blurbs.h: ... and readded under this
	name. Should have never been named with a picmanconfig prefix since
	it's not part of the generic PicmanConfig system.

	* app/config/config-types.h
	* app/config/picmanbaseconfig.c
	* app/config/picmanconfig-dump.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c: changed accordingly.

2002-12-20  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf.c: use G_N_ELEMENTS().

2002-12-20  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c (picman_config_serialize): check the return
	value of close().

2002-12-20  Nathan Summers  <rock@picman.org>

	* app/xcf/xcf-write.[ch]
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c: ported the fix for bug #101340 over from the
	stable branch.  Uses GError to report errors, unlike the stable
	version, which uses a pointer to gboolean.

	* app/xcf/xcf-seek.[ch]: check the return value of fseek and ftell
	for errors.  Return FALSE and set GError if an error is detected.

	* app/xcf/xcf-load.c: since the xcf-seek functions use GError now,
	added a NULL for the error parameter.  Added basic error checking
	on the return value of the xcf-seek functions.  In the future,
	changing xcf-load.c to use GError more completely should be
	considered.

2002-12-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/grid.c: replaced preview code by calls to libpicman

	* plug-ins/imagemap/imap_file.c
	* plug-ins/imagemap/imap_menu.c: use g_file_test funcs to test if
	a file already exists instead of a call to fstat().

2002-12-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/wind.c (dialog_box)
	* plug-ins/common/nova.c (nova_center_create)
	* plug-ins/common/max_rgb.c (dialog)
	* plug-ins/common/jigsaw.c (dialog_box)
	* plug-ins/common/flarefx.c (flare_center_create)
	* plug-ins/common/illusion.c
	* plug-ins/common/glasstile.c: add parameter to call to 
	picman_fixme_preview_new

	* libpicman/picmanmiscui.[ch] (picman_fixme_preview_new): Added boolean
	parameter has_frame to put the preview into a frame. Preview now
	also handles indexed images correctly.

2002-12-19  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscales.c: mark "Scales" for translation.

2002-12-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: added utility functions
	picman_get_mod_name_[shift|control|alt]() and picman_get_mod_separator()
	which get the translated strings for "Shift", "Ctrl", "Alt" and "+"
	from GtkAccelLabelClass to force consistency between menu
	accelerators and other modifiers displayed in the GUI.
	Made the format string to display the modifier ("<%s>")
	translatable separately.

	* app/gui/file-open-dialog.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c
	* app/tools/transform_options.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanitemlistview.c
	* app/widgets/picmanvectorslistview.c: use the new functions instead
	of hardcoding the modifier names over and over again.

	* app/tools/transform_options.c: made a scale_entry out of the
	grid density spinbutton.

2002-12-19  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplay.c (picman_color_display_class_init):
	initialize all class members with default values.

2002-12-19  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.c: use g_message/g_print consistently.

2002-12-19  Michael Natterer  <mitch@picman.org>

	* libpicman/picmandrawable.c (picman_drawable_attch_new_parasite):
	s/drawable/drawable_ID/ to match the header.

2002-12-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: replaced lots of "gpointer data"
	parameters of local callbacks by PicmanCurvesTool* and
	PicmanLevelsTool* pointers. Makes the code shorter and more
	readable. Some random cleanup.

	* app/tools/picmanhistogramtool.c: fixed type of "parent_class"
	pointer.

2002-12-18  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): fixed
	ascii-art to match current widget hierarchy.

	* app/display/picmandisplayshell-handlers.c: fixed typos so we
	actually connect to notify::monitor-[xy]resolution. Expose and
	flush the display in the handler so the resolution change becomes
	visible.

2002-12-18  Michael Natterer  <mitch@picman.org>

	* modules/cdisplay_colorblind.c (cdisplay_colorblind_get_type)
	* modules/cdisplay_gamma.c (cdisplay_gamma_get_type)
	* modules/cdisplay_highcontrast.c (cdisplay_contrast_get_type):
	s/select_info/display_info/

2002-12-18  Sven Neumann  <sven@picman.org>

	* libpicman/picmangradientmenu.c (picman_gradient_select_widget): match
	the parameter name in the header to please gtk-doc.

2002-12-17  Manish Singh  <yosh@picman.org>

	* app/core/picmanenvirontable.[ch]: added some rudimentary support
	to prepend values to existing environment variables. You can do
	"separator name=value" now. API change to picman_environ_table_add
	for it too. Also added some error checking.

	* app/gui/gui.c: change to new above API

	* plug-ins/pypicman/Makefile.am: write ": PYTHONPATH=" out to env
	file

	* po/POTFILES.in: add picmanenvirontable.c

2002-12-17  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/picmanressionist/Presets/*: changed all \010 in strings by
	\012 so that the g_strcompress/g_strescape pair now works correctly.
	
	* plug-ins/picmanressionist/sizemap.c
	* plug-ins/picmanressionist/orientmap.c: reordered Apply/Cancel/Ok
	buttons in dialogs.

	* plug-ins/picmanressionist/presets.c 
	* plug-ins/picmanressionist/paper.c 
	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/picmanressionist.[ch]: replace deprecated
	GtkList by GtkTreeView widgets.

2002-12-17  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/Lighting/lighting_ui.[ch] 
	* plug-ins/Lighting/lighting_preview.c: applied patch from Jeroen
	Lamain. Dragging of lightsource is more smoothly now plus you can 
	now also drag directional lights.

2002-12-17  Nathan Summers  <rock@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpatternmenu.c: documented all publically visible
	functions

	* libpicman/picmanmenu.h: fixed a typo

2002-12-17  Nathan Summers  <rock@picman.org>

	* libpicman/picman.[ch]
	* libpicman/picmandrawable.c
	* libpicman/picmanimage.c: added some documentation

2002-12-17  Sven Neumann  <sven@picman.org>

	* plug-ins/perl/Picman.pm: merged fix for #84884 from stable branch.

2002-12-17  Sven Neumann  <sven@picman.org>

	* app/main.c: merged fix for #71409 from stable branch.

	* plug-ins/common/jpeg.c: merged fix for #75398 from stable branch.

2002-12-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c
	* app/tools/transform_options.[ch]: replaced the totally unclear
	(to the user) way we used to calculate the number of grid lines
	from the value entered in the "Density" spinbutton by a system
	where the user has the choice between the number of grid lines to
	display and the spacing between the displayed grid lines. Replaced
	the "Show Grid" toggle by an option menu to choose the grid type
	from. (idea from drc on #picman).

2002-12-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/CML_explorer.c
	* plug-ins/common/spheredesigner.c: use g_ascii_dtostr() to
	serialize floats.

2002-12-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/ps.c (save_ps_setup): applied a patch from
	Henrik Brix Andersen <brix@picman.org> which fixes bug #101263.

2002-12-16  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: use scientific terms and added an
	approximation formula for tritanopia.

2002-12-16  Michael Natterer  <mitch@picman.org>

	* modules/Makefile.am
	* modules/cdisplay_colorblind.c: added a display filter which will
	simulate the vision of people with color-deficiency to address
	bug #101256. Didn't know any scientific name or any correct formula,
	so I just added the framework plus the approximation formula from
	the bug report. Will need some more work to become useable.

2002-12-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/noisify.c (noisify_func): sorry, you can only
	declare a variable at the beginning of a block.

2002-12-16  Sven Neumann  <sven@picman.org>

	* docs/Wilber_Construction_Kit.xcf.gz: more Wilber gadgets added by
	Guillermo S. Romero.

2002-12-15  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/displace.c
	* plug-ins/common/ripple.c
	* plug-ins/common/shift.c
	* plug-ins/common/spread.c
	* plug-ins/common/tileit.c
	* plug-ins/common/noisify.c: code clean-up, fixed memory leak,
	better use of libpicman routines.

2002-12-15  Sven Neumann  <sven@picman.org>

	* app/gui/user-install-dialog.c: set text and base colors as well
	to make the user installation dialog work on dark themes. Fixes
	bug #86187.

2002-12-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sel_gauss.c: applied a patch from Toby Smith
	that fixes bug #90968.

2002-12-14  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_proc_def_add): fixed a comment.

2002-12-14  Manish Singh  <yosh@picman.org>

	* app/config/picmanconfig-params.c (picman_param_memsize_get_type):
	size should be from GParamSpecULong, not GParamSpecUInt.

2002-12-14  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]
	(picman_display_shell_set_menu_sensitivity): renamed paramater
	"update_popup" to "popup_only" because it's less confusing. Fixed
	the function to update the popup correctly for shell = NULL.

2002-12-14  Michael Natterer  <mitch@picman.org>

	* app/gui/plug-in-commands.c (plug_in_repeat_cmd_callback):
	use gdisp->gimage->picman instead of the_picman.

	* app/tools/picmanimagemaptool.c: pass update_popup == FALSE to
	picman_display_shell_set_menu_sensitivity().

2002-12-14  Sven Neumann  <sven@picman.org>

	* app/gui/plug-in-commands.c (plug_in_repeat_cmd_callback): data
	is not a Picman pointer if this function is called from an image
	menubar. Use the_picman instead of crashing.

2002-12-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c: made it compile after Mitch's
	changes.

2002-12-14  Michael Natterer  <mitch@picman.org>

	Changed menubar showing/hiding to work like rulers and statusbar:

	* app/config/picmanconfig-blurbs.h
	* app/config/picmandisplayconfig.[ch]: renamed "menu_bar_per_display"
	to "show_menubar". Removed PICMAN_PARAM_RESTART flag.

	* app/display/picmandisplayshell.[ch]: changed shell->item_factory to
	shell->menubar_factory plus shell->popup_factory and always create
	both of them. Added "gboolean update_popup" to
	picman_display_shell_set_menu_sensitivity() and call it recursively
	with update_popup == TRUE if the display it is called for is the
	active one.

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c: changed accordinly.

	* app/gui/gui.c: ditto. Set the menu sensitivity of new displays.

	* app/gui/menus.c: added "<Image>/View/Toggle Menubar" menu item.
	Moved some factory initialization code from picmandisplayshell.c
	here.

	* app/gui/view-commands.[ch]: added
	view_toggle_menubar_cmd_callback(). Update the menu sensitivity
	manually in all callbacks which don't call picman_image_flush().

	* app/gui/preferences-dialog.c (prefs_dialog_new): moved the "Show
	Menubar" toggle to the "Appearance" frame of the "Image Windows"
	page. Added an own frame for the display zoom/scaling settings.

	(preferences_dialog_create): Attach config_copy and config_orig
	using g_object_set_data_full() instead of just g_object_set_data()
	plus a g_object_weak_ref().

	(prefs_default_resolution_callback): set the resolution for both
	fields of the "size_sizeentry" instead of setting it for "x"
	twice.

2002-12-14  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preferences.c: make sure that undo level
	is at least 1. Fixes #97771

	* plug-ins/imagemap/imap_file.c: fixes #92750

2002-12-13  Maurits Rijk  <lpeek.mrijk@consunet.nl>
	
	* plug-ins/imagemap/imap_settings.c
	* plug-ins/imagemap/imap_source.[ch]: remove usage of deprecated
	GtkText widget

	* plug-ins/imagemap/arrow_up.xpm
	* plug-ins/imagemap/arrow_down.xpm: removed.

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_misc.[ch]: clean-up some code since we now
	only use stock icons.

	* plug-ins/imagemap/imap_selection.c: use GTK stock icons for arrow up
	and arrow down.

	* plug-ins/imagemap/imap_default_dialog.c: code clean-up

2002-12-13 Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/selection.pdb: merged fix for bug #96284 from
	stable branch.

	* app/pdb/drawable_cmds.c
	* app/pdb/selection_cmds.c
	* libpicman/picmandrawable_pdb.c
	* libpicman/picmanselection_pdb.c: regenerated.

2002-12-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: merged fix for #97352 from stable branch.

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	merged fix for #79486 from stable branch.

2002-12-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmanintl.h
	* libpicman/libpicman-intl.h
	* plug-ins/script-fu/script-fu-scripts.c: removed remaining usage
	of ENABLE_NLS.

2002-12-13  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: added new PDB function
	picman_image_is_dirty() on request of Wolfgang Hofer (#77508).

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanimage_pdb.h: regenerated.

2002-12-12  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/picmanressionist/color.c
	* plug-ins/picmanressionist/general.c
	* plug-ins/picmanressionist/picmanressionist.[ch]
	* plug-ins/picmanressionist/placement.c
	* plug-ins/picmanressionist/presets.c: last bunch of changes to solve
	#81963.

2002-12-12  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c (prefs_color_button_add): create the
	color button for the canvas padding color using PICMAN_COLOR_AREA_FLAT.

2002-12-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/ripply-anim.scm: applied a patch from
	Chris Purnell <cjp@lost.org.uk> that adds the possibility to
	specify the edge behaviour (#83767).

2002-12-10  Michael Natterer  <mitch@picman.org>

	The unbelievable happened: a menu bar per display (optionally)

	* app/widgets/picmanitemfactory.[ch]: Added the possibility to have
	more than one item factory per <Prefix>. Added
	picman_item_factories_set_foobar() variants of all functions which
	set menu item properties (label, sensitive, ...). Removed
	the #ifndef ENABLE_NLS code since that's no longer possible.

	* app/widgets/picmantoolbox.c: made it robust againt the <Image>
	factory not existing at the time of toolbox creation.

	* app/config/picmanconfig-blurbs.h
	* app/config/picmandisplayconfig.[ch]: added boolean
	"menu_bar_per_display" property.

	* app/gui/preferences-dialog.c: added a toggle for the new option.

	* app/gui/menus.[ch]: added menus_get_new_image_factory() as
	temporary solution. Will add a PicmanMenuFactory which creates the
	item factories soon.

	* app/display/picmandisplayshell.c: add the menu bar if requested.
	Changed widget packing slightly for the menu bar case.

	* app/display/picmandisplayshell-callbacks.c: changed accordingly.
	Currently there is no right-click popup menu when we have a menu
	bar. This will change soon.

	* app/gui/file-dialog-utils.c
	* app/gui/gui.c: use picman_item_factories_set_foo().

	* app/gui/channels-commands.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/drawable-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/plug-in-commands.c
	* app/gui/select-commands.c
	* app/gui/tools-commands.c
	* app/gui/vectors-commands.c
	* app/gui/view-commands.c: per-display item factories pass the
	PicmanDisplay as user_data to callbacks, not a Picman. Changed all
	return_if_no_foo() macros to handle both cases.

	Cleaned up the plug-in menu stuff:

	* app/plug-in/plug-in-types.h: removed PlugInMenuEntry type.

	* app/plug-in/plug-ins.[ch]: added plug_ins_proc_def_add() as
	counterpart to plug_ins_proc_def_remove(). Added
	plug_ins_locale_domain() as counterpart to plug_ins_help_path().
	Remember the locale domains just as the help paths. Changed
	plug-in initialization so that their menus can be created multiple
	times.

	* app/plug-in/plug-in.[ch]: use plug_ins_proc_def_add() instead of
	doing it manually.

	* app/gui/plug-in-menus.[ch]: added plug_in_menus_init() which
	just registers the locale domains. Changed plug_in_make_menu() to
	take a list of proc_defs, not plug_ins_defs so it can be used
	after plug-in query.

2002-12-10  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: fixed typo, use "picman->no_interface" instead of
	simply "no_interface" in the "exit" handler.

2002-12-10  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/picmanressionist/paper.c
	* plug-ins/picmanressionist/presets.c
	* plug-ins/picmanressionist/sizemap.c
	* plug-ins/picmanressionist/orientmap.c: more changes to make 
	picmanressionist look like a standard PICMAN plug-in (#81963) plus lots
	of code clean-up.

2002-12-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call): fixed
	color_list iteration for PICMAN_PDB_COLOR args. Closes bug #100696.

2002-12-06  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/winclipboard.c : need to adjust the data 
	pointer for BI_BITFIELDS bitmaps, fixes #99246

2002-12-06  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c: no need to include app_procs.h here.

	* app/display/picmandisplay-foreach.c (picman_displays_dirty)
	(gdisplays_check_valid): don't use the global the_picman. Removed
	inclusion of app_procs.h.

2002-12-05  Michael Natterer  <mitch@picman.org>

	Cleaned up the exit process:

	* app/core/picman.[ch]: added an "exit" signal which carries a
	"gboolean kill_it" parameter and has a boolean return value.
	Added picman_boolean_handled_accumulator() so the emission of "exit"
	can be stopped by returning TRUE from a callback.  Removed
	picman_shutdown() from the public API and made it "exit"'s default
	implementation. Added picman_exit() to emit the signal.

	* app/core/picmanmarshal.list: added BOOLEAN__BOOLEAN marshaller.

	* app/gui/gui.[ch]: Replaced public functions gui_shutdown() and
	gui_exit() by "exit" callbacks. g_signal_connect_after() the
	latter so the shutdown order is correct.

	* app/app_procs.[ch]: removed app_exit() and connect to "exit".
	Split the exit stuff into normal and connect_after callbacks as
	above.

	* app/batch.c
	* app/gui/file-commands.c
	* tools/pdbgen/pdb/misc.pdb
	* app/widgets/picmantoolbox.c: call picman_exit() instead of
	app_exit(). Don't #include "app_procs.h".

	* app/pdb/misc_cmds.c: regenerated.

2002-12-05  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushpipe.c: use the same string as in
	picmanbrushpipe.c to reduce the number of translatable strings.

2002-12-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c (render_image_tile_fault):
	removed useless assignments.

	* plug-ins/common/aa.c: removed wrong assertions that caused the
	plug-in to crash on images with odd width or height (#100344).
	Added support for RGB images as well as alpha channel while I was
	on it.

2002-12-04  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: added -DPICMAN_APP_GLUE_COMPILATION to
	AM_CPPFLAGS.

	* app/appenv.h
	* app/batch.h
	* app/errors.h: #error if it is not defined to keep these files
	from being included from anywhere else.

	* app/app_procs.h: added just a #warning because some places still
	need "the_picman" and app_exit().

	* app/libpicman_glue.h: #ifdef the #error the same way as the other
	headers do.

2002-12-03  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay-foreach.[ch]: renamed
	gdisplays_reconnect() to picman_displays_reconnect() and added a
	"Picman" parameter.

	* app/gui/file-commands.c
	* tools/pdbgen/pdb/display.pdb: changed accordingly.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: some irrelevant
	code cleanups to make them look the same.

	* tools/pdbgen/pdb/message.pdb: changed $desc from "Interface"
	to "Message procedures".

	* tools/pdbgen/pdb/transform_tools.pdb: changed $desc from
	"Tool procedures" to "Transform Tool procedures".

	* app/pdb/brush_select_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/pattern_select_cmds.c: regenerated.

2002-12-03  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorbutton.c: named the menu separator
	"/fg-bg-separator", not just "/---".

	* app/widgets/picmancolorpanel.[ch]: added a PicmanContext pointer to
	get FG/BG from. Don't use "the_picman" and don't include
	"app_procs.h".  Added picman_color_panel_set_context(). Hide the
	FG/BG menu entries if we have no context.

	* app/gui/channels-commands.c
	* app/gui/preferences-dialog.c
	* app/gui/qmask-commands.c
	* app/display/picmandisplayshell.c: set the color_panel's context.

2002-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: made it a lot less deprecated.

2002-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: removed broken code that used
	to update the preview when the user releases the button after
	moving a slider. Instead set the range to UPDATE_DELAYED and
	update the preview on "value_changed". Fixes bug #97350.

2002-12-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/layer.pdb: applied a modified version of a
	patch from Wolfgang Hofer <hof@picman.org> that adds two new PDB
	functions needed for GAP: picman_displays_reconnect() and
	picman_layer_new_from_drawable() (bug #77508).

	* app/pdb/display_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmandisplay_pdb.[ch]
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

2002-12-03  Sven Neumann  <sven@picman.org>

	* app/tools/tool_manager.c (tool_manager_control_active): check
	for gdisp != NULL to avoid to crash when being called from
	indexed_ok_callback().

2002-12-03  Sven Neumann  <sven@picman.org>

	* configure.in: do as the gtk+ folks did and replace the gtk-doc
	version check with an all-sh version (#99216).

2002-12-02  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c (picman_data_save): don't check filename for
	internal PicmanData objects because they are never saved.

	* app/config/picmanrc.c: made verbose an object property so that its
	value is copied by picman_config_duplicate().

2002-12-02  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-blurbs.h
	* app/config/picmanconfig-dump.c: minor changes.

2002-12-02  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.c: fixed serialization of empty
	string properties that I broke yesterday.

2002-12-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmandata.[ch]: use GError for reporting load/save
	errors. Added picman_data_error_quark() and a PicmanDataError enum.
	Made simple virtual functions out of save(), get_extension()
	and duplicate() because they don't need to be signals.

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.[ch]
	* app/core/picmanbrushpipe.[ch]
	* app/core/picmangradient.[ch]
	* app/core/picmanpalette.[ch]
	* app/core/picmanpattern.[ch]: changed accordingly. Set data->dirty
	to FALSE in each _load() function.

	* app/core/picmandatafactory.[ch]: report GError messages here.
	Changed the ugly factory->path pointer location hack to
	factory->path_property_name and get the path from
	factory->picman->config. Added picman_data_factory_data_duplicate()
	implementation which was already declared in the header.

	* app/core/picman.c: pass the path property name to
	picman_data_factory_new().

	* app/widgets/picmandatafactoryview.c: removed the duplicate
	implementation and call picman_data_factory_data_duplicate().

	* app/core/picmangradient.[ch]: added picman_gradient_save_as_pov().

	* app/gui/gradients-commands.c: removed save_as_pov implementation
	and call picman_gradient_save_as_pov().

2002-12-01  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-blurbs.h: small cleanup.

	* app/config/picmanconfig-serialize.[ch]: export more functionality.

	* app/config/picmanconfig-dump.c: added some code to dump a
	commented version of the system-wide picmanrc with default values.

2002-12-01  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h: prefix PIXELS and POINTS with PICMAN
	instead of SIZE so we don't break the libpicman API without a good
	reason.

	* app/pdb/text_tool_cmds.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicman/picmanmisc.[ch]: removed picman_timer functions since the
	GTimer API is simple enough and doesn't need to be wrapped.

	* plug-ins/common/newsprint.c
	* plug-ins/common/unsharp.c: use GTimer.

2002-12-01  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandatafiles.c: s/S_ISLINK/S_ISNLK/ (was never
	compiled before Hans fixed the #ifdef).

2002-11-30  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/flarefx.c: 
	* plug-ins/common/jigsaw.c: 
	* plug-ins/common/nova.c
	* plug-ins/common/wind.c
	* plug-ins/common/illusion.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/max_rgb.c: replace preview code by calls to libpicman

	* libpicman/Makefile.am: added picmanmiscui.[ch]
	* libpicman/picmanmiscui.[ch]: new files. For now contain effect preview
	stuff collected from several plug-ins. Warning: this is NOT the new
	effect preview widget I'm writing, just a first step to cleaning up a
	lot of plug-ins.

2002-11-30  Hans Breuer  <hans@breuer.org>

	* */makefile.msc */*/makefile.msc : updated

	* themes/Default/images/makefile.msc : new file
	* themes/Default/makefile.msc : removed

	* libpicmanwidgets/picmanwidgets.def : updated

	* app/core/core-types.h : renamed PIXELS and POINTS
	to SIZE_* to avoid clashes with system headers
	* app/pdb/text_tool_cmds.c : updated ...
	* tools/pdbgen/enums.pl : ... by renaming here too.

	* app/widgets/picmanhistogrambox.c : <string.h> for memcpy()
	* app/widgets/picmanpropwidgets.c : <string.h> for strlen()

	* app/config/picmanconfig.c : on win32 rename always fails
	if the destination file exists. Delete it first.

	* libpicman/picman.def : removed all '_'-prefixed exports
	* plug-ins/common/iwarp.c : replace _picman_layer_copy()
	with picman_layer_copy(), picman_layer_add_alpha()

	* libpicman/picmanmisc.c : ported picman_timer funcs to use
	g_timer to be more portable

	* libpicmanbase/picmandatafiles.c : there are no symlinks on 
	win32, inverted to #ifndef G_OS_WIN32 as it was meant.

	* libpicmanbase/picmanbase.def libpicmanmodule/picmanmodule.def 
	  libpicmanwidgets/picmanwidgets.def : updated externals

	* plug-ins/common/randomize.c plug-ins/common/sinus.c :
	don't initialize more than the defined struct size

	* plug-ins/common/warp.c : removed unneeded unistd.h and
	signal.h include

	* regexrepl/regexrepl.def : (new file) needed to build 
	as DLL

2002-12-01  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added "gboolean use_shm" to the Picman struct
	and to picman_new().

	* app/app_procs.c: pass "use_shm" to picman_new().

	* app/plug-in/plug-in.c (plug_in_init): get "use_shm" from the
	passed "picman".  Don't include "appenv.h" and "app_procs.h".

2002-11-30  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: no need to include "appenv.h"

	* app/tools/picmaninktool.c: pass InkOptions as user_data to the
	ink_type_update() callback so we don't need to get them from
	"the_picman". Removed inclusion of "app_procs.h".

2002-11-30  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: added "gboolean use_mmx"
	parameter to paint_funcs_setup(). Don't #include "appenv.h".

	* app/base/base.c: pass "use_mmx" to paint_funcs_setup().

2002-11-30  Michael Natterer  <mitch@picman.org>

	* app/base/base-types.h: removed the global "base_config" variable.

	* app/base/base.[ch]: added "gboolean use_mmx" to base_init().
	Don't #include "appenv.h". Pass around more parameters to reduce
	the usage of the global "paint_options" pointer.

	* app/app_procs.c: pass "use_mmx" to base_init().

	* app/base/temp-buf.c: pass "temp_path" around internally. Declare
	"base_config" extern and added a #warning.

	* app/core/picmandata.[ch]
	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.[ch]
	* app/core/picmanbrushpipe.[ch]
	* app/core/picmangradient.[ch]
	* app/core/picmanpalette.[ch]
	* app/core/picmanpattern.[ch]: added "gboolean stingy_memory_use"
	parameters to all _new(), _load() and _duplicate() functions.

	* app/core/picmanmarshal.list: PicmanData::duplicate needs an
	OBJECT__BOOLEAN marshaller now.

	* app/core/picmandatafactory.[ch]: added a "Picman" pointer so the
	factory can find the config. Pass base_config->stingy_memory_use
	to the PicmanData functions changed above.

	* app/core/picman-gradients.c
	* app/core/picman.c
	* app/core/picmanpalette-import.c
	* app/gui/palettes-commands.c
	* app/widgets/picmandatafactoryview.c: changed accordingly.

	* app/core/picmancontext.c: get "stingy_memory_use" from
	context->picman->config.

2002-11-30  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added picman->edit_config which is a copy of
	picman->config except for PICMAN_PARAM_RESTRT options. Create it in
	picman_set_config() which must be called before anything else after
	picman_new(). Install "notify" handlers between the both to keep
	them up-to-date. Enable auto saving for the edit_config.

	* app/app_procs.c: call picman_set_config().

	* tools/pdbgen/pdb/picmanrc.pdb: use picman->edit_config here so we
	don't accidentially change PICMAN_PARAM_RESTART values from the PDB.

	* app/pdb/picmanrc_cmds.c: regenerated.

	* app/gui/preferences-dialog.c: use picman->edit_config as the base
	for all prefs operations. Disable auto saving while the prefs
	dialog is open. No need any more to parse the saved picmanrc to get
	PICMAN_PARAM_RESTART values. Removed PICMAN_PARAM_RESTART special
	hacks because edit_config handles them transparently for us.

	Unrelated:

	* app/core/picmanimage.c (picman_image_init): initialize active_vectors.

	* app/gui/gui.c (gui_image_disconect): when the last image
	disappears, show the toolbox only if the image had a display.

2002-11-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c: more useful debugging output.

2002-11-29  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_pixmap_button_new):
	use gtk_label_new_with_mnemonic().

	* plug-ins/common/uniteditor.c: Treeviewized and undeprecated.
	Removed all static variables. Cleanup.

2002-11-28  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-params-blurbs.h: removed ...
	* app/config/picmanconfig-blurbs.h: ... and readded under this name.
	Defined all missing blurb definitions to NULL.

	* app/config/picmanconfig-params.h: added a blurb parameter to all
	PICMAN_CONFIG_INSTALL_PROP_* macros.
	
	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c: register blurbs with the PicmanRc
	properties.

	* app/config/picmanconfig-serialize.c: do proper line-breaking for
	comments.

	* app/core/picmancontext.c
	* app/widgets/picmandeviceinfo.c: register NULL blurbs here.

2002-11-28  Michael Natterer  <mitch@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-params-blurbs.h: new file defining
	blurbs for config param specs. Not used yet.

2002-11-28  Sven Neumann  <sven@picman.org>
	
	* app/config/Makefile.am
	* app/config/picmanconfig-dump.c: added the basic infrastructure for
	a utitily that dumps the PicmanRc object.

	* app/config/picmanconfig-serialize.c: dump object blurbs as comments.

2002-11-27  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanairbrush.[ch]
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.[ch]
	* app/paint/picmanpaintoptions.[ch]
	* app/paint/picmansmudge.[ch]: it's hard to paint without a context
	to get color, brush etc. from. Added "context" parameters to
	all paint options constructors.

	* tools/pdbgen/pdb/paint_tools.pdb: pass picman_get_current_context()
	to the constructors. Fixes bug #99557.

	* app/pdb/paint_tools_cmds.c: regenerated.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmaninktool.c
	* app/tools/picmansmudgetool.c: changed accordingly.

	* app/tools/paint_options.c: ditto. Don't set
	paint_options->context here because we also need it in the
	no-interface case above.

2002-11-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/autostretch_hsv.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/threshold_alpha.c: use picmanmisc region iterator 
	funcs.

2002-11-27  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.[ch]: added (yet unused) autosave feature.

	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c: simplified user-visible messages.

2002-11-27  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c (preferences_dialog_create):
	added a missing cast to please the compiler.

2002-11-26  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/colorify.c: use picmanmisc region iterator funcs.

2002-11-26  Michael Natterer  <mitch@picman.org>

	* app/config/picmanrc.[ch]: added "gboolean verbose" to PicmanRc and
	its constructor. Print messages only if verbose == TRUE.

	* app/gui/user-install-dialog.[ch]: changed accordingly.

	* app/app_procs.c: ditto. No need any more to parse unitrc before
	calling user_install_dialog_create().

	* app/gui/preferences-dialog.c: ditto. Added the static
	prefs_dialog pointer again so our local help func finds the
	current notebook page.

2002-11-26  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/image-title.png:
	unique icon. Nothing too fancy though.
	* themes/Default/images/preferences/input-devices.png:
	fix the border a little

2002-11-25  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/newsprint.c: timer funcs are now in picmanmisc.

	* plug-ins/common/unsharp.c: timer funcs are now in picmanmisc. Removed
	unused/non-working preview stuff. Will be restored once I finished
	a general preview widget for plug-ins.

	* plug-ins/common/colortoalpha.c
	* plug-ins/common/vinvert.c: use picmanmisc region iterator funcs.

2002-11-25  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/picmanmisc.[ch]: added 2 new functions (picman_timer_start and
	picman_timer_stop) for timing purposes. Also added 2 general region
	iterator functions, used in numerous plug-ins.

2002-11-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_file_dest_add): changed order of
	calls to picman_dnd_data_dest_add() so that "text/uri-list" is
	preferred over "text/plain" and "_NETSCAPE_URL". Fixes dropping
	multiple files from nautilus.

2002-11-25  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-utils.[ch]: added picman_config_diff()
	which returns the difference beween two PicmanConfig objects
	as a GList of GParamSpecs.

	* app/config/picmanconfig-params.c (picman_param_color_cmp): compare
	the colors as integers to get rid of rounding foobar.

	* app/config/picmanconfig-serialize.c: use picman_config_diff().

	* app/display/picmandisplayshell-handlers.c: only need to call
	picman_display_shell_scale_setup() on resolution change if the
	display is not in dot-for-dot mode.

	* app/display/picmandisplayshell.c: changed a separator in the
	padding color menu.

	* app/gui/dialogs.c: made the prefs dialog a singleton again.

	* app/gui/preferences-dialog.c: Should be fully functional again:
	Apply PICMAN_PARAM_CONFIRM properties on "OK". Save picmanrc on "OK".
	Parse a temporaty PicmanRc on dialog creation to get the current
	PICMAN_PARAM_RESTART values. Use picman_config_diff() for all config
	comparisons.

2002-11-25  Manish Singh  <yosh@picman.org>

	* libpicmanbase/picmanwire.c: using a union like that may not be
	completely portable. Use a guint8 array instead. One wonders
	if we really need to support the off-chance someone will make
	a distributed picman framework with this current incarnation
	of the wire protocol.

2002-11-25  Manish Singh  <yosh@picman.org>

	* libpicmanbase/picmanwire.c: use a union instead of separate types to 
	read/write doubles so we don't violate C's aliasing rules. Fixes
	bug #85249.

2002-11-24  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/image.pdb: moved FINITE definition to $extra
	code. Changed to use #elif, much cleaner.

	* app/pdb/image_cmds.c: regenerated

	* app/core/picmanenvirontable.[ch]: added support for app internal
	environment variable settings. These override any *.env files if
	there are collisions. Not sure on that policy. Also, envp is now
	generated on the first get_envp call.

	* app/gui/gui.[ch]: added gui_environ_init, which uses
	picman_environ_table_add. Moved the setting of DISPLAY to here.
	Added setting of GDK_DISPLAY instead for the fb backends. Hm,
	perhaps GDK should do this itself...

	* app_procs.c: call gui_environ_init.

	* libpicmanwidgets/picmancolorscale.c
	* libpicmanwidgets/picmancolorscales.c: #include <string.h> for
	strlen and memcpy.

2002-11-24  Dave Neary  <bolsh@picman.org>

	* libpicmanwidgets/picmanwidgets.c
	* libpicmanwidgets/picmanwidgets.h
	* plug-ins/common/blur.c
	* plug-ins/common/plasma.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/snoise.c
	* plug-ins/gflare/gflare.c
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/maze.c
	* plug-ins/maze/maze.h
	* plug-ins/maze/maze_face.c: Changed the picman random seed
	widget's behaviour and made associated changes in
	plug-ins that use it.

2002-11-24  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_color_button_press): fixed menu path.

2002-11-24  Sven Neumann  <sven@picman.org>

	* libpicman/gserialize.[ch]: removed from CVS, may always be pulled
	out of the Attic if needed again.

2002-11-24  Michael Natterer  <mitch@picman.org>

	* app/config/picmandisplayconfig.c: removed PICMAN_PARAM_RESTART from
	"marching-ants-speed".

	* app/display/picmandisplayshell-selection.[ch]: removed the "speed"
	parameter from the constructor and get the speed from
	PicmanDisplayConfig when starting the ants.

	* app/display/picmandisplayshell-callbacks.c: changed accordingly.

	* app/display/picmandisplayshell-handlers.c: connect to
	notify::marching-ants-speed and restart the ants in the handler.

	* app/gui/preferences-dialog.c: Added an own frame for the
	canvas padding color. Even more cleanup.

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/image-title.png: new image
	for the new page, copied image-windows.png

2002-11-23  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-utils.[ch]: removed
	picman_config_values_equal().

	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig.c: use g_param_values_cmp() instead so
	our registered compare methods are used.

	* app/config/picmandisplayconfig.[ch]: added "canvas_padding_mode"
	and "canvas_padding_color" properties.

	* app/display/display-enums.[ch]: added enum PicmanDisplayPaddingMode
	which can be one of { theme, light check, dark check, custom }.

	* app/display/picmandisplay.h
	* app/display/picmandisplay-handlers.c: removed cached monitor
	resolution values...

	* app/display/picmandisplayshell.[ch]: ...and added them here. Added
	padding state as in PicmanDisplayConfig. Added utility function
	picman_display_shell_set_padding() which hides all the details.
	Added the new padding modes to the padding color button's context
	menu.

	* app/display/picmandisplayshell-callbacks.[ch]: don't fiddle
	with colors manually but use picman_display_shell_set_padding()
	in realize() and in the color button callbacks.

	* app/display/picmandisplayshell-handlers.c: connect to
	notify::monitor-[xy]resolution and
	notify::canvas-padding-[mode|color] and update accordingly.

	* app/widgets/picmanpropwidgets.[ch]: added
	picman_prop_color_button_new().

	* app/widgets/picmandialogfactory.[ch]: added
	picman_dialog_factories_session_clear() (unimplemented).

	* app/gui/preferences-dialog.c: added widgets for padding mode and
	color. Removed some callbacks by connecting the functions they
	called directly. Cleanup.

2002-11-23  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/folders-environ.png:
	replace the generic folder

2002-11-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: keep a pointer to the
	nav_ebox in the PicmanDisplayShell struct.

	* app/display/picmandisplayshell-handlers.c: connect to
	notify::navigation-preview-size and set the button insensitive for
	PICMAN_PREVIEW_SIZE_NONE. Also destroy an existing nav_popup so it
	will be automatically re-created on the next click.  Connect to
	notify::image-title-format and notify::image-status-format and
	update them accordingly.

	* app/display/picmannavigationview.c: don't try any voodoo in
	picman_navigation_view_init(). Removed the notify handler.
	Set the popup's size in picman_navigation_view_new_private().

	* app/gui/preferences-dialog.c: removed the #if 0'ed combo boxes
	and added an own sub-page for the image title and status format.
	Select the possible values using a GtkTreeView.  Some more
	cleanup.

2002-11-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpropwidgets.c: added picman_prop_entry_new(),
	factored lots of stuff out to local utility functions, added some
	comments to the header, cleanup.

2002-11-22  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: allow to configure whether tips
	are shown on startup.

	* app/gui/tips-dialog.c: threw out lots of code and use
	picman_prop_check_button_new() instead.

2002-11-21  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/blinds.c: use picman_get_bg_guchar

	* libpicman/picmanmisc.[ch]: added picman_pixel_fetcher routine with 
	wrapmode and generic get background color routine (picman_get_bg_guchar)

	* plug-ins/common/edge.c: : use picman_pixel_fetcher routines

2002-11-21  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c: use picman_pixel_fetcher routines

2002-11-21  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanguiconfig.[ch]: moved navigation_preview_size to
	PicmanDisplayConfig.

	* app/gui/preferences-dialog.c: offer the full choice of
	PicmanPreviewSizes for the navigation preview size.

	* app/display/picmannavigationview.c: multiply the preview size by 3
	to get reasonable values. Added some broken code that connects to
	notify::navigation-preview-size.

	* etc/picmanrc.in: updated accordingly.

2002-11-21  Michael Natterer  <mitch@picman.org>

	* app/base/tile-cache.[ch]: added tile_cache_init() and
	tile_cache_exit() as public functions.

	* app/base/base.c: call them. Connect to PicmanBaseConfig's
	notify::tile-cache-size.

	* app/core/picmanimage.c: connect to notify::transparency-type and
	notify::transparency-size and call
	picman_image_invalidate_layer_previews() in the callback.

	* app/display/picmandisplay-foreach.[ch]: removed
	gdisplays_expose_full().

	* app/display/picmandisplayshell-handlers.c: connect to
	notify::transparency-type and notify::transparency-size and expose
	the shell in the callback.

	* app/display/picmandisplayshell-render.[ch]: added render_init()
	and render_exit() functions and connect to
	notify::transparency-type and notify::transparency-size for
	setting up the render buffers.

	* app/gui/gui.c: call the new functions instead of render_setup().
	Connect to notify::show-tool-tips.

	* app/gui/preferences-dialog.c: copy values between the global
	config object and it's local copy only when they have changed.
	Wrap setting of lots of values in g_object_[freeze|thaw]_notify().
	Added lots of mnemonics.

	* app/gui/resolution-calibrate-dialog.c: added mnemonics.

	* app/widgets/picmanpropwidgets.c: g_object_set() the values edited
	by the picman_prop_coordinates() much less often by remembering the
	old values and setting them only when they have changed.

2002-11-21  Sven Neumann  <neo@wintermute>

	* app/gui/preferences-dialog.c (prefs_dialog_new): don't set the
	default resolution unit from the monitor resolution entry.

	* app/gui/user-install-dialog.c: use the new PicmanPropWidgets. The
	monitor resolution setup may need some more tweaking ...

2002-11-20  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/whirlpinch.c
	* plug-ins/common/polar.c
	* plug-ins/common/mblur.c: use pixel_fetcher routines that are now in
	libpicman.

2002-11-20  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicman/Makefile.am: added picmanmisc.[ch]

	* libpicman/picman.h: include picmanmisc.h

	* libpicman/picmanmisc.[ch]: new files, containing all kinds of 
	miscellaneous routines factored out from different plug-ins. They stay
	here until their API has crystalized a bit and we can put them into 
	the file where they belong.

2002-11-20  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/whirlpinch.c
	* plug-ins/common/waves.c
	* plug-ins/common/polar.c
	* plug-ins/common/warp.c
	* plug-ins/common/displace.c: replaced all implementations of bilinear 
	func by call to picman_bilinear_8/16

2002-11-20  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c: made object properties from the picmanrc
	filenames. Use NULL to set to the default values.

	* app/app_procs.c
	* app/gui/user-install-dialog.[ch]: don't pass a picman pointer to
	the user installation dialog. All it needs to know are the
	alternative picmanrc names if such are given on the command-line.

2002-11-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanpropwidgets.[ch]: new files containing
	constructors for views on GObject properties.

	* app/gui/Makefile.am: build the preferences dialog again.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c
	* app/gui/menus.c: added it back to the dialog system (as a non
	singleton to give the new model <-> view stuff some testing).

	* app/gui/preferences-dialog.c: here it is again, using property
	view widgets. Lots of stuff removed & simplified. Some things
	still #if 0'ed and/or non-working. No saving yet ...

2002-11-20  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.[ch]: store the picmanrc filenames in the
	PicmanRc object; will become properties later.

	* app/app_procs.c: use the new PicmanRc API and added the
	functionality back that allows to specify different picmanrc
	files on the command-line.

	* app/gui/user-install-dialog.c: don't work on the real picmanrc
	object but create one for the install procedure and save it.

2002-11-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanenummenu.[ch]: added *_new_with_values() and
	*_new_with_values_valist() variants to make enum menu creation
	even more customizable.

2002-11-20  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-params.h: added PICMAN_PARAM_RESTART and
	PICMAN_PARAM_CONFIRM flags and changed all param spec macros
	to have a "flags" parameter.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c: tag the values which need restart or
	confirmation with the resp. flags. Changed all macro calls
	accordingly.

	* app/core/picmancontext.c
	* app/widgets/picmandeviceinfo.c: changed macro calls accordingly.

2002-11-20  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.h:
	s/picman_config_equal/picman_config_is_equal_to/ to match the
	implementation.

2002-11-20  Sven Neumann  <sven@picman.org>

	* app/gui/user-install-dialog.c: don't access the global base_config
	which is not initialized at this point.

2002-11-20  Dave Neary  <bolsh@picman.org>

	* plug-ins/maze/maze.[ch]
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/maze_face.c: Changed occurreces of
	timeseed to defaultseed to more accurately reflect what
	happens with the g_rand* functions. Sorry for missing one
	earlier & temporarily breaking the build :~}

2002-11-20  Sven Neumann  <sven@picman.org>

	* plug-ins/maze/maze.[ch]
	* plug-ins/algorithms.c: make it compile. I'm not sure if this is the
	correct fix though...

2002-11-20  Dave Neary  <bolsh@picman.org>

	* configure.in
	* app/core/picmanbrushpipe.c
	* app/gui/about-dialog.c
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c
	* libpicmanmath/picmanmath.h
	* libpicmanwidgets/picmanwidgets.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/blur.c
	* plug-ins/common/cubism.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/lic.c
	* plug-ins/common/noisify.c
	* plug-ins/common/nova.c
	* plug-ins/common/papertile.c
	* plug-ins/common/plasma.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/spread.c
	* plug-ins/common/warp.c
	* plug-ins/common/wind.c
	* plug-ins/flame/cmap.c
	* plug-ins/flame/flame.c
	* plug-ins/flame/libifs.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/picmanressionist.[ch]
	* plug-ins/picmanressionist/plasma.c
	* plug-ins/picmanressionist/repaint.c
	* plug-ins/ifscompose/ifscompose_utils.c
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/maze.[ch]
	* plug-ins/mosaic/mosaic.c: Change all occurrences of RAND_MAX,
	G_MAXRAND, rand(), srand(), lrand48(), srand48(), random(),
	srandom(), RAND_FUNC and SRAND_FUNC to the appropriate g_rand*
	equivalent. Programs which require seed setting for reproducible
	results, and anything in the core, gets a dedicated GRand * for
	the lifetime required. Programs which only ever used random
	numbers for tossing a coin, rolling a dice, etc use g_random
	functions. For the rest, judgement was used. Where it was easy, a
	GRand * object was used and g_rand_* functions were
	preferred. This fixes bug #67386 in HEAD.

2002-11-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicmancolor/picmanbilinear.c (picman_bilinear): fixed bug that could
	happen with negative values of parameter x or y. Same bug in
	picman_bilinear_8, picman_bilinear_16 and picman_bilinear_32.

2002-11-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/color.c
	* plug-ins/picmanressionist/general.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/picmanressionist/picmanressionist.[ch]
	* plug-ins/picmanressionist/orientation.c
	* plug-ins/picmanressionist/orientmap.c
	* plug-ins/picmanressionist/paper.c
	* plug-ins/picmanressionist/placement.c
	* plug-ins/picmanressionist/plasma.c
	* plug-ins/picmanressionist/ppmtool.[ch]
	* plug-ins/picmanressionist/presets.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/picmanressionist/repaint.c
	* plug-ins/picmanressionist/size.c
	* plug-ins/picmanressionist/sizemap.c: lots and lots of changes. 
	picmanressionist now looks more or less like other plug-ins, using
	picman_scale widgets for data entry, the picman_color_button for color
	selection, the OK and Cancel button at the bottom, etc. There are still
	a few things left to do, mostly more code clean-up.

2002-11-19  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpatheditor.[ch]: added new function
	picman_path_editor_set_path().

2002-11-19  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.[ch]: derive PicmanParamSpecMemsize
	from GParamSpecULong.

2002-11-19  Manish Singh  <yosh@picman.org>

	* data/environ/Makefile.am: really fix a comment

2002-11-18  Sven Neumann  <sven@picman.org>

	* app/app_procs.c: added a missing include.

2002-11-18  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/general.[ch]: we don't need these any longer.

2002-11-18  Sven Neumann  <sven@picman.org>

	Finally landed the new PicmanConfig based picmanrc parser. It's not
	finished yet but we need to start somewhere. This release removes
	the old picmanrc.[ch] files. The picmanrc format changes slightly, but
	the changes are minimal. The Preferences dialog is temporarily
	disabled since it still needs to be ported. If you are are afraid,
	stay away from CVS for a few days ;-)

	* app/Makefile.am
	* app/picmanrc.[ch]: removed the old picmanrc system.

	* app/base/Makefile.am
	* app/base/base-config.[ch]: removed these files in favor of
	config/picmanbaseconfig.[ch].

	* app/core/Makefile.am
	* app/core/picmancoreconfig.[ch]: removed these files in favor of
	config/picmancoreconfig.[ch].

	* app/config/Makefile.am
	* app/config/config-types.h: moved typedefs into this new file.

	* app/config/picmanbaseconfig.[ch]
	* app/config/picmancoreconfig.[ch]
	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc.[ch]
	* app/config/test-config.c: brought into shape for real use.

	* app/base/base-types.h: include config/config-types.h here. Added
	a global PicmanBaseConfig *base_config variable to ease migration.

	* app/gui/Makefile.am: temporarily disabled the preferences dialog.

	* app/app_procs.c
	* app/undo.c
	* app/undo_history.c
	* app/base/base.[ch]
	* app/base/picmanhistogram.c
	* app/base/pixel-processor.c
	* app/base/temp-buf.c
	* app/base/tile-cache.c
	* app/core/core-types.h
	* app/core/picman-documents.c
	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmancontext.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage.c
	* app/core/picmanimagefile.c
	* app/core/picmanmodules.c
	* app/core/picmanpattern.c
	* app/display/Makefile.am
	* app/display/picmandisplay-handlers.c
	* app/display/picmandisplay.[ch]
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmandisplayshell.[ch]
	* app/display/picmannavigationview.c
	* app/file/file-save.c
	* app/gui/device-status-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/paths-dialog.c
	* app/gui/resize-dialog.c
	* app/gui/session.c
	* app/gui/test-commands.c
	* app/gui/tips-dialog.c
	* app/gui/tips-dialog.h
	* app/gui/user-install-dialog.c
	* app/gui/view-commands.c
	* app/paint/picmanpaintcore.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmantexttool.[ch]
	* app/tools/selection_options.c
	* app/tools/tools.c
	* app/tools/transform_options.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanitemfactory.c
	* app/widgets/picmanselectioneditor.c
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: use the new config system
	instead of the old picmanrc stuff.

	* etc/picmanrc.in
	* etc/picmanrc_user.in: adapted to the new picmanrc format. Will update
	the man-page later...

	* app/pdb/fileops_cmds.c
	* app/pdb/picmanrc_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/transform_tools_cmds.c
	* libpicman/picmanpicmanrc_pdb.c: regenerated.
	
2002-11-18  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_properties): improved error message for
	the special case of store_unknown_tokens == TRUE.

	* app/config/picmanconfig.c (picman_config_add_unknown_token): try to
	substitute paths of the form ${foo} in the unknown token value.

	* app/config/picmanconfig-deserialize.c (picman_config_deserialize_enum):
	allow numbers when deserializing enum values.

	* data/environ/Makefile.am: fixed a comment.

2002-11-18  Sven Neumann  <sven@picman.org>

	* data/images/Makefile.am
	* data/images/picman_splash.gif: removed old animated splash.

	* data/images/picman_splash.png: a new splash screen for 1.3.11
	created by Jakub Steiner <jimmac@ximian.com>.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.[ch]: removed public function
	picman_transform_tool_transform_tiles() and made it the default
	implementation of the transform() virtual function. Added
	"const gchar *progress_text" to PicmanTransformTool so it is
	available for the new default implementation. Cleanup.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: removed transform() implementations
	and set transform_tool->progress_text accordingly. Even more
	cleanup.

2002-11-18  Sven Neumann  <sven@picman.org>

	* autogen.sh: try automake-1.7 if automake-1.6 is not available.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: forgot to remove the
	"_delete_event_" stuff's documentation.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c: removed unneeded #includes.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: removed the "feature" of creating
	dialogs without action area by passing "_delete_event_" as button
	text. Also changed the delete_event() implementation: don't
	remember a callback and call it manually but gtk_widget_activate()
	the button for which "connect_delete" was passed as TRUE.

	* app/gui/test-commands.c: added a "Close" button to the multi view.

	* app/gui/brush-select.[ch]
	* app/gui/gradient-select.[ch]
	* app/gui/palette-select.[ch]
	* app/gui/pattern-select.[ch]: ditto. Removed the "context"
	parameter of the *_select_new() functions. All sorts of cleanups
	in all dialogs.

	* app/gui/convert-dialog.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: changed accordingly.

	* app/pdb/brush_select_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/pattern_select_cmds.c: regenerated.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrotatetool.c (roatate_angle_changed): compare the
	old and new angle using an epsilon of 0.0001 degrees so we don't
	get double "angle changed" because of rounding foobar.

	* app/tools/picmantransformtool.c: made PicmanTransformTool subclasses
	which don't use the grid (namely the flip tool) work correctly
	again by looking at transform_tool->use_grid more often.

2002-11-18  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer.c (picman_container_get_child_by_name):
	accept a NULL name and return NULL. Fixes warnings when starting
	picman w/o a picmanrc.

2002-11-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancursor.c: removed commented out and unused
	cruft, cleanup.

2002-11-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c (picman_toolbox_new): add a file dnd
	dest for the toplevel toolbox widget too. Makes picman-remote work
	again.

2002-11-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandrawablelistview.c: removed #undef
	GTK_DISABLE_DEPRECATED and #warning because we don't use
	deprecated stuff here.

2002-11-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_set_default_colors,
	picman_context_swap_colors): g_return_if_fail() earlier to clarify
	things (There was a bug in 1.2 which was fixed only accidentially
	in HEAD).

2002-11-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.h: added GTK_TARGET_SAME_APP flag
	to PICMAN_TARGET_BUFFER.

2002-11-17  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.c (color_notebook_new_internal): removed
	the non-dialog variant (all color notebooks have "Cancel" and "OK"
	buttons again). We have the color dockable which can be always
	open now and don't need this hack any more.

2002-11-16  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in.c: use g_spawn_async now. If the OS/2 port
	is still being maintained, there needs to be work done Glib side.
	If not, we should probably drop the other support code.

	* app/plug-in/plug-in.h: remove unused Win32 only structure members

2002-11-14  Michael Natterer  <mitch@picman.org>

	Transform tool cleanup:

	* libpicmantool/picmantoolenums.[ch]: removed the TransformState enum.

	* app/tools/picmantransformtool.[ch]: don't dispatch everything
	through the transform() virtual function. Added new vitrual
	functions dialog(), prepare(), motion() and recalc(). Do only the
	actual transform in transform(). Moved lots of logic which was
	duplicated in each subclass' transform() here. Cleanup.

	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: changed accordingly: moved code from
	transform() to the other method imlementations. Removed duplicated
	logic which is now done by our parent class. Makes everything
	smaller and more readable.

	InfoDialog cleanup:

	* app/gui/info-dialog.c: removed the "delete_event" callback so
	InfoDialog users can decide themselves what to do.

	* app/gui/info-window.c
	* app/tools/picmanmeasuretool.c: changed accordingly.

	* app/tools/picmancolorpickertool.c: ditto. Moved info_dialog
	creation to a utility function to improve code readbility.

	* app/tools/picmancroptool.c: ditto. Added a "Cancel" button which
	really cancels the tool instead of just hiding the dialog.

	* app/tools/picmantransformtool.c: added a "Cancel" button here too.

2002-11-14  Michael Natterer  <mitch@picman.org>

	* app/gui/tools-commands.c (tools_select_cmd_callback): removed
	the old hack which sets tool->gdisp. Fixes bug #98056.

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_initialize):
	set tool->gdisp here because the hack was there for tools which
	implement initialize() and show dialogs when selected from the
	menu. Also fixed wrong paramater to picman_viewable_dialog_new().

2002-11-12  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c: check for NULL masks returned from
	the brush scaler. Should fix crashes with buggy input devices.
	Fix suggested by Jim Meyer <jim@dsdd.org> (#91067).

2002-11-12  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: use GTK_STOCK_REMOVE for "<Dialogs>/Remove Tab".

2002-11-11  Manish Singh  <yosh@picman.org>

	* autogen.sh: don't say "Now type 'make'" if configure failed.

	* app/core/Makefile.am
	* app/core/core-types.h 
	* app/core/picmanenvirontable.[ch]: Implemented PicmanEnvironTable,
	keeps an envp array built from system environment and *.env files.

	* app/core/picman.[ch]: keep a PicmanEnvironTable around.

	* app/picmanrc.c
	* app/config/picmancoreconfig.[ch]
	* app/core/picmancoreconfig.h
	* app/gui/preferences-dialog.c
	* app/gui/user-install-dialog.c: environ-path config stuff

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folder-environ.png: just copied
	folder.png here, need a better one.

	* app/plug-in/plug-in.c: quick hack to use the envp in the
	PicmanEnvironTable. Only on unix now, should really port the
	code to use g_spawn_*.

	* data/misc/user_install
	* etc/picmanrc.in: add environ-path stuff

	* data/environ/Makefile: creates system environ directory.
 
	* data/environ/default.env: sample env file info.

	* data/Makefile.am
	* configure.in: added data/environ dir

	* plug-ins/pypicman/Makefile.am: python module files get put in
	$(picmanplugindir)/python now, install pypicman.env to point to it.

	* plug-ins/pypicman/doc/Makefile.am: minor clean up.

2002-11-09  Manish Singh  <yosh@picman.org>

	* plug-ins/common/png.c: allow setting compression level 0 from
	the UI.

2002-11-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c (picman_drawable_transform_paste):
	the transformed tile_manager has always an alpha channel, so use
	picman_drawable_type_with_alpha() when creating a layer from it
	using picman_layer_new_from_tiles(). Fixes bug #98053.

2002-11-09  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanpreview.[ch]: use a low priority idle handler to
	queue redraws, since we really want updates when nothing else is
	going on.

2002-11-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanvectorslistview.c: don't undefine
	GTK_DISABLE_DEPRECATED here, since these files don't use any
	deprecated functions.

2002-11-09  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/sinus.c (sinus_dialog): applied a patch from Yeti to
	fix #81965 (Sinus filter doesn't use the 'standard' picman_random_seed 
	widget.) + some minor changes to make it work.

2002-11-08  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_object.c (object_get_icon): first go at fixing
	#97771. Not finished yet.

2002-11-07  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/rcm/rcm_callback.c (rcm_units_string): replaced "???" by
	"unknown" to avoid compiler complaining about trigraphs.
	* plug-ins/rcm/rcm_callback.[ch]: have callback functions return the
	right type (gboolean iso gint).

	* plug-ins/rcm/rcm_misc.c (rcm_render_circle): fixed potential memory
	leak

2002-11-07  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/maze/handy.c: removed superfluous function declarations 
	plus some minor clean-up.

	* plug-ins/common/smooth_palette.c (dialog): replaced "Search Time" by
	"Search Depth" (#82492)

	* plug-ins/gfig/gfig.c (gfig_op_menu_create): replaced "Save as..." by
	"Save As..." (solves #92469)

	* plug-ins/MapObject/arcball.c: remove external function declarations 
	already defined in arcball.h

2002-11-08  Sven Neumann  <sven@picman.org>

        * plug-ins/script-fu/script-fu-scripts.c
        * plug-ins/script-fu/interp_slib.c
        * plug-ins/script-fu/interp_sliba.c: use locale-independant
        functions to convert between strings and numbers so that Script-Fu
        doesn't get confused in locales that don't use a dot as the
        decimal point (#98014).

        * plug-ins/common/papertile.c: applied a patch from David Necas
        that makes the color button work again (#97976).

2002-11-07  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/xbm.c: Applied patch from Raphael
	Quinet to suppress printing of comments in XBM files.
	Closes bug #82763.

2002-11-07  Sven Neumann  <sven@picman.org>

	* Made 1.3.10 release.

2002-11-07  Sven Neumann  <sven@picman.org>

	* Makefile.am: removed mydistcheck hook.

	* app/base/Makefile.am
	* app/paint-funcs/Makefile.am: removed automake-1.4 and 1.5 specific
	stuff; made it work correctly for srcdir != builddir.

	* tools/pdbgen/Makefile.am: do not to write into the source tree.

2002-11-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanbrushpreview.c
	(picman_brush_preview_render_timeout_func): fixed a bug spotted
	by Jim Meyer (#97911) and added a missing call to
	gtk_widget_queue_draw().

2002-11-07  Sven Neumann  <sven@picman.org>

	* HACKING: mention the automake-1.6 requirement.

2002-11-06  Manish Singh  <yosh@picman.org>

	* acinclude.m4: third times the charm. Python support macros
	moved here.

2002-11-06  Manish Singh  <yosh@picman.org>

	* configure.in: remove automake 1.4 special casing here too

2002-11-06  Manish Singh  <yosh@picman.org>

	* autogen.sh: require automake 1.6

	* m4compat: removed, unneeded now

2002-11-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/papertile.c: applied a patch from Toby Smith
	that moves the call to picman_drawable_mask_bounds() to the filter()
	function so that the filter is applied to the correct selection
	even if it changed after the plug-in dialog was opened (#83971).

	* plug-ins/common/unsharp.c (unsharp_mask_dialog): allow larger
	values for the radius (as suggested in #92250).

	* plug-ins/common/png.c: applied patch from Raphael Quinet that
	untoggles the "Save background color" option for images w/o an
	alpha channel (#92395).

2002-11-06  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_init): don't say we'd use MMX if it is
	disabled.

	* libpicmanmodule/picmanmodule.[ch]
	* app/gui/module-browser.c: changed enum values and user-visible
	strings to saner values.

	* libpicmanmodule/picmanmoduledb.c
	* plug-ins/tools/tool-safe-mode.c: made them less verbose.

2002-11-06  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/png.c: Removed cruft from file,
	 including unclear comments and redundant code.

2002-11-06  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-save.c
	* app/xcf/xcf.c: save as XCF version 2 if one of the new layer
	modes is used.

	* plug-ins/gflare/gflare.c: fixed #97766 along with a couple of
	other GUI issues.

2002-11-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mapcolor.c: fixed stupid bug that caused this
	plug-in to map to undefined values. Spotted by David Necas (#97780).

	* tools/authorsgen/contributors: added some names.

	* AUTHORS
	* app/gui/authors.h: regenerated.

2002-11-05  Sven Neumann  <sven@picman.org>

	* plug-ins/gflare/gflare.c: applied a couple of patches from
	David Necas <yeti@physics.muni.cz> that fix various issues with
	the GFlare plug-in. Most of these were introduced when doing the
	(still unfinished) port to GTK+-2.0 (#97761, #97764, #97765).

	Did some more changes while I was on it...

	* plug-ins/gflare/gflares/Bright_Star
	* plug-ins/gflare/gflares/Classic
	* plug-ins/gflare/gflares/Default
	* plug-ins/gflare/gflares/Distant_Sun
	* plug-ins/gflare/gflares/GFlare_101
	* plug-ins/gflare/gflares/GFlare_102
	* plug-ins/gflare/gflares/Hidden_Planet: applied a patch from
	yeti@physics.muni.cz that changes the names to use spaces instead
	of underscores (#97763).

2002-11-05  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c
	* app/widgets/picmanwidgets-constructors.c: applied a patch from
	Guillermo S. Romero that adds three new layer modes (Softlight,
	Grain Extract and Grain Merge, #97686).

	* app/base/base-enums.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/widgets/picmanwidgets-constructors.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.
	
2002-11-05  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorselector.[ch]: added virtual functions
	set_toggles_visible() and set_toggles_sensitive(). Added a
	stock_id. Emit "color_changed" and "channel_changed" on
	set_color() and set_channel() resp.

	* libpicmanwidgets/picmancolornotebook.[ch]: implement the new
	methods.  Added picman_color_notebook_set_has_page() to control
	which selectors a notebook contains.

	* libpicmanwidgets/picmancolorscales.[ch]: removed the toggle
	API and implement the new methods.

	* libpicmanwidgets/picmancolorselect.c: added toggle buttons for the
	channels so the widget doesn't need external ones.

	* app/gui/color-notebook.c: changed accordingly.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-color-triangle-16.png: added a
	(bad) icon for the triangle color selector.

	* modules/colorsel_triangle.c: use the new icon.
	* modules/colorsel_water.c: use the "Paintbrush" icon for now.

	* app/widgets/picmancoloreditor.[ch]: new widget for editing the
	FG/BG color featuring a color notebook, stock buttons for
	selecting the pages and a PicmanPickButton.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h: changed accordingly.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: added a dockable wrapper for PicmanColorEditor.

	* app/gui/menus.c: added it to the menus. Also added separate
	Layers, Channels and Paths entries. Bind <ctrl>L to the new
	callback so it doesn't always create a new layers dialog.

2002-11-05  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.c: on error, always close the module
	using picman_module_close(), not g_module_close() so all stuff gets
	reset. Set module->state *after* calling picman_module_close().
	Added more error checking & messages.

2002-11-04  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpickbutton.[ch]: new GtkButton subclass
	implementing the pick-from-everywhere eyedropper known from
	GtkColorSel. Code shamelessly stolen from there.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h: changed accordingly.

2002-11-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c (picman_dock_class_init): connect
	book_removed()'s default implementation correctly so dock auto
	destruction on last dockbook removal works again.

2002-11-04  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_color_window.c: use stock buttons.

2002-11-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreview.[ch]: removed idle rendering and render
	the preview on "expose" if needed. Renamed picman_preview_render()
	to picman_preview_update(). Cleanup.

	* app/widgets/picmanimagefilepreview.c
	* app/widgets/picmanselectioneditor.[ch]
	* app/widgets/picmantoolinfopreview.c: changed accordingly.

2002-11-03  Garry R. Osgood <grosgood@rcn.com>
	
	* configure.in defined PICMAN_ENABLE_MMX. Current value 0; to disable
	related MMX code in app/paint-funcs/paint-funcs.c and 
	app/paint-funcs/paint-funcs-mmx.h
	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs-mmx.h MMX code bracketed by above
	define Closes #86290 and #90969 by expediency: bugs were not in
	MMX assembly, but in the revised wrapper introduced on 2001-11-19,
	which does not accommodate correctly macros designed to run the
	MMX code selectively. Rather than revert, discussion on bug report
        thread opted to disable such 'MMX microoptimizations' for now, and 
	get the design correct first in pure C. See bug report and caveats
	in paint-funcs-mmx.h
	
2002-11-02  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: simplified the code and
	improved the performance by getting rid of the idle function.
	Simply rerender the buffer on expose if necessary.

2002-11-02  Sven Neumann  <sven@picman.org>

	* app/display/picmanprogress.c (picman_progress_update): force an update
	of the progress bar (#97459, reported by Akkana).

2002-11-01  Michael Natterer  <mitch@picman.org>

	* app/gui/file-open-dialog.[ch]: added "gimage" and "uri"
	parameters to file_open_dialog_show(). If an image is passed, go
	to that image's directory, for an uri, preselect the file.
	Fixes bug #96779.

	* app/gui/menus.c: pass "action" to file_open_cmd_callback() so we
	can distinguish if it was invoked from the toolbox or an image.

	* app/gui/file-commands.[ch]: if invoked from an image, pass it to
	file_open_dialog_show().

	* app/widgets/picmandocumentview.c: pass the selected document's uri
	to file_open_dialog_show().

	* app/gui/file-save-dialog.c: use picman_image_get_filename()
	instead of fiddling with the image's uri manually.

2002-11-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.c
	* app/widgets/picmanimageview.c: changed some debugging output to
	say "TODO: ...".

2002-11-01  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.[ch]: improved preformance by
	rendering the buffer only when needed for an expose instead of
	after each color/channel change.

2002-11-01  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c (picman_color_scale_render): no
	need to assign "d = buf" twice.

2002-11-01  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-reset-16.png: finally a Reset icon
	from Jakub Steiner <jimmac@ximian.com>.

2002-11-01  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmancolorspace.h (picman_rgb_to_hsv4): "rgb" and
	"hsv" parameters were swapped in the header. All users however
	used the function as implemented, not as documented.

2002-11-01  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.10.

	* app/tools/picmanfliptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c: use shorter strings for the dockable
	tabs.

2002-10-31  Sven Neumann  <sven@picman.org>

	* app/gui/color-notebook.c: make the dialog a "normal" window if
	it is created w/o an action area (#97364).

	* plug-ins/Lighting/lighting_preview.c: removed use of deprecated
	GDK functions.

2002-10-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c
	* plug-ins/common/sel_gauss.c:
	applied a patch from Guillermo S. Romero that extends the range of
	valid radii to > 0.0 for these blur plug-ins (#97166).
	
2002-10-31  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs-constructors.c: don't add "Options" to the
	tools name when setting the dockbook tab label.

	* app/gui/color-notebook.c: removed the white and black color
	buttons since white and black are trivial to select anyway.

2002-10-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.[ch]: removed rgb and hsv parameters
	from picman_color_scale_new().

	* libpicmanwidgets/picmanwidgets.c: changed accordingly.

2002-10-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.c: made inverted and flippable work
	correctly.

2002-10-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.c: added the missing bits for
	channel == PICMAN_COLOR_SELECTOR_ALPHA and for vertical orientation.

2002-10-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am: install picmancolorscale.h.

	* libpicmanwidgets/picmancolorscale.c: changed the sliders to black
	and white arrows.

2002-10-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmandata.[ch] (picman_data_delete_from_disk): don't
	g_message() on error but return a GError.

	* app/widgets/picmandatafactoryview.c: show the message here.

2002-10-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandevices.c: don't #include "core/picmanbrush.h"

2002-10-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.[ch]: cosmetic cleanup.

2002-10-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c: fixed rendering for partial
	expose events.

	* libpicmanwidgets/picmanwidgets.[ch]: added picman_color_scale_entry_new().

	* libpicmanwidgets/picmancolorscales.c: use the color scales.

2002-10-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorselect.c: use a mnemonic that doesn't
	collide with the rest of the dialog.

	* modules/Makefile.am
	* modules/colorsel_gtk.c: removed the GTK color selector module.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: translate in the picman14-libpicman domain.

2002-10-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolornotebook.c: create the notebook labels
	with mnemonics.

	* libpicmanwidgets/picmancolorselect.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: added mnemonics to the tab strings.

	* libpicmanwidgets/picmancolorscale.c: looks finished now.

	* libpicmanwidgets/picmancolorscales.c: tie the test color scale to
	the right channel adjustment and update its color and channel
	accordingly. Added mnemonics for the channels.

2002-10-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.[ch]: derive it from GtkScale, 
	override the expose method and draw something there. Work in
	progress...

	* libpicmanwidgets/picmancolorscales.c: added a PicmanColorScale widget
	for testing.

2002-10-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.[ch]: added some API and
	stuff. Still does nothing.

2002-10-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: cosmetics.

2002-10-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.[ch]: new files, basic framework
	for a new widget, does nothing yet.

	* Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h: changed accordingly.

2002-10-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscales.c: removed the hashmark from the
	hex entry.

2002-10-29  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolornotebook.[ch]: made the color notebook
	a PicmanColorSelector subclass so they have the same API.

	* app/gui/color-notebook.c: changed accordingly.

2002-10-29  Sven Neumann  <sven@picman.org>

	* libpicmanmodule/picmanmodule.c
	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c: include libpicman-intl.h, not
	picmanintl.h since this is in the picman14-libpicman translation domain.

	* libpicmanmodule/picmanmoduledb.c
	* libpicmantool/picmantool.c: no need to include intl.h from here, there
	are no translatable message.

2002-10-29  Manish Singh  <yosh@picman.org>

	* picmantool-1.3.in: strip paths from the plug-in filename for
	installation (fixes #97111).

2002-10-29  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/tools-enums.c: removed this file which was moved to
	libpicmantool in March.

2002-10-28  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscales.[ch]: the color scales from
	the main color selection as PicmanColorSelector subclass.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetsmarshal.list
	* libpicmanwidgets/picmanwidgetstypes.h: changed accordingly.

	* libpicmanwidgets/picmancolornotebook.c: skip it when iterating the
	PicmanColorSelector subclasses.

	* libpicmanwidgets/picmancolorselector.[ch]: added virtual function
	set_has_alpha() amd signal "channel_changed". Put RGB, HSV and
	channel values into to the PicmanColorSelector struct where they are
	available for subclasses.

	* libpicmanwidgets/picmancolorselect.[ch]
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: changed accordingly, cleanup.

	* app/gui/color-notebook.[ch]: use the new PicmanColorScales widget,
	lots of cleanup.

2002-10-28  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/unsharp.c: reordered action buttons.

2002-10-28  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolornotebook.[ch]: the notebook as known
	from the main color selection as new widget.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmancolorselector.h
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h: changed accordingly.

	* app/gui/color-notebook.c: use the new widget.

2002-10-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.[ch]: added "book_added" and "book_removed"
	signals. Removed the "destroy_if_empty" flag and destroy empty
	docks in book_removed's default implementation.

	* app/widgets/picmantoolbox.c: implement "book_added" and
	"book_removed" and set the window to freely resizable vertically
	if it contains dockbooks, and to the current behaviour of snapping
	to multiples of tool_button height otherwise. Fixes bug #93309.

	* app/widgets/picmanimagedock.c: changed accordingly.

2002-10-25  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c
	* app/gui/about-dialog.c
	* app/gui/convert-dialog.c
	* app/gui/dialogs-commands.c
	* app/gui/file-commands.c
	* app/gui/palette-import-dialog.c
	* app/tools/picmantexttool.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmanwidgets-utils.c
	* libpicmanwidgets/picmanfileselection.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/general.c
	* plug-ins/picmanressionist/picmanressionist.c: replaced all sorts of
	gtk_widget_show()/gdk_window_raise() combinations by
	gtk_window_present().

2002-10-25  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/color-history.[ch]: new files implementing the color
	history which used to live in color-notebook.*

	* app/gui/color-notebook.[ch]
	* app/gui/session.c: changed accordingly.

2002-10-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanimagedock.c: removed #warning and inclusion of
	"display/*" stuff because we use PicmanDisplays as PicmanObjects in
	this file.

2002-10-24  Sven Neumann  <sven@picman.org>

	* app/pdb/display_cmds.c
	* tools/pdbgen/pdb/display.pdb (display_new_invoker): the first
	display takes ownership of the image. Fixes bug #94371.

2002-10-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c: applied a patch from
	Michael Niedermayer <michaelni@gmx.at> that adds support for
	YCbCr (de)composition (#96448).

2002-10-23  Michael Natterer  <mitch@picman.org>

	Moved generic datafile loading to LibPicmanBase:

	* app/core/picmandatafiles.[ch]: removed...

	* libpicmanbase/picmandatafiles.[ch]: ...and add here with a changed
	API which requires no more global variables.

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmanbasetypes.h
	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmandatafactory.c
	* app/gui/gui.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins.c
	* app/tools/tools.c: changed accordingly.

	Moved module loading to LibPicmanModule:

	* app/core/picmanmodules.c: removed lots of code...

	* libpicmanmodule/picmanmoduledb.[ch]: ...and added it here as
	PicmanModuleDB object.

	* libpicmanmodule/Makefile.am
	* libpicmanmodule/picmanmoduletypes.h: changed accordingly.

	* app/core/picman.[ch]: replaced picman->modules by picman->module_db.

	* libpicmanmodule/picmanmodule.[ch]: added
	picman_module_query(). Internal cleanup. Stuff...

	* app/gui/module-browser.c: changed accordingly. Unfinished...

	* app/core/picmancontainer.c
	* app/core/picmanlist.c: reverted the HACKS introduced recently.

	* app/core/picmanobject.[ch]: added picman_g_object_get_memsize()
	utility function.

	* libpicmanproxy/picmanobject.[ch]: regenerated.

	Changed display filter configuration stuff:

	* libpicmanwidgets/picmancolordisplay.[ch]: made the virtual
	configure() function return a GtkWidget instead of opening a
	dialog. Changed configure_cancel() to configure_reset(). Added
	"changed" signal.

	* app/display/picmandisplayshell-filter-dialog.c: embed the filters'
	config GUI in the dialog. Connect to "changed" and added a "Reset"
	button which resets the filter.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c: changed accordingly.

	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: minor fixes.

2002-10-22  Sven Neumann  <sven@picman.org>

	* app/gui/offset-dialog.c (offset_ok_callback): don't free the
	OffsetDialog structure twice. Fixes bug #96520.

2002-10-21  Sven Neumann  <sven@picman.org>

	* libpicmanmodule/picmanmodule.c: fixed some i18n glitches.

2002-10-21  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* libpicmanmodule/.cvsignore
	* libpicmanmodule/Makefile.am
	* libpicmanmodule/picmanmodule.[ch]
	* libpicmanmodule/picmanmodule.def
	* libpicmanmodule/picmanmoduletypes.h
	* libpicmanmodule/makefile.msc: new library for module loading.

	* configure.in: generate Makefiles for libpicmanmodule and its
	devel-docs. Added GMODULE_CFLAGS and GMODULE_LIBS.

	* app/Makefile.am: link the app against it.

	* libpicman/picmanmodule.h
	* app/core/picmanmoduleinfo.[ch]: removed.

	* libpicman/Makefile.am
	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanmodules.c
	* app/gui/module-browser.c: changed accordingly.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: #include "libpicmanmodule/picmanmodule.h"

2002-10-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanmoduleinfo.[ch]
	* libpicman/picmanmodule.h: separated module query from type
	registration by adding a separate "picman_module_query" function
	which must be implemented by modules. Make local copies of the
	strings returned by the query function.

	* app/core/picmanmodules.c
	* app/gui/module-browser.c: changed accordingly.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: added the picman_module_query() functions.

2002-10-20  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-filter.[ch]: removed the
	ColorDisplayNode struct entirely. PicmanDisplayShell->filters is now
	just a GList of PicmanColorDisplay objects.

	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-render.c: changed accordingly.

2002-10-20  Michael Natterer  <mitch@picman.org>

	Ported module loading to GTypeModule, getting rid of all own
	module registering/bookkeeping stuff for color selectors and
	display filters. The modules now simply register PicmanColorSelector
	and PicmanColorDisplay subclasses, the list of registered subclasses
	can then be obtained calling g_type_children() on the abstract
	base classes.

	This is work in progress and just the first working state after I
	started breaking everything...

	* app/gui/color-select.[ch]
	* libpicman/picmancolordisplay.h
	* libpicman/picmancolorselector.h: removed.

	* app/gui/Makefile.am
	* libpicman/Makefile.am: changed accordingly.

	* libpicman/picmanmodule.h: massively simplified. All voodoo is gone.

	* libpicmanwidgets/picmancolordisplay.[ch]
	* libpicmanwidgets/picmancolorselector.[ch]: new abstract base classes
	which need to be subclassed by modules.

	* libpicmanwidgets/picmancolorselect.[ch]: the built-in color selector
	from app/gui/color-select.* ported to be a PicmanColorSelector
	subclass.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetsmarshal.list
	* libpicmanwidgets/picmanwidgetstypes.h: changed accordingly.

	* app/core/picmanmoduleinfo.[ch]: made it a GTypeModule subclass

	* app/core/picmanmodules.c: changed accordingly.

	* app/core/picmancontainer.c
	* app/core/picmanlist.c: HACKED around to allow PicmanLists of
	GObjects (not PicmanObjects). This is EEKy, so I will either make
	picman->modules a simple GList and revert this bit of change, or
	allow GObjects all over the place in PicmanContainer land...

	* app/display/picmandisplayshell-filter.[ch]
	* app/gui/color-notebook.c: removed all module stuff and use
	g_type_children() to get the list of available color_selectors
	and display_filters.

	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-render.c
	* app/gui/module-browser.c: changed accordingly.

	* app/gui/gui.c: ref the built-in color selector's class before
	the modules are queried so it appears first in the list of
	PicmanColorSelector's children.

	* modules/Makefile.am: build the water color selector again.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: ported them all to the new API.

	* modules/picmanmodregister.[ch]: removed the old EMX module hack.

2002-10-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-mask.c (picman_image_mask_extract): changed an
	error message.

	* app/widgets/picmanwidgets-utils.c: tweaked so it looks more like
	the query box.
	
2002-10-17  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.c
	* app/widgets/picmantoolbox.c: fixed warnings by casting/bracketting
	properly.

2002-10-16  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_default_dialog.c (dialog_destroy): function 
	now correctly returns a value.

2002-10-16  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/Lighting/lighting_image.c
	* plug-ins/Lighting/lighting_main.[ch]
	* plug-ins/Lighting/lighting_preview.[ch]
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/Lighting/lighting_ui.c: applied patch from Jeroen Lamain
	<roccodevinger@yahoo.com> to fix #52896 (Lighting Effects plugin needs 
	interactive light placement)

2002-10-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmaneditor.c: changed the default button_icon_size to
	GTK_ICON_SIZE_MENU.

	* themes/Default/gtkrc
	* themes/Default/images/Makefile.am: don't override GTK+ button
	icons.  This renders some of the compiled-in icons unused; we
	should remove them later.

2002-10-15  Sven Neumann  <sven@picman.org>

	* app/gui/dialogs-constructors.c: draw the tool icons in dockbook
	tabs using GtkImages, not using PicmanPreviews.

	* app/widgets/picmantoolbox.c: added a "button_relief" style property
	to PicmanToolbox and changed the default style to GTK_RELIEF_NONE.

	* themes/Default/gtkrc: document how to set the style here.

2002-10-15  Sven Neumann  <sven@picman.org>

	* app/base/levels.[ch]: added the API for level correction using
	black, gray and white point.

	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.[ch]: misc smaller changes.

	* app/widgets/picmanhistogrambox.[ch]: allocate the buffer for the
	gradient preview on size_allocate, not for every expose event.

	* app/widgets/picmanhistogramview.c: fixed drawing for width > 256.

	* themes/Default/images/stock-color-picker-white-18.png: tweaked.

2002-10-15  Sven Neumann  <sven@picman.org>

	* app/tools/picmaninktool.c: using gtk_image_new_from_pixmap() feels
	kinda lame. Draw the ink blob directly in an expose handler instead.

2002-10-15  Sven Neumann  <sven@picman.org>

	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.[ch]
	* app/tools/picmanthresholdtool.c
	* app/widgets/picmanhistogrambox.[ch]
	* app/widgets/picmanhistogramview.[ch]: started to clean up histogram
	code. Moved the gradient into the PicmanHistogramBox. Draw only in the
	expose event handler.

2002-10-15  Dave Neary  <bolsh@picman.org>
	
	* app/tools/picmaninktool.c
	* app/tools/picmantexttool.c: Removed warnings by including
	string.h, and changing gtk_pixmap_new() to gtk_image_new_from_pixmap().

2002-10-14  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/png.c: Corrected coding standard issues
	(indentation & bracketting).

2002-10-14  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/png.c: Fix bug #55700 properly. Handles
	INDEXEDA images better.

2002-10-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay.[ch]: added convenience function
	picman_display_coords_in_active_drawable().

	* app/tools/picmancurvestool.c: indicate the possibility to pick color
	values from the image by showing a color picker cursor. Made the
	file selection dialog transient for the tool shell.

	* app/tools/picmanlevelstool.c: made the file selection dialog
	transient for the tool shell.

2002-10-13  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-color-picker-black-18.png
	* themes/Default/images/stock-color-picker-gray-18.png
	* themes/Default/images/stock-color-picker-white-18.png: new icons.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am: added the new color picker icons.

	* app/tools/picmanlevelstool.c: added the GUI that will allow to pick
	the white, gray and black point from the image.

2002-10-13  Manish Singh  <yosh@picman.org>

	* app/tools/picmantexttool.c: #include <stdio.h>

2002-10-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: allow to load text from a file.

2002-10-11  Sven Neumann  <sven@picman.org>

	* Made 1.3.9 release.

2002-10-11  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am (INCLUDES): added PANGO_FT2_CFLAGS.

2002-10-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.[ch]: added a very simple text editor.

2002-10-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.[ch]: optionally allow PICMAN_UNIT_PIXEL
	as value for PicmanUnit params.

	* app/core/picmanimage-text.[ch]
	* app/core/picmantext.[ch]
	* app/tools/picmantexttool.c: moved some code around.

2002-10-10  Michael Natterer  <mitch@picman.org>

	* app/gui/palette-import-dialog.c: s/"new_import"/"New Import"/.

2002-10-10  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmantext.[ch]: added first draft of a PicmanText object.

2002-10-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c
	* app/widgets/picmanfontselection.[ch]
	* app/widgets/picmanwidgets-utils.[ch]: started to implement the
	text tool GUI as suggested in #84151.

2002-10-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette.c (picman_palette_get_new_preview): adjust
	the cell_size of the preview dynamically (makes them look nicer).

	* app/core/picmanpalette-import.c: require n_colors to be at least
	2, not 1. Cleanup.

	* app/gui/palette-import-dialog.c: completely chopped and
	re-assembled source and GUI. Please have a look and comment...

2002-10-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-text.[ch]: new files that implement the text
	rendering that used to live in picmantexttool.[ch].

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/tools/picmantexttool.[ch]
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/text_tool.pdb: changed accordingly.

	* tools/pdbgen/enums.pl
	* app/pdb/text_tool_cmds.c: regenerated.

2002-10-09  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: some shortcut changes: Ctrl+Shift+S is now
	"File/Save as...", not "View/Toggle Statusbar" (HIG compliance).
	Removed Ctrl+Shift+B from "Select/Border..." because it is already
	taken by "Dialogs/Brushes...". Set the shortcut to "" instead of
	NULL whenever we abuse GTK_STOCK_NEW, so the menu item doesn't get
	the Ctrl+N shortcut (will need separate stock icons for these menu
	items).

2002-10-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradientpreview.c
	* app/widgets/picmanpalettepreview.c: set "height" to size/2 instead
	of "width" to size*3 in get_size() so the preview size is
	contollable in smaller steps using the container views' "Preview
	Size" context menu.

2002-10-09  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-char-picker-22.png
	* themes/Default/images/stock-letter-spacing-22.png
	* themes/Default/images/stock-line-spacing-22.png: new icons taken
	from #84151.

	* libpicmanwidgets/picmanstock.[ch]: added the new icons.

2002-10-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainermenu.c
	* app/widgets/picmancontainerview.c: ref/unref menu->context and
	view->context in picman_container_[menu|view]_real_set_context() so
	it can't be finalized under our feet.

2002-10-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: added utility function
	picman_scale_entry_set_sensitive().

2002-10-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/animationplay.c: put the preview in a sunken
	frame like most other previews.

2002-10-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-duplicate.c: an attempt to fix bug #94749
	(picman_image_duplicate crashes if floating selection exists).

	* data/images/picman_splash.png: a new blinkensplash from Paris.

2002-10-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ps.c: applied a patch from Peter Kirchgessner
	that fixes bug #78310 (wrong bounding box when exporting to EPS).

2002-10-01  Manish Singh  <yosh@picman.org>

	* autogen.sh: call libtoolize explictly, since newer automakes
	don't run it for us anymore

2002-09-30  Simon Budig  <simon@picman.org>

	* data/brushes/1circle.gbr: fixed the default spacing, so that
	lines actually look like 1 pixel lines...

	* themes/Default/images/tools/.cvsignore: Added some files.

	* app/vectors/picmananchor.h
	* app/vectors/picmanbezierstroke.[ch]
	* app/vectors/picmanstroke.h
	* app/vectors/picmanvectors.h: Added some stuff, mostly unused
	code that otherwise would just rot on my harddisk. Mitch: I
	need to discuss the data structures with you...

2002-09-27  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: added new signal "reconnect"
	which is emitted when the underlying image changes (happens on
	"Revert"). Set the sensitivity of the new "Toggle QuickMask" menu
	item. Don't configure the QMask button in picman_display_shell_new().

	* app/display/picmandisplayshell-handlers.c (picman_display_shell_connect):
	configure the QMask button here so it's consistent after "Revert".

	* app/display/picmannavigationview.c: connect to the shell's
	"reconnect" signal and update accordingly.

2002-09-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_init): set the
	toggle_cursor to PICMAN_ZOOM_CURSOR, not the tool_cursor.

2002-09-26  Michael Natterer  <mitch@picman.org>

	Made F1 help work again:

	* libpicmanwidgets/picmanhelpui.c: add the "F1" binding entries to the
	correct class, use GtkWidget's "show_help" signal correctly,
	cleanup, replaced deprecated stuff (obviously this file was
	make-it-compile ported in the first place :)

	* plug-ins/helpbrowser/helpbrowser.c: close the HtmlStream when
	there is no more data to read (avoids implicit calling of the
	stream's cancel function which fails because we didn't set it).
	Minor cleanup.

2002-09-25  Mel Boyce  <syngin@picman.org>

	* autogen.sh: Changed intltool URL so it's more correct.

2002-09-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.[ch] (picman_item_factory_create_item):
	added a "const gchar *textdomain" parameter so
	g_object_[set|get]_data() hacks needed for translation are private
	stuff of PicmanItemFactory. Use more qdata instead of just data,
	minor cleanup.

	* app/gui/plug-in-menus.c: pass the textdomain as paramater
	instead of g_object_setting it on the item_factory.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/menus.c: pass NULL as textdomain.

2002-09-25  Michael Natterer  <mitch@picman.org>

	* libpicman/Makefile.am: install picmancompat.h

2002-09-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_sharpen): set
	channel->bounds_known to FALSE (fixes #93853).

2002-09-23  Michael Natterer  <mitch@picman.org>

	* app/gui/plug-in-menus.c: escape underscores in plug-in menu
	entries so they don't end up as mnemonics.

2002-09-21  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.h: fixed some macros that were
	never used.

	* data/images/picman_splash.png: flattened the splash image. The
	alpha channel crashed servers with buggy XRender extension
	(#93841) (and should have never been there anyway).

2002-09-18  Manish Singh  <yosh@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c: Allow activation of the
	search from the entry field.

2002-09-18  Manish Singh  <yosh@picman.org>

	* configure.in: use X_CFLAGS when checking for Xmu headers too

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: slight tweak to mitch's change
	to have default parameters for the common case

2002-09-18  Sven Neumann  <sven@picman.org>

	* configure.in: use X_CFLAGS when checking for xpm.h.

	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl: added X_CFLAGS here as well so that
	xpm compiles even if GTK_CFLAGS doesn't pull in the X11 include
	path for us. Should fix #93518 and hopefully won't break it for
	other people.

2002-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/convmatrix.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/print/picman_main_window.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/sel2path/sel2path.c: reordered action buttons.

2002-09-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewabledialog.c: use PangoAttributes instead of
	PangoMarkup.

	* app/gui/preferences-dialog.c: adapt to the look of the
	PicmanViewableDialog.

2002-09-17  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c: reordered buttons and polished the dialog.

2002-09-17  Sven Neumann  <sven@picman.org>

	* app/gui/file-new-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/tools/picmanimagemaptool.c
	* app/widgets/picmanfontselection-dialog.c: place the Cancel button
	next to the confirmative button as suggested by the HIG.

2002-09-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandocumentview.[ch]
	* app/gui/documents-commands.[ch]
	* app/gui/menus.c: changed icon/variables/functions to say
	"Remove" instead of "Delete" because "Delete" is misleading (we
	don't delete the file but just remove the entry from the document
	history).

2002-09-12  Sven Neumann  <sven@picman.org>

	* autogen.sh: fixed output in case automake-1.6 is not available.

2002-09-11  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/curve_bend.c: applied a patch from Guillermo
	S. Romero which cleans up the GUI even more. Changed it a bit to
	behave nicely on window resizing.

2002-09-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: fixed typo (bug #93031).

2002-09-10  Michael Natterer  <mitch@picman.org>

	Some PDB cleanup:

	* tools/pdbgen/pdb/procedural_db.pdb: removed the get_data() and
	set_data() implementations and the global "data_list" variable.
	Cleaned up the dump() stuff (pass the FILE pointer around instead
	of having a global variable for it). Fixed output_string() so it
	does not crash on NULL strings.

	* app/core/picman.[ch]: added picman->procedural_db_data_list.

	* app/pdb/procedural_db.[ch]: added procedural_db_[set|get]_data().
	Don't leak data identifiers when overwriting an already existing
	entry. Added g_return_if_fail() stuff to all public functions.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/parasite.pdb: tweaked some helper functions to
	take parameters which make them aware of the real type of the
	objects they handle (e.g. the PDB function picman_layer_set_name()
	matches the core function picman_object_set_name()).

	* app/pdb/pdb_glue.h: removed ugly CPP-level workarounds for the
	issue mentioned above.

	* app/pdb/channel_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/procedural_db_cmds.c: regenerated.

2002-09-10  Dave Neary  <bolsh@picman.org>

        * plug-ins/common/png.c: Handle INDEXA images if the
        indexed palette is full by looking for an unused colour.
        Fixes bug #55700.

2002-09-09  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-grow-16.png:
	* themes/Default/images/stock-shrink-16.png: make the icons less
	  crowded

2002-09-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayerlistview.c
	* app/gui/channels-commands.c: some more auto-sizing spinbuttons.

	* app/gui/offset-dialog.c: added mnemonics for "X" and "Y".

	Dialog auto-hide cleanup:

	* app/widgets/picmanviewabledialog.c: close the dialog when the
	PicmanViewable goes away (special cased PicmanItems which become
	invisible on "removed"). Close the dialog by syntesizing a
	"delete_event" instead of simply hiding or destroying it so the
	closing method of the dialog's user gets invoked.

	* app/gui/resize-dialog.[ch]: don't do the same here. Simplifies
	the API even more as we don't have to pass the object to watch any
	more.

	* app/gui/image-commands.c
	* app/gui/layers-commands.c: changed accordingly.

	* app/undo_history.c
	* app/gui/convert-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/vectors-commands.c: removed all dialog auto-hiding which
	is now done by PicmanViewableDialog. Also connect more close
	callbacks to gtk_widget_destroy() and handle shell destruction
	accordingly, so these pseudo widgets behave more like real ones.

	Tool-dialog auto-hide fix:

	* app/tools/tool_manager.c: never call a tool's initialize()
	method with a NULL gdisp (I can't follow why we did this before
	because it's conceptually broken and makes the semantics of
	initialize() more than unclear).
	To be sure, added g_return_if_fail(PICMAN_IS_DISPLAY(gdisp)) to
	tool_manager_initialize_active().

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: removed the recently added code
	for handling NULL displays in initialize().

2002-09-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/curve_bend.c: forgot a mnemonic.

2002-09-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/iwarp.c: moved toggles into frame titles.

2002-09-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: removed explicit
	spinbutton pixel size.

	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/coffee.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/land.scm
	* plug-ins/script-fu/scripts/lava.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: follow PDB change:
	picman-gradients-[set|get]-active have been renamed to *-gradient
	to match the brush, pattern and palette APIs.

2002-09-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_get_colormap): return
	gimage->cmap directly instead of calling
	picman_drawable_cmap(active_drawable) without checking if there
	actually is an active_drawable.

	* tools/pdbgen/pdb/image.pdb (image_get_cmap): use g_memdup()
	instead of g_new() followed by memcpy().

	* app/pdb/image_cmds.c: regenerated.

2002-09-08  Michael Natterer  <mitch@picman.org>

	* app/gui/color-notebook.[ch]: set the hex entry to 7 chars instead
	the whole width of the vbox. Added color_notebook_set_title().

	* app/widgets/picmantoolbox-color-area.c: use the new function to
	set the color selection's title to either "Change Foreground
	Color" or "Change Background Color" instead of just "Color
	Selection".

2002-09-07  Michael Natterer  <mitch@picman.org>

	Histogram cleanup:

	* app/base/picmanhistogram.c: Added g_return_if_fail() to all public
	functions, reordered stuff, cleanup (no logic changed).

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanhistogrambox.[ch]: new widget containing a
	PicmanHistogramView and two range spinbuttons (as known from the
	threshold tool). Users only need to connect to the histogram
	view's "range_changed" signal. The spinbuttons are handled
	internally.

	* app/widgets/picmanhistogramview.[ch]: define it's default size in
	the header. Make sure "start" is always smaller than "end". Emit
	"range_changed" in picman_histogram_view_set_range().

	* app/tools/picmanlevelstool.c: changed accordingly.

	* app/tools/picmanthresholdtool.[ch]: removed the code which
	did the same and use the new widget.

	* app/tools/picmanhistogramtool.[ch]: ditto. Removed the "intensity"
	info label. Cleanup.

2002-09-07  Michael Natterer  <mitch@picman.org>

	* app/gui/file-new-dialog.c
	* app/gui/offset-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/user-install-dialog.c: replaced some more pixel sizes by
	char sizes. Tweaked table spacings. Mnemonics.

	* app/gui/info-dialog.[ch]: internal cleanup.

	* app/gui/resize-dialog.[ch]: same here. Removed the "cancel_cb"
	from the API and simply destroy the dialog on "Cancel". Makes the
	dialog construction less weird.

	* app/gui/image-commands.c
	* app/gui/layers-commands.c: changed accordingly. Same cleanups
	as above.

2002-09-07  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c: some stock items.

	* plug-ins/MapObject/mapobject_ui.c: moved toggle button into
	frame title, added mnemonics.

	* plug-ins/common/curve_bend.c: reorganized the GUI completely
	to be more usable. Added mnemonics and stock items.

	* plug-ins/common/checkerboard.c
	* plug-ins/common/film.c
	* plug-ins/common/illusion.c
	* plug-ins/common/plasma.c
	* plug-ins/flame/flame.c: minor cleanups (spacing, stock items).

2002-09-07  Dave Neary  <bolsh@picman.org>

        * app/xcf/xcf-load.c: Unref layer mask rather than layer
        when adding the mask. Fixes bug #92693.

2002-09-06  Hans Breuer  <hans@breuer.org>

	* */*/makefile.msc : updated

	* libpicmantool/makefile.msc : new file, libpicmantool
	is currently build as static lib due to references
	into app/core

	* themes/Default/makefile.msc : removed
	* themes/Default/images/makefile.msc : new file

	* libpicmanwidgets/makefile.msc libpicmanwidgets/picmanwidgets.c
	updated (externals)

	* app/paint-funcs.c : replaced gccism varibale size array on
	stack with portable alloca, removed sizeof(buf) check which 
	must fail now.
	
	* app/config/picmanconfig.c : get write/close protos
	on win32 from io.h
	* app/config/picmanrc.c : dito and <string.h>
	* app/config/picmanscanner.c : <string.h> only

	* app/core/picmancontainer.c : workaround for clumsy 
	compilers not supporting vararg macros

	* app/core/picmandocumentlist.c app/core/picmanparasitelist.c
	include <io.h> on win32

	* app/widgets/picmandocumentview.c 
	  app/widgets/picmanimagedock.c
	  app/widgets/picmanpreview.c : add #ifdef __GNUC__
	to avoid breaking on non standard pragma #warning.

	* app/gui/session.c : include <string.h>

	* regexrepl/makefile.msc : build as dll

	* plug-ins/makefile.msc : updated

	* plug-ins/common/pix.c : open file binary

	* plug-ins/common/spheredesigner.c : avoid error
	'incompatible types' while assigning, use memcpy()

2002-09-06  Michael Natterer  <mitch@picman.org>

	* app/gui/convert-dialog.c: changed "Number of Colors" to
	"Max Number of Colors" to clarify what this parameter does.
	(fixes #92194).

	* app/gui/menus.c: use PICMAN_STOCK_INFO for "View/Info Window".

	Specify spibutton sizes in chars, not pixels (eek) all over
	the place. Also removed explicit sizes where the GtkSpinButton
	default size does not disturbe tabular widget layouts.

	* libpicmanwidgets/picmanwidgets.c: removed the hardcoded width of 75
	pixels in picman_spin_button_new(). Changed picman_scale_entry_new()
	and picman_coordinates_new() to interpret their "spinbutton_width"
	parameters as chars if < 16, and as pixels otherwise. This gives
	reasonable results and doesn't cause unchanged plug-ins to
	suddenly have spinbuttons of dozens of chars width :)

	* libpicmanwidgets/picmansizeentry.c: added the same heuristic here.

	* libpicmanwidgets/picmanquerybox.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/cubism.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/diffraction.c
	* plug-ins/common/emboss.c
	* plug-ins/common/film.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/grid.c
	* plug-ins/common/illusion.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/lic.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/mblur.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/nova.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/spread.c
	* plug-ins/common/tile.c
	* plug-ins/common/tileit.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/gflare/gflare.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/rcm/rcm_dialog.c: changed accordingly, which involves
	removals of gtk_widget_set_size_request(spinbutton), removal of
	lots of explicit spinbutton sizes in picman_scale_entry_new(), and
	adding of new ones because GtkSpinButton's auto-size trashed
	tabular layouts.

	Lots of cleanup & indentation while browsing the plug-ins'
	code. Changed spacings, moved toggle buttons into frame titles,
	use stock items, stuff...

2002-09-06  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/semiflatten.c: minor code cleanup (matching
	g_new/g_free pairs iso g_new/free, etc.)

2002-09-05  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_default_dialog.c (make_default_dialog): more 
	changes for GNOME HIG compliance

	* plug-ins/imagemap/imap_main.c (dialog)
	* plug-ins/imagemap/imap_menu.c: Moved a few menu items to make it
	compliant to the GNOME Human Interface Guidelines.

2002-09-05  Manish Singh  <yosh@picman.org>

	* acinclude.m4: emptied

	* autogen.sh: support for automake version special casing, error
	out on aclocal failure.

	* m4compat/1.4/pysupport.m4
	* m4compat/1.6/pysupport.m4
	* configure.in
	* plug-ins/Makefile.am: pypicman autoconf support, just to get it
	some testing. We'll figure out policy later.

2002-09-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c (crop_tool_crop_image): call
	picman_image_flush() after cropping. Fixes #90977 (Thanks to
	Toby Smith).

2002-09-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-bucket-fill.c: put the call to
	picman_drawable_mask_bounds() back because we always need the region
	to apply the fill (fixes non-seed-fill fills). Also take
	"sample_merged" into account when intersecting the resulting mask
	with the image's selection.

	Fixed unrelated bug:

	* app/core/picmanimage-contiguous-region.c: need to use
	picman_image_projection_bytes(), not drawable->bytes if
	"sample_marged" is TRUE.

2002-09-04  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_cmd_guides.c (make_guides_dialog): fixed 
	minor typo.

	* plug-ins/common/CML_explorer.c: minor code clean-up, removed
	cluttering frames (#92476)

2002-09-04  Dave Neary  <bolsh@picman.org>

	* app/core/picmandrawable-bucket-fill.c: Small patch to
	modify the behaviour of the bucket fill tool if there
	is an active selection. Question: Should the bucket fill
	only work if clicked inside the selection? Currently a
	click anywhere works, and stuff gets drawn if the region
	intersects the selection. This patch closes bug #72896.

2002-09-04  Michael Natterer  <mitch@picman.org>

	More color correction stuff cleanup:

	* app/base/Makefile.am
	* app/base/base-types.h
	* app/base/levels.[ch]: new files containing levels_lut_func(), a
	new "Levels" parameter struct and the "auto levels" stuff.

	* app/base/lut-funcs.[ch]: removed the levels stuff here, added
	lots of g_return_if_fail().

	* app/base/color-balance.[ch]
	* app/base/hue-saturation.[ch]: added init() and reset() functions
	so we don't need to duplicate this code in the tool and the pdb
	wrappers.

	* app/base/curves.[ch]: s/gint/PicmanHistogramChannel/g, made
	curves_channel_reset() initialize the curves array.

	* app/tools/picmancolorbalancetool.[ch]: use the new functions,
	moved the "Range" frame to the top, added a per-range "Reset"
	button, made the global "Reset" button reset all ranges and
	the "Preserve Luminosity" toggle.

	* app/tools/picmancurvestool.[ch]: don't initialize the curves
	array manually, as curves_channel_reset() does that,
	s/gint/PicmanHistogramChannel/g.

	* app/tools/picmanhuesaturationtool.c: use the new functions, added
	a per-channel "Reset" button and made the global "Reset" button
	reset all channels, cleaned up the GUI update function.

	* app/tools/picmanlevelstool.[ch]: changed to use the new Levels
	parameter struct and it's utility functions. Removed stuff
	which now lives in base/levels.c

	* app/tools/picmanimagemaptool.c: align the "Preview" button
	bottom-left, not bottom-right.

	* tools/pdbgen/pdb/color.pdb: use the new stuff and removed
	uglyness because using the "Levels" struct makes the code more
	straightforward.

	* app/pdb/color_cmds.c: regenerated.

2002-09-04  Michael Natterer  <mitch@picman.org>

	* app/gui/color-select.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox.c: removed some leftover GtkTargetEntry
	arrays.

2002-09-03  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/ppmtool.c (saveppm): merged fix for
	bug #92394 from stable branch.
	
2002-09-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.c: small speedup: use
	g_object_[get|set]_qdata() instead of g_object_[get|set]_data().

2002-09-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.c (picman_viewable_real_invalidate_preview):
	remove the attached preview pixbuf just as the preview temp_buf.

2002-09-02  Michael Natterer  <mitch@picman.org>

	DND cleanup part 1:

	* app/widgets/picmandnd.[ch]: changed all picman_dnd_*_dest_set() and
	_unset() functions to _dest_add() and _dest_remove(). Switch from
	using static arrays of GtkTargetEntries to dynamic GtkTargetLists.
	The _add() and _remove() functions configure the drag dest
	automatically if not already done, so there is no need to call
	gtk_drag_dest_set() on the widget any more. Drag source cleanup
	will follow...

	Renamed silly function names picman_gtk_* to picman_dnd_*

	* app/display/picmandisplayshell.c
	* app/tools/picmanblendtool.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox-color-area.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantoolbox.c
	* app/gui/about-dialog.c
	* app/gui/color-select.c
	* app/gui/device-status-dialog.c
	* app/gui/tool-options-dialog.c: changed accordingly. Removed
	all calls to gtk_drag_dest_set() and their GtkTargetEntry tables.

	* app/widgets/picmanchannellistitem.c: enabled some commented out
	dnd code (which will not work since dnd needs more love...)

	* app/widgets/picmanitemlistview.[ch]: added a third
	"gboolean interactive" parameter to PicmanItemNewFunc.

	* app/gui/channels-commands.[ch]
	* app/gui/layers-commands.[ch]
	* app/gui/vectors-commands.[ch]: if the new_item_func is called
	with "interactive == FALSE", don't pop up a dialog but silently
	create a new item of the image's size.

	* app/widgets/picmandrawablelistview.c: use the new feature to allow
	color and pattern drops to the "New" button, which creates a new
	layer/channel filled with the color/pattern.
	(special feature for drc ;-)

	* app/widgets/picmanpaletteeditor.c: fixed event handling so we see
	the context menu again. Also, don't redraw on "expose", since
	GtkPreview does that for us.

2002-09-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewabledialog.c: use PicmanContainerView's
	get_name_func utility stuff instead of reinventing the wheel.
	(They should probably be renamed because they are not at all
	PicmanContainerView related).

2002-09-02  Michael Natterer  <mitch@picman.org>

	* app/gui/info-window.c: don't display Alpha twice, more cleanup.

2002-09-02  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c (picman_clone_tool_draw): manually add
	the src_drawable's offsets instead of implicitly using the
	offsets of the active_drawable (fixes #92311).

2002-09-01  Michael Natterer  <mitch@picman.org>

	PicmanViewableDialogs everywhere, cleanup:

	* libpicmanwidgets/picmanstock.c: added texts for the RESIZE, SCALE
	and CROP stock items.

	* app/widgets/picmanviewabledialog.c: update the title when the
	viewable's name changes.

	* app/gui/color-notebook.[ch]: added color_notebook_viewable_new()
	which creates a PicmanViewableDialog.

	* app/widgets/picmangradienteditor.[ch]
	* app/gui/colormap-editor-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/gradient-editor-commands.c
	* app/gui/palette-editor-commands.c
	* app/undo_history.c: use PicmanViewableDialogs and the new
	color_notebook constructor.

	* app/gui/convert-dialog.c: #include "widgets/picmanviewabledialog.h"

	* app/gui/image-commands.c
	* app/gui/info-dialog.c
	* app/gui/resize-dialog.c: minor cleanups.

	* app/gui/info-window.c: cleaned up the whole thing, esp. the
	"Extended" page. Added HSV color display to the color picker
	frame.  Set the icons as frame titles, stuff...

	* app/tools/picmanimagemaptool.[ch]: removed "shell_title",
	"shell_name" and "stock_id" from the PicmanImageMapTool struct
	because they can be obtained from the tool's PicmanToolInfo object.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: changed accordingly.

	* app/tools/picmanhistogramtool.c: same here: take values from
	tool->tool_info instead of hardcoding them.

	* app/tools/picmancroptool.[ch]: removed the static crop dialog
	variables and added them to the PicmanCropTool struct. Feels safer
	and makes the callback code much simpler. Use stock items for the
	dialog's "Resize" and "Crop" buttons.

	* app/tools/picmanmeasuretool.c
	* app/tools/picmanrotatetool.c: for consistency don't name the tools
	"Blah Tool", also the dialog titles need to match the menu
	entries.

	Unrelated:

	* libpicmanwidgets/picmanwidgets.c: the recently changed, gtk-doc
	comment was correct, as gtk-doc takes the parameter names from
	the header, not the .c file.

	* app/tools/picmantransformtool.c: set the transform tool's state to
	TRANSFORM_CREATING after changing displays, so the initial matrix
	components are saved correctly for the "Reset" function.

2002-09-01  Manish Singh  <yosh@picman.org>

	* modules/Makefile.am: use AM_CPPFLAGS instead of CPPFLAGS

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c: changed deprecated calls

	* modules/colorsel_triangle.c: #undef GTK_DISABLE_DEPRECATED,
	still needs to be fixed for use of GtkPreview

2002-09-01  Michael Natterer  <mitch@picman.org>

	* app/gui/file-commands.[ch]: oops, the callback's name has
	changed too :)

2002-09-01  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: HIG compliance: changed "Save a Copy as..."
	to "Save a Copy...".

	* app/gui/file-dialog-utils.c
	* app/display/picmandisplayshell.c: changed accordingly.

2002-09-01  Michael Natterer  <mitch@picman.org>

	Refcount layer masks correctly. Fixes layer mask undo.

	* app/core/picmanlayer.c (picman_layer_add_mask): ref the mask.

	* app/xcf/xcf-load.c
	* app/gui/layers-commands.c
	* tools/pdbgen/pdb/image.pdb: unref layer masks after adding them.

	* app/pdb/image_cmds.c: regenerated.

2002-08-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanviewabledialog.[ch]: new dialog widget featuring
	a title bar containing a stock icon, a description, the viewable's
	name and a preview. Will be used for all viewable related dialogs
	and serves as a common place to control their look & feel.

	* app/tools/picmanimagemaptool.[ch]: removed the code which did
	almost the same and use PicmanViewableDialog.

	* app/gui/info-dialog.[ch]: extended the API so it has enough
	information to create a PicmanViewableDialog.

	* app/gui/channels-commands.c
	* app/gui/convert-dialog.c
	* app/gui/gradient-editor-commands.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/resize-dialog.c
	* app/gui/vectors-commands.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: use PicmanViewableDialogs

	* themes/Default/gtkrc: apply the dialog style to "*Picman*Dialog*",
	not only "*PicmanDialog*" so it covers PicmanViewableDialog.

2002-08-31  James Henstridge  <james@daa.com.au>

	* libpicman/picman.c (picman_run_procedure): handle PICMAN_PDB_COLOR
	correctly.  This fixes picman_palette_set_{back,fore}ground.

2002-08-29  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/lib.pl: fix minor buglet that earlier perls silently
	ate.

2002-08-29  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: added check_funcs (PICMAN_IS_LAYER,
	PICMAN_IS_IMAGE etc.) to all data types which are looked up by ID...

	* tools/pdbgen/app.pl: ...and call them here instead of just
	checking for (item != NULL). This way image item lookup becomes
	type safe.

	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/transform_tools_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2002-08-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c: fixed wrong g_return_if_fail() in
	picman_channel_feather() so the function can be called again (fixes
	#91923). Also added more g_return_if_fail() where they were
	missing and cleaned up everything a bit.

2002-08-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.c: removed unused #define cruft.

2002-08-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanimagemaptool.[ch]: added a tool icon and
	descriptive string to the dialog's title box. Create the
	drawable preview with is_popup == TRUE so it doesn't show
	layers in the image context. Still not perfect...

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: Chain up early in initialize()
	and return if gdisp == NULL. Set stock_id and desc_text so
	PicmanImageMapTool can display them. Added lots of mnemonics
	(#80804). Use picman_size_entry_new() instead of manually creating
	the slider+spinbutton stuff.

	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.c: changed widgets packing to make them
	resizable without strange effects. Put the "Load", "Save" and
	"Auto" buttons into a frame.

	* app/tools/picmanhuesaturationtool.c: use PicmanColorAreas instead of
	deprecated GtkPreviews. Arranged the color previews and their
	radio buttons as a color wheel. Not the best solution maybe but
	IMHO better than the old GUI.

2002-08-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandrawablepreview.c (picman_drawable_preview_render):
	look at drawable->offset_[xy] != 0 when deciding whether to offset
	the preview. Fixes bug where layers of the size of the image were
	previewed with offset (0,0), regardless of their real offset.

2002-08-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanchannellistview.c: removed all component item
	signal handling code, which is cool...

	* app/widgets/picmancomponentlistitem.c: ...and added it here, which
	is not so cool because it adds Extra Ugliness (TM). At least it
	fixes part one of #90967.

2002-08-28  Michael Natterer  <mitch@picman.org>

	* app/undo.c (undo_pop_layer)
	* app/core/picmanimage.c (picman_image_[add|remove]_layer): emit
	"alpha_changed" from the image if we started (or ended up)
	with an image containing one layer without alpha.

	* app/core/picmanlayer.c: use picman_container_num_children() instead
	of accessing container->num_children manually.

2002-08-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/rotate.c (rotate): check if the active drawable
	is a layer before using picman_layer functions on it.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.c (picman_image_mask_float): fixed a bug
	introduced by myself on 2001-12-13: the floating selection layer
	needs to be of the type of it's associated drawable, which may be
	different from the image's type if it is a channel or layer mask
	(fixes #91814).

2002-08-27  Manish Singh  <yosh@picman.org>

	* devel-docs/lib*/Makefile.am: add dummy all-local rules for the
	!gtk-doc case, to fix problems with some automake/make combos

	* modules/Makefile.am: use lib instead of libexec to appease automake
	1.6

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreview.[ch]: added #define for
	PICMAN_PREVIEW_MAX_BORDER_WIDTH instead of hardcoding it all over
	the place, cleanup.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/plug-ins/plug-in.c (plug_in_close,
	plug_in_handle_proc_uninstall): don't forget to g_free() the
	proc_def struct after removing a temporary procedure.

	* app/plug-ins/plug-ins.c: iterate lists with for() loops,
	cleanup.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.c: fixed wrong parameter name in
	gtk-doc comment.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.c: if a dialog constructor fails
	to return a PicmanDockable, destroy the dock we created for the
	dockable instead of leaking it. Cleanup.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemfactory.c: g_strdup(entry->help_path) if
	static_entry == FALSE.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/plug-in-menus.c: free the help string after adding
	a menu item with static_entry == FALSE.

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: changed the default text to
	"No, you can't change this text. Please DON'T report this bug."

2002-08-27  Michael Natterer  <mitch@picman.org>

	* app/base/curves.h: removed #defines and added enum CurvesType
	instead.

	* app/core/picmanchannel.c: use TRANSPARENT_OPACITY and
	OPAQUE_OPACITY instead of 0 and 255.

	* app/core/picmanlayer.c (picman_layer_create_mask): fixed inverse
	layer mask creation by setting PICMAN_CHANNEL(mask)->bounds_known to
	FALSE correctly (fixes #90982). Also optimized mask creation
	by calling picman_channel_all() and picman_channel_clear() for
	white and black masks.

2002-08-27  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c
	* app/gui/select-commands.[ch]: added a menu entry that toggles
	the QuickMask state and bound Shift-Q to it (bug #86580).

2002-08-27  Sven Neumann  <sven@picman.org>

	* autogen.sh: call 'libtoolize --version' instead of libtool.

2002-08-26  Sven Neumann  <sven@picman.org>

        * plug-ins/sel2path/sel2path.c: changed dialog name as suggested
        in bug-report #88905 and did some code cleanup while I was at it.

2002-08-26  Michael Natterer  <mitch@picman.org>

	Color correction tool chopping:

	* app/Makefile.am
	* app/image_map.[ch]: removed...

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimagemap.[ch]: ...and added here as object.

	* app/base/Makefile.am
	* app/base/base-types.h
	* app/base/color-balance.[ch]
	* app/base/curves.[ch]
	* app/base/hue-saturation.[ch]
	* app/base/threshold.[ch]: the lowlevel color correction functions
	plus their parameter structs cut out of the resp. tools.

	* app/core/core-enums.[ch]: removed PicmanTransferMode enum...

	* app/base/base-enums.[ch]: ...added it here. Also added
	PicmanHueRange for the new hue-saturation files.

	* tools/pdbgen/enums.pl
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c: regenerated.

	* app/tools/Makefile.am
	* app/tools/picmancolorbalancetool-transfer.c: removed (code went
	to base/color-balance.c).

	* app/tools/picmanimagemaptool.[ch]: added most code which was
	duplicated in subclasses. Create the dialog here with a nice title
	bar including image preview and name (fixes #66033). Added virtual
	functions map(), dialog() and reset() which need to be implemented
	by subclasses.

	* app/tools/picmanbrightnesscontrasttool.[ch]
	* app/tools/picmancolorbalancetool.[ch]
	* app/tools/picmancurvestool.[ch]
	* app/tools/picmanhuesaturationtool.[ch]
	* app/tools/picmanlevelstool.[ch]
	* app/tools/picmanposterizetool.[ch]
	* app/tools/picmanthresholdtool.[ch]: removed tons of duplicated
	code and simply implement PicmanImageMapTool's virtual functions.
	Removed all dialog structs and keep the variables in the tool
	structs. The dialogs are now created on-the-fly and destroyed when
	the tool goes away, which makes all callbacks much simpler and
	safer. Lots of GUI & code cleanup in all dialogs.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: added separate "Reset Channel"
	buttons and let the global "Reset" buttons reset all color
	channels.

	* app/tools/tools.c: the various antique foo_free() functions
	don't exist any more.

	* app/tools/picmanhistogramtool.c: removed ImageMap field from
	dialog struct (it was unused). Cleaned up dialog a bit.

	* tools/pdbgen/Makefile.am: don't scan tools/picmanhuesaturationtool.h
	for enums.

	* tools/pdbgen/pdb/color.pdb: use the new stuff from base/ and
	don't include stuff from tools/ any more.

	* app/pdb/color_cmds.c
	* app/pdb/paint_tools_cmds.c: regenerated.

2002-08-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sel_gauss.c: allow radius < 1.0 (bug #90957).

2002-08-22  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.c: a nicer tab for the selection
	dialog.

2002-08-22  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/stock-all-16.png
	* themes/Default/images/stock-none-16.png
	* themes/Default/images/stock-grow-16.png
	* themes/Default/images/stock-shrink-16.png: new icons from Jimmac.

	* themes/Default/images/Makefile.am
	* themes/Default/imagerc
	* libpicmanwidgets/picmanstock.[ch]: added them to the stock system.

	* app/gui/menus.c: use them.

	* app/widgets/picmanselectioneditor.[ch]: use the icons and added
	a "Save to Channel" button.

2002-08-22  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb
	* app/pdb/picmanrc_cmds.c (picmanrc_query_invoker): don't leak the
	result of picmanrc_value_to_str().

	* app/core/picmandrawable-preview.c (picman_drawable_preview_scale):
	use g_new0() instead of g_new() followed by memset().

	* plug-ins/script-fu/script-fu-server.c (server_log): free the
	string after logging it.

2002-08-22  Michael Natterer  <mitch@picman.org>

	* app/paint/paint.c: unref the paint info objects after adding
	them to their container.

	* app/widgets/toolbox.c: free the tooltip string after setting it.

	* app/gui/session.c: spit out the correct warning if (position x y)
	could not be parsed.

2002-08-22  Michael Natterer  <mitch@picman.org>

	* configure.in: bumped version number to 1.3.9

	* app/tools/picmanbycolorselecttool.[ch]: removed the ByColorDialog
	and cleaned up the code.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanselectioneditor.[ch]: added new widget
	PicmanSelectionEditor with same same functionality as the old
	ByColorDialog which can be open all the time (independent of the
	active tool).

	* app/widgets/picmanpreview.[ch]: added picman_preview_new_by_type()
	so previews can be created without a viewable.

	* app/widgets/picmanpreview-utils.[ch]: changed
	picman_preview_type_from_viewable() to
	picman_preview_type_from_viewable_type().

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c: register the new dialog type.

2002-08-22  Michael Natterer  <mitch@picman.org>

	* app/undo.c: compress emissions of "mask_changed" and
	"qmask_changed" across undo groups.

	* app/core/picmanimage-mask.c: set PICMAN_DRAWABLE(mask)->preview_valid
	to FALSE in picman_image_mask_invalidate(), not in
	picman_image_mask_push_undo(). Fixes selection preview rendering
	after a mask undo.

2002-08-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-render.c: allocate all temporary
	render bufs and check bufs large enough for PICMAN_PREVIEW_MAX_SIZE
	(which is 1024). Fixes crashes with too large navigation previews.

2002-08-22  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_main.c (save_as_csim)
	* plug-ins/imagemap/imap_object.c: applied patch for #87687 from
	shaneyfelt@juno.com

2002-08-22  Michael Natterer  <mitch@picman.org>

	Fixed usage of uninitialized memory found by valgrind,
	plus some cleanup:

	* app/base/pixel-region.[ch]: allocate PixelRegionIterators and
	PixelRegionHolders with g_new0(). Changed return values of
	pixel_regions_register() and pixel_regions_process() from gpointer
	to PixelRegionIterator*

	* app/base/pixel-processor.c: no need to cast the above return values.

	* app/base/temp-buf.[ch]: initialize PixelRegions with { 0 }
	before using them for TempBufs.

	* app/gui/device-status-dialog.c: initialize colors before
	passing them to picman_color_area_new().

2002-08-21  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_cmd_guides.c (make_guides_dialog)
	* plug-ins/imagemap/imap_settings.c (create_settings_dialog)
	* plug-ins/imagemap/imap_grid.c (create_grid_settings_dialog): replaced
	some code by default_dialog_add_table convenience func.

	* plug-ins/imagemap/imap_default_dialog.h
	* plug-ins/imagemap/imap_default_dialog.c: added convenience func 
	default_dialog_add_table.

	* plug-ins/imagemap/imap_grid.c: fixed warning for missing prototype
	of abs.

	* plug-ins/imagemap/imap_about.c: updated copyright date
	
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.h 
	* plug-ins/imagemap/imap_menu.c 
	* plug-ins/imagemap/Makefile.am
	* plug-ins/imagemap/imap_cmd_picman_guides.h
	* plug-ins/imagemap/imap_cmd_picman_guides.c: new functionality to allow
	creation of imagemap's using PICMAN guides.
	
2002-08-21  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c (menus_last_opened_add): don't g_free() static
	strings (happened if picmanrc.last_opened_size > 9, fixes #85795).

2002-08-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.c: call picman_image_mask_changed()
	after performing the selection op.

2002-08-20  Sven Neumann  <sven@picman.org>

	* Made 1.3.8 release.

2002-08-20  Sven Neumann  <sven@picman.org>

	* data/misc/Makefile.am: don't use the automatic variable $<
	(seems to work with GNU make only).

	* NEWS: updated.

2002-08-20  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanfuzzyselecttool.c: namespace cleanup.

2002-08-20  Michael Natterer  <mitch@picman.org>

	Make sure the selection (picmanimage-mask.c) functionality is really
	built *on top* of the PicmanChannel functionality:

	* app/undo.[ch]: renamed undo_push_image_mask() to
	undo_push_mask() and generalized it's API to take a PicmanChannel
	param so undos can be pushed for channels which are not the
	image's selection. Simplified the API and added code which copies
	the region of interest instead of leaving this to callers.

	* app/undo_types.h: s/IMAGE_MASK_UNDO/MASK_UNDO/

	* app/undo_history.c: changed accordingly.

	* app/core/picmanchannel.[ch]: don't #include "picmanimage-mask.h".
	Changed picman_channel_push_undo() to really push a channel undo,
	not a selection undo. Added "gboolean push_undo" params to all
	functions which are called from picmanimage-mask.c. Various cleanups
	and optimizations. Added /*< proxy-foo >*/ stuff to the header so
	we export just the struct itself to libpicmanproxy. Added accessors
	picman_channel_[get|set]_show_masked().

	* app/core/picmanimage-mask.[ch]: renamed picman_image_mask_undo() to
	picman_image_mask_push_undo(). Call it before calling PicmanChannel
	functions which modify the mask, also call all PicmanChannel
	functions with push_undo = FALSE. Emit picman_image_mask_changed()
	after each operation instead of calling it in
	picman_image_mask_invalidate(). Removed picman_image_mask_none()
	because it is the same as picman_image_mask_clear().
	General cleanup.

	* app/core/picmanimage-mask-select.c
	* app/core/picmanimage-qmask.c: changed accordingly.

	* app/core/picmanedit.c: call picman_image_mask_clear(), not
	picman_channel_clear (picman_image_get_mask()).

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c: call picman_image_mask_changed()

	* app/gui/channels-commands.c
	* app/gui/select-commands.c
	* app/tools/picmantexttool.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/selection.pdb: follow PicmanChannel and
	picman_image_mask* API changes.

	* app/pdb/channel_cmds.c
	* app/pdb/selection_cmds.c
	* libpicmanproxy/picmanchannel.h: regenerated.

	Unrelated:

	* app/core/picmanimage.c: call picman_drawable_push_undo() instead of
	undo_push_image() directly.

2002-08-18  Manish Singh  <yosh@picman.org>

	* autogen.sh: remove bashism (function keyword)

2002-08-18  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gif.c: removed GTK_ENABLE_BROKEN and _DEPRECATED
	#defines and #includes because this plug-in has already been
	ported.

2002-08-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c: fixed warning, coding style.

2002-08-09  Kelly Martin  <kmartin@pyrzqxgl.org>

	* app/tools/picmanposterizetool.c (picman_posterize_tool_register):
	fixed typo.

2002-08-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmagnifytool.[ch]: reverted Dave's change
	since this feature has already been implemented properly
	(and configurable) last December.

2002-08-05  Dave Neary  <bolsh@picman.org>

	* app/tools/picmanmagnifytool.[ch]: Require a minimum
        movement in the X and Y direction before we zoom in
        on/out to the dragged square. Limit rather arbitrarily
        set to 5. This fixes bug #86939, reported by
        philipj@telia.com.

2002-08-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c: merged fix for bug #89825 from
	stable branch.

2002-08-04  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/decompose.c: Add RGBA as a decompose target.

2002-08-03  Manish Singh  <yosh@picman.org>

	* configure.in: make sure -lm is in $LIBS for the finite/isfinite
	test, fixes issues on newer FreeBSD

	* plug-ins/common/jpeg.c: cast statbuf.st_size to glong for
	g_snprintf

2002-08-03  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/Makefile.am (EXTRA_DIST): removed *.xpm files for
	which we now use GTK stock icons
	* plug-ins/imagemap/edit.xpm
	* plug-ins/imagemap/preferences.xpm: removed these pixmaps since we now
	use stock icons for those.

	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/imagemap/imap_browse.c: replaced a few deprecated GTK 
	function calls.

2002-08-02  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_main.h
	* plug-ins/imagemap/imap_menu.c 
	* plug-ins/imagemap/imap_menu.h 
	* plug-ins/imagemap/imap_tools.c
	* plug-ins/imagemap/imap_tools.h: started implementation of fuzzy 
	select:  you can now click on a more or less contiguous region and the 
	plug-in will automatically create an object (circle, rectangle or 
	polygon)

2002-08-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_object.c (object_list_write_csim)
	* plug-ins/imagemap/imap_main.c (save_as_csim)
	* plug-ins/imagemap/imap_polygon.c (polygon_write_csim)
	* plug-ins/imagemap/imap_rectangle.c (rectangle_write_csim) 
	* plug-ins/imagemap/imap_circle.c (circle_write_csim): lowercased tags 
	as described in #87687. Still a few more changes to be made.

2002-07-22  Sven Neumann  <sven@picman.org>

	* themes/Default/imagerc: applied a patch from Guillermo S. Romero
	that updates the example imagerc.

2002-07-11  Sven Neumann  <sven@picman.org>

	* configure.in: bumbed version number to 1.3.8.

	* app/core/picmancontainer.c: use gulong for signal handler IDs.

2002-07-09  Sven Neumann  <sven@picman.org>

	Merged bug-fixes from the stable branch:
	
	* plug-ins/common/papertile.c: bug #86868.

	* plug-ins/common/tileit.c: bug #86637.

	* plug-ins/common/xpm.c: bug #87588.

	* plug-ins/print/print.c: bug #87428.

2002-07-08  Zbigniew Chyla  <cyba@gnome.pl>

	i18n fixes

	* plug-ins/script-fu/script-fu.c (script_fu_query): Pass
	"picman14-script-fu" to picman_plugin_domain_register
	(not "picman-script-fu").

	* libpicman/libpicman-intl.h: s/picman-libpicman/picman14-libpicman/

	* libpicmanwidgets/picmanstock.c (picman_stock_items[]): ditto

2002-06-29  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/papertile.c (open_dialog): Added mnemonics (#80804)
	(filter): replaced picman_pixel_rgn_get/set_row's to get/set complete 
	image in/from buffer with one picman_pixel_rgn_get/set_rect.

	* plug-ins/common/xpm.c (save_dialog): Added mnemonics (#80804) plus
	some minor code cleanup.

2002-06-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiler.c: converted Make Seamless plug-in so it now 
	uses a tile iterator. It's now about 10 times faster than the original
	implementation. Also includes fix for #67686 which was caused by
	rounding error in integer calculations.

2002-06-27  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.[ch]: removed gdisp->scale,
	gdisp->dot_for_dot, the scaling marcos and the
	gdisplay_[un]transform[_f]() functions.

	* app/display/picmandisplayshell.[ch]: added them here. Named the
	transform functions picman_display_shell_[un]transform_xy[_f]().

	Made the picman_display_shell_[un]transform_coords() functions copy
	all values of the PicmanCoords struct, not just x and y.

	* app/display/picmanstatusbar.[ch]: keep a pointer to
	PicmanDisplayShell, not PicmanDisplay.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmannavigationview.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/select-commands.c
	* app/gui/view-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanvectortool.c: changed accordingly.

	* app/gui/layers-commands.c: if(gimage->selection_mask) is always
	TRUE, use if(!picman_image_mask_is_empty(gimage)) instead.

	* app/tools/picmanfuzzyselecttool.[ch]: moved global variables
	to the object struct.

2002-06-25  Simon Budig  <simon@picman.org>

	* docs/Wilber.svg: Fixed the SVG so that the Adobe Plugin
	displays it correctly (the "fill" property defaults to black)

2002-06-25  Mel Boyce  <syngin@picman.org>

	* plug-ins/helpbrowser/helpbrowser.c: Changed HTML for the
	"Document not found" error to come in to line with PICMAN-Help-2 style.

2002-06-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/pix.c: changed a confusing comment, minor cleanup.

2002-06-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tiler.c (tile): minor optimizations and code
	cleanup.

	* plug-ins/common/AlienMap.c: added mnemonis (#80804) plus minor
	code cleanup.

	* plug-ins/common/pix.c: minor code cleanup: g_new should have a 
	matching g_free instead of free

2002-06-24  Sven Neumann  <sven@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c (dialog_search_callback):
	cleaned up after myself. There's no need to sort the store twice.

2002-06-23  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicmancolor/picmanrgb.c (picman_rgb_min)
	* libpicmancolor/picmanrgb.c (picman_rgb_max): don't use macro calls inside
	a macro call to avoid double evaluation.

2002-06-23  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/lic.c: started code clean-up. This plug-in is still
	painfully slow.

	* plug-ins/common/lic.c (create_main_dialog): Added mnemonics (#80804) 
	to dialog.

2002-06-23  Marco Wessel  <marco@phoenix.uzaynet.nl> 

	* plug-ins/script-fu/scripts/tileblur.scm: switch horizontal and
	vertical blurring. They were reversed. (Tuomas noticed this.)
	
2002-06-21  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/AlienMap2.c: replace plug-ins hsl_to_rgb and 
	rgb_to_hsl routines by libcompcolor routines (picman_hsl_to_rgb and 
	picman_rgb_to_hsl). Added mnemonics (#80804) to dialog.

	* libpicmancolor/picmancolorspace.c (picman_hsl_to_rgb): implemented correct
	algorithm for this conversion (taken from "Fundamentals of Interactive
	Computer Graphics by Foley and van Dam).

2002-06-21  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* data/misc/Makefile.am: added some files to DISTCLEANFILES
	(bug #86086).

2002-06-20  Michael Natterer  <mitch@picman.org>

	Fixed color picking (reported by jimmac on #picman):

	* app/core/picmanimage-pick-color.c: set the returned color's alpha
	value to opaque if the drawable we pick from has no aplha.

	* app/tools/picmancolorpickertool.c: ignore all values returned by
	picman_image_pick_color() if it returns FALSE (which happens if we
	want to pick outside the drawable).

2002-06-19  Michael Natterer  <mitch@picman.org>

	Fix for #85202:

	Updating the active tool's modifier state on GDK_ENTER_NOTIFY and
	GDK_LEAVE_NOTIFY was a bad idea because this only works with
	focus-follows-mouse.  Instead, update it during the whole time the
	canvas can receive key events, namely from FOCUS_IN until
	FOCUS_OUT. As an ugly side condition, click-to-focus leads to
	GDK_BUTTON_PRESS arriving before GDK_FOCUS_CHANGE(in).

	* app/display/picmandisplayshell-callbacks.[ch]: removed the
	separate focus_in and focus_out callbacks and handle them in
	picman_display_shell_canvas_tool_events(). Moved tool state updating
	from the ENTER/LEAVE code to FOCUS_CHANGE. Added an ugly static
	variable "button_press_before_focus" and take care of the side
	condition mentioned above.

	* app/display/picmandisplayshell.c: changed accordingly.

2002-06-19  Maurits Rijk  <maurits@linux.local>

	* plug-ins/imagemap/imap_preview.c (arrow_cb): minor layout changes.
	
	* plug-ins/imagemap/imap_object.c (object_get_icon): 
	* plug-ins/imagemap/imap_selection.c (selection_update): quick and
	dirty fix for now. Should be replaced as soon as GtkCList is replaced
	by GtkTreeView.

	* plug-ins/imagemap/imap_cmd_move_sash.c (move_sash_command_new): fixes
	#84726 (Imagemap plugin crashes regularly).

2002-06-19  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/fractaltrace.c (dialog_show): enable mnemonics

	* plug-ins/common/blur.c (blur_prepare_row): function caused a 
	"assertion `y >= 0 && y < pr->drawable->height' failed" in 
	picman_pixel_rgn_get_row.
	
2002-06-18  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/Makefile.am (EXTRA_DIST): removed *.xpm files for
	which we now use GTK stock icons
	* plug-ins/imagemap/open.xpm
	* plug-ins/imagemap/save.xpm
	* plug-ins/imagemap/zoom_in.xpm
	* plug-ins/imagemap/zoom_out.xpm: removed these pixmaps since we now
	use stock icons for those.

2002-06-18  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/align_layers.c (align_layers_dialog): enable 
	mnemonics, minor code cleanup.

	* plug-ins/imagemap/imap_file.c (create_file_error_dialog): added stock
	warning icon to error dialog.

	* plug-ins/imagemap/ChangeLog: removed since it wasn't up-to-date and
	changes to the plug-in are logged in _this_ ChangeLog.
	
2002-06-17  Sven Neumann  <sven@picman.org>

	Obviously I disagree with Tim about the symbol_name parameter in
	g_scanner_unexp_token(). As it seems it's not supposed to be used
	to tell the user about the expected symbol (see bug #81850):

	* picmanconfig.[ch] (picman_config_deserialize_return): removed the
	symbol_name parameter.

	* app/config/picmanconfig-deserialize.c
	* app/core/picmancontainer.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c: changed the callers accordingly.

	* app/core/picmanunits.c (picman_unitrc_load): pass NULL as symbol_name
	to g_scanner_unexp_token().
	
2002-06-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-server.c (read_from_client): merged
	fix for bug #85573 from stable branch. We should port this stuff
	to use GIOChannels.

2002-06-17  Michael Natterer  <mitch@picman.org>

	Separated tool_options creation from tool registration so we
	don't implicitly create widgets before gui_init():

	* libpicmantool/picmantooltypes.h: removed PicmanToolOptionsNewFunc
	typedef here...

	* app/core/core-types.h: ...and added it here.

	* libpicmanproxy/picmanproxytypes.h: regenerated.

	* app/core/picmantoolinfo.[ch]: added a PicmanToolOptionsNewFunc
	pointer to remember the constructor. Fixed the finalize() method
	(bug was never noticed because we leaked all tool infos)

	* app/tools/tool_manager.[ch]: moved tool_options creation to the
	new function tool_manager_restore(). Unref the tool infos after
	adding them to their container. Added "brush" and "gradient" to
	the context properties which are defined for tool contexts.

	* app/app_procs.c: call tool_manager_restore() after gui_init().

	* app/gui/gui.c: removed the hack introduced recently and call
	render_setup() in gui_init() again, not in gui_themes_init().

	Use the correct contexts now that they are properly initialized
	at the time of tool_options creation:

	* app/tools/picmanblendtool.c: use tool_info->context, not
	picman_get_user_context() to get/set the tool's gradient.

	* app/paint/picmanpaintcore.[ch] (picman_paint_core_start): added a
	PicmanPaintOptions paramater and get the brush to use from
	paint_options->context (instead of picman_get_current_context()).

	* app/paint/picmanpaintcore-stroke.c
	* app/tools/picmanpainttool.c: changed accordingly.

	* app/tools/paint_options.c: added a brush preview to the paint
	options.

2002-06-16  Michael Natterer  <mitch@picman.org>

	Fix for #85201:

	* app/tools/picmanfliptool.c: set the toggle_cursor correctly.

	* app/tools/picmantransformtool.c: if "use_grid" is FALSE, skip the
	cursor update stuff and chain up directly.

	Misc tool->control options fixes:

	* app/tools/picmanpainttool.c: set "motion_mode" to
	PICMAN_MOTION_MODE_EXACT.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmansmudgetool.c: don't touch "motion_mode" here.

	* app/tools/picmanimagemaptool.c
	* app/tools/picmantransformtool.c: set "scroll_lock" to TRUE and
	"preserve" to FALSE.

	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: don't touch them here.

	* app/tools/picmanhistogramtool.[ch]: derive it from PicmanImageMapTool
	so it inherits it's control settings.

	* app/tools/picmanellipseselecttool.c: don't set "preserve" to TRUE.

	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c: code formating paranoia.

	* app/tools/picmantoolcontrol.c: fixed indentation.

2002-06-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanblendtool.c: set the witdh of the gradient preview
	to 96 instead of 128 pixels so it is not the widest tool options
	item with the "small" theme.

2002-06-16  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanstock.[ch]: register the new "invert" and
	"layer to imagesize" PNGs as stock icons.

	* app/gui/menus.c: use them here.

	* themes/Default/images/Makefile.am: fixed indentation.

2002-06-16  Sven Neumann  <sven@picman.org>

	* app/gui/menus.c: use the new paste icons in the menu.

2002-06-15  Jakub Steiner <jimmac@ximian.com>

	replaced
	* themes/Default/images/stock-swap-colors-16.png:
	with
	* themes/Default/images/stock-swap-colors-12.png:

	eek, now I know why the wicked 12x12 size ;)

	* libpicmanwidgets/picmanstock.c: 
	* themes/Default/images/Makefile.am: 
	* themes/Default/images/stock-icons.list: updated
	
2002-06-15  Jakub Steiner <jimmac@ximian.com>
	
	added:

	* themes/Default/images/stock-invert-16.png: color invert
	* themes/Default/images/stock-layer-to-imagesize-16.png: 
	* themes/Default/images/stock-swap-colors-16.png:

	replaced:

	* themes/Default/images/stock-convert-rgb-16.png:
	* themes/Default/images/stock-paste-16.png:
	* themes/Default/images/stock-paste-as-new-16.png:
	* themes/Default/images/stock-paste-into-16.png:

	  removed themes/Default/images/stock-swap-colors-12.png: replaced
	  by *-16.png

	* themes/Default/images/Makefile.am: updated icons
	* themes/Default/images/stock-icons.list: updated
	* libpicmanwidgets/picmanstock.c: replaced stock_swap_colors
	
2002-06-14  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/shift.c: #84588 (use standard size entry widget
	for 'Shift Amount').

2002-06-14  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_cmd_unselect.c
	* plug-ins/imagemap/imap_cmd_select.c
	* plug-ins/imagemap/imap_rectangle.c: Fix for #71478 (Imagemap 
	plug-in does not draw some rectangles correctly)

2002-06-14  Sven Neumann  <sven@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c: made the DBBrowser dialog
	at least a little bit useable.

2002-06-13  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/wind.c (dialog_box): enable mnemonics, minor code
	cleanup.

	* plug-ins/common/tga.c (save_dialog): 
	* plug-ins/common/ripple.c (ripple_dialog)
	* plug-ins/common/whirlpinch.c (whirl_pinch_dialog)
	* plug-ins/common/png.c (save_dialog): enable mnemonics

2002-06-13  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* app/core/picmanimage-new.c :replaced memcpy by structure assignment.

	* plug-ins/common/gqbist.c (dialog_create): enable mnemonics, 
	replaced several memcpy's by structure assignment, pass structure 
	variable by reference iso value.

	* plug-ins/common/curve_bend.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/spheredesigner.c replaced memcpy by 
	structure assignment

2002-06-13  Sven Neumann  <sven@picman.org>

        * plug-ins/common/unsharp.c: merged fix for bug #83420 from stable
	branch.

2002-06-13  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/plug-in/plug-in.c (plug_in_init_shm): allocate shared memory
	segments with permissions 0600 instead of making them accessible
	by everyone.

2002-06-12  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.[ch]: applied a patch from Henning
	Makholm <henning@makholm.net> that vastly improves drawing of thin
	lines. See bug #69773 for a detailed description.

2002-06-12  Sven Neumann  <sven@picman.org>

	* app/base/tile-swap.c: use off_t to handle file offsets (#74478).

2002-06-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreview.c (picman_preview_size_allocate): center
	the preview's allocation.

	* app/tools/picmanblendtool.c (blend_options_new): use a button for
	the gradient so it's more obvious that it can be pressed.

2002-06-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmandata.[ch]: added a boolean "internal" which
	indicates that the data object is an automatically created
	internal object. Changed the code to refuse saving or deleting
	internal objects.

	* app/core/Makefile.am
	* app/core/picman-gradients.[ch]: new files implementing internal
	gradients (FG -> BG in RGB and HSV and FG -> transparent).

	* app/core/picman.c: call picman_gradients_init().

	* app/core/picmandatafactory.c (picman_data_factory_data_free): don't
	free internal objects so they stay there on "Refresh".

	* app/core/picmandatalist.c: sort internal objects to the beginning
	of the list.

	* app/widgets/picmandataeditor.c: refuse to change the name of
	internal objects.

	* app/widgets/picmandatafactoryview.c: set the "Delete" button
	insensitive for internal objects.

	* app/widgets/picmangradienteditor.c: refuse to edit internal
	gradients, just display them so color picking works.

	* app/gui/brushes-commands.c
	* app/gui/gradients-commands.c
	* app/gui/palettes-commands.c
	* app/gui/patterns-commands.c: set the "Delete" menu item
	insensitive for internal objects.

	* app/gui/gui.c: need to call render_setup() earlier because of
	you-dont-want-to-know-why. Will change it back once the previews
	have their own render buffers.

	* app/tools/picmanblendtool.c: Replaced the "Type" menu by a preview
	showing the active gradient. Clicking the preview pops up the
	gradient selection. Renamed the "Gradient" menu to "Shape". Removed
	"blend_mode" from the BlendOptions struct because we always use
	"custom" mode now.

2002-06-11  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/helpbrowser.c: implemented anchor handling.
	Load remote URLs by calling the webbrowser plug-in.

2002-06-11  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/paint-funcs/Makefile.am: fixed my fix for automake-1.6 (#84514).

2002-06-10  Sven Neumann  <sven@picman.org>

	* HACKING: suggest to use the stable branches of gtk+ and friends.

2002-06-10  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/uri.[ch]: added new files that implement
	conversion of a relative URI and an absolute base URI to a new
	absolute URI according to RFC 2396. This code has been kindly
	provided by Jacob Schroeder <jacob@convergence.de>.

	* plug-ins/helpbrowser/helpbrowser.c: more work on the help
	browser using the new URI functions. Still work in progress.
 
2002-06-09  Michael Natterer  <mitch@picman.org>

	* themes/Default/imagerc
	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.[ch]: register the new "Swap" and
	"Default" icons in "menu" size.

	* app/gui/menus.c: use them here.

	* app/widgets/picmantoolbox-color-area.c: changed accordingly.

2002-06-09  Michael Natterer  <mitch@picman.org>

	Paint cleanup:

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/tools/picmanblendtool.c: made all *_motion() functions take
	only (paint_core, drawable, paint_options) and get all parametrs
	from looking at paint_options. Reordered functions to be
	consistent. Indentation. Stuff...

	* app/paint/picmandodgeburn.[ch]: moved the PicmanLut from
	PicmanDodgeBurnOptions to the PicmanDodgeBurn object struct.

	* app/paint/picmansmudge.[ch]: moved all global variables to the
	PicmanSmudge object struct.

2002-06-09  Sven Neumann  <sven@picman.org>

	* app/undo.c
	* app/config/picmanconfig-deserialize.c
	* app/core/picmanbrushpipe.c
	* app/core/picmancontainer.c
	* app/core/picmanimagefile.c
	* app/gui/paths-dialog.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmangradienteditor.c: unified translatable strings
	and unmarked a few for translation since they should never be seen.

2002-06-08  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/shift.c (shift_dialog)
	* plug-ins/common/newsprint.c (newsprint_dialog)
	* plug-ins/common/bumpmap.c (bumpmap_dialog)
	* plug-ins/common/polar.c (polarize_dialog)
	* plug-ins/common/cubism.c (cubism_dialog): enable mnemonics

2002-06-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox-color-area.[ch]: use stock pixbufs to
	draw the "Default Colors" and "Swap Colors" buttons.

	* app/widgets/picmantoolbox.c: changed accordingly.

	* pixmaps/Makefile.am
	* pixmaps/default.xpm
	* pixmaps/swap.xpm: removed these pixmaps.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-default-colors-12.png
	* themes/Default/images/stock-swap-colors-12.png: added them as stock
	icons.

	* libpicmanwidgets/picmanstock.[ch]: register the new stock icons.

2002-06-08  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_get_brush_mask): applied
	patch from Henning Makholm <henning@makholm.net> that fixes wrong
	brush opacity (bug #84538).

2002-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: ported to the GTK+-2.0 API.

2002-06-08  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/paint-funcs/Makefile.am: automake-1.6 seems to use yet another
	variable to pass flags to the assembler (bug #84514). Define
	AM_CCASFLAGS like AM_ASFLAGS to satisfy all versions of automake.

	* configure.in
	* all Makefiles: removed STRIP_BEGIN and STRIP_END since it's a
	GNU make extension that we don't really need and newer versions of
	automake don't seem to like it.

2002-06-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlist.[ch]: added picman_list_reverse().

	* app/core/picmandocumentlist.c: call it after deserializing so we
	don't reverse the history each time.

	* app/widgets/picmandevices.c: use it instead of manually fiddling
	with list->list.

2002-06-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: renamed picman_drawable_apply_image()
	to picman_drawable_push_undo() because that's what it actually does.

	* app/image_map.c
	* app/core/picmandrawable-offset.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmaninktool.c: changed accordingly. Removed redundant
	comments because it's now obvious what the function does from
	looking at its name.

	* app/core/picmandrawable.[ch]
	* app/core/picmanimage.h: renamed "gboolean undo" parameters to
	"gboolean push_undo".

2002-06-06  Michael Natterer  <mitch@picman.org>

	* libpicmanproxy/picmanchannel.h: forgot to commit this one.

2002-06-06  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-deserialize.c: #include "picmanscanner.h"

2002-06-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch] (picman_channel_invert): added a boolean
	"push_undo" parameter.

	* app/core/picmanimage-mask.c
	* app/core/picmanimage-qmask.c: pass push_undo == TRUE.

	* app/core/picmanlayer.c (picman_layer_create_mask): call
	picman_channel_invert(), not picman_drawable_invert() because the
	latter takes the current selection into accout (reported by Jimmac
	on #picman). Added g_return_if_fail() stuff to all public functions.
	Cleanup.

2002-06-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c (picman_container_get_child_by_index):
	don't warn if an out-of-bounds index is passed in but simply
	return NULL (removes the need to check if the container has 0
	children before asking the container for it's first child).

2002-06-06  Sven Neumann  <sven@picman.org>

	* INSTALL: added FreeType2 URL and suggest to use GNU make.

	* configure.in: improved output in case of missing PangoFT2.

2002-06-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectselecttool.c: fixed #84157: allow the tool to
	scroll the display. Also preserve it on drawable changes.

2002-06-04  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-blend-22.png: was too
	  big
	* themes/Default/images/stock-linked-20.png: 
	* themes/Default/images/stock-eye-20.png: prettier IMHO

2002-06-04  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.[ch]: i don't know what i was
	thinking, but PicmanPaintOptions.context *is* used, sorry...

2002-06-04  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.[ch]: removed
	PicmanPaintOptions.context because it was unused.

2002-06-02  Michael Natterer  <mitch@picman.org>

	* app/gui/session.c: parse sessionrc using GScanner.

	* app/config/picmanscanner.[ch]: added utility function
	picman_scanner_parse_string_list(). Fixed the color parser's parse
	error detection.

	* app/picmanrc.c: removed the sessionrc parsing stuff.

	* app/config/picmanconfig-params.c (picman_param_spec_color): no need
	to set the param_spec's value_type, it already gets set by it's
	base class' instance_init() function.

2002-06-02  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tile.c (tile_dialog)
	* plug-ins/common/jigsaw.c (dialog_box)
	* plug-ins/common/diffraction.c (diffraction_dialog): enable mnemonics

	* plug-ins/flame/flame.c (dialog): add mnemonics and slight 
	reorganization of dialog (now uses a notebook with 2 pages instead of
	one clunky dialog).

2002-06-02  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_about.c: bumped version number to 2.0

	* plug-ins/imagemap/imap_browse.[ch]: use GTK_STOCK_OPEN stock icon

	* plug-ins/imagemap/imap_default_dialog.c: added apply stock icon

	* plug-ins/imagemap/imap_popup.c
	* plug-ins/imagemap/imap_selection.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_menu_funcs.c: enable mnemonics in menus and
	use stock icons whenever possible.

	* plug-ins/imagemap/Makefile.am
	* plug-ins/imagemap/copy.xpm
	* plug-ins/imagemap/cut.xpm
	* plug-ins/imagemap/paste.xpm
	* plug-ins/imagemap/delete.xpm
	* plug-ins/imagemap/undo.xpm
	* plug-ins/imagemap/redo.xpm: removed since we now use stock icons.
	
2002-06-02  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/Makefile.am: added imap_stock.[ch]

	* plug-ins/imagemap/imap_circle.[ch]
	* plug-ins/imagemap/imap_cmd_guides.[ch]
	* plug-ins/imagemap/imap_edit_area_info.[ch]
	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_menu_funcs.[ch]
	* plug-ins/imagemap/imap_misc.[ch]
	* plug-ins/imagemap/imap_object.[ch]
	* plug-ins/imagemap/imap_polygon.c
	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/imagemap/imap_rectangle.[ch]
	* plug-ins/imagemap/imap_settings.[ch]
	* plug-ins/imagemap/imap_table.[ch]
	* plug-ins/imagemap/imap_toolbar.c
	* plug-ins/imagemap/imap_tools.[ch]: lots of changes to update plug-in 
	for GTK-2.0 such as removal of deprecated widgets and function calls 
	and use of stock icons.

	* plug-ins/imagemap/imap_stock.[ch]: new files

	* plug-ins/imagemap/imap_main.c: initialize stock icons

2002-06-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/imagemap/imap_preferences.[ch]
	* plug-ins/imagemap/imap_table.c: enable mnemonics

	* plug-ins/imagemap/imap_grid.[ch]: Add mnemonics to dialog and added 
	option to couple Width/Height and Left/Top offset in grid with 
	PicmanChainButton.

	* plug-ins/imagemap/imap_tools.c (make_tools)
	* plug-ins/imagemap/imap_selection.c (make_selection_toolbar)
	* plug-ins/imagemap/imap_toolbar.c (make_toolbar): set style to only 
	show icons (GTK_TOOLBAR_ICONS).

	* plug-ins/imagemap/imap_object.[ch] (object_on_button_press): event 
	function now returns boolean value.

	* plug-ins/imagemap/imap_main.c (dialog): removed some obsolete code 
	that caused strange startup size of plug-in.

2002-06-01  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/convmatrix.c: enable mnemonics and removed some
	global variables.

	* plug-ins/mosaic/mosaic.c (mosaic_dialog): 
	* plug-ins/common/nova.c (nova_center_create)
	* plug-ins/common/nlfilt.c (mw_preview_new)
	* plug-ins/common/noisify.c (noisify_dialog)
	* plug-ins/common/borderaverage.c (borderaverage_dialog): enable 
	mnemonics

2002-05-31  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/borderaverage.c (borderaverage_dialog)
	* plug-ins/common/blur.c (blur_dialog): enable mnemonics

2002-05-31  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-blend-22.png: make it
	  more distiguishable from the transform tools
	* themes/Default/images/stock-plugin-16.png: Xtns>plugin-details
	  icon

2002-06-01  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.[ch]: removed all global variables, factored
	out duplicated code, cleanup.

2002-05-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmanpaletteeditor.c: return FALSE from button press
	event callbacks so the color drag handlers work again. Cleaned up
	the palette editor a bit.

2002-05-31  Michael Natterer  <mitch@picman.org>

	* app/paint-core/paint-core.c (combine_sub_region): this is
	getting silly: this time (maybe) really fix #83418 and #26072: of
	course the local buffer needs to take the sizes of all three
	passed in regions into account, not only two of them *sigh*

2002-05-31  Michael Natterer  <mitch@picman.org>

	* app/config/picmanscanner.[ch]: configure the scanner the same
	way PicmanConfig did (scanner->user_data is, if set, a GError).
	Added picman_scanner_parse_color(). Added "GError **error" to
	picman_scanner_new().

	* app/config/picmanconfig.c: use picman_scanner_new().

	* app/config/picmanconfig-deserialize.c: use picman_scanner_parse_color().

	* app/core/picmanunits.c
	* app/plug-in/plug-in-rc.c: changed accordingly.

	* app/plug-in/plug-in-rc.c: made the main parse loops consistent
	with the other places using GScanner.

2002-05-31  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/checkerboard.c: applied patch from Jeroen Lamain
	<roccodevinger@yahoo.com> to fix #81014 (Use size entry widget in
	Checkerboard plugin).

2002-05-30  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/displace.c (displace_dialog)
	* plug-ins/common/illusion.c (dialog): enable mnemonics

2002-05-30  Sven Neumann  <sven@picman.org>

	* Made 1.3.7 release.
	
2002-05-30  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-read.c (xcf_read_string): UTF-8 validate all strings
	and try g_locale_to_utf8() as fallback if it fails.

2002-05-30  Sven Neumann  <sven@picman.org>

	* configure.in: check for extra libraries needed for inet_ntoa() and
	socket() and define them as SOCKET_LIBS.

	* plug-ins/script-fu/Makefile.am (LDADD): added SOCKET_LIBS.

2002-05-30  Sven Neumann  <sven@picman.org>

	* configure.in: added -lX11 to LIBXMU since GTK_LIBS doesn't provide
	it for us anymore (reported by Tomas Ogren).

	* libpicmanbase/picmanenv.[ch]: declare picman_path_runtime_fix() static.

	* app/base/Makefile.am: conditionally build detect-mmx.S to avoid
	warnings about empty object files (reported by Tomas Ogren).

	* plug-ins/Makefile.am: commented out plugin-helper since it's just
	too broken to be distributed.
	
	* themes/Default/images/Makefile.am: echo -n is not portable and not
	needed, so removed it (reported by Tomas Ogren).

2002-05-30  Sven Neumann  <sven@picman.org>

	* app/gui/gui.c (gui_get_screen_resolution): do some sanity checks
	on the values returned by GDK.

2002-05-30  Sven Neumann  <sven@picman.org>

	* configure.in: bumped the version to 1.3.7.

	* tools/Makefile.am (EXTRA_DIST): include picman-mkproxy. Should fix
	bug #83455.

2002-05-29  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.c: fixed #83418, which was caused by
	my bogus "fix" for #26072 (initial_sub_region:: error :: src->w *
	(src->bytes + 1) > 512).
	The assertions were there because there were local temporary
	buffers of 512 bytes size. Now the buffers' size is
	MAX (src->width * src->bytes, dest->width * dest->bytes) which
	should be enough this time :) Re-enabled the assertions because
	of paranoia...

2002-05-29  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpencil.c: don't pass bogus [0..255] opacities to
	picman_paint_core_paste_canvas() but use gdouble values in a
	[0.0..1.0] range. Spotted by Jakub Steiner.

2002-05-29  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/Makefile.am: set include paths in AM_ASFLAGS for
	automake-1.5.

2002-05-29  Sven Neumann  <sven@picman.org>

	* Made 1.3.6 release.

2002-05-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: renamed picman_mem_size_entry_new()
	to picman_memsize_entry_new() for consistency. Rewrote using bitshifts.
	Should work correctly for sizeof (gulong) > 32 now. Added new unit
	GigaBytes.

	* app/gui/preferences-dialog.c
	* app/gui/user-install-dialog.c: changed accordingly.

	* app/config/picmanconfig-types.[ch]: added new function
	picman_memsize_set_from_string() that allows to check if the
	conversion succeeded.

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_memsize): use picman_memsize_set_from_string().

2002-05-28  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/gflare/gflare.c: enable mnemonics.

	* plug-ins/common/plasma.c (plasma_dialog)
	* plug-ins/common/snoise.c (solid_noise_dialog): enable mnemonics on 
	Random Seed widget.

2002-05-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c (picman_layer_new_from_drawable): determine
	the src_base_type from the passed drawable, not from the image it
	is attached to.

	* app/core/picmanimage-convert.c (picman_drawable_convert_rgb)
	(picman_drawable_convert_grayscale): added a check for the expected
	bpp of the passed tile_manager.

2002-05-28  Sven Neumann  <sven@picman.org>

	* app/base/base-config.[ch]
	* app/gui/user-install-dialog.c: use a gulong for the tile_cache_size.

	* app/base/tile-cache.c: cleanup, no changes.

	* app/config/picmanconfig-types.c (string_to_memsize): avoid overflows.

2002-05-28  Michael Natterer  <mitch@picman.org>

	Yes, this is a bit hackish...

	* app/widgets/picmanpreview.[ch]: added "gboolean eat_button_events"
	to enable previews which are clickable *and* let the click through
	to their parent widget.

	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmanlayerlistitem.c: set "eat_button_events" to
	FALSE whenever we set "clickable" to TRUE so the GtkListItems get
	the click and can set the active drawable.

2002-05-28  Sven Neumann  <sven@picman.org>

	* app/config/test-config.c
	* app/gui/test-commands.c: use g_error_free() so we crash if our
	PicmanConfig functions return FALSE and don't set an error.

	* app/widgets/picmandevices.c: don't warn if devicerc was not found.

	* app/gui/preferences-dialog.c: use G_MAXULONG as upper limit for
	the mem_size entries.

	* libpicmanwidgets/picmanwidgets.c (picman_mem_size_entry): use gulong
	and set the range of the spinbutton's adjustment properly.

2002-05-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-types.c: derive PICMAN_TYPE_MEMSIZE from
	G_TYPE_ULONG. Should probably be even G_TYPE_UINT64 but we use
	strtol which can only handle unsigned long int.

	* app/config/picmanbaseconfig.[ch]
	* app/config/picmanguiconfig.[ch]: changed accordingly.

	* app/config/test-config.c: use picman_config_serialize_value() to
	dump changed values to stdout.

2002-05-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c: override GObjectClass->constructor() and
	do the setup stuff there, not in picman_context_new(). This way we
	can create properly initialized contexts with g_object_new().

	* app/widgets/picmandeviceinfo.c: Removed the "picman" property
	again. Added a constructor() implementation and moved stuff there
	from picman_device_info_set_property(PROP_PICMAN).

	* app/config/picmanconfig-deserialize.c: made deserialization of
	value arrays work by actually using the array and not just leaking
	it ;)

	* app/core/picmancontainer.c: removed debugging output. Call
	config_iface->deserialize(child, ...) again instead of calling
	picman_config_deserialize_properties() directly.

	* app/widgets/picmandevices.c: switch to using the new stuff for
	devicerc.

	* app/widgets/picmandeviceinfo.[ch]
	* app/widgets/picmandevices.[ch]
	* app/picmanrc.c: removed all old picmanrc-style devicerc stuff.

	* app/gui/menus.c
	* app/gui/test-commands.[ch]: removed devicerc testing entries
	and callbacks.

2002-05-28  Sven Neumann  <sven@picman.org>

	* autogen.sh: simplified by using a function for version checks.

2002-05-28  Sven Neumann  <sven@picman.org>

	* NEWS: updated.

	* plug-ins/common/jpeg.c (background_jpeg_save): cast stat.st_size
	to gint to avoid compiler warning with large file support. This
	will fail for JPEG files > 2GB but I doubt this is a real problem.

2002-05-28  Sven Neumann  <sven@picman.org>

	* configure.in (AC_OUTPUT): fixed dist target by commenting out
	plug-ins/tools/common since it's also commented out in the Makefile
	in plug-ins/tools. Fixed broken check for sendmail.

	* plug-ins/common/mail.c: use the SENDMAIL define from config.h.

2002-05-28  Sven Neumann  <sven@picman.org>

	* autogen.sh: cleaned up, nicer output.

2002-05-27  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c (picman_config_serialize): fixed error code
	and improved error messages.

2002-05-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* libpicmanwidgets/picmanwidgets.c (picman_random_seed_new): 
	* plug-ins/common/randomize.c (randomize_dialog)
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/common/nova.c (nova_dialog)
	* plug-ins/common/sparkle.c (sparkle_dialog)
	* plug-ins/common/plasma.c (plasma_dialog)
	* plug-ins/common/waves.c (pluginCoreIA): enable_mnemonics.

2002-05-27  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/apply_lens.c (lens_dialog): call to
	picman_drawable_has_alpha iso seperate check on PICMAN_INDEXEDA_IMAGE |
	PICMAN_GRAYA_IMAGE | PICMAN_RGBA_IMAGE

2002-05-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmansizeentry.c (picman_size_entry_attach_label):
	set the spinbutton which is attached right of the label as
	mnemonic_widget for the label.

2002-05-27  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.[ch]: added "gint nest_level" to the
	deserialization functions, so nested calls to deserialize()
	don't error on the trailing ')'. Made the scanner config parse
	one-character identifiers and allow G_CSET_A_2_Z for all
	identifiers.
	Added picman_config_deserialize_return() because returning the
	correct return value from a deserialize() function is not
	trivial any more with nested calls.

	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanrc.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c: use the new return value utility
	function and made the main parsing loops simpler.

	* app/core/picmanunits.c: made the main parsing loops consistent
	with the stuff that uses PicmanConfig.

	* app/config/picmanconfig-deserialize.c 
	* app/config/picmanconfig-serialize.c: call the
	(de)serialize_property() functions only if the property's class
	implements the method itself (does *not* inherit it from one of
	it's parents).

	* app/core/picmancontainer.c: implemented deserialization of
	containers. For each child entry encountered in the input, check
	if it's already contained in the container and create it if not.
	If a "picman" pointer is passed as user_data pass it as construct
	property to g_object_new() when creating the object.

	* app/core/picmancontext.c: changed deserialization of brush,
	pattern etc. to honor "no_data".

	* app/widgets/picmandeviceinfo.c: added a "picman" construct_only
	property which overrides PicmanContext's "picman" property. Moved all
	initialisation code from picman_device_info_new() to
	picman_device_info_set_property(PROP_PICMAN) so it is properly
	performed if the object is created by PicmanContainer's
	deserialize() implementation.

	* app/widgets/picmandevices.c: made picman_devices_restore_test() work.

2002-05-27  Sven Neumann  <sven@picman.org>

	* configure.in: restructured, added lots of comments. Reenabled
	build of picman-remote.

	* app/main.c: output name and version with usage information.
	
	* docs/Makefile.am: install the picman-remote-1.3 man-page.
	
	* tools/Makefile.am: link picman-remote-1.3 to picman-remote if
	enable-default-binary was choosen at configure time.

	* tools/picman-remote.c: make it start picman-1.3 if called with the
	--new command-line option. Still the same bad hack as in 1.2 :-(

2002-05-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c: kindof fixed the channel
	dialog's component items. Had to disable keyboard navigation
	because GtkList is horribly broken with GTK_SELECTION_MULTIPLE.
	Left in lots of #if 0'ed stuff because this is not the final
	solution...

2002-05-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: "%lld" is not a portable format string,
	cast to gint64 and use G_GINT64_FORMAT instead.

2002-05-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c: use "%lld" when printing or parsing
	file sizes because AC_SYS_LARGEFILE makes off_t a long long.

2002-05-27  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh
	* configure.in: added AC_SYS_LARGEFILE as a first prerequisite to
	handle bug #74478 (cannot handle swap size of 2GB). This requires
	autoconf-2.52. Unified and documented our use of AC_DEFINE() to 
	please autoheader.

	* acconfig.h: removed since it is now obsolete.

2002-05-26  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/helpbrowser.c: made Forward button work.

2002-05-25  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/scatter_hsv.c (scatter_hsv_dialog)
	* plug-ins/common/noisify.c (noisify_dialog)
	* plug-ins/common/spread.c (spread_dialog)
	* plug-ins/common/edge.c (edge_dialog)
	* plug-ins/common/sobel.c (sobel_dialog)
	* plug-ins/common/sharpen.c (sharpen_dialog)
	* plug-ins/common/unsharp.c (unsharp_mask_dialog)
	* plug-ins/common/max_rgb.c (dialog): enable mnemonics.

	* libpicmanwidgets/picmansizeentry.c (picman_size_entry_attach_label): allow 
	underscore to be embedded in text parameter so labels can have 
	mnemonics. More work to do here.

2002-05-25  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/tileit.c: fix for #82498 (Opacity only seems to work 
	when tile is flipped). Also added mnemonics to dialog.

2002-05-25  Sven Neumann  <sven@picman.org>

	* NEWS: updated.

	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/helpbrowser/queue.[ch]: simplified user interface and
	code. Still work in progress...

2002-05-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: a first start at
	cleaning up the Script-Fu user interface.

2002-05-24  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-deserialize.c: added deserialization of
	GValueArrays (untested). Added picman_config_deserialize_value()
	which is factored out from picman_config_deserialize_property().

2002-05-24  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/film.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/tileit.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/sel2path/sel2path.c: make use of stock labels.

2002-05-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_serialize): write newline after
	serializing the properties.

	* app/config/picmanconfig.c (picman_config_string_indent): tiny
	optimization.

2002-05-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/smooth_palette.c (doit): fix for #82489 (selection 
	is ignored). Also adds mnemonics to dialog.

2002-05-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/iwarp.c (iwarp_dialog): fix for #82494 (strange 
	behaviour 'Number of Frames' entry). Also adds mnemonics to dialog.

2002-05-24  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.c (picman_config_string_indent): fixed assertion
	which did not check for indent_level >= 0 but > 0.

	* app/config/picmanconfig-serialize.c (picman_config_serialize_value):
	serialize floats with g_ascii_formatd() to be locale independed,
	added serialization of GValueArrays.

	* app/widgets/picmandeviceinfo.c: added properties for "mode",
	"axes" and "keys". Their set_property() implementations are
	untested.

2002-05-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/hot.c: let the hot filter also act on the current 
	selection (fixes #82480). Adds mnemonics to dialog.

2002-05-24  Maurits Rijk  <lpeek.mrijk@consunet.nl>

	* plug-ins/common/checkerboard.c: fix for #82499 (small typo) and also 
	adds mnemonics

2002-05-24  Sven Neumann  <sven@picman.org>

	* app/core/cpercep.[ch]
	* app/core/picmanimage-convert.c
	* app/paint-funcs/paint-funcs.c: removed C++ style comments and
	compiler warnings.

2002-05-24  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.[ch]
	* app/config/picmanconfig-serialize.[ch]: added "gint indent_level"
	to all serialization functions. Added picman_config_string_indent()
	which indents a GString.

	* app/config/picmanrc.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c: changed accordingly.

	* app/core/picmancontext.c: don't crash when serializing NULL object
	properties.

	* app/config/picmanscanner.[ch]: added picman_scanner_parse_identifier().

	* app/core/picmancontainer.c: implement PicmanConfigInterface.
	Container serialization works, deserialization is not implemented yet.

	* app/widgets/picmandevices.[ch]: made
	PicmanDeviceManager->device_info_list a PicmanList, not GList, added
	testing functions for (de)serializing it.

	* app/gui/menus.c
	* app/gui/test-commands.[ch]: call the new test functions from
	the <Toolbox>/File/Debug menu.

2002-05-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: copied some code from
	gtk+/gtk/gtkmenubar.c:window_key_press_handler() which pops up the
	<Image> menu on F10 (or whatever is configured in GtkSettings).

2002-05-22  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_query): check for PICMAN_PARAM_SERIALIZE.

2002-05-22  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig.[ch]: added virtual interface methods
	serialize_property() and deserialize_property() which can be used
	to implement (de)serialization of special properties or to
	override the default implementation.

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c: for each property, check if
	the class which added it implements the virtual functions and call
	them before trying the default implementations.

	* app/config/picmanconfig-params.h: added new macro
	PICMAN_CONFIG_INSTALL_PROP_OBJECT().

	* app/core/picmancontext.c: declare the "tool", "brush", "pattern",
	"gradient" and "palette" properties as serializable and added
	implementations of (de)serialize_property().

2002-05-21  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: need to link test-config against
	libpicmancolor now.

	* app/config/picmanconfig.c (picman_config_serialize): write newlines
	after header and before footer.

	* app/config/test-config.c
	* app/config/picmanrc.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/gui/test-commands.c: removed the newlines here.

	* app/config/picmanconfig-params.h: define PICMAN_PARAM_SERIALZE flag
	which can be used to mark an object property as serializable.
	Make the PICMAN_CONFIG_INSTALL_PROP_* macros set it.

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c: check the PICMAN_PARAM_SERIALIZE
	flag.

	* app/config/picmanconfig-params.c (picman_param_color_set_default):
	fixed.

	* app/core/picmancontext.c: install serializable properties using the
	PICMAN_CONFIG_INSTALL_PROP_* macros.

2002-05-21  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-types.[ch]: added PICMAN_TYPE_COLOR as boxed
	type encapsulating PicmanRGB.

	* app/config/picmanconfig-params.[ch]: added PicmanParamSpecColor
	which is derived from GParamSpecBoxed and adds a default value.

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c: added generic
	(de)serialization of the new property type.

	* app/core/picmancontext.c: implement the config interface, changed
	signal parameters and property types to use the new
	PICMAN_TYPE_COLOR.

	* app/core/picmanmarshal.list: added a VOID__BOXED marshaller.

	* app/gui/menus.c
	* app/gui/test-commands.[ch]: some test code which (de)serializes
	the user context.

2002-05-21  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.[ch] (picman_layer_new_from_tiles): added a
	PicmanImageType parameter to specify the desired drawable type. This
	is needed when pasting into layer masks.

	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-mask.c: changed accordingly.

2002-05-21  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.c: some more minor cleanup.

2002-05-21  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.c
	* app/widgets/picmandeviceinfo.c: write/parse the "wheel" axis
	properly when writing/parsing devicerc.

	* app/widgets/picmandevices.c: no need to #define something twice.

2002-05-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-text-console.c: somewhat cleaner
	implementation.

2002-05-17  Sven Neumann  <sven@picman.org>

	* INSTALL: documented more configure options.

2002-05-16  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanprotocol.[ch]
	* libpicmanbase/picmanwire.[ch]: pass "gpointer user_data" to all
	functions, which in turn gets passed to the registered reader,
	writer, and flusher funcs.

	* libpicman/picman.c
	* libpicman/picmantile.c: pass NULL as user_data. We have only one
	pipe on the plug-in side.

	* app/plug-in/plug-in.c: pass the PlugIn as user_data. As a
	consequence, got rid of more global variables. The global
	"current_plug_in" and the plug_in_push()/pop() madness are still
	there. Will replace them by some less ugly hack later...

2002-05-16  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: don't allow to close the splash screen. Fixes
	bug #81962.

	* plug-ins/picmanressionist/picmanressionist.c: changed button order.
	As mentioned in bug #81963 the UI of this plug-in needs some more
	work.

	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/paper.c
	* plug-ins/picmanressionist/presets.c: fixed handling of scrolled
	windows.

2002-05-16  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.c: Pass PlugIn, not Picman pointers to all
	message handler functions so they have a proper context to operate
	on. Use the PlugIn pointer passed instead of "current_plug_in".
	Removed global variables "current_readchannel" and
	"current_writechannel" because it is now always possible to use
	plug_in->my_read and plug_in->my_write.

2002-05-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c: <shift>+click toggles the active
	layer's "linked" property now.

	* themes/Default/images/stock-tool-options-16.png: new icon.

	* themes/Default/images/Makefile.am
	* themes/Default/imagerc
	* libpicmanwidgets/picmanstock.[ch]: added it to the stock system.

	* app/gui/menus.c: use it for the tool_options dialog's menu
	entries.

2002-05-15  Simon Budig  <simon@picman.org>

	* plug-ins/pagecurl/pagecurl.c: tiny fix, there was an
	ancient non working call to picman_layer_add_alpha still
	hanging around...

2002-05-15  Simon Budig  <simon@picman.org>

	* plug-ins/pagecurl/pagecurl.c: Made the pagecurl plugin
	automatically add an alpha channel. Fixes #81611.

2002-05-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c: fixed documentation.

	* app/tools/picmanpenciltool.c
	* app/tools/picmansheartool.c: assign shortcuts that don't collide with
	other tools.

2002-05-15  Michael Natterer  <mitch@picman.org>

	New feature: pressing <space> in the image window temporary
	switches to the move tool (so that releasing <space> switches back
	to the old tool).

	* app/display/picmandisplayshell.[ch]: added booleans
	shell->space_pressed and shell->space_release_pending. Connect
	more events to picman_display_shell_events() so they can be blocked
	there if needed.

	* app/display/picmandisplayshell-callbacks.c: beautified and
	uglified at the same time:

	beauty:
	- moved the checks if picman is busy or button1 is down to
	  picman_display_shell_events() so they don't clutter
	  picman_display_shell_canvas_tool_events().
	- factored tool modifer updating out to a separate function.
	- indentation/spacing cleanup.

	ugly:
	- added more static variables to track the state of <space>
	- added the actual move tool toggling code.

2002-05-15  Michael Natterer  <mitch@picman.org>

	* app/gui/splash.c
	* libpicmanproxy/picmanobject.h: reverted stuff someone
	accidentially checked in...

2002-05-15  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/tool-options.png:
	* themes/Default/images/preferences/image-windows.png:
	* themes/Default/images/preferences/display.png: 
	  unique PICMAN icons

2002-05-15  Sven Neumann  <sven@picman.org>

	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c
	* app/core/picmanunits.c: improved parser error messages. Relies on a
	fix in glib (see bug #81850). However it doesn't hurt if you don't
	have the fix.

2002-05-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.[ch]: added user_data pointer to serialize
	and deserialize methods.

	* app/config/picmanrc.[ch]: implement picman_rc_save() using
	picman_config_serialize() so it can take advantage of the file
	handling magic implemented there.

	* app/config/test-config.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c: changed accordingly.

2002-05-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.[ch]: added a return value to indicate
	success of PicmanConfigInterface::serialize. Added a PicmanConfigError
	value for write errors and check the return value of all write()
	calls. Allow to specify file header and footer when calling
	picman_config_serialize().

	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanrc.c: changed accordingly.

	* app/core/picman-documents.[ch]: new files with functions to handle
	picman->documents.

	* app/core/picmandocuments.[ch]: removed ...

	* app/core/picmandocumentlist.[ch]: ... and added under this name.
	Implements a generic document list.
	
	* app/core/picman-parasites.[ch]: new files with functions to handle
	picman->parasites.

	* app/core/picmanparasite.[ch]: removed.

	* app/core/picmanparasitelist.[ch]: nothing more than a generic
	parasite list.

	* app/undo.c
	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picman.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/gui/file-open-dialog.c
	* app/pdb/parasite_cmds.c
	* tools/pdbgen/pdb/parasite.pdb: changed accordingly.

2002-05-15  Sven Neumann  <sven@picman.org>

	* app/core/picmandocuments.c: misc small changes.

	* app/core/picmanparasite.[ch]: reduced to a small set of wrappers
	around picman->parasites.

	* app/core/picmanparasitelist.c: moved the code that reads and
	writes parasite lists ala parasiterc to this file. Added a
	PicmanConfigInterface to PicmanParasiteList.

	* app/core/picman.c: changed accordingly.

2002-05-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ps.c: reverted the last change and applied a patch
	from Peter Kirchgessner instead (closes reopened bug #81606).

2002-05-14  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h
	* app/core/picmandocuments.[ch]: made the list of recently used
	images an object derived from PicmanList that implements the
	PicmanConfigInterface.

	* app/core/picman.c
	* app/file/file-open.c
	* app/file/file-save.c: changed accordingly.

2002-05-14  Dave Neary  <bolsh@picman.org>

	* plug-ins/common/plasma.c: Added fixes for bugs #81730 and 
	#81732 from the 1.2 branch.

2002-05-14  Sven Neumann  <sven@picman.org>

	* libpicman/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmantool/Makefile.am
	* libpicmanwidgets/Makefile.am: removed unneeded CPPFLAGS.

	* libpicmanproxy/Makefile.am: ditto. Changed rules for generated files
	so that they work for parallel builds.

2002-05-14  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c: fixed error messages.

	* plug-ins/common/ps.c: applied a patch from Raphael Quinet that
	fixes bug #81606 (special-case recent Illustrator EPS brain damage).

2002-05-14  Sven Neumann  <sven@picman.org>

	* themes/Default/images/stock-wilber-eek-64.png: tweaked so the
	shadow isn't cut off at the image border. We could still need a
	better icon.

	* themes/Default/images/stock-wilber-eek.png: removed.

2002-05-13  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmath.h: removed FINITE() macro.

	* tools/pdbgen/pdb/image.pdb
	* app/pdb/image_cmds.c: define FINITE() here, where it is used.

	* tools/pdbgen/pdb/lib.pl: add "config.h" to all generated libpicman
	.c files.

	* libpicman/picman*_pdb.c: regenerated.

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanchannel.c
	* libpicman/picmandrawable.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanhelp.c
	* libpicman/picmanimage.c
	* libpicman/picmanlayer.c
	* libpicman/picmanpatternmenu.c
	* libpicman/picmanpixelrgn.c
	* libpicman/picmanproceduraldb.c
	* libpicman/picmanselection.c
	* libpicman/picmantile.c
	* libpicman/picmanui.c
	* libpicmanmath/picmanmatrix.c
	* libpicmanmath/picmanvector.c
	* plug-ins/MapObject/arcball.c
	* plug-ins/fp/fp_gdk.c
	* plug-ins/fp/fp_misc.c
	* plug-ins/ifscompose/ifscompose_storage.c
	* plug-ins/ifscompose/ifscompose_utils.c
	* plug-ins/maze/handy.c
	* plug-ins/rcm/rcm_gdk.c
	* plug-ins/sel2path/edge.c
	* plug-ins/xjt/xjpeg.c
	* plug-ins/xjt/xpdb_calls.c: include "config.h".
	
2002-05-13  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c (picman_config_serialize): serialize to a
	temporary file and rename it to the target filename when it is
	completely written.

2002-05-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparasite.c: parse parasiterc using GScanner instead
	of picmanrc.

	* app/picmanrc.c: removed the parasite parsing stuff.

2002-05-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanenummenu.[ch]: added _with_range variants for all
	enum menu widgets that limit the range of choices.

	* app/gui/file-new-dialog.c
	* app/gui/layers-commands.c
	* app/gui/preferences-dialog.c: use PicmanEnumMenus with ranges.

2002-05-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: uhh, skipping values used in the PDB
	was a bad idea. Removed the skip trigraphs again. This breaks the
	GUI; will fix it later.

	* tools/pdbgen/enums.pl: regenerated.

2002-05-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: registered PicmanFillType enum and added
	translatable names to PicmanImageBaseType.

	* app/core/picman.[ch]
	* app/core/picmanedit.c
	* app/core/picmanimage-new.[ch]: removed picman_image_new_[init|exit]()
	where we used to create names for the enums mentioned above. Dropped
	picman_image_new_set_have_current_cut_buffer() in favor of accessing
	the value directly.

	* app/gui/file-new-dialog.c (file_new_dialog_create)
	* app/gui/layers-commands.c (layers_new_layer_query): use
	PicmanEnumMenus to choose the base_type and fill_type.

2002-05-13  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.c commented out a warning in
	initial_sub_region and a g_error() in combine_sub_region which
	didn't expect to get chunks of pixels with a width of > 128
	passed. I guess it was an assertion to ensure the integrity of
	some higher level code (see picmandisplay.c:
	picman_display_idlerenderer_callback()).  The assertion went off
	whenever we wanted to render a preview with a width of > 128,
	which is however handled absolutely correctly by the two
	functions. (fixes #26072)

	* app/core/picmancontext.c (picman_context_get_by_type): unref objects
	before returning them. Fixes our biggest memleak (whole images).

	* app/display/picmandisplay-handlers.c: commented out debugging
	g_print()s which track the image's refcount.

2002-05-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmenu.c: use picman_image_get_name().

	* plug-ins/common/deinterlace.c: don't use 'O' as mnemonic, it's
	already taken by the _OK button.

2002-05-13  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c: documentation fix.

2002-05-13  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: set the view's display to NULL
	in "destroy". Fixes crash on closing the navigation dialog.

	* app/gui/dialogs-constructors.c
	* app/gui/menus.c: use PICMAN_STOCK_NAVIGATION instead of
	PICMAN_STOCK_TOOL_MOVE. Use the new PICMAN_STOCK_WARNING (see below)
	for the error console.

	* themes/Default/images/*.png
	* themes/Default/images/tools/*.png: renamed all stock icons to
	have the pixel size instead of "button" or "menu" in the name.
	(e.g. stock-menu-scale.png -> stock-scale-16.png).

	* libpicmanwidgets/picmanstock.[ch]
	* libpicmanwidgets/picmanwidgets.c
	* themes/Default/gtkrc
	* themes/Default/imagerc
	* themes/Default/images/Makefile.am: changed accordingly.

2002-05-11  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: connect to size allocations of
	the navigation preview's parent container and resize it so it
	takes all available space.

	* app/widgets/picmanpreview.[ch]: replaced magic values by public
	#defines of PICMAN_PREVIEW_MAX_SIZE and PICMAN_PREVIEW_MAX_POPUP_SIZE.
	Increased the maximum preview size to 1024. Don't call the virtual
	get_size() function if preview->viewable is NULL but call
	picman_preview_real_get_size() directly.

	* app/widgets/picmanbufferpreview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmancontainermenu.c
	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmanimagepreview.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmannavigationpreview.c: replaced magic values by
	the new costants.

2002-05-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.c: Added a comment to explain why
	the "correct" size calculation is commented out and put back the
	old buffer size so we don't crash. Made the code robust against
	whether we render only the color cells or the whole widget's
	allocation->width.

	* app/widgets/picmandialogfactory.c: Don't try to #define DEBUG(...)
	but wrap the whole g_print(...) statement in a debugging macro.

2002-05-11  Sven Neumann  <sven@picman.org>

	* libpicman/stdplugins-intl.h
	* plug-ins/script-fu/script-fu-intl.h: use the new function
	picman_locale_directory() instead of LOCALEDIR.

	* app/Makefile.am
	* plug-ins/*/Makefile.am: removed LOCALEDIR definition.

2002-05-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_radio_group_new2): applied a
	patch from Maurits Rijk that enables mnemonics (bug #80804).
	
	* plug-ins/common/blinds.c
	* plug-ins/common/deinterlace.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/destripe.c
	* plug-ins/common/emboss.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/mblur.c
	* plug-ins/common/oilify.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/struc.c: : applied patches from Maurits Rijk that
	add mnemonics (bug #80804).

	* plug-ins/common/convmatrix.c: merged fix for bug #81345 from stable
	branch.

2002-05-11  Sven Neumann  <sven@picman.org>

	* app/gui/Makefile.am: removed LOCALEDIR definition ...

	* libpicmanbase/Makefile.am: ... and added it here.

	* app/widgets/picmandnd.c: corrected pointer arithmetic.
	
2002-05-11  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am (SOURCES): removed picmantool.h.

	* libpicmantool/Makefile.am (SOURCES): added picmantoolcontrol.h.

2001-05-11  Hans Breuer  <hans@breuer.org>

	* app/makefile.msc : add appconfig.lib. Statically
	link libpicmantool/picmantool.lib.

	* app/main.c : use picman_locale_directory()

	* app/config/picmanconfig-utils.c : <string.h>

	* app/config/makefile.msc : add picmanscanner

	* app/core/picmanimagefile.c : some G_OS_WIN32 mess to get
	mkdir() and chmod()

	* app/display/picmandisplayshell.c
	* app/plug-in/plug-in-progrss.c
	* app/tool/picmancolorpickertool.c  
	* app/tool/picmancroptool.c  
	* app/tool/picmanmeasuretool.c  
	* app/tool/picmanperspectivetool.c  
	* app/tool/picmanrotatetool.c  
	* app/tool/picmanscaletool.c  
	* app/tool/picmansheartool.c  
	* app/tool/picmantransformtool.c  
	* app/widgets/picmancolormapeditor.c  
	* app/widgets/picmancolorpanel.c  
	* app/widgets/picmantoolbox-color-area.c : add #ifdef __GNUC__ to
	avoid breaking on non standard pragma #warning.

	* app/tools/makefile.msc : add picmantoolcontrol remove tools-enum.

	* app/tools/tool_manager.c : need to include
	libpicmantool/picmantoolcontrol.h after core includes
	otherwise we would compile without prototypes or
	break miserably

	* app/gui/plug-in-menus.c : replace LOCALEDIR with
	picman_locale_directory ()

	* app/gui/preferences-dialog.c (prefs_notebook_append_page) : 
	only try to gdk_pixbuf_new_from_file() with a valid filename.
	It should simply return NULL otherwise, but fails if the
	filename is an empty string.

	* app/paint-funcs/makefile.msc : add -FImsvc_recommended_pragmas.h

	* app/widgets/picmancolormapeditor.c : the 'row'
	allocated needs to be 'xn * cellsize * 2' (to avoid
	accessing unowned memory) not only width, which has 
	become allocation.width by someone commenting out 
	the correct size calculation

	* app/widgets/picmandialogfactory.c : varargs to macros
	are GCCism or at least non standard. #define DEBUG
	to g_print or nothing - without arguments - does fix
	it somewhat dirty as the compiler needs to tolerate
	the '(blah, foo, bar);' statement than

	* app/widgets/makefile.msc : updated

	* app/xcf/makefile.msc : add -FImsvc_recommended_pragmas.h

	* etc/picmanrc.win32 : use ';' to separate theme-path

	* libpicmanbase/picmanenv.c : #include <stdio.h>
	for sprintf()

	* app/widgets/picmandnd.c (picman_dnd_set_file_data) : 
	the passed in vals chunk is not always null-terminated
	(at least not on win32). Use the length parameter too 
	to avoid reading junk filenames.

	* libpicman/picman.def : export picman_image_get_name()

	* libpicmanbase/picmanbase.def : export picman_locale_directory()
	* libpicmanbase/picmanenv.[ch] : added picman_locale_directory ()

	* libpicmanbase/makefile.msc : define DATADIR and SYSCONFDIR
	to empty string to let picman find its files in the common
	place (win32: relative to the top level picman dir)

	* plug-ins/common/pixelize.c : <string.h>

	* plug-ins/flame/cmap.c : #include <glib.h> for g_random_int()

	* plug-ins/makefile.msc : -FImsvc_recommended_pragams.h
	and a little hack to give imagemap the prototypes it
	desires without changing the lexed source

	* themes/Default/images/makefile.msc : now added (see below)

	* themes/Default/images/stock-button-reset.png : made it binary

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.c: EEK, actually increase
	picman->next_display_ID after taking a value.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c (file_open_image): invalidate all layer and
	channel previews after loading an image. Fixes previews containing
	garbage after image loading (also fixes thumbnail generation).

2002-05-10  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: initialize a variable to please the
	compiler.

	* app/pdb/image_cmds.c: regenerated.

2002-05-10  Michael Natterer  <mitch@picman.org>

	We can always create PicmanPreviews for any GtkIconSize, but
	not vice versa. therefore:

	* app/widgets/picmandockable.[ch]: changed the "gint size" parameter
	used for tab sizes to "GtkIconSize size" all over the place. Added
	"stock_id" in addition to "name" and "short_name".

	* app/widgets/picmandockbook.c
	* app/widgets/picmanimagedock.c: use GtkIconSize instead of integer
	preview sizes for all widget style properties. Renamed them from
	"blah_height" to "blah_size" because "height" is an implementation
	detail.

	* app/gui/dialogs-constructors.c: changed calls to
	picman_dockable_new() and all *_tab_func()s accordingly. Removed
	the hack for the navigation tab and added a general tab_func
	which returns a hbox with an icon & label.

	* app/gui/menus.c: made the dialog menus found under <Toolbox>,
	<Image> and <Dialogs> more consistent and added more stock icons.

	* etc/gtkrc_user
	* themes/Default/gtkrc: changed accordingly.

2002-05-10  Sven Neumann  <sven@picman.org>

	* app/gui/user-install-dialog.c
	* plug-ins/common/gtm.c: use stock pixbufs instead of xpm pixmaps.

	* pixmaps/Makefile.am
	* pixmaps/eek.xpm
	* pixmaps/folder.xpm
	* pixmaps/wilber.xpm: removed now unused pixmaps.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay.c: added a read-only property for the
	display's image, so it can be retreived by the core, which
	treats displays as simple PicmanObjects.

	* app/core/picmancontext.c: made context->display an object
	property, not just gpointer. Connect to the "remove" signal of
	picman->displays to get notified of disappearing displays. Removed
	the EEKWrapper and get the display's gimage with g_object_get().

	* app/widgets/picmanimagedock.[ch]: added image_dock->display_container
	and require it being passed in the constructor. Do voodoo things
	in the "image_changed" and "display_changed" callbacks to ensure
	that the dock doesn't end up with no display even if the active
	image has one. Added a style property for the image menu's preview
	size.

	* app/gui/dialogs-commands.c (dialogs_menu_update): set the
	"View as List" and "View as Grid" items insensitive if the
	other view type doesn't exist. Hide them if the view cannot
	be classified as "list" or "grid" at all. Also hide the
	"Preview Size" submenu if it's pointless for the view.

	* app/gui/dialogs-constructors.c: added a special tab for the
	navigation dialog. Will propbaby add dockable->stock_id to
	generalize this kind of tab. Pass picman->displays to
	picman_image_dock_new().

	* app/gui/menus.c: reordered the "<Dialogs>" factory entries,
	added more stock icons, cleanup.

	* etc/gtkrc_user
	* themes/Default/gtkrc: document usage of PicmanImageDock's
	"menu_preview_height" property.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmannavigationview.c: pack the preview's alignment
	into the inner frame, not around it, so it looks like the other
	dockables. Fixed popup window positioning. Tried to get rid of
	insane scale_label allocation computation but failed. Left the
	EEKy code there for further investigation.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/undo_history.c: create the "Undo" and "Redo" buttons from
	stock items.

	* pixmaps/Makefile.am
	* pixmaps/lower.xpm
	* pixmaps/paste.xpm
	* pixmaps/raise.xpm: removed them because they are not used any more.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainermenuimpl.c: don't try to set the
	preview_size of plain GtkMenuItems.

	* app/widgets/picmandocumentview.c: fixed the "update" and
	"delete dangling" functionals. They got passed wrong user_data.

	* app/widgets/picmanitemfactory.c (gtk_item_factory_set_visible): if
	the widget found is a menu, get it's parent item and show/hide
	that.

	* app/widgets/picmanpreview.c (picman_preview_set_viewable): always
	clear preview->buffer so we don't display previews of vanished
	viewables.

2002-05-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c: disabled debuggind output.

	* app/core/picmandrawable.c (picman_drawable_init): no need to
	initialize variables twice :)

	* app/widgets/picmannavigationpreview.c: removed debugging output.

2002-05-08  Nathan Summers  <rock@picman.org>

	* Changelog: (2002-05-06) somehow the Changelog entry for my dbbrower
	modification didn't get committed. Probably this was because I 
	committed at the same time that some guy with a backhoe committed some
	modifications to the network cable running under the parking lot behind
	my apartment, leaving me without internet connectivity for several 
	days. :)
	
2002-05-08  Manish Singh  <yosh@picman.org>

        * configure.in: the correct switch is --disable-print, not 
        --without-picmanprint. Fix not found error message, and add a pointer
        to the picman-print homepage.

2002-05-08  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c (run): call bind_textdomain_codeset() so
	that we get UTF-8 encoded translations from libpicmanprint.

2002-05-08  Michael Natterer  <mitch@picman.org>

	Started to get rid of the gdisplays_foo() functions in
	app/display/picmandisplay-foreach.[ch]. Work in progress...

	* app/core/picman.[ch]: added the display list to the Picman object
	(as a PicmanList of PicmanObjects). This way we get more independent
	from whether there is GUI or not, as picman->displays will simply
	be an empty list for the --no-interface case.

	* app/display/picmandisplay.[ch]: Removed the global "display_list"
	and "display_num" variables. Use picman->displays instead.

	* app/display/picmandisplay-foreach.[ch]: renamed most functions
	from gdisplays_foo() to picman_displays_foo() and pass them a Picman
	pointer. 

	* app/core/picmanimage.[ch]: added a "flush" signal.

	* app/display/picmandisplay-handlers.c: connect to "flush" and call
	picman_display_flush() in the callback.

	* tools/pdbgen/pdb/display.pdb: use picman_displays_flush(picman)
	here and only here.

	* app/pdb/display_cmds.c: regenerated.

	* app/app_procs.c
	* app/gui/gui.c
	* app/gui/preferences-dialog.c:
	s/gdislays_foo()/picman_displays_foo(picman)/

	* app/image_map.c
	* app/undo_history.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell-scale.c
	* app/gui/channels-commands.c
	* app/gui/colormap-editor-commands.c
	* app/gui/convert-dialog.c
	* app/gui/drawable-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/select-commands.c
	* app/gui/vectors-commands.c
	* app/paint/picmanairbrush.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanimageview.c
	* app/widgets/picmanitemlistitem.c
	* app/widgets/picmanitemlistview.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanvectorslistview.c: replaced gdisplays_flush()
	with calls to picman_image_flush(gimage). Removed inclusion of
	"display/picmandisplay-foreach.h" from most files.

2002-05-08  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_color_window.c
	* plug-ins/print/picman_main_window.c: a couple of cleanups and fixes.
	This code relies heavily on GTK+ implementation details and thus
	tends to work differently or even crashes on GTK+-2.0 :-(

2002-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picman.h: removed unused commented out prototype.

	* app/core/picmanimage.c (picman_image_set_tattoo_state): fixed it
	again after I have b0rked it when using vectors instead of paths.

	* app/display/picmandisplay.c: some comments and one more
	g_return_val_if_fail().

	* app/widgets/picmanimagedock.c: more fixes for the subtle
	active_image <-> active_display difference.

	* tools/pdbgen/pdb/display.pdb (picman_display_delete): call
	picman_display_delete() instead of just destroying it's shell (eek).

	* app/pdb/display_cmds.c: regenerated.

	Added a special view type for the image list so we can implement
	stuff like deleting images which are left over from crashed
	plug-ins:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimageview.[ch]: new widget: a view on the image
	container.

	* app/gui/Makefile.am
	* app/gui/images-commands.[ch]: new callbacks for it's context menu.

	* app/gui/dialogs-constructors.c: use the new widget instead of
	plain PicmanContainerViews.

	* app/gui/menus.c: added an item_factory for it.

2002-05-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_scale_entry_new)
	(picman_table_attach_aligned): applied a patch from Maurits Rijk that
	enables mnemonics (bug #80804).

	* plug-ins/common/apply_lens.c
	* plug-ins/common/glasstile.c: applied a patch from Maurits Rijk that
	adds mnemonics (bug #80804).

	* plug-ins/common/animationplay.c
	* plug-ins/common/decompose.c
	* plug-ins/common/film.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/winprint.c
	* plug-ins/gap/gap_lib.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_settings.c
	* plug-ins/print/picman_main_window.c
	* plug-ins/print/print.c
	* plug-ins/print/print_picman.h: use new function picman_image_get_name()
	where applicable.

2002-05-07  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/image.pdb: added image_get_name. Also, no longer
	duplicate the string in image_get_filename, since
	picman_image_get_filename() returns a caller freed string now.

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanimage_pdb.[ch]: regenerated

2002-05-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/nav_window.[ch]: removed.

	* app/display/Makefile.am
	* app/display/display-types.h
	* app/display/picmannavigationview.[ch]: new widget partially based
	on the removed nav_window.

	* libpicmanproxy/picmanproxytypes.h: regnenerated.

	* app/display/picmandisplay-foreach.[ch]: removed
	gdisplays_nav_preview_resized(). The new config system will allow
	us to get notified of changes.

	* app/display/picmandisplayshell.[ch]: added "scaled" and "scrolled"
	signals.

	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c: emit "scaled" and
	"scrolled" appropriately. Removed nav_window stuff.

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c: changed accordingly.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c: made the navigation dialog dockable.

	* app/gui/view-commands.c: changed the nav_dialog callback accordingly.

	* app/gui/preferences-dialog.c
	* app/picmanrc.[ch]
	* app/config/picmanguiconfig.[ch]: removed "nav_window_per_display"
	as it's now a dockable and it's state is saved in sessionrc.

	* app/widgets/picmannavigationpreview.[ch]: added context sensitive
	mouse cursors.

	* app/widgets/picmanimagedock.c: made it capable of holding
	display-related dialogs (like PicmanNavigationView) by connecting
	to the context's "display_changed" signal.

	* app/widgets/widgets-types.h: removed inclusion of
	"display/display-types.h".

	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanitemlistitem.c
	* app/widgets/picmanitemlistview.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmanvectorslistview.c: warn about inclusion of
	"display/display-types.h".

2002-05-07  Sven Neumann  <sven@picman.org>

	Moved slovenian translation to the stable branch where they should
	have been added in the first place.

	* configure.in: removed sl from LINGUAS.

	* picman.spec.in: updated a bit, still broken.

2002-05-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: reverted my last change. I changed the
	function when porting everything to URIs because it was documented
	to return NULL but didn't behave so.

	We need to add a new PDB function which returns the image's
	*display* name ("Untitled" for a NULL filename).

2002-05-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_get_filename): get the image's
	uri with picman_image_get_uri(), not picman_object_get_name(), so it
	automatically becomes "Unnamed" if it's not set.

2002-05-07  Sven Neumann  <sven@picman.org>

	* libpicman/picmanintl.h: removed (wrong) definition of LOCALEDIR.

	* libpicman/stdplugins-intl.h: fixed typo in domainname that broke i18n
	of plug-ins.

	* app/gui/Makefile.am: define LOCALEDIR.

	* app/gui/plug-in-menus.c
	* app/plug-in/plug-in.h
	* app/plug-in/plug-ins.[ch]: declared translation domain and help path
	as const strings.

	* plug-ins/print/print.c
	* plug-ins/print/print_picman.h: minor cleanups.

2002-05-07  David Monniaux  <david@picsou.chatons>

	* app/arch/i386/mmx/paint_funcs_mmx.S.m4: original source of
	paint_funcs_mmx.S, but the latter has been modified manually and
	is now out-of-sync. Deleted to reduce confusion.

	* app/arch/i386/mmx/paint_funcs_mmx.S: would not compile on my
	machine due to wrong .type directives. Fixed.
	
2002-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/print/picman_main_window.c: use more stock labels.

2002-05-07  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: depend on libpicmanprint >= 4.2.0 for the print plug-in.
	You need to --disable-print to build w/o print support.

	* plug-ins/Makefile.am: build print plug-in conditionally.
	
	* plug-ins/print/Makefile.am
	* plug-ins/print/picman_color_window.c
	* plug-ins/print/picman_main_window.c
	* plug-ins/print/print.c
	* plug-ins/print/print_picman.h
	* plug-ins/print/print-image-picman.c: the print plug-in from the
	picmanprint 4.2.1 release adapted to build inside the picman tree and
	ported to gtk+-2.0. Not yet free of deprecated code.

	* plug-ins/print/README
	* plug-ins/print/RELNOTES
	* plug-ins/print/escputil-1.3.1.in
	* plug-ins/print/escputil.c
	* plug-ins/print/print-canon.c
	* plug-ins/print/print-dither.c
	* plug-ins/print/print-escp2.c
	* plug-ins/print/print-intl.h
	* plug-ins/print/print-pcl.c
	* plug-ins/print/print-printers.c
	* plug-ins/print/print-ps.c
	* plug-ins/print/print-util.c
	* plug-ins/print/print-weave.c
	* plug-ins/print/print.h
	* plug-ins/print/quickmatrix257.h
	* plug-ins/print/ran.367.179.h: removed.

2002-05-06  Nathan Summers  <rock@picman.org>

	* libpicmanproxy/Makefile.am: correct a cut'n'paste mistake. The build
	actual works correctly now! I should have committed this fix a long
	time ago.

2002-05-06  Sven Neumann  <sven@picman.org>

	* autogen.sh: fixed typo.

	* app/config/picmanconfig-serialize.[ch] (picman_config_serialize_value):
	allow to specify whether strings should be escaped.

	* app/config/picmanrc.c (picman_rc_query): don't escape string values.

	* app/config/test-config.c: changed accordingly.

2002-05-06  Nathan Summers  <rock@picman.org>

        * plug-ins/dbbrowser/dbbrowser_utils.c: (picman_db_browser) use a
        GtkHPaned instead of a GtkHBox to separate the list from the details.
        This little change makes the pdb browser much more usable.

2002-05-06  Nathan Summers  <rock@picman.org>

	* tools/picman-mkproxy: added proxy-subst command, which substitutes its
 	argument for the current line in the proxied version

2002-05-06  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_query): free the list of properties.

2002-05-06  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-utils.[ch]
	* app/config/picmanconfig.[ch]
	* app/config/picmanrc.[ch]: added a PicmanRc implementation of
	picman_config_duplicate() that also copies unknown tokens. Added new
	function picman_rc_query().

	* app/config/test-config.c: added tests for picman_rc_query().

	* app/config/Makefile.am: need to link test app against libappwidgets.

2002-05-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanhelp.[ch]: removed...

	* app/widgets/Makefile.am
	* app/widgets/picmanhelp.[ch]: ...and added here.

	* app/widgets/widgets-enums.[ch]: added PicmanHelpBrowserType here
	as registered enum. Added an evil hack with PicmanCursorType so
	app/config/picmanguiconfig.h can include this file.

	* app/widgets/picmancursor.c: added an assertion because of the
	changed PicmanCursorType.

	* app/config/picmanguiconfig.[ch]: added a property for the help
	browser type.

	* app/picmanrc.c
	* app/libpicman_glue.c
	* app/gui/preferences-dialog.c
	* tools/pdbgen/pdb/help.pdb: changed accordingly.

	* app/pdb/help_cmds.c: regenerated.

	Some nav_window cleanup before chopping:

	* app/nav_window.[ch]: removed the old preview code and use
	PicmanNavigationPreviews only. Namespaceified all functions. Speak
	in terms of PicmanDisplayShell, not PicmanDisplay. Lots of internal
	cleanup.

	* app/gui/gui-types.h: removed NaviagtionDialog here...

	* app/display/display-types.h: ...and added it here.

	* app/display/picmandisplayshell-callbacks.[ch]: added a callback
	for the navigation button and call nav_window_show_popup() from there.

	* app/display/picmandisplayshell.c: free shell->nav_dialog
	unconditionally, connect to the new callback.

	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c
	* app/gui/view-commands.c: changed accordingly.

	* app/widgets/picmanpreview.c (picman_preview_set_viewable): the
	assertion introduced recently was too tight, breaking
	PicmanNavigationPreview. Changed it to do an "is a" check, not exact
	preview type matching.

	* app/widgets/picmanimagepreview.c: added quick-hack support for
	xres != yres.

	* app/widgets/picmannavigationpreview.[ch]: made
	picman_navigation_preview_grab_pointer() public so the nav_window
	can call it.

	Unrelated:

	* app/display/picmandisplay.c: removed the gui/ dependency from this
	file by removing info_window stuff.

	* app/display/picmandisplayshell.c (picman_display_shell_flush): update
	the info_window here.

	* app/gui/dialogs-constructors.c (dialogs_indexed_palette_new): call
	picman_dockable_set_context() like all other constructors.

	* app/undo.c
	* app/paint/picmanpaintcore.h: some more include cleanup.

2002-05-05  Sven Neumann  <sven@picman.org>

	* NEWS: updated.
	* configure.in: fixed check for libgtkhtml-2.0.
	
2002-05-05  Sven Neumann  <sven@picman.org>

	* configure.in: bumped our version number to 1.3.6. Added check
	for libgtkhtml-2.0.

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/helpbrowser.c: started to port the help browser
	to GtkHtml2. Not all features are working yet.

	* plug-ins/helpbrowser/back.xpm
	* plug-ins/helpbrowser/forward.xpm: removed.

2002-05-04  Sven Neumann  <sven@picman.org>

	* README: updated Bugs section. Mention gdkxft to avoid more
	reports about crashes caused by such lousy LD_PRELOAD hacks.
	
2002-05-04  Sven Neumann  <sven@picman.org>

	* app/arch/i386/mmx/detect_mmx.S
	* app/arch/i386/mmx/paint_funcs_mmx.S: applied a patch from 
	iccii@hotmail.com that promises to fix build on mingw (bug #80681).

	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-utils.[ch]: moved value compare function to
	picmanconfig-utils.

	* app/config/picmanconfig.[ch]: added duplicate and compare functions
	to PicmanConfigInterface so derived interfaces can override them.

	* app/tools/picmantexttool.c: fixed tool cursor.

2002-05-03  Nick Lamb  <njl195@zepler.org.uk>

	* plug-ins/common/tiff.c: Overbright alpha bug #77283 fixed

2002-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/borderaverage.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/papertile.c
	* plug-ins/common/vpropagate.c: applied a patch from iccii@hotmail.com
        that adds missing calls to picman_tile_cache_ntiles() to speed up the
        plug-ins considerably (bug #78358).

	* plug-ins/common/colorify.c: fix for drawables with alpha from
	iccii@hotmail.com.

2002-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/tools/tool-safe-mode.c: removed another warning.

2002-05-03  Michael Natterer  <mitch@picman.org>

	* devel-docs/Makefile.am
	* devel-docs/includes.txt: new file documenting the core's
	include policy.

	* HACKING: mention it here.

	* libpicmantool/picmantooltypes.h: removed PicmanToolOptions here.

	* app/core/core-types.h: and added it here. This is a temp hack
	needed because PicmanToolInfo needs to know the PicmanToolOptions
	type.

	* libpicmanproxy/picmanproxytypes.h: regenerated.

	* libpicmantool/picmantoolmodule.h: don't include picmantooltypes.h here...
	* libpicmantool/picmantoolmodule.c: ...but here.

	* app/config/picmanconfig-params.c: include "libpicmanbase/picmanbase.h"
	entirely, not single files from it.

	* app/core/picman.c
	* app/core/picmancontext.c
	* app/core/picmancoreconfig.c
	* app/core/picmandatafactory.c
	* app/core/picmandocuments.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/core/picmanmodules.c
	* app/core/picmanpaintinfo.c
	* app/core/picmanparasite.c
	* app/core/picmanpreviewcache.c
	* app/core/picmantoolinfo.c
	* app/core/picmanunit.c: include "core-types.h" and no other types file.

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: include "tools/tools-types.h"
	instead of "libpicmantool/picmantooltypes.h", warn about inclusion
	on "gui/gui-types.h"

	* app/file/file-open.c
	* app/file/file-save.c: don't include "libpicmantool/picmantooltypes.h".

	* app/gui/about-dialog.c
	* app/gui/brush-select.c
	* app/gui/brushes-commands.c
	* app/gui/color-select.c
	* app/gui/data-commands.c
	* app/gui/device-status-dialog.c
	* app/gui/dialogs.c
	* app/gui/gradients-commands.c
	* app/gui/help-commands.c
	* app/gui/info-window.c
	* app/gui/palettes-commands.c
	* app/gui/patterns-commands.c
	* app/gui/resize-dialog.c
	* app/gui/tips-dialog.c
	* app/gui/tool-options-dialog.c: include "gui-types.h" and no
	other types file.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/paint/paint.c: include "paint-types.h" and no other types file.

	* app/pdb/pdb-types.h: don't include "libpicmantool/picmantooltypes.h".

	* app/plug-in/plug-in-progress.c: warn about inclusion of
	"display/display-types.h"

	* app/tools/tools-types.h: include "libpicmantool/picmantooltypes.h".

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantoolcontrol.c
	* app/tools/picmantoolcontrol.h
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/tools/tools.c: include "tools-types.h" and no other types file,
	warn about inclusion of "gui/gui-types.h".

	* app/widgets/picmancolorpanel.c
	* app/widgets/picmantoolbox-color-area.c: warn about inclusion of
	"gui/gui-types.h".

	* app/xcf/xcf-load.c
	* app/xcf/xcf.c: don't include "libpicmantool/picmantooltypes.h".

	Split tool-safe-mode up in two files, one including libpicmanproxy,
	one libpicman.
	
	* plug-ins/tools/Makefile.am
	* plug-ins/tools/tool-safe-mode-plug-in.[ch]: new files including
	libpicman/ stuff only.

	* plug-ins/tools/tool-safe-mode.[ch]: include libpicmanproxy/ and
	libpicmantool/ but don't include libpicman/ because of conflicting
	declarations.

	Unrelated:

	* app/tools/picmanclonetool.c: create the clone core so we don't crash.

	* app/gui/file-open-dialog.c: changed the way we create previews
	so that only out-of-date previews are created on a click in the
	preview area. Unconditional creation can still be forced by
	<Ctrl>+click. Changed the tooltip to document this.

2002-05-03  Sven Neumann  <sven@picman.org>

	* app/tools/picmanairbrushtool.[ch]
	* app/tools/picmanbezierselecttool.[ch]
	* app/tools/picmanblendtool.[ch]
	* app/tools/picmanbrightnesscontrasttool.[ch]
	* app/tools/picmanbucketfilltool[.ch]
	* app/tools/picmanbycolorselecttool[.ch]
	* app/tools/picmanclonetool[.ch]
	* app/tools/picmancolorbalancetool[.ch]
	* app/tools/picmancolorpickertool[.ch]
	* app/tools/picmanconvolvetool[.ch]
	* app/tools/picmancroptool[.ch]
	* app/tools/picmancurvestool[.ch]
	* app/tools/picmandodgeburntool[.ch]
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool[.ch]
	* app/tools/picmanerasertool[.ch]
	* app/tools/picmanfliptool[.ch]
	* app/tools/picmanfreeselecttool[.ch]
	* app/tools/picmanfuzzyselecttool[.ch]
	* app/tools/picmanhistogramtool[.ch]
	* app/tools/picmanhuesaturationtool[.ch]
	* app/tools/picmaninktool[.ch]
	* app/tools/picmaniscissorstool[.ch]
	* app/tools/picmanlevelstool[.ch]
	* app/tools/picmanmagnifytool[.ch]
	* app/tools/picmanmeasuretool[.ch]
	* app/tools/picmanmovetool[.ch]
	* app/tools/picmanpaintbrushtool[.ch]
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool[.ch]
	* app/tools/picmanpenciltool[.ch]
	* app/tools/picmanperspectivetool[.ch]
	* app/tools/picmanposterizetool[.ch]
	* app/tools/picmanrectselecttool[.ch]
	* app/tools/picmanrotatetool[.ch]
	* app/tools/picmanscaletool[.ch]
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool[.ch]
	* app/tools/picmansmudgetool[.ch]
	* app/tools/picmantexttool[.ch]
	* app/tools/picmanthresholdtool[.ch]
	* app/tools/picmantool.c
	* app/tools/picmantoolcontrol.h
	* app/tools/picmantoolmodule[.ch]
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool[.ch]
	* app/tools/path_tool.c
	* app/tools/tool_manager[.ch]
	* app/tools/tools.c
	* libpicmantool/picmantool.c
	* libpicmantool/picmantoolcontrol.h
	* libpicmantool/picmantoolmodule.h: removed tons of warnings. Do we need
	to add -Werror to the CFLAGS to avoid such a mess in the future ?!
	Also had to enforce the PICMAN coding style in lots of places :-(

	* libpicman/picmanpixelrgn.c: got sick and tired of debugging plug-ins,
	so I've added checks for most parameters passed to the PicmanPixelRgn
	functions. This will slow down plug-in execution a little bit but
	should help to find bugs early.

2002-05-02  Nathan Summers  <rock@picman.org>
        
	* app/core/core-types.h
	* libpicmantool/picmantooltypes.h: moved PicmanToolInfo back into the core.

	* libpicmantool/picmantoolcontrol.h
	* app/tools/picmantoolcontrol.c: got rid of picman_tool_control_new

	* libpicmantool/picmantool.c (picman_tool_init): create the PicmanToolControl
        here instead of in the descendant classes

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c
	* plug-ins/tools/tool-safe-mode.c: changed accordingly

	* libpicmanproxy/picmanproxytypes.h: autogenerated

2002-05-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_save_thumbnail): fixed
	typo.

	* plug-ins/rcm/rcm_misc.c (rcm_reduce_image): merged fix for bug
	#80561 from stable branch.

2002-05-02  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-console.c: fixed communication
	with the SIOD interpreter:

	- set the GError variable to NULL before using it.
	- set the GIOChannel used to read SIOD's output to binary mode.

2002-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.[ch]: added some assertions, cleaned up
	internals.

	* app/widgets/picmandocumentview.c: use the preview size instead of a
	hardcoded thumbnail size. Should we use the prefs value instead?

2002-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: adapt the thumbnail size to the image size
	so that thumbs of small images don't end up in the "large" directory.

2002-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.[ch]: accept any size so we don't depend on
	the values of PicmanThumbnailSize. We might want to allow other thumbnail
	sizes than only 0, 128 or 256.

2002-04-29  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added new enum PicmanThumbnailSize.

	* app/picmanrc.c
	* app/config/picmancoreconfig.[ch]
	* app/core/picmancoreconfig.[ch]: replaced old picmanrc value
	write_thumbnails with thumbnail_size.

	* app/core/picmanimagefile.[ch]: allow to specify a thumbnail size.

	* app/core/picmandocuments.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/gui/preferences-dialog.c
	* app/widgets/picmandocumentview.c: changed accordingly.

	* app/gui/file-open-dialog.c: create the preview according to the
	users choice of thumbnail size. Doesn't update on changes yet.

2002-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.[ch]: save empty thumbnails to
	~/.thumbnails/fail/picman-1.3 if we cannot create a thumbnail. Added
	new state PICMAN_IMAGEFILE_STATE_THUMBNAIL_EXISTS to indicate that a
	thumbnail was found but is not yet loaded. Removed unused thumb_mtime
	from PicmanImagefile struct and simplified some parts of the code.

	* app/gui/file-open-dialog.c: cosmetic changes.

2002-04-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added "gchar *name_changed_signal"
	to PicmanViewableClass which defaults to "name_changed".

	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c: connect to
	viewable_class->name_changed_signal instead of just
	"name_changed". Fixed possible UI inconsistency where the previous
	viewable's tooltip would have been displayed.

	* app/core/picmanimagefile.[ch]: set name_changed_signal to
	"info_changed" so views can update their tooltips correctly.
	Merged the separate image_state and thumb_state states into one
	state variable and extended the state enum. Added description
	strings for all states. Show the file size for all files, not only
	for those with a thumbnail. Enabled display of outdated
	thumbnails.

	* app/gui/file-open-dialog.c: some changes because
	picman_imagefile_get_description() returns 3 instead of 2 lines of
	text now.

	* app/widgets/picmancontainerview-utils.c: show the imagefile's
	description in the tooltip.

	* app/gui/menus.c
	* app/gui/documents-commands.[ch]
	* app/widgets/picmandocumentview.c: added functions to remove
	"dangling" document history entries. Updated the context menu so
	all functions can be accessed through it.

2002-04-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/tools/transform_options.c: in preparation of a more generic tool
	options framework: use the options value, not the default value when
	setting up the tool options UI. Doesn't make any difference since both
	are initialized to the same value, but reduces usage of the ugly foo_d
	variables.

	* app/tools/picmanmagnifytool.c: don't change the resize_windows_on_zoom
	picmanrc value in response to changes in the tool options. Only use it
	as default value when resetting the tool options.

2002-04-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): invalidate layer
	previews so we don't crash when an image preview is generated after
	converting the image from RGB to GRAY.

	* app/core/picmanimage.c (picman_image_get_new_preview): added some
	assertions to make it easier to find similar problems in the future.

2002-04-24  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c 
	* plug-ins/imagemap/imap_preview.c: don't use GDK_MOTION_NOTIFY as an 
	event mask.

2002-04-23  Nathan Summers  <rock@picman.org>

	* libpicmantool/picmantoolmodule.[ch]: More error checking. Also introduced
	a versioning scheme. Increment PICMAN_TOOL_MODULE_ABI_VERSION any time
	you break binary compatiblity.
        
	* plug-ins/tools/tool-safe-mode.c: call g_type_init().

2002-04-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c: display the tools' shortcuts in the
	tool buttons' tooltips (fixes #60273).

2002-04-21  Nathan Summers  <rock@picman.org>

	* app/tools/picmantoolcontrol.[ch]
	* libpicmantool/picmantool.c: resurrected the motion hints and cursor
 	changing code.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: set the motion mode; fix a few parameters

	* app/tools/picmaninktool.c (picman_ink_tool_button_press): uncommented
 	some code I had temporarily commented out and didn't uncomment before
 	committing

	* libpicmantool/picmantoolcontrol.h
	* app/tools/picmantoolcontrol-displayshell.[ch]: merged with
 	picmantoolcontrol.[ch].  The distinction was fairly arbitrary.

	* plug-ins/tools/picmantoolcontrol.c: added some stubs

	* app/tools/Makefile.am
	* app/tools/tool_manager.c
	* app/display/picmandisplayshell-callbacks.c: changed accordingly

	* tools/pdbgen/pdb/image.pdb
	* libpicman/picmanimage_pdb.c: applied a patch from Pippen to correct
 	documentation on the undo operations
 	
2002-04-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.[ch]: made picman_imagefile_save_thumbnail()
	return a gboolean indicating success.

	* app/file/file-save.c
	* tools/pdbgen/pdb/fileops.pdb: use picman_imagefile_save_thumbnail()
	to save thumbnails.

	* app/file/file-utils.[ch]: removed the .xvpics thumbnail saving code.

	* app/pdb/fileops_cmds.c: regenerated.

2002-04-19  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.[ch]: all functions return the opened image
	and the pdb status plus a GError now. Removed all g_message()
	calls from file_open_image(). Instead, display all error messages
	in file_open_with_proc_and_display() if it got no error return
	location passed.

	* app/app_procs.c
	* app/core/picmanimagefile.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandocumentview.c: changed accordingly.

	* app/gui/file-open-dialog.c: only treat the "entered_filename" as
	URI if it contains "://".

2002-04-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmandocuments.[ch] (picman_documents_add): speak in terms
	of "uri", not "filename". Return the created imagefile.

	* app/core/picmanimagefile.[ch]: factored out private function
	picman_imagefile_save_png_thumb() and call it from
	picman_imagefile_create_thumbnail().
	Added public function picman_imagefile_save_thumbnail() which takes
	an imagefile and an image.

	* app/file/file-open.c: create thumbnails for all images opened
	interactively using picman_imagefile_save_thumbnail().

	* app/xcf/xcf-load.c (xcf_load_image): set the filename with
	picman_image_set_filename() so it gets converted to an URI as for
	external plug-ins.

2002-04-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c: oops, thumbnails were created in the
	wrong directory since my last commit.

2002-04-18  Michael Natterer  <mitch@picman.org>

	* app/gui/file-open-dialog.c: added a progress bar to the preview
	frame to show the progress when creating many previews. Also added
	some more ugly static variables...

2002-04-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.[ch]: create the thumbnail subdir strings
	only once in class_init, minor stuff.

	* app/widgets/picmanpreview.c: set widget_class->activate_signal to
	the preview's "clicked" id so we can create mnemonics for it.

	* app/gui/file-open-dialog.c: make the whole preview area clickable,
	block some signals of the "Preview" button so it behaves like
	the tree view headers.

2002-04-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.[ch]: save the number of layers in the
	thumbnail and show it in the description.

	* app/gui/file-dialog-utils.[ch]: added file_dialog_new() which
	contains a lot of factored out code from file-open and file-save.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: use file_dialog_new(), reduce use of
	global variables, added utility functions to reduce code
	duplication, cleanup.

	* app/gui/file-open-dialog.c: use a temporary imagefile to create
	previews so the dialog's preview can show the progress when
	creating many thumbnails.

2002-04-17  Michael Natterer  <mitch@picman.org>

	* app/file/file-save.c: shouldn't free the filename before using it :)

	* app/core/picmanimagefile.c: emit the "info_changed" signal more
	often, assemble the description string differently.

	* app/gui/file-open-dialog.c: moved the preview into a frame right
	of the file selection box, lots of gui and other cleanup...

2002-04-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.[ch]
	* app/gui/file-open-dialog.c: moved code to generate a literate
	description of the image to the PicmanImagefile object.

2002-04-17  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: register PicmanImageType.

	* app/core/picmanimagefile.[ch]: read and write more image properties
	in thumbnails.

	* app/gui/file-open-dialog.c: changed accordingly.

	* app/widgets/picmandialogfactory.c: disabled debugging output.

	* app/widgets/picmandocumentview.c: changed the "Refresh" button to
	regenerate the preview on click and reload all previews on
	shift+click.

	* tools/pdbgen/enums.pl: regenerated.

2002-04-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_png_thumb_path): create
	the thumbnail directories if they don't exist.
	(picman_imagefile_png_thumb_name): reimplemented w/o snprintf().

	* app/pdb/color_cmds.c
	* tools/pdbgen/pdb/color.pdb: merged fix for bug #78877 from stable
	branch.

2002-04-16  Michael Natterer  <mitch@picman.org>

	* app/base/temp-buf.c: fixed temp_buf_copy() and
	temp_buf_to_[color|gray]() to (1) not crash and (2) to assume the
	correct pixelformat. Bugs were never noticed because the code was
	never used until today...

	* app/core/picmanviewable.c (picman_viewable_get_new_preview_pixbuf):
	use temp_buf_copy() to convert GRAY* TempBufs to RGB* before
	creating the pixbuf.

	* app/app_procs.c: don't try to open command line images if the
	filename could not be converted to an URI.

	* app/file/file-open.c
	* app/file/file-save.c: use g_file_test() instead of stat().

	* app/file/file-utils.[ch]: cleanup, changed
	file_utils_filename_to_uri() to take a list of procs, not a Picman
	pointer.

	* app/core/picmanimage.c: changed accordingly.

	* app/core/picmanimagefile.[ch]: implemented thumbnail saving
	following the thumbnail standard v0.5 (the implementation is not
	yet fully standard compliant).

	* app/gui/file-open-dialog.c: use the new thubmnail functions and
	removed all .xvpics code. Not finished yet...

	* app/core/picmandocuments.c
	* app/widgets/picmandocumentview.c: changed accordingly.

	* tools/pdbgen/pdb/fileops.pdb (file_save_thumbnail): set "success"
	correctly.

	* app/pdb/fileops_cmds.c: regenerated.

2002-04-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpreview.c (picman_preview_expose_event): don't draw
	anything if an idle update is pending.

	* libpicmanwidgets/picmancolorarea.c (picman_color_area_expose): reordered
	conditions so that the one that is most expensive to check comes last.

2002-04-15  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.c: serialize doubles and floats
	using the locale independent g_ascii_formatd().

2002-04-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanunits.c: serialize the unit factor with
	g_ascii_formatd() so it is locale independent.

2002-04-14  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.[ch]: added utility functions
	file_utils_uri_to_utf8_basename() and
	file_utils_uri_to_utf8_filename().

	* app/nav_window.c
	* app/undo_history.c
	* app/display/picmandisplayshell.c
	* app/gui/info-window.c
	* app/gui/menus.c
	* app/gui/palette-import-dialog.c
	* app/tools/picmanbycolorselecttool.c
	* app/widgets/picmancontainerview-utils.c: use the new functions.

2002-04-14  Michael Natterer  <mitch@picman.org>

	Use UTF-8 encoded escaped URIs for PicmanImage and PicmanImageFile.

	* app/file/file-open.[ch]
	* app/file/file-save.[ch]
	* app/file/file-utils.[ch]: port everything to using URIs, removed
	file_open_absolute_filename() and added file_utils_filename_to_uri()
	instead.

	* app/core/picmanimage.[ch]: added picman_image_[get|set]_uri() which
	works like the old picman_image_[get|set]_filename().
	Changed picman_image_[get|set]_filename() to call uri conversion
	functions.

	* app/app_procs.c: removed lots of code and use the new uri
	functions to open images passed on the command line.

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: changed accordingly.

	* app/nav_window.c
	* app/undo_history.c
	* app/display/picmandisplayshell.c
	* app/gui/info-window.c
	* app/gui/palette-import-dialog.c
	* app/tools/picmanbycolorselecttool.c
	* app/widgets/picmancontainerview-utils.c: 
	s/picman_image_get_filename()/picman_image_get_uri()/g. Need to add
	a utility function which returns the basename in unescaped UTF-8.

	* app/gui/file-commands.c
	* app/widgets/picmandocumentview.c: use "uri", not "filename" as
	variable name where appropriate.

	* app/gui/menus.c: some broken code for the "Open Recent" items,
	will be fixed soon...

	* app/widgets/picmandnd.c: evil (!!!) hackery to convert dropped
	filenames to uris.

	* tools/pdbgen/pdb/fileops.pdb: changed accordingly. Clarified
	the meaning of the "raw_filename" parameter.

	* tools/pdbgen/pdb/message.pdb: use g_message("%s", message),
	*not* g_message(message).

	* app/pdb/fileops_cmds.c
	* app/pdb/message_cmds.c
	* libpicman/picmanfileops_pdb.c: regenerated.

2002-04-14  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c: removed some #if 0'ed stuff.

	* app/gui/edit-commands.c (edit_copy_cmd_callback): call
	gdisplays_flush() so the menus are updated correctly.

	* app/widgets/picmanitemfactory.c (picman_item_factory_set_color):
	pack the original menu item label with TRUE, TRUE into the created
	hbox so it's accel. label is visible.

2002-04-12  Michael Natterer  <mitch@picman.org>

	Well, sometimes the most obvious solution is not the first one...

	* app/picmanhelp.[ch]: removed _picman_standard_help_func().

	* app/libpicman_glue.c (picman_standard_help_func): call picman_help()
	directly.

2002-04-12  Michael Natterer  <mitch@picman.org>

	* app/picmanhelp.[ch]: removed usage of "the_picman" by passing around
	more "Picman" pointers. Renamed picman_standard_help_func() to
	_picman_standard_help_func() and declare it in the header.  Don't
	include "app_procs.h".

	* app/libpicman_glue.[ch]: added picman_standard_help_func() here.
	Call _picman_standard_help_func (the_picman, ...) like all other
	wrappers in this file do. I know this is ugly but better let's
	have all uglyness in one place (here) :-)

	* app/widgets/picmanitemfactory.[ch]: added a "Picman" member to the
	PicmanItemFactory struct. Pass it to picman_help(),

	* app/gui/menus.c: pass a Picman to picman_item_factory_new(), removed
	useless inclusion of "picmanhelp.h".

	* tools/pdbgen/pdb/help.pdb: pass a Picman to picman_help()

	* app/pdb/help_cmds.c: regenerated.

	* app/gui/tips-dialog.c: removed gtk_quit_add_destroy() here too
	because the tips dialog is created by a dialog factory which takes
	care of dialog destruction.

2002-04-12  Sven Neumann  <sven@picman.org>

	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: merged fix for bug #51781 from stable
	branch: don't gtk_quit_add_destroy() the fileload and filesave widgets.

2002-04-12  Sven Neumann  <sven@picman.org>

	* data/misc/Makefile.am: fixed uninstall target (bug #78536).

2002-04-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gtm.c
	* plug-ins/common/illusion.c
	* plug-ins/common/ps.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/wind.c
	* plug-ins/maze/maze_face.c
	* plug-ins/sel2path/sel2path.c
	* plug-ins/sel2path/sel2path_adv_dialog.c: applied a patch from 
	<iccii@hotmail.com> that adds calls to picman_help_free() even though I 
	think that omitting picman_help_free() is tolerable lazyness (#76984).

2002-04-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-crop.c: reordered some lines, no logic
	changed.

	* app/core/picmanlayer.[ch]: made picman_layer_pick_correlate()
	return a gboolean, not gint.

	* app/display/picmandisplayshell.c
	* app/gui/layers-commands.[ch]
	* app/gui/menus.c: added "<Image>/Layers/Crop Layer" which resizes
	the active layer to the current selection's bounds, just as
	"<Image>/Image/Crop Image"

2002-04-12  Zbigniew Chyla  <cyba@gnome.pl>

	* app/gui/dialogs-constructors.c: Marked some strings for translation.

2002-04-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ps.c: merged fix for bug #75667 from stable branch.
	
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/rcm/rcm_misc.c: merged fix for bug #67018 from stable
	branch.
	
	* themes/Default/gtkrc: removed settings for tooltips color since
	GTK+-2.0 sets a reasonable default. Added a line to allow to change
	menu accelerators.

2002-04-10  Manish Singh  <yosh@picman.org>

	* plug-ins/common/url.c: merges from picman-1-2 branch

2002-04-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c: include libart.h instead of a selection
	of libart headers.

2002-04-03  Manish Singh  <yosh@picman.org>

	* app/core/picmanobject.c: use gobject marshaller names directly so
	libpicmanproxy doesn't need picmanmarshal.* around

2002-04-03  Manish Singh  <yosh@picman.org>

	* plug-ins/tools/Makefile.am
	* plug-ins/tools/common/Makefile.am: make it work with automake 1.5

2002-04-01  Nathan Summers  <rock@picman.org>

	* pretty much all files: One year of motif hacking has made me agree
	with Miguel that .NET is the way of the future.  Ported all code to C#.
	Works great on Mono!

	Still doesn't support CMYK.

2002-03-29  Nathan Summers  <rock@picman.org>

	* plug-ins/tools/tool-safe-mode.c: fix a segfault

2002-03-30  Tor Lillqvist  <tml@iki.fi>

	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am: Additions for Win32: Use
	-no-undefined. Use the .def file. Produce MS style import
	library if possible. Install (and uninstall) import
	libraries.

	* libpicmanbase/Makefile.am: Pass definition of PREFIX in CPPFLAGS.

	* libpicmanbase/picmanbase.def: Do export picman_signal_private.

	* libpicmanbase/picmanenv.c: Similar Win32 working as in the picman-1-2
	branch:
	(picman_directory): Replace funny chars in user name (when used as
	part of last-resort personal picman directory name) with
	underscores.
	(picman_toplevel_directory): New (Win32-only) function. Deduces the
	installation prefix at run-time.
	(picman_path_runtime_fix): New function. On Win32, replace the
	string with one where the compile-time prefix has been replaced
	with the run-time one.
	(picman_path_parse, picman_env_get_dir): Call it.
	
	* libpicmanbase/picmansignal.c: Trim (lots of) trailing spaces in
	copyright notice.
	(picman_signal_private): Bypass on Win32, return NULL. Or should we
	call g_error(), thus requiring that calls of this are enclosed with
	#ifdef G_OS_UNIX?

	* libpicmanbase/makefile.mingw.in
	* libpicmancolor/makefile.mingw.in
	* libpicmanmath/makefile.mingw.in: Add comment that it is seriously
	out-of-date.

	* libpicmanbase/makefile.msc: Do compile picmansignal.c.

2002-03-29  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Start of changes for autoconfiscated build on
	Win32. Mostly similar to how it is done in the picman-1-2 branch:

	Set LT_CURRENT_MINUS_AGE to $LT_CURRENT - $LT_AGE, this is used by
	libtool in DLL names, we need it for the *.rc.in files in case we
	want to have version resources in DLLs (these include the original
	filename). AC_SUBST it.

	Call AC_LIBTOOL_WIN32_DLL.

	Test for Win32 platform and native Win32, set automake
	conditionals PLATFORM_WIN32 and OS_WIN32. Set PATHSEP to ';' or
	':', AC_SUBST it.

	If on Win32, test for lib.exe availability (to build MS import
	libraries), set automake conditional MS_LIB_AVAILABLE.

	Include GLIB_LIBS when checking for bind_textdomain_codeset, in
	case using a separate -lintl.

	Don't try to link with -lX11 when looking for libXpm unless the
	GDK backend is x11. On Win32 we use the "no-X" version of libXpm.

2002-03-28  Nathan Summers  <rock@picman.org>

	* libpicmantool
	* libpicmantool/.cvsignore
	* libpicmantool/Makefile.am: a library that contains tool code shared 
	between the core and plugins

	* app/tools/picmantool.h: Removed here ...
	
	* libpicmantool/picmantool.h: ... and added here

	* libpicmantool/picmantooltypes.h: various types used by the tools.
	PICMAN_CHANNEL_OP_FOO must be declared before this file is included.
	
	* libpicmantool/picmantool.c: parts of the implementation of the PicmanTool
	class that are not specific to the core
	
	* libpicmantool/picmantoolcontrol.h: new class that contains the state
	and control information of the tool. Only the .h file is here because
	the plug-in code is completely different from the core code.
	
	* libpicmantool/picmantoolmodule.[ch]: the GTypePlugin that loads the tool
	plugin modules.  The registration code is not included here and must
	be supplied by the core or plug-in. Because registration in the core
	requires a Picman object, but pluginspace has no Picman (nor should it)
	the registration functions have been changed to take a void pointer.
	
	* app/tools/tools-enums.h: Removed here ...
	
	* libpicmantool/picmantoolenums.h: ... and added here


	* tools/picman-mkproxy: a perl script that aids in the creation and 
	maintainance of proxy objects by parsing c files and including relevant
	parts

	* libpicmanproxy
	* libpicmanproxy/.cvsignore
	* libpicmanproxy/.Makefile.am: a library that contains proxy objects
	necessary for tool plug-ins.
	
	* libpicmanproxy/picmanproxytypes.h: declarations of various types needed
	by tool plug-ins.
	
	
	* app/core/core-enums.h
	* app/core/core-types.h
	* app/display/display-types.h 
	* app/widgets/widgets-enums.h: export types to libpicmanproxy 
	
	* app/tools/tools-types.h: now just contains core-specific types
	
	* app/tools/picmantool.c
	* app/tools/picmantoolmodule.c
	* app/tools/picmantoolcontrol.[ch]: parts that are core-specific
	
	* app/tools/picmantoolcontrol-displayshell.[ch]: a special interface
	just for displayshell
	
	
	* plug-ins/tools/picmantool.c
	* plug-ins/tools/picmantoolcontrol.[ch]: parts that are 
	pluginspace-specific


	* plug-ins/tools/tool-safe-mode.[ch]: pluginspace tool loader
	

	* Makefile.am
	* configure.in
	* app/Makefile.am
	* app/picmanrc.c
	* app/undo.c
	* app/core/picman.c
	* app/core/picmancontext.c
	* app/core/picmancoreconfig.c
	* app/core/picmandatafactory.c
	* app/core/picmandocuments.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/core/picmanitem.c
	* app/core/picmanmodules.c
	* app/core/picmanpaintinfo.c
	* app/core/picmanparasite.c
	* app/core/picmantoolinfo.c
	* app/core/picmanunit.c
	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/paint/paint.c
	* app/pdb/pdb-types.h
	* app/tools/Makefile.am
	* app/tools/picmanairbrushtool.[ch]
	* app/tools/picmanbezierselecttool.[ch]
	* app/tools/picmanblendtool.[ch]
	* app/tools/picmanbrightnesscontrasttool.[ch]
	* app/tools/picmanbucketfilltool.[ch]
	* app/tools/picmanbycolorselecttool.[ch]
	* app/tools/picmanclonetool.[ch]
	* app/tools/picmancolorbalancetool.[ch]
	* app/tools/picmancolorpickertool.[ch]
	* app/tools/picmanconvolvetool.[ch]
	* app/tools/picmancroptool.[ch]
	* app/tools/picmancurvestool.[ch]
	* app/tools/picmandodgeburntool.[ch]
	* app/tools/picmandrawtool.[ch]
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.[ch]
	* app/tools/picmanfliptool.[ch]
	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmanfuzzyselecttool.[ch]
	* app/tools/picmanhistogramtool.[ch]
	* app/tools/picmanhuesaturationtool.[ch]
	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmaninktool.[ch]
	* app/tools/picmaniscissorstool.[ch]
	* app/tools/picmanlevelstool.[ch]
	* app/tools/picmanmagnifytool.[ch]
	* app/tools/picmanmeasuretool.[ch]
	* app/tools/picmanmovetool.[ch]
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmanpathtool.[ch]
	* app/tools/picmanpenciltool.[ch]
	* app/tools/picmanperspectivetool.[ch]
	* app/tools/picmanposterizetool.[ch]
	* app/tools/picmanrectselecttool.[ch]
	* app/tools/picmanrotatetool.[ch]
	* app/tools/picmanscaletool.[ch]
	* app/tools/picmanselectiontool.c
	* app/tools/picmansheartool.[ch]
	* app/tools/picmansmudgetool.[ch]
	* app/tools/picmantexttool.[ch]
	* app/tools/picmanthresholdtool.[ch]
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.[ch]
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/tools/tool_manager.c
	* app/tools/tool_manager.h
	* app/tools/tools.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/gui/convert-dialog.c
	* app/gui/info-window.c
	* app/gui/tools-commands.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf.c
	* plug-ins/tools/.cvsignore
	* plug-ins/tools/Makefile.am
	* plug-ins/tools/common/Makefile.am
	* tools/pdbgen/Makefile.am: changed accordingly


	* libpicmantool/picmantoolenums.c
	* libpicmanproxy/picmanchannel.h
	* libpicmanproxy/picmanobject.[ch]: autogenerated

2002-03-28  Sven Neumann  <sven@picman.org>

	* Made 1.3.5 release.

2002-03-28  Sven Neumann  <sven@picman.org>

	* Makefile.am (EXTRA_DIST): removed po-script-fu/script-fu-xgettext.
	* NEWS: updated.

2001-03-28  Manish Singh  <yosh@picman.org>

	* app/gui/user-install-dialog.c: Treeviewized

2001-03-28  Hans Breuer  <hans@breuer.org>

	* config.h.win32 : #define GETTEXT_PACKAGE

	* makefile.msc : add theme rule

	* app/makefile.msc : picman.exe depends on all the libs
	and general update

	* app/base/makefile.msc : updated

	* app/config/picmanconfig-serialize.c : #include <io.h> for win32
	* app/config/picmanconfig-types.c : #include <string.h>

	* app/core/picmancontext.c app/core/picmancontainer.c
	  app/core/picmantoolinfo.c : #include <string.h>
 
	* app/core/picmandocuments.c (picman_documents_save_func) :
	need to g_strescape() the filename to not make 
	backslashes vanish during de-serialization

	* app/core/picmanimagefile.c : #define S_ISREG for G_OS_WIN32

	* app/core/makefile.msc : add -DPICMAN_COMPILATION
	required for cpercep.c build

	* app/display/picmandisplayshell.c : #include <string.h>

	* app/display/makefile.msc : -FImsvc_recommended_pragmas.h,
	G_LOG_DOMAIN definition and object file update

	* app/file/makefile.msc : -FImsvc_recommended_pragmas.h,
	G_LOG_DOMAIN definition

	* app/file/file-open.c (file_open_with_proc_and_display) :
	use absolute filename for picman_documents_add()

	* app/gui/channel-commands.c app/gui/colormap-editor-commands.c
	  app/gui/edit-commands.c app/gui/vectors-commands.c : 
	#include <string.h>

	* app/gui/makefile.msc : updated

	* app/gui/menus.c : use g_file_test() instead of access()
	to avoid inclusion <unistd.h>

	* app/paint/makefile.msc : updated

	* app/plug-in/plug-in-params.c : #include <string.h>

	* app/plug-in/makefile.msc : updated

	* app/plug-in/plug-in-def.h : #include <time.h> for time_t

	* app/plug-in/plug-in.c : remove definition of S_IFREG

	* app/plug-in/gap/gap_arr_dialog.c : include <config.h>
	before including libpicman/libpicman-intl.h

	* app/tools/makefile.msc : updated

	* app/vectors/makefile.msc : new file

	* app/widgets/makefile.msc : updated

	* libpicman/picman.def : updated externals

	* libpicmanwidgets/picmanwidgets.def : updated externals

	* modules/makefile.msc : updated and disabled colorsel_gtk.

	* plug-in/makefile.msc : don't define GETTEXT_PACKAGE

	* themes/Default/images/makefile.msc : moved makefile.msc from ..
	and adapted pathes to images

2002-03-28  Michael Natterer  <mitch@picman.org>

	* app/config/Makefile.am
	* app/config/picmanscanner.[ch]: new files containing a convenience
	constructor for GScanner and some parse utility functions, mostly
	cut out of app/plug-in/plug-in-rc.c

	* app/plug-in/plug-in-rc.c: removed the stuff here, added scopes
	to the scanner symbols.

	* app/core/Makefile.am
	* app/core/picmanunits.[ch]: moved the user_unit list handling and
	unitrc stuff to this file. Parse unitrc here, using the new
	utility functions instead of using picmanrc.

	* app/core/picmanunit.[ch]: removed here.

	* app/core/picmandocuments.c: same here: added a scanner for the
	document history instead of using picmanrc.

	* app/picmanrc.c: removed unitrc and document history parsing stuff
	along with some old unused cruft.

	* app/app_procs.c
	* app/core/picman.c
	* app/gui/user-install-dialog.c: #include "core/picmanunits.h".

	* app/core/picmandrawable-bucket-fill.c: don't include "picmanrc.h".

2002-03-27  Sven Neumann  <sven@picman.org>

	* autogen.sh: bail out if one of the required tools is not found
	before proceeding to the version checks.

2002-03-26  Sven Neumann  <sven@picman.org>

	* tools/picman-mkenums: merged glib-mkenums changes (#74431).

2002-03-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox.c: use gtk_widget_add_events() instead
	of gtk_widget_set_events().

2002-03-23  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig.[ch]
	* app/config/picmanrc.[ch]
	* app/config/test-config.c: added better error reporting using GError.

2002-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanpreview-utils.[ch]: new file containing
	picman_preview_type_from_viewable() so we don't need to include
	*all* vieable and preview subclasses in picmanpreview.c

	* app/widgets/picmanpreview.c: picman_preview_set_viewable: never
	unset the drag source if the viewable is set to NULL (fixes dock
	tabs, thanks to sjburges), also check the passed viewable's type.

	* themes/Default/gtkrc: set the paned handle_size to 6 pixels, so
	it has the same size as the dock_separator.

	* etc/gtkrc_user: set both to 5 here, also fiddle around with
	the global focus padding and the GtkOptionMenu indicator.

2002-03-22  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.c
	* app/tools/tool_manager.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmantoolinfopreview.c: plugged a couple of mem leaks
	found using valgrind.

	* libpicmanwidgets/picmancolorarea.c (picman_color_area_expose): don't draw
	anything if an idle update is pending.
	
2002-03-22  Sven Neumann  <sven@picman.org>

	* app/appenv.h: moved use_shm declaration here, added use_mmx.
	
	* app/main.c: added --no-mmx commandline option, removed --no-xshm
	from help output.
	
	* app/base/base-config.[ch]: removed use-mmx declaration.
	
	* app/core/core-types.h
	* app/base/base-types.h: include libpicmanbase/picmanbasetypes.h from base.

	* app/base/base.c: respect user settings for mmx.

	* app/paint-funcs/paint-funcs.c
	* app/plug-in/plug-in.c: changed accordingly.
	
	* docs/picman-1.3.1.in: updated.

2002-03-22  Duarte Loreto <happyguy_pt@hotmail.com>

	* configure.in: Added Portuguese (pt) to ALL_LINGUAS

2002-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c: picman_dock_add_book() optimized to about
	two cases :) as picman_dock_remove_book(), just a bit more ugly.

2002-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c: reduced the picman_dock_remove_book()
	if () {} else if () {} ... paned removal madness to two cases.

2002-03-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c: pack the dock's PicmanDockbooks in
	GtkVPaneds instead of a GtkVBoxed so they are resizable. It's
	hackish, uncommented and weird code that will change, but I wanted
	to have a working state in CVS before optimizing...

2002-03-20  Michael Natterer  <mitch@picman.org>

	./mitch --sanitize-identifier-namespace

	* app/core/picmancontext.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c
	* app/gui/edit-commands.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/vectors-commands.c
	* app/gui/view-commands.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmandnd.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantoolbox.c: s/picman:/picman-/g and s/_/-/g for all
	identifier strings (e.g. picman:eraser_tool -> picman-eraser-tool,
	picman:layer-list -> picman-layer-list, ...)

	* plug-ins/tools/common/picmanbrushselecttool.c:
	s/picman:brush_select_tool/picman-brush-select-tool-module/

	Don't quite remember why I introduced the "picman:" prefix in the
	first place, but we can always add it back if we need it (for
	whatever reason)

	You may want to edit your ~/.picman-1.3/sessionrc and devicerc or
	all session settings will be lost due to parse errors.

2002-03-20  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/commands.[ch]: removed...

	* app/gui/help-commands.[ch]: ...and added here.

	* app/gui/menus.c: changed accordingly and added the mem_profile
	debug callback so all debug stuff is in one place.

2002-03-20  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: moved display after gui to make the build work
	with the latest "truly ugly hack" in app/display/Makefile.am.

	* app/tools/picmancolorbalancetool.[ch]: dialog overhaul.

2002-03-20  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.[ch]: badly chopped into the new files below.
	Pass around much more "PlugIn" and "Picman" pointers instead of
	using "current_plug_in" and "the_picman". Needs much more hacking
	though... :(

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-def.[ch]
	* app/plug-in/plug-in-params.[ch]
	* app/plug-in/plug-in-progress.[ch]
	* app/plug-in/plug-ins.[ch]: new files.

	* app/gui/Makefile.am
	* app/gui/plug-in-commands.[ch]
	* app/gui/plug-in-menus.[ch]: ditto.

	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-types.h: changed accordingly.

	* app/pdb/procedural_db.c: changed procedural_db_destroy_args()
	so it can be used from plug_in_args_destroy(). Fixed a parasite
	memory leak (or introduced a new SEGV, we'll see...).

	* app/display/Makefile.am: another "truly ugly hack" until the
	plug-in menu stuff is chopped even more...

	* app/gui/commands.[ch]: removed filters_repeat_cmd_callback() here,
	it is now in plug-in-commands.[ch].

	* app/widgets/picmanitemfactory.[ch]: removed all picman_menu_item_*()
	hacks. We have a PicmanItemFactory available in most cases we used
	to call this functions, and can use picman_item_factors_from_path()
	in all other cases. The item factory stuff needs more work
	anyway...

	* app/app_procs.c
	* app/picmanhelp.c
	* app/display/picmandisplayshell.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/paths-dialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly (includes,
	renamed functions and picman_menu_item_*() removal).

	* app/pdb/fileops_cmds.c
	* app/pdb/help_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2002-03-20  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: pass an additional "Picman"
	pointer to picman_display_shell_set_menu_sensitivity() so we can
	correctly set the state of some items even without a display.
	Set the sensitivity of much more items. Never set submenus
	insensitive so the user can always browse the whole menu
	(according to the GNOME HIG).

	* app/image_map.c
	* app/display/picmandisplay.c
	* app/gui/gui.c: changed accordingly.

	* app/gui/view-commands.[ch]: added a callback for the display
	filters dialog because display related dialogs are going to
	be handled different soon.

	* app/gui/menus.c: use the new callback.

2002-03-20  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: registered PicmanConvertDitherType and
	skip PICMAN_NODESTRUCT_DITHER since the comment said it should never
	be used.
	
	* app/gui/convert-dialog.c: simplified a lot by using enums.

	* app/tools/paint_options.c: include picmanenummenu.h.

	* app/pdb/convert_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2002-03-20  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-menu-selection-to-channel.png: one
	more icon from Jimmac.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/imagerc: add it.

	* app/gui/menus.c: use it.

2002-03-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.c: fixed a bug i introduced when making
	the tab_height configurable: need to connect the signals of the
	new tab_widget created in style_set(), otherwise we get the
	functionality of a plain GtkNotebook...

	* app/widgets/picmanfontselection.c: make the minimal width of the
	entry even smaller so users can choose to put it in a small dock.

	* app/widgets/picmanpaletteeditor.c: fixed "Zoom All" zoom ratio
	calculation.

2002-03-19  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/base-enums.c
	* app/core/Makefile.am
	* app/core/core-enums.c
	* app/widgets/Makefile.am
	* app/widgets/widgets-enums.c: purely cosmetic change.
	
	* app/paint/Makefile.am
	* app/paint/paint-enums.[ch]: generate paint-enums.c with registered
	enums. Skip PICMAN_BRUSH_PRESSURE and PICMAN_CUSTOM_CONVOLVE so they
	don't get exported to libpicman and are not registered as enum values.

	* tools/pdbgen/pdb/paint_tools.pdb: removed special casing of
	PicmanBrushApplicationMode and PicmanConvolveType since the forbidden
	values are now skipped anyway.

	* libpicman/picmancompat.h: removed compat defines for the forbidden
	enum values. They shouldn't have been used.

	* app/tools/Makefile.am
	* app/tools/tools-enums.[ch]: generate tools-enums.c with registered
	enums.
	
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.h
	* app/paint/picmandodgeburn.h
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.[ch]
	* app/tools/picmandodgeburntool.c
	* app/tools/paint_options.c: changed accordingly. Added more enum
	radio frames and enum option menus.

2002-03-19  Sven Neumann  <sven@picman.org>

	* ChangeLog.plug-ins
	* PLUGIN_CVS: removed these files, they have never been used.

2002-03-19  Sven Neumann  <sven@picman.org>

	* app/paint/Makefile.am
	* app/paint/paint-enums.h
	* app/paint/paint-types.h: split enums into their own file and
	namespacified them.
	
	* app/tools/Makefile.am
	* app/tools/tools-enums.h
	* app/tools/tools-types.h: split enums into their own file.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.[ch]
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/paint_options.c
	* plug-ins/gfig/gfig.c: changed accordingly.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: added compatibility defines for
	changed enums.

	* tools/pdbgen/Makefile.am: updated list of headers to parse for enums.

	* app/pdb/paint_tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/paint_tools.pdb: regenerated.

2002-03-19  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: Oops, PicmanContainer's "reorder" signal has more
	parameters than "add" and "remove", which is quite relevant now
	that we use the data pointer passed to the callback :)
	Pointed out by Dave Neary on #picman.

2002-03-19  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-types.h: added enum PicmanMotionMode which can be
	one of { EXACT, HINT, COMPRESS }.

	* app/tools/picmantool.[ch]: removed tool->perfectmouse and added
	tool->motion_mode. Default to PICMAN_MOTION_MODE_HINT.

	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c: set PICMAN_MOTION_MODE_EXACT.

	* app/tools/picmanfuzzyselecttool.c: set PICMAN_MOTION_MODE_COMPRESS.

	* app/tools/picmaneditselectiontool.[ch]: ditto. Removed
	gtkutil_compress_motion().

	* app/display/picmandisplayshell-callbacks.c: look at
	active_tool->motion_mode and perform pointer grabbing and motion
	compression accordingly. Also, don't request motion hints from
	XInput devices because the wacom driver sends crap (fixes #6901).
	This change also brings hints and ordinary motions back in sync
	albeit compression, so IMHO it also fixes #68542 and #22375, but
	this needs further investigation.

2002-03-18  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-enums.[ch]: use picman_mkenums to create 
	widgets-enums.c, added it to CVS since it contains translatable
	messages now.

	* app/widgets/picmanenummenu.[ch]: added new functions 
	picman_enum_radio_box_new() and picman_enum_radio_frame_new() that create
	groups of radio buttons out of enum types.

	* app/core/core-enums.[ch]: registered more enums.
	
	* app/paint/picmandodgeburn.h
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/transform_options.[ch]: use picman_enum_radio_frame_new()
	for some tool options.

2002-03-18  Manish Singh  <yosh@picman.org>

	* app/gui/preferences-dialog.c: slight cosmetic fix to make the
	treeview look nicer.

2002-03-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.h
	* app/tools/paint_options.c: put the "Fade Out" and "Gradient" stuff
	into separate frames with togglebutton titles.

	* app/widgets/picmanchannellistview.c: use
	picman_image_mask_select_channel() instead of reinventing the wheel.

	* app/widgets/picmanvectorslistview.c: removed unneeded inclusion
	of "core/picmanimage-mask.h".

	* app/widgets/picmancolormapeditor.c: set the hex entry to 7 digits,
	some cleanup.

	* app/widgets/picmanpaletteeditor.c: set the vertical scrollbar
	to GTK_POLICY_AUTOMATIC.

	Added support for configuring some more GUI dimensions using
	widget class style properties:

	* app/widgets/picmandock.c: made "separator_height" work correctly.
	* app/widgets/picmandockbook.c: added "tab_height".
	* app/widgets/picmaneditor.c: added "button_icon_size".
	* app/widgets/picmanimagedock.c: added "minimal_width".
	* app/widgets/picmantoolbox.c: added "tool_icon_size".

	* themes/Default/gtkrc: set the properties to their default values
	for documentation.

	* etc/gtkrc_user: added a (commented out) example style which makes
	lots of things smaller.

2002-03-18  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* app/core/core-types.h: more enum cleanup (PicmanOffsetType, MergeType).

	* app/core/picmandrawable-offset.c
	* app/core/picmanimage-merge.[ch]
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* tools/pdbgen/pdb/image.pdb: changed accordingly.
	
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.
	
2002-03-18  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* app/core/core-types.h: more enum cleanup (ChannelOps this time).

	* app/core/picmanchannel.[ch]
	* app/core/picmanimage-mask-select.[ch]
	* app/gui/channels-commands.c
	* app/gui/vectors-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/tools-types.h
	* app/widgets/picmanchannellistview.[ch]
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: changed accordingly.

	* app/pdb/channel_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2002-03-18  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* app/core/core-types.h: more enum cleanup (ConvertPaletteType and 
	ConvertDitherType this time).

	* app/core/picmanimage-convert.[ch]
	* app/gui/convert-dialog.c
	* tools/pdbgen/pdb/convert.pdb: changed accordingly.

	* app/pdb/convert_cmds.c
	* libpicman/picmanconvert_pdb.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2002-03-18  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* app/core/core-types.h: moved some more enums into the right place
	and namespacified them.

	* app/undo.c
	* app/core/picmandrawable-bucket-fill.[ch]
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanlayer.[ch]
	* app/display/picmandisplayshell-dnd.c
	* app/gui/channels-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/layers-commands.c
	* app/gui/menus.c
	* app/tools/picmanbucketfilltool.c
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/misc_tools.pdb: changed accordingly.

	* libpicman/picmancompat.h
	* plug-ins/script-fu/siod-wrapper.c: added compat defines for changed
	PicmanMaskApplyMode enum.

	* tools/pdbgen/enums.pl
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c: regenerated.

	* app/paint-funcs/paint-funcs.c: ifdef'ed out some debug output and
	reindented.

2002-03-18  Tuomas Kuosmanen  <tigert@ximian.com>

	* themes/Default/images/stock-button-eye.png: Added some
	antialiasing to the "show layer" icon now that gtk2 supports
	it.. (whee! :-)

2002-03-17  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/app.pl
	* tools/pdbgen/enumcode-py.pl
	* tools/pdbgen/enumcode.pl
	* tools/pdbgen/enumgen.pl: removed enum nick support, best to keep
	internal and external names consistent

	* app/core/core-enums.h: remove chops from enums. Change TRANS to
	TRANSPARENT in PicmanBlendMode

	* app/core/core-types.h: remove chops and nicks from enums. Change INV
	to INVERSE and SUB to SUBTRACT to make things more clear

	* app/core/picmanchannel.c
	* app/gui/channels-commands.c
	* app/gui/vectors-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/selection_options.c
	* app/tools/tools-types.h
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmanvectorslistview.c: reflect SUB -> SUBTRACT change

	* app/core/picmandrawable-blend.c: reflect TRANS -> TRANSPARENT change

	* app/core/picmanlayer.c
	* app/gui/layers-commands.c: reflect INV -> INVERSE change

	* app/paint/paint-types.h: remove nick from PaintApplicationMode

	* app/tools/picmanerasertool.c: fix tooltip

	* app/widgets/picmanenummenu.c: #include "libpicman/picmanintl.h" for
	gettext

	* libpicman/picmancompat.h: compatibility enums here, since we removed
	the nicks

	* tools/pdbgen/enums.pl
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* app/core/core-enums.c
	* app/pdb/channel_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated, enum changes

	* plug-ins/common/hot.c: PICMAN_TRANS_IMAGE_FILL -> PICMAN_TRANSPARENT_FILL

	* plug-ins/common/warp.c: PICMAN_BG_IMAGE_FILL -> PICMAN_BACKGROUND_FILL

	* plug-ins/script-fu/siod-wrapper.c: compat constant definitions

2002-03-17  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: registered more enums.

	* app/tools/picmanblendtool.c: use PicmanEnumMenus.

2002-03-17  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c: open the file with O_TRUNC.

2002-03-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: new function to set the sensitivity
	of an option_menu.

	* app/base/base-enums.[ch]: register and describe PicmanHistogramChannel.

	* app/core/Makefile.am
	* app/core/core-enums.[ch]: build with picman-mkenums, added core-enums.c
	to CVS, added descriptions for PicmanPreviewSize.
	
	* app/display/Makefile.am
	* app/display/display-enums.[ch]: build with picman-mkenums, added 
	display-enums.c to CVS, added descriptions for PicmanCursorMode.

	* app/gui/preferences-dialog.c: more PicmanEnumMenus.

	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanlevelstool.c: use a PicmanEnumMenu for the Channel menu.
	Allow alpha channel in HistogramView. These tools needs more work...

2002-03-17  Sven Neumann  <sven@picman.org>

	* tools/picman-mkenums: allowing NULL for names was a bad idea...

	* app/base/base-enums.[ch]: added more descriptions.

2002-03-17  Sven Neumann  <sven@picman.org>

	* configure.in: define PICMAN_MKENUMS for use in Makefile.am.

	* tools/Makefile.am
	* tools/picman-mkenums: a modified version of glib-mkenums that parses
	literal descriptions for enum values out of the header file.

	* app/base/Makefile.am
	* app/base/base-enums.h: added descriptions for the InterpolationType.
	
	* app/base/base-enums.c: added to CVS although it is generated since
	translatable messages are extracted from this file and translators
	shouldn't need to build stuff.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanenummenu.[ch]: new widget to create a GtkMenu or a
	GtkOptionMenu directly from a registered enum.

	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/tools/transform_options.c: use picman_enum_option_menu_new() for
	the Interpolation menus.

2002-03-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.[ch]: namespaceified and cleaned
	up a lot. Removed the menu code.

	* app/gui/menus.c: added a "<ColormapEditor>" item factory...

	* app/gui/Makefile.am
	* app/gui/colormap-editor-commands.[ch]: ...and callbacks for the
	new factory.

	* app/gui/menus.c: Cleaned up a lot. Removed most static variables.
	Enabled the menu debugging code again. Moved all debug and test
	entries to <Toolbox>/File/Debug. Added an "Open Recent" submenu
	to <Image>/File because it was a one-liner after the cleanup...

	* app/widgets/picmaneditor.c: create the icons in GTK_ICON_SIZE_MENU.
	Need to make this configurable using a style property...

2002-03-16  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/colormap-dialog.[ch]: removed...

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancolormapeditor.[ch]: ...and added here.

	* app/gui/dialogs-constructors.c: changed accordingly.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-menu-convert-grayscale.png
	* themes/Default/images/stock-menu-convert-indexed.png
	* themes/Default/images/stock-menu-convert-rgb.png
	* themes/Default/images/stock-menu-merge-down.png
	* themes/Default/images/stock-menu-reshow-filter.png
	* themes/Default/images/stock-menu-rotate-180.png
	* themes/Default/images/stock-menu-rotate-270.png
	* themes/Default/images/stock-menu-rotate-90.png
	* themes/Default/images/stock-menu-scale.png: new icons from Jimmac.

	* themes/Default/images/stock-menu-resize.png: my own doing. Someone
	needs to look at it :)

	* themes/Default/imagerc
	* libpicmanwidgets/picmanstock.[ch]: added them.

	* app/gui/menus.c: use them.

2002-03-16  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-filter-dialog.c: treeviewized
	and undeprecated.

	* app/widgets/Makefile.am
	* app/widgets/picmanconstrainedhwrapbox.[ch]: removed this hack.

	* app/widgets/picmancontainergridview.[ch]: added "rows" and
	"columns" fields, connect to the viewport's "size_allocate" signal
	and set the size_request of the wrap_box in the callback.

2002-03-15  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: renamed shell->cd_list to
	shell->filters and shell->cd_ui to shell->filters_dialog.

	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-filter.c
	* app/display/picmandisplayshell-render.c
	* app/gui/dialogs-constructors.c: changed accordingly.

	* app/display/picmandisplayshell-filter-dialog.c: cleaned up the GUI.
	Still deprecated GtkCLists around...

	* app/widgets/picmaneditor.[ch]: added picman_editor_new().

	* app/gui/image-commands.[ch]
	* app/gui/menus.c: added "<Image>/Image/Crop Image" because i was
	sick of clicking 20 times just to crop to the current selection.

	* themes/Default/gtkrc: removed "picman-dock-style" and changed
	"picman-gtk-icons" to "picman-default-style". Set our widget class
	style property defaults there.

2002-03-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colorify.c: applied a patch from Maurits Rijk 
	<lpeek.mrijk@consunet.nl> that gives a nice speedup (#74563).

2002-03-14  Manish Singh  <yosh@picman.org>

	* app/tools/picmanfuzzyselecttool.c: add missing support for
	anchoring a selection (bugfix ported from stable branch)

2002-03-14  Michael Natterer  <mitch@picman.org>

	Re-enabled the display filters. They work exactly the same way
	as before except for the color_area pseudo-display. More stuff
	to come...

	* app/display/Makefile.am: build them again.

	* app/display/picmandisplayshell-filter-dialog.[ch]
	* app/display/picmandisplayshell-filter.[ch]: changed to the new
	namespace, work on PicmanDisplayShell instead of PicmanDisplay.

	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]: changed accordingly.

	* app/gui/dialogs-constructors.c: enabled the dialog constructor.

	* app/gui/gui.c: call the init() function.

	* app/gui/menus.c: enabled the menu entry, but moved it to
	<Image>/View. Moved "Undo History..." to <Image>/Image.

	* modules/Makefile.am: build and install the modules.

	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c: made them compile with minimal
	changes.

	Unrelated:

	* app/undo_history.c: connect to the image's "disconnect", not
	"destroy" signal.

	* app/tools/picmanselectiontool.c: mask out the irrelevant parts of
	the "state" passed to the modifier_key() func, so tool_options
	button toggling works with other modifiers (e.g. num_lock)
	pressed.

2002-03-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolorpickertool.c: oops, including removed files
	is a bad idea...

2002-03-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmantoolinfo.c: g_strdup() the stock_id passed to
	picman_tool_info_new() because the caller's memory may disappear
	after registering the tool (tool modules).

	Made a PicmanDock out of the toolbox:

	* app/gui/Makefile.am
	* app/gui/color-area.[ch]
	* app/gui/indicator-area.[ch]
	* app/gui/toolbox.[ch]: removed...

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmantoolbox-color-area.[ch]
	* app/widgets/picmantoolbox-indicator-area.[ch]
	* app/widgets/picmantoolbox.[ch]: ...and added here.

	* app/widgets/picmandock.[ch]: don't set a minimal width. Added a
	"destroy_if_empty" boolean so we can prevent destruction of the
	toolbox if it's last dockable is removed. Added picman_dock_construct()
	which is called from PicmanImageDock and PicmanToolbox.

	* app/widgets/picmanimagedock.[ch]: Default to not showing the image
	menu, set a minimal width here, misc. minor cleanup.

	* app/widgets/picmandockbook.c: some more PICMAN_IS_IMAGE_DOCK()
	checks, fixed dnd widget creation.

	* app/widgets/picmandialogfactory.[ch]: changed
	picman_dialog_factories_toggle() to take just the toolbox_factory as
	parameter. When restoring the session use the created dock's
	dialog factory to create dockables, not the the factory we
	created the dock from (for the toolbox).

	* app/display/picmandisplayshell-callbacks.c: changed accordingly.

	* app/gui/dialogs.[ch]: create an own dialog factory for the toolbox
	and set dialogs_toolbox_new() as it's new_dock_func.

	* app/gui/dialogs-constructors.[ch]: changed dialogs_toolbox_get()
	accordingly.

	* app/gui/dialogs-commands.[ch]: added dialogs_show_toolbox(), ckeck
	if a dock is really a PicmanImageDock before casting.

	* app/gui/gui.c
	* app/gui/menus.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

	* app/gui/color-notebook.c
	* app/gui/color-select.c
	* app/gui/colormap-dialog.c
	* app/gui/palette-editor-commands.c: removed useless inclusion of
	"gui/color-area.h".

	* themes/Default/gtkrc: set "picman-dock-style" for PicmanToolbox widgets.

2002-03-13  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/lib.pl: autogenerated libpicman/picman_pdb.h

	* tools/pdbgen/app.pl: fix a bug in the file open error message

	* libpicman/picman_pdb.h: now generated

2002-03-13  Sven Neumann  <sven@picman.org>

	* app/Makefile.am (SUBDIRS): moved pdb directory to the end.
	
	* app/paint/Makefile.am: removed the ugly hack. Seems to work w/o it.

	* themes/Default/Makefile.am: don't build inline pixbuf headers here.

	* themes/Default/images/Makefile.am: build them here with a hack
	that extracts the icon names out of the filenames. Cleaner Makefile
	and correct dependencies.

	* themes/Default/imagerc
	* themes/Default/images/stock-button-reset.png: added a reset button
	(which looks just like refresh at the moment).
	
	* configure.in
	* themes/Default/images/tools/Makefile.am: removed.

	* libpicmanwidgets/picmanstock.c
	* libpicmanwidgets/picmanwidgets.c: include the pixbuf headers from their
	new places.

2002-03-13  Michael Natterer  <mitch@picman.org>

	* app/gui/brush-select.[ch]: renamed parameters to be consistent
	with the other foo-select.* files.

	* app/gui/tool-options-dialog.c: removed unused function.

	* app/plug-in/plug-in-types.h: PlugInImageType was accidentially
	exported to the PDB.

	* tools/pdbgen/enums.pl
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c: regenerated.

	More brush, pattern, ... PDB wrapper cleanup:

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: even more cleanup, guard
	all functions with if(!picman->no_interface).

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb: reordered functions to be
	consistent across all files. Generate libpicman wrappers for *all*
	functions because of API symmetry.

	* tools/pdbgen/pdb/gradients.pdb: renamed gradients_[get|set]_active
	to gradients_[get|set]_gradient because of API symmetry.

	* libpicman/picmancompat.h: added the old function names here, guard
	the whole file with PICMAN_ENABLE_COMPAT_CRUFT (it's back, yeah).

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/gflare/gflare.c: use the new function names.

	* libpicman/picmanbrushes_pdb.[ch]
	* libpicman/picmangradients_pdb.[ch]
	* libpicman/picmanpalettes_pdb.[ch]
	* libpicman/picmanpatterns_pdb.[ch]
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c: regenerated.

2002-03-13  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h: register PicmanChannelType and 
	PicmanSelectionControl enums with the type system.

	* app/core/picmanimage.c: use them in signal declarations.

	* app/widgets/Makefile.am
	* app/widgets/widgets-enums.h
	* app/widgets/widgets-types.h: split enums into it's own file and
	generate widgets-enums.c. Register PicmanZoomType enum.

	* app/widgets/picmannavigationpreview.c: use PICMAN_TYPE_ZOOM_TYPE.

2002-03-12  Michael Natterer  <mitch@picman.org>

	* app/config/picmanguiconfig.[ch]: removed "global_paint_options".

2002-03-12  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.[ch]
	* app/gui/preferences-dialog.c
	* app/paint/picmanpaintoptions.[ch]
	* app/tools/paint_options.[ch]
	* app/tools/tool_manager.[ch]: removed the "global_paint_options"
	picmanrc option because it doesn't quite fit the new dockable dialog
	architecture.

	* app/gui/brush-select.[ch]
	* app/gui/gradient-select.[ch]
	* app/gui/palette-select.[ch]
	* app/gui/pattern-select.[ch]: removed the "Global Brush/Pattern/...
	Selection" part of them. They are now only used for temp popup
	selections and the PDB. *Lots* of cleanup.

	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/palette-import-dialog.c
	* app/plug-in/plug-in.c: changed accordingly.

	Cleaned up the palette and other data PDB stuff:

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl: added "palette_select" and "palettes".

	* tools/pdbgen/pdb/palette_select.pdb: new file. Makes the palette
	selection PDB controllable.

	* tools/pdbgen/pdb/palettes.pdb: new file cut out of palette.pdb
	because of API symmetry with brushes, patterns, ...

	* tools/pdbgen/pdb/palette.pdb: removed from here.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: lots of cleanup.

	Autogenerated stuff:

	* app/pdb/Makefile.am
	* app/pdb/palette_select_cmds.c
	* app/pdb/palettes_cmds.c: new files.

	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c: regenerated.

	* libpicman/Makefile.am
	* libpicman/picman_pdb.h
	* libpicman/picmanpalettes_pdb.[ch]
	* libpicman/picmanpaletteselect_pdb.[ch]: new files.

	* libpicman/picmangradientselect_pdb.[ch]
	* libpicman/picmanpalette_pdb.[ch]
	* libpicman/picmanpatterns_pdb.c: regenerated.

2002-03-11  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c: use a PangoAttributeList instead of
	PangoMarkup for the frame header. Also removed bold attribute and 
	hardcoded size_request.

2002-03-11  Michael Natterer  <mitch@picman.org>

	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c: proofreading by bex.

	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/pattern-select.c: cleaned up the
	foo_select_change_callbacks() functions a bit.

2002-03-11  Sven Neumann  <sven@picman.org>

	* app/gui/user-install-dialog.c: fixed typo (#74248).

2002-03-11  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.5.

	* NEWS: updated.
	
	* themes/Default/imagerc: fixed typos.

2002-03-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayerlistview.[ch]: added a PicmanAnchorItemFunc
	and use it if it's set.

	* app/widgets/picmanitemlistview.c: removed the floating selection
	special case hack from the remove_item callback.

	* app/gui/layers-commands.[ch]: added layers_remove_layer() and
	layers_anchor_layer(). Fixed sensitive setting of the "Anchor"
	menu item.

	* app/gui/dialogs-constructors.c: use the new functions when
	constructing the layers dialog. Makes deleting and anchoring
	floating selections from the layers dialog work without hacking
	or code duplication.

	* app/widgets/picmandialogfactory.c: added comments about dialog
	destruction in dispose().

2002-03-10  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.h: removed type checking casts from
	macros which return parts of pseudo-widgets.

	* app/widgets/picmanbrushfactoryview.c: changed accordingly.

	* app/widgets/picmandialogfactory.c: added a "dispose"
	implementation used to destroy all dialogs the factory has
	created.

	* app/gui/toolbox.[ch]: removed toolbox_free(), removed the static
	"toolbox_shell" variable, set the active tool correctly on
	creation, don't show the window here (fixes session menagement),
	take the vbox' spacing into account when calculating the window's
	resize hints.

	* app/gui/gui.c: don't include "toolbox.h", don't call
	toolbox_free().

	* app/widgets/picmanfontselection.c: set the width of the entry to
	16 chars on creation so it doesn't fall back to it's insanely
	large default width, minor stuff.

	* app/tools/picmantexttool.c
	* app/tools/selection_options.c: some more scale_entries.

2002-03-10  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/tool-options-dialog.[ch]: made the tool options dialog
	dockable. Create a fancy tab for it which looks like the old
	dialog header.

	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/toolbox.c: changed accordingly.

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanerasertool.c: moved the tool toggling widgets to
	the top.

	* app/tools/paint_options.c: show the paint mode menu for all
	paint tools but set it insensitive where it makes no sense.
	Reduces flickering and makes the tools' similarity more obvious.

	* app/widgets/picmandataeditor.c: fixed segfault in
	picman_data_editor_set_data() (data may be NULL), don't pass NULL to
	gtk_entry_set_text(), make the name entry insensitive if data ==
	NULL.

	* app/widgets/picmandialogfactory.c: fixed longstanding bug which
	made newly created docks steal the first session entry with a NULL
	widget instead of the first _dock_ session entry with a NULL
	widget. Added even more debugging output. Cleanup.

	* app/widgets/picmandockbook.c: made the tab/menu widget code more
	general to cover the tool options tab.

2002-03-09  Sven Neumann  <sven@picman.org>

	* Made 1.3.4 release.

2002-03-09  Sven Neumann  <sven@picman.org>

	* configure.in: removed intltool version check, it is broken :-(
	Updated dependencies to glib-2.0.0, pango-1.0.0 and gtk+-2.0.0.

	* HACKING
	* INSTALL: updated.
	
2002-03-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanbrushfactoryview.c: forgot some casts.

2002-03-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: return the created label from
	picman_table_attach_aligned(), doc fixes.

	* app/gui/channels-commands.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmansmudgetool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmanlayerlistview.c: use picman_scale_entries instead
	of just hscales in lots of places, so the values are keyboard
	input-able.

2002-03-08  Sven Neumann  <sven@picman.org>

	* configure.in: reorder AC_OUTPUT to make intltool happy, check
	intltool version.

	* Makefile.am: reordered SUBDIRS.
	
2002-03-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch]: changed picman_channel_get_color() to
	not return the color but take a second PicmanRGB* parameter like all
	other _get_color() functions. Reordered some functions to make
	more sense, added some g_return_if_fail().

	* app/core/picmanpalette.[ch]: added picman_palette_[set|get]_n_columns()

	* app/gui/menus.c: added a "<PaletteEditor>" item factory.

	* app/gui/Makefile.am
	* app/gui/palette-editor-commands.[ch]: callbacks for the factory.

	* app/widgets/picmanpaletteeditor.[ch]: removed the menu stuff here,
	added a spinbutton to adjust the number of columns.

	* app/gui/gradient-editor-commands.c: removed usage of "the_picman".

	* app/widgets/picmangradienteditor.c: minor cleanup.

	* app/widgets/picmanbrusheditor.h
	* app/widgets/picmangradienteditor.h
	* app/widgets/picmanpaletteeditor.h: forgot to declare the _get_type()
	functions publically.

2002-03-08  Sven Neumann  <sven@picman.org>

	Handle gtk-doc just like GTK+ does it now:
	
	* configure.in: check for gtk-doc version 0.9. Do not build the API
	reference by default.

	* autogen.sh: pass --enable-gtk-doc to configure.

	* Makefile.am: Added a slightly modified distcheck rule that passes
	--enable-gtk-doc to the configure inside.

	* NEWS: updated.
	
2002-03-08  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added PicmanPaletteEntry typedef.

	* app/core/picmanpalette.h: removed it here.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmaneditor.[ch]: new widget which is the base class
	for everything which is a vbox and has a button area at the
	bottom.

	* app/widgets/picmancontainerview.[ch]: derived from PicmanEditor now.

	* app/widgets/picmandataeditor.[ch]: a PicmanEditor subclass which is
	the base class for the new data editors below.

	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmanitemlistview.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanvectorslistview.c
	* themes/Default/gtkrc: changed accordingly.

	* app/gui/Makefile.am
	* app/gui/brush-editor.[ch]
	* app/gui/gradient-editor.[ch]
	* app/gui/palette-editor.[ch]: removed...

	* app/widgets/picmanbrusheditor.[ch]
	* app/widgets/picmangradienteditor.[ch]
	* app/widgets/picmanpaletteeditor.[ch]: ...and added back as
	PicmanDataEditor subclasses. Lots of cleanup and stuff...

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gui-types.h
	* app/gui/palette-select.c
	* app/tools/picmancolorpickertool.c: changed accordingly.

2002-03-07  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: back to a still splash image.

	* data/images/picman_splash.png: blinkenwilber as seen from the
	berlinerfernsehturm.de.

2002-03-07  Sven Neumann  <sven@picman.org>

	* themes/Default/imagerc: applied patch from Guillermo S. Romero that
	adds missing icons.

2002-03-07  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-*.png: new icon set
	
2002-03-07  Simon Budig  <simon@picman.org>

	* NEWS: updated.

2002-03-06  Sven Neumann  <sven@picman.org>

	* INSTALL: mention libart2.

2002-03-06  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/interface.png: wilber picman
	  session
	* themes/Default/images/preferences/help-system.png: the gnome2
	  help icon (by Tuomas Kuosmanen)
	
2002-03-06  Simon Budig  <simon@picman.org>

	* configure.in
	* app/Makefile.am
	* app/core/Makefile.am: We depend on Libart-2.0 now.

	* app/core/picmanscanconvert.c: Converted the Scan-Conversion to
	use libart. *Way* better results.

2002-03-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushpipe.c
	* app/core/picmanpalette.c: message fixes.

2002-03-06  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/input-devices.png:
	* themes/Default/images/preferences/environment.png:
	* themes/Default/images/preferences/default-comment.png:
	  start replacing generic icons with picman-branded
	
2002-03-06  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/preferences/folders-modules.png
	* themes/Default/images/preferences/folders-themes.png
	* themes/Default/images/preferences/folders-tool-plug-ins.png:
	Some more folder icons for the prefs. dialog.

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders.xcf.gz: changed accordingly.

	* app/gui/preferences-dialog.c: use them.

	* themes/Default/Makefile.am
	* themes/Default/imagerc
	* libpicmanwidgets/picmanstock.[ch]: removed PICMAN_STOCK_PASTE.

	* themes/Default/gtkrc: override GTK_STOCK_PASTE with our icon
	instead.

	* app/gui/menus.c
	* app/widgets/picmanbufferview.c: s/PICMAN_STOCK_PASTE/GTK_STOCK_PASTE/

	* themes/Default/images/Makefile.am: install all icons of the
	default theme so the installed directory can be used as template.

2002-03-05  Michael Natterer  <mitch@picman.org>

	* configure.in: mention picman-remote in the error message if
	Xmu was not found.

	* plug-ins/webbrowser/Makefile.am
	* tools/Makefile.am: removed X_LIBS again because configure adds
	them to LIBXMU now.

2002-03-05  Michael Natterer  <mitch@picman.org>

	* configure.in: Add X_LIBS to LDFLAGS while checking for
	Xmu because GTK_LIBS no longer adds them.

2002-03-04  Michael Natterer  <mitch@picman.org>

	Forgot some gint opacity values:

	* app/core/picmanlayer.[ch]: layer->opacity, picman_layer_new(),
	picman_layer_new_from_tiles()

	* app/core/picmanimage-projection.[ch]: picman_image_projection_opacity()

	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/gui/layers-commands.c
	* app/tools/picmantexttool.c
	* app/widgets/picmanlayerlistview.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/layer.pdb: changed accordingly.

	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.c: regenerated.

2002-03-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-contiguous-region.c: some cleanup, removed 
	unused parameters and code.

	* app/widgets/picmantoolinfopreview.c: fixed stupid bug I introduced
	yesterday.

2002-03-03  Michael Natterer  <mitch@picman.org>

	Use gdouble in a [0.0..1.0] range for opacity values in the whole
	core's API. Convert them using (opacity * 255.999) when passing
	them to base/ and paint-funcs/

	Affected functions:

	* app/core/picmanchannel.[ch]: picman_channel_[set|get]_opacity()
	* app/core/picmanimage.[ch]: picman_image_[apply|replace]_image()
	* app/paint/picmanpaintcore.[ch]: picman_paint_core_[paste|replace]_canvas()

	* app/core/core-types.h: added defines PICMAN_OPACITY_TRANSPARENT
	and PICMAN_OPACITY_OPAQUE, just like the ones from
	paint-funcs/paint-funcs-types.h

	* app/picmanrc.c
	* app/image_map.c
	* app/core/picmancontext.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanlayer.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanpalette.c
	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmansmudge.c
	* app/tools/picmaninktool.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanpreview.c
	* app/xcf/xcf-load.c: changed accordingly, use the new constants.

2002-03-03  Sven Neumann  <sven@picman.org>

	* plug-ins/webbrowser/Makefile.am
	* tools/Makefile.am: GTK_LIBS no longer pulls in X_LIBS for us, so we 
	need to add X_LIBS here.

2002-03-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.[ch]: changed
	picman_image_mask_select_channel() to not take "drawable" and
	"sample_merged" parameters (which are silly in some contexts) but
	simply the offsets of the passed channel.

	* app/gui/channels-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

	* app/tools/picmandrawtool.[ch]: changed picman_draw_tool_draw_lines()
	and _draw_strokes() to take an additional "use_offsets" parameter
	like the other drawing functions.

	* app/path_curves.c
	* app/tools/picmanvectortool.c: changed accordingly.

	* app/paint/picmanpaintcore.c: removed #if 0'ed code which was
	identical to other functions.

	* app/tools/picmanselectiontool.c: use the PicmanEditSelectionTool's
	"arrow_key_func" so it's now possible to keyboard-move the current
	layer and selection with all selection tools. Needs some more
	tweaking...

	* app/tools/picmaniscissorstool.[ch]
	* app/tools/picmanvectortool.[ch]: derive them from PicmanSelectionTool
	to make the modifier key <-> tool options interaction work. Ported
	IScissors to the new way the draw_tool works.

2002-03-02  Sven Neumann  <sven@picman.org>

	* autogen.sh: require intltool-0.17.
	
	* configure.in: require latest glib, pango and gtk+. Bail out if
	libtiff, libjpeg or libpng is not found.  You now need to explicitly
	disable TIFF, JPEG and PNG support.

	* HACKING
	* INSTALL
	* NEWS
	* README: updated.

	* data/misc/Makefile.am: fixed dependencies.

2002-03-02  Sven Neumann  <sven@picman.org>

	* app/core/picmantoolinfo.c
	* app/widgets/picmantoolinfopreview.c: allow RGB previews and do proper
	blending for RGBA. This is wasted effort since we will change the
	PicmanPreview system anyway, but I couldn't stand the awful look any
	longer.
	
	* app/display/picmandisplayshell.c
	* app/gui/file-save-dialog.c: added linebreaks to messages.

2002-03-01  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders-brushes.png
	* themes/Default/images/preferences/folders-gradients.png
	* themes/Default/images/preferences/folders-palettes.png
	* themes/Default/images/preferences/folders-patterns.png
	* themes/Default/images/preferences/folders-plug-ins.png: some new
	icons made from Jimmac's new tool icons and Tigert's abstract
	palette icon.

	* themes/Default/images/preferences/folders.xcf.gz: all folders
	icons as layered image.

	* app/gui/preferences-dialog.c: use them.

2002-02-28  Michael Natterer  <mitch@picman.org>

	* app/gui/preferences-dialog.c: put the title label & icon outside
	the notebook and exchange them when flipping pages. Pass an icon
	to the resolution_calibrate_dialog.

2002-02-28  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.[ch]
	* app/config/picmanguiconfig.[ch]
	* app/gui/toolbox.c: removed the "show_indicators" picmanrc option.
	The toolbox layout will change and thus obsolete it anyway.

	* app/gui/Makefile.am
	* app/gui/input-dialog.[ch]: removed.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c: changed accordingly.

	* app/gui/preferences-dialog.c: Added an "Input Devices" page and
	embed the input_dialog stuff there. Put "Display" and "Monitor"
	under "Interface". Removed the "Session" page. Lots of cleanup and
	reordering of options.  Please comment...

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/input-devices.png: new icon.
	* themes/Default/images/preferences/session.png: removed.

2002-02-28  Sven Neumann  <sven@picman.org>

	* app/gui/resolution-calibrate-dialog.[ch]: take an optional pixbuf
	as eye-candy.

	* app/gui/preferences-dialog.c
	* app/gui/user-install-dialog.c: changed accordingly.

2002-02-28  Michael Natterer  <mitch@picman.org>
	    Sven Neumann  <sven@picman.org>

	* configure.in
	* themes/Default/images/Makefile.am
	* themes/Default/images/preferences/Makefile.am: new directory
	for themeable preferences icons.

	* themes/Default/images/preferences/default-comment.png
	* themes/Default/images/preferences/display.png
	* themes/Default/images/preferences/environment.png
	* themes/Default/images/preferences/folders.png
	* themes/Default/images/preferences/help-system.png
	* themes/Default/images/preferences/image-windows.png
	* themes/Default/images/preferences/interface.png
	* themes/Default/images/preferences/monitor.png
	* themes/Default/images/preferences/new-image.png
	* themes/Default/images/preferences/session.png
	* themes/Default/images/preferences/tool-options.png: added some
	GPL icons from Jimmac's site (http://jimmac.musichall.cz/).

	* app/gui/gui.[ch]: added gui_themes_get_theme_dir() so we can find
	icons which are loaded on demand.

	* app/gui/preferences-dialog.c: added the icons to the tree and
	the notebook page headers. Cleaned up and reduced the code a lot
	by adding utility functions prefs_table_new() and
	prefs_check_button_new().

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-callbacks.[ch]: added a "Default"
	menu entry to the display's color button context menu so we can
	reset the padding color to the theme's bg color.

2002-02-28  Sven Neumann  <sven@picman.org>

	* app/gui/file-commands.c: fixed message string.

2002-02-27  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/stock-button-stroke.png
	* themes/Default/images/stock-button-to-path.png
	* themes/Default/images/stock-button-to-selection.png: removed.

	* themes/Default/images/stock-button-path-stroke.png
	* themes/Default/images/stock-button-selection-stroke.png
	* themes/Default/images/stock-button-selection-to-path.png: new ones.

	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* libpicmanwidgets/picmanstock.[ch]: changed accordingly.

	* themes/Default/images/stock-button-selection-add.png
	* themes/Default/images/stock-button-selection-intersect.png
	* themes/Default/images/stock-button-selection-replace.png
	* themes/Default/images/stock-button-selection-subtract.png: cropped.

	* themes/Default/images/tools/stock-tool-button-brightness-contrast.png:
	a nicer one from Ville PÃ¤tsi.

	* app/gui/menus.c
	* app/widgets/picmanvectorslistview.c: use the new stock items.

	* app/gui/dialogs-commands.c: create the new paths dialog, not the
	old one in dialogs_lc_cmd_callback().

	* app/gui/vectors-commands.c: some more s/Vectors/Path/ in
	user-visible strings.

	* app/app_procs.c: some test code for the filename -> uri migration.

2002-02-27  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanpaintinfo.[ch]: new object for registering
	PicmanPaintCore subclasses, just like PicmanToolInfo for tools.

	* app/core/picman.h: added picman->paint_info_list to hold them.

	* app/core/picmantoolinfo.[ch]: removed the "pdb_string" and
	"paint_core_name" pointers and added a PicmanPaintInfo pointer
	instead.

	* app/core/picmanimage-mask.c
	* app/gui/vectors-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/tool_manager.c: changed accordingly.

	* app/paint/paint-types.h
	* app/paint/paint.c: added paint class registration stuff like
	the tool_manager does.

	* app/paint/picmanairbrush.[ch]
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.[ch]
	* app/paint/picmanpaintbrush.[ch]
	* app/paint/picmanpencil.[ch]
	* app/paint/picmansmudge.[ch]: added register functions which are
	called from paint_init().

	The core object system lives not only in "core/", but in
	core, paint, vectors, file, plug-in and xcf, so I had to hack
	a bit to keep the deps working:

	* app/pdb/pdb-types.h: don't include "paint/paint-types.h"...

	* app/core/core-types.h: ...because it's included here. Moved
	the inclusions of the core's subsystems' "foo/foo-types.h"
	files to the end of the file.

	* app/paint/Makefile.am: Some slimy radioactive uglyness.

	* app/gui/drawable-commands.c
	* app/tools/picmanblendtool.c: removed calling core functions via
	the PDB because it makes no sense to do it manually in only a few
	places.  This needs to be done generically using generated
	wrappers living in "app/commands/" or something...

2002-02-27  Sven Neumann  <sven@picman.org>

	* config.guess
	* config.sub: removed from CVS, they get added by automake -a.

2002-02-26  Sven Neumann  <sven@picman.org>

	* app/gui/tips-dialog.c
	* app/gui/tips-parser.c: added support for simple text markup.

	* tips/picman-tips.xml.in: document and use the new markup tags.

2002-02-26  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: make absolute paths out of relative ones
	passed on the commandline so the PicmanImagefiles can generate
	previews.

	* app/gui/Makefile.am
	* app/gui/drawable-commands.[ch]: new files implementing menu
	callbacks which work not just on layers.

	* app/gui/layers-commands.[ch]: removed them here. Cleanup.

	* app/gui/menus.c: changed accordingly.

	* app/gui/brushes-commands.c
	* app/gui/channels-commands.c
	* app/gui/vectors-commands.c: cleanup. Added macros to get
	rid of code duplication.

2002-02-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/guillotine.c: code cleanup by Maurits Rijk 
	<lpeek.mrijk@consunet.nl> (#72288).

	* plug-ins/script-fu/interp_slib.c: fixed typo (#72673).

2002-02-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemlistview.[ch]: added a "item_activate_func"
	to the struct and the constructor so we can distinguish double
	click from right click in the callbacks.

	* app/widgets/picmanvectorslistview.[ch]: added a "item_stroke_func".

	* app/widgets/picmanchannellistview.c: reorder the "To Selection" button.

	* app/gui/dialogs-constructors.c: changed accordingly.

	* app/gui/menus.c: added separators and some new items to the
	vectors menu. Use the SELECTION_REPLACE, _ADD, ... icons for
	the resp. menu items.

	* app/gui/vectors-commands.[ch]: added empty callbacks for the new
	menu items, put the stroke stuff to an own function which is used
	as "item_stroke_func" when creating PicmanVectorsListViews.

2002-02-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask-select.[ch]: implemented
	picman_image_mask_select_vectors() as simple wrapper around
	picman_image_mask_select_polygon().

	* app/gui/vectors-commands.c: call it from the "to selection"
	callbacks.

	* app/gui/channels-commands.c: use picman_image_mask_select_channel()
	instead of doing the same manually.

	* app/paint/picmanpencil.c: register as "PicmanPencil", not
	"PicmanPencilCore".

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanvectorslistview.[ch]: new PicmanItemListView
	subclass featuring a "To Selection" and "Stroke" button.

	* app/widgets/picmanitemlistview.c: create PicmanVectorsListViews.

2002-02-26  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-stroke.[ch]: added
	picman_paint_core_stroke_vectors() which strokes the whole vector
	using one undo step.

	* app/gui/vectors-commands.c: use the new function.

	* app/tools/picmanvectortool.c: changed to do evil voodoo in
	picman_vectors_tool_set_vectors() and thus to always find a
	display to show the vectors.

2002-02-26  Sven Neumann  <sven@picman.org>

	* NEWS: updated

2002-02-26  Simon Budig  <simon@picman.org>

	* app/gui/vectors-commands.c
	* app/tools/picmanvectortool.c
	* app/tools/picmanvectortool.h: fixed a name of a function
	and corrected picman_vector_tool_set_vectors.

2002-02-26  Michael Natterer  <mitch@picman.org>

	Added some kind of paint core registry. It's ugly and will change...

	* app/core/picman.c: call paint_init() and paint_exit().

	* app/core/picmantoolinfo.[ch]: added "gchar *paint_core_name" to
	the PicmanToolInfo structure and the contstructor.

	* app/tools/tool_manager.c: pass the class names of the
	PicmanPaintCore subclasses to picman_tool_info_new().

	* app/paint/Makefile.am
	* app/paint/paint.[ch]: new files. Simlply ref/unref all paint
	core classes so we can find them using g_type_from_name().

	* app/paint/picmanpaintcore-stroke.[ch]: changed to take an array
	of PicmanCoords, not just gdouble.

	* tools/pdbgen/pdb/paint_tools.pdb: convert the stroke array here.

	* app/gui/vectors-commands.c: ad-hoc implementation of vectors
	stroking.  Double click now sets the active vectors in the vectors
	tool.

	* app/pdb/paint_tools_cmds.c: regenerated.

2002-02-26  Sven Neumann  <sven@picman.org>

	* app/gui/tips-parser.c: some documentation can't hurt.

	* app/tools/Makefile.am
	* app/paint/Makfile.am
	* app/vectors/Makfile.am
	* plug-ins/tools/Makefile.am: fixed dist target. 

2002-02-26  Simon Budig  <simon@picman.org>

	* app/tools/picmandrawtool.c
	* app/tools/picmandrawtool.h: Added function picman_draw_tool_draw_strokes
	to be able to draw lines from a PicmanCoords array.

	* app/vectors/picmananchor.h: removed "active", since this should
	be a GUI thing.

	* app/vectors/picmanstroke.c
	* app/vectors/picmanstroke.h
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanbezierstroke.h: Implemented (and fixed API) for
	interpolation.

	* app/tools/picmanvectortool.c
	* app/tools/picmanvectortool.h: Changed accordingly, we can actually
	draw polylines now.

2002-02-26  Michael Natterer  <mitch@picman.org>

	* app/undo.[ch]: renamed undo_push_layer_rename() to
	undo_push_item_rename(), so channel/vectors renaming is undoable.
	Use "gsize" for all undo size variables. Cleanup.

	* app/undo_types.h: s/LAYER_RENAME_UNDO/ITEM_RENAME_UNDO/.

	* app/core/core-types.h: added LAYER_PROPERTIES_UNDO_GROUP.

	* app/core/picmanimage.c: s/Vectors/Path/ in all user-visible strings.

	* app/core/picmanitem.[ch]: cleanup.

	* app/gui/menus.c: s/"New Path"/"New Path..."/, pass
	"vectors_menu_update" to picman_item_factory_new().

	* app/gui/layers-commands.c: renaming the floating layer
	transforms it into an ordinary layer. Push an undo group around
	around both the "fs_to_layer" and the renaming.

	* app/gui/channels-commands.c
	* app/gui/vectors-commands.c: made renaming undoable, cleanup.

	* app/widgets/picmanitemlistview.c: added an EEKY hack so "Delete"
	is not broken any more for floating selections. Need a better
	solution...

2002-02-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/fileops.pdb: changed dot to underscore in
	implementation of picman_temp_name(). Fixes bug #72324.

	* app/pdb/fileops_cmds.c: regenerated.

	* Makefile.am
	* tips/update.sh: added a script to update po files.
	
2002-02-25  Sven Neumann  <sven@picman.org>

	* app/gui/tips-dialog.c
	* app/gui/tips-parser.c: added proper error handling. This completes
	the new XML-based tips system that closes bug #68846.

2002-02-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanitemlistitem.[ch]: new PicmanListItem subclass
	which handles DND reordering of PicmanItems.

	* app/widgets/picmandrawablelistitem.[ch]: derive from PicmanItemListItem
	and removed the reordering code.

	* app/widgets/picmanlistitem.c: create a PicmanItemListItem if the
	passed viewable is a PicmanItem.

2002-02-25  Sven Neumann  <sven@picman.org>

	* README.i18n: updated
	
	* app/gui/tips-dialog.c
	* app/gui/tips-parser.[ch]: dropped the locale matching magic since
	it would never work for all cases. Instead introduced a special 
	message so translators can specify the exact tips locale.

2002-02-25  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanitem.[ch]: new base class for something which is a
	child of an image, has a PDB ID, a tattoo, parasites and emits
	a "removed" signal.

	* app/core/picmandrawable.[ch]
	* app/vectors/picmanvectors.[ch]: derive from PicmanItem. Removed
	lots of stuff from PicmanDrawable.

	* app/core/picman.[ch]: changed picman->drawable_table and
	picman->next_drawable_ID to picman->item_table and picman->next_item_id.

	* app/undo.[ch]: s/undo_push_drawable_parasite/undo_push_item_parasite/,
	minor cleanups.

	* app/core/picmanlayer.[ch]: changed picman_layer_new_from_tiles() and
	picman_layer_new_from_drawable() to take the "dest_gimage" as
	second, not first parameter.

	* app/image_map.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-histogram.c
	* app/core/picmandrawable-offset.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-pick-color.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/display/picmandisplayshell-dnd.c
	* app/file/file-save.c
	* app/gui/channels-commands.c
	* app/gui/file-save-dialog.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/paths-dialog.c
	* app/gui/toolbox.c
	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c
	* app/plug-in/plug-in.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/widgets/picmandrawablepreview.c: changed accordingly.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanitemlistview.[ch]: new widget implementing most
	of the stuff formerly done by PicmanDrawableListView.

	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmanlayerlistview.c: changed accordingly.

	* app/widgets/picmandnd.[ch]: added a vectors DND type.

	* app/gui/menus.c
	* app/gui/dialogs.c
	* app/gui/dialogs-constructors.[ch]: added a vectors dialog and
	a vectors item_factory.

	* app/gui/Makefile.am
	* app/gui/vectors-commands.[ch]: new files implementing the
	callbacks for the new vectors dialog and item_factory.

	* app/pdb/pdb_glue.h: some more ugly hacks to keep intermediate
	perl code working...

	* tools/pdbgen/pdb.pl: added a vectors type, use PicmanItem for all
	ID lookups.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/misc_tools.pdb
	* tools/pdbgen/pdb/parasite.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: misc changes according to
	stuff above.

	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2002-02-25  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c
	* app/tools/picmanvectortool.[ch]
	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: Fixed various bugs, *including*
	the nasty one from this morning (thanks Mitch).

2002-02-25  Sven Neumann  <sven@picman.org>

	* app/gui/tips-parser.[ch]: strip newlines, tabs and adjacent spaces
	from string values. Added a naive locale match algorithm. We'll see
	how well it works in real life...

	* app/gui/tips-dialog.c: call picman_tips_from_file() with current
	locale. Let GTK+ do the line breaks, assorted cosmetic changes.
	
	* tips/de.po: stripped newlines from translation.

2002-02-25  Michael Natterer  <mitch@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/picmanvectors-preview.[ch]: new files creating dummy
	vectors previews.

	* app/vectors/picmanvectors.[ch]: added a "gimage" pointer.

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c: some object stuff fixes.

2002-02-25  Sven Neumann  <sven@picman.org>

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in: updated, they used to refer to
	po/po2tbl.sed which is no longer existant.

2002-02-25  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.c
	* app/vectors/picmanvectors.h: Changed to a container of
	PicmanStrokes. This will enable it to contain different
	Stroke-types in one Vectors-Object (think Entry in path
	dialog)
	
	* app/vectors/picmanstroke.c
	* app/vectors/picmanstroke.h
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanbezierstroke.h: New Objects: A connected
	component in a vector.
	
	* app/vectors/picmanbezier.c
	* app/vectors/picmanbezier.h: Removed, obsoleted by picmanstroke
	and picmanbezierstroke.

	* app/tools/picmanvectortool.c
	* app/vectors/Makefile.am
	* app/vectors/vectors-types.h
	* app/vectors/picmananchor.h: Changed accordingly.

	There is a nasty bug I am yet unable to find in the tool.
	Don't use it. For some reason a wrong function instead of
	picman_stroke_real_anchor_get_next gets called. I have *no*
	idea, whats wrong here. I stared at the code for hours.

	If somebody has an idea I'd appreciate a hint.

2002-02-25  Sven Neumann  <sven@picman.org>

	* app/gui/Makefile.am
	* app/gui/tips-parser.[ch]: new files. A simple XML parser for the 
	picman-tips.xml file.
	
	* app/gui/tips-dialog.c: Removed old picman_tips.txt parsing code and
	switched to use picman-tips.xml with the new parser. This needs some
	more work ...

2002-02-24  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh: fixed intltool version number, we need intltool 0.15.

	* tips/Makefile.am
	* tips/POTFILES.in
	* tips/de.po
	* tips/picman-tips.xml.in: translation framework for new XML-ized tips
	file. Thanks to Carol for converting the tips to XML.

2002-02-24  Michael Natterer  <mitch@picman.org>

	* app/undo.[ch]
	* app/undo_types.h: added undo stuff for PicmanVectors.

	* app/core/gimimage.c: use the new undo functions. Still unused
	and untested.

2002-02-24  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added parasite undo groups.

	* app/undo.c: added assertions to make undo_push_group_start()
	accept only "UndoType" values and undo_push() only "UndoImplType".

	* app/core/picmandrawable.c: use the new undo group and don't
	include "undo_types.h".

2002-02-23  Michael Natterer  <mitch@picman.org>

	* app/undo_types.h
	* app/undo.[ch]: added new undo type IMAGE_TYPE_UNDO along with
	undo_push_image_type(), removed undoing the base_type from
	IMAGE_SIZE_UNDO. Hacked the undo_names a bit.

	* app/core/picmanimage-convert.c: call undo_push_image_type().

	This removes lots of unneeded invalidations on type/size undo.

2002-02-23  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.c: include undo_types.h to fix the build.

2002-02-23  Michael Natterer  <mitch@picman.org>

	General undo cleanup:

	* app/undo.[ch]: made all undo structs private. Changed all
	undo_push_foo() functions to take useful parameters instead of
	"gpointer foo_ptr" and create the undo structs internally.
	Renamed lots of functions so they are more self-explanatory
	(like undo_push_gimage_mod -> undo_push_image_size). Added some
	undo functions (channel reordering is undoable now).  Never pass
	in a UndoType, as they are reseved for groups now (see below).
	Lots of cleanup and stuff...

	* app/undo_types.h: is a private header now which defines "enum
	UndoImplType" which is reserved for actual undo operations.
	All enum values are named "FOO_UNDO".

	* app/core/core-types.h: added the "UndoType" enum here and don't
	include "undo_types.h" any more. The UndoType values are all
	named "FOO_UNDO_GROUP" and are reserved for undo groups.

	The ID space of actual undo operations and undo groups
	is now strictly disjunct.

	* app/core/picmanchannel.h
	* app/core/picmanimage.h
	* app/core/picmanlayer.h
	* app/core/picmanlayermask.h
	* app/paint/picmanpaintcore.h
	* app/tools/picmantransformtool.h: removed undo struct definitions.

	* app/undo_history.c
	* app/path_transform.h
	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/channels-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/paths-dialog.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/guides.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/undo.pdb: changed accordingly.

	* app/pdb/guides_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

	* app/core/picmanimage.[ch]: added infrastructure for holding a
	PicmanList of PicmanVectors objects. The API is the same as for layers
	and channels. Not used yet.

2002-02-22  Sven Neumann  <sven@picman.org>

	* HACKING
	* Makefile.am
	* autogen.sh
	* configure.in: depend on intltool for handling i18n stuff. This
	means that you need intltool to compile The PICMAN from CVS. Grab
	it from ftp://ftp.gnome.org/pub/GNOME/stable/sources/intltool/
	or out of gnomecvs module intltool. You shouldn't need it if you
	compile The PICMAN from tarball.
	
	* data/misc/Makefile.am
	* data/misc/picman.desktop.in.in: merge translations into the desktop
	file. 

2002-02-22  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: cleaned up --with-sendmail, --enable-threads and
	--enable-mp options. Added --with-gnome-desktop=PATH option.

	* data/misc/Makefile.am
	* data/misc/picman.desktop.in.in: install a GNOME desktop file for
	The PICMAN and create a link so GNOME-2.0 should be able to find it.
	Use --with-gnome-desktop=PATH to override the link location.

	* data/images/Makefile.am
	* data/images/wilber-icon.png: new file to serve as application icon.
	
	* plug-ins/script-fu/script-fu-scripts.c: register script-fu
	SF_ADJUSTMENT parameters as PICMAN_PDB_FLOAT (spotted by Masahiro
	Sakai <zvm01052@nifty.ne.jp>).

2002-02-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanprogress.[ch]: removed...

	* app/display/Makefile.am
	* app/display/picmanprogress.[ch]: ...and added here. Prefixed
	everything with "picman_".

	* app/gui/image-commands.c
	* app/plug-in/plug-in.c
	* app/tools/picmanblendtool.c
	* app/tools/picmantransformtool.c: changed accordingly.

2002-02-22  Michael Natterer  <mitch@picman.org>

	* app/vectors/Makefile
	* app/vectors/Makefile.in: removed.

2002-02-22  Simon Budig  <simon@picman.org>

	* app/vectors/Makefile
	* app/vectors/Makefile.am
	* app/vectors/Makefile.in
	* app/vectors/picmananchor.h
	* app/vectors/picmanbezier.c
	* app/vectors/picmanbezier.h
	* app/vectors/picmanvectors.c
	* app/vectors/picmanvectors.h
	* app/vectors/vectors-types.h: new files, the beginning
	of a new vector infrastructure for picman.
	
	* configure.in
	* app/Makefile.am
	* app/core/core-types.h: changed accordingly.

	* app/tools/Makefile.am
	* app/tools/picmanvectortool.c
	* app/tools/picmanvectortool.h
	* app/tools/tools.c: New tool without practical use (yet),
	using the new infrastructure.

	to be continued...

2002-02-21  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/floating_sel.[ch]: removed...

	* app/core/Makefile.am
	* app/core/picmanlayer-floating-sel.[ch]: ...and added here.

	* app/undo.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage-qmask.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/gui/layers-commands.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* plug-ins/tools/common/picmanbrushselecttool.c
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/layer.pdb: changed includes accordingly.

	* app/pdb/floating_sel_cmds.c
	* app/pdb/layer_cmds.c: regenerated.

2002-02-21  Michael Natterer  <mitch@picman.org>

	Made the paint tool PDB wrappers work again (a bit at least...)

	* app/Makefile.am: changed linking order. libtool sucks.

	* app/undo.c: check if active_tool is a PicmanPaintTool before
	casting it.

	* app/paint/Makefile.am
	* app/paint/paint-types.h: added new files/types.

	* app/paint/picmanpaintoptions.[ch]: new files cut out of
	tools/paint_options.h. Prefixed everything with "Picman". There is
	still GtkWidget* cruft hanging around in the structs...

	* app/paint/picmanpaintcore-stroke.[ch]: utility function
	which paints a stroke array. Needed for the PDB wrappers.

	* app/paint/picmanairbrush.[ch]
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.[ch]
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpaintcore.[ch]
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.[ch]: added *_options_new() functions which
	create correctly initialized options structures without widgets.

	* app/tools/paint_options.[ch]: removed the options struct
	definitions and value initialisations.

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmansmudgetool.c: changed all paint_options functions
	accordingly, s/PaintOptions/PicmanPaintOptions/g etc., removed all
	#if 0'ed non_gui functions.

	* tools/pdbgen/pdb/paint_tools.pdb: use picman_paint_core_stroke().
	We currently leak all paint_options structs created by the PDB
	wrappers, more stuff to come...

	* app/pdb/paint_tools_cmds.c: regenerated.

2002-02-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/glasstile.c: code cleanup based on a patch from
	Maurits Rijk <lpeek.mrijk@consunet.nl> (#72051).

2002-02-21  Michael Natterer  <mitch@picman.org>

	Implemented #66921 (needs picman-*-refresh in PDB)

	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/patterns.pdb: added picman_*_refresh() procedures.

	* tools/pdbgen/pdb/palette.pdb: typo: s/patterns/palettes/

	* app/pdb/gradients_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* app/pdb/patterns_cmds.c
	* libpicman/picmangradients_pdb.[ch]
	* libpicman/picmanpalette_pdb.c: regenerated.

2002-02-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.c: return the corrent value in
	g_return_val_if_fail().

	* app/tools/picmanpainttool.c: removed some more painting logic...

	* app/paint/picmanpaintcore.[ch]: ...and added it here so the PDB
	wrappers can use it too. Added "gboolean use_pressure" which needs
	to be set by PicmanPaintTool so we don't need access to GdkDevices.

2002-02-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colortoalpha.c: optimization and cleanup based
	on a patch from Maurits Rijk <lpeek.mrijk@consunet.nl> (#72044).

2002-02-20  Michael Natterer  <mitch@picman.org>

	Implemented #7100 (initialize layer mask with a copy of the image)

	* app/core/core-types.h: added ADD_COPY_MASK and ADD_INV_COPY_MASK
	enum values.

	* app/pdb/layer_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmanlayer.c (picman_layer_create_mask): implement
	the new layer mask add modes.

	* app/gui/layers-commands.c (layers_add_mask_query): added radio
	buttons for the new modes.

	* app/paint-funcs/paint-funcs.c (flatten_region): this function
	was never needed so nobody noticed that it never worked. Fixed now.

	* app/undo.c
	* app/core/picmanlayermask.h
	* app/core/picmanimage.c: the "mode" field of LayerMaskUndo is
	obsolete since some earlier 1.3 layer mask change. Removed it.
	(Makes mask undos work again)

2002-02-20  Michael Natterer  <mitch@picman.org>

	Implemented #10125 ("quick" colour picker does not honour
	"sample merged")

	* app/tools/picmancolorpickertool.[ch]: made definition of
	PicmanColorPickerToolOptions public.

	* app/tools/picmanpainttool.c: get the color picker's tool_options
	and pick colors accordingly. Also draw a rectangle for
	"sample_average".

2002-02-20  Michael Natterer  <mitch@picman.org>

	Oops, yesterday's "fix" for #10466 made it even worse :)

	* app/core/picmandrawable-transform.c: need the 0.5 offset to
	the pixel's center only for INTERPOLATION_NONE, as the LINEAR
	and CUBIC algorithms already know about their errors.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: some more s/gint/gdouble/ so the
	tools can detect pointer motions again...

2002-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/vinvert.c: applied a patch with some optimizations
	from Maurits Rijk <lpeek.mrijk@consunet.nl> (#71955).

2002-02-19  Michael Natterer  <mitch@picman.org>

	Fixed #10466 (disappearing pixels when rotating by 90 deg):

	* app/core/picmandrawable-transform.c: when transforming backwards
	to find the destination line's sub-pixel source coordinates, we
	need to transform the pixels _center_, not it's upper left corner.

	* app/core/picmandrawable-transform-utils.[ch]: added
	picman_drawable_transform_matrix_rotate_center() which takes double
	center coordinates instead of an integer pixel bounding box.

	* app/tools/picmantransformtool.[ch]: use double instead of int for
	all coordinates except the original bounding box.

	* app/tools/picmanrotatetool.c: use double whenever touching the
	"center" value, so it can be sub-pixel positioned.

2002-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/pagecurl/pagecurl.c: code cleanup based on a patch from 
	Maurits Rijk <lpeek.mrijk@consunet.nl> (#71866).

2002-02-18  Sven Neumann  <sven@picman.org>

	* libpicman/picmanintl.h: removed INIT_LOCALE() macro. Error out if
	config.h wasn't included before.

	* app/main.c: directly call the appropriate functions to set up I18N.
	
	* libpicman/libpicman-intl.h: error out if config.h wasn't included.

	* plug-ins/script-fu/script-fu-intl.h: set codeset to UTF-8.

2002-02-18  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-types.h
	* app/tools/*.[ch]: chain up unconditionally in control(),
	s/ToolAction/PicmanToolAction/g, s/ToolState/PicmanToolState/g.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c: don't touch tool->paused_count
	(setting it to 0 was a hack which should no longer be needed).

	* app/tools/picmandrawtool.c: check if the draw tool has actually
	been started (draw_tool->gdisp != NULL) before calling it's
	draw() function.

	* app/tools/tool_manager.c: simplified tool_manager_control_active():
	simply call picman_tool_control() if gdisp == tool->gdisp.

	* app/tools/picmantool.[ch]: picman_tool_control(): do all the PAUSE,
	RESUME and HALT voodoo here.

	* app/tools/picmanpainttool.c: implemented #9902 (Drawing straight
	lines does not work between different views). It's an evil hack,
	but clearly marked in the source.

2002-02-18  Sven Neumann  <sven@picman.org>

	* app/app_procs.c
	* app/base/temp-buf.c
	* app/core/picmanmodules.c
	* app/plug-in/plug-in.c
	* libpicmanbase/picmanenv.c
	* libpicmanwidgets/picmanfileselection.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/picmanressionist.[ch]: use g_file_test()
	instead of stat() whereever possible. Improves code readability.

2002-02-18  Sven Neumann  <sven@picman.org>

	* configure.in: require latest glib and gtk+ releases (1.3.14).
	Bumped our version number to 1.3.4.

2002-02-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: implement thumbnail loading according
	to the latest version of the Thumbnail Managing standard.
	
	* app/widgets/picmanimagefilepreview.[ch]: draw a GTK_DIALOG_QUESTION 
	pixbuf when no preview is available. The implementation is a bit ugly
	but we can improve this later when PicmanPreview has been generalized
	to accept pixbufs also.

	* themes/Default/gtkrc: register the icons for GtkWidget instead of
	GtkImage so they can be used from other widgets too.

	* plug-ins/common/zealouscrop.c: merged fix for bug #71795 from
	stable branch.

2002-02-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/aa.c: code cleanup based on a patch from 
	Maurits Rijk <lpeek.mrijk@consunet.nl>.

2001-02-17  Manish Singh  <yosh@picman.org>

	* app/core/Makefile.am: add a -DPICMAN_COMPILATION so cpercep can
	optionally include glib.h. This needs to be done in the makefile.msc
	too, but I'm unsure on the right way to do that.

	* app/core/cpercep.c: guard #include <glib.h> in PICMAN_COMPILATION.
	cbrt() is a GNU extension, so define in terms of pow if we aren't
	on glibc. Guard CLAMP against redefinition.

	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/picmanressionist.c: make them build again

2001-02-17  Hans Breuer  <hans@breuer.org>

	* */*/makefile.msc */makefile.msc : from now on use 
	make.msc from $(TOP)/glib/build/win32; all occurences
	of DIRENT removed and general update

	* app/config/makefile.msc app/paint/makefile.msc
	  app/plug-in/makefile.msc themes/Default/makefile.msc :
	new files

	* app/base/base.c : ported to GDir usage

	* app/config/picmanconfig-serialize.c :
	  app/config/picmanconfig-deserialize.c : HAVE_UNISTD_H
	* app/config/picmanconfig.c :
	  app/config/picmanrc.c : HAVE_UNISTD_H, use <io.h> for
	open() prototype and merged pmode parameter 
	(_S_IREAD | _S_IWRITE)

	* app/core/cpercep.c : msvc doesn't have cbrt(), provide
	it via pow(). Also include <glib.h> for painless 'inline'
	definition.

	* app/core/picmandatafiles.c : ported to GDir usage

	* app/core/picmanimage-convert.c : work around a msvc compiler
	limitation (can't convert from uint64 to double)

	* app/file/file-open.c app/file/file-save.c :
	access() -> _access() for G_OS_WIN32

	* app/plug-in/plug-in.c : HAVE_UNISTD_H and <io.h>

	* libpicmanbase/picmanbase.def : updated externals

	* libpicmanbase/picmanenv.c : define WIN32_LEAN_AND_MEAN to
	avoid clashes with incompatible DATADIR definitions

	* libpicmancolor/picmancolor.def : updated externals

	* linpicmanmath/picmanmath.def : updated externals

	* libpicmanwidgets/picmanwidgets.def : updated externals

	* libpicmanwidgets/libpicman-glue.c : adapt to const changes
	of some prototypes

	* plug-ins/makefile.msc : disabled gdyntext

	* plug-ins/gap/iter_ALT/*/*.inc : PicmanRunModeType -> PicmanRunMode

	* plug-ins/FractalExplorer/FractalExplorer.c :
	* plug-ins/gap/gap_lib.c :
	* plug-ins/gfig/gfig.c :
	* plug-ins/gflare/gflare.c :
	* plug-ins/picmanressionist/picmanressionist.c :
	replaced DIRENT usage with GDir

	* plug-ins/script-fu/script-fu-scripts.c : #include <windows.h>
	to get the Sleep() prototype

2002-02-17  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: made
	picman_display_shell_update_icon() public, removed the update_icon
	signal handler and idle function.

	* app/display/picmandisplayshell-handlers.c: added the update_icon
	stuff here so it get's properly dis- and reconnected.

2002-02-17  Michael Natterer  <mitch@picman.org>

	Fixed #34633 (wheel mouse zooming leaves straigth-line helpline on
	image) and maybe some other stuff caused by the misbehaviour
	described below:

	* app/tools/tools-types.h
	* app/tools/tool_manager.c (tool_manager_control_active):

	Removed the "PAUSED" ToolState.

	The possible state transitions were INACTIVE <-> ACTIVE <-> PAUSED,
	where the ACTIVE <-> PAUSED transition was done only in the
	tool_manager, causing the tools's control() never to be called
	when the tool was INACTIVE.

	The PicmanPaintTool however wants to draw on the display when it's
	INACTIVE, and of course wants to be suspended/resumed correctly
	while fiddling with display repainting/scaling/...

	The PAUSED state was also redundant information, since
	(tool->paused_count > 0) is the same information (only more
	correct and independent of tool activity).

	* app/display/picmandisplayshell-scale.[ch]: suspend/resume the
	active tool around _all_ changes to the display's "scale" and
	"offset" fields.  Added new function
	picman_display_shell_scale_by_values() which does that and is called
	from all places which need to change these values.

	* app/tools/picmanmagnifytool.c: changed accordingly.

	Unrelated stuff:

	* app/paint/picmanairbrush.c: added a #warning FIXME.

	* app/tools/picmandrawtool.c: made a warning more verbose.

	* app/tools/picmanpainttool.c: put one more drawable offset
	calculation in { .. }, will make a utility function out of it...

2002-02-16  Manish Singh  <yosh@picman.org>

	* app/gui/file-open-dialog.c: use new GtkFileSelection multiselect
	API.

2002-02-15  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-handlers.c: added back the handler
	which invalidates the display_title on dirty/clean. Removing it
	was simply wrong.

	* app/display/picmandisplayshell-scale.c: don't call
	picman_display_shell_update_title() directly but set
	shell->title_dirty to TRUE before calling gdisplays_flush().

	* app/paint/picmanpaintcore.[ch]: added picman_paint_core_constrain()
	which does the "snap to 15 degrees" stuff formerly done in
	PicmanPaintTool. Call picman_brush_select_brush() in
	picman_paint_core_paint() if paint_state == MOTION, not in several
	other places.  Reordered functions, added some comments and
	documentation.

	* app/paint/picmanairbrush.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmaneraser.c
	* app/paint/picmanpaintbrush.c
	* app/paint/picmanpencil.c
	* app/paint/picmansmudge.c:
	s/CORE_CAN_HANDLE_CHANGING_BRUSH/CORE_HANDLES_CHANGING_BRUSH/g,
	minor cleanup.

	* app/pdb/pdb-types.h: include "paint/paint-types.h"

	* app/tools/picmanpainttool.[ch]: use picman_paint_core_constrain(),
	removed paint_tool->state because it's not needed any more,
	lots of cleanup.

	* tools/pdbgen/app.pl: another eeky special case for "paint/".

	* tools/pdbgen/pdb/paint_tools.pdb: include stuff from "paint/",
	not "tools/".

	* app/pdb/paint_tools_cmds.c: regenerated.

2002-02-14  Michael Natterer  <mitch@picman.org>

	Core/UI separation for the paint tools:

	* configure.in
	* app/Makefile.am
	* app/paint/.cvsignore
	* app/paint/Makefile.am: added new directory for the paint methods
	without GUI and tools around them.

	* app/paint/paint-types.h: typedefs for this module.

	* app/paint/picmanpaintcore-kernels.h
	* app/paint/picmanpaintcore.[ch]: the general paint logic taken
	from PicmanPaintTool.

	* app/paint/picmanairbrush.[ch]
	* app/paint/picmanclone.[ch]
	* app/paint/picmanconvolve.[ch]
	* app/paint/picmandodgeburn.[ch]
	* app/paint/picmaneraser.[ch]
	* app/paint/picmanpaintbrush.[ch]
	* app/paint/picmanpencil.[ch]
	* app/paint/picmansmudge.[ch]: subclasses of PicmanPaintCore,
	implementing their own paint() methods.  Needs more hacking
	to get the GtkWidget pointers out of the options structs.

	* app/tools/picmanpainttool_kernels.h: removed.

	* app/tools/tools-types.h: removed the paint tool enums.

	* app/tools/picmanairbrushtool.[ch]
	* app/tools/picmanclonetool.[ch]
	* app/tools/picmanconvolvetool.[ch]
	* app/tools/picmandodgeburntool.[ch]
	* app/tools/picmanerasertool.[ch]
	* app/tools/picmanpaintbrushtool.[ch]
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmanpenciltool.[ch]
	* app/tools/picmansmudgetool.[ch]: all paint tools are pure GUI
	things now.  PaintOptions and friends still need to be chopped up
	though...

	* app/undo.c: changed PaintUndo to PicmanPaintCoreUndo, some minor
	cleanup.

	* tools/kernelgen.c: changed accordingly.

	* tools/pdbgen/Makefile.am: scan paint/paint-types.h for enums.

	* tools/pdbgen/pdb/paint_tools.pdb: hardcode "success = FALSE" for
	all paint PDB wrappers.  The non-gui stuff is completely broken.
	More commits to come...

	* app/pdb/paint_tools_cmds.c
	* tools/pdbgen/enums.pl: regenerated.

2002-02-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.[ch]: moved all global variables into
	the PicmanPaintTool structure so they have a proper lifecycle and
	it's easier to move them to the upcoming PicmanPaintCore (??)
	object.

	* app/tools/picmanpainttool_kernels.h
	* tools/kernelgen.c: s/SUBSAMPLE/KERNEL_SUBSAMPLE/

2002-02-13  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: moved "Merge Layers" and "Flatten Image" from
	"Layer/" to "Image/", removed them from the "<Layers>" menu
	entirely, moved "Merge Down" after "Anchor Layer" in both menus.

	* app/gui/image-commands.[ch]: moved callbacks from here...

	* app/gui/layers-commands.[ch]: ...to here.

	* app/gui/layers-commands.[ch]
	* app/display/picmandisplayshell.c: changed menu_update functions
	accordingly.

2002-02-12  Nathan Summers  <rock@picman.org>

	* plug-ins/tools/.cvsignore
	* plug-ins/tools/Makefile.am: new directory for tool plug-ins

	* plug-ins/tools/common/.cvsignore
	* plug-ins/tools/common/Makefile.am: unified directory for single-file
	tool plug-ins, just like the "common" subdirectory for plug-ins

	* plug-ins/tools/common/picmanbrushselecttool.[ch]: start of a
	tool plug-in that uses the current brush to select from the image.

	* configure.in
	* plug-ins/Makefile.am: changed accordingly


2002-02-12  Michael Natterer  <mitch@picman.org>

	* app/gui/edit-commands.c: merged partial fix for #62592 from
	stable branch.

2002-02-12  Michael Natterer  <mitch@picman.org>

	* app/gui/resize-dialog.c: merged fix for #63741 from stable
	branch, minor cleanup.

2002-02-12  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c: changed "Nearest Neighbor" interpolation
	to "None".

2002-02-12  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: scale_region_no_resample() no
	longer needs to be public, as we can call
	scale_region(src, dest, PICMAN_INTERPOLATION_NONE).

2002-02-12  Nathan Summers  <rock@picman.org>

	* app/plug-in/plug-in-rc.c: implement a new pluginrc flag,
	"has-init", so that only plug-ins with init functions are
	initialized.

	* app/plug-in/plug-in.ch
	* libpicman/picman.c
	* libpicmanbase/picmanprotocol.ch: send a new picmanwire message,
	GP_HAS_INIT during the query stage if the plug-in needs to be
	initialized.  Only invoke the plug-in in init mode if the plug-in
	has an init function.  Incremented the interface age.

	(inspired by a patch by Tor Lillqvist available at 
	http://bugzilla.gnome.org/showattachment.cgi?attach_id=6214)

2002-02-12  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h: renamed PicmanInterpolationType values to
	something sane and unexported it from the PDB since it was never
	used in any PDB calls.
	
	* app/picmanrc.c
	* app/config/picmancoreconfig.c
	* app/core/picmancoreconfig.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanlayer.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/paint-funcs/paint-funcs.c
	* app/pdb/transform_tools_cmds.c
	* app/tools/transform_options.c
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.
	
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2002-02-11  Nathan Summers  <rock@picman.org>

	* app/plug-in/plug-in.[ch]
	* libpicman/picman.c: added support for the init function in plug-ins 
	(fixes bug #66859).

2002-02-12  Michael Natterer  <mitch@picman.org>

	Made the interpolation type configurable in the scale and
	transform options dialogs (#69251):

	* app/base/base-config.[ch]
	* app/config/picmanbaseconfig.[ch]: removed interpolation_type here...

	* app/core/picmancoreconfig.[ch]
	* app/config/picmancoreconfig.[ch]: ...and added it here.

	* app/picmanrc.c
	* app/gui/preferences-dialog.c: changed accordingly.

	* app/paint-funcs/paint-funcs.[ch]: scale_region: take an
	interpolation_type parameter.

	* app/core/picmanchannel.[ch]
	* app/core/picmandrawable-transform.[ch]
	* app/core/picmanimage-scale.[ch]
	* app/core/picmanlayer.[ch]: pass interpolation_type parameters to all
	scale and transform functions.

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.

	* app/gui/resize-dialog.[ch]
	* app/tools/transform_options.[ch]: added an interpolation_type menu.

	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/tools/picmantransformtool.c: changed accordingly.

	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2002-02-12  Sven Neumann  <sven@picman.org>

	* plug-ins/MapObject/mapobject_preview.c: 
	s/gdk_image_get/gdk_drawable_get_image/

	* plug-ins/MapObject/mapobject_ui.c: fixed wrong refcounting of 
	GtkImage.

2002-02-11  Sven Neumann  <sven@picman.org>

	* libpicmanmath/Makefile.am
	* libpicmanmath/picmanmath.h
	* libpicmanmath/picmanmd5.[ch]
	* libpicmanmath/test-md5.c: added MD5 digest algorithm (based on code
	taken from evolution). We will need this to implement the thumbnail
	standard (http://triq.net/~pearl/thumb-spec.php).

2002-02-11  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.[ch]
	* app/config/picmandisplayconfig.[ch]
	* app/gui/preferences-dialog.c: made the string which appears in
	the display's statusbar configurable separately from the title
	string. They still both have the same default value.

	* app/display/picmandisplayshell.c: changed accordingly.

	Also added lots of new % expansions which implement all stuff
	mentioned in #5843. Didn't apply the original patch because it is
	overly complicated (the same can be acheived using %D and %C).
	Instead, applied a changed version of picman-quinet-000618-0.patch.
	Added %Cx, which expands to 'x' if the image is clean.

	* docs/picmanrc-1.3.5.in
	* etc/picmanrc.in
	* etc/picmanrc.win32: added documentation for the new stuff.

2002-02-11  Nathan Summers  <rock@picman.org>

	* gui/preferences-dialog.c: s/directory/folder/ and other
	bex-approved proofreads.

2002-02-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/jpeg.c: merged fix for bug #69127 from stable branch.

2002-02-11  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbucketfilltool.c
	* app/tools/selection_options.c: added missing tooltips, enabled
	"reset" for the new select/fill transparent toggles.

2002-02-11  Michael Natterer  <mitch@picman.org>

	* etc/picmanrc.in
	* etc/picmanrc.win32: document the new %m image-title-format expansion.

2002-02-11  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.c: small hack that strips the ellipses
	from the "Repeat" and "Re-Show" menu entries.

	* plug-ins/mosaic/mosaic.c: register under "Filters/Distorts", not
	"Filters/Render" because this plug-in changes the image and
	doesn't render something from scratch.

2002-02-11  Sven Neumann  <sven@picman.org>

	* TODO.xml: updated.

2002-02-10  Sven Neumann  <sven@picman.org>

	* Made 1.3.3 release.
	
2002-02-10  Sven Neumann  <sven@picman.org>

	* NEWS: updated.
	
	* app/batch.c
	* app/general.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandata.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/file/file-utils.c: don't include ctype.h, use g_ascii_* 
	functions from GLib instead.

	* app/gui/file-open-dialog.c: disabled multiple selection in the
	file open dialog until this is fixed in GTK+.

2002-02-10  Adam D. Moss  <adam@picman.org>

	* app/core/picmanimage-convert.[ch]:
	RGB->Indexed quantizer version 3.0 (the rest of the commit started
	a year ago -- whoops).  Divide colours within CIE L*a*b* space using
	CPercep module (cpercep.[ch]), colour-match and dither likewise,
	change the underlying box selection criteria and division point
	logic, bump luminance precision upwards, etc. etc.

	* app/core/cpercep.[ch] (new files): utility module used by
	quantizer for quantifying perceptual colour distances

	* app/core/picmanimage-convert-data.h (new file): move the big
	static data arrays out of picmanimage-convert.c

	* app/core/picmanimage-convert-fsdither.h: static-ify data

	* app/core/Makefile.am: add cpercep.[ch] and picmanimage-convert-data.h

2002-02-10  Michael Natterer  <mitch@picman.org>

	* app/undo.c: removed #if 0'ed old display update hackery. Don't
	flush the displays here at all and include nothing from
	"display/".

	* app/undo_history.c
	* app/gui/edit-commands.c: call gdisplays_flush() if undo_pop() or
	undo_redo() return TRUE.

	* app/core/picmanimage-contiguous-region.[ch]: allow a contiguous
	transparent region to be selected/filled (#71058).

	* app/core/picmandrawable-bucket-fill.[ch]
	* app/core/picmanimage-mask-select.[ch]: take a boolean
	fill_transparent/select_transparent parameter and pass it to the
	contiguous region funcion.

	* app/display/picmandisplayshell-dnd.c: pass
	fill_transparent == FALSE to bucket_fill_full because we fill the
	whole drawable anyway here.

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/selection_options.[ch]: added toggle buttons to the
	tool options and pass the value to the fill and select core
	functions.

	* tools/pdbgen/pdb/misc_tools.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: hardcode
	"select_transparent" to FALSE to get the old behaviour. Should
	export the new feature to plug-ins however.

	* app/pdb/misc_tools_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2002-02-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmantoolmodule.[ch]
	* app/tools/tools-types.h
	* app/tools/tools.c: code cleanup, no real changes.

2002-02-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gradmap.c: merged fix for bug #70964 from stable 
	branch.

2002-02-08  Nathan Summers  <rock@picman.org>

	* app/tools/picmantoolmodule.[ch]: split registering classes and
	registering tools into separate functions. Makes tool plug-ins
	actually work!

	* app/tools/tools.c: replaced extremely ugly temporary hack for
	loading tool modules with ugly temporary hack for loading tool
	modules.

2002-02-08  Sven Neumann  <sven@picman.org>

	* app/gui/tips-dialog.c
	* app/gui/user-install-dialog.c
	* libpicmanwidgets/picmanfileselection.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/presets.c
	* plug-ins/script-fu/script-fu-scripts.c: use the term Folder instead
	of Directory (bug #56194).

	* etc/picmanrc.in
	* etc/picmanrc.win32: added global palettes folder to the palettes
	search path.

	* data/misc/user_install: don't copy palettes into users ~/.picman-1.3.
	
2002-02-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.[ch]: added picman_rc_duplicate() and started to
	add inline documentation.
	
	* app/config/test-config.c: test the new functionality.

2002-02-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c: added missing finalizers.

2002-02-07  Nathan Summers  <rock@picman.org>

	* app/tools/picmantoolmodule.[ch]: New class that uses GTypeModule to
	dynamically load tool plugins.  Does not quite work yet, but builds
	correctly.

	* app/tools/tools.c: added some code to test the PicmanToolModule code.

	* app/tools/Makefile.am: added picmantoolmodule to the build.

2002-02-07  Nathan Summers  <rock@picman.org>

	* app/picmanrc.c
	* app/config/picmancoreconfig.[ch]
	* app/core/picmancoreconfig.[ch]
	* app/gui/preferences-dialog.[ch]
	* etc/picmanrc.in: add a preferences option for tool plug-ins,
	in anticipation of future work on them. Tool plug-ins should be 
	in a separate directory so that the plug-in codecan distinguish 
	them.  
	
2002-02-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-new.[ch]: renamed the image size utility
	functions from foo_size_bar() to foo_memsize_bar(), use "gsize"
	instead of "gdouble". Also take the selection mask into account
	for the initial image size.

	* app/display/picmandisplayshell.c
	* app/gui/file-new-dialog.c: changed accordingly.

	* app/display/picmandisplayshell-handlers.c: connect to "undo_event",
	not "dirty" and "clean" to dirty the image title.

	* app/tools/picmanmovetool.c: factored common code out to
	picman_move_tool_start_guide(), also set a useful cursor there.

2002-02-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_message_box): changed the
	message dialog icon to WARNING since we mostly use this for
	warnings. We should change the API so that picman_message knows
	about the severity of the message it displays.
	
	* themes/Default/images/stock-wilber-16x16.png
	* themes/Default/images/stock-wilber-32x32.png
	* themes/Default/images/stock-wilber-48x48.png
	* themes/Default/images/stock-wilber-64x64.png: slightly better icons.

	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-wilber-eek.png: added a new eek wilber
	based on suggestions made in bug-report #65194. Actually I'd like it
	be more eeeky, so feel free to submit a better one.
	
	* libpicmanwidgets/picmanstock.[ch]: register the new stock icon.

	* app/gui/gui.c (gui_really_quit_dialog): use STOCK_WILBER_EEK.

2002-02-07  Sven Neumann  <sven@picman.org>

	* app/gui/file-new-dialog.c
	* app/gui/resize-dialog.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c: moved Cancel button to the left.

	* data/images/Makefile.am
	* data/images/tips_wilber.png: removed ...
	* data/images/wilber-tips.png: ... and readded under a new name.

	* app/gui/tips-dialog.c: changed accordingly.

	* data/images/wilber-wizard.png: new wilber for the user installation
	dialog.

	* app/gui/user-install-dialog.c: use the new wilber icon. We still
	need a good new eeek wilber.

	* themes/Default/gtkrc: don't change the default font size.

2002-02-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.c: made the picman_object_get_memsize()
	debugging output configurable by a global "picman_debug_memsize"
	boolean.

	* app/display/picmandisplay.c: removed duplicated prototype.

	* app/display/picmandisplayshell.[ch]: renamed the various cursor
	functions to be more consistent and shorter. Compress window title
	updates by adding a "gboolean title_dirty" and updating the title
	in picman_display_shell_flush().  Added "%m" (memory size) to the
	possible title string substitutions.

	* app/display/picmandisplay-foreach.c
	* app/display/picmandisplayshell-handlers.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmantool.c: changed accordingly.

	* app/display/picmandisplayshell-callbacks.c: forgot to grab the
	pointer when dragging guides from the rulers. Coincidentially,
	this also fixes the buggy offset between guide and mouse
	pointer...
	Cleaned up the main tool event callback a bit more.

	* app/widgets/picmanpreview.c
	* app/gui/commands.c: set the new global "picman_debug_memsize"
	toggle to TRUE while calling picman_object_get_memsize().

	* app/gui/preferences-dialog.c: added a image title example
	containing the new "%m" feature.

	* docs/picmanrc-1.3.5.in: document "%m" in the manpage.

	* app/tools/picmanbezierselecttool.c: reordered some statements.

	* app/tools/picmandrawtool.[ch]: store the PicmanDisplay passed to
	picman_draw_tool_start() in draw_tool->gdisp and use it for
	coordinate transfomration. This way we can draw on a display
	which is not tool->gdisp.

	* app/tools/picmanpainttool.c: changed the picman_draw_tool_foo()
	calls needed to make the straight_line preview work in a way
	that does not interfere with paint_tool subclasses which want
	to do their own drawing (like the clone tool).

	Also changed the paint_tools PRETRACE_PAINT and POSTTRACE_PAINT
	flags usage in a way that subclasses can use them without major
	hackery: don't simply wrap picman_display_flush_now() with
	PRETRACE/POSTTRACE calls, but wrap the actual painting calls, so
	subclasses are able to do useful things with paint_tool->*_coords.

	* app/tools/picmanclonetool.c: removed poking around in draw_tool
	internals and simply suspend()/resume() it in
	PRETRACE_PAINT/POSTTRACE_PAINT to get the clone_src indicator
	drawn correctly.

2002-02-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/flame/flame.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/maze/maze_face.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/sel2path/sel2path.c: reordered action_area buttons.

	* themes/Default/gtkrc: namespace cleanup.

2002-02-05  Michael Natterer  <mitch@picman.org>

	Removed pointer grabbing from all tools:

	* app/tools/picmantool.[ch]: added "gboolean perfectmouse" which
	defaults to FALSE but can be set to TRUE in a tool's instance_init
	function.

	* app/display/picmandisplayshell-callbacks.c: look at
	active_tool->perfectmouse and picmanrc.perfectmouse and do the
	pointer grab/ungrab here. The pointer is now grabbed right before
	dispatching the button_press to the tool and ungrabbed after
	the tool's button_release has returned. It is also grabbed
	*always*, not only if tool->state got ACTIVE by button_press,
	which makes it all much simpler...

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c: removed
	gdk_pointer_grab()/ungrab() calls all over the place. Also removed
	inclusion of "display/picmandisplayshell.h" from most of them.

2002-02-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]: added fields for both the tool's
	toggled and untoggled GdkCursorType, PicmanToolCursorType and
	PicmanCursorModifier. Added a default implementation of
	picman_tool_cursor_update() which uses the new fields. Added
	picman_tool_set_cursor() as simple wrapper around the resp.
	PicmanDisplayShell functions so tools don't need to know them.

	Tool implementations can either set the new fields in their
	cursor_update() function and chain up or call the new wrapper.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmanpathtool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c: changed accordingly:

	- set default values in the tools' instance_init functions.
	- changed the cursor_update() stuff.
	- removed inclusion of subclasses in picmanpainttool.c
	- the cursor_update() functions are better than before but still evil.
	- i probably broke some of them...

	* app/tools/picmantool.c: fixed NULL pointer dereference by using
	the tools's class name as identifier for picman_statusbar_foo()
	instead of accessing tool->tool_info (which may be NULL)
	(spotted by David Odin).

2002-02-03  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanwidgets.c: ref and sink the adjustment we use
	for the mem_size_entry.

2002-02-03  Manish Singh  <yosh@picman.org>

	* docs/Makefile.am: don't install picman-remote manpage yet

2002-02-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: merged fix from stable branch (#70344).
	
	* plug-ins/common/smooth_palette.c: merged fix from stable branch
	(#70333).

2002-02-03  Manish Singh  <yosh@picman.org>

	* configure.in
	* tools/Makefile.am: commit everything this time (see my previous
	log entry).

2002-02-03  Sven Neumann  <sven@picman.org>

	* configure.in
	* tools/Makefile.am: fixed the build by trying to do the changes
	Yosh didn't commit.

2002-02-03  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/frosty-logo.scm: don't redefine min.
	Thanks to Jeff Trefftzs <trefftzs@tcsn.net> for spotting this.

2002-02-03  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/display/display-types.h
	* app/display/picmanstatusbar.[ch]: new widget derived from
	GtkStatusbar.  Contains the coordinates display, a progress bar
	which is also used for status message display and a cancel button.
	Added a simplified API for pushing/popping messages which takes a
	string as context_id and does the conversion to guint internally
	on each call.

	* app/display/picmandisplayshell.[ch]: removed the status bar code.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-scale.c
	* app/gui/view-commands.c
	* app/picmanprogress.c: changed accordingly.

	Removed knowledge about PicmanDisplayShell from tools:

	* app/tools/picmantool.[ch]: added picman_tool_push_status() and
	picman_tool_pop_status() so tools don't need to fiddle with
	display details.

	* app/tools/picmandrawtool.[ch]: pass a PicmanDisplay instead of
	a GdkWindow to picman_draw_tool_start() (the window passed was
	always gdisp->shell->canvas->window).

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.[ch]
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.[ch]
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.[ch]
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmanpathtool.c
	* app/tools/picmanrectselecttool.[ch]
	* app/tools/picmantransformtool.c: changed accordingly:

	- pass PicmanDisplay to picman_draw_tool_start().
	- use PicmanTool's new status push/pop functions.
	- removed the statusbar context_id from all tool structs.

	* app/gui/dialogs-constructors.[ch]: a bit cleanup in preparation
	of dockable editor dialogs.

2002-02-02  Manish Singh  <yosh@picman.org>

	* configure.in
	* Makefile.am
	* app/Makefile.am 
	* docs/Makefile.am
	* plug-ins/print/Makefile.am
	* tools/Makefile.am
	* (the various manpages): versioned the binaries and manpages.
	Added an --enable-default-binary switch to configure to make
	symlinks for unversioned things (defaults to no for 1.3). The
	perl stuff isn't touched, but that's disabled in the build here
	anyway.

2002-02-01  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanpatheditor.[ch]: treeviewized and undeprecated

	* plug-ins/webbrowser/webbrowser.c: set_size_request takes a 0 size
	and makes it 1 instead of -1 like set_usize did, so pass -1

2002-01-31  Simon Budig  <simon@picman.org>

	* plug-ins/rcm/rcm.c: register as "plug_in_rotate_colormap"
	instead of "plug-in-rotate-colormap". This fixes the usage
	in picman-python (despite the fact that there is no PDB
	interface)

2002-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c
	* app/core/picmandocuments.c
	* app/core/picmanmodules.c
	* app/core/picmanpalette.c: fixed some get_memsize()
	implementations, give useful names to some global objects so the
	new mem profile of "the_picman" looks nicer.

	* app/gui/menus.c
	* app/gui/commands.[ch]: added a "Debug" menu to the toolbox,
	offer a mem profile of the global "Picman" instance.

2002-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: removed picman_layer_has_alpha(), use
	picman_drawable_has_alpha() instead.

	* app/core/picmanimage-convert.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-projection.c
	* app/display/picmandisplayshell.c
	* app/gui/layers-commands.c: changed accordingly.

	* app/core/picmanimage.[ch]: added picman_image_has_alphe(), made some
	variable names more verbose and use enum types instead of "gint"
	in functions calling initial_region() and combine_regions().

	* app/widgets/picmanchannellistview.c: show an alpha channel preview
	only if the image has alpha.

	* app/widgets/picmanpreview.c: reordered functions,
	picman_preview_render_and_flush(): fixed channel preview rendering,
	calculate the component byte offsets before entering the render
	loop instead of duplicating the render code for the gray/alpha
	case.

2002-01-31  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c: use GtkTreeViews instead of 
	deprecated GtkCLists.
	
	* app/widgets/picmanfontselection.c: use a proper size for the eeky hack.

2002-01-31  Manish Singh  <yosh@picman.org>

	* app/gui/file-open-dialog.c: fixed up so it works with the patch
	I posted to gtk-devel-list. Real fix pending discussion there.

2002-01-30  Sven Neumann  <sven@picman.org>

	* app/gui/about-dialog.c: GDK_RGB_DITHER_NORMAL should be good enough.
	
	* app/gui/preferences-dialog.c: undef GTK_DISABLE_DEPRECATED for
	GtkListItem.
	
	* app/widgets/picmancomponentlistitem.c: don't use GtkPreview methods
	on a PicmanPreview. The component views are still broken but at least
	the warnings are gone.
	
	* app/widgets/picmanfontselection.c: fixed warnings by hardcoding a 
	font size when validating a font name :-(
	
	* app/widgets/picmanpreview.c: set allocation to desired size.
	
	* libpicmanwidgets/picmancolorarea.c: flipped so it looks like before
	the port to GtkDrawingArea. Use GDK_RGB_DITHER_MAX to render.

2002-01-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpreview.[ch]: derive from GtkDrawingArea
	instead of deprecated GtkPreview.

	* app/gui/buffers-commands.c
	* app/gui/device-status-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/indicator-area.c
	* app/gui/info-window.c
	* app/gui/palette-import-dialog.c
	* app/gui/palettes-commands.c
	* app/gui/test-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox.c
	* app/widgets/picmandnd.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanmenuitem.c: removed #undef GTK_DISABLE_DEPRECATED.

2002-01-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorarea.c: pass a GdkGC to
	gdk_draw_rgb_image(), fixed dither offsets.

	* app/core/picmanobject.[ch]: new virtual function
	picman_object_get_memsize().

	* app/base/temp-buf.[ch]
	* app/base/tile-manager.[ch]: added *_get_memsize() methods.

	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmanchannel.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandata.c
	* app/core/picmandatafactory.c
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/core/picmanlist.c
	* app/core/picmanmoduleinfo.c
	* app/core/picmanpalette.c
	* app/core/picmanparasitelist.c
	* app/core/picmanpattern.c
	* app/core/picmanpreviewcache.[ch]
	* app/core/picmanundo.[ch]
	* app/core/picmanundostack.c
	* app/core/picmanviewable.c: added get_memsize() implementations.

	* app/widgets/picmanpreview.c
	* app/core/picmanobject.[ch]: some #ifdef DEBUG_MEMSIZE code to
	test the new memsize stuff (middle click any preview to get
	it's viewable's memory footprint).

2002-01-30  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Events.c
	* plug-ins/FractalExplorer/FractalExplorer.[ch]
	* plug-ins/FractalExplorer/Globals.c
	* plug-ins/common/film.c
	* plug-ins/common/plugindetails.c
	* plug-ins/fp/fp_misc.c
	* plug-ins/rcm/rcm_callback.c
	* plug-ins/rcm/rcm_misc.c: removed the ugly hacks and simply define
	GTK_DISABLE_DEPRECATED before including gtk.h.

2002-01-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: derive from GtkDrawingArea
	instead of deprecated GtkPreview.

	* app/nav_window.c
	* app/gui/brush-editor.c
	* app/gui/buffers-commands.c
	* app/gui/color-select.c
	* app/gui/colormap-dialog.c
	* app/gui/device-status-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-open-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/indicator-area.c
	* app/gui/info-window.c
	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.c
	* app/gui/palettes-commands.c
	* app/gui/test-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanitemfactory.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanpreview.c
	* libpicman/picmanbrushmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanmenu.c
	* libpicman/picmanpatternmenu.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/blinds.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/destripe.c
	* plug-ins/common/diffraction.c
	* plug-ins/common/emboss.c
	* plug-ins/common/exchange.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/grid.c
	* plug-ins/common/illusion.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/noisify.c
	* plug-ins/common/nova.c
	* plug-ins/common/plasma.c
	* plug-ins/common/polar.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/sinus.c
	* plug-ins/common/tileit.c
	* plug-ins/common/video.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c
	* plug-ins/flame/flame.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/rcm/rcm_dialog.c: define GTK_DISABLE_DEPRECATED to make
	it compile.

	We really need a generic plug-in preview system that doesn't use
	GtkPreview.

2002-01-30  Sven Neumann  <sven@picman.org>

	* configure.in: depend on glib-1.3.13, pango-0.24 and gtk+-1.3.13.
	Bumped our version number to 1.3.3.

	* NEWS: updated.

2002-01-30  Manish Singh  <yosh@picman.org>

	* app/gui/file-open-dialog.c: ported to the new treeviewized file
	selection widget. Unfortunately, multiple selections aren't supported
	anymore so it's still broke. I'll make a patch to gtk to address this
	after I get some sleep.

	* app/widgets/picmanpreview.h
	* libpicmanwidgets/picmancolorarea.h
	* plug-ins/FractalExplorer/Events.c
	* plug-ins/common/film.c 
	* plug-ins/common/plugindetails.c 
	* plug-ins/fp/fp_misc.c 
	* plug-ins/rcm/rcm_callback.c
	* plug-ins/rcm/rcm_misc.c: REALLY REALLY ugly hack to get things to
	build under the latest enum deprecations. Of course, we'll remove
	these when these files compile with deprecation turned on

	* plug-ins/dbbrowser/dbbrowser_utils.c: warning cleanup

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanoffsetarea.c: need a custom marshaller for
	our signal since the gtk marshaller we used went away.

2002-01-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: added a call to gtk_widget_show() that
	got lost during porting. Now you can shoot the whole screen again.

2002-01-27  Sven Neumann  <sven@picman.org>

	* app/gui/file-new-dialog.c: moved the memory size information out
	of the frame label to avoid redrawing the whole frame for every change.

2002-01-25  Michael Natterer  <mitch@picman.org>

	* configure.in: CPPFLAGS: added -DGTK_DISABLE_DEPRECATED

	* libpicmanwidgets/picmandialog.c: still use the deprecated
	gtk_window_set_policy() but spit out a #warning.

	* app/widgets/widgets-types.h
	* app/widgets/picmanitemfactory.[ch]: made it a GtkItemFactory
	subclass. This way we can reproduce the effect of
	gtk_item_factory_get_from_path() which is deprectated for good
	reasons.  For PICMAN, using it its perfectly OK since we only have
	one item factory per "<prefix>".

	* app/widgets/picmanbrushfactoryview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandialogfactory.[ch]
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmanpreview.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.[ch]: pass around PicmanItemFactory
	pointers instead of "const gchar *" item factory identifiers.
	Replaced gtk_window_set_policy() by gtk_window_set_resizable()
	and other recommended stuff.

	* app/gui/about-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/menus.c
	* app/gui/offset-dialog.c
	* app/gui/splash.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox.c: lots of
	s/gtk_item_factory_from_path/picman_item_factory_from_path/,
	gtk_window_set_policy() replacements, misc fixes.

	* plug-ins/gdyntext/charmap_window.c
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/gdyntext/message_window.c
	* plug-ins/imagemap/imap_main.c: replaced gtk_window_set_policy().

2002-01-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/tga.c
	* plug-ins/common/video.c: compile with GTK_DISABLE_DEPRECATED.

2002-01-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tga.c: merged fix for bug #53278 from stable branch.
	
	* plug-ins/common/tiff.c: merged fix for bug #69129 from stable branch.

2002-01-23  Simos Xenitellis  <simos@hellug.gr>

	* configure.in: Added "el" (Greek) to ALL_LINGUAS.

2002-01-22  Sven Neumann  <sven@picman.org>

	* picmantool-1.3.in: fixed usage info.
	
	* themes/Default/images/Makefile.am: should really install the stock
	icons defined in our gtkrc.

2002-01-18  Raja R Harinath  <harinath@cs.umn.edu>

	* configure.in: Add a few [] to nested AC_CHECK_* invocations.
	Needed for autoconf 2.52, but also the right fix for older
	autoconfs.  (http://bugzilla.gnome.org/show_bug.cgi?id=68958)

	* app/gui/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am: Search for include files in build
	directory too.  (http://bugzilla.gnome.org/show_bug.cgi?id=68961)

2002-01-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/video.c
	* plug-ins/common/vinvert.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/warp.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xpm.c
	* plug-ins/common/xwd.c: compile with GTK_DISABLE_DEPRECATED.

2002-01-14  Rebecca Walter  <bex@picman.org>

	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.c
	* app/gui/paths-dialog.c: more proofreading with help from 
	CyBeR (Marco Wessel)

2002-01-13  Manish Singh  <yosh@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c: I'm dumb, use better sorting.
	It's all _kris_'s fault.

2002-01-13  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanstock.[ch]: removed stock items which are
	already defined in Gtk+ (GTK_STOCK_NEW etc.).

	* libpicmanwidgets/picmanquerybox.[ch]: moved the icon code from the
	boolean query box constructor to create_query_box() so it can be
	used for all of them. New macro PICMAN_QUERY_BOX_VBOX() to pack
	custom widgets into the dialogs. Will probably have to make a
	real widget out of it to get a sane API...

	* app/gui/menus.c
	* app/gui/select-commands.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmandrawablelistview.c
	* libpicmanwidgets/picmanpatheditor.c
	* plug-ins/common/uniteditor.c: changed accordingly.

	* libpicmanwidgets/picmanwidgets.c: register the WM icons in
	large -> small order.

	* themes/Default/Makefile.am: don't create inline pixbufs of the
	removed stock items' icons...

	* themes/Default/gtkrc: ...but simply override them here.

	* themes/Default/imagerc: removed them here too.

2002-01-12  Manish Singh  <yosh@picman.org>

	* plug-ins/dbbrowser/dbbrowser_utils.c: use GtkTreeView and multiline
	labels now. UI still needs some tweaking, but compiles with
	GTK_DISABLE_DEPRECATED.

2002-01-09  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/picman-dialog-error.png
	* themes/Default/images/picman-dialog-info.png
	* themes/Default/images/picman-dialog-question.png
	* themes/Default/images/picman-dialog-warning.png: new stock icons to
	override the standard gtk-dialog icons.

	* themes/Default/images/picman-dialog-icons.xcf.gz: XCF version of the
	new dialog icons.

	* themes/Default/gtkrc: override the standard gtk-dialog icons with
	our versions.

	* libpicmanwidgets/picmanquerybox.[ch]: allow to pass a stock_id instead
	of the boolean eek.

	* app/widgets/picmanwidgets-utils.c: added an icon to the picman_message
	dialog. We need to add an API to declare the severity of the message
	or allow to pass a stock_id. For now all messages habe the Info icon.

	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c: pass a suitable(?) stock_id to 
	picman_query_boolean_box().

2002-01-08  Michael Natterer  <mitch@picman-org>

	* plug-ins/common/tga.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/tiff.c
	* plug-ins/common/tile.c
	* plug-ins/common/tileit.c
	* plug-ins/common/tiler.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/url.c
	* plug-ins/common/zealouscrop.c: compile with
	GTK_DISABLE_DEPRECATED, cleanup.

2002-01-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/xbm.c: merged fix from stable branch.

2002-01-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/sinus.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sobel.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/spread.c
	* plug-ins/common/struc.c
	* plug-ins/common/sunras.c: compile with GTK_DISABLE_DEPRECATED.

2002-01-02  Michael Natterer  <mitch@picman.org>

	* pixmaps/Makefile.am
	* pixmaps/zoom_in.xpm
	* pixmaps/zoom_out.xpm: removed.

	* app/nav_window.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c: use GTK_STOCK_ZOOM_[IN|OUT]
	instead.

2002-01-02  Michael Natterer  <mitch@picman.org>

	* plug-ins/pagecurl/pagecurl.c: compile with GTK_DISABLE_DEPRECATED.

2002-01-02  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpixmap.c: made a warning more verbose.

	* libpicmanwidgets/picmanpixmap.h: no need to fiddle around with evil
	#defines now that it's ported to GtkImage.

2001-12-30  Manish Singh  <yosh@picman.org>

	* app/gui/module-browser.c: add a shadow to the scrolled window, so
	it looks nicer

	* libpicmanwidgets/picmanbutton.c: try to restore gtk_widget_draw behavior

	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpixmap.[ch]: compile with GTK_DISABLE_DEPRECATED

2001-12-31  Sven Neumann  <sven@picman.org>

	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am: use GLIB_CFLAGS instead of GTK_CFLAGS.

	* app/libpicman_glue.[ch]: do not allow anyone but app/libpicman_glue.c
	to include libpicman_glue.h.

	* libpicmanbase/picmanunit.h
	* libpicman/picmanunit.c: cache return values of PicmanUnit PDB calls and 
	return const strings from the PicmanUnit accessor functions just like
	the equivalent functions in the application do.
	
	* plug-ins/common/uniteditor.c: don't free PicmanUnit strings. Don't
	free the result of gtk_entry_get_text() neither.

2001-12-31  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/nlfilt.c
	* plug-ins/common/noisify.c
	* plug-ins/common/nova.c
	* plug-ins/common/oilify.c
	* plug-ins/common/papertile.c
	* plug-ins/common/pat.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/plasma.c
	* plug-ins/common/plugindetails.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/polar.c
	* plug-ins/common/ps.c
	* plug-ins/common/psp.c
	* plug-ins/common/randomize.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c: compile with GTK_DISABLE_DEPRECATED.

2001-12-30  Sven Neumann  <sven@picman.org>

	* app/libpicman_glue.[ch]
	* app/gui/info-window.c: some const fixes.

2001-12-30  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am: nicer output of glib-mkenums.

2001-12-29  Sven Neumann  <sven@picman.org>

	* data/brushes/Makefile.am (brushdata_DATA): added missing brush
	vine.gih.

2001-12-29  Michael Natterer  <mitch@picman.org>
	    Sven Neumann  <sven@picman.org>
	    Simon Budig  <simon@picman.org>

	* Made 1.3.2 release from 18C3.

2001-12-29  Simon Budig  <simon@picman.org>
	    Sven Neumann  <sven@picman.org>

	* data/images/Makefile.am
	* data/images/picman_splash.gif: new blinking splash.
	
	* app/gui/splash.c (splash_create): load splash from picman_splash.gif.

2001-12-29  Michael Natterer  <mitch@picman.org>

	* NEWS: mention GTK_DISABLE_DEPRECATED.

2001-12-29  Sven Neumann  <sven@picman.org>

	* data/brushes/vine.gih: fixed rank and increased spacing.

2001-12-29  Michael Natterer  <mitch@picman.org>

	* app/picmanprogress.c
	* app/nav_window.c
	* app/ops_buttons.c
	* app/undo_history.c
	* app/display/picmandisplayshell.c
	* app/gui/about-dialog.c
	* app/gui/brush-editor.c
	* app/gui/channels-commands.c
	* app/gui/color-area.c
	* app/gui/color-notebook.c
	* app/gui/color-select.c
	* app/gui/colormap-dialog.c
	* app/gui/convert-dialog.c
	* app/gui/device-status-dialog.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/info-dialog.c
	* app/gui/layers-commands.c
	* app/gui/module-browser.c
	* app/gui/offset-dialog.c
	* app/gui/palette-editor.c
	* app/gui/palettes-commands.c
	* app/gui/paths-dialog.c
	* app/gui/qmask-commands.c
	* app/gui/resize-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/splash.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox.c
	* app/gui/user-install-dialog.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmanconstrainedhwrapbox.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerlistview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanfontselection-dialog.c
	* app/widgets/picmanhistogramview.c
	* app/widgets/picmanitemfactory.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmanpreview.[ch]
	* app/widgets/gtkhwrapbox.c
	* app/widgets/gtkvwrapbox.c
	* app/widgets/gtkwrapbox.c
	* libpicman/picmanbrushmenu.c
	* libpicman/picmanexport.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanmenu.c
	* libpicman/picmanpatternmenu.c
	* libpicmanwidgets/picmanbutton.c
	* libpicmanwidgets/picmanchainbutton.[ch]
	* libpicmanwidgets/picmancolorarea.h
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanfileselection.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpatheditor.c
	* libpicmanwidgets/picmanpixmap.h
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanstock.[ch]
	* libpicmanwidgets/picmanwidgets.h
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/Events.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/bmp/bmpwrite.c
	* plug-ins/dbbrowser/dbbrowser_utils.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/fp/fp_misc.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/picmanressionist/*.c
	* plug-ins/imagemap/*.[ch]
	* plug-ins/maze/maze_face.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/print/print_picman.h
	* plug-ins/rcm/rcm_callback.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/rcm/rcm_misc.c
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/sel2path/sel2path.c
	* plug-ins/sel2path/sel2path_adv_dialog.c
	* plug-ins/sgi/sgi.c
	* plug-ins/webbrowser/webbrowser.c
	* plug-ins/xjt/xjt.c
	* plug-ins/common/[A-n]*.c: compile with GTK_DISABLE_DEPRECATED
	defined. Not everything is fully ported yet, had to #undef
	GTK_DISABLE_DEPRECATED in many places and added #warnings when
	doing so.

	* pixmaps/Makefile.am
	* pixmaps/chain.xpm: removed.

	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-button-hchain-broken.png
	* themes/Default/images/stock-button-hchain.png
	* themes/Default/images/stock-button-vchain-broken.png
	* themes/Default/images/stock-button-vchain.png: new stock icons.

2001-12-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c: write comment to top of picmanrc.

	* app/core/picmanscanconvert.c: removed redundant CLAMP statements.
	
	* app/plug-in/plug-in-rc.[ch]
	* app/plug-in/plug-in.c: rewrote pluginrc scanner and moved the code 
	that writes the pluginrc into plug-in-rc.c.

2001-12-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmagnifytool.c: calculate mouse movement in screen
	coordinates. Reset threshold to default value when the Reset button
	is pressed.

2001-12-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig.h
	* app/config/picmanrc.[ch]: added new function to only write changes to
	the personal picmanrc.
	
	* app/config/test-config.c: test the new functionality.
	
	* tools/pdbgen/pdb/procedural_db.pdb: the change I did yesterday 
	wasn't overly clever; here's a better one.

	* app/pdb/procedural_db_cmds.c: regenerated.

2001-12-28  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-rc.[ch]: new files that parse pluginrc using a
	GScanner.

	* app/plug-in/plug-in.[ch]: made PlugInDef public again so we can use
	it from the pluginrc parser.

	* tools/pdbgen/pdb/procedural_db.pdb: made regex string matching 
	robust against NULL pointers.

	* app/pdb/procedural_db_cmds.c: regenerated.

	* app/picmanrc.c: removed old pluginrc parser.
	
2001-12-27  DindinX  <David@dindinx.org>

	* app/tools/picmanmagnifytool.c: Added a threshold value determining
	by how many pixels the mouse should move to use the window mode.

2001-12-27  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am: fixed for 'make dist'.

2001-12-27  Sven Neumann  <sven@picman.org>

	* INSTALL
	* NEWS
	* configure.in: require latest versions of glib, gtk+ and friends. 
	Bumped our version number to 1.3.2.

	* app/plug-in/plug-in.c (plug_in_params_destroy, plug_in_args_destroy):
	moved condition out of the switch statement, simplified code.
	
	* app/plug-in/plug-in-proc.[ch]: moved plug_in_proc_def_destroy() here.

	* app/picmanrc.c: use plug_in_proc_def_destroy().
	
	* app/pdb/procedural_db.c: use g_string_hash() instead of our own hash
	function.

	* app/xcf/xcf.c: initialize all fields of the PlugInProcDef struct.
	
2001-12-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c (text_render): fixed text positioning by
	removing a workaround for a bug that has finally been fixed in Pango.

2001-12-19  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in-proc/plug-in-proc.[ch]: new files. Started to split
	plug-in.c into smaller pieces.
	
	* app/plug-in/plug-in-types.h: namespacified PicmanRunModeType enum and
	renamed it to PicmanRunMode.
	
	* app/plug-in/plug-in.[ch]
	* app/picmanhelp.c
	* app/file/file-open.[ch]
	* app/file/file-save.[ch]
	* app/file/file-utils.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/paths-dialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.
	
	* app/pdb/fileops_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* libpicman/picmanfileops_pdb.[ch]
	* tools/pdbgen/enums.pl: regenerated.

	* libpicman/Makefile.am
	* libpicman/picmancompat.h: added picmancompat.h mostly as a place to 
	document plug-in API changes.

	* plug-ins/*: changed all occurences of PicmanRunModeType to PicmanRunMode.
	
2001-12-18  Sven Neumann  <sven@picman.org>

	* docs/picmantool-1.3.1.in
	* picmantool-1.3.in: applied patch from Roger Leigh <rl117@york.ac.uk>
	that makes picmantool respect the DESTDIR environment variable.

	* app/config/Makefile.am: declare test-config as TESTS so it is build
	and executed when running 'make check'.
	
	* app/config/picmanbaseconfig.c: don't register a PicmanConfig interface.
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c: no need to include "picmanconfig.h".
	
	* app/config/picmanconfig.[ch]: removed store_unknown parameter from
	deserialize method. The default implementation will bail out on 
	unknown tokens.
	
	* app/config/picmanrc.c: override deserialize method so it stores 
	unknown tokens.

2001-12-18  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: don't build test-config by default.
	
	* app/config/picmanrc.[ch]: new files for the PicmanRc implementation.

	* app/config/picmancoreconfig.h
	* app/config/picmandisplayconfig.h
	* app/config/picmanguiconfig.h: include the necessary enum headers
	here and prefix local includes with config so the files can be safely
	included from almost everywhere.
	
	* app/config/test-config.c: instantiate and test PicmanRc.

2001-12-18  DindinX  <David@dindinx.org>

	* app/base/boundary.c:
	* app/base/pixel-surround.c:
	* app/base/temp-buf.c: some more g_malloc -> g_new and 
	  g_realloc -> g_renew changes, foe better readability and type
	  safety.

2001-12-18  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/display/display-enums.h: new file with PicmanCursorMode enum.

	* app/display/display-types.h: removed CursorMode enum here, include
	display-enums.h.

	* app/picmanrc.c
	* app/display/picmandisplayshell.c
	* app/gui/preferences-dialog.c: changed accordingly.

	* app/config/Makefile.am
	* app/config/picmanbaseconfig.[ch]
	* app/config/picmancoreconfig.[ch]
	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanguiconfig.[ch]: implemented the remaining properties.

2001-12-18  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-utils.[ch]: new files with utility functions.

	* app/config/picmandisplayconfig.[ch]: new class with display config
	properties so PicmanGuiConfig doesn't get too large.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.[ch]
	* app/config/picmanguiconfig.[ch]: install path properties with
	useable defaults (substituted picmandir and friends). Moved properties
	around.

	* app/gui/session.c: removed outdated comment.

2001-12-18  Michael Natterer  <mitch@picman.org>

	* configure.in: added -DGDK_PIXBUF_DISABLE_DEPRECATED to CPPFLAGS.

	* app/core/picmanbuffer.[ch]: picman_buffer_get_[width|height]:
	added "const" to the PicmanBuffer parameter.

	* app/core/picmanchannel.c: indentation and comment changes.

	* app/core/picmandrawable-desaturate.c: don't include
	"paint-funcs/paint-funcs.h".

	* app/display/picmandisplayshell.c: don't include "base/temp-buf.h".

	* app/gui/gui.c: removed the image container's "name_changed"
	handler.

	* app/gui/palette-import-dialog.[ch]: use PicmanPreview and
	PicmanContainerMenu instead of doing the same manually. Removed lots
	of code. Not perfect yet.

	* app/tools/picmanfuzzyselecttool.c: no need to include tile stuff.

	* app/widgets/picmancontainerview-utils.c: better g_warning() message.

	* tools/pdbgen/pdb/paint_tools.pdb: don't include
	"base/tile-manager.h".

	* app/pdb/paint_tools_cmds.c: regenerated.

	* data/images/Makefile.am
	* data/images/picman_logo.ppm: removed...
	* data/images/picman_logo.png: ...and added as PNG.

	* app/gui/about-dialog.c: use gdk_pixbuf_new_from_file() to load
	the PNG logo instead of manually parsing the PPM.

2001-12-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandrawablelistview.[ch]: changed
	the PicmanNewDrawableFunc typedef to take an additional 
	"PicmanDrawable *template" paramater, added the "Drop to New"
	feature again by passing the dropped drawable to
	view->new_drawable_func().

	* app/gui/channels-commands.[ch]: channels_new_channel_query:
	* app/gui/layers-commands.[ch]: layers_new_layer_query:

	Added the "template" parameter because they are used as the
	views' new_drawable_func(), create layers/channels with
	the template's properties if a template is passed.

2001-12-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.c: oops, PICMAN_IS_DRAWABLE(gimage) will
	always fail :-) fixed.

2001-12-17  Sven Neumann  <sven@picman.org>

	* picmanconfig.[ch]: don't serialize unknown tokens; leave that to
	the picmanrc implementation. Create file with correct permissions.
	
	* test-config.c: changed accordingly.
	
	* picmanguiconfig.[ch]: added more properties.

2001-12-16  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanguiconfig.[ch]
	* app/config/test-config.c: started to implement PicmanGuiConfig.

	* app/config/picmancoreconfig.c: set default for image-comment.

2001-12-16  Sven Neumann  <sven@picman.org>

	* app/core/picmancoreconfig.[ch]: changed thumbnail_mode to boolean
	write_thumbnails. thumbnail_mode used to have only two defined
	values; if we need more later, we can change that easily when the 
	new PicmanConfig system is in place.

	* app/picmanrc.c
	* app/file/file-save.c
	* app/gui/file-open-dialog.c
	* app/gui/preferences-dialog.c: changed accordingly.
	
	* app/config/picmancoreconfig.[ch]: finished PicmanCoreConfig class.

2001-12-16  Sven Neumann  <sven@picman.org>

	* docs/make-todo: added icon for developer.picman.org.

2001-12-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.[ch]
	* app/config/picmanconfig-types.[ch]: added support for PicmanUnit type.
	
	* app/config/picmanbaseconfig.[ch]
	* app/config/picmancoreconfig.[ch]
	* app/config/test-config.c: cleaned up includes. Added more properties
	to PicmanCoreConfig.

	* app/libpicman_glue.h
	* libpicmanbase/picmanunit.h: 
	declared picman_unit_get_number_of_built_in_units() G_GNUC_CONST.

	* app/core/picmanunit.[ch]: internal PicmanUnit functions return const 
	strings.

	* app/xcf/xcf-save.c: changed accordingly.

2001-12-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c: merged fix for bug #66003 from stable
	branch.

2001-12-16  Sven Neumann  <sven@picman.org>

	* plug-ins/gap/gap_decode_xanim.c (p_xanim_dialog)
	* plug-ins/common/sinus.c (sinus_dialog): merged typo fixes from
	stable branch.

2001-12-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added
	PICMAN_IMAGE_TYPE_IS_[RGB|GRAY|INDEXED]() and
	PICMAN_IMAGE_TYPE_BASE_TYPE() macros.

	* app/plug-in/plug-in.[ch]: new enum PlugInImageType instead of
	multiple #defines.

	* app/gui/file-dialog-utils.[ch]: file_dialog_update_menus(): take
	a PicmanImageType instead of the PlugInImageType.

	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanlayermask.c
	* app/core/picmanpalette-import.c
	* app/display/picmandisplay-handlers.c
	* app/display/picmandisplayshell-render.c
	* app/gui/file-save-dialog.c
	* app/gui/toolbox.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/image.pdb: use the new macros, cleanups like
	storing PicmanImageType in PicmanImageType variables, not just gint.

	* app/pdb/convert_cmds.c
	* app/pdb/image_cmds.c: regenerated.

	* app/widgets/picmandialogfactory.c: save the state of the "Auto"
	button in sessionrc.

2001-12-13  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.h
	* app/config/picmanconfig-serialize.c: fixed typos.
	
	* app/core/core-enums.h
	* app/core/core-types.h: converted ChannelType enum to PicmanChannelType
	and moved it to core-enums.h.
	
	* app/core/picmanimage.[ch]
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.[ch]
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

	* app/pdb/image_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2001-12-13  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-params.h
	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig-substitute.c
	* app/config/picmanconfig-types.c
	* app/config/picmanconfig.[ch]
	* app/config/test-config.c: code cleanup, I18N

	* app/config/picmancoreconfig.[ch]: some more properties.

2001-12-13  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: made picman->global_buffer a PicmanBuffer,
	not TileManager.

	* app/core/picmanbuffer.[ch]: added a "gboolean copy_pixels" to
	picman_buffer_new().

	* app/core/picmanimage-new.c
	* app/core/picmanedit.[ch]
	* app/core/picmanimage-qmask.c
	* app/widgets/picmanbufferpreview.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmancontainerview-utils.c: chaned accordingly, don't
	include "base/tile-manager.h".

	* app/core/picmandrawable.[ch]: added picman_drawable_copy().

	* app/core/picmanchannel.[ch]
	* app/core/picmanlayer.[ch]
	* app/core/picmanlayermask.[ch]: use it in
	picman_[channel|layer|layer_mask]_copy(), added "GType new_type" as
	paramater to all of them.

	* app/core/picmanimage-duplicate.c
	* app/gui/channels-commands.c
	* app/gui/edit-commands.c
	* app/gui/layers-commands.c
	* app/widgets/picmanchannellistview.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

	* app/core/picmanlayer.[ch]: removed the "layer_type" parameter from
	picman_layer_new_from_tiles() because it always needed to be equal
	to picman_image_base_type_with_alpha() of the passed image.

	* app/core/picmandrawable-transform.c
	* app/core/picmanedit.c
	* app/core/picmanimage-mask.c: cahanged accordingly.

	* app/core/picmanimage.[ch]: added some new PICMAN_IMAGE_TYPE_FOO()
	marcos to get rid of magic values like "pixels = 3" all over the
	place.

	* app/core/picmanlayer.[ch]: added picman_layer_new_from_drawable()
	which creates a layer from an other image's drawable.

	* app/core/picmanimage-convert.[ch]: made the RGB and GRAY converters
	public to use them above, use the new PICMAN_IMAGE_TYPE() macros.

	* app/display/picmandisplayshell-dnd.c
	* app/gui/toolbox.c: removed tile manager stuff and use the new
	functions.

	* app/widgets/picmandrawablelistview.[ch]: added a
	"convert_drawable_func" which is used to handle drops from other
	images.

	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlistitem.[ch]: implemented DND of layers between
	images using picman_layer_new_from_drawable().

	* app/gui/dialogs-constructors.c: changed accordingly.

2001-12-12  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-pick-color.[ch]: new files.

	picman_image_pick_color() doesn't set the FG or BG color and doesn't
	touch the current palettte.

	* app/tools/picmancolorpickertool.[ch]: removed the actual picking
	code, set the user_context's FG or BG color here.

	* app/gui/palette-editor.[ch]:
	s/palette_set_active_color/palette_editor_update_color/, don't set
	the FG and BG color here. The function is still #if 0'ed.

	* app/gui/toolbox.c: fixed WM resize hints in toolbox_style_set(),
	code cleanup.

	* app/tools/picmanpainttool.[ch]: some cleanup before chopping.

	* app/tools/picmansmudgetool.c: changed accordingly.

	* tools/pdbgen/pdb/misc_tools.pdb: removed the possibility to set
	the FG or BG color or add the picked color to the active palette
	bacause it doesn't belong here. Palette PDB wrappers are on the
	TODO anyway.

	* app/pdb/misc_tools_cmds.c
	* libpicman/picmanmisctools_pdb.[ch]: regenerated.

	* plug-ins/perl/examples/image_tile
	* plug-ins/perl/examples/logulator
	* plug-ins/script-fu/scripts/hsv-graph.scm
	* plug-ins/script-fu/scripts/title-header.scm: changed accordingly.

2001-12-12  Michael Natterer  <mitch@picman.org>

	* docs/Wilber_Construction_Kit.xcf.gz: new version with additional
	layers by Ville PÃ¤tsi (drc).

2001-12-12  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-substitute.c: plugged a memleak and applied
	some optimizations.

2001-12-11  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* app/core/core-types.h: moved gradient enums to core-enums.h and
	namespaceified them.
	
	* app/core/picmandrawable-blend.[ch]
	* app/core/picmangradient.c
	* app/gui/gradient-editor-commands.c
	* app/pdb/misc_tools_cmds.c
	* app/tools/picmanblendtool.c
	* tools/pdbgen/pdb/misc_tools.pdb: changed accordingly.

	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2001-12-11  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h
	* app/base/base-types.h: moved all remaining enums to base-enums.h
	
	* app/core/core-enums.h
	* app/core/core-types.h: moved PicmanImageType to core-enums.h and
	changed the values from RGB_GIMAGE to PICMAN_RGB_IMAGE and the like.
	
	* app/core/picmanchannel.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage.[ch]
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanpalette-import.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-render.c
	* app/gui/file-save-dialog.c
	* app/gui/toolbox.c
	* app/plug-in/plug-in.c
	* app/tools/picmanblendtool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmandodgeburntool.c: changed accordingly.

	* tools/pdbgen/Makefile.am: no need to parse app/base/base-types.h
	any longer.

	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/paint_tools_cmds.c
	* tools/pdbgen/enums.pl: regenerated.

2001-12-11  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h: removed PicmanImageBaseType enum ...

	* app/core/core-enums.h: and added it here with proper namespace
	(enum values prefixed with PICMAN_).

	* app/picmanrc.c
	* app/core/picmancoreconfig.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/core/picmanpalette-import.c
	* app/display/picmandisplay-handlers.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell.c
	* app/file/file-utils.c
	* app/gui/colormap-dialog.c
	* app/gui/convert-dialog.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/palette-import-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/toolbox.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanpainttool.c
	* app/widgets/picmanchannellistview.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

	* tools/pdbgen/enums.pl
	* app/pdb/convert_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmanconvert_pdb.c
	* libpicman/picmanimage_pdb.c: regenerated.

	* app/config/Makefile.am
	* app/config/picmanconfig-params.h
	* app/config/picmanconfig-serialize.c
	* app/config/picmancoreconfig.[ch]: added more stuff to PicmanCoreConfig.

2001-12-10  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanenv.[ch]: added new function picman_plug_in_directory()
	to retrieve the compile_time defined plug_in directory. Declared some
	functions G_GNUC_CONST and simplified code by introducing a helper
	function.
	
	* app/config/Makefile.am
	* app/config/picmancoreconfig.[ch]: started to implement PicmanCoreConfig
	derived from PicmanBaseConfig.
	
	* app/config/picmanbaseconfig.[ch]: misc small changes.

	* app/config/picmanconfig-deserialize.c
	(picman_config_deserialize_properties): return quietly if there are no
	properties.
	
	* app/config/picmanconfig-substitute.c: more special cases.
	
	* app/config/test-config.c: test PicmanCoreConfig.

2001-12-10  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-substitute.[ch]: new files with code to do
	substitution magic on path strings. Similar to the code in picmanrc.c
	but UTF8 safe.

	* app/config/picmanconfig-params.h
	* app/config/picmanbaseconfig.c: added a bunch of convenience macros
	to register config properties and use them for PicmanBaseConfig.
	
	* app/config/picmanconfig-types.h: added missing PICMAN_VALUE_HOLDS_FOO()
	macros.

	* app/config/picmanconfig-deserialize.c: UTF8-validate all strings.
	
	* app/config/picmanconfig-serialize.c: some code reorganisation.

2001-12-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/screenshot.c: removed deprecated use of
	"user_data" together with libpicmanwidgets standard
	callbacks. Reported by Carbamide on #picman.

2001-12-10  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/tools.pdb: removed, chopped...

	* tools/pdbgen/pdb/misc_tools.pdb
	* tools/pdbgen/pdb/paint_tools.pdb: ...and added here.

	* app/pdb/tools_cmds.c
	* libpicman/picmantools_pdb.[ch]: removed.

	* app/pdb/internal_procs.c
	* app/pdb/misc_tools_cmds.c
	* app/pdb/paint_tools_cmds.c
	* libpicman/picmanmisctools_pdb.[ch]
	* libpicman/picmanpainttools_pdb.[ch]: generated files.

	* app/pdb/Makefile.am
	* libpicman/Makefile.am
	* libpicman/picman_pdb.h
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl: changed accordingly.

	* tools/pdbgen/pdb/selection_tools.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: cosmetic comment changes.

2001-12-10  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/core/Makefile.am: use GLIB_GENMARSHAL and GLIB_MKENUMS variables
	declared by AM_PATH_GLIB_2_0 instead of calling the binaries directly.

2001-12-10  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig.c: stricter parsing.
	
	* app/config/test-config.c: more output.

2001-12-09  Sven Neumann  <sven@picman.org>

	* autogen.sh: check for pkg.m4.
	
	* configure.in: removed logic to extract GLIB CFLAGS and LDFLAGS 
	from the GTK CFLAGS and LDFLAGS. Use AM_PATH_GLIB_2_0() instead. 
	This change will break things on awfully misconfigured systems.
	Simplified the checks and moved version numbers to the top to ease
	maintainance. Check if gtk-doc is suffiently new.

	* app/main.c: removed the PicmanConfig test code.

	* app/config/Makefile.am
	* app/config/test-config.c: added a (yet very small) standalone test 
	suite for PicmanConfig.

	* app/config/picmanconfig.[ch] 
	* app/config/picmanconfig-deserialize.[ch]: allow to specify if
	unknown tokens should be stored or should cause a parser error. 
	Changed code to store unknown tokens to use a list since a hash 
	table seems to be overkill here.

2001-12-09  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-params.[ch]
	* app/config/picmanconfig-types.[ch]: added new param_spec 
	PICMAN_PARAM_PATH with value_type PICMAN_PATH_TYPE.

	* app/config/picmanconfig.[ch]: added code to store and lookup unknown 
	tokens.

	* app/config/picmanconfig-deserialize.c: improved logic, prepared for 
	special handling of PICMAN_PATH_TYPE; still work in progress...

	* app/config/picmanbaseconfig.c: register temp-path and swap-path as
	PICMAN_PARAM_PATH properties.

2001-12-08  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/enumgen.pl: introduced new trigraph keyword
	/*< pdb-skip >*/ used to skip enums for inclusion in libpicman when
	parsing headers. The keyword /*< skip >*/ is still used to skip
	enum values. This change is necessary since glib-mkenums also uses
	/*< skip >*/.

	* app/base/base-types.h * app/base/base-enums.h: moved
	PicmanCheckType and PicmanCheckSize to base-enums.h so they get
	registered with the type system, marked them as /*< pdb-skip >*/.
	
	* app/core/core-types.h * app/display/display-types.h *
	app/paint-funcs/paint-funcs-types.h * app/tools/picmanpainttool.h *
	app/tools/tools-types.h: changed /*< skip >*/ to /*< pdb-skip >*/.
	
2001-12-08  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-enums.h: new file that holds enums that are registered
	with the type system and is used to generate core-enums.c.
	
	* app/core/core-types.h: include core-enums.h

	* app/base/base-types.h: namespace cleanup. Prefix all enumeration
	types with Picman and their values with PICMAN. Moved PicmanLayerModeEffects
	enum ...

	* app/base/base-enums.h: ... here.

	* app/image_map.c
	* app/base/temp-buf.c
	* app/core/picmancontext.[ch]
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-projection.c
	* app/core/picmanimage.[ch]
	* app/core/picmanlayer.[ch]
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-render.c
	* app/gui/brush-select.c
	* app/gui/layers-commands.c
	* app/gui/preferences-dialog.c
	* app/gui/toolbox.c
	* app/paint-funcs/paint-funcs.[ch]
	* app/tools/picmanconvolvetool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmantexttool.c
	* app/tools/paint_options.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanwidgets-constructors.[ch]
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly.
	
	* libpicmanbase/picmanbasetypes.h: no need to chop PICMAN prefix off the 
	enums any longer.
	
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/picmanrc.c: removed code to parse for "plug_in" keyword which was 
	left over from some very early picman days.
	
	* app/plug-in/plug-in.[ch]: removed now unused function plug_in_add().

2001-12-08  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am: fixed build rules for picmanmarshal.[ch].
	
2001-12-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.c: improved code readability by 
	splitting deserialize_property into smaller functions.

	* app/config/picmanconfig.[ch]: added picman_config_debug_notify_callback()
	for debugging purposes.

	* app/main.c: use picman_config_debug_notify_callback().

2001-12-08  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-params.[ch]
	* app/config/picmanconfig-types.[ch]: new files implementing special
	GParamSpecs and GValueTypes needed for PicmanConfig.
	
	* app/config/picmanbaseconfig.c: register tile-cache-size property
	with PicmanParamSpecMemsize.
	
	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanconfig-serialize.[ch]: enable serialization and 
	deserialization of non-fundamental types.

2001-12-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/devices.[ch]: removed, chopped...

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/gui/Makefile.am

	* app/widgets/picmandeviceinfo.[ch]
	* app/widgets/picmandevices.[ch]
	* app/gui/device-status-dialog.[ch]
	* app/gui/input-dialog.[ch]: ...and added here.

	Made PicmanToolInfo a PicmanContext subclass. Create a PicmanDeviceManager
	struct in picmandevices.c and attach it to the Picman instance.

	* app/core/picman.[ch]: removed picman_create_context(). It was a bad
	idea in the first place beause it prevented PicmanContext subclasses
	from being be properly registered with their Picman instance.

	* app/core/picmancontext.c: moved the stuff which used to be in
	picman_create_context() back here. Added a "picman" property which
	must be set on construction. Added a "dispose" implementation
	which removes the context from it's Picman's context_list.

	* app/picmanrc.c
	* app/core/picmantoolinfo.[ch]
	* app/display/picmandisplayshell-callbacks.c
	* app/gui/brush-select.c
	* app/gui/dialogs-constructors.c
	* app/gui/gradient-editor.c
	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/palette-editor.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c
	* app/gui/toolbox.c
	* app/tools/picmanpainttool.c
	* app/tools/tool_manager.c
	* app/widgets/picmanimagedock.c: changed accordingly.

	* app/gui/tools-commands.[ch]: made all callback signatures
	the same.

	* app/gui/preferences-dialog.c: cleaned up the
	display_format_string GtkCombo code.

2001-12-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanmarshal.[ch]: removed from CVS, they are generated.

	* app/base/Makefile.am
	* app/base/base-enums.h: new file defining enums that are to be
	registered. Used to build app/base/base-enums.c.

	* app/base/base-types.h: include base-enums.h.

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enumcode.pl
	* tools/pdbgen/enums.pl: parse the new base-enums.h file and modified
	the perl voodoo so it doesn't prefix enums with PICMAN_ that are already
	properly namespaced.

	* app/core/core-types.h: don't need to chop PICMAN from enum.

	* app/pdb/color_cmds.c
	* app/pdb/tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c: regenerated.

	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig.[ch]: made PicmanConfig an interface including
	a reasonable default implementation that works on object properties.

	* app/config/Makefile.am
	* app/config/picmanbaseconfig.[ch]: new PicmanBaseConfig using the
	PicmanConfig interface. Yet only used for testing from app/main.c.

	* app/main.c: test the new PicmanBaseConfig object.

	* app/picmanrc.c
	* app/base/base-config.h
	* app/base/*.c
	* app/core/picmandatafiles.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanpreviewcache.c
	* app/gui/preferences-dialog.c
	* app/paint-funcs/paint-funcs.c
	* app/xcf/xcf-seek.c: need to include glib-object.h since base-config
	contains registered enums now. Follow name change of InterpolationType
	to PicmanInterpolationType.
	
2001-12-06  David Neary  <bolsh@picman.org>

	* plug-ins/common/vpropagate.c: Create Erode and Dilate filter
	menu entries with reasonable defaults for this plug-in.

2001-12-06  Sven Neumann  <sven@picman.org>

	* app/gui/offset-dialog.c: some GUI fiddling.

2001-12-06  Rebecca Walter <bex@picman.org>

	* app/gui/module-browser.c
	* app/gui/offset-dialog.c: More of my proofing.

2001-12-06  Dindinx  <David@dindinx.org>

	* plug-ins/*/*.c: use the G_N_ELEMENTS macro where appropriate,
	removing a bunch of unuseful static variables. Changed some
	g_malloc to g_new while I was on it.

2001-12-03  Michael Natterer  <mitch@picman.org>

	* app/devices.c: use the passed Picman pointer instead of
	using "the_picman".

	* app/base/temp-buf.c: indentation.

	* app/gui/preferences-dialog.c: prefs_toggle_callback(): fixed
	segfault when trying to find the prefs_dlg widget from a menu
	item callback (Fixes #65757).

	* app/gui/offset-dialog.[ch]: fixed public prototype, include
	the header in the .c file.

	* app/tools/picmanblendtool.c
	* app/tools/paint_options.c
	* app/tools/transform_options.c: removed usage of "the_picman".

	* app/gui/menus.c: some menu cleanup: moved all functions which
	operate on the active layer/drawable to <Image>/Layer. Renamed
	"Layers" to "Layer".

	* app/display/picmandisplayshell.c: changed menu update function
	accordingly.

	* app/gui/image-commands.[ch]
	* app/gui/layers-commands.[ch]: moved stuff from image-commands.*
	to layers-commads.*.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/autocrop.c
	* plug-ins/common/autostretch_hsv.c
	* plug-ins/common/c_astretch.c
	* plug-ins/common/color_enhance.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/normalize.c
	* plug-ins/common/rotate.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/zealouscrop.c
	* plug-ins/rcm/rcm.c
	* plug-ins/fp/fp.c: register under <Image>/Layer, some cosmetic
	fixes.

2001-12-03  Sven Neumann  <sven@picman.org>
	    Michael Natterer <mitch@picman.org>

	* app/paint-funcs/paint-funcs-mmx.h: removed redefiniton of HAS_ALPHA
	macro.

	* app/core/picman.c: reverted Daniel's change; it doesn't make the code
	simpler, only more error-prone.

	* app/gui/info-dialog.h
	* app/gui/resize-dialog.h
	* app/core/picman.h
	* app/core/picmanbrushgenerated.h
	* app/core/picmanbrushpipe.h
	* app/core/picmanchannel.[ch]
	* app/core/picmancontainer.h
	* app/core/picmancoreconfig.h
	* app/core/picmandata.h
	* app/core/picmandatafactory.[ch]
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable.[ch]
	* app/core/picmanimage.h
	* app/core/picmanimagefile.h
	* app/core/picmanlayer.h
	* app/core/picmanlayermask.h
	* app/core/picmanmoduleinfo.h
	* app/core/picmanpalette.h
	* app/core/picmanundo.h
	* app/widgets/picmanbrushfactoryview.h
	* app/widgets/picmanconstrainedhwrapbox.h
	* app/widgets/picmancontainermenu.h
	* app/widgets/picmancontainerview.h
	* app/widgets/picmandialogfactory.h
	* app/widgets/picmanimagedock.h
	* app/widgets/picmanlistitem.h
	* app/widgets/picmanmenuitem.h
	* app/widgets/picmannavigationpreview.h
	* app/widgets/picmanpreview.h
	* app/picmanrc.h
	* app/pathP.h
	* app/tools/picmanbezierselecttool.h
	* app/tools/picmancolorbalancetool.h
	* app/tools/picmancurvestool.h
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanfreeselecttool.h
	* app/tools/picmanhuesaturationtool.h
	* app/tools/picmaninktool-blob.h
	* app/tools/picmaninktool.h
	* app/tools/picmaniscissorstool.h
	* app/tools/picmanmagnifytool.h
	* app/tools/picmanmeasuretool.h
	* app/tools/picmanpainttool.h
	* app/tools/picmanpathtool.h
	* app/tools/picmanrectselecttool.h
	* app/tools/picmanthresholdtool.h
	* app/tools/picmantool.h
	* app/tools/picmantransformtool.h
	* app/base/base-config.h
	* app/base/picmanlut.[ch]
	* app/base/pixel-region.h
	* app/base/pixel-surround.[ch]
	* app/base/temp-buf.[ch]
	* app/base/tile-manager-private.h
	* app/base/tile-manager.[ch]
	* app/base/tile-private.h
	* app/base/tile.[ch]
	* app/display/picmandisplay.h
	* app/display/picmandisplayshell-selection.h
	* app/display/picmandisplayshell.h
	* app/gui/brush-select.h
	* app/gui/gradient-editor.h
	* app/gui/gradient-select.h: reverted most of Daniel's changes.
	
	There's no reason to use unsigned integers here and in lots of places 
	it is even wrong. 

	Then it's way too early to convert gbooleans into bitfields. This 
	change may make sense in a few places but can happen later when the 
	API has settled and the code is more stable.
	
	* app/picmanrc.c: reverted Daniel's change. This is a GCC-ism and this
	code is about to die soon anyway.

2001-12-03  Daniel Egger  <degger@fhm.edu>

	* app/core/picman.c: Simplified logic thanks to bitfields.

2001-12-02  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in.c: use g_tree_foreach() instead of deprecated
	g_tree_traverse().

	* app/undo_history.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmandisplayshell.c
	* app/gui/about-dialog.c
	* app/gui/color-area.c
	* app/gui/color-select.c
	* app/gui/gradient-editor.c
	* app/gui/gui.c
	* app/gui/paths-dialog.c
	* app/gui/user-install-dialog.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaninktool.c
	* app/widgets/picmancursor.c
	* app/widgets/picmannavigationpreview.c
	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmanpixmap.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/uniteditor.c
	* plug-ins/ifscompose/ifscompose.c: s/gdk_gc_unref/g_object_unref/, 
	s/gdk_drawable_unref/g_object_unref/

2001-12-02  Daniel Egger  <degger@fhm.edu>

	* app/picmanrc.c: Convert ugly comments into named structure fields.
	Much cleaner and less errorprone though may cause troubles on
	older compilers and then needs to be reverted. Please report!

	* app/base/base-types.h: Add FIXME reminder.

	* app/base/picmanlut.c: Use CLAMP macro instead of if-cascade. 
	
	* app/base/temp-buf.c: Remove duplicated calculations and simplify
	checks.
	
	* app/base/tile-manager.c: 
	- (tile_manager_get_tile_num): Return success and take an additional
	  pointer for the tilenumber.
	- Simplify logic in the rest of the file as a result.
	- Remove rotten debugging cruft. 
	
	* app/core/picmanbrushgenerated.c: Fix two stylistic nits.

	* app/app_procs.c: Include <stdlib.h> for exit () prototype.

	* app/core/picmandrawable-blend.c: Include <stdlib.h> for abs () 
	prototype.

	* app/display/picmandisplay.c: Include <string.h> for memcpy () 
	prototype.
	
	* app/core/picmanimage-convert.c: (HIST_RGB): First parameter is
	not const. Fixes a gcc warning for a wrong return value.

	* libpicmanwidgets/picmanunitmenu.c	
	* app/core/picmanunit.c: Add suggested (by gcc 3.1 cvs) parentheses 
	to group correct logic tests together.

	* app/paint-funcs/paint-funcs-generic.h: Fix my HAS_ALPHA macro
	to avoid gcc 3.1 cvs warning.
	
	* app/picmanrc.h
	* pathP.h
	* base-config.h
	* app/base/boundary.h
	* app/base/picmanlut.[ch]
	* app/base/pixel-region.h
	* app/base/pixel-surround.[ch]
	* app/base/temp-buf.[ch]
	* app/base/tile-manager-private.h
	* app/base/tile-manager.c
	* app/base/tile-private.h
	* app/base/tile.[ch]
	* app/core/picman.h
	* app/core/picmanbrushgenerated.h	
	* app/core/picmanbrushpipe.h
	* app/core/picmanchannel.[ch]
	* app/core/picmancontainer.h
	* app/core/picmancoreconfig.h	
	* app/core/picmandata.h
	* app/core/picmandatafactory.[ch]	
	* app/core/picmandrawable-blend.c	
	* app/core/picmandrawable.[ch]
	* app/core/picmanimage.h
	* app/core/picmanimagefile.h
	* app/core/picmanlayer.h
	* app/core/picmanlayermask.h
	* app/core/picmanmoduleinfo.h
	* app/core/picmanpalette.h
	* app/core/picmanundo.h
	* app/display/picmandisplay.h
	* app/display/picmandisplayshell-selection.h
	* app/display/picmandisplayshell.h
	* app/gui/brush-select.h
	* app/gui/gradient-editor.h
	* app/gui/gradient-select.h
	* app/gui/info-dialog.h	
	* app/gui/resize-dialog.h
	* app/tools/picmanbezierselecttool.h
	* app/tools/picmancolorbalancetool.h
	* app/tools/picmancolorpickertool.h
	* app/tools/picmancurvestool.h
	* app/tools/picmandodgeburntool.c	
	* app/tools/picmanfreeselecttool.h
	* app/tools/picmanfuzzyselecttool.h
	* app/tools/picmanhuesaturationtool.h
	* app/tools/picmaninktool-blob.h
	* app/tools/picmaninktool.h
	* app/tools/picmaniscissorstool.h
	* app/tools/picmanmagnifytool.h
	* app/tools/picmanmeasuretool.h
	* app/tools/picmanpainttool.h
	* app/tools/picmanpathtool.h
	* app/tools/picmanrectselecttool.h
	* app/tools/picmanthresholdtool.h
	* app/tools/picmantool.h
	* app/tools/picmantransformtool.h
	* app/tools/path_toolP.h
	* app/widgets/picmanbrushfactoryview.h
	* app/widgets/picmanconstrainedhwrapbox.h
	* app/widgets/picmancontainermenu.h
	* app/widgets/picmancontainerview.h 
	* app/widgets/picmandialogfactory.h
	* app/widgets/picmanimagedock.h
	* app/widgets/picmanlistitem.h
	* app/widgets/picmanmenuitem.h
	* app/widgets/picmannavigationpreview.h
	* app/widgets/picmanpreview.h: Unsignify lots of variables and
	parameters and use bitfields in structs where possible. First
	part of a huge cleanup all over the code...

2001-12-01  Michael Natterer  <mitch@picman.org>

	* app/errors.c: forgot a "return".

	* app/gui/error-console-dialog.c: the menu item signals were
	connected "swapped", which is wrong.

	* app/tools/picmanerasertool.c: added a cursor_update_func(), update
	the "toggled" state there and chain up. Fixes wrong cursor
	updating.

	Made brush_pipe slection work again, removed the #warnings:

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushpipe.c: changed brush_class->select_brush()
	and brush_class->want_null_motion() to be proper virtual
	functions. Pass last_coords and cur_coords to them.

	* app/tools/picmanpainttool.c: call the functions again.

2001-12-01  Michael Natterer  <mitch@picman.org>

	* app/main.c
	* app/appenv.h: moved "message_handler" from here...

	* app/core/picman.[ch]: ...to here. Added picman_message() and a
	"gui_message_func" pointer...

	* app/gui/gui.c: ...which gets set here to gui_message().

	* app/errors.c: don't include any gui stuff but simply call
	picman_message().

	* app/app_procs.c: don't set "message_handler" here, it's done in
	gui.c now.

	* app/gui/error-console-dialog.[ch]: use picman->message_handler.

	* app/gui/dialogs-constructors.c: pass a Picman pointer to
	error_console_create().

	* app/widgets/picmanwidgets-utils.[ch]: made the "message" parameter
	of picman_message_box() a const gchar*, not just gchar*.

	* tools/pdbgen/pdb/message.pdb: use picman->message_handler, don't
	include "appenv.h".

	* app/pdb/message_cmds.c: regenerated.

	* app/devices.[ch]: cleanup before chopping: removed global
	variable "current_device", added devices_get_current(), pass lots
	of Picman pointers around.

	* app/picmanrc.c: pass a Picman pointer to devices_rc_update().

	* app/display/picmandisplayshell-callbacks.c
	* app/gui/toolbox.c
	* app/tools/picmanpainttool.c: use devices_get_current(), pass Picman
	pointers to all devices_foo() functions.

	* app/core/picmanimage-mask.c: no need to include "pdb/pdb-types.h".

2001-12-01  Daniel Egger  <degger@fhm.edu>

	* app/core/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am
	* modules/Makefile.am
	* themes/Default/Makefile.am: Don't try to concatenate something
	to a variable not used before but simply assign it. Shuts up
	annoying automake warnings for me.

2001-12-01  Abel Cheung  <maddog@linux.org.hk>

	* tips/{Makefile.am,makefile.mingw}: Added picman_tips.zh_TW.txt
	  to the targets.

	* tips/picman_tips.zh_TW.txt: Added traditional Chinese translation
	  in Big5 encoding.

2001-11-30  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/plug_in.[ch]: removed...

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/plug-in/plug-in.[ch]: ...and added here.

	* app/appenv.h: removed StackTraceMode and MessageHandlerType...

	* libpicmanbase/picmanbasetypes.h: ...and added them here.

	* tools/pdbgen/Makefile.am: don't scan "app/apptypes.h" for enums.

	* tools/pdbgen/enumcode.pl: added a general check to prevent
	enums which are defined in libpicman* from being written to
	"libpicman/picmanenums.h".

	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/core-types.h: include "pdb/pdb-types.h" so including
	"core/core-types.h" gets the whole core type space.

	* app/core/picman.[ch]: added a "stack_trace_mode" parameter to the
	constructor and store it in the Picman struct because the value is
	also passed to plug-ins and nobody should include "appenv.h".

	* app/picmanrc.[ch]: pass the alternate_system_picmanrc and
	alternate_picmanrc filenames from the command line to picmanrc_prase()
	so we don't need to include "appenv.h".

	* app/batch.[ch]: pass the "batch_cmds" as parameter, don't
	include "append.h".

	* app/app_procs.c: pass more parameters around.

	* app/devices.c
	* app/errors.c
	* app/picmanhelp.c
	* app/main.c
	* app/core/picmangradient.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/file/file-utils.c
	* app/gui/commands.c
	* app/gui/error-console-dialog.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/paths-dialog.c
	* app/gui/user-install-dialog.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/xinput_airbrush.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly:

	- changed "plug-in.h" include where needed.
	- don't call picman_fatal_error() directly, it's called via the log
	  handler when calling g_error().
	- don't incude "errors.h" except from main.c.
	- changed stack_trace and message_handler enum names.
	- get "stack_trace_mode" from Picman.
	- removed many inclusions of "appenv.h".

	* app/pdb/fileops_cmds.c
	* app/pdb/help_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db.c: regenerated.

2001-11-30  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/display/gximage.[ch]: removed. It was a wrapper around
	nothing since we use GdkRGB.

	* app/display/picmandisplayshell-render.[ch]: added the render
	buf size defines here, added the #if 0'ed display filter stuff
	and the actual GdkRGB render stuff here too.

	* app/display/picmandisplayshell.[ch]: added shell->render_buf as
	replacement for the global gximage buffer, renamed shell->scroll_gc
	to shell->render_gc and use it all over the place when rendering
	image data.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scroll.c: changed accordingly.

	* app/gui/gui.c: don't call gximage init/exit stuff.

2001-11-30  Rebecca Walter  <bex@picman.org>

	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/gui/indicator-area.c
	* app/gui/info-dialog.c
	* app/gui/info-window.c:  More proofreading.
	In cooperation with Marco Wessel (CyBeR)

2001-11-30  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/colormaps.[ch]: removed.

	* app/app_procs.c: don't call it.

	* app/gui/gui.c: configure GdkRGB here.

	* app/display/picmandisplayshell.c
	* app/display/gximage.c
	* app/gui/color-notebook.c
	* app/gui/color-select.c
	* app/gui/colormap-dialog.c
	* app/gui/info-window.c
	* app/gui/preferences-dialog.c
	* app/tools/picmanmovetool.c
	* app/display/picmandisplayshell-selection.c: changed accordingly
	(simply removed the unneded include or use
	gdk_gc_set_rgb_[fg|bg]_color() instead).

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-callbacks.[ch]: chopped
	picman_display_shell_canvas_events() in smaller callbacks. Only the
	events that trigger tool actions are handled in a single callback.

2001-11-30  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-qmask.[ch]: new files: the QMask stuff
	stripped from GUI code. Added picman_image_qmask_invert().

	* app/core/picmanimage.[ch]: removed the QMask functions.

	* app/display/Makefile.am
	* app/display/picmandisplayshell-qmask.[ch]: removed.

	* app/gui/Makefile.am
	* app/gui/qmask-commands.[ch]: new files for the new QMask item
	factory callbacks and the qmask query dialog.

	* app/gui/menus.c: added a context menu for the QMask button.

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-handlers.c: don't include the qmask
	stuff.

	* app/display/picmandisplayshell-callbacks.[ch]: Moved the 2 qmask
	callbacks here. Don't popup the dialog on double_click. Show
	the contect menu on right-click.

	* app/display/picmandisplayshell-callbacks.[ch]:
	picman_display_shell_canvas_events(): removed the hack of
	conntecting "key_press_event" to gtk_true() while a tool is
	active. Instead, check for (event & GDK_BUTTON1_MASK) in the
	key_press and key_release handlers and stop signal emission. Save
	the modifier state on "button_press" and restore it after
	"button_release".

	Changed the way context menus are updated/shown:

	- removed PicmanContainerContextFunc.
	- pass around item factory identifiers (e.g. "<Brushes>")
	- added voodoo to update the menus before showing them.

	* app/widgets/picmanitemfactory.[ch]: picman_item_factory_new(): take
	a PicmanItemFactoryUpdateFunc parameter, attach it as data to the
	factory and use it to update the menu in
	picman_item_factory_popup_with_date().

	* app/widgets/picmanwidgets-utils.[ch]: removed
	picman_item_factory_popup_with_data() here.

	* app/widgets/picmanbrushfactoryview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmandrawablelistview.[ch]: use item_factory
	identifier strings all over the place.

	* app/widgets/picmandockbook.c: removed the menu update code, it's
	now in gui/dialogs-commands.c.

	* app/gui/brushes-commands.[ch]
	* app/gui/buffers-commands.[c]
	* app/gui/channels-commands.[ch]
	* app/gui/dialogs-commands.[ch]
	* app/gui/documents-commands.[ch]
	* app/gui/gradient-editor-commands.[ch]
	* app/gui/gradients-commands.[ch]
	* app/gui/layers-commands.[ch]
	* app/gui/palettes-commands.[ch]
	* app/gui/patterns-commands.[ch]: removed all show_context_menu()
	functions and made the update functions public. Changed all
	update functions to use the picman_item_factory_set_foo() methods
	instead of picman_menu_item_set_foo().

	* app/gui/menus.c: pass the update functions to the
	picman_item_factory_new().

	* app/gui/dialogs-constructors.c: pass item factory identifiers to
	all view constructors.

	* app/gui/gradient-editor.c: show the context menu using the new
	method.

	* app/gui/toolbox.c: no need to include "dialogs-commands.h".

2001-11-29  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig.c (picman_config_serialize): ooops.

2001-11-29  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: set the accelerators for the "Open Recent"
	items > 10 to "" instead of NULL so gtk+ doesn't use the stock
	item's default accel.

	* app/widgets/picmandock.c
	* app/widgets/picmanimagedock.c: set the docks' titles to
	"Picman Dock #<n>" instead of just "Picman" so they can be
	distinguished in the WM's window list or dock or whatever.

2001-11-29  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: put the last_opened menu entries in a
	submenu called "Open Recent", added items to create a dock
	with some useful tabs in it ("Brushes, Patterns & Stuff..."),

	* app/gui/dialogs-commands.[ch]: added a callback for the new
	"Stuff" menu entry.

	* app/gui/dialogs-constructors.h: removed dialogs_lc_get()
	declaration because it doesn't exist.

2001-11-29  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.[ch]: replaced the QMask radio
	buttons by a single check button. Still needs some tuning.

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-qmask.[ch]: changed accordingly.

	* app/tools/picmantool.[ch]: added "gboolean handle_empty_image" to
	the PicmanTool structure.

	* app/tools/picmanmovetool.c: set it to TRUE.

	* app/tools/picmanfuzzyselecttool.c: don't picman_[set|unset]_busy()
	while calculating the selection but set the busy cursor on the
	display manually (we have the pointer grabbed anyway).

	* app/display/picmandisplayshell-callbacks.c: don't check for
	PICMAN_IS_MOVE_TOOL(active_tool) but look at
	active_tool->handle_empty_image. Removed the checks for
	PICMAN_IS_FUZZY_SELECT_TOOL(active_tool) because fuzzy_select
	doesn't set PICMAN busy while it's active any more.

	* app/tools/transform_options.[ch]
	* app/tools/picmantransformtool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c: added widgets for the transform tools'
	constraints (one more #51108 issue fixed).

	* app/tools/picmanerasertool.c: cosmetic.

	* app/widgets/picmandockbook.c: don't hardcode GtkNotebook's
	tab_border to 0 but add a style property for it...

	* themes/Default/gtkrc: ...and set it to 0 here.

2001-11-29  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanenv.c
	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/imagemap/imap_preferences.c: use g_build_filename().

	* plug-ins/script-fu/script-fu-scripts.c: use new GDir functions,
	g_build_filename() and g_file_test() to make code more portable.
	Don't use deprecated gdk_font functions. We don't use X fonts any 
	longer.

2001-11-29  Sven Neumann  <sven@picman.org>

	* app/picmanrc.c (save_picmanrc_strings): reverted list handling for 
	unknown_tokens to the code used in 1.2 which has the advantage that
	it doesn't crash.

2001-11-29  Sven Neumann  <sven@picman.org>

	* m4macros/picman-1.4.m4: use picmantool-1.3.

	* app/display/picmandisplayshell.c
	* app/gui/gui.c: cosmetic changes from Guillermo S. Romero.

	* plug-ins/common/*.c
	* plug-ins/script-fu/script-fu-scripts.c: applied patches from
	Guillermo S. Romero that change the button ordering. I had to redo
	some of the changes by hand since the patches didn't apply cleanly.
	Hopefully got it all right...

2001-11-28  Kelly Martin  <kmartin@pyrzqxgl.org>

	* base/pixel-region.c base/tile-manager.c: a couple more
	interesting off-by-one errors.  it appears to work now, though.

2001-11-28  Kelly Martin  <kmartin@pyrzqxgl.org>

	* base/pixel-region.c: corrected an off-by-one error, sorry :)

2001-11-28  Kelly Martin  <kmartin@pyrzqxgl.org>

	* app/undo.c: Fixed another use of array of gpointer in place of a
	proper struct, this time in undo_(push|pop)_channel_mod.

	* base/base-types.h
	* base/tile-manager.h
	* base/tile-manager-private.h
	* base/tile-manager.c: added PixelDataHandle as an abstraction
	on top of tiles.  PixelDataHandles either return a pointer into
	the tile data, or create a temporary buffer so the calling
	function can access data from disparate tiles using a single
	buffer.  This is a step in reducing the dependence of core
	image functions being aware of tiles as well as a step toward
	having a single abstraction for pixel data.

	* app/image_map.c: changed to use read_pixel_data_1
	* app/pixel-region.c: changed to use the read_pixel_data and
	write_pixel_data where practical.  

2001-11-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-mask.[ch]: s/gimage_mask/picman_image_mask/g

	* app/floating_sel.c
	* app/undo.c
	* app/undo_history.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanedit.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-mask-select.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/display/picmandisplayshell-qmask.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmandisplayshell.c
	* app/gui/channels-commands.c
	* app/gui/edit-commands.c
	* app/gui/layers-commands.c
	* app/gui/select-commands.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanchannellistview.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/selection_cmds.c: regenerated.

2001-11-28  Michael Natterer  <mitch@picman.org>

	* app/base/base-types.h: include the new
	"paint-funcs/paint-funcs-types.h".

	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs-types.h: new file. Includes
	"base/base-types.h".

	* app/paint-funcs/paint-funcs.[ch]: removed the enums here,
	include "paint-funcs-types.h".

	* app/widgets/widgets-types.h: include "display/display-types.h"

	* app/display/display-types.h: include "widgets/widgets-types.h".

	* app/tools/tools-types.h: include "display/display-types.h"

	* app/gui/gui-types.h: include "tools/tools-types.h".

	The order of namespaces/dependencies should be (but is not):

	(base, paint-funcs) -> (core, file, xcf, pdb) ->
	(widgets, display) -> tools -> gui

	* app/path.c: include "tools/tools-types.h".

	* app/core/Makefile.am
	* app/core/picmanimage-guides.[ch]
	* app/core/picmanimage-merge.[ch]
	* app/core/picmanimage-resize.[ch]
	* app/core/picmanimage-scale.[ch]: new files.

	* app/core/picmanimage.[ch]: removed the stuff which is in the new
	files. Reordered all functions in both the .h and .c files,
	commented the groups of functions.

	* app/core/picmancontainer.c: create the handler_id using a counter,
	not the address of a pointer, because the address *may* be the
	same twice, added debugging output.

	* app/core/picmanviewable.[ch]: added primitive support for getting
	a preview GdkPixbuf.

	* app/nav_window.c
	* app/undo.c
	* app/undo_history.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.[ch]
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-scroll.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/palette-import-dialog.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/widgets/picmancontainerview-utils.c
	* app/xcf/xcf-load.c: changed accordingly, some cleanup.

	* tools/pdbgen/pdb/guides.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly, reordered functions.

	* app/plug_in.c: set the labels of the "Repeat" and "Re-Show" menu
	items to the name of the last plug-in (Fixes #50986).

	* app/display/picmandisplayshell.[ch]: set the labels of "Undo" and
	"Redo" to the resp. undo names. Much simplified the WM-icon stuff
	by removing most code and using picman_viewable_get_new_preview_pixbuf().

	* app/widgets/picmanbrushfactoryview.c: forgot to assign the GQuark
	returned by picman_container_add_handler().

	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.[ch]: regenerated.

2001-11-28  Kelly Martin  <kmartin@pyrzqxgl.org>

	* app/undo.c: Fixed evil<tm> double casting of enum to glong to
	gpointer for layer_mod undo by using a struct instead of an array
	of gpointer (!!!) for storing layer_mod undo data.  Also moved
	layer offset undo information out of the undo tile manager. 
	* app/image_map.c: Moved layer offset undo information out of the
	undo tile manager.

	Above changes may break image_map and layer_mod undos, please test
	as I haven't. :)

2001-11-28  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-projection.[ch]: new files. Changed function
	names to be consistent.

	* app/core/picmanimage.[ch]: removed the projection stuff
	here. Removed the picman_image_composite_blah() functions because
	they were just calling the resp. picman_image_projection ones.

	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanpalette-import.c
	* app/undo.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-render.c
	* app/gui/info-window.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

2001-11-28  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-wilber-16x16.png
	* themes/Default/images/stock-wilber-32x32.png
	* themes/Default/images/stock-wilber-48x48.png
	* themes/Default/images/stock-wilber-64x64.png: new files.

	* themes/Default/Makefile.am: create picman-wilber-pixbufs.h

	* libpicmanwidgets/picmandialog.[ch]: removed picman_dialog_set_icon().

	* libpicmanwidgets/picmanwidgets.[ch]: added picman_widgets_init() which
	calls picman_stock_init() and calls gtk_window_set_default_icon_list()
	with the above set of inlined pixbufs.

	* libpicman/picmanui.c
	* app/gui/gui.c: call picman_widgets_init().

	* app/display/picmandisplayshell.c: removed the fallback icon stuff.

	* app/gui/splash.c
	* app/gui/user-install-dialog.c
	* app/widgets/picmandock.c
	* app/widgets/picmanitemfactory.c
	* libpicmanwidgets/picmanhelpui.c
	* plug-ins/imagemap/imap_default_dialog.c
	* plug-ins/imagemap/imap_file.c: don't call picman_dialog_set_icon().

	* plug-ins/common/uniteditor.c: wanted to start hacking here...
	Nothing really changed.

2001-11-28  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbutton.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanoffsetarea.c: fixed button_press event handling,
	removed double g_return_if_fail()s, misc. cleanup.

	* app/display/picmandisplayshell.c: removed the SET_COLOR() stuff
	here...

	* app/gui/menus.c: ...and added it here so it actually works.

	* app/widgets/picmancolorpanel.c: add color previews to the
	item_factory.

	* app/widgets/picmandockbook.c: use the item_factory functions now
	that they are in widgets/.

	* app/widgets/picmanitemfactory.[ch]: nothing, we just want to keep
	the RCS hirtory.

2001-11-27  Daniel Egger  <degger@fhm.edu>

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs.h: Unsignified lots of arguments
	and misc cleanups.

2001-11-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanitemfactory.[ch]: put the whole generic stuff
	from gui/menus.[ch] here (where generic == less_evil because it at
	least does not depend on particular menu entries).

	* app/gui/menus.[ch]: removed the stuff here. Only the global menu
	definitions and bad hacks to adjust them to our needs left.
	Removed all menus_get_foobar_factory() functions because we can
	use gtk_item_factory_from_path("<FooBar>") all over the place.

	* app/plug_in.c
	* app/display/picmandisplayshell.c
	* app/gui/brushes-commands.c
	* app/gui/buffers-commands.c
	* app/gui/channels-commands.c
	* app/gui/dialogs.c
	* app/gui/documents-commands.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor-commands.c
	* app/gui/gradients-commands.c
	* app/gui/gui.c
	* app/gui/layers-commands.c
	* app/gui/palettes-commands.c
	* app/gui/paths-dialog.c
	* app/gui/patterns-commands.c
	* app/gui/toolbox.c: changed accordingly. None of these files
	except gui/gui.c includes gui/menus.h any more.

2001-11-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c: GType is a pointer now, not a guint.

	* app/widgets/picmandock.c: chain up in widget_class->style_set().

	Gradient Editor chopping plus merging of bex' proofreading:
	(fixes #62278).

	* app/core/core-types.h: moved the gradient related enums here.

	* app/core/picmangradient.[ch]: removed the enums, added gradient
	segment utility functions from the gradient_editor.

	* app/gui/gui-types.h: added the GradientEditor typedef here.

	* app/gui/Makefile.am
	* app/gui/gradient-editor-commands.[ch]: new files implementing
	callbacks and menu_update stuff for the new gradient_editor
	item factory.

	* app/gui/gradient-editor.[ch]: removed tons of code, namespace
	cleanup, stuff...

	* app/gui/menus.[ch]: added the gradient_editor menu stuff here.
	Added menus_set_color() which creates & updates a color menu item
	(will soon be used in other places too). Renamed menus_set_state()
	to menus_set_active().

	The editor's menu code is ugly as before, only different and evil
	the same way as the rest of the menu stuff, so it's at least
	consistent :)

	* app/display/picmandisplayshell.c: changed accordingly.

	* app/gui/test-commands.c: don't include "gradient-editor.h".

2001-11-27  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/Makefile.am
	* app/config/picmanconfig.[ch]
	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig-deserialize.[ch]: added new base class
	PicmanConfig that knows how to serialize and deserialize it's properties
	in sexp format. Contains two example properties that will go into
	derived classes once this is really used.

	* app/main.c: deserialize and serialize the test PicmanConfig object to
	~/.picman-1.3/foorc (only for debugging).

	* app/widgets/widgets-types.h
	* app/core/core-types.h: moved PicmanPreviewSize enum to core-types.

	* app/core/core-types.h: don't include gdk-pixbuf.h.

	* app/core/picmantoolinfo.h
	* app/core/picmanimagefile.c: include gdk-pixbuf.h.

	* app/core/picmanimage.[ch]: made construct_flag a gboolean.

	* app/core/picmandrawable-invert.c
	* app/core/picmanunit.c
	
	* tools/pdbgen/pdb/plug_in.pdb
	* app/pdb/plug_in_cmds.c: removed unused variables.

	* app/display/Makefile.am: removed .PHONY and files cruft

	* app/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am
	* plug-ins/Makefile.am: removed commented out makefile.mingw rules.
	If we ever need them again, they can easily be resurrected from CVS.
	
2001-11-26  Kelly Martin  <kmartin@pyrzqxgl.org>

	* app/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am
	* plug-ins/Makefile.am:
	Commented out makefile.mingw rules in Makefile.am.  These conflict
	with the default rules generated by automake and generate annoying
	warnings.  tml doesn't think they're needed anymore.  If it turns
	out they are, they can be added back.

2001-11-26  Rebecca Walter  <rjp@mail.tele.dk>

	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/error-console-dialog.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: More of my extensive proofing.
	Someone needs to check bex comments and do some hacking.

2001-11-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: picman_image_construct_layers/channels():
	actually free the reverse_list after projecting the drawables.
	(Spotted by Kelly Martin).

2001-11-26  Michael Natterer  <mitch@picman.org>

	* tools/authorsgen/contributors: added Rebecca Walter (bex).

	* AUTHORS
	* app/gui/authors.h: regenerated.

	* app/widgets/widgets-types.h: added PicmanPreviewSize enum.

	* app/picmanrc.c
	* app/gui/menus.c
	* app/gui/preferences-dialog.c
	* app/widgets/picmandockbook.c: use the new enum.

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanmagnifytool.c: added "(<Ctrl>)" and "(<Alt>)" to
	some tool options strings.

	* app/tools/picmanmovetool.c: some more widgets for hidden tool
	options (#51108).

	* app/tools/transform_options.c: renamed to "Tool Paradigm" stuff
	to something more understandable.

	* app/widgets/picmandock.c: added a style property for the height
	of the separator.

	* themes/Default/gtkrc: show how to use the new property.

	* app/widgets/picmancontainerview.c
	* app/widgets/picmandockable.c
	* app/widgets/picmanlayerlistview.c: waste less lines when calling
	gtk_widget_style_get().

2001-11-25  Simon Budig  <simon@picman.org>

	* app/tools/picmanerasertool.c
	* app/tools/picmanerasertool.h
	* tools/pdbgen/pdb/tools.pdb: Removed the color_erase option of
	the eraser.

	* app/pdb/tools_cmds.c: regenerated.

2001-11-25  Simon Budig  <simon@picman.org>

	* app/paint-funcs/paint-funcs.c: ANTI_ERASE had wrong
	layer mode information (according to the comments).
	Changed it to something sane. I did test it and no
	errors occurred. I wonder why they did not happen earlier...

2001-11-25  Sven Neumann  <sven@picman.org>

	* Made 1.3.1 release.
	
2001-11-25  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/Makefile.am
	* data/misc/Makefile.am: made 'make dist' happy.

2001-11-25  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* configure.in
	* picman-1.3.pc.in
	* picmanui-1.3.pc.in: added pkg-config files for picman-1.3.

	* picmantool-1.4.in: renamed to picmantool-1.3.in

	* docs/Makefile.am
	* docs/picmantool-1.4.1.in renamed to docs/picmantool-1.3.1.in.
	Disabled installation of man-pages; they need to be updated and
	should probably be renamed.

	* app/Makefile.am: generate binary called picman-1.3 so we don't clash
	with older picman installations.

	* picman-1.3.pc.in
	* picmanui-1.3.pc.in: added pkg-config files for picman-1.3.

	* INSTALL
	* NEWS: updated

2001-11-24  Sven Neumann  <sven@picman.org>

	Clean up after Marc Lehmann who changed tools/pdbgen/pdb/color.pdb
	and tools/pdbgen/pdb/image.pdb without writing a ChangeLog entry and
	without regenerating the respective files :-(
	
	* tools/pdbgen/pdb/color.pdb: another typo fix similar to the one
	Marc spotted.

	* app/pdb/color_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmancolor_pdb.c
	* libpicman/picmanimage_pdb.c: regenerated.

2001-11-24  Sven Neumann  <sven@picman.org>

	* app/picmanrc.c
	* app/plug_in.[ch]
	* app/pdb/plug_in_cmds.c
	* tools/pdbgen/pdb/plug_in.pdb: started to clean up plug_in code a 
	little. Still a long way to go...

	* app/gui/splash.c: simplified

2001-11-24  Simon Budig  <simon@picman.org>

	* app/base/base-types.h
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs.h
	* app/widgets/picmanwidgets-constructors.c:

	implemented "Color Erase" paint mode, the hack in the
	eraser tool will be removed.

	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated

2001-11-24  Rebecca Walter  <rjp@mail.tele.dk>

	* app/gui/about-dialog.c
	* app/gui/brush-select.c
	* app/gui/color-notebook.c
	* app/gui/colormap-dialog.c: miscellaneous proofreading.

2001-11-23  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c: don't draw resize_grip in status bar
	(patch from Guillermo S. Romero).

	* app/devices.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-qmask.c
	* app/display/picmandisplayshell.c
	* app/gui/channels-commands.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/gui/error-console-dialog.c
	* app/gui/file-new-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/layers-commands.c
	* app/gui/module-browser.c
	* app/gui/offset-dialog.c
	* app/gui/palette-import-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/user-install-dialog.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/widgets/picmanfontselection-dialog.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanunitmenu.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c: changed button order to follow the
	new GTK+ style: confirmative is right-most (for LTR rendering).

2001-11-23  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c: removed a useless g_return_if_fail().

	* app/widgets/picmancontainereditor.h: removed PicmanViewType enum.

	* app/widgets/widgets-types.h: added it here.

	* app/widgets/picmancontainerview-utils.[ch]: added a utility function
	which gets the PicmanContainerView out of a PicmanDockable.

	* app/widgets/picmandialogfactory.[ch]: added support for saving and
	loading of each PicmanDockable's preview size. Store the dialog's
	default preview size in the PicmanDialogFactoryEntry.  Pass the
	preview_size to each created dialog.

	* app/gui/menus.c: added menu items for setting the preview_size
	and switching between list and grid view. Removed the item
	overkill in the "Add Tab" submenu.

	* app/gui/dialogs-commands.[ch]: added callbacks for the new items.

	* app/widgets/picmandockbook.c: set the item's state before showing
	the menu.

	* app/errors.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/edit-commands.c
	* app/gui/gui.c
	* app/gui/indicator-area.c
	* app/gui/toolbox.c: changed accordingly.

	* app/tools/selection_options.[ch]: cleaned up the selection
	options and added some tooltips. Much more to do...

2001-11-23  Rebecca Walter  <rjp@mail.tele.dk>

	* app/file/*.c: Proofing. only minor changes.

2001-11-23  Sven Neumann  <sven@picman.org>

	* app/picmanrc.c: don't include picmanutils.h, it's gone.

	* libpicmanbase/Makefile.am: removed stale reference to picmanutils.h.

	* libpicmanwidgets/picmancolorbutton.h: wanted to type G_END_DECLS here.

2001-11-23  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 1.3.1. 
	Require Glib/GTK+-1.3.11 and Pango-0.22. Removed GDK_DISABLE_COMPAT_H
	and GTK_DISABLE_COMPAT_H from our default CFLAGS since they don't
	exist any longer.
	
	* RELEASE-TO-CVS.patch: removed since the glib/gtk+ API is supposed to
	be frozen now.

	* HACKING: removed reference to RELEASE-TO-CVS.patch

	* app/gui/menus.c
	* app/tools/picmantexttool.c: applied RELEASE-TO-CVS.patch to conform
	to the new GTK+/Pango API.

	* app/core/Makefile.am: generate marshallers with picman_marshal prefix.
	
	* app/core/picmanmarshal.list: added all marshallers we use.

	* app/core/picmanmarshal.[ch]: regenerated.

	* app/[lots of .c files]: use picman_marshal_* for all marshallers.
	
	* data/images/
	* app/app_procs.c
	* app/gui/splash.c:

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmanutils.[ch]: removed since they are no longer needed.

	* app/picmanrc.c
	* plug-ins/common/ps.c
	* plug-ins/gdyntext/gdyntext.c
	* plug-ins/gdyntext/gdyntextcompat.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/script-fu/script-fu-scripts.c: use glib functions instead
	of picman_strescape() and picmanstrcompress().

	* cleaned up all header files: use G_BEGIN_DECLS/G_END_DECLS, declared
	all _get_type function as G_GNUC_CONST.
	
	* tools/pdbgen/enumcode.pl
	* tools/pdbgen/lib.pl: make them generate header files using 
	G_BEGIN_DECLS/G_END_DECLS.

	* pixmaps/Makefile.am
	* pixmaps/wilber3.xpm: removed ...
	* data/images/tips_wilber.png: ... and added here as PNG
	
	* app/gui/tips-dialog.c: load the Wilber on demand using GdkPixbuf.

	* data/images/picman_splash.ppm: removed ...
	* data/images/picman_splash.png: ... and added as PNG

	* app/app_procs.c
	* app/gui/splash.[ch]: load the splash image using GdkPixbuf.

	* app/gui/about-dialog.c: sink the GtkPreview.
	
2001-11-22  Michael Natterer  <mitch@picman.org>

	* app/devices.c: made device_status_update() static as declared.

	* app/core/picmanobject.h: don't include <gobject/gobject.h> as this
	is forbidden now (doesn't hurt as we need to include glib or gtk+
	before picman headers in .c files anyway).

	* app/widgets/picmancontainerlistview.c: better handling of
	"button_press" of list items: don't let a selected item being
	deselected, fixed context menu popup.

2001-11-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/paint_options.c
	* app/tools/transform_options.c: removed the remaining cases of
	we-rely-on-the-radio-buttons-being-in-the-same-order-as-the-enum
	and use picman_radio_group_set_active() instead.
	Use GINT_TO_POINTER(gint) instead of (gpointer)gint all over
	the place.

2001-11-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanstock.c: added stock *items* (not only icons)
	for all tools so they can be used as action buttons.

	* app/tools/picmantransformtool.[ch]: added
	transform_tool->use_center so subclasses can switch on/off center
	detection/cursor_update . Added an oper_update() implementation
	and figure the current handle out there. Reordered button_press()
	so we don't need to call it recursively.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: use the new stock items instead of
	_("Rotate") etc.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanscaletool.c: allow the whole thing being dragged
	around by handling the center separately.

	* app/tools/picmandrawtool.c: picman_draw_tool_on_handle(): need to
	use the radius, not the diameter to check if being over a
	PICMAN_HANDLE_CIRCLE handle.

2001-11-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.[ch]: use "picman-item-data" instead of
	"user_data" as data key when attaching values to radio buttons or
	menu items. (For backward compat, attach "user_data" additionally,
	but don't use it to _get_data()).
	Added picman_radio_group_set_active() which works like
	picman_options_menu_set_history() and sets the active item by
	attached "picman-item-data" value.

	* app/gui/brush-select.c
	* app/gui/file-new-dialog.c
	* app/gui/info-window.c
	* app/gui/preferences-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanselectiontool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/widgets/picmanlayerlistview.c: removed all kinds of
	"user_data" stuff and evil hacks to find a radio button by the
	value it represents (simply call picman_radio_group_set_active()).

	* app/tools/picmandrawtool.c: added a g_return_if_fail().

	* app/tools/picmanfliptool.c: don't set draw_tool_class->draw to NULL,

	* app/tools/picmantransformtool.[ch]: fixed some stuff i broke when
	removing the old "interactive" boolean (there is no
	non-interactive transform tool any more).  Put the info_dialog
	pointer and the old_trans_info array into the PicmanTransformTool
	instance. Added picman_transform_tool_info_dialog_connect(). Don't
	include any subclasses any more.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: use
	picman_transform_tool_info_dialog_connect() to create and connect
	the info dialogs' action_area.

2001-11-21  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: sink the GtkPreview created for the splash.
	
	* libpicmanwidgets/picmanhelpui.c: ref and sink the tooltips on creation.
	
2001-11-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanfileselection.c: set the window title for file
	selection dialogs as we do for directory selection dialogs. Provide
	fallbacks if picman_file_selection_new() is called with a NULL title.

	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/siod-wrapper.c: applied a modified version of a
	patch from Matteo Nastasi <matteo.nastasi@milug.org> that adds the new 
	Script-Fu parameter type SF-DIRNAME.

	* plug-ins/script-fu/scripts/test-sphere.scm: use SF-DIRNAME.

2001-11-21  Michael Natterer  <mitch@picman.org>

	* RELEASE-TO-CVS.patch: regenerated with the stuff below included.

2001-11-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: seems I've comitted something which
	should only be in RELEASE-TO-CVS.patch. Sorry...

2001-11-21  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: key press and release
	events were sent swapped to tools.

	* app/tools/selection_options.[ch]: added radio buttons for the
	selection operation (REPLACE, ADD, ...). Partly fixes #51108.

	* app/tools/picmanselectiontool.[ch]: honor the new tool options
	stuff. Do evil things in picman_selection_tool_modifier_key().

	* app/tools/picmanbycolorselecttool.[ch]: removed most of the
	widgets from the by_color_select window because they are all in
	the selection_options now.

	* libpicmanwidgets/picmanstock.[ch]: added new stock items for the
	buttons.

	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-button-selection-add.png
	* themes/Default/images/stock-button-selection-intersect.png
	* themes/Default/images/stock-button-selection-replace.png
	* themes/Default/images/stock-button-selection-subtract.png: new
	stock images.

2001-11-21  Michael Natterer  <mitch@picman.org>

	* app/tools/selection_options.c: added "reset" code for the new
	auto_shrink tool options.

2001-11-21  Michael Natterer  <mitch@picman.org>

	* pixmaps/Makefile.am
	* pixmaps/anchor.xpm
	* pixmaps/edit.xpm
	* pixmaps/eye.xpm
	* pixmaps/linked.xpm
	* pixmaps/paste-as-new.xpm
	* pixmaps/paste-into.xpm
	* pixmaps/refresh.xpm: felt like i had to remove some cruft, so
	these unused pixmaps had to go to the Attic.

2001-11-21  Michael Natterer  <mitch@picman.org>

	* RELEASE-TO-CVS.patch: regenerated after the text tool changes.

2001-11-20  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-types.h: added PicmanToolRegisterFunc,
	PicmanToolRegisterCallback and PicmanToolOptionsNewFunc typedefs
	which are used to register tools.

	* app/tools/tools.c: put the register funcs in an array of
	PicmanToolRegisterFuncs. Pass a Picman pointer *plus* a
	PicmanToolRegisterCallback (which is tool_manager_register_tool())
	to the tools' register functions.

	* app/tools/tool_manager.[ch]: added a PicmanToolOptionsNewFunc to
	the parameters of tool_manager_register_tool(). Create the tool
	options here, not in each tool.

	* app/tools/paint_options.[ch]
	* app/tools/selection_options.[ch]
	* app/tools/tool_options.[ch]
	* app/tools/transform_options.[ch]: all _init() and _new()
	functions take a PicmanToolInfo pointer now. The _reset() func needs
	to be set manually now.

	* app/tools/[all_tools].[ch]: changed accordingly:

	- pass PicmanToolOptionsNewFuncs to the register callback.
	- don't create the tool options in the tools' _init() function.
	- removed all static tool options variables.
	- get the options from the tool system in the cases i missed
	  in my last commit.
	- added minor hacks to get rid of the static options pointer
	  in some pathological cases :) (i.e. the ink tool).

2001-11-20  David Neary <dneary@eircom.net>

	* app/core/picmanpalette.c: Included errno.h

2001-11-20  Rebecca Walter <rjp@mail.tele.dk>

	* app/core/picmanedit.c
	* app/core/picmanimagefile.c
	* app/core/picmanmoduleinfo.c
	* app/core/picmanmodules.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: More of the extensive proofing. Fun fun fun!

2001-11-20  Sven Neumann  <sven@picman.org>

	* app/gui/preferences-dialog.c
	* plug-ins/common/gif.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/mail.c: don't strip last character off when 
	retrieving text from a GtkTextBuffer. There used to be a bug in GTK+
	that made this necessary. It has been fixed in the meantime.

	* plug-ins/picmanressionist/size.c: merged string fix from stable branch.

2001-11-20  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]
	* app/tools/picmanpainttool.[ch]
	* app/tools/picmanrectselecttool.[ch]
	* app/tools/picmantool.[ch]
	* app/tools/picmantransformtool.[ch]: use simple virtual functions
	instead of signals for all tools because they are much faster and
	don't need to be signals at all.

2001-11-20  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c: put a g_object_ref() on a different line.

	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanmodules.c: ne need to #include "core/..." here.

	* app/display/picmandisplay-handlers.c: added debugging output
	because we have an image refcounting problem :(

	* app/display/picmandisplayshell-handlers.c: fixed a signal
	disconnection.

	* app/tools/picmanbezierselecttool.[ch]
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmansmudgetool.c: get the tool's options via
	tool->tool_info->tool_options, not from the local statis pointer.
	Some minor cleanups & function reordering.

	* app/widgets/picmandockbook.c: return TRUE from the notebook tabs'
	"button_press" handler, connect DND before cnnecting to
	"button_press" because we now stop it's emission.

2001-11-19  Daniel Egger  <degger@fhm.edu>
	
	* app/paint-funcs/paint-funcs.h: Added magic comment to prevent
	enums from being exported.

2001-11-19  Daniel Egger  <degger@fhm.edu>
	
	* app/paint-funcs/paint-funcs-mmx.h 
	* app/paint-funcs/paint-funcs.c: Fixed typoes and brought the
	code back to compileland.

	Now the code IS tested. :)

2001-11-19  Michael Natterer  <mitch@picman.org>

	Some moving of unused files so they don't clutter app/...

	* app/gdisplay_color.[ch]
	* app/gdisplay_color_ui.[ch]: removed...

	* app/display/picmandisplayshell-filter.[ch]
	* app/display/picmandisplayshell-filter-dialog.[ch]: ...added here.

2001-11-19  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay-foreach.c: forgot to commit last time.

	Transform stuff cleanup:

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmandrawable-transform.[ch]: new files implementing
	the actual transform functions cut from tools/picmantransformtool.*.

	* app/core/picmandrawable-transform-utils.[ch]: new files implementing
	transform matrix assembly utility functions.

	* app/tools/picmantransformtool.[ch]: removed the stuff here. cleanup.

	* app/tools/transform_options.[ch]: removed all stuff which does
	not belong here, e.g. the transform_tool_* functions and the
	global "transform_options" variable. Works like all other tool
	options now.

	* app/tools/picmanfliptool.[ch]
	* app/tools/picmanperspectivetool.[ch]
	* app/tools/picmanrotatetool.[ch]
	* app/tools/picmanscaletool.[ch]
	* app/tools/picmansheartool.[ch]: massive code removal because
	we can use core/picmandrawable-fransform* functions now. cleanup.

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl: added new PDB group "transform_tools".

	* tools/pdbgen/pdb/tools.pdb: removed the transform stuff here...

	* tools/pdbgen/pdb/transform_tools.pdb: and added *much*
	simplified versions which use the new core/picmandrawable-transform*
	utilities.

	* app/pdb/Makefile.am
	* app/pdb/transform_tools_cmds.c: new file.

	* app/pdb/internal_procs.c
	* app/pdb/tools_cmds.c: regenerated.

	* libpicman/Makefile.am
	* libpicman/picman_pdb.h
	* libpicman/picmantransformtools_pdb.[ch]: new files.

	* libpicman/picmantools_pdb.[ch]: regenerated.

2001-11-19  Daniel Egger  <degger@fhm.edu>

	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs-generic.h 
	* app/paint-funcs/paint-funcs.h: 
	- Statified a few functions so they can be inlined.
	- Simplified function calls.
	- Unsignified variables and parameters where possible.
	- Reduced lookuptable size for add_pixels from 256*256*4 bytes
	  to 2*256-1 bytes and O(n*n) function in paint_funcs_setup
	  to O(n). Should reduce memory consumption by almost 1/4 Mb.
	
	This needs much more cleanup....
	
2001-11-19  Daniel Egger  <degger@fhm.edu>
	
	* app/paint-funcs/paint-funcs-mmx.h: New file. Added glue code
	for the assembly MMX functions.

	* app/paint-funcs/paint-funcs-generic.h: Moved MMX code from here ...
	* app/paint-funcs/paint-funcs-mmx.h: ... to here. Cleaned up a bit
	and don't check for use_mmx on every single call but ...
	* app/paint-funcs/paint-funcs.c: (paint_funcs_setup): ... here and
	register MMX functions if CPU has those capabilities.

	Code is untested for the MMX case due no available Intel-Machine
	right now but should't be to far away from a working state. 

2001-11-19  Sven Neumann  <sven@picman.org>

	* RELEASE-TO-CVS.patch: changes to the text tool to make it compile 
	with the new PangoFT2 API. 

2001-11-19  Daniel Egger  <degger@fhm.edu>

	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs-generic.h: Split generic (read: C) 
	code for pixelmanipulation and most of the code that belongs to it
	into new file.
	(apply_layer_funcs): Gone. The correct layer function is now 
	dispatched from the layer_mode_funcs table and the table is 
	per default initialised with the generic functions. Arguments
	will be passed by a struct apply_layer_mode_struct instead
	of directly per stack to avoid parameter typying madness.
	
	It's now cleanly possible to check for availabilty of 
	MMX/AltiVec/(insert your favourite brew here) in 
	paint_funcs_setup () and change the table to use faster routines.
	The old MMX cruft which is temporaribly in paint-funcs-generic.h
	will soon be gone but I'm to tired now.

	* app/paint-funcs/paint-funcs.c: Braind dead code for temporary 
	buffer (which never shrunk only grew) gone and replaced by 
	straightforward code.

	* app/paint-funcs/paint-funcs-generic.h: Applied a bunch of obvious 
	optimisations to reduce code size and avoid parameter madness.

	* paint-funcs-[gray|graya|indexed|rga|rgba].[c|h]: Gone. I lost
	several days of work on these files and came to the conclusion
	that there has to be an easier way anyway. :)

	Everything well tested on PPC and producing exactly the same results
	as the code before so this has good odds to be the first major
	change that won't break PICMAN. :)

2001-11-18  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay-foreach.c: fixed a comment.

	* app/gui/file-open-dialog.c: no need to declare
	"extern GSList *display_list;".

	* app/gui/brush-select.c
	* tools/pdbgen/pdb/brush_select.pdb: pass opacity as [0.0..100.0]
	through the PDB and as [0.0..1.0] to the app.

	* app/pdb/brush_select_cmds.c: regenerated.

	* plug-ins/gfig/gfig.c: full opacity is 100.0, not 1.0.

	(GFig and script-fu may still be broken after this change).

2001-11-17  Michael Natterer  <mitch@picman.org>

	Made --no-interface not calling gtk_init() (and thus not
	contacting the X server) any more. (Fixes #58961).

	* app/core/picman.[ch]: added two new function pointers
	"gui_main_loop_func" and "gui_main_loop_quit_func" and an own
	stack of GMainLoops which is used if they are not set.

	* app/gui/gui.[ch]: added main loop functions here and set them as
	pointers in the Picman instance. Separated gui_libs_init() from
	gui_themes_init() so it can be used as replacement for gtk_init()
	and be called before command line parsing.

	* app/main.c: check for "--no-interface" before initializing
	anything. Added a "--g-fatal-warnings" option (cut'n'paste from
	gtkmain.c). Added a check for "--" (end of options).

	* app/app_procs.c: call the new picman_main_loop() functions,
	call gui_themes_init().

	* app/devices.[ch]: reduce usage of "the_picman" by passing "Picman"
	pointers to some functions.

	* app/plug_in.c: some ugly checks for the_picman->no_interface which
	will go away once this file is core/ui chopped. Call
	picman_main_loop() stuff instead of gtk_main().

	* app/core/picmantoolinfo.c: allow passing a NUL GdkPixbuf pointer.

2001-11-17  Wang Jian  <lark@linux.net.cn>

	* configure.in(ALL_LINGUAS): Added zh_CN for Simplified Chinese.

2001-11-17  Daniel Egger  <egger@fhm.edu>

	* app/base/base.c: Prevent from crash if swap_path == NULL. 

2001-11-16  Michael Natterer  <mitch@picman.org>

	Wishlist item #57669:

	* app/picmanrc.[ch]: replaced picmanrc option "allow-resize-windows"
	by "resize-windows-on-zoom" and "resize-windows-on-resize".

	* app/gui/preferences-dialog.c: added a toggle for
	"resize-windows-on-resize".

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-scale.c
	* app/tools/picmanmagnifytool.c
	* docs/picmanrc.5.in
	* etc/picmanrc.in
	* etc/picmanrc.win32: changed accordingly.

	* app/display/picmandisplay-area.[ch]: added picman_area_new().

	* app/display/picmandisplay.c: cleanup usage of PicmanArea.

	* app/display/picmandisplayshell.[ch]: added configurable canvas
	padding color and a small color_panel to change it in the upper
	right corner of the window.

	* app/display/picmandisplayshell-callbacks.[ch]: added a callback
	for the color_panel, initialize the color in the "realize"
	callback.

	Wishlist item #51548.

	* app/display/picmandisplayshell-selection.[ch]
	* app/gui/menus.c
	* app/gui/view-commands.[ch]: made the layer boundary toggleable
	separately from the selection.

	* app/gui/color-notebook.c: #if 0'ed a debugging g_print().

2001-11-16  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorbutton.[ch]: added Black and White to popup
	menu. Take widget->allocation into account when calculating popup 
	position since GtkButton is a NO_WINDOW widget now.

2001-11-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c: s/G_GNUC_PRETTY_FUNC/G_GNUC_PRETTY_FUNCTION/

2001-11-16  Rebecca Walter  <rjp@mail.tele.dk>

	* app/core/picmancontext.c
	* app/core/picmandatafactory.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable.c
	* app/core/picmangradient.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage.c: Extensive proofreading of messages and 
	warnings.  Improved standardization of string format and content.

2001-11-15  Michael Natterer  <mitch@picman.org>

	Picman's opacity values are a pain... the core actually *should*
	only accept and expose values in a [0.0..1.0] range.

	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c: take 0.0 <= opacity <= 1.0,
	*not* 0.0 < opacity <= 100.0.

	* app/tools/picmanblendtool.c: don't (opacity * 100.0) before passing.

	* tools/pdbgen/pdb/tools.pdb: (opacity / 100.0) before passing.

	* app/display/picmandisplayshell-dnd.c: paint_mode and opacity were
	swapped in the call to picman_drawable_bucket_fill_full().

	* app/pdb/tools_cmds.c: regenerated.

2001-11-15  Michael Natterer  <mitch@picman.org>

	* app/gui/layers-commands.c: fixed the layers dialog's "New Layer"
	button by checking for a floating selection in
	layers_new_layer_query() instead of
	layers_new_layer_cmd_callback().

2001-11-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]: restructured the new draw utility
	functions and added picman_draw_tool_draw_handle() and
	picman_draw_tool_on_handle().

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmancroptool.[ch]
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmantransformtool.c: use the new functions all over
	the place so handle drawing and mouse_over detection work the same
	for all tools.

2001-11-15  Michael Natterer  <mitch@picman.org>

	* Makefile.am: removed antique Makefile targets, including the
	"files" hack (which was some automatic EXTRA_DIST voodoo), added
	missing stuff to EXTRA_DIST.

	* app/plug-in/Makefile.am
	* devel-docs/Makefile.am
	* docs/Makefile.am
	* plug-ins/Makefile.am
	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/FractalExplorer/fractalexplorer-examples/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/bmp/Makefile.am
	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/faxg3/Makefile.am
	* plug-ins/fits/Makefile.am
	* plug-ins/flame/Makefile.am
	* plug-ins/gap/Makefile.am
	* plug-ins/gdyntext/Makefile.am
	* plug-ins/gflare/Makefile.am
	* plug-ins/gflare/gflares/Makefile.am
	* plug-ins/gfli/Makefile.am
	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/picmanressionist/Brushes/Makefile.am
	* plug-ins/picmanressionist/Paper/Makefile.am
	* plug-ins/picmanressionist/Presets/Makefile.am
	* plug-ins/ifscompose/Makefile.am
	* plug-ins/imagemap/Makefile.am
	* plug-ins/libgck/Makefile.am
	* plug-ins/libgck/gck/Makefile.am
	* plug-ins/maze/Makefile.am
	* plug-ins/mosaic/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/plugin-helper/Makefile.am
	* plug-ins/print/Makefile.am
	* plug-ins/rcm/Makefile.am
	* plug-ins/script-fu/Makefile.am
	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/sel2path/Makefile.am
	* plug-ins/sgi/Makefile.am
	* plug-ins/webbrowser/Makefile.am
	* plug-ins/xjt/Makefile.am
	* tips/Makefile.am: removed "files" too, some minor cleanups.

2001-11-15  Rebecca Walter <rjp@mail.tele.dk>

	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanchannel.c:  Proofreading to strings, approved by Sven

2001-11-15  Sven Neumann  <sven@picman.org>

	* RELEASE-TO-CVS.patch: recreated from toplevel dir so it applies
	as advertised in HACKING.

2001-11-14  Manish Singh  <yosh@picman.org>

	* RELEASE-TO-CVS.patch: gtk_item_factory_parse_rc->gtk_accel_map_load,
	gtk_item_factory_dump_rc->gtk_accel_map_save

	* configure.in: fixes for newer autoconf, AC_INIT with etc/picmanrc.in
	now

	* app/core/picmancontainer.c: g_type_instance_is_a is private (and
	got renamed recently), use G_TYPE_CHECK_INSTANCE_TYPE instead

	* app/gui/gradient-editor.c: use gtk_accel_label_set_accel_widget
	instead of gtk_accel_label_set_accel_object

	* app/gui/module-browser.c: replaced CList with a TreeView

2001-11-14  Michael Natterer  <mitch@picman.org>

	* data/misc/Makefile.am
	* data/misc/rmshm: removed here again...

	* tools/Makefile.am
	* tools/rmshm: ...and added here.

2001-11-14  Michael Natterer  <mitch@picman.org>

	* configure.in: new directories etc/, data/images/ and data/misc/.

	* Makefile.am
	* data/Makefile.am: added new SUBDIRs.

	* data/images/Makefile.am
	* data/misc/Makefile.am
	* etc/Makefile.am: new Makefiles

	* picman1_0_splash.ppm
	* picman1_2_splash.ppm
	* picman_logo.ppm
	* picman_splash.ppm: removed, now in data/images/

	* rmshm
	* user_install
	* user_install.bat: removed, now in data/misc/

	* picmanrc.in
	* picmanrc.win32
	* picmanrc_user.in
	* gtkrc_user
	* ps-menurc
	* unitrc: removed, now in etc/

	* app/gui/about-dialog.c
	* app/gui/splash.c
	* app/gui/user-install-dialog.c: changed image and script file
	paths accordingly.

2001-11-14  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanrc_cmds.c
	* tools/pdbgen/pdb/picmanrc.pdb: added a missing g_strdup() that caused
	picman_get_default_comment() to free the global default comment.

2001-11-14  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.[ch]: added
	tool_manager_button_press_active() and friends functions.

	* app/display/picmandisplayshell-callbacks.c:
	picman_display_shell_canvas_events(): use the functions instead of
	re-fetching the active_tool whenever it may have changed
	(which requires knowledge about the tools' implementation).
	Also moved lots of variables around.

2001-11-14  Michael Natterer  <mitch@picman.org>

	* Makefile.am: changed build order of toplevel directories so that
	the stuff which is most likely to be broken during "make dist"
	(the po stuff) is built before the actual source.

2001-11-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added "update_guide" signal.

	* app/display/picmandisplay-foreach.[ch]: removed
	gdisplays_expose_guide().

	* app/display/picmandisplayshell-handlers.c: added a handler for
	"update_guide" and expose the guide there.

	* app/undo.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c: call picman_image_update_guide() instead
	of gdisplays_expose_guide().

2001-11-14  Abel Cheung  <maddog@linux.org.hk>

	* configure.in (ALL_LINGUAS): Rename zh_TW.Big5 -> zh_TW to
	  prevent future encoding naming problem.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.h: a cut'n'paste bug prevented tools and
	imagefiles from being dropped.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: get the active_tool
	_after_ maybe changing it by calling devices_check_change().

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: the toolbox menu's last_used_documents menu
	contained one entry too few if the number of documents was smaller
	or equal than picmanrc.last_opened_size.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.[ch]: use PicmanCoords structs for
	cur_coords, last_coords and start_coords and the undo struct
	instead of storing separate gdouble values.

	* app/undo.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmansmudgetool.c: changed accordingly.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/base/temp-buf.c: allow passing NULL to temp_buf_resize() again.

2001-11-13  Michael Natterer  <mitch@picman.org>
	    Sven Neumann  <sven@picman.org>

	* Made 1.3.0 release.

2001-11-13  Sven Neumann  <sven@picman.org>

	* Makefile.am (EXTRA_DIST): added po/po2tbl.sed.in and the po update
	scripts.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* modules/Makefile.am: added colorsel_water.c to EXTRA_DIST.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* NEWS: some more stuff.

2001-11-13  Sven Neumann  <sven@picman.org>

	* INSTALL
	* NEWS
	* README
	* TODO.xml: updated

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/gui/user-installed-dialog.c: fixed some action_area uglyness
	which occured after the switch to GtkDialog.

2001-11-13  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c: added some safety checks. 

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimagefilepreview.[ch]: a new class implementing
	special	PicmanPreview methods for PicmanImagefile.

	* app/core/picmanimagefile.c: added code to load thumbnails according
	to the proposed Thumbnail Managing Standard 
	(see http://triq.net/~pearl/thumbnail-spec/). Pretty much untested.

	* app/widgets/picmancontainerview-utils.c: plugged a memleak.

	* app/widgets/picmanimagepreview.c: simplified.

	* app/widgets/picmanpreview.c: tell it about PicmanImagefilePreview.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am: need to spell EXTRA_DIST correctly now
	that the "files" hack is gone.

2001-11-13  Michael Natterer  <mitch@picman.org>

	* configure.in: commented out generation of some files in
	plug-ins/ so config.status doesn't warn about non-existing
	directories.

2001-11-12  Michael Natterer  <mitch@picman.org>

	* HACKING: small fix.

	* configure.in: changed --disable-perl to --enable-perl because
	it doesn't build properly at the moment.

	* pixmaps/Makefile.am: removed stuff which is no longer there
	from EXTRA_DIST.

	* plug-ins/Makefile.am: put back the $(PICMAN_PERL) line in SUBDIRS.

	* app/widgets/picmanmenuitem.c. include "libpicmanwidgets/picmanwidgets.h".

	* data/Makefile.am
	* data/brushes/Makefile.am
	* data/gradients/Makefile.am
	* data/palettes/Makefile.am
	* data/patterns/Makefile.am: removed the old "files" hack and put
	the stuff to EXTRA_DIST.

	* app/Makefile.am
	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/file/Makefile.am
	* app/gui/Makefile.am
	* app/paint-funcs/Makefile.am
	* app/pdb/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am
	* app/widgets/picmanmenuitem.c
	* app/xcf/Makefile.am
	* cursors/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am
	* m4macros/Makefile.am
	* themes/Makefile.am
	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/Makefile.am: removed "files" target.

2001-11-12  Sven Neumann  <sven@picman.org>

	* po/Makefile.in.in
	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in: fixed distdir.

2001-11-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-types.h: changed PicmanItemGetNameFunc
	signature to return a tooltip in a passed gchar* pointer location.

	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c: changed all get_name_funcs and their
	callers accordingly (passing the "gchar **tooltip" pointer is
	optional).

2001-11-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/pixelize.c: implemented a feature request:

	Made the pixel size configurable independently in x and y
	direction. Added new PDB function. Use a PicmanCoordinates widget
	for the dialog.

2001-11-12  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: use
	picman_display_shell_[install|remove]_override_cursor() to set the
	middle mouse button move cursor so we get the original cursor back
	after scrolling.

	* app/tools/picmandrawtool.[ch]: added lots of drawing functions
	(picman_draw_tool_draw_rectangle() etc.) which work in image (or
	active drawable) coordinates.

	* app/tools/picmanblendtool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantransformtool.[ch]
	* app/tools/path_tool.[ch]: use the new functions. Removed tons of
	gdk_draw_foo() and gdisplay_transform_foo() calls. Most drawing
	functions look *much* nicer now. Ported some tools to detect
	handle clicks in display coordinates while I was on it, misc
	fixes.

	* app/tools/picmanmovetool.[ch]: derive from PicmanDrawTool instead
	of drawing manually.

2001-11-11  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: oops, this should have been checked in
	with my last commit.

2001-11-11  Manish Singh  <yosh@picman.org>

	* configure.in
	* app/Makefile.am
	* app/plug-in/Makefile.am
	* plug-ins/Makefile.am
	* modules/Makefile.am: fixes to build with automake 1.5 (just hacks
	to get it to work, real fixes to come later)
 
	* app/gui/preferences-dialog.c: unset GValue from tree model when
	we're done with it.

	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmansizeentry.[ch]
	* libpicmanwidgets/picmanwidgets.[ch]
	* plug-ins/common/animationplay.c
	* plug-ins/common/colorify.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/diffraction.c
	* plug-ins/common/film.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gicon.c
	* plug-ins/common/gih.c
	* plug-ins/common/gtm.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/mail.c
	* plug-ins/common/pat.c
	* plug-ins/common/plugindetails.c
	* plug-ins/common/png.c
	* plug-ins/common/ps.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/sinus.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/tileit.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/xbm.c: gtk_widget_set_usize is deprecated. Use
	gtk_widget_set_size_request instead.

	* libpicmanwidgets/picmanunitmenu.[ch]: changed to use GtkTreeView.

2001-11-10  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplay-marching-ants.h
	* app/display/picmandisplay-selection.[ch]: removed...

	* app/display/picmandisplayshell-marching-ants.h
	* app/display/picmandisplayshell-selection.[ch]: ...new names.

	* app/display/picmandisplay.[ch]
	* app/display/picmandisplayshell.[ch]: moved the Selection stuff
	from PicmanDisplay to PicmanDisplayShell.

	Renamed all functions which will stay in PicmanDisplay from
	gdisplay_foo() to picman_display_foo(). Added picman_display_get_ID(),
	cleaned up the idle renderer.

	* app/image_map.c
	* app/plug_in.c
	* app/display/Makefile.am
	* app/display/picmandisplay-foreach.[ch]
	* app/display/picmandisplay-handlers.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-scroll.c
	* app/gui/gui.c
	* app/gui/view-commands.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* tools/pdbgen/pdb.pl: changed accordingly, cleanup.

	* app/pdb/display_cmds.c: regenerated.

2001-11-10  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* user_install.[ch]: removed...

	* gui/Makefile.am
	* gui/user-install-dialog.[ch]: ...added here.

	* gui/file-open-dialog.[ch]: removed file_open_with_display() and
	file_open_with_proc_and_display() here...

	* file/file-open.[ch]: ...and added them here.

	* app_procs.c
	* widgets/picmandnd.c
	* widgets/picmandocumentview.c: changed accordingly.

2001-11-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/qmask.[ch]: removed.

	* app/core/picmanimage.[ch]: added "qmask_changed" signal and
	picman_image_[set|get]_qmask_state().

	* app/display/Makefile.am
	* app/display/picmandisplayshell-qmask.[ch]: put the stuff here.

	* app/display/picmandisplayshell-handlers.[ch]: new files: handlers
	for PicmanImage signals handled by PicmanDisplayShell.

	* app/display/picmandisplay-handlers.c: removed some of them here.
	Don't include any PicmanDisplayShell stuff any more.

	* app/display/picmandisplay.c: no need to update the qmask buttons
	in picman_display_flush_whenever().

	* app/display/picmandisplayshell.c: call picman_display_shell_connect()
	and disconnect().

2001-11-10  Michael Natterer  <mitch@picman.org>

	* app/qmask.c: fixed qmask callbacks to check if the toggle is
	active before performing any action.

	* app/core/core-types.h: added the PicmanCoords type here because it
	will be used by core functions as soon as the painting stuff is
	separated from the painting tools.

	* app/core/picmandrawable-bucket-fill.c: fixed g_return_if_fail()s
	to not disable any useful operation :-) Still didn't figure out
	how I broke display color and pattern dropping :-(

	* app/display/picmandisplayshell.[ch]: added
	picman_display_shell_[un]transform_coords() which work on two
	PicmanCoords pointers.

	* app/display/picmandisplayshell-callbacks.c: use the new functions
	instead of the gdisplay_* ones.

	* app/gui/image-commands.c: PicmanImage emits "disconnect", not
	"destroy".

	* app/tools/tools-types.h
	* app/tools/picmantool.h: removed PicmanCoords here.

	* app/tools/picmanconvolvetool.c: fixed modifier_key() implementation.

	* app/tools/picmancroptool.c: cleanup.

	* app/tools/paint_options.c: don't need a separator in the ink
	tool options.

	* app/tools/picmanrectselecttool.c
	* app/tools/selection_options.[ch]: implemented wish #50352:

	Added "Auto Shrink Selection" and "Sample Merged" toggles to
	the rect_select and ellipse_select tools. Put the "Fixed size"
	widgets in a frame. Removed the separators after the common
	selection tool options because I didn't like them any more
	(feel free to comment ;)

2001-11-09  Michael Natterer  <mitch@picman.org>

	* app/gui/resize-dialog.c: added a "Center" button to the "Offset"
	frame (#51599).

2001-11-09  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanprotocol.[ch]: removed the "palette" PDB type
	again. Incremented protocol version.

	* app/plug_in.c
	* app/pdb/procedural_db.c
	* libpicman/picman.c
	* libpicmanbase/picmanbasetypes.h: changed accordingly.

	* app/pdb/procedural_db_cmds.c
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

2001-11-09  Michael Natterer  <mitch@picman.org>

	* app/undo.c: should set the fs.backing_store TileManager pointer
	to NULL after deleting it. Why the heck didn't this crash
	before...?

	* app/core/Makefile.am
	* app/core/picmandrawable-blend.[ch]: the blend stuff taken from
	the blend tool.

	* app/core/core-types.h: added the blend enums.

	* app/tools/picmanblendtool.[ch]: removed the stuff here.

	* tools/pdbgen/pdb/tools.pdb: changed blend wrapper accordingly.

	* app/pdb/tools_cmds.c: regenerated.

	* tools/pdbgen/Makefile.am: don't scan tools/picmanblendtool.c.

	* tools/pdbgen/enums.pl: regenerated.

	* app/tools/picmanbucketfilltool.c: fixed crash caused by my last
	change.

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: removed lots of uglyness by
	using GtkImages for the qmask and navigation buttons. Don't realize
	anything before the shell is shown. Connect the realize
	callback and do stuff there. Don't call the realize callback
	from picman_display_shell_canvas_events() any more.

	* pixmaps/navbutton.xpm
	* pixmaps/qmasknosel.xpm
	* pixmaps/qmasksel.xpm: removed.

	* themes/Default/Makefile.am
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-menu-navigation.png
	* themes/Default/images/stock-menu-qmask-off.png
	* themes/Default/images/stock-menu-qmask-on.png: new PNGs instead.

	* libpicmanwidgets/picmanstock.[ch]: register them as stock icons.

2001-11-09  Sven Neumann  <sven@picman.org>

	* app/gui/file-open-dialog.c: merged fix for bug #63880 from stable
	branch and fixed a wrong signal callback signature.
	
	* plug-ins/imagemap/imap_main.c: merged fix for bug #64075 from stable
	branch.

	* plug-ins/common/gauss_iir.c
	* plug-ins/common/gauss_rle.c: merged fix for bug #57853 from stable
	branch.

	* plug-ins/Lighting/lighting_ui.c: s/gdk_image_unref/g_object_unref/

2001-11-08  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: build display/ before tools/.

	* app/devices.c: devices_check_change(): added all events
	which have a GdkDevice pointer.

	* app/picmanprogress.c: include "display-types.h" instead of
	"core-types.h".

	* app/core/Makefile.am
	* app/core/picmandrawable-bucket-fill.[ch]: new files: the bucket_fill
	stuff taken from tools/picmanbucketfilltool.[ch].

	* app/core/core-types.h: added "BucketFillMode".

	* app/core/picmanimage-mask-select.[ch]: cleanup.

	* app/core/picmanmarshal.list: added more marshallers for PicmanTool's
	new signal signatures.

	* app/core/picmanmarshal.[ch]: regenerated.

	* app/display/Makefile.am
	* app/display/picmandisplayshell-dnd.[ch]
	* app/display/picmandisplayshell-layer-select.[ch]: new files: the
	canvas drop callbacks from picmandisplayshell-callbacks.[ch] and
	the stuff formerly knows as gui/layer-select.[ch].

	* app/display/picmandisplay.h: don't include "gui/gui-types.h".

	* app/display/gximage.c: include "display-types.h".

	* app/display/picmandisplay-foreach.c
	* app/display/picmandisplayshell.[ch]: call gdsplay_delete(), don't
	destroy the shell widget.

	* app/gui/Makefile.am
	* app/gui/layer-select.[ch]: removed.

	* app/gui/gradients-commands.c: fixed "Save as POV" fprintf()s.

	* app/gui/preferences-dialog.c: removed the layer_select stuff
	because it is useless with the new preview system.

	* app/gui/tool-options-dialog.c: send the correct data to the
	close_callback.

	* app/gui/tools-commands.c: changed to follow the new
	picman_tool_initialize() semantics (see below).

	Tool & canvas event handling chainsawing:

	* app/tools/tools-types.h: new struct PicmanCoords which contains
	x, y, pressure, tilt etc.

	* app/display/picmandisplayshell-callbacks.[ch]: added utility
	functions which transparently retreive the current event's
	PicmanCoords or take it from the device directly if the event has
	none. Pass PicmanCoords _in_image_coordinates_ to all tool
	functions.

	Most important: don't pass GdkEvents and display coordinates to
	tools any more.

	* app/tools/picmantool.[ch]: changed virtual functions to take
	PicmanCoords, time and state separately instead of GdkEvents.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.[ch]
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.[ch]
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.[ch]
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.[ch]
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanselectiontool.[ch]
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.[ch]
	* app/tools/path_tool.[ch]
	* app/tools/selection_options.c: tons and tons of changes:

	- changed to use the new virtual function parameters.
	- removed zillions of gdisplay_untransform_coords().
	- get the active drawable's offsets manually in many cases.
	  (questionable, but IMHO ok because it's obvious and not simply a
	  "TRUE" passed to some function)
	- reordered some functions to be consistent across tools.
	- some tools had to be changed to work on image coords, not
	  display ones (esp. crop).
	- fixed strange rotate tool behaviour which should be backported
	  to stable.
	- some stuff i came across.
	- indentation and other paranoia.
	- rounding of coordinated may be broken in some tools.
	- new bugs guaranteed.

	* app/tools/tool_manager.[ch]: new semantic of
	tool_manager_initialize_active() (looked at the places where it
	was used from and put common code together). Should be a bit
	better now :)

	* app/tools/picmanblendtool.c
	* app/tools/transform_options.c: use the new GTK+ feature that a
	widget (toggle button) can be a frame's title for this tools' tool
	options.

	* app/widgets/widgets-types.h: stuff.

	* themes/Default/gtkrc: s/GtkDialog/PicmanDialog/.

	* tools/pdbgen/Makefile.am: don't scan tools/picmanbucketfilltool.h
	any more.

	* tools/pdbgen/enums.pl: regenerated.

	* tools/pdbgen/pdb/tools.pdb: changed bucket_fill wrapper.

	* app/pdb/tools_cmds.c: regenerated.

2001-11-05  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/*.c: ported fixes from stable branch (mostly 
	missing includes of config.h),

	* plug-ins/picmanressionist/orientmap.c: removed commented out code
	that continued to show up when grepping for deprecated GTK+ code.

	* tools/pdbgen/pdb/procedural_db.pdb: removed unneeded inclusion
	of config.h (it gets added automatically).

2001-11-02  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scroll.c: stop synthesizing expose
	events but use gdk_window_invalidate_rect() and
	gdk_window_process_updates() (both with "update_children == FALSE"
	because the canvas has no children).

	* app/tools/picmanmagnifytool.c: nothing.

2001-11-01  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplay-callbacks.[ch]
	* app/display/picmandisplay-render.[ch]
	* app/display/picmandisplay-scale.[ch]
	* app/display/picmandisplay-scroll.[ch]: removed and added as
	picmandisplayshell-foo.[ch] because they are all methods of the
	shell.

	* app/display/picmandisplay.[ch]
	* app/display/picmandisplayshell.[ch]: moved the "offset" and "size"
	variables from PicmanDisplay to PicmanDisplayShell. PicmanDisplay
	should know nothing about screen coordinates.

	The gdisplay_[un]transform_foo() methods are still part of
	PicmanDisplay but will be moved to PicmanDisplayShell as soon as the
	tools' vitrual functions speak in image coordinates instead of
	GdkEvents.

	* app/display/picmandisplayshell-callbacks.[ch]: prefixed all
	functions with picman_display_shell_*. Moved some stuff to a
	"realize" callback File still has to be renamed.

	* app/display/picmandisplay-foreach.[ch]: removed
	gdisplays_shrink_wrap().

	* app/gui/menus.c
	* app/gui/view-commands.[ch]
	* app/display/picmandisplayshell-scale.[ch]: implemented "Zoom to
	Fit Window" function (#57670).

	* app/nav_window.c
	* app/display/picmandisplay-handlers.c
	* app/display/picmandisplayshell-render.[ch]
	* app/display/picmandisplayshell-scale.[ch]
	* app/display/picmandisplayshell-scroll.[ch]
	* app/gui/colormap-dialog.c
	* app/gui/gui.c
	* app/gui/preferences-dialog.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c
	* app/widgets/picmanpreview.c: changed according to variable
	and filename changes.

	* app/tools/tool_manager.c: tool_manager_select_tool(): send the
	active tool a "HALT" command before selecting the new one. Fixes
	stale tool dialogs which were there because some other hack was
	removed (This is IMHO the right place to shut down the active
	tool).

	* app/tools/picmancroptool.c: don't shrink wrap after cropping but
	let picmanrc.allow_resize_windows decide.

	* app/tools/picmanselectiontool.c: gimage_mask_value() takes image,
	not screen coordinates. A good example of how braindead it is to
	pass GdkEvents to tools :-) Fixes incorrect cursor and oper
	update of the selection tools.

	* app/tools/picmantransformtool.c
	* app/undo.c: removed (#if 0 for now) some strange code which did
	manual exposing of PicmanDisplayShell areas. This was definitely a
	hack and should not be there given the image emits correct
	"update" signals.

2001-11-01 DindinX <odin@mandrakesoft.com>

	* plug-ins/common/bz2.c: fix a little typo in a comment

2001-10-31  Michael Natterer  <mitch@picman.org>

	Chopped up the display stuff (beware: unfinished)...

	The plan is that PicmanDisplay is the object which collects
	updates from the image, compresses them and waits for the PICMAN
	to be idle to actually paint them. It should be a non-GUI object
	which is the model for the actual widget to connect to.

	PicmanDisplayShell has all the widgets and handles painting and
	exposing of the result. Nobody should actually be required to
	update or look at it as it should be a view on the PicmanDisplay
	object.

	Much stuff is still in the wrong place and the functions don't
	follow their files' filename namespace any more. More to come...

	* app/display/Makefile.am
	* app/display/picmandisplay-ops.[ch]: removed. It's functions didn't
	belong together anyway.

	* app/display/picmandisplay-area.[ch]: new files: the PicmanArea
	functions.

	* app/display/picmandisplay-handlers.[ch]: new files: signal
	handlers for PicmanImage signals. Mostly from gui/gui.c.

	* app/display/picmandisplay.[ch]: removed all widgets and other
	GUI stuff. There is still much undecided here...

	* app/display/picmandisplayshell.[ch]: actually use the object and
	filled it with all the stuff from PicmanDisplay.

	* app/display/picmandisplay-callbacks.[ch]
	* app/display/picmandisplay-foreach.[ch]
	* app/display/picmandisplay-render.c
	* app/display/picmandisplay-scale.[ch]
	* app/display/picmandisplay-scroll.[ch]
	* app/display/picmandisplay-selection.c: changed accordingly.

	* app/core/picman.[ch]: return a PicmanObject from
	picman_create_display() so it can be used as single GUI independent
	point to create displays, require the initial scale as parameter.

	* app/core/picmancontext.c: changed the ugly EEKWrapper according to
	the PicmanDisplay structure changes. Bugfix: set the image to NULL
	in picman_context_display_destroyed().

	* app/core/picmanedit.c
	* app/core/picmanimage-new.c: changed picman_create_display() calls
	accordingly.

	* app/core/picmanimage-convert.c: invalidate the layer & image
	previews here, not in the caller.

	* app/core/picmanimage-crop.c: update the whole image after cropping.

	* app/core/picmanimage.[ch]: added picman_image_find_guide(),
	picman_image_snap_point() and picman_image_snap_rectangle(). Added
	"resolution_changed" and "unit_changed" signals and corresp.
	public convenience functions to emit them.

	* app/core/picmanlayer.c: emit the image's "alpha_changed" signal
	when adding alpha to the bottom (and only) layer of the image.

	* app/picmanprogress.c
	* app/image_map.c
	* app/nav_window.c
	* app/qmask.c
	* app/undo.c
	* app/user_install.c: changed accordingly.

	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/preferences-dialog.c
	* app/gui/toolbox.c
	* app/gui/view-commands.c: ditto.

	* app/gui/gui.[ch]: removed most picman->images handlers as the
	displays connect to them themselves now. chaged gui_display_new()
	according to the picman_create_display() changes.
	Added gui_get_screen_resolution().

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantool.c
	* app/tools/picmantransformtool.c
	* app/tools/xinput_airbrush.c: lots of changes because PicmanDisplay
	has become two objects. Lots of gdisp->shell casting uglyness
	added. This is fine because exactly these parts will have to go
	away.

	(PicmanDisplay will provide methods for XOR drawing upon the display
	in image coordinates without the need to transform coordinates all
	the time. Also the tools shouldn't see GdkEvents but get more
	useful virtual functions which speak in image coordinates too).

	* app/widgets/picmancomponentlistitem.c: removed a now useless image
	update.

	* tools/pdbgen/pdb/display.pdb: use picman_create_display().

	* app/pdb/display_cmds.c: regenerated.

2001-10-30  Simon Budig   <simon@picman.org>

	* app/pdb/tools_cmds.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanerasertool.h
	* tools/pdbgen/pdb/tools.pdb

	Added a "color erase" feature to the eraser. This is ported from
	the colortoalpha plugin and is utterly cool.

	The "Color Erase" Option should be disabled when the drawable
	has no alpha channel, however, I have no idea how to do this.

2001-10-29  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c (temp_buf_to_gray): rewrote so gcc-3.0 doesn't 
	complain.

	* app/widgets/picmanfontselection-dialog.c: use g_ascii_strcasecmp().
	
	* libpicman/picmanintl.h
	* libpicman/stdplugins-intl.h
	* plug-ins/script-fu/script-fu-intl.h: don't call gtk_set_locale()
	since gtk_init() does it for us now. Don't set LC_NUMERIC to "C".
	INIT_I18N_UI() is the same as INIT_I18N_UI() now.

	* app/devices.c
	* app/picmanrc.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmangradient.c
	* app/gui/color-notebook.c
	* app/gui/gradients-commands.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/presets.c
	* plug-ins/ifscompose/ifscompose_storage.c: use g_ascii_formatd() and
	g_ascii_strtod() to serialize and deserialize floats. These functions 
	are locale-independent. There are probably more places that need to be
	fixed in this fashion.

	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/script-fu/script-fu.c: s/INIT_I18N_UI/INIT_I18N/

	* tools/picman-remote.c
	* app/widgets/picmanwidgets-utils.c
	* app/core/picmanimage-contiguous-region.c
	* app/paint-funcs/paint-funcs-indexeda.c
	* app/paint-funcs/paint-funcs.c
	* app/tools/picmanpathtool.c
	* app/tools/path_tool.c
	* modules/colorsel_triangle.c
	* plug-ins/common/mpeg.c
	* plug-ins/imagemap/imap_csim_parse.c: cleanups
	
2001-10-29  Michael Natterer  <mitch@picman.org>

	Cleanup weekend...

	* app/app_procs.c: pass "no_interface" to picman_new().

	* app/core/picman.[ch]: added "gboolean no_interface" and the
	load_procs and save_procs GSLists.

	* app/core/picmantoolinfo.[ch]: added a "Picman" pointer to the
	PicmanToolInfo object so more functions find their context without
	accessing the global "the_picman" variable.

	* app/display/display-types.h: removed the GDisplay -> PicmanDisplay
	typedef.

	* app/display/picmandisplay.c: look at picman->no_interface, don't
	include "appenv.h".

	* app/file/file-open.[ch]
	* app/file/file-save.[ch]: don't use "the_picman" any more. Instead,
	pass around lots of "Picman" pointers. Removed the global load_procs
	and save_procs variables here. Use access() to find out whether a
	file is readable/writable, removed the manual voodoo and it's
	Win32 wrappers. Added an optional (can be NULL) "PlunInProcDef"
	parameter to file_save(), removed file_save_with_proc().

	* app/gui/menus.c: Use the unused "gpointer data" parameter of the
	GtkItemFactory callbacks to pass a "Picman" pointer to all of them.
	This reduces the usage of the global "the_picman" hack to zero
	in app/gui/... yeah.

	* app/gui/channels-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/palettes-commands.c
	* app/gui/select-commands.c
	* app/gui/test-commands.c
	* app/gui/tools-commands.c
	* app/gui/view-commands.c: use the passed "Picman" pointer.

	* app/gui/color-area.[ch]
	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-new-dialog.[ch]
	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]
	* app/gui/gui.c
	* app/gui/info-window.[ch]
	* app/gui/module-browser.[ch]
	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.[ch]
	* app/gui/paths-dialog.c
	* app/gui/preferences-dialog.[ch]
	* app/gui/resize-dialog.[ch]
	* app/gui/tool-options-dialog.[ch]
	* app/gui/toolbox.c: pass around lots more "Picman" and
	"PicmanContext" pointers and don't use "the_picman" any more.

	* app/tools/picmantool.h: added a pointer to the corresponding
	PicmanToolInfo object (which in turn has a pointer to a Picman).

	* app/tools/tool_manager.[ch]: set the pointer after creating the
	tool object. Removed tool_manager_get_info_by_tool() as there is a
	tool->tool_info pointer now.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpathtool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/path_tool.c
	* app/tools/xinput_airbrush.c: s/GDisplay/PicmanDisplay/g.
	Use tool->tool_info and tool_info->picman in some places to get
	rid of using "the_picman".

	Removing the remaining ones involves changing the tool options
	system and is scheduled next...

	* app/widgets/picmandnd.c
	* app/widgets/picmandocumentview.c: pass a "Picman" pointer to all
	file_open_*() functions.

	* app/gdisplay_color.[ch]
	* app/gdisplay_color_ui.[ch]
	* app/image_map.[ch]
	* app/nav_window.[ch]
	* app/path.c
	* app/path_bezier.c
	* app/path_transform.h
	* app/qmask.[ch]: s/GDisplay/PicmanDisplay/g

	* tools/pdbgen/pdb/fileops.pdb: load_procs and save_procs are
	members of the "Picman" object now.

	* tools/pdbgen/pdb/plug_in.pdb: use picman->no_interface, don't
	include "appenv.h".

	* app/pdb/fileops_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2001-10-29  Sven Neumann  <sven@picman.org>

	* plug-ins/webbrowser/web-browser.scm: updated links

	* tools/pdbgen/lib.pl: cosmetic change (if (!x) -> unless (x)).
	
2001-10-28  Hans Breuer  <hans@breuer.org>

	* config.h.win32 : define HAVE_DIRENT_H, it's from build/win32/dirent

	* app/*/makefile.msc : updated
	* app/file/makefile.msc app/display/makefile.msc : new files

	* app/user_install.c : make the G_OS_WIN32 part compile again 
	(fn -> filename)

	* app/core/picmantoolinfo.c (picman_tool_info_init) : cosmetic change,
	make implementation signature static like the local prototype

	* app/pdb/gradients_cmds.c app/pdb/palette_cmds.c : include <string.h>
	for strlen () / strcmp () by ...
	* tools/pdbgen/pdb/gradients.pdb tools/pdbgen/pdb/palette.pdb :
	... changing the perl source here

	* app/widgets/picmandocumentview.c : #include <string.h>

	* libpicman/makefile.msc : 
	* libpicmanwidgets/picmanwidgets.def : updated

	* plug-ins/makefile.msc : reflect the fact that DIRENT functions
	are removed from glib. Also define the questionable GETTEXT_PACKAGE
	and LOCALEDIR which are required to compile, not adapted to NLS
	support for win32 yet
  
2001-10-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/nlfilt.c
	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gap/gap_navigator_dialog.c: removed code that sets the
	colormap and gamma value of a GtkPreview. We don't need to do this
	since GtkPreview uses GdkRGB.

2001-10-28  Sven Neumann  <sven@picman.org>

	* configure.in: require GLib-1.3.10, GTK+-1.3.10 and Pango-0.21

	* RELEASE-TO-CVS.patch
	* libpicmanbase/picmanparasiteio.c
	* libpicmanwidgets/picmanstock.c
	* plug-ins/ifscompose/ifscompose_storage.c: applied the patch and
	emptied the patch file.
 	
	* libpicman/picmangradientmenu.c: corrected order of parameters in call
	to picman_gradients_get_gradient_data().

	* tools/pdbgen/pdb/palette.pdb: I think this is how Nathan wanted it
	to be.

	* app/pdb/palette_cmds.c
	* libpicman/picmanpalette_pdb.[ch]: regenerated.

2001-10-27  Nathan Summers  <rock@picman.org>

	* picmanpalette_pdb.c: the autogenerated code for
	  picman_palette_get_entry won't compile.  Temporary kludge so that it
	  will compile and work correctly.

2001-10-27  Nathan Summers  <rock@picman.org>

	* app/plug_in.c
	* libpicman/picman.c
	* libpicmanbase/picmanbasetypes.h
	* libpicmanbase/picmanprotocol.c
	* libpicmanbase/picmanprotocol.h
	* tools/pdbgen/pdb/palette.pdb: added preliminary pdb support to
        manipulate palettes.  Incremented plugin interface version number.

        * app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* app/pdb/procedural_db.c
	* app/pdb/procedural_db_cmds.c
	* libpicman/picmanpalette_pdb.c
	* libpicman/picmanpalette_pdb.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated

2001-10-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushgenerated.h
	* app/core/picmanbrushpipe.h
	* app/core/picmanbuffer.h
	* app/core/picmandatafactory.h
	* app/core/picmandrawable.h
	* app/core/picmangradient.h
	* app/core/picmanimage.h: added some missing FOO_GET_CLASS() macros.

2001-10-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/gradient_select.pdb: removed
	gradients_get_gradient_data() here...

	* tools/pdbgen/pdb/gradients.pdb: ...and added it here.

	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmangradients_pdb.[ch]
	* libpicman/picmangradientselect_pdb.[ch]: regenerated.

	* app/core/picmangradient.h: added PICMAN_GRADIENT_DEFAULT_SAMPLE_SIZE
	here...

	* app/gui/gradient-select.h: ...removed it here.

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmangradientselect.[ch]: removed. We don't wrap
	_gradients_get_gradient_data() with gradients_get_gradient_data()
	any more but call the PDB wrapper directly.

	API CHANGE: Arguments 2 and 3 are swapped now!

	* plug-ins/FractalExplorer/Dialogs.c: changed accordingly.

2001-10-25  Michael Natterer  <mitch@picman.org>

	* configure.in: generate app/file/Makefile

	* app/Makefile.am
	* app/file-open.[ch]
	* app/file-save.[ch]
	* app/file-utils.[ch]: removed...

	* app/file/Makefile.am
	* app/file/file-open.[ch]
	* app/file/file-save.[ch]
	* app/file/file-utils.[ch]: ...and added here.

	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* tools/pdbgen/pdb/fileops.pdb: changed includes accordingly.

	* app/app_procs.[ch]: removed app_exit_finish() and
	app_exit_finish_done() from the public API, call gtk_main() here,
	pass "no_data" to picman_new() and "restore_session" to
	gui_restore().

	* app/main.c: removed global variable "double_speed", don't
	call gtk_main() in main.c. Added some missing log domains.

	* app/appenv.h: removed "double_speed".

	* app/core/picman.[ch]: added "gboolean no_data" property which
	must be passed to picman_new().

	* app/display/picmandisplay-foreach.[ch]: added gdisplays_set_busy()
	and gdisplays_unset_busy().

	* app/gui/about-dialog.c: don't include "appenv.h", declare
	"double_speed" extern.

	* app/gui/brush-select.[ch]
	* app/gui/gradient-select.[ch]
	* app/gui/palette-select.[ch]
	* app/gui/pattern-select.[ch]: made the list of dialogs and the
	global selection dialogs private. Added functions which get a
	dialog by PDB callback_name. Pass a "Picman" and the callback_name
	to the constructors. Don't include "app_procs.h" for "the_picman"
	and "appenv.h" for "no_data" any more. Use the passed "Picman"
	instead and look at picman->no_data.

	* app/gui/toolbox.[ch]: pass a "Picman" to the constructor.

	* app/gui/gui.[ch]: use the new gdisplays_[un]set_busy() functions,
	use the passed "Picman" all over the place, don't include
	"appenv.h" and "app_procs.h". gui_really_quit_dialog() takes
	a "quit_func" callback now and calls it instead of calling
	app_exit_finish() (which is now private) directly.

	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/palette-import-dialog.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: changed accordingly.

	* app/pdb/brush_select_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/pattern_select_cmds.c: regenerated.

2001-10-24  Sven Neumann  <sven@picman.org>

	* plug-ins/perl/examples/glowing_steel: merged Raphaels patch for 
	bug #56598 from the stable branch.

	* libpicman/picmanexport.c: merged Raphaels patch for bug #51114 from the 
	stable branch.
	
	* plug-ins/common/grid.c: merged the fix for indexed images from the
	stable branch.

2001-10-24  Michael Natterer  <mitch@picman.org>

	* app/file-open.c
	* app/file-utils.c
	* app/picmanrc.c
	* app/plug_in.c
	* app/user_install.c
	* app/base/base.c
	* app/base/temp-buf.c
	* app/core/picmandata.c
	* app/core/picmandatafiles.c
	* app/core/picmanimagefile.c
	* app/gui/about-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/splash.c
	* app/gui/tips-dialog.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* libpicmanbase/picmanenv.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* tools/pdbgen/pdb/fileops.pdb: use g_build_filename() all over
	the place instead of g_strconcat() and friends together with
	G_DIR_SEPARATOR_S. Also removed all attempts to manually detect
	double dir separators. LibPicmanBase's searchpath utility functions
	don't append a G_DIR_SEPARATOR_S to all paths any more.

	* app/pdb/fileops_cmds.c: regenerated.

2001-10-24  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbutton.[ch]: added
	picman_button_extended_clicked() which emits the resp. signal.

	* app/gui/menus.[ch]: added new item factories "<Buffers>" and
	"<Documents>".

	* app/gui/Makefile.am
	* app/gui/buffers-commands.[ch]
	* app/gui/documents-commands.[ch]: new files for the callbacks.

	* app/gui/dialogs-constructors.c: use them.

	* app/gui/file-open-dialog.c: set the title to "Open Image",
	not "Load Image".

2001-10-23  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: pass a "Picman" to gui_libs_init(), initialize
	the GUI before initializing the plug-ins.

	* app/gui/menus.[ch]: removed menus_last_opened_add() and connect
	to picman->documents' "add", "remove" and "reorder" signals to
	auto-update the "last opened" menu entries. Moved all public
	functions to the top of the file. Removed global variable
	"last_opened_raw_filenames".

	* app/gui/gui.[ch]: removed "last opened" fiddling here, moved
	menu init functions which need to be called after plug-in query
	to gui_restore().

	* app/gui/session.[ch]: added "Picman" parameters to all public
	functions.

	* app/file-save.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c: changed accordingly.

2001-10-23  Sven Neumann  <sven@picman.org>

	* TODO.xml: added an entry for handling layers with masks with the 
	Transform Tool.

	* app/gui/tips_dialog.c: make Next and Previous buttons insensitive 
	if no tips could be loaded (as done in the stable branch).
	
	* plug-ins/common/mblur.c (mblur_linear): merged fix for bug #62640
	from stable branch.

	* plug-ins/gap/gap_lib.c: merged fix for bug #61677 from stable branch.

2001-10-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/docindex.[ch]: removed.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmandocumentview.[ch]: new widget as replacement.

	* app/core/picmancontext.[ch]: added context->imagefile property.

	* app/app_procs.c
	* app/file-save.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/test-commands.c: changed accordingly.

	* app/widgets/picmancontainerview.[ch]: added "gboolean reorderable"
	property which needs to be set by subclasses.

	* app/widgets/picmandrawablelistview.c: removed the "insert_item"
	implementation which was used to make the items reorderable.

	* app/widgets/picmancontainerlistview.[ch]: make the list items
	reorderable depending on view->reorderable.

	* app/widgets/picmanbufferview.c: made it reorderable.

	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmandatafactoryview.c: changed accordingly.

2001-10-22  Michael Natterer  <mitch@picman.org>

	General cleanup of the selection tools and their PDB wrappers:

	* app/core/Makefile.am
	* app/core/picmanimage-contiguous-region.[ch]
	* app/core/picmanimage-mask-select.[ch]: new files providing a clean,
	uniform API for the selection functionalities. Changed order of
	parameters to be consistent, removed code duplication.

	The region returned by the "by_color" function is not really
	contiguous but the API is so similar to "by_seed" and it's used
	in the same context so it's fair enough to put them together.

	Also, I'm not sure if the two is_pixel_sufficiently_different()
	I've optimized away were meant to do *exactly* the same. Added
	a comment there to remember the former difference.

	* app/core/picmanchannel.[ch] (picman_channel_feather): removed the
	"output" channel parameter and made it optionally push an undo
	(like the other channel operations do).

	* app/core/picmanimage-mask.c: call picman_channel_feather() with
	"push_undo == TRUE", removed some useless comments.

	* app/tools/picmanbycolorselecttool.[ch]
	* app/tools/picmanellipseselecttool.[ch]
	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmanfuzzyselecttool.[ch]
	* app/tools/picmanrectselecttool.[ch]: removed all the actual
	selection functionality and call the new picman_image_mask_select_*()
	and picman_image_contiguous_region_*() functions instead.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmaniscissorstool.c: use new function
	picman_image_mask_select_channel() instead of doing the same manually.

	* app/tools/picmanbucketfilltool.c: find_contiguous_region() ->
	picman_image_contiguous_region_by_seed().

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl
	* tools/pdbgen/pdb/selection_tools.pdb: added new group "Selection
	Tools" which depends only on "core/" stuff (not on "tools/" any
	more, brrrr).

	* tools/pdbgen/pdb/text_tool.pdb: don't include "appenv.h"

	* tools/pdbgen/pdb/tools.pdb: removed the selection tools.

	* app/pdb/Makefile.am
	* app/pdb/selection_tools_cmds.c: new file.

	* app/pdb/internal_procs.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c: regenerated.

	* libpicman/Makefile.am
	* libpicman/picman_pdb.h
	* libpicman/picmanselectiontools_pdb.[ch]: new files.

	* libpicman/picmantools_pdb.[ch]: regenerated

	Misc cleanups:

	* app/app_procs.c: call splash_create() with "no_splash_image"
	as parameter.

	* app/display/picmandisplay-render.c
	* app/display/gximage.c: don't include "appenv.h".

	* app/gui/gui.c: call session_restore() only if "restore_session"
	is TRUE.

	* app/gui/session.c: don't "if(restore_session)" here and don't
	include "appenv.h"

	* app/gui/splash.[ch]: added "gboolean show_image" parameter to
	splash_create(), don't include "appenv.h"

	* app/tools/picmanpainttool.[ch]: added a "PicmanGradient" parameter
	to picman_paint_tool_get_color_from_gradient().

	* app/tools/picmanpaintbrushtool.c: pass the gradient.

	* app/tools/picmanselectiontool.c
	* app/tools/picmantransformtool.c
	* app/tools/tool_manager.c: s/GDisplay/PicmanDisplay/.

	* app/widgets/picmancontainergridview.[ch]: removed the "white_style"
	class variable and don't fiddle around with colors and styles...

	* themes/Default/gtkrc: ...do the same here with a simple rc style.

2001-10-19  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: link the app in a different order as some init
	functions are called from core/picman.c instead of app_procs.c now.

	* app/app_procs.[ch]: made app_init_update_status() private and
	pass it as callback to various init functions.

	* app/plug_in.[ch]: plug_in_init() take "picman" and "status_callback"
	parameters.

	* app/undo.c: use "gimage->picman" instead of "the_picman", don't
	include "app_procs.h".

	* app/core/core-types.h: added "PicmanInitStatusFunc" typedef.

	* app/core/picman.[ch]: picman_initialize() and picman_restore() now
	take a "status_callback" as parameter. Don't include "app_procs.h".

	* app/core/picmanmodules.c: putting the modules in a strong
	container was a bad idea because it may be impossible to finalize
	a PicmanModuleInfo object belonging to a stalled module.

	* app/gui/color-area.c: use G_N_ELEMENTS().

	* app/gui/session.c: don't call app_init_update_status() and don't
	include "app_procs.h" because this happens after the splash is
	hidden.

	* tools/pdbgen/app.pl
	* app/pdb/internal_procs.[ch]: pass a "status_callback" to
	internal_procs_init(), don't include "app_procs.h".

	* plug-ins/Makefile.am: build gfig, picmanressionist and imagemap
	again.

	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_ui.c: s/gdk_image_unref/g_object_unref/

	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/picmanressionist/ppmtool.[ch]
	* plug-ins/picmanressionist/presets.c
	* plug-ins/imagemap/imap_browse.[ch]
	* plug-ins/imagemap/imap_csim.y
	* plug-ins/imagemap/imap_edit_area_info.c
	* plug-ins/imagemap/imap_file.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_polygon.c
	* plug-ins/imagemap/imap_popup.c
	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/imagemap/imap_taglist.c
	* plug-ins/imagemap/imap_tools.c: ported to current GLib/Gtk+.

	* plug-ins/gap/gap_arr_dialog.c
	* plug-ins/gap/gap_decode_xanim.c
	* plug-ins/gap/gap_filter_foreach.c
	* plug-ins/gap/gap_filter_main.c
	* plug-ins/gap/gap_frontends_main.c
	* plug-ins/gap/gap_lib.c
	* plug-ins/gap/gap_main.c
	* plug-ins/gap/gap_mod_layer.c
	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gap/resize.c: half-way fixed this one too but I'm not
	willing to fix tons of duplicated and deprecated app/ code...

2001-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/common/illusion.c: merged fixes for missing PDB parameters
	from stable branch.

2001-10-18  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/module_db.[ch]: removed.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanmoduleinfo.[ch]
	* app/core/picmanmodules.[ch]: new files containing the module info
	object and the module list handling code.

	* app/gui/Makefile.am
	* app/gui/module-browser.[ch]: new files containing the GUI.

	* app/xcf/xcf.[ch]: pass a "Picman" pointer to xcf_exit().

	* app/core/picman.[ch]: handle modules and xcf init/exit here too.

	* app/app_procs.c: don't touch the modules and xcf stuff any more.

	* app/gui/dialogs-constructors.c: changed accordingly.

2001-10-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.[ch]: added properties for "children_type"
	and "policy". Ref/unref the "children_type" class so we can do
	signal lookups and use other introspection features without an
	existing instance of "children_type".

	The new properties are G_PARAM_CONSTRUCT_ONLY and *MUST* be passed
	to g_object_new() to ref/unref children_type's class correctly.

	* app/core/picmandatalist.c
	* app/core/picmanlist.c: pass them as construct properties.

	* app/core/picman.c: no need to manually ref classes any more.

2001-10-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanchannellistview.c: added a handler for PicmanImage's
	"alpha_changed" signal (does nothing yet).

	* app/widgets/[lots of files]: somehow my last perl torturing
	removed my email address from the copyright notice. Another perl
	hack brought it back now :)

2001-10-16  Michael Natterer  <mitch@picman.org>

	* app/picmanprogress.[ch]
	* app/undo.c: s/GDisplay/PicmanDisplay/

	* app/plug_in.[ch]: removed unused boolean "destroy" field of
	the PlugIn struct.

	* app/core/picmanedit.c: don't include "app_procs.h"

	* app/display/picmandisplay-callbacks.c: moved the "grab_and_scroll"
	stuff from picmandisplay-scroll.* here (less complicated and easier
	to cleanup...)

	* app/display/picmandisplay-scroll.[ch]: removed here.

	* app/display/picmandisplay-render.[ch]
	* app/display/picmandisplay-selection.[ch]
	* app/display/picmandisplayshell.c: s/GDisplay/PicmanDisplay/g

	* app/display/picmandisplay.[ch]: ditto, removed gdisplay_active()
	which was just a wrapper around
	"picman_context_get_display (picman_get_user_context (the_picman))"
	(which is more to type but makes the use of the global
	"the_picman" variable more obvious).

	* app/gui/color-area.h
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/file-dialog-utils.c
	* app/gui/image-commands.c
	* app/gui/info-window.h
	* app/gui/paths-dialog.h
	* app/gui/select-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/tools-commands.c
	* app/gui/view-commands.c: s/GDisplay/PicmanDisplay/, gdisplay_active()
	removal, include "app_procs.h" for "the_picman".

	* app/tools/picmanbezierselecttool.h
	* app/tools/picmanbrightnesscontrasttool.[ch]
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.[ch]
	* app/tools/picmancurvestool.[ch]
	* app/tools/picmaneditselectiontool.h
	* app/tools/picmanhistogramtool.[ch]
	* app/tools/picmanhuesaturationtool.[ch]
	* app/tools/picmanlevelstool.[ch]
	* app/tools/picmanmovetool.h
	* app/tools/picmanperspectivetool.h
	* app/tools/picmanposterizetool.[ch]
	* app/tools/picmanrotatetool.h
	* app/tools/picmanscaletool.h
	* app/tools/picmansheartool.h
	* app/tools/picmantexttool.h
	* app/tools/picmanthresholdtool.[ch]
	* app/tools/picmantool.[ch]
	* app/tools/picmantransformtool.h
	* app/tools/tool_manager.[ch]: lots of s/GDisplay/PicmanDisplay/, made
	all *_dialog_hide() functions private, cleanup.

	* app/widgets/*: removed GtkType and gtk_type_* stuff entirely and
	use GObject functions, removed lots of empty "destroy" methods and
	use more type checking class cast macros instead of casting
	directly.

	* app/widgets/picmancontainermenu.c: fixed item insert order.

	* app/widgets/picmanhistogramview.[ch]: cleaned up and renamed all
	functions.

	* app/widgets/picmanwidgets-utils.[ch]: removed picman_dialog_hide() as
	Gtk+ does the right thing (TM) now.

	* tools/pdbgen/pdb/color.pdb: implemented "histogram" without
	digging into tools/ and widgets/ (needs to be done for all
	color PDB functions).

	* tools/pdbgen/pdb/picmanrc.pdb: no need to use "the_picman" in a PDB
	function as a "Picman" pointer is passed to them all.

	* tools/pdbgen/pdb/image.pdb: don't include "app_procs.h"

	* app/pdb/color_cmds.c
	* app/pdb/picmanrc_cmds.c
	* app/pdb/image_cmds.c: regenerated.

	* app/pdb/procedural_db.c: don't include "app_procs.h"

2001-10-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sel_gauss.c: merged fix for bug #62433 from stable
	branch. plug-ins/common/colortoalpha.c already had the problem fixed.

2001-10-13  Michael Natterer  <mitch@picman.org>

	* RELEASE-TO-CVS.patch: gdk_pixbuf_new_from_stream -> _from_inline

	* app/display/Makefile.am
	* app/display/picmandisplay-foreach.[ch]: new files for functions
	operating on all displays (will go away as soon as the display
	behaves like a proper view which doesn't need to be updated
	explicitly).

	* app/display/picmandisplay-callbacks.c
	* app/display/picmandisplay-scale.[ch]
	* app/display/picmandisplay-scroll.[ch]
	* app/display/picmandisplay.[ch]: "scale" and "scroll" namespace
	cleanup, moved bounds_checking() to picmandisplay-scroll.[ch], lots
	of unfinished, intermediate stuff.

	* app/display/picmandisplayshell.[ch]: added some GObject framework
	for the PicmanDisplayShell object (not used yet).

	* app/app_procs.c
	* app/docindex.c
	* app/image_map.c
	* app/nav_window.c
	* app/path.c
	* app/qmask.c
	* app/undo.c
	* app/gui/channels-commands.c
	* app/gui/convert-dialog.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/layer-select.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/paths-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/select-commands.c
	* app/gui/view-commands.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanlistitem.c
	* tools/pdbgen/pdb/display.pdb
	* app/pdb/display_cmds.c: changed accordingly (mostly including
	"picmandisplay-foreach.h" instead of "picmandisplay.h")

2001-10-10  DindinX <dindinx@wanadoo.fr>

	* app/display/picmandisplay-callbacks.c: fixed a buglet. Key-release
	  events are now correctly handled.

2001-10-08  Dave Neary <nearyd@eircom.net>

	* HACKING
	* RELEASE-TO-CVS.patch: Added file, and instructions on
        why/how to use it to HACKING

2001-10-07  DindinX <dindinx@wanadoo.fr>

	* plug-ins/common/apply_lens.c: little optimisation by avoiding some
	useless recalculation.

2001-10-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfontselection-dialog.c: inserted some extra checks
	to work around a bug in PangoFT2 version 0.20.
	
2001-10-02  Emese Kovacs  <emese@gnome.hu>

	* tips/Makefile.am|makefile.mingw: Added picman_tips.hu.txt to the
        targets.

        * tips/picman_tips.hu.txt: Added Hungarian tips file in UTF-8
	encoding.

2001-10-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sobel.c (sobel_dialog): merged fix for bug #61525
	from stable tree.

2001-10-01  Michael Natterer  <mitch@picman.org>

	* configure.in: create build/win32/dirent/Makefile.

2001-09-28  Sven Neumann  <sven@picman.org>

	* configure.in(ALL_LINGUAS): Removed zh_CN again until all po files
	have been added. Translators, read README.i18n!

2001-09-28  Michael Natterer  <mitch@picman.org>

	* app/gui/preferences-dialog.c: added a frame around the tree.

	* app/widgets/picmanhistogramview.c: forgot to pass the "detail" to
	g_signal_emit(). Should fix the histogram tool. Thanks to Seth for
	debugging.

2001-09-28  Wang Jian  <lark@linux.net.cn>

	* configure.in(ALL_LINGUAS): Added zh_CN

2001-09-27  Sven Neumann  <sven@picman.org>

	* HACKING
	* Makefile.am
	* acconfig.h
	* autogen.sh
	* configure.in: use AM_GLIB_GNU_GETTEXT. Since glib and GTK+ rely on
	gettext being available, we don't need to ship with the option to use
	an included implementation. The intl subdirectory will not be created
	anymore. Had to put the old sed hacks back in that create Makefiles
	from Makefile.in in the extra po directories.

	* almost all Makefile.am: removed $(top_srcdir)/intl from INCLUDES.
	
	* app/main.c
	* libpicman/stdplugins-intl.h
	* plug-ins/perl/Picman.xs
	* plug-ins/script-fu/script-fu-intl.h: changed package names to 
	picman14* so the po files don't clash with picman12.

2001-09-26  Manish Singh  <yosh@picman.org>

	* app/gui/preferences-dialog.c: replaced CTree with a TreeView

2001-09-26  Sven Neumann  <sven@picman.org>

	* configure.in: we require glib-1.3.9, pango-0.20, atk-0.5 and
	gtk+-1.3.9 available from ftp://ftp.gtk.org/pub/gtk/v1.3/.

	* HACKING: mention the fact that we will try to keep our source
	compileable against the latest development releases of gtk+ and
	friends.

	* app/plug_in.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* plug-ins/common/csource.c
	* plug-ins/common/wmf.c: follow glib API changes.

	* plug-ins/common/mail.c: fixed a warning.

2001-09-26  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/disp_callbacks.[ch]
	* app/gdisplay.[ch]
	* app/gdisplay_ops.[ch]
	* app/gximage.[ch]
	* app/image_render.[ch]
	* app/interface.[ch]
	* app/marching_ants.h
	* app/scale.[ch]
	* app/scroll.[ch]
	* app/selection.[ch]: removed.

	* app/display/Makefile.am
	* app/display/display-types.h
	* app/display/picmandisplay-callbacks.[ch]
	* app/display/picmandisplay-marching-ants.h
	* app/display/picmandisplay-ops.[ch]
	* app/display/picmandisplay-render.[ch]
	* app/display/picmandisplay-scale.[ch]
	* app/display/picmandisplay-scroll.[ch]
	* app/display/picmandisplay-selection.[ch]
	* app/display/picmandisplay.[ch]
	* app/display/picmandisplayshell.[ch]
	* app/display/gximage.[ch]: added here.

	* app/[many files]
	* app/gui/[many files]
	* app/tools/*
	* app/widgets/[many files]: changed accordingly. Still very
	incomplete separation of the display stuff but it at least
	compiles.

	* tools/pdbgen/pdb.pl:
	* tools/pdbgen/pdb/display.pdb: s/GDisplay/PicmanDisplay/,
	s/"gdisplay.h"/"display/picmandisplay.h"/.

	* app/pdb/display_cmds.c: regenerated.

2001-09-25  Michael Natterer  <mitch@picman.org>

	* app/gdisplay.[ch]: renamed it to PicmanDisplay and made it a
	PicmanObject subclass.

	* app/disp_callbacks.[ch]
	* app/gdisplay_ops.[ch]
	* app/scale.[ch]
	* app/scroll.[ch]
	* app/display/display-types.h: changed accordingly.

	* app/core/picmanimage.[ch]: new signal "selection_control".

	* app/core/core-types.h: moved the SelectionControl enum and all
	other core enums here.

	* app/gui/gui.c: connect to the images' "selection_control" signal
	and call gdisplays_selection_visibility().

	* app/core/picmancontext.c
	* app/core/picmandrawable-offset.h
	* app/core/picmanimage-convert.h
	* app/core/picmanimage-mask.c
	* app/core/picmanlayer.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c: changed accordingly.

	* app/gui/colormap-dialog.[ch]: GObject porting.

	* tools/pdbgen/Makefile.am: removed headers which no longer
	contain enums.

	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/drawable.pdb: include files which are no longer
	included automatically by the enum voodoo.

	* app/pdb/convert_cmds.c
	* tools/pdbgen/enums.pl: regenerated.

2001-09-24 Nathan Summers <rock@picman.org>
        
        * plug-ins/Lighting/lighting_image.c
        * plug-ins/Lighting/lighting_shade.c: fixed off-by-one error that 
        caused segfaults on images with a width of exactly 64.  Bug is present 
        in 1.2.2; fix should be committed to stable after it is tested.

2001-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/Makefile.am: reenabled build of ifscompose. We should port 
	the gdk_string functions to Pango, but for the moment it builds again
	by undefining GDK_DISABLE_DEPRECATED.

2001-09-22  Hans Breuer  <hans@breuer.org>

	* app/makefile.msc : need to link with pangof2

	* app/display/display-funcs.h : new file to provide prototype
	gdisplays_selection_visibility ()
	* app/core/picmanimage-mask.c :
	* app/core/picmanlayer.c : use it

	* app/core/makefile.msc : generate picmanmarshal.[hc]

	* app/gui/makefile.msc : add error-console-dialog.obj, also
	more trying for building as dll

	* app/tools/picmaninktool.c(965) : avoid "fatal error C1021: invalid 
	preprocessor command 'warning'", by wrapping it in #ifdef __GNUC__

	* app/tools/makefile.msc : add FREETYPE2_CFLAGS

	* app/widgets/picmanfontselction-dialog.c : use g_strcasecmp ()

	* app/tools/makefile.msc : add FREETYPE2_CFLAGS and picmanfontselction*

	* libpicman/picman.def :
	* libpicmanwidgets/picmanwidgets.def : updated externals

	* libpicmanwidgets/makefile.msc : add picmanstock

	* plug-ins/makefile.msc : gflare doesn't require EXTRA_gflare anymore

	* plug-ins/common/spheredesigner.c : 
	* plug-ins/helpbrowser/helpbrowser.c :
	* plug-ins/imagemap/imap_main.c :
	remove _help_accel from picman_help_connect ()

	* plug-ins/gap/gap_mov_dialog.c :
	* plug-ins/gap/gap_navigator_dialog.c : remove references to 
	use_xshm and picman_color_cube ()

	* plug-ins/gfig/gfig.c : don't access ->klass, but use 
	G_OBJECT_GET_CLASS

	* plug-ins/picmanressionist/repaint.c : the GtkButton::child
	field is moved to the parent GtkBin.

	* plug-ins/ifscompose/ifscompose.c : the GtkStyle::font field
	isn't public anymore, use accessor gtk_style_get_font ()

	* plug-ins/imagemap/imap_preferences.c : reflect GTK2 API change
	gtk_notebook_set_current_page ()

2001-09-20  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.[ch]: made a real object (GtkDialog
	subclass) out of it. The API will change soon too.

	* libpicmanwidgets/picmanwidgetstypes.h: added PicmanDialog typedef.

	* libpicmanwidgets/picmanbutton.[ch]
	* libpicmanwidgets/picmanchainbutton.[ch]
	* libpicmanwidgets/picmancolorarea.[ch]
	* libpicmanwidgets/picmancolorbutton.[ch]
	* libpicmanwidgets/picmanfileselection.[ch]
	* libpicmanwidgets/picmanoffsetarea.[ch]
	* libpicmanwidgets/picmanpatheditor.[ch]
	* libpicmanwidgets/picmanpixmap.c
	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c: removed GtkType stuff and use
	GType in all get_type() functions. Some random GObject porting.

	* app/gui/info-dialog.c
	* app/gui/info-window.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantransformtool.c: changed accordingly.

2001-09-20  Sven Neumann  <sven@picman.org>

	* app/gdisplay.c: fixed resize of cursor position label that I broke
	with my latest change.
	
	* app/widgets/picmanfontselection-dialog.c: avoid the crash by using the
	correct PangoContext, but there's still a bug somewhere in this code
	(or in PangoFT2).

2001-09-19  Michael Natterer  <mitch@picman.org>

	* TODO.xml: added an entry about "Stroke".

	* app/gui/about-dialog.c: use g_timeout and g_source functions
	instead if gtk_timeout stuff.

	* app/widgets/picmandnd.[ch]: general cleanup:

	- removed the internal enum duplication and use PicmanDndType all over
	  the place.
	- added internal PicmanDndDataDef entries for all public DND types.
	- code cleanup, some debugging output.

2001-09-19  Sven Neumann  <sven@picman.org>

	* configure.in: require GTK+-1.3.8 and PangoFT2-0.19.
	
	* app/devices.c:
	* app/tools/picmanpainttool.c: removed intermediate hacks that are no 
	longer needed with the new GTK+ release.
	
	* app/plug_in.c
	* libpicman/picman.[ch]
	* libpicman/picmanui.c
	* libpicmanbase/picmanprotocol.[ch]: removed use_xshm and color_cube
	variables and accessor functions. 
	
	* app/errors.c: use gtk_exit() instead of gdk_exit().

	* app/gdisplay.c: use Pango API to determine cursor label width. This
	does not work correctly, but at least it compiles...
	
	* app/gui/splash.c: follow Pango API changes.

	* app/tools/picmancurvestool.[ch]: use PangoLayouts to draw text.

	* app/tools/picmantexttool.c: follow Pango API changes.
	
	* app/widgets/picmanfontselection-dialog.c
	* app/widgets/picmanfontselection.c: mostly rewritten following the
	changes in GtkFontSelection. This is unusable at the moment and 
	crashes, but at least it compiles again...

	* plug-ins/Makefile.am: temporarily disabled build of ifscompose since
	it does not compile any longer after the latest GDK cleanups.

	* plug-ins/common/nlfilt.c: picman_color_cube() is obsolete.
	
2001-09-18  Sven Neumann  <sven@picman.org>

	* app/pdb/parasite_cmds.c
	* tools/pdbgen/pdb/parasite.pdb: fixed nasty bug in perl expression
	that caused all parasite PDB functions to work on global picman parasites
	even if the picman_image_parasite* and picman_drawable_parasite* functions
	were called.
	
2001-09-17  Sven Neumann  <sven@picman.org>

	* app/picmanrc.c (picmanrc_init): 
	fixed a typo spotted by Ed Halley <ed@halley.cc>.

	* app/pdb/picmanrc_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanpicmanrc_pdb.[ch]: added new PDB function 
	picman_get_default_comment() that allows to access the default image
	comment as set in the preferences.

	* plug-ins/common/csource.c
	* plug-ins/common/gif.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/tiff.c: use picman_get_default_comment() instead of 
	a hardcoded string.

	* plug-ins/common/uniteditor.c: replaced deprecated GDK function
	gdk_color_alloc().

2001-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mail.c: resurrected mail plug-in. Thanks to 
	David Odin <dindinx@wanadoo.fr> for the patch.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: build mail, nlfilt and plugindetails
	plug-ins again.

	* tips/Makefile.am
	* tips/picman_conseils.fr.txt: removed ...
	* tips/picman_tips.fr.txt: ... and readded under this name.

2001-09-11  Nathan Summers <rock@picman.org>

	* all files: wilber cried.

2001-09-09  Sven Neumann  <sven@picman.org>

	* app/devices.c
	* app/tools/picmanpainttool.c: readded the old code here in case the
	old GDK variable is defined. Since GTK+-1.3.7 is finally out, we want 
	to try to keep PICMAN compile against this release as long as possible.

	* plug-ins/common/gif.c: applied a patch from David Odin 
	<dindinx@wanadoo.fr> that brings the GIF plug-in back to live.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: build it again.

2001-09-08  Daniel Egger  <egger@interearth.com>

	* app/devices.c
	* app/tools/picmanpainttool.c: Use new gdk_device_get_core_pointer ()
	instead of the former gdk_core_pointer variable. You will need a
	recent CVS gtk to compile it!

2001-09-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanoffsetarea.c
	* plug-ins/gdyntext/charmap.c
	* plug-ins/gdyntext/charmap_window.c
	* plug-ins/gdyntext/font_selection.c
	* plug-ins/gdyntext/message_window.c: 
	use GtkType instead of guint to store result of gtk_type_unique(). 
	Patch courtesy of Alex Larsson <alexl@redhat.com>.

2001-09-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/jpeg.c: JPEG is back!
	Thanks to David Odin <dindinx@wanadoo.fr> for the patch.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: build it again.

2001-09-03  Sven Neumann  <sven@picman.org>

	* app/gui/about-dialog.c
	* app/gui/splash.c: draw text using PangoLayouts, now compiles with
	GDK_DISABLE_DEPRECATED being defined.

	* app/gui/authors.h
	* tools/authorsgen/authorsgen.pl
	* tools/authorsgen/contributors: converted to use UTF-8 strings.

2001-09-03  Michael Natterer  <mitch@picman.org>

	* configure.in: added -DGDK_DISABLE_DEPRECATED.

	* app/gui/about-dialog.c
	* plug-ins/common/wmf.c
	* plug-ins/ifscompose/ifscompose_utils.c: #undef it here (too lazy...)

	* app/colormaps.[ch]
	* app/gdisplay.c
	* app/module_db.c
	* app/plug_in.c
	* app/gui/brush-editor.c
	* app/gui/color-notebook.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/paths-dialog.c
	* app/gui/select-commands.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c: replaced deprecated stuff,
	g_list_free() the return value of gtk_container_get_children().

	* plug-ins/Makefile.am: build gflare again.

	* plug-ins/gflare/asupsample.[ch]: removed because the same function
	is already in libpicmancolor.

	* plug-ins/gflare/gtkmultioptionmenu.[ch]: removed because Gtk+
	handles menu_height > screen_height by scrolling now.

	* plug-ins/gflare/Makefile.am
	* plug-ins/gflare/gflare.c: changed accordingly, cleanups.

2001-09-03  Sven Neumann  <sven@picman.org>

	* app/plug_in.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: check strings from data files and plug-in 
	registration for UTF-8 validity. There are probably a lot more places 
	that need these checks.

	* plug-ins/common/gqbist.c: converted PDB texts to UTF-8.

2001-08-31  Thomas Canty  <tommydal@optushome.com.au>

	* app/colormaps.c
	* app/gdisplay.c
	* app/nav_window.c
	* app/scroll.c
	* app/selection.c
	* app/undo.c
	* app/gui/about-dialog.c
	* app/gui/color-area.c
	* app/gui/color-select.c
	* app/gui/gradient-editor.c
	* app/gui/gui.c
	* app/gui/splash.c
	* app/tools/picmancurvestool.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/curve_bend.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/imagemap/imap_preview.c: replaced some deprecated GDK 
	functions

2001-08-30  Michael Natterer  <mitch@picman.org>

	* app/plug_in.c
	* libpicmanbase/picmanwire.c
	* libpicman/picman.c: removed GIOChannel "channel->funcs->io_foo()"
	hacks and use plain g_io_channel_[read|write]_chars(). An
	additional g_io_channel_set_buffered (channel, FALSE); is needed
	to make the channels work in binary mode. Fixed misc other stuff
	in the GIOChannel code.

	* app/tools/picmandrawtool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmandialogfactory.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicman/picmanui.c: replaced some deprecated GDK functions.

	* app/gui/palette-editor.c: block the color_name entry's "changed"
	signal while setting it. Fixes invalid UTF-8 warnings.

2001-08-30  Sven Neumann  <sven@picman.org>

	* app/plug-in.c: set the message encoding for the plug-in textdomain.
	
2001-08-30  Sven Neumann  <sven@picman.org>

	* configure.in: check for bind_textdomain_codeset, use standard 
	HAVE_FOO semantic for difftime.

	* libpicman/picmanintl.h
	* libpicman/libpicman-intl.h
	* libpicman/stdplugins-intl.h: set encoding of message translations
	to UTF-8 if bind_textdomain_codeset() is available. We still 
	explicitely set LC_NUMERIC to "C" so we can write and parse floats 
	in a defined way independent of the locale. We might want to find 
	a cleaner solution for this.
	
	* plug-ins/script-fu/script-fu-server.c: inverted preprocessor logic
	from NO_DIFFTIME to HAVE_DIFFTIME.
	
	* plug-ins/script-fu/scripts/trochoid.scm: 
	fixed parameter description (bug #59760).

2001-08-29  Sven Neumann  <sven@picman.org>

	* README.i18n: added a section that mentions the GNOME translation
	project that coordinates translation efforts in the GNOME CVS tree.

	Mention the fact that po files as well as the tips files need to be
	UTF-8 encoded to work with GTK+-2.0.

	* tips/picman_tips.de.txt: converted to UTF-8.

2001-08-29  Sven Neumann  <sven@picman.org>

	* app/widgets/gtkhwrapbox.[ch]
	* app/widgets/gtkvwrapbox.[ch]
	* app/widgets/gtkwrapbox.[ch]: make it compile even if you don't 
	have gle installed ;-)

2001-08-29  Sven Neumann  <sven@picman.org>

	* configure.in: added comment how to handle version numbers when
	making releases so I don't get it wrong once again. 
	Removed leftover PICMAN_CONTRIBUTORS.

	* picmantool.1.in: removed this file.

	* docs/Makefile.am
	* docs/picman.1.in: fixed stuff that was left after the removal of
	the PICMAN_CONTRIBUTORS hack.

2001-08-29  Michael Natterer  <mitch@picman.org>

	* configure.in: added -DG_DISABLE_DEPRECATED and
	-DGDK_DISABLE_COMPAT_H.

	* app/batch.c
	* app/file-utils.c
	* app/gdisplay.c
	* app/gdisplay_ops.c
	* app/picmanrc.[ch]
	* app/module_db.c
	* app/nav_window.c
	* app/undo_history.c
	* app/core/picmangradient.c
	* app/core/picmanimagefile.c
	* app/core/picmanpalette.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/gui/error-console-dialog.c
	* app/gui/file-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/info-window.c
	* app/gui/menus.c
	* app/gui/palette-import-dialog.c
	* app/tools/picmanbycolorselecttool.c
	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmandatafactoryview.c
	* libpicman/picmanmenu.c
	* plug-ins/common/bz2.c
	* plug-ins/common/compose.c
	* plug-ins/common/csource.c
	* plug-ins/common/decompose.c
	* plug-ins/common/gz.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/script-fu/interp_slib.c
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-scripts.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* app/pdb/fileops_cmds.c
	* app/pdb/picmanrc_cmds.c: removed deprecated stuff like
	g_basename(), g_dirname(), g_strup() and friends. Added some
	"const gchar *" declarations while I was on it. Added some
	G_N_ELEMENTS() macros instead of declaring a useless variable
	for the number of items.

	* app/widgets/gtkhwrapbox.[ch]
	* app/widgets/gtkvwrapbox.[ch]
	* app/widgets/gtkwrapbox.[ch]: replaced with the latest versions
	from GLE, ported by the master himself.

	* app/gui/toolbox.c: changed accordingly.

	* app/plug_in.c
	* libpicman/picman.c
	* libpicmanbase/picmanwire.[ch]: use evil hacks to get binary mode
	from the new GIOChannel implementation (upstream bugreport already
	posted).

2001-08-28  Sven Neumann  <sven@picman.org>

	* configure.in: removed the authorgen hack. It broke the build with
	autoconf-2.52. Need to come up with a better idea. Until then the
	manpages don't show the autors anymore.
	Removed the useless definitions of brushdata, palettedata, ...
	while I was on it.

	* data/Makefile.am
	* data/brushes/Makefile.am
	* data/gradients/Makefile.am
	* data/palettes/Makefile.am
	* data/patterns/Makefile.am: do it the conventional way and list all
	data files in the Makefiles.

2001-08-28  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh: libtool >= 1.3.4 should be good enough

2001-08-28  Sven Neumann  <sven@picman.org>

	* acinclude.m4: removed redefinitions of libtool macros. We use the
	installed libtool now. If this breaks the build for your system, 
	upgrade libtool. If that does not help, let us know.
	
	* ltconfig
	* ltmain.sh: removed these files. Newer versions of libtool don't use
	ltconfig and ltmain.sh is taken from your libtool installation.

	* autogen.sh: check for presence of libtool.
	
	* Makefile.am
	* configure.in
	* picman-remote.1.in
	* picman.1.in
	* picmanrc.5.in: removed man-pages from toplevel dir ...
	
	* docs/Makefile.am
	* docs/picman-remote.1.in
	* docs/picman.1.in
	* docs/picmanrc.5.in
	* docs/picmantool-1.4.1.in: ... and added them back here.
	
	* picman-1.4.m4: removed from toplevel dir ...
	
	* m4macros/Makefile.am
	* m4macros/picman-1.4.m4: ... and added it back here.

2001-08-19  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am: added PANGOFT2_CFLAGS to INCLUDES.

2001-08-19  Sven Neumann  <sven@picman.org>

	* app/devices.h
	* app/disp_callbacks.c
	* app/interface.c: applied a patch from <David.Odin@bigfoot.com> that
	changes some function prototype to return gboolean instead of gint.
	
	* app/tools/picmanblendtool.c: pixel_regions_register() and 
	pixel_regions_process() return a gpointer, not (gpointer *).

2001-08-17  Michael Natterer  <mitch@picman.org>

	* configure.in: added app/display/ and app/plug-in/. Empty for
	now except for the types files.

	* app/Makefile.am
	* app/appenums.h
	* app/apptypes.h: removed.

	* app/display/Makefile.am
	* app/display/display-types.h
	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/gui/Makefile.am
	* app/gui/gui-types.h
	* app/pdb/Makefile.am
	* app/pdb/pdb-types.h: new files for typedefs.

	* app/appenv.h: added MessageHandlerType and StackTraceMode here.

	* app/undo_types.h: moved undo struct typedefs here.

	* app/tools/tools-types.h
	* app/core/core-types.h: added some enums and Tattoo here
	(renamed to PicmanTattoo).

	* app/gdisplay.h: temp_hack: #include "display/display-types.h"

	* app/picmanhelp.c: s/gtk_idle_add/g_idle_add/

	* app/picmanrc.c: don't use "picmanrc" in token handlers but the
	passed "val1p" and "val2p".

	* app/image_map.[ch]: cleanup in preparation of making a GObject
	out of it.

	* app/base/pixel-region.[ch]: no need to pass the
	PixelRegionIterator around as void pointer.

	* app/core/picman.[ch]
	* app/core/picmancontext.[ch]
	* app/core/picmantoolinfo.[ch]
	* app/tools/tool_manager.c
	* app/widgets/picmandnd.c: added the standard_tool_info to the Picman
	object.

	* app/batch.c
	* app/file-open.c
	* app/file-save.c
	* app/file-utils.c
	* app/interface.c
	* app/main.c
	* app/path.[ch]
	* app/pathP.h
	* app/plug_in.h
	* app/core/picmandrawable.[ch]
	* app/core/picmanimage-mask.c
	* app/core/picmanimage.[ch]
	* app/core/picmanlayer.c
	* app/gui/color-area.c
	* app/gui/color-notebook.c
	* app/gui/colormap-dialog.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/error-console-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gradient-select.c
	* app/gui/indicator-area.c
	* app/gui/info-dialog.c
	* app/gui/palette-editor.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c
	* app/gui/session.c
	* app/gui/splash.c
	* app/gui/view-commands.c
	* app/tools/picmaninktool-blob.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmanpreview.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c: changed accordingly: s/Tattoo/PicmanTattoo/, include
	the new types files, include <glib-object.h> instead of >gtk/gtk.h>.
	Bad hacks to get rid of SELECTION_OFF and friends in core/ (will
	be replaced ba a signal soon).

	* tools/pdbgen/Makefile.am: changed list of headers scanned for
	enums accordingly.

	* app/pdb/procedural_db.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: same fixes as above, added
	hacks to ensure that all foo-types.h files are included before all
	other picman internal includes, include "pdb-types.h" unconditionally.

	* tools/pdbgen/enums.pl
	* app/pdb/*_cmds.c: regenerated.

2001-08-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]
	* app/tools/tool_manager.[ch]: removed all *_get_PDB_string()
	functions and PicmanToolClass' "pdb_string" field as this info is
	stored independent from a specific tool instance in PicmanToolInfo

	* app/tools/picmanbezierselecttool.c: use PicmanToolInfo's "pdb_string".

2001-08-14  Michael Natterer  <mitch@picman.org>

	* app/interface.c
	* app/gui/about-dialog.c
	* app/gui/brush-editor.c
	* app/gui/brush-select.c
	* app/gui/color-notebook.c
	* app/gui/color-select.c
	* app/gui/convert-dialog.c
	* app/gui/file-commands.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-dialog-utils.h
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gradients-commands.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/layer-select.c
	* app/gui/menus.c
	* app/gui/paths-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/select-commands.c
	* app/gui/splash.c
	* app/gui/test-commands.c
	* app/gui/tips-dialog.c
	* app/tools/picmanthresholdtool.c
	* app/tools/paint_options.c
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c: got rid of all
	gtk_object_[get|set]_data() and almost all gtk_signal_foo()
	function calls.

2001-08-14  Michael Natterer  <mitch@picman.org>

	* app/gdisplay.h: an evil temp_hack which lets PicmanContext manage
	the active display without including "gdisplay.h". Will go away as
	soon as context properties are registered dynamically.

	* app/module_db.c: cleaned up the object code in preparation of
	moving it to core/.

	* app/path.c: connect to PicmanImage's "disconnect" signal instead
	of "destroy".

	* app/core/picmanobject.[ch]: derive it from GObject, not from
	GtkObject any more (yeah :-)

	* app/core/*.c: #include <glib-object.h> instead of <gtk/gtk.h>,
	removed some remaining GtkObject-isms.

	(left in a few #include <gtk/gtk.h> where bigger changes are needed
	to get rid of the UI dependency).

	* app/core/core-types.h: #include <gdk-pixbuf/gdk-pixbuf.h> here
	temporarily.

	* app/core/picman.c (picman_create_display): unref the image after
	creating it's first display.

	* app/core/picmanbrush.[ch]: disabled the parts of the code which
	depend on PicmanPaintTool.

	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c: changed accordingly.

	* app/core/picmancontext.[ch]: evil hack (see above) to manage the
	active display without including "gdisplay.h"

	* app/core/picmanimage-mask.[ch]: pass a context to
	gimage_mask_stroke() and get the current tool's PDB string from
	there.

	* app/core/picmanedit.c: changed accordingly.

	* app/core/picmanimage.c: use picman_image_update() instead of
	gdisplays_update_full().

	* app/gui/color-area.c
	* app/gui/colormap-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/edit-commands.c
	* app/gui/image-commands.c
	* app/gui/toolbox.c: changed accordingly (don't use Gtk methods on
	GObjects).

	* app/gui/menus.c: fix some const warnings by explicit casting.

	* app/tools/*.[ch]: ported all tools to GObject, some minor
	cleanup while i was on it.

	* app/widgets/picmandialogfactory.[ch]: ported to GObject.

	* app/widgets/picmanlayerlistview.h: added FOO_GET_CLASS() macro.

	* tools/pdbgen/app.pl: added a "widgets_eek" hack like "tools_eek"
	which inserts #include "widgets/widgets-types.h" before ordinary
	includes.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/edit.pdb
	* app/pdb/brush_select_cmds.c
	* app/pdb/edit_cmds.c: changed according to the stuff above.

2001-08-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: take image resolution and choosen unit 
	into account for font and border size.
	
	* app/widgets/picmanfontselection-dialog.[ch]
	* app/widgets/picmanfontselection.[ch]
	* app/widgets/widgets-types.h: added an indicator for font validity.
	Added a font preview to the font selection dialog.
	
	* libpicmanwidgets/picmanfileselection.c: return FALSE from 
	picman_file_selection_entry_focus_out_callback() since we do not want
	to stop signal emission.
	
2001-08-12  Michael Natterer  <mitch@picman.org>

	Switched to GObject reference counting:

	* app/core/picmancontainer.c: only ref(), not ref()/sink() children
	of strong containers. Reordered picman_container_remove() so we
	don't need to ref the object while removing it.

	* app/core/picmancontext.c: misc fixes. Needs to be badly tortured...

	* app/app_procs.c
	* app/gdisplay.c
	* app/picmanrc.c
	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandatafactory.c
	* app/core/picmandocuments.c
	* app/core/picmangradient.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/core/picmanlist.c
	* app/core/picmanobject.c
	* app/core/picmanparasite.c
	* app/core/picmanpattern.c
	* app/core/picmanundostack.c
	* app/gui/dialogs.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanfuzzyselecttool.c: changed accordingly: don't
	ref()/sink() any more, unref all (??) objects after adding them to
	strong containers, misc. minor fixes.

	* app/gui/dialogs-constructors.c
	* app/widgets/picmanwidgets.c: use g_object_add_weak_pointer()
	instead of simply crashing because g_object_weak_ref() was used
	with gtk_widget_destroyed, brrr.

	* app/widgets/picmandnd.c: removed unneeded g_return_if_fail()'s.

2001-08-12  Sven Neumann  <sven@picman.org>

	* TODO.xml: fixed an error, updated some numbers and added new items.

2001-08-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: return the created layer.

	* app/pdb/text_tool_cmds.c
	* libpicman/picmantexttool_pdb.c
	* tools/pdbgen/pdb/text_tool.pdb: hacked a bit so scripts using the 
	text_*_fontname procedures work again with the new text tool. 
	The fontname is however no longer a X Logical Font Description, but 
	the much simpler scheme that Pango understands: 
	"[FAMILY-LIST] [STYLE-OPTIONS]". Interactive font selection is still
	broken. The variants of the text PDB calls that pass the XLFD fields
	directly should also work since the PDB now translates this to a
	Pango-conform fontname. Later this API will die, but for the moment,
	some backward compatibility can't hurt...

2001-08-11  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c: split "destroy" up in "dispose" and "finalize".

	* app/core/picmancontext.c: objects need to be passed around with
	g_param_spec_object() or bad things will happen.

	* app/gui/channels-commands.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/gui.c
	* app/gui/layers-commands.c
	* app/gui/resize-dialog.c
	* app/gui/select-commands.c
	* app/tools/picmanclonetool.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanpreview.c: removed many connections to
	"destroy": Connect to "disconnect" or use g_object_weak_ref()
	instead.

2001-08-11  Michael Natterer  <mitch@picman.org>

	* configure.in: fsck^^^ -- lovely autofoo wants "changequote([,])dnl"

	* app/core/picmancontext.[ch]: lots of GObject porting.

	* app/core/picmanobject.[ch]: added a "disconnect" signal, which
	like gtk's "destroy" is emitted in dispose(). This is ugly but
	I don't see another "clean" way to implement weak containers.

	* app/core/picmancontainer.c: connect to the "disconnect" signal of
	the children of weak containes.

	* app/core/picmanimage.[ch]: replaced the "destroy" implementation
	with "dispose" + "finalize". Removed gimage->undo_history.

	* app/devices.c
	* app/gui/dialogs-constructors.c
	* app/gui/tools-commands.c
	* app/tools/tool_manager.c
	* app/widgets/picmanimagedock.c: changed accordingly.

2001-08-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: made border work and fixed render offsets.

2001-08-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: allow to specify size and border. 
	
	* app/widgets/picmanfontselection.c: use GTK_STOCK_SELECT_FONT icon.

2001-08-11  Sven Neumann  <sven@picman.org>

	* configure.in: added dependency on PangoFT2 (Pango compiled with 
	FreeType2 support).
	
	* app/Makefile.am: link against PangoFT2.
	
	* app/tools/Makefile.am
	* app/tools/picmantexttool.[ch]: rudimentary new text tool. Still needs
	lots of work.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h:
	* app/widgets/picmanfontselection-dialog.[ch]
	* app/widgets/picmanfontselection.[ch]: added font selection widgets.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanfontselection.[ch]: removed font selection code 
	from here since the fonts need to be selected from the core's 
	PangoContext. Will add PDB-controlled font selection later.

2001-08-11  Michael Natterer  <mitch@picman.org>

	* TODO.xml: added a TODO entry about additional image/file info.

	* app/file-save.c: #include "core/picmandocuments.h"

	* app/core/picmancontainer.[ch]: made virtual functions out of some
	signals.

	* app/core/*.[ch]: more GObject stuff: ported all
	picman_foo_get_type() functions and replaced almost all "destroy"
	implementations with either "finalize" or "dispose" functions.

2001-08-11  Seth Burgess      <sjburges@picman.org>
	
	* plug-ins/common/colortoalpha.c: set nparams != 4 for 
	non-interactive execution.  Thanks to alex@foogod.com for
	this fix.

2001-08-11  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmandocuments.[ch]: new file implementing the
	docindex.* replacement.

	* app/picmanrc.c: added TT_XDOCUMENT to parse the new document
	history.

	* app/file-save.c
	* app/gui/file-open-dialog.c: add opened & saved images to the
	document history.

	* app/core/picman.c: call picman_documents_init/exit() instead of
	doing it here.

	* app/core/picmanimagefile.[ch]: removed the "filename" attribute
	and use PicmanObject's "name" instead.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c: added a menu entry/dockable for the document
	history.

	* app/widgets/picmandnd.[ch]: make it DND-able.

	* app/widgets/picmanpreview.c: fix preview rendering correctly this
	time.

2001-08-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanfontselection.[ch]: added a rudimentary font
	selection widget, mostly copied from GtkFontSelection.

	* libpicmanwidgets/picmanfileselection.c: more GObject porting.

2001-08-10  Michael Natterer  <mitch@picman.org>

	* app/nav_window.c: fix compiler warning.

	* app/core/picman.[ch]: added picman->documents which will be an MRU
	list of PicmanImagefile objects.

	* app/core/picmancontainer.c: added some g_return_if_fail().

	* app/gui/palette-editor.c: use GtkImage instead of GtkPixmap,
	s/gtk_signal_*/g_signal_*/.

	* app/widgets/picmanpreview.c: render the checkerboard only for
	channel == -1. In particular, don't render it for channel
	previews.

	* app/module_db.c
	* app/core/*.c
	* app/gui/colormap-dialog.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmansmudgetool.c
	* app/tools/tool_manager.c
	* app/widgets/*.c
	* libpicmanwidgets/*.c: s/gtk_type_new/g_object_new/

2001-08-09  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: removed PICMAN_ZOOM_TYPE,

	* app/widgets/widgets-types.h: added it here.

	* app/disp_callbacks.c
	* app/widgets/picmannavigationpreview.[ch]
	* app/gui/gradient-editor.c: removed old cruft which expects wheel
	events as button_4 and button_5 and connect to GdkEventScroll
	instead.

	* app/nav_window.c: connect to PicmanNavigationPreview's new
	"scroll" and "zoom" signals.

	* app/gui/error-console-dialog.c: remove wheel scrol stuff (done
	by GtkScrolledWindow now).

	* app/gui/color-notebook.c
	* app/gui/gradient-editor.c: removed GtkPixmap stuff and use
	GtkImage instead. Looks a bit ugly in the color_notebook (seems
	we need more icon sizes).

	* app/gui/indicator-area.c: GObject porting.

	* app/gui/menus.c_ some more menu icons.

	* app/gui/toolbox.c: pass a PicmanContext around as callback data
	and use context->picman instead of accessing the global "the_picman"
	variable.

2001-08-09  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimagefile.[ch]: added first draft of a PicmanImagefile
	object that will handle image files on disk, in particular their 
	thumbnails.

2001-08-07  Michael Natterer  <mitch@picman.org>

	* app/disp_callbacks.c: removed a gdk_pointer_ungrab(), it was
	only there because of buggy gtk+ 1.2.x. Cosmetic changes.

	* app/undo.c: use G_N_ELEMENTS() instead of
	sizeof(array)/sizeof(element).

	* app/gui/menus.c: more stock icons, moved the item_factory
	creation into the menus_get_foo_factory() functions, use
	G_N_ELEMENTS(). This file badly needs to be spit up...

	* app/core/picmanviewable.[ch]
	* app/widgets/picmancontainermenu.[ch]
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanmenuitem.[ch]
	* app/widgets/picmanpreview.[ch]: replaced tons of signal emissions
	by virtual functions which are *much* faster. Moreover, all of
	them are private implementation bits of the specific class
	hierarchy and are useless or even dangerous to be exposed as
	signals.

	* app/widgets/picmandrawablelistitem.c: removed the drag_motion()
	implementation as it's already done in the parent class.

	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanlayerlistitem.c: redraw the widget when the
	drop_type has changed. Fixes drop_indicator drawing.

2001-08-07  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbutton.[ch]: cleanup.

	* app/Makefile.am
	* app/errorconsole.[ch]: removed...

	* app/gui/Makefile.am
	* app/gui/error-console-dialog.[ch]: ...added here. Lots of cleanup,
	create a vbox instead of a dialog.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c: added a dockable for the error console.

	* app/errors.c
	* app/gui/gui.c
	* app/gui/menus.c: changed accordingly.

	* app/widgets/picmancontainerview.c: conntect "extended_clicked" to
	the "extended_clicked" callback, not "clicked".

	* app/widgets/picmanlayerlistview.c: set the layer option box'
	spacing in "style_set".

	* app/widgets/picmanlistitem.c: argh.

	* themes/Default/gtkrc: changed the default theme to set a smaller
	font only for the dockable because that's where saving screen
	estate really makes sense. May need some further tweaking.

2001-08-06  Daniel Egger  <egger@suse.de>

	* autogen.sh: Fix error message to reflect that one needs
	gettext 0.10.38 to compile PICMAN.

2001-08-06  Michael Natterer  <mitch@picman.org>

	* configure.in
	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/Makefile.am: some new Makefiles to
	make it installable.

	* Makefile.am
	* gtkrc: removed...

	* themes/Default/Makefile.am
	* themes/Default/gtkrc: ...added here.

	* themes/Default/imagerc: new file (not used, just for
	documentation) which loads the default theme's images in the same
	way the inlined pixbufs are registered with the stock system.

	* picmanrc.in
	* picmanrc.win32
	* user_install
	* user_install.bat
	* app/picmanrc.[ch]: added "theme-path" and "theme" picmanrc variables.

	* app/app_procs.c: prase picmanrc before initializing the GUI.

	* app/core/picmandatafiles.[ch]: added support for getting only
	subdirectories in the callback.

	* libpicmanbase/picmanenv.c: as a temp_hack picman_gtkrc(); returns the
	default theme's gtkrc.

	* app/gui/gui.c: build a hash of theme directories and select
	the one configured in picmanrc.theme. Use picman_gtkrc()'s default
	value if there is no theme installed or configured.

	* app/gui/preferences-dialog.c: Added theme_path to the GUI. No
	stuff for selection the theme yet.

	* app/gui/menus.c: beautify <Image>/Tools/

	* app/tools/picmancroptool.c: register in <Image>/Tools/Transform Tools/

2001-08-05  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* themes/.cvsignore
	* themes/Makefile.am
	* themes/Default/.cvsignore
	* themes/Default/Makefile.am
	* themes/Default/images/.cvsignore
	* themes/Default/images/*.png
	* themes/Default/images/tools/.cvsignore
	* themes/Default/images/tools/*.png: new place for all images
	which are registered with the stock system. The default images are
	all inlined but we will install the default theme later along with
	an appropriate gtkrc as a template for custom themes.

	Added PNGs of all tools icons. Thanks to syngin :)

	* pixmaps/.cvsignore
	* pixmaps/Makefile.am: reverted everything to the old state. This
	directory will go away soon.

	* libpicmanwidgets/picmanstock.[ch]: changed accordingly. Register
	stock icons in GTK_ICON_SIZE_BUTTON for all tools.

	* app/core/picmantoolinfo.[ch]
	* app/tools/tool_manager.[ch]: PicmanToolInfo wants a stock_id and a
	pre-rendered GdkPixbuf instead of ugly icon_data now. Added some
	workarounds until PicmanPreview is a GtkImage and uses GdkPixbuf
	instead of TempBuf.

	* app/tools/Makefile.am
	* app/tools/icons.h: die, uglyness, die.

	* app/tools/[all tools].c: register with a stock_id, not a
	icon_data pointer.

	* app/gui/dialogs-constructors.c: Oops, PICMAN badly crashed on
	changing the image for the past few days :)

	* app/gui/menus.c: create the tools' menu entries with stock
	icons.

	* app/gui/toolbox.c: use GtkImages instead of PicmanPreviews for
	the toolbox buttons. Will need to change this back as soon
	as PicmanPreview actually _is_ a GtkImage.

2001-08-05  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanstock.[ch]: register the button icons with
	GTK_ICON_SIZE_BUTTON, but set them as scalable fallbacks for
	themselves so they get scaled for menus.

	* app/gui/menus.c: set stock icons for much more menu entries.

	* app/widgets/picmanwidgets-utils.[ch]: new utility function
	picman_item_factory_popup_with_data().

	* app/disp_callbacks.[ch]
	* app/gui/brushes-commands.c
	* app/gui/channels-commands.c
	* app/gui/gradients-commands.c
	* app/gui/layers-commands.c
	* app/gui/palettes-commands.c
	* app/gui/paths-dialog.c
	* app/gui/patterns-commands.c: use the new function.

	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c: s/_("Reset")/PICMAN_STOCK_RESET/

	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmancontainerview.[ch]: moved the button_box utility
	functions from the container editor to PicmanContainerView itself.

	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancomponentlistitem.c
	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c: changed accordingly. Removed
	lots of duplicated code and use stock images instead of pixmaps.

	* libpicmanwidgets/picmanfileselection.[ch]
	* libpicmanwidgets/picmanpatheditor.c: use stock images instead of
	pixmaps.

	* pixmaps/Makefile.am: removed "yes" and "no", added "stroke".

	* pixmaps/anchor.xpm
	* pixmaps/delete.xpm
	* pixmaps/lower.xpm
	* pixmaps/new.xpm
	* pixmaps/paste-as-new.xpm
	* pixmaps/paste-into.xpm
	* pixmaps/paste.xpm
	* pixmaps/raise.xpm
	* pixmaps/refresh.xpm
	* pixmaps/toselection.xpm: made them all 16x16 so they are scaled
	nicely in menus. Should probably be 18x18.

2001-08-04  Michael Natterer  <mitch@picman.org>

	* Makefile.am: build pixmaps/ before libpicmanwidgets/.

	* pixmaps/.cvsignore
	* pixmaps/Makefile.am: build picman-stock-pixbufs.h using
	gdk-pixbuf-csource from some of our XPMs.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanstock.[ch]: new files featuring
	picman_stock_init(). Register a default GtkIconFactory and a set of
	stock buttons.

	* app/gui/gui.[ch]: new function gui_libs_init(). Call
	picman_stock_init() from it.

	* app/app_procs.c: call new function gui_libs_init().

	* libpicman/picmanui.c: call picman_stock_init().

	* app/devices.c: removed action_area hacks as we can configure it
	via style properties now.

	* app/gui/menus.c: use <StockItem> for some menu entries.
	Looks nifty :-)

	* app/widgets/picmancontainereditor.[ch]: take a "stock_id"
	parameter in picman_container_editor_add_button(), not a EEKy
	pxm_data pointer.

	* app/widgets/picmanbufferview.c
	* app/widgets/picmandatafactoryview.c: changed accordingly.

	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandrawablelistview.c: removed ugly tooltips
	formating hacks since gtk2 does it right now.

	* app/widgets/picmandockbook.c: re-enabled a line that was commented
	out for some reason...?

	* app/errorconsole.c
	* app/gui/file-new-dialog.c
	* app/gui/tool-options-dialog.c
	* plug-ins/common/uniteditor.c: use the new PICMAN_STOCK_FOO id's.

	* libpicmanwidgets/picmanquerybox.c: fixed auto-hiding by connection
	to a passed object's signal.

2001-08-03  Michael Natterer  <mitch@picman.org>

	* gtkrc: set style properties for dockables.

	* app/main.c: some #if 0'ed code for mem profiling.

	* app/gui/commands.[ch]
	* app/gui/menus.c: added a mem profiling menu entry + callback.

	* app/gui/palette-editor.c: added a #warning as reminder, use
	gtk_dialog_set_has_separator().

	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmandockable.[ch]
	* app/widgets/picmandrawablelistview.[ch]: added some style
	properties to set PicmanDockable and friends' borders and spacings.

	* libpicmanwidgets/picmanpixmap.[ch]
	* libpicmanwidgets/picmansizeentry.[ch]
	* libpicmanwidgets/picmanunitmenu.[ch]: GObject stuff, cleanup.

	* app/docindex.c
	* app/errorconsole.c
	* app/gdisplay_color_ui.c
	* app/picmanprogress.c
	* app/module_db.c
	* app/undo_history.c
	* app/user_install.c
	* app/gui/channels-commands.c
	* app/gui/gradient-editor.c
	* app/gui/info-window.c
	* app/gui/tips-dialog.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/widgets/picmandatafactoryview.c
	* libpicman/picmanexport.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* plug-ins/[lots of files]:

	Some perl mass processing applying s/_("Foo")/GTK_STOCK_FOO/g,
	minor manual cleanup in some files.

2001-08-02  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c:
	s/#ifndef GDK_WINDOWING_WIN32/#ifdef GDK_WINDOWING_X11/

2001-08-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tga.c: merged fix for small TGA2 files by
	 Nick Lamb <njl195@zepler.org.uk> from the stable branch.

2001-08-01  Sven Neumann  <sven@picman.org>

	* app/docindex.c
	* app/gdisplay_color_ui.c
	* app/picmanprogress.c
	* app/nav_window.c
	* app/path.c
	* app/scale.c
	* app/undo_history.c
	* app/user_install.c
	* app/gui/resolution-calibrate-dialog.[ch]: converted uses of  
	gtk_signal_* to g_signal_*. 

	Changed expose_event handlers that used to be connected using 
	signal_connect_after to call the default handler, do the additional 
	drawing, then stop the signal emission by returning TRUE.

2001-08-01  Sven Neumann  <sven@picman.org>

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/tools/transform_options.c: got rid of all remaining gtk_signal 
	wrappers in the tools directory.

2001-08-01  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h: defined PicmanTransferMode enum.
	
	* app/tools/picmancolorbalancetool.[ch]
	* app/tools/picmandodgeburntool.[ch]: use it here instead of defining
	the same enum again. Some GObject porting.
	
	* app/tools/picmansmudgetool.h: removed unused enum SmudgeMode.

	* app/pdb/color_cmds.c
	* app/pdb/tools_cmds.c
	* libpicman/picmanenums.h
	* libpicman/picmantools_pdb.[ch]
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly (mostly generated)

2001-08-01  Sven Neumann  <sven@picman.org>

	* configure.in: added GTK_DISABLE_COMPAT_H back to CPPFLAGS.
	
	* app/user_install.c
	* app/base/base.c
	* app/gui/info-window.c
	* app/gui/menus.c
	* app/gui/preferences-dialog.c
	* app/pdb/procedural_db_cmds.c
	* app/tools/picmancurvestool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandrawablelistview.c
	* app/widgets/picmannavigationpreview.c
	* libpicmanbase/picmanparasiteio.c
	* libpicmanwidgets/picmanwidgets.c
	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/uniteditor.c
	* plug-ins/dbbrowser/dbbrowser_utils.c
	* plug-ins/gap/gap_navigator_dialog.c
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/ifscompose/ifscompose_storage.c
	* plug-ins/print/picman_main_window.c
	* tools/picman-remote.c
	* tools/pdbgen/pdb/procedural_db.pdb: replaced lots of deprecated 
	glib, gdk and gtk+ functions using the new API.

	* app/paint-funcs/paint-funcs-rgb.c: removed trailing commas.

2001-08-01  Michael Natterer  <mitch@picman.org>

	* app/base/base.c: g_strdup (g_get_temp_dir ()), may fix an unseen
	crash.

	* libpicmanwidgets/picmanhelpui.[ch]: fixed the help stuff by using
	GtkWidget's new "show_help" signal, which is exactly what we did
	before, only without badly hacking around.
	Renamed picman_help_connect_help_accel() to picman_help_connect()
	because that's what it does.

	* app/devices.c
	* app/errorconsole.c
	* app/interface.c
	* app/gui/about-dialog.c
	* app/gui/edit-commands.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradients-commands.c
	* app/gui/gui.c
	* app/gui/info-dialog.c
	* app/gui/palettes-commands.c
	* app/gui/paths-dialog.c
	* app/gui/select-commands.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmandatafactoryview.c
	* libpicmanwidgets/picmandialog.c
	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gqbist.c
	* plug-ins/flame/flame.c
	* plug-ins/fp/fp_gtk.c
	* plug-ins/script-fu/script-fu-scripts.c: changed accordingly,
	GObject stuff, sprinkled some GTK_STOCK_FOOs, minor cleanups.

2001-07-31  Michael Natterer  <mitch@picman.org>

	* gtkrc: eek, my last change changed the width of all GtkRange
	subclasses, not only GtkScale, fixed now.

	* app/devices.c: use GTK_STOCK_FOO button texts.

	* app/interface.c
	* app/qmask.[ch]: renamed all qmask callbacks to *_callback().

	* app/gui/tool-options-dialog.c: GObject stuff, use
	gtk_dialog_set_has_separator() instead of poking around.

	* app/widgets/picmancolorpanel.c: set panel->color_notebook to NULL
	in "destroy".

	* app/widgets/picmannavigationpreview.c: return TRUE from the
	"expose_event" handler.

	* app/widgets/picmanpreview.c: tiny optimizatin.

2001-07-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanfileselection.c
	* libpicmanwidgets/picmanpixmap.c: replaced deprecated GDK calls
	
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: GObject porting.

2001-07-31  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanexport.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanmenu.c
	* libpicman/picmanpatternmenu.c: GObject porting.

2001-07-31  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h: removed g_signal_handlers_disconnect_by_data
	again. As Owen pointed out, it's generally a bad idea to use it since
	you can't be absolutely sure that no one else has a pointer to the 
	data you are disconnecting.

	* app/gdisplay.c: added the macro here temporarily.
	
	* app/module_db.c
	* app/undo_history.c
	* app/gui/brush-editor.c
	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/pattern-select.c: use g_signal_handlers_disconnect_by_func.
	
	* libpicmanwidgets/picmanbutton.c
	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanfileselection.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpatheditor.c
	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c
	* libpicmanwidgets/picmanwidgets.c: GObject porting.

2001-07-30  Michael Natterer  <mitch@picman.org>

	* gtkrc: set the width of the scrollbar slider to the same value
	as our default font size so the sliders are nicely aligned with
	their descriptive labels.

	* libpicmanwidgets/picmandialog.[ch]
	* libpicmanwidgets/picmanquerybox.[ch]: use GLib-isms and create the
	dialogs' action_area buttons with gtk_dialog_add_button() so we
	can use the GTK_STOCK_FOO buttons and plug in our own icon factory
	later.

	* app/qmask.[ch]: fixed the qmask buttons by applying proper
	GdkEvent callback conventions.

	* libpicmanwidgets/picmancolorbutton.c: NULLify all pointers in
	"destroy".

	* app/gdisplay_ops.c
	* app/picmanhelp.c
	* app/interface.c
	* app/gui/brush-editor.c
	* app/gui/color-notebook.c
	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/gui/resolution-calibrate-dialog.c
	* app/gui/tool-options-dialog.c
	* app/widgets/picmanwidgets-utils.c
	* libpicmanwidgets/picmanunitmenu.c: g_signal_* and GObject stuff,
	use lots of GTK_STOCK_OK and friends instead of _("OK") etc.,
	misc minor cleanups.

2001-07-30  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh: require gettext version 0.38.

	* configure.in: removed some ugly sed hacks that are not any longer 
	needed with recent versions of gettext.

2001-07-29  Michael Natterer  <mitch@picman.org>

	* app/picmanhelp.c: code formating paranoia.

	* app/core/picman.c: one more g_signal_connect().

	* app/tools/picmanmeasuretool.c: a gtk_widget_show() was optimized
	away :)

	* plug-ins/Makefile.am: re-enabled script-fu and dbbrowser.

	* plug-ins/dbbrowser/dbbrowser_utils.[ch]
	* plug-ins/script-fu/script-fu-console.[ch]
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-text-console.[ch]
	* plug-ins/script-fu/script-fu.c: use GtkTextBuffer/GtkTextView
	all over the place. GUI code cleanup in the dbbrowser and
	the script-fu console.

2001-07-29  Sven Neumann  <sven@picman.org>

	* app/devices.c
	* app/disp_callbacks.c
	* app/docindex.[ch]
	* app/file-save.c
	* app/gdisplay.c
	* app/picmanprogress.[ch]
	* app/picmanrc.c
	* app/plug_in.c
	* app/gui/gradient-editor.c
	* app/gui/menus.[ch]: more GObject and const changes.

2001-07-29  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/animationplay.c : REVERTED for all platforms
	which do install headers 'reflect that GTK2 has its
	gdk<x|win32|fb>.h files in the back-end sub directories'
	only the win32 headers aren't installed ...

2001-07-29  Sven Neumann  <sven@picman.org>

	* INSTALL
	* README
	* configure.in
	* picman-1.4.m4: updated pkg-config location and various other tweaks.
	
2001-07-29  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/maze/maze_face.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/sgi/sgi.c: removed compiler warnings by adding G_CALLBACK()
	casts and const declarations.

2001-07-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/AlienMap.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/blinds.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/deinterlace.c
	* plug-ins/common/emboss.c
	* plug-ins/common/film.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/gif.c
	* plug-ins/common/gih.c
	* plug-ins/common/hot.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/lic.c
	* plug-ins/common/mail.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/mblur.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/papertile.c
	* plug-ins/common/pnm.c
	* plug-ins/common/ps.c
	* plug-ins/common/psp.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/struc.c
	* plug-ins/common/sunras.c
	* plug-ins/common/tiff.c
	* plug-ins/common/waves.c
	* plug-ins/common/wind.c
	* plug-ins/common/xbm.c: got rid of lots of compiler warnings by 
	adding G_CALLBACK() casts and some const declarations.

2001-07-29  Sven Neumann  <sven@picman.org>

	* app/docindex.c
	* app/ops_buttons.[ch]: more GObject porting.

2001-07-28  Hans Breuer  <hans@breuer.org>

	* */*/makefile.msc : updated for GTK2 build

	* app/widgets/makefile.msc : (new file) forgot this one last time

	* plug-ins/common/animationplay.c : reflect that GTK2 has its
	gdk<x|win32|fb>.h files in the back-end sub directories

	* plug-ins/common/gif.c :
	* plug-ins/common/jpeg.c :
	* plug-ins/dbbrowser/dbbrowser_utils.c :
	* plug-ins/gap/gap_dbbrowser_utils.c :
	* plug-ims/picmanressionist/presets.c :
	* plug-ims/picmanressionist/imap_setting.c :
	* plug-ims/picmanressionist/imap_source.c :
	* plug-ims/script-fu/script-fu-console.c :
	* plug-ims/script-fu/script-fu-scripts.c : #define GTK_ENABLE_BROKEN
	and include <gtk/gtktext.h> to make them compile/work again

	* plug-ins/common/spheredesigner.c : gtk_color_selction_set_opacity
	renamed to gtk_color_selection_set_current_alpha

	* plug-ins/gflare/gtkmultioptionmenu.c : ported ny removing the
	virtual draw function and style->xthickness and ythickness via
	direct access, klass field isn't available anymore

	* plug-ins/common/nlfilt.c :
	* plug-ims/gap/gap_movdialog.c :
	* plug-ims/picmanressionist/picmanressionist.c : 
	gtk_widget_set_default_visible is neither available nor needed anymore

	* plug-ins/common/plugindetails.c : ported to GtkTextBuffer
	and reflect gtk_paned api changes 

	* plug-ims/picmanressionist/imap_preview.c : replace GTK_WIDGET(a)->klass
	access by GTK_WIDGET_GET_CLASS(a) 

	* plug-ims/picmanressionist/imap_selection.c :
	* plug-ims/picmanressionist/imap_toolbar.c :
	* plug-ims/picmanressionist/imap_tools.c : gtk_toolbar api changes

2001-07-27  Sven Neumann  <sven@picman.org>

	* app/core/core-types.h: 
	defined convenience macro g_signal_handlers_disconnect_by_data().
	Will try to persuade Tim to accept it for GLib.

	* app/module_db.c
	* app/undo_history.c
	* app/core/picman.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushpipe.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandatafactory.c
	* app/core/picmanparasite.c
	* app/gui/brush-editor.c
	* app/gui/brush-select.c
	* app/gui/dialogs.c
	* app/gui/file-open-dialog.c
	* app/gui/gradient-select.c
	* app/gui/gradients-commands.c
	* app/gui/menus.c
	* app/gui/pattern-select.c: GObject porting. 
	Replaced all remainaing gtk_object_[unref|ref] calls by their 
	g_object_ counterparts, except refs that are used with 
	gtk_object_sink().

2001-07-27  Sven Neumann  <sven@picman.org>

	* app/module_db.c
	* app/gui/color-area.c
	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmanbufferview.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmancontainerlistview.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandock.c: more GObject porting

2001-07-27  Michael Natterer  <mitch@picman.org>

	* app/errorconsole.c
	* app/user_install.c: use GtkTextView.

	* app/gui/preferences-dialog.c: use GtkTextView correctly :)

	* app/interface.c: a quick hack which enables setting the
	canvas padding color via gtkrc.

	* app/file-utils.c
	* app/plug_in.c
	* app/pdb/fileops_cmds.c
	* tools/pdbgen/pdb/fileops.pdb: s/g_basename/g_path_get_basename/

	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c: stupid /me disabled all paint tools
	by setting pressure to 0.0 instead of 1.0, fixed now.

2001-07-27  Michael Natterer  <mitch@picman.org>

	* app/gui/indicator-area.c: create/raise the new dialogs, not the
	old ones when clicking on the previews.

	* app/gui/palette-editor.c: some debugging g_print()s to track
	down a funny GTK+ "lets trash const data" bug.

	* app/gui/preferences-dialog.c: replaced deprecated GtkText with
	GtkTextBuffer/GtkTextView.

	* app/widgets/picmandockbook.c: when creating a new dock from a DND
	operation, set it's auto_follow_active and show_image_menu state
	to the source dock's values.

2001-07-26  Sven Neumann  <sven@picman.org>

	* configure.in: check for X, respect X_LIBS when searching for libxpm.
	We can't rely on GTK_LIBS including the X_LIBS any longer.
	
	* app/errorconsole.[ch]: some const fixes.

2001-07-25  Michael Natterer  <mitch@picman.org>

	* gtkrc
	* gtkrc_user: updated for gtk+ 2.0, added a "picman-" prefix to
	all global PICMAN styles.

	* app/app_procs.c: typo.

	* app/user_install.c
	* app/gui/resolution-calibrate-dialog.[ch]: use GtkRcStyle along
	with gtk_widget_get_modifier_style()/gtk_widget_modify_style() as
	recommended instead of messing with the widgets' styles directly.

	* app/core/picmandatalist.[ch]
	* app/core/picmanparasitelist.[ch]
	* app/core/picmanundo.[ch]
	* app/core/picmanundostack.[ch]: GObject porting stuff.

2001-07-25  Sven Neumann  <sven@picman.org>

	* app/devices.c: fixed typo.
	
	* app/gdisplay.c
	* app/undo_history.c
	* app/user_install.c
	* app/gui/about-dialog.c
	* app/gui/color-area.c
	* app/gui/gradient-editor.c
	* app/gui/gui.c
	* app/gui/paths-dialog.c
	* app/gui/splash.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaninktool.c
	* app/tools/picmantexttool.c: 
	s/gdk_[bit|pix]map_unref/gdk_drawable_unref/
	
	* app/xcf/xcf-load.c: use GObject functions

	* plug-ins/common/animationplay.c: include GDK backend specific 
	headers

2001-07-25  Sven Neumann  <sven@picman.org>

	* configure.in: only build X11 specific plug-ins and tools if 
	building for GTK+ on X11.

2001-07-25  Michael Natterer  <mitch@picman.org>

	* HACKING
	* INSTALL: updated, mention pkg-config.

	* app/gdisplay_ops.c
	* app/gui/resize-dialog.c
	* app/gui/toolbox.c: more GObject porting and const stuff.

2001-07-25  Sven Neumann  <sven@picman.org>

	* configure.in: check for pkg-config (>= 0.7)
	
	* picmantool-1.4.in: use pkg-config instead of glib-config and 
	gtk-config.

2001-07-25  Sven Neumann  <sven@picman.org>

	* app_procs.c
	* errors.c
	* errors.h
	* file-save.c
	* gdisplay.c
	* module_db.c
	* undo.c: use GObject functions and const fixes.

2001-07-25  Michael Natterer  <mitch@picman.org>

	* app/gui/brush-select.c
	* app/gui/channels-commands.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/offset-dialog.c
	* app/gui/palette-import-dialog.c
	* app/gui/paths-dialog.c
	* app/gui/preferences-dialog.c: use GObject functions, stuff.

2001-07-25  Sven Neumann  <sven@picman.org>

	* app/nav_window.c
	* app/user_install.c
	* app/pdb/color_cmds.c
	* app/pdb/selection_cmds.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c
	* app/tools/tool_manager.c
	* app/tools/transform_options.c
	* app/widgets/picmandnd.c
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/selection.pdb: use GObject functions.

2001-07-25  Sven Neumann  <sven@picman.org>

	* app/gximage.c: replaced some deprecated gdk functions.
	
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainermenuimpl.c
	* app/widgets/picmancursor.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmanhistogramview.c
	* app/widgets/picmanlistitem.c
	* app/widgets/picmanmenuitem.c
	* app/widgets/picmannavigationpreview.c
	* app/widgets/picmanpreview.c
	* app/widgets/picmanwidgets-utils.c: more work on porting to GObject.

2001-07-25  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-constructors.c
	* app/widgets/picmandockable.c: removed debugging g_print().

	* app/widgets/picmandock.c: ditto, fixed a crash caused by some
	intermediate porting hack.

2001-07-24  Michael Natterer  <mitch@picman.org>

	Port to glib/gtk+ 2.0 episode I (every segfault has it's beginning)

	* configure.in: require glib/gtk+ >= 1.3.7, commented out the
	gtkxmhtml stuff.

	From now on, you will need glib, pango, atk and gtk+ HEAD from CVS
	to hack or use PICMAN HEAD.

	Beware, it crashes randomly :)

	* app/core/Makefile.am
	* app/core/picmanmarshal.list: new file plus rules to generate
	picmanmarshal.[ch] from it.

	* app/core/*
	* app/tools/*
	* app/widgets/*
	* libpicmanwidgets/*: started to use the glib object system. All
	core/ objects are still gtk objects however. All signals are
	created using g_signal_new(). There are many gtk+ artefacts left.
	Finally, we will _not_ use the gtk_signal_foo() wrappers and
	friends any more.

	* app/colormaps.c
	* app/devices.[ch]
	* app/disp_callbacks.c
	* app/errorconsole.c
	* app/file-save.[ch]
	* app/interface.c
	* app/module_db.c
	* app/nav_window.c
	* app/ops_buttons.c
	* app/scroll.c
	* app/user_install.c
	* app/gui/about-dialog.c
	* app/gui/brush-editor.c
	* app/gui/brushes-commands.c
	* app/gui/color-notebook.c
	* app/gui/colormap-dialog.c
	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-commands.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gradients-commands.c
	* app/gui/image-commands.c
	* app/gui/info-dialog.[ch]
	* app/gui/layer-select.c
	* app/gui/layers-commands.c
	* app/gui/menus.c
	* app/gui/offset-dialog.c
	* app/gui/palette-editor.c
	* app/gui/palettes-commands.c
	* app/gui/patterns-commands.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.[ch]
	* app/gui/splash.c
	* app/gui/tips-dialog.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox.c
	* app/gui/tools-commands.c
	* libpicman/picmanbrushmenu.c
	* libpicman/picmanmenu.c
	* libpicman/picmanpatternmenu.c
	* libpicman/picmanui.c
	* libpicmanbase/picmanenv.c: tons and tons of changes like "const
	gchar*", switch from GdkDeviceInfo to GdkDevice (very incomplete
	and currently disables), lots of s/gtk_signal/g_signal/,
	removal/replacement of deprecated stuff,
	s/GtkSignalFunc/GCallback/ and lots of small changes and fixes 
	while I was on it, zillions of warnings left...

	* modules/Makefile.am: disabled the water color selector
	temporarily (XInput issues).

	* plug-ins/Makefile.am
	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl: simply excluded all plug-ins
	which did not build (including Script-Fu). They are trivial to
	fix.

2001-07-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/winclipboard.c
	* plug-ins/gap/gap_filter_foreach.c
	* plug-ins/imagemap/imap_cmd_guides.c
	* plug-ins/sel2path/pxl-outline.c: marked missing strings for 
	translation (patch from "Iccii" <iccii@hotmail.com>).

2001-07-22  Hans Breuer  <hans@breuer.org>

	* app/*/makefile.msc : 
	* plug-ins/makefile.msc	: 
	* libpicman/picman.def :
	* libpicmanwidgets/picmanwidgets.def : updated

	* makefile.msc :
	* app/xcf/makefile.msc :
	* regexrepl/makefile.msc : new files
	
	* app/base/base-config.c : a work-around for a gccism with
	structure initialization

	* app/core/picman.c :
	* app/core/picmanimage-new.c :
	* app/gui/color-area.c
	* app/widgets/picmandialogfactory.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf-write.c
	* plug-ins/common/plasma.c :
	* plug-ins/flame/libifs.c : added <string.h> for strlen(), strcpy(),
	memcpy(), memcmp() and friends 	

	* plug-ins/imagemap/imap_rectangle.c :
	* plug-ins/ifscompose/ifscompose_storage.c : added <stdlib.h> for abs()

	* plug-ins/common/spheredesigner.c : reflect renaming of drawable.id
	drawable.drawable_id 

	* plug-ins/script-fu/siod-wrapper.c : <string.h> and conditional use
	of script_fu_server_quit () cause there is not yet script-fu server
	on win32.

2001-07-22  Stanislav Brabec  <utx@penguin.cz>

	* plugins/common/despeckle.c: Reflect my fix from 2001-03-01
	(range limits) in script-fu comments.

2001-07-20  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/dialog_handler.[ch]: removed.

	* app/widgets/picmandialogfactory.[ch]: added the missing features
	from the dialog_handler: idle/unidle all dialogs and the show_all
	-> hide_all -> show_toolbox -> show_all cycling (a bit ugly
	currently because the toolbox's factory and it's identifier has to
	be passed to picman_dialog_factories_toggle()).

	* app/disp_callbacks.c
	* app/gui/gui.c: call the new dialog factory class methods.

	* app/devices.c
	* app/docindex.c
	* app/errorconsole.c
	* app/nav_window.c
	* app/undo_history.c
	* app/gui/info-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c: currently "unmanaged" because they
	are not yet registered with a dialog factory.

	* app/gui/menus.c: ditto for the tearoff menus.

	* app/gui/brush-select.c
	* app/gui/colormap-dialog.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox.c: these are already factory created so toggling
	and (un)idling works like before.

	* app/widgets/picmandock.c: reduced the minimal width from 280 to 250.

	* app/widgets/picmanlayerlistview.c: use a toggle button instead of
	a check button for "Keep transp.".

2001-07-19  Sven Neumann  <sven@picman.org>

	* configure.in: ran autoupdate on this file
	
	* app/xcf/xcf-load.c
	* app/xcf/xcf-private.h
	* app/xcf/xcf-save.c: code cleanup, no changes

2001-07-18  Michael Natterer  <mitch@picman.org>

	* app/batch.c: bahave like the old batch code and call
	app_exit(FALSE) when reading from STDIN is finished.

2001-07-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-text-console.c: stop reading on EOF

	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu.c: some small cleanups

2001-07-18  Michael Natterer  <mitch@picman.org>

	* app/batch.[ch]: seems Mathieu messed up the last commit :) Added
	these two files back from the Attic, removed the old STDIN code
	and added a small hack which calls "extension-script-fu-text-console"

	* app/main.c: reverted to the last version, so old and new batch
	mode are both there now.

2001-07-17  Mathieu Lacage  <mathieu@gnome.org>

	* app/batch.c: new code to call the script_fuc_text_console pdb function.
	* app/main.c: (main): remove batch command code.

	* plug-ins/script-fu/Makefile.am: add siod-wrapper.h/c
	* plug-ins/script-fu/script-fu-console.c:
	(script_fu_cc_key_function), 
	(script_fu_open_siod_console),
	(script_fu_close_siod_console):
	* plug-ins/script-fu/script-fu-scripts.h: 
	* plug-ins/script-fu/script-fu-server.c: 
	(script_fu_server_quit),
	(script_fu_server_get_mode), 
	(execute_command):
	Replace all direct calls to the scheme interpreter with calls to the siod-wrapper.
	* plug-ins/script-fu/script-fu-console.h: remove run_eval.
	* plug-ins/script-fu/script-fu-server.h:
	* plug-ins/script-fu/script-fu-text-console.c:
	(script_fu_text_console_run), 
	(read_command),
	(script_fu_text_console_interface):
	The actual new text console.
	* plug-ins/script-fu/script-fu-text-console.h: header.
	* plug-ins/script-fu/script-fu.c: 
	(script_fu_quit),
	(script_fu_query), 
	(script_fu_run): rename to better words.
	move most of the code to siod-wrapper.c/h
	* plug-ins/script-fu/siod-wrapper.c: 
	(siod_get_output_file),
	(siod_set_output_file), 
	(siod_get_verbose_level),
	(siod_set_verbose_level), 
	(siod_print_welcome),
	(siod_interpret_string), 
	(siod_get_error_msg),
	(siod_get_success_msg), 
	(siod_init), 
	(init_procedures),
	(init_constants), 
	(convert_string), 
	(sputs_fcn), 
	(lprin1s),
	(marshall_proc_db_call), 
	(script_fu_register_call),
	(script_fu_quit_call):
	All the funcitons dealing with the internals of the scheme interpreter.
	* plug-ins/script-fu/siod-wrapper.h: the header.

2001-07-17  Michael Natterer  <mitch@picman.org>

	* app/path.[ch]: removed path_to_beziersel() so this file can be
	safely included from core/.

	* app/tools/picmanbezierselecttool.[ch]: added it here.

	* app/core/core-types.h: added a PicmanToolOptions typedef. Removes
	deps into tools/ and will later be a core object anyway.

	* app/tools/tools-types.h: removed the ToolOptions typedef here.

	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage.c
	* app/core/picmantoolinfo.[ch]: removed deps into tools/, misc stuff.

	* app/tools/tool_manager.[ch]: some ugly temp hacks. Please ignore.

	* app/widgets/picmandialogfactory.[ch]: added a "remember_if_open" field
	to the PicmanDialogFactoryEntry so we can manage dialogs which should
	not be re-opened on startup.

	* app/gui/dialogs-constructors.c
	* app/gui/dialogs.c: register & create all editor dialog with the
	"global_dialog_factory".

	* app/gui/tool-options-dialog.c
	* app/tools/*: s/ToolOptions/PicmanToolOptions/

2001-07-15  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanwire.c: remove the usage of printf()/scanf()
	when sending doubles over the wire. Instead, rely on the memory
	layout of gdouble being IEEE compliant and transmit 8 bytes in
	network byte order.

	* libpicmanbase/picmanprotocol.h: increase GP_VERSION because this
	makes the wire protocol binary incompatible.

	* app/main.c
	* libpicman/picman.c: removed the setlocate(LC_NUMERIC,"C") workaround.

2001-07-15  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c: don't use the global "the_picman" variable.

	* app/core/picmanimage-convert.c: don't update the display here.

	* app/gui/gui.c: connect to the images' "mode_changed" signal
	and update here.

	* app/gui/brush-editor.[ch]
	* app/gui/gradient-editor.[ch]
	* app/gui/palette-editor.[ch]: pass a "Picman" pointer to all
	editors. Added an palette_name entry to the palette editor.

	* app/gui/colormap-dialog.[ch]: removed all the dialog stuff and
	made the constructor return a vbox so it can be integrated in a
	dockable. Lots of cleanup and removal of anqiuqe aretfacts.

	* app/gui/dialogs-constructors.[ch]: wrap the colormap dialog in
	a dockable.

	* app/gui/dialogs-commands.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c: integrate the new dockable, made the "Brushes.."
	etc. menu entries create dockbles. Moved the old dialogs and the
	test menu entries to "Old + Testing" and removed N_() so the .po
	files stay cruft-free.

	* app/gui/test-commands.[ch]: removed lots of stuff which is not
	"testing" any more.

2001-07-14  Sven Neumann  <sven@picman.org>

	* app/pdb/display_cmds.c
	* tools/pdbgen/pdb/display.pdb (display_new_invoker): removed 
	unnecessary check for image being nonempty.

2001-07-14  Fatih Demir <kabalak@gtranslator.org>

	* tips/Makefile.am|makefile.mingw: Added picman_tips.tr.txt to the
	targets and re-ordered the tips files listings.

	* tips/picman_tips.tr.txt: Added Turkish tips file from Alper Ersoy.

2001-07-13  Michael Natterer  <mitch@picman.org>

	* app/appenv.h
	* app/main.c: removed "use_mmx" and the MMX detection.

	* app/base/Makefile.am: build the MMX detection unconditionally
	as it's already #ifdef'ed in the source.

	* app/base/detect-mmx.h: added a header for detect-mmx.S

	* app/base/base-config.[ch]: added the "use_mmx" boolean.

	* app/base/base.c: call intel_cpu_features() here.

	* app/paint-funcs/paint-funcs.c: #include "base/base-config.h".

	* app/floating_sel.c
	* app/core/picmanimage.c: removed commented out cruft.

	* app/core/picmanlayer.c: picman_layer_new_from_tiles(): pass the
	gimage instead of NULL to picman_layer_new() because layers have to
	be created in an image context now
	(checked picman_layer_new_from_tile()'s callers if this is
	semantically correct).

2001-07-12  Dave Neary  <dneary@eircom.net>

	* po/POTFILES.in: One line fix to fix dependency problem.
	
2001-07-12  Sven Neumann  <sven@picman.org>

	* app/regexrepl.c
	* app/regexrepl.h: removed here ...

	* plug-ins/script-fu/regexrepl.c
	* plug-ins/script-fu/regexrepl.h: ... and here ...

	* regexrepl/Makefile.am
	* regexrepl/regex.c
	* regexrepl/regex.h: ... and added here again.
	
	* Makefile.am
	* configure.in
	* app/Makefile.am
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* plug-ins/script-fu/Makefile.am
	* plug-ins/script-fu/interp_regex.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

2001-07-12  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/detect_mmx.S: removed.

	* app/base/Makefile.am
	* app/base/detect-mmx.S: added.

2001-07-11  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanunit.c
	* app/unitrc.h: removed...

	* app/core/Makefile.am
	* app/core/picmanunit.[ch]: ...re-added here.

	* app/core/picman.[ch]: added the image and drawable hash tables,
	next_image_ID, next_guide_ID and next_drawable_ID, added a
	PicmanCoreConfig pointer which is now initalized dynamically.

	* app/core/picmancoreconfig.[ch]: don't provide a global core_config
	variable any more (need to access picman->config now).

	* app/gdisplay.[ch]
	* app/core/picmandrawable.[ch]
	* app/core/picmanimage.[ch]: removed all global variables from
	picmanimage.c and picmandrawable.c, pass a Picman* to all *_get_by_ID()
	functions.

	* tools/pdbgen/app.pl: pass Picman* to all _get_by_ID() functions.

	* app/app_procs.c
	* app/file-open.c
	* app/file-save.c
	* app/picmanrc.c
	* app/libpicman_glue.c
	* app/module_db.c
	* app/plug_in.c
	* app/undo.c
	* app/user_install.c
	* app/core/core-types.h
	* app/core/picmancontext.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-new.c
	* app/core/picmanparasite.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/info-window.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c
	* app/widgets/picmandnd.c

	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c
	* app/pdb/undo_cmds.c
	* app/pdb/unit_cmds.c

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/unit.pdb: changed accordingly.

2001-07-10  Sven Neumann  <sven@picman.org>

	Bugfixes from the stable branch:
	
	* plug-ins/common/bz2.c
	* plug-ins/common/gz.c: a fix for bug #57217 based on a patch from
	Raphael Quinet.

	* plug-ins/gap/gap_lib.c (p_file_copy): open files in binary mode. 
	A patch from Wolfgang Hofer that possibly fixes bug #52890.

	* tools/Makefile.am: added picmanpath2svg.py to EXTRA_DIST.
	
2001-07-10  Michael Natterer  <mitch@picman.org>

	* app/app_procs.[ch]: removed the picman_busy boolean, check whether
	user_installation is needed here, not in user_install.c, parse
	gtkrc an friends only if(!no_interface), create the Picman object
	before parsing picman's rc files and pass it to the parse functions,
	many other cleanups.

	* app/appenums.h: added MessageHandlerType and StackTraceMode.
	
	* app/appenv.h: removed MessageHandlerType, declare all global
	variables from main.c (no more hidden global stuff please).

	* app/errors.[ch]: added the fatal message func here (from main.c),
	removed the StackTraceMode enum.

	* app/picmanrc.[ch]: renamed functions to picmanrc_*(), pass a Picman
	pointer to some functions.

	* app/picmanunit.c
	* app/unitrc.h: ok, this is ugly: renamed all functions to
	_picman_unit_*() and made them public. The unit list is part
	of the Picman object now, so pass a Picman* to all functions.

	* app/libpicman_glue.[ch]: added EEKy wrappers for all picman_unit_*()
	functions which are used by widgets.

	* app/main.c: cleaned up the global variables, removed the fatal
	message handler, call app_init() directly, not via the
	user_install stuff, misc. cleanups.

	* app/user_install.[ch]: removed the check if user_installation is
	needed (done by app_procs.c now).

	* app/core/picman.[ch]: added the user_unit list and the "busy"
	boolean. Moved picman_[set|unset]_busy() here. Added
	picman_initialize() which is called after unitrc and picmanrc are
	parsed.

	* app/batch.c
	* app/colormaps.c
	* app/devices.c
	* app/disp_callbacks.c
	* app/gdisplay_ops.c
	* app/picmanhelp.c
	* app/module_db.c
	* app/nav_window.c
	* app/plug_in.c
	* app/core/picmancontext.c
	* app/core/picmandatafiles.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage.c
	* app/core/picmanparasite.c
	* app/core/picmanparasitelist.h
	* app/gui/file-open-dialog.c
	* app/gui/gui.[ch]
	* app/gui/info-dialog.c
	* app/gui/info-window.c
	* app/gui/preferences-dialog.c
	* app/gui/session.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmantransformtool.c
	* app/tools/tool_manager.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancursor.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/app.pl
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/unit.pdb
	* app/pdb/image_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/unit_cmds.c: changed accordingly, minor cleanups.

2001-07-09  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/datafiles.[ch]
	* app/picmanparasite.[ch]
	* app/parasitelist.[ch]: removed...

	* app/core/Makefile.am
	* app/core/picmandatafiles.[ch]
	* app/core/picmanparasite.[ch]
	* app/core/picmanparasitelist.[ch]: ...and added here.

	* app/picmanrc.c
	* app/module_db.c
	* app/plug_in.c
	* app/undo.c
	* app/core/picman.c
	* app/core/picmanchannel.c
	* app/core/picmandatafactory.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/parasite.pdb
	* app/pdb/parasite_cmds.c: changed #include's accordingly.

2001-07-09  Dave Neary  <dneary@eircom.net>

	* app/plug_in.c: One-line fix which is needed, but never showed 
	up before. Initialise a string to NULL, to avoid a !=NULL
	mishap later on. 
	
2001-07-09  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: added a (commented out) function to open
	files (to get rid of including gui/file-open-dialog.h)

	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]: renamed all functions because they
	are no callbacks any more. Removed the _by_extension() callbacks.

	* app/gui/file-commands.[ch]: added the
	file_[open|save]_by_extension() callbaks here along with some
	other stuff which has nothing to do with the file dialogs.

	* app/gui/menus.c: added a helper function to create an item
	factory, cleanup.

	* app/gui/palette-editor.[ch]: contains only the editor for a
	single palette now (removed the notebook and the palette list).
	Renamed all functions to palette_editor_*(). Will be made a
	dockable later.

	* app/gui/palette-select.[ch]: made it work like the other
	selection dialogs.

	* app/app_procs.c
	* app/docindex.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/widgets/picmandnd.c: changed accordingly.

2001-07-08  Michael Natterer  <mitch@picman.org>

	* app/disp_callbacks.c: the active_tool may change in the middle
	of gdisplay_canvas_events(), so re-get it after using it for
	cursor_update.

	* app/base/boundary.c: made some global variables local.

	* app/core/picmandrawable.c: don't call picman_drawable_set_visible()
	in picman_drawable_configure() because we don't want signal
	emissions while configuring the drawable.

	* app/gui/Makefile.am
	* app/gui/brushes-commands.[ch]
	* app/gui/data-commands.[ch]
	* app/gui/gradients-commands.[ch]
	* app/gui/palettes-commands.[ch]
	* app/gui/patterns-commands.[ch]: new files for new new item
	factories' callbacks.

	* app/gui/menus.[ch]: added context menus for brushes, patterns, ...

	* app/gui/gradient-editor.c
	* app/gui/palette-editor.c: removed the "Save as POV", "Import
	Palette" and "Merge Palattes" buttons as they are item factory
	callbacks now.

	* app/widgets/picmanbrushfactoryview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmandatafactoryview.[ch]: pass a
	"PicmanContainerContextFunc" pointer to all PicmanContainerEditor
	subclasses' constructors. Use the function to show the context
	menu.

	* app/widgets/picmancontainergridview.c: dispatch the previews'
	"context" signal.

	* app/widgets/picmanpreview.[ch]: new signal "context" which is
	emitted on right-click.

	* app/gui/brush-select.c
	* app/gui/dialogs-constructors.c
	* app/gui/gradient-select.c
	* app/gui/layers-commands.c
	* app/gui/palette-select.c
	* app/gui/pattern-select.c
	* app/gui/test-commands.c: changed accordingly.

2001-07-08  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/drawable.[ch]: removed.

	* app/core/picmandrawable.[ch]: added the functions here. Made an
	end to the myth that FG/BG and the undo system (!!!) are not
	really part of the core.

	* app/disp_callbacks.c
	* app/floating_sel.c
	* app/image_map.c
	* app/qmask.c
	* app/undo.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-desaturate.c
	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-invert.c
	* app/core/picmandrawable-offset.c
	* app/core/picmanedit.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage.[ch]
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/gui/channels-commands.c
	* app/gui/gui.c
	* app/gui/layers-commands.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/tools/tool_manager.c
	* app/widgets/picmanchannellistitem.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandrawablelistitem.c
	* app/widgets/picmanlayerlistitem.c
	* app/widgets/picmanlayerlistview.c
	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb: changed accordingly. Misc small
	fixes and cleanups.

2001-07-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/gimage.[ch]: removed.

	* app/core/picman.c: s/gimage_new/picman_image_new/

	* app/gui/gui.c
	* app/tools/tool_manager.c: added the handlers from gimage.c

2001-07-07  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.[ch]: put all tool_manager variables into
	a struct which is attached to a "Picman". Pass a Picman* to all
	tool_manager functions.

	* app/disp_callbacks.c
	* app/gdisplay.c
	* app/gimage.c
	* app/scale.c
	* app/scroll.c
	* app/undo.c
	* app/gui/convert-dialog.c
	* app/gui/edit-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/tools-commands.c: changed accordingly.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantool.c
	* app/tools/picmantransformtool.c: mostly bad hacks for tool dialogs
	which exist without a real context. Needs some more review.

2001-07-07  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-crop.[ch]: new files for picman_image_crop()
	and picman_image_crop_auto_shrink() (should share large portions of
	code with picman_image_resize()).

	* app/tools/picmancroptool.[ch]: removed here.

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/tools.pdb: picman_crop --> picman_image_crop

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/tools_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmantools_pdb.[ch]: regenerated.

	* plug-ins/common/autocrop.c
	* plug-ins/common/gif.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/zealouscrop.c
	* plug-ins/perl/examples/image_tile
	* plug-ins/script-fu/scripts/add-bevel.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm
	* plug-ins/script-fu/scripts/slide.scm: changed accordingly. Some
	cleanups in the plug-ins.

2001-07-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/context_manager.[ch]: removed.

	* app/app_procs.c: call tool_mananger instead of context_manager
	functions, pass "the_picman" to some more functions.

	* app/drawable.[ch]: pass a PicmanContext to drawable_fill().

	* app/errors.c: behave according to "stack_trace_mode" when using
	the debugging signal handler.

	* app/picmanrc.[ch]: removed the core/ config variables.

	* app/selection.c: set the selection's state to INVISIBLE in
	selection_pause().

	* app/core/Makefile.am
	* app/core/picmancoreconfig.[ch]: new files (the configuration
	variables used by core/).

	* app/core/picmancontext.[ch]: removed the global contexts (user,
	default, ...) and their functions. It's no longer possible to pass
	NULL to the context functions to manipulate the current context
	(picmancontext.c doesn't know the current context any more).

	* app/core/picman.[ch]: added them here. The functions are now called
	picman_[set|get]_*_context(). Added picman_create_context() which is
	the only function to create contexts now.

	* app/gui/dialogs.[ch]
	* app/gui/gui.[ch]: pass "picman" to all functions.

	* app/tools/tool_manager.[ch]
	* app/tools/tools.[ch]: pass "picman" to lots of functions. Added
	the "global_tool_context" logic and the global/non-global paint
	options switching from the context_manager. Pass "picman" to all
	tools' "register" functions.

	* app/tools/*: changed accordingly.

	* app/devices.c
	* app/disp_callbacks.c
	* app/file-open.[ch]
	* app/file-save.c
	* app/gdisplay.c
	* app/gimage.c
	* app/libpicman_glue.c
	* app/module_db.c
	* app/nav_window.c
	* app/plug_in.c
	* app/qmask.c
	* app/undo.c
	* app/base/base-config.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandrawable-offset.c
	* app/core/picmangradient.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage.c
	* app/core/picmanpalette.c
	* app/core/picmantoolinfo.[ch]
	* app/core/picmanundo.c
	* app/gui/brush-select.c
	* app/gui/channels-commands.c
	* app/gui/color-area.c
	* app/gui/dialogs-constructors.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gradient-select.c
	* app/gui/info-window.c
	* app/gui/layers-commands.c
	* app/gui/menus.c
	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.c
	* app/gui/palette-select.c
	* app/gui/paths-dialog.c
	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c
	* app/gui/resize-dialog.c
	* app/gui/test-commands.c
	* app/gui/tool-options-dialog.c
	* app/gui/toolbox.c
	* app/gui/tools-commands.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanlayerlistview.c
	* app/pdb/brushes_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/patterns_cmds.c
	* app/pdb/procedural_db.c
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/patterns.pdb: changed accordingly: remove usage
	of picman_context_[get|set]_*(NULL), create contexts with
	picman_create_context(). Get the user/current context with
	picman_get_[user|current]_context(). Added/removed access to the
	global "the_picman" variable in some places. Get the core's config
	variables from "core_config".
	
2001-07-06  Dave Neary  <dneary@eircom.net>

	* app/picmanrc.c: Removed some C89 & gcc extention stuff which broke
	the build on some platforms.
	
2001-07-06  Dave Neary  <dneary@eircom.net>

	* po/POTFILES.in: Changed app/image_new.c to 
	app/core/picmanimage-new.c to get the build working.

2001-07-05  Michael Natterer  <mitch@picman.org>

	* app/gimage.c: don't add the image to the image container,
	don't call undo_free().

	* app/core/picman.[ch]: add new images to picman->images, optionally
	attach the comment parasite.

	* app/core/picmanedit.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-new.c
	* app/gui/file-open-dialog.c
	* app/gui/toolbox.c
	* tools/pdbgen/pdb/image.pdb
	* app/pdb/image_cmds.c
	* app/xcf/xcf-load.c: call picman_create_image() and/or
	picman_create_display(), don't attach a comment parasite.

	* app/core/picmanimage.c: call undo_free() in "destroy".

	* app/file-open.c
	* app/gui/palette-import-dialog.c
	* app/xcf/xcf-save.c: don't #include "gimage.h"

2001-07-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/image_new.[ch]: removed...

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimage-new.[ch]: ...and (partly) added here.

	* app/core/picman.[ch]: added picman_create_image() which will be the
	_only_ place to get new images from soon.
	Added  a "create_display_func" function pointer...

	* app/gui/gui.[ch]: ...which gets initialized here.

	This way the core can create displays without depending on the
	interface.

	* app/app_procs.c
	* app/apptypes.h
	* app/core/picmanedit.c
	* app/gui/file-commands.c
	* app/gui/file-new-dialog.[ch]: changed accordingly.

2001-07-05  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: renamed picman_initialize() to picman_restore()
	because it loads all kinds of data. Added picman_shutdown() to save
	the data. Added the global parasite list.

	* app/apptypes.h: removed ParasiteList.

	* app/core/core-types.h: added PicmanParasiteList.

	* app/picmanparasite.[ch]: removed the global parasite list.

	* app/parasitelist.[ch]: s/ParasiteList/PicmanParasiteList/
	s/parasite_list_*/picman_patasite_list_*/

	* app/core/picmandatafactory.c: don't save the data in
	picman_data_factory_data_free().

	* app/app_procs.c
	* app/picmanrc.c
	* app/undo.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable.[ch]
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage.[ch]
	* app/core/picmanlayer.c
	* app/pdb/brushes_cmds.c
	* app/pdb/parasite_cmds.c
	* app/widgets/picmandatafactoryview.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/parasite.pdb: changed accordingly.

2001-07-04  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picman.[ch]: added an "application object" called Picman.

	Currently, it contains the image list, the clipboard, the data
	factories, the procedural hashtable and the tool info list.  It's
	the toplevel object of the core object system. Finally, creating a
	Picman object will return a standalone picman core engine instance
	with no other global states/variables involved.

	* app/app_procs.[ch]: allocate a "Picman" instance called "the_picman" :)
	Removed stuff which is now done by the "Picman" object. Merged
	picman_init() into app_init() because picman_init() is taken now.

	* app/context_manager.[ch]: removed stuff done by "Picman".

	* app/batch.[ch]
	* app/gimage.[ch]
	* app/xcf/xcf-load.[ch]
	* app/xcf/xcf.[ch]
	* app/core/picmanedit.[ch]
	* app/tools/tool_manager.[ch]: pass around an additional "Picman"
	argument.

	* app/pdb/procedural_db.[ch]: pass a "Picman" pointer as first
	parameter to all internal procedures and to all procedural_db_*
	functions.

	* app/core/picmancontext.[ch]
	* app/core/picmanimage.[ch]: added a "Picman" pointer to the structs.

	* app/devices.c
	* app/errors.c
	* app/file-open.c
	* app/file-save.c
	* app/picmanhelp.c
	* app/picmanunit.c
	* app/image_new.c
	* app/main.c
	* app/nav_window.c
	* app/plug_in.c
	* app/base/base.c
	* app/core/picmandatafactory.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-mask.c
	* app/core/picmantoolinfo.[ch]
	* app/gui/brush-select.c
	* app/gui/convert-dialog.c
	* app/gui/dialogs-constructors.c
	* app/gui/edit-commands.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/gradient-select.c
	* app/gui/gui.c
	* app/gui/image-commands.c
	* app/gui/info-window.c
	* app/gui/menus.c
	* app/gui/palette-editor.c
	* app/gui/palette-import-dialog.c
	* app/gui/palette-select.c
	* app/gui/paths-dialog.c
	* app/gui/pattern-select.c
	* app/gui/preferences-dialog.c
	* app/gui/test-commands.c
	* app/gui/toolbox.c
	* app/gui/tools-commands.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanpainttool.h
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.h
	* app/widgets/picmanbufferview.c
	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmancursor.c
	* app/widgets/picmandnd.c
	* app/widgets/picmanimagedock.c: changed accordingly. Cleaned up
	lots of includes. Many files still access the global "the_picman"
	variable exported by app_procs.h.

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly. Don't
	use "the_picman" here because all procedures get passed a "Picman"
	pointer now.

	* app/pdb/*: regenerated.

2001-07-04  Dave Neary  <dneary@eircom.net>

	* po/POTFILESin: Changed to reflect some moved/removed files.

2001-07-03  Michael Natterer  <mitch@picman.org>

	* configure.in: new directory app/xcf/

	* app/Makefile.am
	* app/global_edit.[ch]
	* app/xcf.[ch]: removed.

	* app/core/Makefile.am
	* app/core/picmanedit.[ch]: added here...

	* app/xcf/.cvsignore
	* app/xcf/Makefile.am
	* app/xcf/xcf-load.[ch]
	* app/xcf/xcf-private.h
	* app/xcf/xcf-read.[ch]
	* app/xcf/xcf-save.[ch]
	* app/xcf/xcf-seek.[ch]
	* app/xcf/xcf-write.[ch]
	* app/xcf/xcf.[ch]: ...and here (chopped up).

	* app/app_procs.c
	* app/disp_callbacks.c
	* app/floating_sel.c
	* app/gui/edit-commands.c
	* app/gui/toolbox.c
	* app/pdb/edit_cmds.c
	* app/widgets/picmanbufferview.c
	* tools/pdbgen/pdb/edit.pdb: changed accordingly.

2001-07-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/xwd.c: applied patch from Peter Kirchgessner 
	<peter@kirchgessner.net> that fixes bug #56830.

	* app/global_edit.c: attach default comment to image created by
	picman_edit_paste_as_new().

	Both changes merged from stable branch.

2001-07-02  Michael Natterer  <mitch@picman.org>

	* app/global_edit.c: allow a NULL gimage argument for
	picman_edit_paste_as_new() (don't set resolution and unit).

	* app/disp_callbacks.[ch]
	* app/interface.c: allow dropping of a PicmanBuffer (pastes the
	buffer).

	* app/gui/toolbox.c: ditto (creates a new image).

2001-07-02  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* help/*: removed all help files. They will be distributed as a
	separate package in the future.

2001-07-02  Nick Lamb  <njl195@zepler.org.uk>

        * plug-ins/common/png.c: Change PNG defaults (no 1.0 gamma chunk)

2001-07-02  Sven Neumann  <sven@picman.org>

	* picmantool-1.4.in
	* plug-ins/*/Makefile.am
	* plug-ins/common/mkgen.pl: merged fixes from stable branch
	
2001-07-02  Michael Natterer  <mitch@picman.org>

	* app/gui/dialogs-commands.[ch]
	* app/gui/menus.c: added dialogs_toggle_auto_cmd_callback() which
	toggles PicmanImageDock's "Auto" button.

	* app/gui/dialogs.c: ref/sink the global dialog factories.

	* app/widgets/picmandialogfactory.[ch]: added some comments, some
	cleanups and additional checks. Factored out the "aux-info" stuff
	to separate functions.

	* app/widgets/picmandockbook.c: set the state of the "Auto Follow
	Active Image" menu item.

	* app/widgets/picmanimagedock.[ch]: added a gboolean for
	"show_image_menu" so we don't need to fiddle around with the
	widgets to get this info. Added
	picman_image_dock_set_auto_follow_active().

2001-07-01  Sven Neumann  <sven@picman.org>

	* acconfig.h: add HAVE_FINITE and HAVE_ISFINITE 
	(fix from stable branch)

2001-06-29  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: removed PicmanFillType.

	* app/picmanrc.c: parse the session-info's new "aux-info" field.

	* app/global_edit.[ch]: removed the old "Paste Named" dialog and
	prefixed all functions with "picman_".

	* app/core/core-types.h: added PicmanFillType.

	* app/core/picmanbrush.[ch]: new signal "spacing_changed".

	* app/gui/Makefile.am
	* app/gui/tools-commands.[ch]: one more file cut out of commands.[ch].

	* app/gui/commands.[ch]: removed the tools stuff here.

	* app/gui/brush-select.[ch]
	* app/gui/dialogs-constructors.c: use the new PicmanBrushFactoryView
	(see below).

	* app/gui/dialogs-commands.[ch]
	* app/gui/menus.[ch]:

	- Made it 64bit safe again by passing the dialog factory's
	  identifiers as GQuarks, not as guints created by GPOINTER_TO_UINT().
	- Added a "gchar *quark_string" field to PicmanItemFactoryEntry
	  which gets transformed into a GQuark by menus_create_item().
	- Added SEPARATOR() and BRANCH() macros which make the *_entries[]
	  arrays more readable.
	- Added a menu item to show/hide PicmanImageDock's image menu.
	- Removed file_last_opened_cmd_callback().

	* app/gui/edit-commands.c: the global_edit functions are "picman_"
	prefixed now.

	* app/gui/file-commands.[ch]: added file_last_opened_cmd_callback()
	here.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanbrushfactoryview.[ch]: new widget: a
	PicmanDataFactory subclass with a "spacing" scale.

	* app/widgets/picmancontainereditor.[ch]:

	- Connect to the PicmanContainerView's "select_item",
	  "activate_item" and "context_item" signals here once instead of
	  in each subclass and dispatch them via new virtual functions.
	- Added a convenience function which makes DND to the buttons much
	  less painful for subclasses.

	* app/widgets/picmanbufferview.c
	* app/widgets/picmandatafactoryview.[ch]: changed accordingly.

	* app/widgets/picmandialogfactory.[ch]:

	- Added picman_dialog_factory_dialog_raise() which can raise
	  toplevel dialogs _and_ dockables (and creates them if they are
	  not open yet).
	- Keep track of all created dialogs (not only toplevels).
	- Added an "aux_info" field to PicmanSessionInfo which is a GList of
	  gchar* and is saved in sessionrc.
	- Remember if PicmanImageDock's image menu is visible by using an
	  aux_info string.
	- The code did not become nicer with all those new constraints. I
	  have to add comments before I forget how it works.

	* app/widgets/picmandockbook.c: set the state of the "Show Image Menu"
	menu item before popping up the item factory.

	* app/widgets/picmanimagedock.[ch]: added
	picman_image_dock_set_show_image_meu().

	* plug-ins/gdyntext/gdyntext.c
	* plug-ins/perl/examples/fit-text
	* plug-ins/perl/examples/terral_text
	* plug-ins/perl/examples/tex-to-float: register all text rendering
	plug-ins under <Image>/Filters/Text

	* app/pdb/brush_select_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/enums.pl
	* po/POTFILES.in: changed according to all the stuff above.

2001-06-27  Sven Neumann  <sven@picman.org>

	* README.i18n: merged changes from stable branch.

2001-06-26  Sven Neumann  <sven@picman.org>

	* picmantool.1.in
	* app/pdb/image_cmds.c
	* tools/pdbgen/pdb/image.pdb: ported changes from stable branch.

2001-06-26  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/color_transfer.[ch]: removed.

	* app/tools/Makefile.am
	* app/tools/picmancolorbalancetool-transfer.[ch]: added.

	* app/tools/picmancolorbalancetool.c: changed accordingly.

	* app/base/Makefile.am
	* app/base/tile-manager-crop.[ch]: formerly known as crop_buffer().

	* app/tools/picmantexttool.c: changed accordingly.

	* app/context_manager.[ch]: added the global clipboard and the
	named buffer list here.

	* app/app_procs.c: don't call color_transfer_init() and don't free
	the buffer stuff (done by the context manager now).

	* app/errorconsole.c: don't #include "gui/commands.h"

	* app/global_edit.[ch]: removed lots of stuff which is now done by
	gui/edit-commands.* or the new PicmanBuffer object. The "paste
	named" dialog will go away and this file will be moved to core/
	soon.

	* app/image_new.c: no need to declare the global_buffer extern any
	more.

	* app/qmask.c: don't #include "global_edit.h"

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanbuffer.[ch]: new object (aka named buffer)

	* app/core/picmancontext.[ch]: added a PicmanBuffer attribute.

	* app/core/picmanimage.[ch]: one s/int/gboolean/.

	* app/core/picmanpattern.c: hmm...

	* app/gui/commands.[ch]: split up in small files:

	* app/gui/Makefile.am
	* app/gui/edit-commands.[ch]
	* app/gui/file-commands.[ch]
	* app/gui/image-commands.[ch]
	* app/gui/select-commands.[ch]
	* app/gui/view-commands.[ch]: new files.

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: added the named buffer list & grid.

	* app/gui/file-new-dialog.[ch]
	* app/gui/menus.c
	* app/gui/palette-editor.c
	* app/gui/test-commands.c: changed accordingly.

	* app/pdb/edit_cmds.c
	* tools/pdbgen/pdb/edit.pdb: changed for the global_edit stuff.

	* app/widgets/Makefile.am
	* app/widgets/picmanbufferpreview.[ch]
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmancontainereditor.[ch]: new widgets.

	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandnd.[ch]
	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmanlayerlistview.c
	* app/widgets/picmanpreview.c
	* app/widgets/widgets-types.h: changed accordingly for the new
	PicmanBuffer object and it's views, misc. cleanups.

	* pixmaps/Makefile.am
	* pixmaps/paste-as-new.xpm
	* pixmaps/paste-into.xpm
	* pixmaps/paste.xpm: new pixmaps (they all look the same... Tigert? ;-)

	* po/POTFILES.in: added the new files.

2001-06-25  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/burn-in-anim.scm: added Burn-In script
	written by Roland Berger <roland@fuchur.leute.server.de>.

2001-06-22  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmath.h: do not include math.h conditionally.
	
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c: ported fix for bug #50715 from
	stable branch.

2001-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/gdyntext/ChangeLog
	* plug-ins/gdyntext/gdyntext.[ch]: ported changes from stable branch,
	updating GDynText to version 1.5.4.

2001-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/common/papertile.c
	* plug-ins/common/vinvert.c
	* plug-ins/script-fu/scripts/textured-logo.scm: merged changes from
	stable branch that mark some leftover strings for translation.

2001-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ps.c: applied fix for #51403.
	* plug-ins/flame/flame.c: applied fix for #37761.
	* plug-ins/script-fu/script-fu-console.c: applied fix for #50522.

	All fixes taken from the stable branch.

	* app/gui/file-open-dialog: ported fix for #51722 from stable branch.

2001-06-20  Michael Natterer  <mitch@picman.org>

	* app/gdisplay.c: same gdisplays_update_full() fix as in the
	stable branch. Removed lots of commented out code and comments
	about whether the code should be commented out or not.

	* app/core/picmanimage-mask.c: tried to fix it here first an ended
	up with a little cleanup.

2001-06-20  David Neary  <dneary@eircom.net>

	* configure.in
	* libpicman/picmanmath.h: Imported fix from bug #51822 into 1.3
	branch. Fix is courtesy of <bugzilla-gnome@thewrittenword.com>.
	
2001-06-18  Austin Donnelly  <austin@picman.org>

	* plug-ins/common/newsprint.c: Fix from
	    <warner-gnome.bugzilla@lothar.com> for problem with GREYA
	    images: it was using the settings from the RGB colourspace
	    due to testing bpp != 1 rather than colour_bpp != 1
	    (colour_bpp has alpha taken out of it).  Fixes Bug#52981.
	    Sven committed the same fix to 1.2 CVS.  This also bumps the
	    version number to 0.60 to reflect this fixed bug.

2001-06-18  Michael Natterer  <mitch@picman.org>

	* app/nav_window.[ch]: major cleanup. After being finished, I
	decided that it needs to be factored out to a widget (see below),
	so like 90% of this file will go away soon.

	* app/apptypes.h: added opaque NavigationDialog typedef.

	* app/gdisplay.[ch]: Added gdisplay_selection_visibility() which
	is called from gdisplays_selection_visibility(). Capitalized the
	SelectionControl enum values. Cleaned up the GDisplay struct and
	it's initialisation while i was on it.

	* app/gimage.c: gimage_size_changed_handler(): removed stuff which
	is now done by PicmanImage itself.

	* app/scale.c
	* app/scroll.c: also update the navigation popup, not only the
	dialog.

	* app/selection.[ch]: major indentation & cleanup attack. Maybe
	found the "Selection vanishes" bug (the timeout id was assinged to
	a gint, not a _guint_).

	* app/undo.c: s/picman_image_size_changed/picman_viweable_size_changed/

	* app/core/picmandrawable.c: invalidate the image's preview from our
	"invalidate_preview" implementation. This means that the image's
	preview is invalidated way too often currently, which cries for
	some general freeze/thaw mechanism on the PicmanViewable level.
	(Note that previews are rendered in the idle loop, so this is not
	really a major performance impact, it's just ugly).

	* app/core/picmanimage.[ch]: removed the "size_changed" signal...

	* app/core/picmanviewable.[ch]: ...and added it here.

	* app/core/picmanlayer.c: invalidate_preview(): always chain up,
	also if it's a floating selection.

	* app/gui/info-dialog.[ch]
	* app/gui/info-window.c: minor cleanups.

	* app/gui/preferences-dialog.c: no need to invalidate the image
	after we have invalidated all it's layers.

	* app/core/picmanimage-mask.c
	* app/gui/commands.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c: capitalized the SelectionCommand enum
	values.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmannavigationpreview.[ch]: new widget.

	* app/widgets/picmanpreview.[ch]: added a non-working
	non-dot-for-dot mode. Added xres/yres params to the
	picman_preview_calc_size() helper function.

	Cache the "size" value which was passed to the simple function
	variants (picman_preview_new() and picman_preview_set_size()) so we
	can re-calculate the preview's extents on the underlying
	viewable's "size_changed" signal and on picman_preview_set_viewable().

	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmanimagepreview.c: changed accordingly.

2001-06-18  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c
	* plug-ins/script-fu/scripts/land.scm: merged fixes from picman-1-2.

2001-06-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/perl/Picman/Lib.xs: forgot to s/id/drawable_id/ here.

2001-06-15  Austin Donnelly  <austin@picman.org>

	* app/gdisplay.c: initialise gdisp->cursor_x and gdisp->cursor_y
	    to 0 in gdisplay_new() so that we don't get floating point
	    exceptions when attempting to translate to screen co-ords in
	    gdisplay_update_cursor().  Fixes critical Bug #56237.

2001-06-14  Michael Natterer  <mitch@picman.org>

	* app/gdisplay.c: fixed a FIXME: set the sensitivity of the
	color tools' menu entries again.

	* libpicman/picmancolorselector.h
	* libpicman/picmandrawable.h
	* libpicman/picmanmenu.h: removed the usage of "id" from the public
	interface because it's a reserved keyword of Objective C.

	* libpicman/picmandrawable.c
	* libpicman/picmantile.c

	* plug-ins/[lotsa plugins].c: changed accordingly.

2001-06-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmeasuretool.c: fixed typo, closes bug #56200.

2001-06-14  Sven Neumann  <sven@picman.org>

	* app/disp_callbacks.c
	* app/gdisplay.c
	* app/gui/info-window.[ch]: 
	applied a patch from Ralf Engels <ralf-engels@gmx.de> that adds info
	about the cursor position to the Info window. Cleaned up the code a
	little while I was on it and renamed info_window_update_RGB() to
	info_window_update_extended().

2001-06-14  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c: fixed typo, closes bug #56193.

2001-06-12  Michael Natterer  <mitch@picman.org>

	* libpicman/picmandrawable.h: removed one more
	picman_channel_ops_duplicate #define.

	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gap/gap_mov_exec.c
	* plug-ins/gap/gap_pdb_calls.[ch]: removed a handmade PDB wrapper
	and use picman_image_duplicate().

2001-06-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/add-bevel.scm
	* plug-ins/script-fu/scripts/blend-anim.scm
	* plug-ins/script-fu/scripts/fuzzyborder.scm
	* plug-ins/script-fu/scripts/image-structure.scm
	* plug-ins/script-fu/scripts/old_photo.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm
	* plug-ins/script-fu/scripts/round-corners.scm
	* plug-ins/script-fu/scripts/slide.scm
	* plug-ins/script-fu/scripts/spinning_globe.scm
	* plug-ins/script-fu/scripts/swirltile.scm
	* plug-ins/script-fu/scripts/waves-anim.scm
	* plug-ins/script-fu/scripts/weave.scm: follow API cleanup:

	s/picman-channel-ops-duplicate/picman-image-duplicate/
	s/picman-channel-ops-offset/picman-drawable-offset/

2001-06-08  Michael Natterer  <mitch@picman.org>

	* configure.in: don't build devel-docs/pdb/Makefile.am

2001-06-07  Michael Natterer  <mitch@picman.org>

	* configure.in: added zh_TW.Big5 to ALL_LINGUAS. Added the
	STRIP_BEGIN and STRIP_END macros from gtk+.

	* app/base/makefile.msc: unmodified copy of app/core/makefile.msc
	(just to make "make dist" work).

	* */Makefile.am: use @STRIP_BEGIN@ and @STRIP_END@ all over the
	place. The Makefiles are a bit uglier now but it makes compiling
	output much more readable.

2001-06-06  Adam D. Moss  <adam@picman.org>

	* tools/pdbgen/pdb/image.pdb: picman_image_list(),
	picman_image_get_layers() and picman_image_get_channels() via
	pdb were eventually crashing due to prepending to an
	uninitialised GList*...

2001-06-06  Dave Neary  <dneary@eircom.net>

	* plug-ins/gap/gap_lib.c
	* plug-ins/gap/gap_dbbrowser_utils.[ch]: Made a couple of small
	changes to remove warnings (including string.h, and moving header
	includes from .h file to .c file).
	
2001-06-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/gui/Makefile.am
	* app/paint-funcs/Makefile.am
	* app/pdb/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am: no need to build .la objects for
	convenience libraries which are never linked into another dynamic
	library. Create simple .a files instead. Reduces compilation time
	of app/ by about 50%.

2001-06-05  Dave Neary  <dneary@eircom.net>

	* po/POTFILES.in: Changed one line to satisfy dependencies
	
2001-06-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/authors.h: removed.

	* app/gui/Makefile.am
	* app/gui/authors.h: added.

	* tools/authorsgen/authorsgen.pl: generate it in the new place.

	* app/gui/about-dialog.c
	* app/gui/commands.c
	* app/interface.c: don't #include "picmanhelp.h"

2001-06-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/resize.[ch]: removed.

	* app/gui/Makefile.am
	* app/gui/resize-dialog.[ch]: added.

	* app/gui/commands.c
	* app/gui/layers-commands.c: changed accordingly.

2001-06-05  Michael Natterer  <mitch@picman.org>

	* app/global_edit.c: some s/0/FALSE/

	* app/resize.[ch]: removed resize_scale_implement() and
	resize_check_layer_scaling(), cleanup.

	* app/core/picmanimage.[ch]: added picman_image_check_scaling().

	* app/gui/commands.c: added image_scale_implement() as static
	function.

	* app/gui/tool-options-dialog.[ch]: add the tool options widgets
	to the dialog when they are first needed. Removed
	tool_options_dialog_add().

	* app/tools/tool_manager.c: don't call tool_options_dialog_add().

2001-06-03  Dave Neary  <dneary@eircom.net>

	* app/picmanrc.[ch]: Made all the global options members of one
	struct, picmanrc.

	* app/app_procs.c
	* app/colormaps.c
	* app/context_manager.c
	* app/devices.c
	* app/disp_callbacks.c
	* app/file-save.c
	* app/gdisplay.c
	* app/gdisplay.h
	* app/gdisplay_ops.c
	* app/picmanhelp.c
	* app/image_new.c
	* app/interface.c
	* app/module_db.c
	* app/nav_window.c
	* app/plug_in.c
	* app/resize.c
	* app/scale.c
	* app/selection.c
	* app/undo.c
	* app/undo_history.c
	* app/user_install.c
	* app/xcf.c

	* app/core/picmancontext.c
	* app/core/picmanimage.c
	* app/core/picmanundo.c

	* app/gui/brush-select.c
	* app/gui/commands.c
	* app/gui/file-new-dialog.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/gui.c
	* app/gui/layer-select.c
	* app/gui/menus.c
	* app/gui/paths-dialog.c
	* app/gui/preferences-dialog.c
	* app/gui/session.c
	* app/gui/tips-dialog.c
	* app/gui/toolbox.c

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanpainttool.c
	* app/tools/paint_options.c
	* app/tools/selection_options.c

	* app/widgets/picmandrawablelistview.c

	* tools/pdbgen/pdb/picmanrc.pdb
	* app/pdb/picmanrc_cmds.c: Changed accordingly.
	
2001-06-01  Dave Neary  <dneary@eircom.net>

	* app/tools/picmanbycolorselecttool.c: added a call to
        by_color_select_close_callback() in _tool_destroy() to close 
        the dialog on exiting the tool.

2001-05-31  Dave Neary  <dneary@eircom.net>

	* app/core/picmanimage.[ch]
	* app/core/picmanimage-mask.c
	* app/tools/picmanbycolorselecttool.c
	* app/undo.c: Added a "mask_changed" signal, to allow
	picmanbycolorselect to update it's dialog properly, and take out a
	silly dependency in picmanimage.

	One outstanding issue is that now the dialog doesn't close
	automatically when the tool context changes. Working on it :)
	
2001-05-30  Michael Natterer  <mitch@picman.org>

	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/gui/Makefile.am
	* app/paint-funcs/Makefile.am: added makefile.msc to EXTRA_DIST.

	* app/core/picmanimage.c: don't try to create previews with width or
	height < 1.

	* app/gui/color-notebook.c: Major (??) dialog repacking. Don't
	show an action_area for the main color selection (it's now about
	half the size of the 1.2 one).

	* libpicman/picmancolorselector.h: define some gui size constants
	here.

	* app/gui/color-select.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: use the constants and removed the
	spacing around the main container.

	* libpicmanwidgets/picmancolorarea.[ch]: rendering in the idle loop
	fixes a race condition when accessing widget->window during widget
	resizing.

	* modules/Makefile.am: disabled the "GTK" color notebook page (we
	will put the GtkHSV widget of gtk+ 2.0 here).

2001-05-29  Simon Budig  <simon@picman.org>

	* po/POTFILES.in: Added app/tools/picmanposterizetool.c
        which replaces posterize.c. Is it complete now?  :-)
	
2001-05-28  Dave Neary   <dneary@eircom.net>

	* po/POTFILES.in: Changed one filename to (finally) fix
        the build - sorry I missed this yesterday :)
	
2001-05-27  Dave Neary   <dneary@eircom.net>

	* po/POTFILES.in: Removed posterize.c to fix build
	
2001-05-25  Hans Breuer  <hans@breuer.org>

	* app/*/makefile.msc : almost completely autogenerated 
	all new makefiles (it simply was too much work to do
	this manually)

	* app/core/makefile.msc :
	* app/gui/makefile.msc :
	* app/paint-funcs/makefile.msc : new files
 
	* app/base/base.c : include <io.h> for unlink

	* libpicman*/makefile.msc :
	* libpicman*/*.def : adapted or regenerated

	* libpicman/picmancolorselctor.h : include gmodule.h to avoid
	different declarations in different context.

	* libpicman/proceduraldb.c : string.h for memcmp

	* libpicmanwidgets/libpicman-glue.c : include picmanbasetypes.h before
	picmanunits.h

	* plug-ins/common/animoptimize.c : added nops after
	labels. At least the msvc compiler doesn't compile it otherwise

	* plug-ins/twain/twain.c : added main() to allow to build 
	as console app

2001-05-25  Michael Natterer  <mitch@picman.org>

	* app/base/pixel-processor.c: fixing a typo fixes ENABLE_MP.

	* app/core/picmandrawable-histogram.c
	* app/core/picmanimage-colorhash.c
	* app/core/picmantoolinfo.c: fixed some #includes.

	* libpicmanwidgets/picmanfileselection.[ch]
	* libpicmanwidgets/picmanwidgetstypes.h: moved the opaque typedef to
	picmanwidgetstypes.h

	* po/POTFILES.in: reflect app/'s state again.

2001-05-25  Michael Natterer  <mitch@picman.org>

	* configure.in: new directory devel-docs/libpicmanbase/

2001-05-25  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/scan_convert.[ch]: removed.

	* app/core/Makefile.am
	* app/core/picmanscanconvert.[ch]: added. Changed all function names
	and use PicmanVector2 instead of ScanConvertPoint.

	* app/base/base-types.h: removed ScanConvertPoint (didn't belong
	here anyway).

	* app/pdb/tools_cmds.c
	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmaniscissorstool.c
	* tools/pdbgen/pdb/tools.pdb: changed accordingly.

2001-05-25  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.[ch]: removed "num_processors".

	* app/base/base-config.[ch]: and added it here.

	* app/base/picmanhistogram.c
	* app/base/pixel-processor.c
	* app/gui/preferences-dialog.c: changed accordingly.

2001-05-25  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanui.[ch]: removed.

	* app/tools/paint_options.[ch]: removed paint_mode_menu_new().

	* app/widgets/Makefile.am
	* app/widgets/picmanwidgets-constructors.[ch]
	* app/widgets/picmanwidgets-utils.[ch]: added here.

	* app/disp_callbacks.c
	* app/errors.c
	* app/picmanhelp.c
	* app/interface.c
	* app/gui/brush-select.c
	* app/gui/channels-commands.c
	* app/gui/commands.c
	* app/gui/file-dialog-utils.c
	* app/gui/file-open-dialog.c
	* app/gui/file-save-dialog.c
	* app/gui/layers-commands.c
	* app/gui/tool-options-dialog.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhistogramtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/tools/tool_manager.c
	* app/widgets/picmanlayerlistview.c: changed accordingly.

2001-05-25  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/tool_options_dialog.[ch]: removed.
	* app/tools/tools.h: new file

	* app/gui/Makefile.am
	* app/gui/tool-options-dialog.[ch]: added.

	* app/tools/tools.c: renamed register_tools() to tools_init(), new
	function tools_exit().

	* app/app_procs.c
	* app/context_manager.c
	* app/tools/tool_manager.c
	* app/gui/dialogs-constructors.c
	* app/gui/gui.c: changed accordingly.

2001-05-25  Michael Natterer  <mitch@picman.org>

	All tools are back :)

	* app/tools/Makefile.am
	* app/tools/brightness_contrast.[ch]
	* app/tools/color_balance.[ch]
	* app/tools/curves.[ch]
	* app/tools/histogram_tool.[ch]
	* app/tools/hue_saturation.[ch]
	* app/tools/levels.[ch]
	* app/tools/posterize.[ch]
	* app/tools/threshold.[ch]: removed...

	* app/tools/picmanbrightnesscontrasttool.[ch]
	* app/tools/picmancolorbalancetool.[ch]
	* app/tools/picmancurvestool.[ch]
	* app/tools/picmanhistogramtool.[ch]
	* app/tools/picmanhuesaturationtool.[ch]
	* app/tools/picmanlevelstool.[ch]
	* app/tools/picmanposterizetool.[ch]
	* app/tools/picmanthresholdtool.[ch]: ...and ported to the new tool
	system. Yes, the toolbox looks strange right now.

	* app/tools/picmanimagemaptool.[ch]: base class for all image_map
	tools. Does nothing at all right now.

	* app/tools/picmanbucketfilltool.h: removed _new() function
	declaration.

	* app/tools/picmantool.c: removed obsolete stuff and STUB()s.

	* app/tools/tools.c: register the new tools.

	* app/menus.c: removed the #if 0 around the code which reorders
	the color tool menu entries.

	* app/app_procs.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/color.pdb
	* app/pdb/color_cmds.c
	* po/POTFILES.in: changed accordingly.

2001-05-24  Michael Natterer  <mitch@picman.org>

	* config.guess
	* config.sub: new versions from CVS (at least that's what my
	debian package says...)

	* app/Makefile.am
	* app/picmanpreviewcache.[ch]: removed.

	* app/core/Makefile.am
	* app/core/picmanpreviewcache.c: added.

	* app/core/picmandrawable.c: reordered #includes

	* app/apptypes.h: make ImageMap a proper opaque typedef, not
	simply a gpointer.

	* app/image_map.[ch]: changed accordingly. cleanup.

	* app/tools/color_balance.h
	* app/tools/curves.h
	* app/tools/histogram_tool.h
	* app/tools/hue_saturation.h
	* app/tools/threshold.h: changed here too.

	* app/tools/picmantool.c: removed old by_color_select stuff.

	* libpicmanbase/picmanbasetypes.h: /*< skip >*/ PICMAN_UNIT_PERCENT as
	it's a UI convenience thing and no unit.

	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanwidgets/picmanbutton.c: maybe this change makes PicmanButton
	behave even more careful when changing GtkButton's private stuff.

2001-05-23  Michael Natterer  <mitch@picman.org>

	* app/picmanhistogram.[ch]
	* app/lut_funcs.[ch]: removed.

	* app/base/picmanhistogram.[ch]
	* app/base/lut-funcs.[ch]
	* app/core/picmandrawable-histogram.[ch]: added, cleanup.

	* app/Makefile.am
	* app/appenums.h
	* app/apptypes.h
	* app/base/Makefile.am
	* app/base/base-types.h
	* app/core/Makefile.am
	* app/core/picmanchannel.c
	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-invert.c
	* app/pdb/color_cmds.c
	* app/widgets/picmanhistogramview.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

2001-05-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/resolution_calibrate.[ch]: removed

	* app/gui/Makefile.am
	* app/gui/resolution-calibrate-dialog.[ch]: added

	* app/user_install.c
	* app/gui/preferences-dialog.c
	* po/POTFILES.in: changed accordingly.

	* app/core/picmanlayer.c: irrelevant doc reformating.

2001-05-22  Sven Neumann  <sven@picman.org>

	* app/module_db.c: ported bugfix for #55050 from stable branch.

2001-05-22  Michael Natterer  <mitch@picman.org>

	* libpicman/.cvsignore
	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmanfeatures.h.in: removed picmanfeatures.h

	* libpicmanbase/.cvsignore
	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmanbasetypes.h
	* libpicmanbase/picmanversion.h.in: and added it as picmanversion.h

	* configure.in: changed accordingly.

	* app/app_procs.c
	* app/main.c
	* app/gui/about-dialog.c
	* app/gui/splash.c
	* app/pdb/misc_cmds.c
	* tools/pdbgen/pdb/misc.pdb: fixed includes.

	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c
	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c
	* plug-ins/common/jpeg.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/ps.c
	* plug-ins/common/tiff.c
	* plug-ins/gdyntext/gdyntextcompat.h
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/perl/Picman.xs
	* plug-ins/perl/Picman/Lib.xs
	* plug-ins/pypicman/picmanmodule.c
	* tools/picman-remote.c: removed all #ifdef PICMAN_HAVE_BLAH
	conditionals as they are broken anyway since we changed all
	plug-ins with perl scripts shortly before 1.2. Also, refering to
	intermediate unstable releases is evil.

2001-05-21  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c
	* app/datafiles.c
	* app/devices.c
	* app/docindex.c
	* app/gdisplay_color.c
	* app/gdisplay_color_ui.c
	* app/picmanhelp.c
	* app/main.c
	* app/module_db.c
	* app/plug_in.c
	* app/resize.c
	* app/resolution_calibrate.c
	* app/undo_history.c
	* app/user_install.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandata.c
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/gui/about-dialog.c
	* app/gui/file-new-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/layers-commands.c
	* app/gui/menus.c
	* app/gui/palette-editor.c
	* app/gui/session.c
	* app/gui/splash.c
	* app/gui/tips-dialog.c
	* app/pdb/image_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/tools/curves.c
	* app/tools/picmantexttool.c
	* app/tools/levels.c
	* app/widgets/picmandnd.c
	* app/widgets/picmanpreview.c
	* libpicman/picmancolordisplay.h
	* libpicmanbase/picmanbase.h
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/libpicman-glue.c
	* plug-ins/common/gih.c
	* plug-ins/common/psp.c
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/text_tool.pdb: last checkin didn't get all
	#include "libpicman/i_dont_exist_any_more.h". This one should make
	it compile again without old crap hanging around in <prefix>/include.

2001-05-21  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.def: removed removed symbols :)

	* libpicmanbase/picmanbase.def
	* libpicmanbase/makefile.mingw.in
	* libpicmanbase/makefile.msc: added because they are in EXTRA_DIST.
	Will definitely not work before a friendly visit by Tor or Hans.

2001-05-21  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* picmantool-1.4.in: added new directory libpicmanbase/

	* app/Makefile.am: link against the new lib.

	* app/appenums.h: removed the PDB enums which are in
	libpicmanbase/picmanbasetypes.h now. They are all "Picman" prefixed.

	* app/apptypes.h: #include "libpicmanbase/picmanbasetypes.h"

	* app/[lots]
	* app/core/[of]
	* app/gui/[files]
	* app/tools/: changed includes and all PDB types.

	* app/pdb/*: regenerated.

	* libpicman/Makefile.am: don't build libpicmani.a uglyness any more.

	* libpicman/picmanenv.[ch]
	* libpicman/picmanlimits.[hh]
	* libpicman/picmanparasite.[ch]
	* libpicman/picmanparasiteio.[ch]
	* libpicman/picmanprotocol.[ch]
	* libpicman/picmansignal.[ch]
	* libpicman/picmanunit.h
	* libpicman/picmanutils.[ch]
	* libpicman/picmanwire.[ch]: removed...

	* libpicmanbase/*: ...and added here as new library.

	* libpicman/picman.[ch]
	* libpicman/picmandrawable.[ch]
	* libpicman/picmanenums.h
	* libpicman/picmanimage.[ch]
	* libpicman/picmantile.c
	* libpicman/picmantypes.h
	* libpicman/picmanunit.c: changed accordingly. Added the
	picman_*_add_new_parasite to picman.[ch], picmandrawable.[ch] and
	picmanimage.[ch].

	* libpicmanwidgets/picmanpatheditor.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanunitmenu.c
	* libpicmanwidgets/picmanwidgets.c
	* libpicmanwidgets/picmanwidgetstypes.h: changed includes accordingly.

	* plug-ins/*/Makefile.am
	* plug-ins/common/mkgen.pl: link against libpicmanbase.

	* tools/pdbgen/Makefile.am: scan libpicmanbase/picmanbasetypes.h, so
	the enums are known to pdbgen...

	* tools/pdbgen/enumcode.pl: ...but don't write them out to
	libpicman/picmanenums.h

	* tools/pdbgen/app.pl: include libpicman/picmanbase.h in all *_cmds.c
	files. Added PICMAN_ to the type names ganerated in app/.

	* tools/pdbgen/enums.pl: regenerated.

	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/unit.pdb: changed includes.

Mon May 21 04:08:29 CEST 2001  Marc Lehmann <pcg@goof.com>

	* autogen.sh: allow for automake 1.4-p1 and similar version numbers.

2001-05-20  Michael Natterer  <mitch@picman.org>

	* app/base/Makefile.am
	* app/base/base.[ch]: new files for base_init() and base_exit()
	which initialize/shutdown the paint_funcs and the tile_cache.

	* app/app_procs.c: removed the stuff here.

	* app/widgets/picmanchannellistitem.c: commented out unused code.

2001-05-20  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* plug-ins/script-fu/Makefile.am: put the regex and MMX sources to
	EXTRA_DIST so they get distributed unconditionally.

	* tools/pdbgen/pdb/layer.pdb: re-enabled the layer_mask procs but
	let them use accessors (which don't exist)...

	* app/pdb/pdb_glue.h: ... #define the accessors as macros here.

	Yes, this is ugly, but I simply don't fully understand pdbgen
	yoshcode.

	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]: regenerated with the layer_mask
	accessors.

	* app/tools/Makefile.am: add the files which are not built to
	EXTRA_DIST.

	* pixmaps/Makefile.am
	* pixmaps/channel.xbm
	* pixmaps/eye.xbm
	* pixmaps/layer.xbm
	* pixmaps/linked.xbm
	* pixmaps/mask.xbm: removed.

	* plug-ins/Makefile.am: build XJT again because the layer_mask
	stuff is back. Perl also seems to build again.

	* plug-ins/common/aa.c: explicit casting fixes some warnings.

	* plug-ins/script-fu/interp_regex.c: #include "config.h".

2001-05-19  Sven Neumann  <sven@picman.org>

	* app/main.c: s/USE_GCC_INTEL_MMX/HAVE_ASM_MMX/
	
	* app/path_curves.c: fixed some warnings and changed code so it
	does not try to draw unconfigured points.
	
	* app/base/temp-buf.[ch]: added a warning not to use the data field
	from the TempBuf struct directly.

2001-05-18  Michael Natterer  <mitch@picman.org>

	* app/gui/menus.c: use the correct callback for opening L&C.

	* app/widgets/picmandock.c: set the window title, the WM-name/class
	and the icon.

2001-05-16  Michael Natterer  <mitch@picman.org>

	* app/general.[ch]: removed search_in_path() and the unused
	xstrsep().

	* app/plug_in.c: added plug_in_search_in_path(), don't include
	"general.h".

	* app/picmanrc.c
	* app/image_render.c
	* app/gui/convert-dialog.c
	* app/gui/palette-editor.c
	* app/gui/paths-dialog.c
	* app/pdb/paths_cmds.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* tools/pdbgen/pdb/paths.pdb: removed useless includes.

2001-05-15  Michael Natterer  <mitch@picman.org>

	* app/picmancontextpreview.[ch]: removed (was not used).

	* app/apptypes.h: removed the Guide typedef.

	* app/core/core-types.h: added it here as PicmanGuide (everything in
	core/ must be "Picman"-prefixed).

	* app/gimage.[ch]: removed the global "next_guide_id" variable,
	don't destroy the guides in the "destroy" handler.

	* app/core/picmanimage.[ch]: destroy them in destroy().

	* app/xcf.c: use PicmanImage accessors to add the guides, so we
	don't need "next_guide_id".

	* app/gdisplay.[ch]
	* app/undo.c
	* app/core/picmanimage-duplicate.c
	* app/tools/picmancroptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.[ch]
	* app/pdb/guides_cmds.c
	* tools/pdbgen/pdb/guides.pdb: s/Guide/PicmanGuide/, cleanup.

2001-05-15  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/fsdither.h: removed...

	* app/core/Makefile.am
	* app/core/picmanimage-convert-fsdither.h: ...and added here.

	* app/core/picmanimage-convert.c: changed accordingly.

2001-05-15  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.c: register all parse functions in a hash table
	instead of a static array. This way, with some additional ugly
	hacking, we get the addresses of the variables in
	base/base-config.c registered. The whole config stuff has to be
	done properly at some point.

2001-05-15  Michael Natterer  <mitch@picman.org>

	* configure.in: new directory app/base/

	* app/Makefile.am
	* app/boundary.[ch]
	* app/brush_scale.[ch]
	* app/picmanchecks.h
	* app/picmanlut.[ch]
	* app/pixel_processor.[ch]
	* app/pixel_region.[ch]
	* app/pixel_surround.[ch]
	* app/temp_buf.[ch]
	* app/tile.[ch]
	* app/tile_cache.[ch]
	* app/tile_manager.[ch]
	* app/tile_manager_pvt.h
	* app/tile_pvt.h
	* app/tile_swap.[ch]: moved to base/

	* app/base/Makefile.am
	* app/base/base-types.h
	* app/base/*: new directory for the sub-object pixel maniplation
	and storage stuff. Does not include Gtk+ or anything outside
	base/. Did some cleanup in all files.

	* app/appenums.h
	* app/apptypes.h
	* app/core/picmanimage.h: removed types which are now in
	base/base-types.h.

	* app/base/base-config.[ch]
	* app/picmanrc.[ch]: put the config variables for base/ to their own
	file so base/ doesn not have to include picmanrc.h (does not yet
	work, i.e. the variables are un-configurable right now)

	* app/main.c: set a log handler for "Picman-Base".

	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs.[ch]: removed the color hash which
	maps RGB to color indices because it's a totally standalone system
	which has nothing to do with the paint-funcs and introduced a
	PicmanImage dependency.

	paint-funcs/ should be considered on the same sub-object
	(glib-only) level as base/, only in a different directory.

	* app/core/Makefile.am
	* app/core/picmanimage-colorhash.[ch]: put the color hash here.

	* app/gimage.c: don't invalidate the color hash here...

	* app/core/picmanimage.c: ... but in the colormap_changed() default
	inplementation. Initialize the hash in class_init().

	* tools/pdbgen/Makefile.am: scan app/base/base-types.h for enums.

	* tools/pdbgen/enums.pl: regenerated.

	* app/[lots]
	* app/core/[of]
	* app/gui/[files]
	* app/pdb/[all]
	* app/tools/[over]
	* app/widgets/[the]
	* tools/pdbgen/pdb/[place]: changed #includes accordingly. And use
	base_config->value instead of the stuff from picmanrc.h.

2001-05-14  Michael Natterer  <mitch@picman.org>

	* README.patch_xinput_airbrush
	* patch_xinput_airbrush: removed because GTK+-2.0 will manage the
	number of valuators dynamically.

	* app/Makefile.am: some more thinking about subdirectories.

	* app/boundary.c
	* app/pixel_processor.c
	* app/pixel_region.c: removed #include's, code cleanup.

	* libpicmanwidgets/Makefile.am: install picmanbutton.h

	* devel-docs/libpicman/tmpl/picmanadaptivesupersample.sgml
	* devel-docs/libpicman/tmpl/picmanbilinear.sgml: removed ...

	* devel-docs/libpicmancolor/tmpl/picmanadaptivesupersample.sgml
	* devel-docs/libpicmancolor/tmpl/picmanbilinear.sgml: ... and added here.

	* devel-docs/libpicman/libpicman-decl.txt
	* devel-docs/libpicman/libpicman-sections.txt
	* devel-docs/libpicman/libpicman.hierarchy
	* devel-docs/libpicman/tmpl/picmanenums.sgml
	* devel-docs/libpicmancolor/libpicmancolor-decl.txt
	* devel-docs/libpicmancolor/libpicmancolor-docs.sgml
	* devel-docs/libpicmancolor/libpicmancolor-sections.txt
	* devel-docs/libpicmancolor/libpicmancolor.hierarchy
	* devel-docs/libpicmancolor/tmpl/picmancolortypes.sgml: regenerated.

2001-05-14  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* libpicman/Makefile.am: don't reference header files which don't exist
	any longer

2001-05-14  Sven Neumann  <sven@picman.org>

	* app/ops_buttons.[ch]: use PicmanButton and connect to extended_clicked.
	
	* app/docindex.c
	* app/gui/paths-dialog.c: changed accordingly.

2001-05-14  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/pixmaps2.h: removed this file ...

	* app/tools/Makefile.am
	* app/tools/icons.h: ... and readded it here with some changes.

	* app/tools/*.c: include the new icons.h file

	* app/pdb/procedural_db.[ch]: declare name as const

2001-05-13  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/cursorutil.[ch]: removed. Stuff now lives in app_procs.[ch]
	and in widgets/picmancursor.[ch]

	* app/appenv.h: added the "picman_busy" boolean.

	* app/app_procs.[ch]: added the "busy" stuff here.

	* app/gui/gui.[ch]: "busy" stuff for the gui.

	* app/widgets/Makefile.am
	* app/widgets/picmancursor.[ch]: exports only one function:
	picman_cursor_new() which returns a GdkCursor which has to be
	destroyed.

	* app/apptypes.h
	* app/appenums.h: removed the cursor types.
	* app/widgets/widgets-types.h: added here.

	* app/tools/picmaneditselectiontool.[ch]: added
	gtkutil_compress_motion() here (will go to some utils file in
	widgets/).

	* app/tools/tools-types.h: #include "widgets/widgets-types.h"

	* app/dialog_handler.c
	* app/disp_callbacks.c
	* app/gdisplay.[ch]
	* app/nav_window.c
	* app/scroll.c
	* app/xcf.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage.c
	* app/gui/file-open-dialog.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/image.pdb
	* app/pdb/image_cmds.c: use the new cursor and "busy" functions.

	* app/gdisplay.h
	* app/core/picmanbrush.c: added some ugly cross-includes.

	* app/context_manager.c
	* app/gdisplay_ops.c
	* app/picmanrc.c
	* app/core/picmandrawable-offset.c
	* app/gui/file-save-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/preferences-dialog.c
	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanselectiontool.c: removed inclusion of "cursorutil.h"

2001-05-13  Michael Natterer  <mitch@picman.org>

	* app/appenums.h
	* app/core/core-types.h
	* app/tools/tools-types.h: moved some more types to core-types.h
	and tools-types.h.  Removed AUXILLARY_CHANNEL from the ChannelType
	enum.

	* app/gdisplay.[ch]: removed the "depth" and "color_type" fields
	from the struct. Cleaned up the header.

	* app/selection.c
	* app/gui/info-window.c: use g_visual->depth instead of
	gdisp->depth.

	* app/picmanhelp.c: #include "core/core-types.h"

	* tools/pdbgen/Makefile.am: added app/core/core-types.h to the
	list of files to be scanned for enums.

	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c: regenerated.

2001-05-13  Michael Natterer  <mitch@picman.org>

	* TODO.xml: some percentage updates.

	* autogen.sh: correctly parse latest autoconf's broken "--version"
	string.

	* app/widgets/Makefile.am
	* app/widgets/picmancontainerview-utils.[ch]: new files which
	provide a set of built-in get_name_func()s for PicmanContainerView
	and PicmanContainerMenu.

	* app/widgets/picmancontainermenu.c
	* app/widgets/picmancontainerview.c: use them.

	* app/widgets/picmanimagedock.c
	* app/gui/dialogs-constructors.c: removed the get_name_func()s here.

2001-05-13  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h: removed some forgotten tools types.

	* app/tools/tools-types.h: and added them here.

	* app/interface.c
	* app/disp_callbacks.[ch]: ported dropping of drawables to the
	new DND system.

	* app/app_procs.c
	* app/core/picmandatafactory.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmantoolinfo.h
	* app/gui/gui.c
	* app/tools/tool_options.c
	* app/widgets/picmanchannellistview.c
	* app/widgets/picmanlayerlistview.c: removed/fixed includes.

	* app/gui/brush-select.[ch]
	* app/gui/pattern-select.[ch]: removed the display of the current
	name (done by the grid view now).

	* app/gui/palette-select.c: fixed palette preview size.

	* app/gui/dialogs-constructors.c: added get_name() functions for
	brushes, patterns, images and palettes.

	* app/widgets/picmancontainergridview.[ch]: added a label for the
	name of the active item.

	* app/widgets/picmandnd.[ch]: removed the old drawable DND preview
	icon code.

	* tools/pdbgen/app.pl: braino: the $tool_eek hack has to be
	initialized to 0 at the beginning of each file, otherwise we end
	up including "tools/tools-types.h" everywhere.

	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/tools.pdb: add "tools/tools-types.h" where needed.

	* app/pdb/color_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/undo_cmds.c
	* app/pdb/unit_cmds.c: regenerated.

2001-05-12  Adam D. Moss  <adam@picman.org>

	* plug-ins/common/animoptimize.c: Cunningly decrease
	the efficiency of the plugin.  Add semi-broken code
	to find or remove the statistical mode pixels across
	all frames (ie. the animation background).  Checked in
	mainly to avoid tree-drift until I have time to finish
	this.

2001-05-11  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/lc_dialog.[ch]: taken behind the curtain and shot.
	(famous words of Seth Burgess on #picman)

	* app/app_procs.c
	* app/gdisplay.c
	* app/gimage.c
	* app/gui/commands.c
	* app/gui/gui.c
	* app/gui/menus.c
	* app/gui/preferences-dialog.c: don't #include it or call it's
	functions any more.

	* app/gui/dialogs-commands.[ch]: added a constructor for a dock
	which looks like the old L&C dialog (taken from test-commands.*)

	* app/gui/test-commands.[ch]: removed here.

	* app/gui/dialogs-constructors.[ch]: wrapped the old
	paths-dialog.* stuff in a dockable which can be created only
	once. Will go away as soon as the new path stuff is there.

	* app/gui/dialogs.c: added the paths dockable, removed lc_dialog.

	* app/gui/paths-dialog.c: some changes to make it work without the
	lc_dialog around it. Will probably crash randomly and refuse to
	update it's contents properly (scheduled for removal).

2001-05-11  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am
	* app/gui/channels-dialog.[ch]
	* app/gui/layers-dialog.[ch]: at the end of their epoch, the
	dinosaurs were wiped out by a "cvs remove" impact from space.

	* app/lc_dialog.c: changed accordingly.

	* app/gui/layer-select.c: use the new preview system (mostly code
	removal).

	* app/gui/menus.c: reorder the dialog factory menu.

2001-05-10  David Neary  <dneary@eircom.net>

        * app/tools/picmanbycolorselecttool.[ch]
        * app/undo.c: Temporarily fixed an issue with undo when
        there's a bycolorselect mask on the image - since
        picman_by_color_select_tool_initialize_by_image() should be
        a private function, this needs changing.

2001-05-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanchannellistview.c: fixed button sensitivity.

	* app/widgets/picmandialogfactory.c: write out newlines to
	.sessionrc at the right places.

	* app/widgets/picmandock.c: s/picman_dockable/picman-dockable/ makes DND
	re-arranging of dialogs work again.

2001-05-10  David Neary  <dneary@eircom.net>

        * tools/picman-remote.c: Got rid of some annoying 
        warnings about stuff like exit not having a prototype.
        Included string.h and stdlib.h.

2001-05-10  David Neary  <dneary@eircom.net>

	* app/tools/picmanbycolorselecttool.[ch]: Activate 
	"Select by color" tool.

	* app/tools/Makefile.am
	* app/tools/tools.c
	* app/tools/picmantool.[ch]
	* app/tools/selection_options.c
	* tools/pdbgen/pdb/tools.pdb: Changed accordingly
	
2001-05-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/asupsample.[ch]: removed.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/tools/Makefile.am
	* app/tools/tools-types.h: new files.

	* app/tools/picmantoolinfo.[ch]: removed.
	* app/core/picmantoolinfo.[ch]: added here.

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmanadaptivesupersample.[ch]
	* libpicman/picmanbilinear.[ch]: removed here...

	* libpicmancolor/Makefile.am
	* libpicmancolor/picmancolortypes.h
	* libpicmancolor/picmanadaptivesupersample.[ch]
	* libpicmancolor/picmanbilinear.[ch]: ..and added here.

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/paths.pdb

	* app/*.c: changed tons of #include's

2001-05-09  Michael Natterer  <mitch@picman.org>

	* configure.in
	* app/Makefile.am: added new directory app/core/ for the core
	object system.

	* app/gimage_mask.[ch]
	* app/picmanbrush-header.h
	* app/picmanbrush.[ch]
	* app/picmanbrushgenerated.[ch]
	* app/picmanbrushpipe.[ch]
	* app/picmanchannel.[ch]
	* app/picmancontainer.[ch]
	* app/picmancontext.[ch]
	* app/picmandata.[ch]
	* app/picmandatafactory.[ch]
	* app/picmandatalist.h
	* app/picmandrawable-desaturate.[ch]
	* app/picmandrawable-equalize.[ch]
	* app/picmandrawable-invert.[ch]
	* app/picmandrawable-offset.[ch]
	* app/picmandrawable-preview.[ch]
	* app/picmandrawable.[ch]
	* app/picmangradient.[ch]
	* app/picmanimage-convert.[ch]
	* app/picmanimage-duplicate.[ch]
	* app/picmanimage-undo.[ch]
	* app/picmanimage.[ch]
	* app/picmanlayer.[ch]
	* app/picmanlayermask.[ch]
	* app/picmanlist.[ch]
	* app/picmanmarshal.[ch]
	* app/picmanobject.[ch]
	* app/picmanpalette-import.[ch]
	* app/picmanpalette.[ch]
	* app/picmanpattern-header.h
	* app/picmanpattern.[ch]
	* app/picmanundo.[ch]
	* app/picmanundostack.[ch]
	* app/picmanviewable.[ch]: removed these files...

	* app/core/*: ...and added them here.

	* app/*.c
	* app/gui/*.c
	* app/pdb/*.c
	* app/tools/*.c
	* app/widgets/*.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gih.c
	* plug-ins/common/pat.c
	* po/POTFILES.in
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/*.pdb: changed accordingly.

2001-05-08  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: removed PicmanDropType.
	* app/widgets/widgets-types.h: added PicmanDropType.

	* app/gui/channels-dialog.c
	* app/gui/layers-dialog.c: #include "widgets/widgets-types.h"

2001-05-08  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmandnd.[ch]: removed.

	* app/widgets/Makefile.am
	* app/widgets/picmandnd.[ch]: and moved here.

	* app/devices.c
	* app/docindex.c
	* app/interface.c
	* app/gui/about-dialog.c
	* app/gui/channels-dialog.c
	* app/gui/color-area.c
	* app/gui/color-select.c
	* app/gui/colormap-dialog.c
	* app/gui/gradient-editor.c
	* app/gui/indicator-area.c
	* app/gui/layers-dialog.c
	* app/gui/palette-editor.c
	* app/gui/palette-select.c
	* app/gui/toolbox.c
	* app/tools/picmanblendtool.c
	* app/tools/tool_manager.c
	* app/tools/tool_options_dialog.c: changed #includes accordingly.

2001-05-08  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: added ChannelType.
	* app/picmanimage.h: removed ChannelType.
	* tools/pdbgen/enums.pl: regenerated.

	* app/apptypes.h: don't include libpicmanwidgets/picmanwidgetstypes.h
	and widgets/widgets-types.h any more.

	* app/devices.c
	* app/picmandnd.c
	* app/picmanrc.c
	* app/lc_dialog.c
	* app/gui/[many].c: include widgets/widgets-types.h

	* app/tools/histogram_tool.h: include widgets/widgets-types.h here
	because of an ugly dependency from pdb/color_cmds.c

	* app/tools/tool_options_dialog.c

	* app/widgets/widgets-types.h: include
	libpicmanwidgets/picmanwidgetstypes.h and apptypes.h so files in
	widgets/ only have to include this file.

	* app/widgets/*.c: include widgets-types.h instead of apptypes.h

	* app/picmandrawable-preview.c
	* app/gui/gradient-editor.c: removed useless #includes.

2001-05-07  Michael Natterer  <mitch@picman.org>

	* app/picmanimage.[hc]: new signal "floating_selection_changed",
	removed ancient declaration of _PicmanImageRepaintArg.

	* app/floating_sel.c
	* app/undo.c: emit "floating_selection_changed" where approptiate.

	* app/gimage_mask.c: s/"Floated Layer"/"Floating Selection"/
	because we view this layer directly now (not some thing with an
	"L" icon).

	* app/gui/layers-commands.c: don't use confusing boolean variables
	which indicate that something is not true (reversed their logic).

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanchannellistitem.[ch]: new widget. Does nothing yet.

	* app/widgets/picmanchannellistview.c: set the button box
	insensitive when there is a floating selection.

	* app/widgets/picmandrawablelistitem.c: made channel DND work again.
	Very ugly btw.

	* app/widgets/picmandrawablelistview.c: connect to
	"floating_selection_changed". Fake a change of the active drawable
	so the button boxes get updated correctly.

	* app/widgets/picmanlayerlistview.c: set the sensitivity of the
	buttons correctly.

	* app/widgets/picmanlistitem.c: create PicmanChannelListItems for
	channels.  Some very ugly code to work around broken
	GTK_STATE_INSENSITIVE propagation in list items.

2001-05-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanchannellistview.c: enabled setting component
	activity. Connect an "extended_clicked" callback to the "To
	Selection" button for add/sub/intersect.

	* app/widgets/picmancomponentlistitem.c: removed some commented out
	code.

	* app/widgets/picmandrawablelistview.c: stuff.

	* app/widgets/picmanlayerlistview.c: set "Raise" to insensitive if
	the active layer has no alpha.

	* libpicmanwidgets/picmanbutton.c: fiddle around correctly with
	GtkButton's internals.

2001-05-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanoffsetarea.h: new widget PicmanOffsetArea cut 
	of the resize dialog, allows to interactively specify offsets when 
	resizing images or drawables.

	* libpicmanwidgets/picmanpixmap.c: removed empty destroy method.

	* app/resize.c: use new PicmanOffsetArea.

2001-05-06  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanbutton.[ch]: new widget derived from
	GtkButton.  It adds an "extended_clicked" signal which is emitted
	instead of "clicked" if a modifier was pressed.

	* libpicmanwidgets/picmanchainbutton.[ch]
	* libpicmanwidgets/picmanpixmap.[ch]: removed the opaque typedefs.

	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h: and added them here. Added
	PicmanButton.

	* app/widgets/picmandrawablelistview.c: use PicmanButtons for "Raise"
	and "Lower" and raise/lower to top/bottom on shift-click.

2001-05-06  Michael Natterer  <mitch@picman.org>

	* app/picmanimage.[ch]: renamed "restructure" to "alpha_changed" and
	only emit it in flatten(), not in merge_layers().

	* app/gimage.c
	* app/picmanlayer.c: changed accordingly.

	* app/widgets/picmancontainerlistview.c: set both scrollbar policies
	to automatic.

2001-05-06  Michael Natterer  <mitch@picman.org>

	* app/picmanimage.[ch]: renamed the "resize" signal to "size_changed".

	* app/gimage.c: changed accordingly.

	* app/undo.c: renamed the "shrink_wrap" to "size_changed", call
	picman_image_size_changed() and let the handlers do the work.

	* app/widgets/picmanlistitem.[ch]: added a virtual set_preview_size()
	method and a default implementation.

	* app/widgets/picmanlayerlistitem.c: added an inplementation of
	set_preview_size() which set's the size of the mask preview.

	* app/widgets/picmanchannellistview.c: implement set_preview_size()
	and set the size of the component previews.

	* app/widgets/picmancontainerlistview.c: call
	picman_list_item_set_preview_size() instead of resizing the preview
	manually.

	* app/widgets/picmancontainerview.c: emit "set_preview_size" even if
	the size has not changed so we can use it to re-calculate the
	preview size on image size change.

	* app/widgets/picmandrawablelistview.c: connect to the image's
	"size_changed" signal and trigger preview size re-calculation in
	the callback.

2001-05-06  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: added PicmanDropMode...
	* app/picmandnd.h: ...removed from here.

	* app/picmanimage.[ch]:
	- New signal "mode_changed".
	- removed "const PicmanImage*" from picman_image_colormap_changed()
	  because a signal emission is never "const" for the object
	  which emits the signal.
	- Fixed picman_image_[set|get]_component_[active|visible]():
	  ALPHA_CHANNEL maps to ALPHA_PIX only in RGB mode, use
	  ALPHA_G_PIX/ALPHA_I_PIX in GRAY/INDEXED mode.

	* app/picmanimage-convert.c
	* app/undo.c: call picman_image_mode_changed().

	* app/picmanviewable.c: added an implementation of
	"invalidate_preview" which frees the preview temp_buf which may be
	attached to the viewable. Subclasses need to chain up now.

	* app/picmandrawable.c
	* app/picmanimage.c: chain up in invalidate_preview().

	* app/widgets/picmanchannellistview.c: connect to the image's
	"mode_changed" signal and rebuild the channel list in the
	callback.

	* app/widgets/picmancontainerview.h: indentation.

	* app/widgets/picmandockbook.c: set the dockable's context to NULL
	in picman_dockbook_remove()

	* app/widgets/picmanimagedock.c: forgot to actually set the dock's
	image in picman_image_dock_new().

	* app/gui/dialogs-constructors.c: added a get_name_func() for tool
	views which returns the tool's "blurb". It's safe to assume now
	that a dockable's context will exist as long as the dockable
	exists unless it's explicitely set to NULL, so remove ugly hacks
	handling context destruction.

	* app/tools/picmantool.c: removed COMPAT_CRUFT and useless #include's.

2001-05-04  Michael Natterer  <mitch@picman.org>

	* configure.in
	* devel-docs/Makefile.am
	* devel-docs/libpicmancolor/*
	* devel-docs/libpicmanmath/*
	* devel-docs/libpicmanwidgets/*: added new gtk-doc modules for
	libpicmancolor, libpicmanmath and libpicmanwidgets. Moved existing
	documentation from the old files to the new templates.

	* devel-docs/libpicman/*: regenerated all files and removed the
	stuff which is in the new modules now.

	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.[ch]: some documentation fixes.

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in: updated.

2001-05-03  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h: removed typedefs from the widgets/ subdir.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h: new file.

	* app/widgets/picmancontainermenu.[ch]
	* app/widgets/picmancontainerview.[ch]: synced them again and added a
	"get_name_func" 

	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanmenuitem.[ch]: add a "get_name_func" and use it
	to get the item's name.

	* app/widgets/picmancontainerlistview.c
	* app/widgets/picmancontainermenuimpl.c: pass the get_name_func to
	the created items.

	* app/widgets/picmanchannellistview.c: gtk_widget_queue_resize() the
	component frame after changing the image.

	* app/widgets/picmancomponentlistitem.c: set a custom
	get_name_func() so the components are named Red, Green, ... again.

	* app/widgets/picmanimagedock.c: set a custom get_name_func() which
	returns names like in the old L&C dialog's image menu.

	* tools/pdbgen/Makefile.am: don't scan apptypes.h for enums.

2001-05-03  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: don't #include "gui/color-select.h"

	* app/disp_callbacks.[ch]: renamed gdisplay_drop_viewable() to
	gdisplay_drop_pattern().

	* app/picmanimage.[ch]: added new signals
	"component_visibility_changed" and "component_active_changed" and
	emit them in the resp. accessors.

	* app/interface.c: removed old PicmanPreview test code.

	* app/widgets/Makefile.am
	* app/apptypes.h
	* app/widgets/picmanchannellistview.[ch]
	* app/widgets/picmancomponentlistitem.[ch]: new (unfinished) widgets.

	* app/widgets/picmandockbook.c: switch to the right-clicked notebook
	page before showing the menu.

	* app/widgets/picmandrawablelistitem.[ch]: removed the protected
	functions which make the toggle buttons look nicer...

	* app/widgets/picmanlistitem.[ch]: ...and added them here.

	* app/widgets/picmandrawablelistview.[ch]: virtualized set_image()
	so subclasses can properly (dis)connect on image change.

	* app/widgets/picmandrawablepreview.c
	* app/widgets/picmanimagepreview.[ch]: removed the calc_size()
	functions which calculate the preview's aspect ratio...

	* app/widgets/picmanpreview.[ch]: ...and added then here as
	protected functions.

	* app/widgets/picmanlayerlistitem.c: flush displays after changing
	the layer mask's "apply" or "show" state.

2001-05-01  Michael Natterer  <mitch@picman.org>

	* app/picmanimage.h: removed prototype of function which doesn't
	exist.

	* app/widgets/picmanpreview.[ch]: new signal "extended_clicked"
	which is emitted instead of "clicked" if the user pressed shift,
	control or mod1 on button_press.

	* app/widgets/picmanlayerlistitem.c: use the "extended_clicked"
	signal to toggle the layer mask's "show" and "apply" states.

2001-05-01  Michael Natterer  <mitch@picman.org>

	* app/picmandnd.[ch]: Made file/url DND work like the other DND types.
	The drop callback gets passed a GList of filenames.
	Provide a default callback which calls file_open_with_display()
	for each filename.

	* app/docindex.c: changed accordingly.

	* app/gui/toolbox.c: same file DND changes and made dropping
	drawables work again with the new DND system.

	* app/widgets/picmandrawablelistview.c: properly disconnect from the
	image in "destroy".

	* app/widgets/picmanlayerlistitem.c: gtk_signal_connect_while_alive()
	to the layer's "mask_changed" signal.

2001-05-01  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: removed more GUI initialisation code.

	* app/color_transfer.c: removed useless includes.

	* app/gui/brush-editor.[ch]
	* app/gui/dialogs-constructors.c:
	s/BrushEditGeneratedWindow/BrushEditor/, s/begw/brush_editor/, made
	the brush preview of the editor autoresizing.

	* app/gui/dialogs.h: removed "extern" declaration of non-existant
	variable.

	* app/gui/gui.[ch]: new function gui_post_init() which shows the
	tips dialog.

	* app/gui/tips-dialog.c: made signal handling nicer (clean up in a
	"destroy" handler).

	* app/gui/toolbox.[ch]: removed toolbox_raise(), removed the help
	system (de)initialisation code which is now in gui.c, cleanup.

2001-04-30  Dave Neary  <dneary@eircom.net>

	* app/tools/tool_options.c: Ensure that option widgets are set to
	defaults on first call to the _init() function. 
	
2001-04-29  Garry R. Osgood  <grosgood@rcn.com>
	* plug-ins/plugin-helper/plugin-helper.c
	extensions don't have parameters,
	but helper_run() was asking anyway -
	and segfaulting. Commented out
	line for now; everything still seems
	prototypical in Plug In Helper Land.
	
2001-04-29  Michael Natterer  <mitch@picman.org>

	* app/picmanlayer.[ch]: added a "linked_changed" signal and emit it
	in picman_layer_set_linked().

	* app/gui/layers-dialog.c: use the accessor when setting "linked".

	* app/widgets/picmandrawablelistitem.[ch]: made the hacks which make
	the buttons look nice inside list items available to subclasses.

	* app/widgets/picmanlayerlistitem.[ch]: added a "linked" button.

2001-04-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.[ch]: added virtual method
	context_item() which works like select_item() and activate_item()
	and a function to trigger the signal from subclasses (marked as
	"protected").

	* app/widgets/picmancontainerlistview.c: invoke context_item() on
	right click.

	* app/widgets/picmandrawablelistview.[ch]: implement context_item()
	and show a context menu. The functions to show the menu as well as
	functions to create a new drawable and to edit it's attriutes must
	be passed to the constructor now.

	* app/gui/channels-commands.[ch]
	* app/gui/layers-commands.[ch]: added functions which show the
	layers and channels context menus. No accelerators supported yet.
	Auto-destroy all dialogs when their drawable is removed from the
	image.

	* app/gui/dialogs-constructors.c: changed the calls to
	picman_drawable_list_view_new() accordingly.

	* app/gui/menus.c
	* app/gui/test-commands.[ch]: removed some test dialogs.

2001-04-28  David Neary  <dneary@eircom.net>

	* app/tools/transform_options.[ch]: Separated the transform
	options stuff from the picmantransformtool files so that each of the
	transform tools to make is available to the other transform tools.

	* app/tools/picmantransformtool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/Makefile.am: Changed accordingly
	
2001-04-28  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: added RunModeType.
	* app/plug_in.h: removed RunModeType.
	* tools/pdbgen/Makefile.am: don't scan app/plug_in.h for enums.
	* tools/pdbgen/enums.pl: regenerated.

	* app/file-open.[ch]
	* app/file-save.[ch]
	* app/file-utils.[ch]: removed all GUI specific code.

	* app/gui/Makefile.am
	* app/gui/file-dialog-utils.[ch]
	* app/gui/file-open-dialog.[ch]
	* app/gui/file-save-dialog.[ch]: new files.
	Renamed file_open() to 	file_open_with_display().

	* app/app_procs.c
	* app/docindex.c
	* app/picmandnd.c
	* app/gui/commands.c
	* app/gui/gui.c
	* app/gui/menus.c: changed accordingly.

2001-04-27  Michael Natterer  <mitch@picman.org>

	* app/app_procs.[ch]: removed stuff which now lives in gui/gui.c,
	removed global variable "we_are_exiting", made app_init() static.

	* app/appenv.h: removed "we_are_exiting".

	* app/colormaps.c: don't #include "app_procs.h"

	* app/file-open.[ch]
	* app/file-save.[ch]: removed the *_pre_init() functions and
	renamed the *_post_init() functions to *_menu_init().

	* app/gui/gui.c: added more GUI init and shutdown code from
	app_procs.c

2001-04-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainermenuimpl.c: only work around option
	menu reference problems if the removed item was the active one.

	* app/widgets/picmanimagedock.c: don't try to avoid a recursive
	signal emission in picman_image_dock_image_changed() but work around
	it. This makes the image menu work finally.

	* app/gui/dialogs-constructors.c: removed debugging output.

2001-04-25  Michael Natterer  <mitch@picman.org>

	* app/picmanobject.c: free the object's name on destruction.

	* app/picmanparasite.c: picman_personal_rc_file()'s return value has
	to be g_free()'d.

	* app/main.c: indentation.

	Ported memleak fixes from 1.2:

	* app/picmanbrush.c: don't leak all pixmaps.

	* app/picmanbrushpipe.c: free all the pipe's brushes here.

2001-04-24  David Neary  <dneary@eircom.net>

	* app/authors.h: Synced this file from the earlier commit.

	* app/pixmaps2.h
	* app/pdb/tools_cmds.c
	* app/tools/Makefile.am
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanperspectivetool.h
	* app/tools/picmanrotatetool.c
	* app/tools/picmanrotatetool.h
	* app/tools/picmansheartool.c
	* app/tools/picmansheartool.h
	* app/tools/picmantool.c
	* app/tools/picmantool.h
	* app/tools/picmantransformtool.c
	* app/tools/tools.c
	* tools/pdbgen/pdb/tools.pdb:    Enabled the rest of the 
	transform tools and changed some of the options stuff in 
	transform_options_new(). There are one or two outstanding 
	(non-critical) runtime problems in that function.

2001-04-24  Michael Natterer  <mitch@picman.org>

	* app/authors.h: regenerated.

	* app/gui/dialogs-constructors.c: call the drawable views's
	set_context() function once explicitly after creation.

	* app/gui/dialogs.c
	* app/widgets/picmandialogfactory.[ch]: session management correctly
	remembers the dialogs' sizes again.

	* app/widgets/picmancontainermenuimpl.c: set the options menu's
	history to "0" after removing a menu item (temp hack because
	GtkOptionMenu doesn't handle the removal of the currently active
	item correctly).

	* app/widgets/picmanimagedock.c: another try to get dock->context's
	signals handled correctly. Debugging output will disappear soon.

2001-04-23  David Neary  <dneary@eircom.net>

        * AUTHORS: Added my name here before being politely
        informed that the file is autogenerated. Ooops!

        * tools/authorsgen/contributors: Added my name to the
        list of contributors.

2001-04-23  Michael Natterer  <mitch@picman.org>

	* app/picmancontext.[ch]: some minor fixes / cleanup.

	* app/picmandata.c: forgot to gtk_object_class_add_signals() in
	class_init().

	* app/gui/dialogs-constructors.[ch]: added a tool_tab_func() so
	the notebook tab shows a tool preview, pass a PicmanContext to all
	dialog constructors and added set_context() functions for all
	dockable based dialogs so they can be configured to use the
	context of the destination dock when dragging them around.

	* app/widgets/picmancontainermenuimpl.c: removed debugging output.

	* app/widgets/picmandialogfactory.[ch]: add a method to create
	dockables (which gets passed the dock the dockable will be added
	to) so the dockables can be created in the right context.

	* app/widgets/picmandock.[ch]: added a PicmanContext attribute, remove
	the dockbooks explicitely in destroy().

	* app/widgets/picmandockable.[ch]: dockables now know about their
	set_context_func() and can thus be dragged between different
	contexts.

	* app/widgets/picmandockbook.c: picman_dockbook_add(): refuse to add
	dockables to dockbooks which are not part of a dock, set the
	dockable's context after adding it.

	* app/widgets/picmanimagedock.[ch]: image docks now keep a pointer
	to the global image list which is passed to them on construction
	so they don't need to know about the global "image_context"
	variable, added an "Auto" button like in L&C.

	* app/gui/dialogs-commands.c: changed accordingly.

2001-04-23  Sven Neumann  <sven@picman.org>

	Merged Yosh's changes from stable branch:

	* acinclude.m4: updated libtool stuff

        * configure.in: more #undefs so jpeglib.h test works

        * plug-ins/common/bumpmap.c: speedup patch from Ernst Lippe
        <ernstl@planet.nl> (tile cache size optimization)

2001-04-23  Sven Neumann  <sven@picman.org>

	Merged changes from stable branch:
	
        * plug-ins/perl/examples/terral_text: fixed typo.

        * plug-ins/perl/examples/image_tile
        * plug-ins/perl/examples/yinyang: 
        applied picman-kirchgessner-010422-0.patch which fixes problems with 
        invalid number of parameters passed to some functions.

        * plug-ins/script-fu/interp_sliba.c: fixed problems with strbreakup 
        reported by Mike Kelly <mike@csuchico.edu> (bugs #52383 and #52385)

2001-04-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: cleanup.

	* app/interface.c: #include "picmanui.h"

	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c
	* app/gui/menus.c
	* app/gui/test-commands.[ch]: changes for the image menu below.

	* app/apptypes.h
	* app/widgets/Makefile.am
	* app/widgets/picmancontainermenu.[ch]
	* app/widgets/picmancontainermenuimpl.[ch]: new widgets. The actual
	implemtation lives in a separate file because
	picmancontainermenu.c's code is identical to picmancontainerview.c's
	except for the base class. This will become an interface with Gtk 2.0.

	* app/widgets/picmanimagedock.[ch]: a dock with an image menu. The
	pages still don't follow the context correctly.

	* app/widgets/picmanmenuitem.[ch]: a menu item with a preview.

	* app/widgets/picmandialogfactory.[ch]: pass a dock constructor to
	the constructor and provide a method to create a new dock within
	this factory's context.

	* app/widgets/picmandock.[ch]: removed the constructor because we
	create only image docks now. Put the vbox into a main_vbox (which
	also contains the image menu).

	* app/widgets/picmandockbook.[ch]: create new docks with the dialog
	factory.

	* app/picmancontainer.[ch]
	* app/picmandata.[ch]
	* app/picmandatafactory.[ch]
	* app/picmandatalist.[ch]
	* app/picmanlist.[ch]
	* app/picmanviewable.[ch]
	* app/widgets/picmanbrushpreview.[ch]
	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmancontainerlistview.[ch]
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandockable.[ch]
	* app/widgets/picmandrawablelistitem.[ch]
	* app/widgets/picmandrawablelistview.[ch]
	* app/widgets/picmandrawablepreview.[ch]
	* app/widgets/picmanlayerlistitem.[ch]
	* app/widgets/picmanlayerlistview.[ch]
	* app/widgets/picmanlistitem.[ch]
	* app/widgets/picmanpalettepreview.[ch]
	* app/widgets/picmanpatternpreview.[ch]
	* app/widgets/picmanpreview.[ch]: ass-sign some copyrights.

2001-04-21  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/lc_dialogP.h
	* app/paths_dialogP.h: removed stuff that will go away anyway (put
	the declarations to the public headers).

	* app/picmanui.[ch]: new function picman_widget_get_callback_context()
	which may only be called from a *_cmd_callback() and returns the
	data we attached with weird methods.

	* app/gui/Makefile.am
	* app/gui/channels-commands.[ch]: callbacks independent from the
	channels dialog and the "new" and "edit channel" dialogs.

	* app/gui/channels-dialog.[ch]
	* app/gui/layers-commands.c
	* app/gui/layers-dialog.[ch]
	* app/lc_dialog.[ch]
	* app/gui/menus.c
	* app/gui/paths-dialog.[ch]
	* app/tools/picmanbezierselecttool.c
	* po/POTFILES.in: changed accordingly.

2001-04-20  Michael Natterer  <mitch@picman.org>

	* app/picmanui.[ch]: new functions picman_window_add_accel_group() and
	picman_window_remove_accel_group() which do the ugly accel context
	hack described below.

	* app/interface.c
	* app/gui/layers-dialog.c: use the new functions.

	* app/disp_callbacks.c
	* app/gui/layers-commands.c: removed stuff which is now done
	automatically.

2001-04-20  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/layers_dialogP.h: removed.

	* app/picmanui.[ch]: new function picman_menu_position().

	* app/disp_callbacks.c
	* app/interface.c
	* app/gui/layers-dialog.c: popup the image and layers menu with
	gtk_item_factory_popup_with_data() instead of gtk_menu_popup()
	and pass the PicmanImage we're operating on as data.

	For accelerators, which are invoked without context, we catch key
	press events and attach the context to the GtkItemFactory.

	* app/gui/Makefile.am
	* app/gui/layers-commands.[ch]: common layer callbacks (instead of
	separate ones in commands.c and layers-dialog.c

	* app/gui/commands.[ch]
	* app/gui/layers-dialog.[ch]: removed the menu callbacks here.

	* app/gdisplay.h
	* app/lc_dialog.c
	* app/gui/channels-dialog.c
	* app/gui/layer-select.c
	* app/gui/menus.c
	* po/POTFILES.in: changed accordingly.

2001-04-20  Michael Natterer  <mitch@picman.org>

	* app/main.c: set the message handler for all app log domains, not
	only for "Picman".

	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-select.c: removed the "edit" callbacks.

	* app/gui/dialogs-constructors.[ch]: Added the callbacks
	here. Added layer and channel lists.

	* app/gui/dialogs.c: register the new lists.
	* app/gui/menus.c: their menu entries.

	* app/widgets/picmandock.c: set a minimal width of 280 pixels.

2001-04-19  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanclonetool.[ch]
	* app/tools/picmanconvolvetool.[ch]
	* app/tools/picmanpainttool.c
	* app/tools/picmantool.h
	* app/tools/paint_options.c
	* app/tools/tool_manager.c
	* app/tools/tools.c: Applied a patch from Dave Neary
	<dneary@eircom.net> which brings clone and convolve back.

	That's all paint tools, Dudes!

2001-04-19  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/brush_header.h
	* app/pattern_header.h
	* app/desaturate.[ch]
	* app/equalize.[ch]
	* app/invert.[ch]: removed.

	* app/picmanbrush-header.h
	* app/picmanpattern-header.h
	* app/picmandrawable-desaturate.[ch]
	* app/picmandrawable-equalize.[ch]
	* app/picmandrawable-invert.[ch]: new files.

	* app/gui/commands.c: put some stuff from desaturate, equalize and
	invert here. While it's ok to check the drawable type in the
	callback, this is the wrong place for PDB wrappers.

	* app/picmanbrush.c
	* app/picmanbrushpipe.c
	* app/picmanlayer.c
	* app/picmanpattern.c
	* app/pdb/color_cmds.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gih.c
	* plug-ins/common/pat.c
	* po/POTFILES.in
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

2001-04-18  Michael Natterer  <mitch@picman.org>

	* app/picmandrawable-offset.[ch]: renamed ChannelOffsetType to
	PicmanOffsetType.

	* app/pdb/channel_ops_cmds.c
	* libpicman/picmanchannelops_pdb.[ch]
	* tools/pdbgen/pdb/channel_ops.pdb: removed.

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: put the "offset" and "duplicate"
	functions where they belong.

	* app/gui/offset-dialog.c
	* app/pdb/Makefile.am
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/Makefile.am
	* libpicman/picman_pdb.h
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanenums.h
	* libpicman/picmanimage.h
	* libpicman/picmanimage_pdb.[ch]
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enumcode.pl
	* tools/pdbgen/enums.pl
	* tools/pdbgen/groups.pl
	* plug-ins/common/guillotine.c
	* plug-ins/print/print.c
	* plug-ins/script-fu/script-fu-constants.c: changed accordingly.

2001-04-18  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/channel_ops.[ch]: removed

	* app/picmandrawable-offset.[ch]
	* app/picmanimage-duplicate.[ch]: new files without GUI.

	* app/gui/Makefile.am
	* app/gui/offset-dialog.[ch]: new files.

	* app/gui/commands.c
	* app/pdb/channel_ops_cmds.c
	* po/POTFILES.in
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/channel_ops.pdb: changed accordingly.

2001-04-18  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/convert.[ch]: removed.
	* app/picmanimage-convert.[ch]: new files: the convert functionality
	without GUI (now called picman_image_convert()).

	* app/gui/Makefile.am
	* app/gui/convert-dialog.[ch]: new files.

	* app/gui/commands.c
	* app/pdb/convert_cmds.c
	* po/POTFILES.in
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl: changed accordingly.

2001-04-18  Michael Natterer  <mitch@picman.org>

	* app/devices.[ch]
	* app/gui/about-dialog.[ch]
	* app/gui/preferences-dialog.[ch]
	* app/gui/tips-dialog.[ch]: return a GtkWidget from the constructor.

	* app/gui/dialogs.c
	* app/gui/dialogs-constructors.[ch]: register them with the dialog
	factory.

	* app/gui/commands.[ch]
	* app/gui/menus.c: removed their old callbacks.

	* app/gui/brush-select.c
	* app/gui/gradient-select.c
	* app/gui/palette-editor.[ch]: no need to show or raise the shell
	(that's done by the dialog factory now).

	* app/widgets/picmandialogfactory.c: actually do what the
	"singleton" and "session_managed" flags say.

2001-04-18  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: commented the sections of the file list.
	* app/gui/Makefile.am: cleanup.

	* app/unittest/*: removed.

2001-04-17  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/gui/Makefile.am
	* app/about_dialog.[ch]
	* app/brush_edit.[ch]
	* app/brush_select.[ch]
	* app/channels_dialog.[ch]
	* app/color_area.[ch]
	* app/color_notebook.[ch]
	* app/color_select.[ch]
	* app/colormap_dialog.[ch]
	* app/commands.[ch]
	* app/file_new_dialog.[ch]
	* app/gradient_editor.[ch]
	* app/gradient_select.[ch]
	* app/indicator_area.[ch]
	* app/info_dialog.[ch]
	* app/info_window.[ch]
	* app/layer_select.[ch]
	* app/layers_dialog.[ch]
	* app/menus.[ch]
	* app/palette.[ch]
	* app/palette_import.[ch]
	* app/palette_select.[ch]
	* app/paths_dialog.[ch]
	* app/pattern_select.[ch]
	* app/preferences_dialog.[ch]
	* app/session.[ch]
	* app/test_commands.[ch]
	* app/tips_dialog.[ch]
	* app/toolbox.[ch]: moved to gui/ (s/_/-/ and some more useful
	filenames on the way).

	* app/app_procs.c
	* app/context_manager.c
	* app/convert.c
	* app/disp_callbacks.c
	* app/errorconsole.c
	* app/file-open.c
	* app/file-save.c
	* app/file-utils.c
	* app/gdisplay.c
	* app/gimage.c
	* app/picmanrc.c
	* app/image_new.c
	* app/interface.c
	* app/nav_window.c
	* app/path.c
	* app/plug_in.c
	* app/gui/dialogs-constructors.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmancolorpanel.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* po/POTFILES.in: changed accordingly.

2001-04-17  Michael Natterer  <mitch@picman.org>

	* app/session.[ch]
	* app/picmanrc.c: removed the old dialog session management code...

	* app/widgets/picmandialogfactory.[ch]: ...and manage all dialogs here.

	* app/gui/dialogs-constructors.[ch]: dialog factory compliant
	constructors for all session managed toplevel dialogs.

	* app/brush_select.[ch]
	* app/devices.[ch]
	* app/docindex.[ch]
	* app/errorconsole.[ch]
	* app/gradient_select.[ch]
	* app/info_dialog.c
	* app/lc_dialog.[ch]
	* app/palette.[ch]
	* app/pattern_select.[ch]
	* app/toolbox.[ch]
	* app/tools/tool_options_dialog.[ch]: all dialog constructors have
	to return the dialog now (even the legacy ones that will go away).
	Removed the session management code as this is now done for the
	dialogs, not by them.

	* app/app_procs.c
	* app/color_select.c
	* app/commands.[ch]
	* app/indicator_area.c
	* app/menus.c
	* app/palette_select.c
	* app/preferences_dialog.c
	* app/gui/dialogs.c
	* app/gui/dialogs-commands.[ch]
	* app/gui/gui.c
	* app/tools/picmantool.c
	* app/widgets/picmandock.c: changed accordingly.

2001-04-16  Michael Natterer  <mitch@picman.org>

	First attempt to get the docks session managed:

	* app/picmanrc.c: new picmanrc type "new-session-info" which will soon
	replace the original one.

	* app/menus.c
	* app/gui/dialogs.c: s/_/-/g in all dialog identifier strings.

	* app/session.[ch]: call the dialog factory's session functions.

	* app/test_commands.c: use the dialog factory to create the tabs.

	* app/gui/dialogs-commands.c
	* app/gui/dialogs-constructors.[ch]: the constructors return widgets,
	not dockables now.

	* app/widgets/picmandialogfactory.[ch]: maintain a list of dialog
	factories in the class struct. Added ugly code to do the PicmanDock
	session management.

	* app/gui/gui.c
	* app/widgets/picmandock.c: changed accordingly.

2001-04-15  Michael Natterer  <mitch@picman.org>

	* app/gui/Makefile.am: new files:

	* app/gui/gui.[ch]: the new place for the UI init and shutdown code.
	* app/gui/splash.[ch]: a separate file for the splash.

	* app/app_procs.c: removed lots of stuff. Still much UI code left.

2001-04-15  Michael Natterer  <mitch@picman.org>

	* app/menus.[ch]: changed all menus_get_*() functions to return
	the GtkItemFactory, not separate widget, and accel_group
	pointers. Disabled automatic tearoff item creation for all
	factories axcept the toolbox and image factory.

	* app/channels_dialog.c
	* app/file-open.c
	* app/file-save.c
	* app/interface.c
	* app/layers_dialog.c
	* app/paths_dialog.c
	* app/toolbox.c: changed accordingly.

2001-04-15  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/paletteP.h: removed

	* app/palette.[ch]
	* app/palette_select.c: changed accordingly.

	* app/Makefile.am
	* app/gui/Makefile.am: some more preparation for file moving.

2001-04-15  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: grouped the files together which will go to gui/.

	* app/widgets/picmandialogfactory.[ch]: maintain a list of open
	PicmanDocks for session management.

	* app/widgets/picmandock.c: register open docks with the dialog
	factory.

	* app/widgets/picmandockable.[ch]
	* app/widgets/picmandockbook.c: pass a pointer to the PicmanDockbook
	to the PicmanDockable's "get_tab" function because the function is
	called before the dockable is added to the dockbook.

	* app/test_commands.c
	* app/gui/dialogs-constructors.[ch]
	* app/gui/dialogs.c: changed accordingly.

2001-04-14  Michael Natterer  <mitch@picman.org>

	* app/menus.c: added some more dialog types.

	* app/gui/Makefile.am
	* app/gui/picmandialogfactory.[ch]: removed again...

	* app/widgets/Makefile.am
	* app/widgets/picmandialogfactory.[ch]: ...and added where it belongs.

	* app/gui/dialogs.c
	* app/widgets/picmandock.c: changed #include's

	* app/gui/dialogs-commands.c: dialogs can be removed via the menu
	now.

	* app/widgets/picmandockbook.c: ref the dockbook while the item
	factory is active because an item factory callback may destroy it
	(we need to add the hijacked GtkNotebook menu back to the
	notebook).

2001-04-14  Michael Natterer  <mitch@picman.org>

	* configure.in
	* app/Makefile.am
	* app/gui/Makefile.am: new directory which will contain all gui code
	except widgets (I was tired off adding new files to app/).

	* app/apptypes.h
	* app/gui/picmandialogfactory.[ch]: factory which produces dialogs
	from string descriptions. Should maybe go to widgets/.

	* app/gui/dialogs-commands.[ch]: callbacks for the new menu
	factory below.

	* app/gui/dialogs-constructors.[ch]: dialog constructors which are
	registered with the dialog factory.

	* app/gui/dialogs.[ch]: register the dialogs with the factory.

	* app/app_procs.c: call dialogs_register().

	* app/menus.[ch]: a new item factory for creating dialogs.

	* app/test_commands.c
	* app/widgets/picmandock.[ch]: added a dialog factory pointer to the
	PicmanDock struct.

	* app/widgets/picmandockbook.[ch]: badly (badly!) fiddle around with
	GtkNotebook's menu to get it integrated in the GtkItemFactory
	which produces new dialogs.

2001-04-13  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.[ch]: removed the ID system from the pdb/
	subdir...

	* app/picmanimage.[ch]: ...and temporarily added it back to PicmanImage.

	The ID stuff is not only used by the PDB but is a more general
	type of service which is needed for the PDB, DND and some parts of
	the GUI. Finally, a PicmanFactory class with subclasses for data
	objects, images etc. will maintain the ID spaces.

	* app/colormap_dialog.c
	* app/file-open.c
	* app/file-save.c
	* app/gdisplay.c
	* app/picmandnd.c
	* app/picmandrawable.c
	* app/info_window.c
	* app/lc_dialog.c
	* app/nav_window.c
	* app/palette_import.c
	* app/paths_dialog.c
	* app/plug_in.c
	* app/xcf.c
	* app/tools/picmantexttool.c
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/image.pdb: use PicmanImage's ID functions.

	* app/pdb/channel_cmds.c
	* app/pdb/channel_ops_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2001-04-13  Michael Natterer  <mitch@picman.org>

	* app/picmandnd.c: added a DND type for PicmanImage.

	* app/tools/tools.c: don't register bezier select twice.

	* app/widgets/picmandockbook.[ch]: hacked the popup menu a bit.

2001-04-11  Stanislav Brabec  <utx@penguin.cz> 

        On request of Martin Weber <martweb@gmx.net>: 
        * plug-ins/bmp/bmpread.c:
        PICMAN couldn't read bmp files with a bad chunk. This kind of files
        can be found in OS/2 1.x. 

2001-04-11  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmansmudgetool.[ch]
	* app/tools/picmantool.[ch]
	* app/tools/paint_options.c
	* app/tools/tool_manager.c
	* app/tools/tools.c
	* app/pdb/tools_cmds.c
	* tools/pdbgen/pdb/tools.pdb: applied a (slightly modified) patch
	from Dave Neary <dave.neary@palamon.ie> which reactivates the
	smudge tool.

2001-04-11  Michael Natterer  <mitch@picman.org>

	* app/test_commands.c: fixed the dockable names.

	* app/tools/picmanbezierselecttool.c: applied patch from Dave Neary
	which fixes some minor stuff that was forgotten to port.

	* app/widgets/picmandockbook.c: set the tooltip of the notebook tab
	also if it is a plain label.

2001-04-11  Simon Budig  <simon@picman.org>

	* app/tools/picmanpathtool.[ch]
	* app/tools/path_tool.[ch]

	Some tweaks to make gcc and mitch more happy.

2001-04-11  Simon Budig  <simon@picman.org>

	* app/path_curves.[ch]
	* app/tools/picmandrawtool.c
	* app/tools/picmanpathtool.[ch]
	* app/tools/path_tool.[ch]
	* app/tools/path_toolP.h

	At least now it looks as if it could do something sometimes...

2001-04-11  Michael Natterer  <mitch@picman.org>

	* configure.in
	* app/widgets/*: new directory containing all widgets. Some of them
	will go to libpicmanwidgets.

	* app/color_panel.[ch]
	* app/picmanbrushpreview.[ch]
	* app/picmanconstrainedhwrapbox.[ch]
	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]
	* app/picmancontainerview.[ch]
	* app/picmandatafactoryview.[ch]
	* app/picmandock.[ch]
	* app/picmandockable.[ch]
	* app/picmandockbook.[ch]
	* app/picmandrawablelistitem.[ch]
	* app/picmandrawablelistview.[ch]
	* app/picmandrawablepreview.[ch]
	* app/picmangradientpreview.[ch]
	* app/picmanimagepreview.[ch]
	* app/picmanlayerlistitem.[ch]
	* app/picmanlayerlistview.{ch]
	* app/picmanlistitem.[ch]
	* app/picmanpalettepreview.[ch]
	* app/picmanpatternpreview.[ch]
	* app/picmanpreview.[ch]
	* app/picmantoolinfopreview.[ch]
	* app/gtkhwrapbox.[ch]
	* app/gtkvwrapbox.[ch]
	* app/gtkwrapbox.[ch]
	* app/histogramwidget.[ch]: removed from here.

	* app/Makefile.am
	* app/appenums.h
	* app/brush_select.c
	* app/channels_dialog.c
	* app/devices.c
	* app/picmandnd.c
	* app/picmandrawable-preview.c
	* app/picmanhistogram.h
	* app/gradient_editor.c
	* app/gradient_select.c
	* app/indicator_area.c
	* app/info_window.c
	* app/palette.c
	* app/palette_select.c
	* app/pattern_select.c
	* app/qmask.c
	* app/test_commands.c
	* app/toolbox.c
	* app/pdb/color_cmds.c
	* app/tools/paint_options.c
	* app/tools/tool_options_dialog.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

2001-04-10  Michael Natterer  <mitch@picman.org>

	* app/picmandock.c: started to add some more separator event handling.

	* app/picmanpalettepreview.c: we don't want a popup if n_colors == 0.

	* app/test_commands.c: cleanup.

2001-04-10  Sven Neumann  <sven@picman.org>

        * app/tools/posterize.c
        * plug-ins/common/fractaltrace.c
        * plug-ins/common/illusion.c
        * plug-ins/flame/flame.c
        * plug-ins/gfig/gfig.c
        * plug-ins/picmanressionist/general.c
        * plug-ins/imagemap/imap_cmd_guides.c
        * plug-ins/mosaic/mosaic.c
        * plug-ins/winsnap/winsnap.c: merged i18n fixes from stable branch

2001-04-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmandockbook.[ch]: new object (the notebook separated out
	of picmandock.[ch]).

	* app/picmandnd.h: new DND type "DIALOG".

	* app/picmandock.[ch]
	* app/picmandockable.[ch]: DND mostly works now.

	* app/menus.c
	* app/test_commands.[ch]: updated.

2001-04-08  Sven Neumann  <sven@picman.org>

        * plug-ins/bmp/bmp.c
        * plug-ins/common/jpeg.c
        * plug-ins/common/mpeg.c
        * plug-ins/common/png.c
        * plug-ins/common/tiff.c
        * plug-ins/common/xpm.c
        * plug-ins/twain/twain.c
        * plug-ins/winsnap/winsnap.c: ported I18N initialization fixes from
	stable branch

2001-04-07  Michael Natterer  <mitch@picman.org>

	* app/paint_funcs.c
	* app/paint_funcs.h
	* app/paint_funcs_simd.S: removed the old files.

	* tools/pdbgen/Makefile.am
	* app/app_procs.c
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/desaturate.c
	* app/disp_callbacks.c
	* app/floating_sel.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmanchannel.c
	* app/picmandrawable-preview.c
	* app/picmandrawable.c
	* app/picmanimage.c
	* app/picmanlayer.c
	* app/picmanlayermask.c
	* app/global_edit.c
	* app/image_map.c
	* app/image_new.c
	* app/layers_dialog.c
	* app/temp_buf.c
	* app/toolbox.c
	* app/undo.c
	* app/undo_history.c
	* app/paint-funcs/paint-funcs.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c: changed accordingly.

2001-04-07  Simon Budig  <simon@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/path_bezier.[ch]
	* app/path_curves.[ch]
	* app/pixmaps2.h
	* app/tools/Makefile.am
	* app/tools/picmandrawtool.[ch]
	* app/tools/path_tool.[ch]
	* app/tools/path_toolP.h
	* app/tools/tools.c

	new files:
	* app/tools/picmanpathtool.c
	* app/tools/picmanpathtool.h

	Reactivated (at least partially) the old new path tool. It
	will undergo major restructuring. Especially the path stuff 
	will become proper objects. This definitely is work in progress
	and totally unuseable now.

2001-04-07  Michael Natterer  <mitch@picman.org>

	* configure.in
	* app/Makefile.am
	* app/paint-funcs/.cvsignore
	* app/paint-funcs/Makefile.am: made the paint-funcs directory compile
	so Prof can continue hacking it. The old stuff still needs to be
	removed.

	* app/apptypes.h
	* app/picmandock.[ch]
	* app/picmandockable.[ch]: new widgets (not used yet).

	* app/menus.c
	* app/test_commands.[ch]: untested testing code for the new widgets.

2001-04-07  Daniel Egger  <egger@suse.de>

	* app/paint-funcs/paint-funcs-gray.[ch]
	* app/paint-funcs/paint-funcs-graya.[ch]
	* app/paint-funcs/paint-funcs-indexed.[ch]
	* app/paint-funcs/paint-funcs-indexeda.[ch]
	* app/paint-funcs/paint-funcs-rgb.[ch]
	* app/paint-funcs/paint-funcs-rgba.[ch]: Added new files seperated
	and specialised from paint_funcs.c. Not used so far.

2001-04-07  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanairbrushtool.c
	* app/tools/picmandodgeburntool.[ch]
	* app/tools/picmanerasertool.c
	* app/tools/picmanpaintbrushtool.[ch]
	* app/tools/picmanpenciltool.c
	* app/pdb/tools_cmds.c
	* tools/pdbgen/pdb/tools.pdb: general cleanup of all paint tools we
	have so far: reordered/renamed functions to make them look the same,
	minor fixes in all files.

2001-04-06  Stanislav Brabec  <utx@penguin.cz> 

        On request of Martin Weber <martweb@gmx.net>:
        * plugins/common/tga.c: Fixed bug #52728 - problem in loading
        compressed and uncompressed 15 bit tga, compressed 16 bit tga
        files and removed a false warning for 32 bit tga files.

2001-04-02  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/detect_mmx.S
	* app/arch/i386/mmx/detect_mmx.S
	* app/arch/i386/mmx/paint_funcs_mmx.S
	* app/arch/i386/mmx/paint_funcs_mmx.S.m4: split MMX detection out
	of paint_funcs_mmx.S and replaced it with a working version (the 
	old one used to execute an illegal instruction on non-MMX systems).

2001-04-01  Simon Budig  <simon@picman.org>

	* nearly all files:
	
	Changed all GUI-Stuff back to Motif (see www.openmotif.org).
	Finally we have a professional toolkit here. When you need some
	reasons, why GTK+ sucks: See
	      http://unix.oreilly.com/news/motif_0400.html

2001-04-01  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanairbrushtool.[ch]: back again.

	* app/tools/picmantool.[ch]
	* app/tools/paint_options.c
	* app/tools/tool_manager.c
	* app/tools/tools.c: changed accordingly.

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h
	* app/tools/tool_options_dialog.c: pass the ToolOptions to the
	ToolOptionsResetFunc instead of a useless (void).

	* app/tools/paint_options.[ch]
	* app/tools/selection_options.[ch]: pass ToolOptions pointers here too.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c: changed accordingly. Removed many
	"reset" callbacks which just redirected the call to
	paint_options_reset() or selection_options_reset().

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/undo.c: made undo_pop_paint() work again.

	* app/tools/picmanpainttool.[ch]: store the tool ID and the tool
	type in the PaintUndo struct.

	* app/tools/picmanpenciltool.c: removed unused variable.

	* app/tools/picmantool.c: removed and reordered STUB()s and cruft.

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanfliptool.[ch]: applied a patch from Dave Neary
	which re-activates this tool. Enabled the tool options too.

	* app/tools/picmanbezierselecttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmantexttool.c: trivial fixes.

	* app/tools/picmantool.c: removed cruft.

	* app/tools/picmantransformtool.[ch]: a special case for the flip
	tool, cleanup.

	* app/tools/tools.c: register the flip tool.

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/tools/bezier_select.[ch]
	* app/tools/bezier_selectP.h
	* app/tools/transform_core.[ch]
	* app/tools/transform_tool.[ch]: removed.

	* app/tools/Makefile.am
	* po/POTFILES.in: changed accordingly.

	* app/tools/picmanbezierselecttool.c: indentation fixes.

	* app/tools/picmandodgeburntool.[ch]: made cursor toggling work
	again, cleanup.

	* app/tools/picmanscaletool.[ch]
	* app/tools/picmantool.c: minor cleanups like removing STUB()s.

	* app/tools/tool_manager.c: applied patch from Dave Neary which
	returns useful PDB strings for the paint tools again.

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/undo.c: re-enabled transform undo. Fixes the transform tool
	crashes.

	* app/tools/picmantool.[ch]: put tool->ID back because the undo
	system uses it. Also, a unique tool serial number will be not too
	bad to have once we have module tools.

	* app/tools/picmantransformtool.[ch]: changed accordingly.

2001-03-31  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/pixel_surround.[ch]: lowlevel stuff taken out of the transform
	tool.

	* app/tools/picmanscaletool.[ch]: minor cleanups, declare
	picman_scale_tool_register() publically.

	* app/tools/picmantransformtool.[ch]: removed the PixelSurround stuff,
	hardcode tr_tool->interactive to TRUE, removed the no_draw() function,
	register the tool options, misc. other fixes and bad hacks that need
	to go away.

	(All this non-interactive stuff needs to be done outside the tool
	system. A "non-interactive tool" is just pure nonsense)

	* app/tools/picmantool.h: spacing.

	* app/tools/tool_manager.c: tool_manager_register_tool_options():
	return after warning, don't simply continue and crash.

	* app/tools/tools.c: register the bezier select tool.

2001-03-30  Michael Natterer  <mitch@picman.org>

	* app/devices.c
	* app/disp_callbacks.c
	* app/picmanrc.c
	* app/scroll.c
	* app/tools/picmanpainttool.[ch]
	* modules/colorsel_water.c: removed the GTK_HAVE_SIX_VALUATORS stuff
	in preparation of gtk 2.0 migration.

2001-03-30  Michael Natterer  <mitch@picman.org>

	* app/fileops.[ch]
	* app/fileopsP.h: removed...

	* app/file-open.[ch]
	* app/file-save.[ch]
	* app/file-utils.[ch]: ...and split up into more hackable chunks.
	(didn't change any logic, just moved the functions around)

	* app/Makefile.am
	* app/app_procs.c
	* app/commands.c
	* app/docindex.c
	* app/picmandnd.c
	* app/picmanrc.c
	* app/menus.c
	* app/pdb/fileops_cmds.c
	* po/POTFILES.in
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly (mostly changing
	#include's).

2001-03-30  Michael Natterer  <mitch@picman.org>

	* app/app_procs.[ch]: some random cleanups in pre-historic code.

	* app/fileops.c: useless cleanup (will be split into file-open.[ch]
	and file-save.[ch] soon).

	* app/picmanpattern.c: implement PicmanData's "duplicate" method.

	* app/global_edit.c: cleanup in preparation for making a view on a
	PicmanContainer of cut buffers out of it.

	* app/gradient_editor.c: don't let the name entry expand vertically.

	* app/menus.c: typos.

2001-03-25 Seth Burgess <sjburges@picman.org>

        * app/tools/picmanbezierselecttool.[ch]: added new files from
	Dave Neary <dneary@eircom.net> to give back bezier curves.  This
	might be entirely replaced at some future point.
	
	* app/Makefile.am
	* app/apptypes.h
	* app/path.[ch]
	* app/path_bezier.[ch]
	* app/paths_dialog.c
	* app/paths_dialogP.h
	* app/tools/Makefile.am
	* app/tools/picmaniscissorstool.c
	* app/tools/picmantool.c: applied patches to let bezier work again.

2001-03-25 Seth Burgess <sjburges@picman.org>
	
	* app/tools/paint_options.c : applied 1-line patch by Dave Neary
	<dneary@eircom.net> that takes away the warning on startup of 
	dodgeburn.

2001-03-25 18:16:50  Adam D. Moss <adam@picman.org>

	* app/convert.c: Define accessor function/macro for histogram
	reads and writes.  This slows us down a little because we avoid
	some of the dirty tricks we used when we knew that the histogram
	was a straight 3d array, so I've recovered some of the speed loss
	by implementing a 5d accessor function with good locality of
	reference.  This change is the first step towards quantizing in a
	more interesting colourspace than frumpy old RGB.

2001-03-24  Nathan Summers <rock@picman.org>

	* app/tools/picmanscaletool.[ch]: Made the scale tool work again.
	Doesn't draw on the screen correctly, but works if you set the
	size in the dialog box.  Fixing the path tool should solve the
	problem.  Don't you love wierd dependancies?
	
	* app/tools/picmantool.c: stubbed some more path tool functions.
	
	* app/tools/picmantransformtool.[ch]: fixed some serious problems.
	I can't believe Picman linked before!

	* app/tools/Makefile.am
	* app/tools/tools.c 
	* tools/pdbgen/pdb/tools.pdb: changed accordingly

2001-03-23  Seth Burgess <sjburges@picman.org>

	* po-plug-ins/ro.po
	* po-script-fu/ro.po
	* po-libpicman/ro.po
	* plug-ins/perl/po/ro.po
	* plug-ins/perl/po/tr.po : added empty translation files so it would 
	compile again.  Translators, please add these when you add a new 
	language, even if they're blank!

2001-03-23  Seth Burgess <sjburges@picman.org>
	
	* app/tools/Makefile.am
	* app/tools/picmandodgeburntool.[ch]: dodgeburn works again.  Non-GUI
	disabled, some dialog bugs (gtk complains profusely) hanging around 
	still.

	* app/tools/picmantool.[ch]
	* app/tools/picmanpainttool.c
	* app/tools/paint_options.c
	* app/tools/tools.c: changed accordingly.
 

2001-03-23  Marius Andreiana  <mandreiana@yahoo.com>

	* configure.in: Added ro (Romanian) to ALL_LINGUAS

2001-03-22  Stanislav Brabec  <utx@penguin.cz>  

        * app/tools/picmanbucketfilltool.c: Bucket fill threshold=0 must
        be allowed.

2001-03-18  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/app.pl: guard inclusion of <process.h> by G_OS_WIN32
	* tools/pdbgen/lib.pl: add include <string.h> if the generated code
	used memcpy().
	
	* tools/pdbgen/pdb/fileops.pdb: include process.h for G_OS_WIN32.

	* libpicman/picmanbrushes_pdb.c
	* libpicman/picmandrawable_pdb.c
	* libpicman/picmangradients_pdb.c
	* libpicman/picmangradientselect_pdb.c
	* libpicman/picmanimage_pdb.c
	* libpicman/picmanpaths_pdb.c
	* libpicman/picmanpatterns_pdb.c
	* libpicman/picmanproceduraldb_pdb.c
	* tools/pdbgen/pdb/fileops.pdb: regenerated

2001-03-16  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/gqbist.c : #define PATH_MAX as _MAX_PATH
	if it isn't defined

	* plug-ins/common/gz.c : #include <io.h> for win32 _get_osfhandle ()

	* plug-ins/gflare/gflare.c : #include <gtk/gtk.h> before using
	G_OS_WIN32

	* plug-ins/twain/twain.c : provide a main () entry point to allow
	to build as console application as well

2001-03-16  Hans Breuer  <hans@breuer.org>

	* app/makefile.msc
	* app/tools/makefile.msc : adapted to current state of file 
	renaming/restructuring. Probably will break again soon ...

	* app/context_manager.c : needs register_tools () prototype

	* app/picmanlist.c
	* app/picmanpalette-import.c : #include <string.h> for memcpy, strcmp 
	and friends

	* app/pdb/fileops_cmds.c : #include <process.h>	/* for _getpid() */
	(Yes I know that this is not the right place to change it, but hacking 
	pdbgen.pl to get platform specific headers is out of my scope)

	* app/test_commands.c : explicit casts to (PicmanSetDrawableFunc) make
	it compile even with strict checks turned on.

	* app/undo.c (undo_pop_paint) : return a value even if the function 
	does nothing at the moment (makes it compile)

	* libpicman/picman.def : updated

	* libpicman/picmancolorselector.h : include <gmodule.h> to make 
	picman_color_selector_(un)register prototypes conform to their
	implementation

	* libpicman/picmanfeatures.h : reflect 1.3 version

	* libpicmanmath/picmanmatrix.c
	* libpicmanwidgets/picmandialog.c : more <string.h> inclusion

	* libpicman/makefile.msc : moved picmanadativesupersample.c to 
	libpicmancolor, which makes it reusable from the core, too.

	* libpicman/picman.def : updated

	* libpicman/picmanproceduraledb.c : #include <string.h>

	* libpicmancolor/picmancolor.def
	* libpicmancolor/makefile.msc : added picmanadaptivesupersample

	* libpicmanmath/picmanmatrix.c : #include <string.h> for memcmp
	* libpicmanwidgets/picmandialog.c - " - for strcmp


2001-03-15 14:51:59Z  Marc Lehmann <pcg@goof.com>

	* picmantool-1.4.in: Fix --libs-noui so that plug-ins link against
        the new library names.
        * configure.in: Added the libtool-limitation-workaround to PICMAN_LIBS*
        env vars so that picman-perl works again.

2001-03-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: applied patch from 
        Tom Holroyd <tomh@po.crl.go.jp> which fixes wrong array size.

2001-03-14  Nathan Summers <rock@picman.org>

	* tools/picmantransformtool.[ch]: merged in all the old transform
        tool code.

        * tools/picmantool.h: added dummy GtkTypes for all the transform tools.

2001-03-13  Fatih Demir <kabalak@gtranslator.org>

	* configure.in: Added "tr" into ALL_LINGUAS..

2001-03-12  Simon Budig  <simon@picman.org>

	* pixmaps/wilber.xpm: Fixed one pixel.

2001-03-12  Michael Natterer  <mitch@picman.org>

	* app/picmanlayerlistview.c: added some help_data and tooltips.

	* app/tools/Makefile.am
	* app/tools/picmanerasertool.[ch]: one more.

	* app/tools/picmanpaintbrushtool.[ch]
	* app/tools/picmanpenciltool.[ch]: made all paint tools look the same.

	* app/tools/picmanpainttool.c
	* app/tools/picmantool.[ch]
	* app/tools/paint_options.c
	* app/tools/tools.c: changed accordingly.

	* pixmaps/anchor.xpm: made it a bit smaller.

	* pixmaps/refresh.xpm: replaced with the "Recurrence" icon from
	evolution.

2001-03-12  Michael Natterer  <mitch@picman.org>

	* pixmaps/Makefile.am
	* pixmaps/edit.xpm: new pixmap. "Someone" needs to go over the
	pixmaps one day ;)

	* app/picmandatafactoryview.c
	* app/picmandrawablelistview.c: use the new icon.

	* app/floating_sel.c: stupid: the new picman_layer_get_opacity()
	accessor speaks in normalized [0.0..1.0] values, so the
	floating selection was invisible after blindly using it.

	* app/picmanimage.c: more stupid: a totally useless sanity clamping
	made the composite preview ugly. Fixed.

	* app/tools/tool_manager.c: why the heck did this never crash before:
	don't dereference a NULL GDisplay pointer.

2001-03-11  Seth Burgess      <sjburges@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanpenciltool.[ch]: no. 16 for your 
	pixelling pleasure.

	* app/tools/picmantool.[ch]
	* app/tools/paint_options.c
	* app/tools/tools.c: changed accordingly.
	
2001-03-11  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmaniscissorstool.[ch]: no. 15 is alive.

	* app/tools/picmantool.[ch]
	* app/tools/selection_options.c
	* app/tools/tools.c: changed accordingly.

2001-03-11  Michael Natterer  <mitch@picman.org>

	* app/picmanlayerlistview.c: minor cleanups.

	* app/tools/Makefile.am
	* app/tools/picmanblendtool.[ch]: back again.

	* app/tools/picmantool.[ch]
	* app/tools/paint_options.c
	* app/tools/tools.c: changed accordingly.

2001-03-11  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmanlayerlistview.[ch]: new subclass of PicmanDrawableListView
	(the upcoming replacement of the layers dialog). Connects to the
	new PicmanLayer signals using the layer container as signal proxy
	(see below).

	* app/picmancontainerview.[ch]: made "set_container" a virtual
	function.  This is needed by the PicmanLayerListView to
	connect/disconnect signals. Subclasses implementing this method
	MUST obey the following order of instructions:

	1. disconnect from signals related to PicmanContainerView->container
	2. chain up (!!!)
	3. connect to signals related to PicmanContainerView->container

	And yes, I will add DocBook files for all those new objects :)

	* app/picmanpreview.[ch]: made "border_color" a PicmanRGB instead of
	guchar[3]. Added picman_preview_set_border_color().

	* app/picmancontainergridview.c
	* app/picmanlayerlistitem.c: use picman_preview_set_border_color().

	* app/picmancontainerlistview.c
	* app/picmandrawablelistview.c: cleanup.

	* app/picmandrawablelistitem.c: we can safely asume that our parent
	widget is a PicmanDrawableListView and use it's "reorder_drawable"
	function pointer (after checking that it's there).

	* app/picmanlistitem.c: connect the correct DND type when changing
	the container of a list item with "reorderable" enabled.

	* app/picmanlayer.[ch]: added accessors and "*_changed" signals for
	layer->mode, layer->opacity and layer->preserve_trans.

	* app/disp_callbacks.c: fixed a FIXME: use the correct bucket fill
	tool context again.

	* app/tools/paint_options.[ch]: paint_mode_menu_new(): added a
	boolean which toggles the "Behind" item on/off to the same
	constructor can be used for all paint mode menus.

	* app/tools/picmantoolinfo.c: rect. select is the standard tool again.

	* app/brush_select.c
	* app/floating_sel.c
	* app/picmanimage.c
	* app/layers_dialog.c
	* app/pdb/layer_cmds.c
	* app/tools/picmaneditselectiontool.c
	* tools/pdbgen/pdb/layer.pdb: use the new layer accessors and the
	paint_mode_menu constructor.

	* app/commands.c
	* app/gdisplay.c
	* app/menus.c
	* app/undo.c
	* app/tools/picmanpainttool.c
	* app/tools/picmantool.c
	* app/tools/paint_options.c
	* app/tools/tool_manager.c: put the #warning's back inside
	#ifdef __GNUC__

2001-03-10  Daniel Egger  <egger@suse.de>

	* plug-ins/common/sobel.c: Applied patch from
	Austin Donnelly to fix rendering of the topmost
	scanline.

2001-03-10  Garry R. Osgood <grosgood@rcn.com>
	
	* app/Makefile.am
	Inclusion of David's MMX code into Makefile now 
	depends on prior definition of HAVE_ASM_MMX.
	* app/pdb/procedural_db.c
	Line 276 cast of va_args to type PicmanRGB seems
	very problematical on SGI, as the va_args macro
	expands to Extreme Ugliness and 
	(PicmanRGB)(Extreme Ugliness) does not compile.
	RH Linux seems indifferent and accepts either.
	* app/commands.c
	* app/gdisplay.c
	* app/menus.c
 	* app/plug_in_cmds.c
	* app/undo.c
	* app/tools/picmanpainttool.c
 	* app/tools/picmantool.c
	* app/tools/paint_options.c
	* app/tools/tool_manager.c
	s|#<remark about extreme buggedness>| 
	/* #<remark about extreme buggedness> */|
	Not all compilers are at peace with non-standard 
	pre-compiler directives. SGI MIPs compilers are 
	among the latter species.	
	
2001-03-11  Tor Lillqvist  <tml@iki.fi>

	* plug-ins/common/winclipboard.c: Enhance to also be able to paste
	BI_BITFIELDS images, 16- or 32-bit. Global indentation and spacing
	fix (use cvs diff -bu2 to see the real differences).

2001-03-09  Nathan Summers <rock@picman.org>

	* app/tools/picmantransformtool.[ch]: it compiles, but probably isn't 
	useful

	* app/tools/Makefile.am: changed accordingly

2001-03-09  Zach Beane  <xach@mint.net>

	* TODO.xml: Added "Open into layer" entry.

2001-03-09  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/rect_selectP.h: removed.

	* app/tools/picmanfreeselecttool.[ch]
	* app/tools/picmanfuzzyselecttool.[ch]: reactivated.

	* app/tools/picmantool.[ch]: removed STUB()s and old crap.

	* app/tools/tools.c: register the new tools.

	* app/disp_callbacks.c
	* app/tools/selection_options.c: changed accordingly.

	* app/apptypes.h
	* app/tools/picmanrectselecttool.c: cleanup.

2001-03-09  Nathan Summers <rock@picman.org>

	* app/tools/picmantransformtool.[ch]: More work on the transform tool.
	Still does not compile, but it's much closer.

	* app/tools/Makefile.am
	* app/apptypes.h
	* app/undo.c: changed accordingly

2001-03-08  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanellipseselecttool.[ch]
	* app/tools/picmanrectselecttool.[ch]: new objects based on a (heavily
	modified) patch by Dave Neary <dneary@eircom.net>.

	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmantool.[ch]
	* app/tools/selection_options.c
	* app/tools/tools.c: changed accordingly.

2001-03-08  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h
	* app/channel_ops.c
	* app/commands.c
	* app/convert.[ch]
	* app/fileops.c
	* app/floating_sel.c
	* app/gimage.h
	* app/gimage_mask.[ch]
	* app/picmanchannel.c
	* app/global_edit.h
	* app/image_map.c
	* app/layer_select.[ch]
	* app/layers_dialogP.h
	* app/lc_dialog.c
	* app/resize.c
	* app/toolbox.c
	* app/undo.h
	* app/undo_history.c
	* app/xcf.c
	* app/tools/picmanbycolorselecttool.h
	* app/tools/picmancroptool.[ch]
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanpainttool.c
	* app/tools/transform_core.h: removed the GImage typedef, cleanup.

2001-03-08  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/[almost *]: lots of files renamed to picman*tool.[ch]

	* app/commands.c
	* app/context_manager.c
	* app/disp_callbacks.c
	* app/gdisplay.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmandnd.c
	* app/picmanrc.c
	* app/global_edit.c
	* app/info_window.c
	* app/scale.c
	* app/scroll.c
	* app/undo.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c
	* po/POTFILES.in
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly.

2001-03-06  Simon Budig  <simon@picman.org>
	
	* app/mit.[ch]: Increased Mitch's age by one. Hopefully
	this won't break everything.

2001-03-06  Michael Natterer  <mitch@picman.org>

	* app/gimage.[ch]: removed the layer mask functions.

	* app/picmanchannel.[ch]: added a boolean "dummy" parameter to
	picman_channel_copy() so it has the same signature as
	picman_layer_copy() and can be used by the PicmanDrawableListView to
	generically duplicate drawables.

	* app/picmancontainerview.c: call "select_item" with a NULL item
	before changing the underlying PicmanContainer so subclasses have
	a chance to update (e.g. set button sensitivity).

	* app/picmandnd.c: folded all the GtkType comparing code into a
	utility function (much more readable now).

	* app/picmandrawablelistview.[ch]: activated the "raise", "lower",
	"duplicate" and "delete" buttons. I'm not really happy with all
	those function pointers passed to the constructor (and the dummy
	parameters I've added to some PicmanChannel functions) -- OTOH the
	generic view maybe worth the "gboolean dummy" cruft hanging around
	in the channel class.

	* app/picmanlayer.[ch]: removed the "apply_mask", "edit_mask" and
	"show_mask" booleans ...

	* app/picmanlayermask.[ch]: .. and added them here together with
	proper accessors and "*_changed" signals.

	This also makes the layer mask undo code much clearer as we don't
	have to store the booleans separately.

	* app/picmanlayerlistitem.c: badly hacked to acheive the correct
	indicator being drawn around the active drawable. This needs
	a new PicmanPreview function for setting the border color.

	* app/picmanlistitem.c: smaller horizontal spacing.

	* app/picmanpreview.[ch]: added the "border_width" parameter also to
	picman_preview_set_size() so we can modify all previews the same way
	after creation.

	* app/layers_dialog.c: no need to push an undo group around
	the "duplicate layer" code. Was this an artefact or did I miss
	something here ???

	* app/channel_ops.c
	* app/channels_dialog.c
	* app/gimage_mask.c
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmandrawablelistitem.c
	* app/picmanimage.[ch]
	* app/qmask.c
	* app/test_commands.c
	* app/undo.c
	* app/xcf.c
	* app/pdb/channel_cmds.c
	* tools/pdbgen/pdb/channel.pdb
	* app/pdb/selection_cmds.c
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]
	* tools/pdbgen/pdb/layer.pdb: commented out the layer mask accessors
	from the perl code, so the functions temporarily disappeared all
	over the place.

	* plug-ins/Makefile.am: don't build XJT until the layer mask stuff
	is back.

	* pixmaps/eye.xpm: cropped it to it's minimal size.

2001-03-05  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmanimage-undo.[ch]
	* app/picmanundo.[ch]
	* app/picmanundostack.[ch]: added new PicmanUndo and PicmanUndoStack objects 
	which will be used for the upcoming new undo system. Actually my 
	current plan for the undo system is to keep it pretty much as it is...
	
	* app/picmanimage.[ch]: added new PicmanUndoStacks but temporarily kept
	old GSLists around, so I don't break everything now.

2001-03-04  Michael Natterer  <mitch@picman.org>

	* app/picmanbrushpreview.c
	* app/picmangradientpreview.c
	* app/picmanpalettepreview.c
	* app/picmanpatternpreview.c
	* app/picmantoolinfopreview.c: removed all dnd code ...

	* app/picmanpreview.c: ... and put it where is belongs.

	* app/picmancontext.c: use g_type_is_a() instead of comparing the
	types directly.

	* app/picmandnd.[ch]: same g_type_is_a() fix here. New function
	picman_dnd_viewable_source_unset().

	* app/picmandrawablelistitem.c: gtk_signal_connect_while_alive() to
	PicmanDrawable's "visibility_changed" fixes a crash here.

	* app/picmanlayerlistitem.c: check more strictly if DND reordering
	of layers is allowed.

	* app/picmanlistitem.c: more DND reordering checking.
	Start drawing the drop indicator at x = name_label->allocation.x
	(looks better IMHO).

2001-03-04  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmanlayerlistitem.[ch]: new widget derived from
	PicmanDrawableListItem (additionally displays the layer mask),

	* app/picmanlistitem.[ch]: added the preview_size to the struct so
	subclasses can create previews at arbitrary times. Removed the
	"preview_size" parameter from "set_viewable".

	* app/picmanimage.[ch]: removed the layer mask functions because
	they belong to PicmanLayer.

	* app/picmanlayer.[ch]: folded the layer mask code from PicmanImage
	into PicmanLayer's layer mask functions. Added a "mask_changed"
	signal which is emitted when a mask is added/removed. Added
	"push_undo" parameters to the functions so we can use them from
	the undo system.

	* app/undo.c: instead of badly poking the PicmanLayer struct, use
	the accessors with push_undo = FALSE.

	* app/gimage_mask.c
	* app/picmandrawablelistitem.c
	* app/layers_dialog.c
	* app/xcf.c
	* app/pdb/image_cmds.c
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

2001-03-04  Michael Natterer  <mitch@picman.org>

	* app/picmandrawable.[ch]: new function picman_drawable_set_visible().
	Renamed picman_drawable_visible() to picman_drawable_get_visible().
	Added a "visibility_changed" signal.

	* app/picmanlistitem.[ch]: new virtual function "set_viewable"
	which allows subclasses to connect to the viewable's signals.

	* app/picmandrawablelistitem.[ch]: added an eye button. Implement
	"set_viewable" to connect to the "visibility_changed" signal.

	* app/picmanchannel.[ch]: removed unused function
	picman_channel_toggle_visibility().

	* app/channels_dialog.c
	* app/floating_sel.c
	* app/gimage_mask.c
	* app/picmanimage.c
	* app/picmanlayer.c
	* app/layers_dialog.c
	* app/xcf.c
	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/pdb_glue.h
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: removed direct access of
	drawable->visible and use the functions instead. Also makes PDB
	code generation nicer.

	* pixmaps/eye.xpm: cropped it a bit.

2001-03-04  Zbigniew Chyla  <cyba@gnome.pl>

	* app/commands.c (image_scale_callback),
	libpicmanwidgets/picmanchainbutton.c (picman_chain_button_destroy),
	libpicmanwidgets/picmancolorbutton.c (picman_color_button_destroy):
	libpicmanwidgets/picmanpixmap.c (picman_color_button_destroy):
	Move variable assignments out of assertions to allow compilation
	with "G_DISABLE_ASSERT" defined.

2001-03-04  Sven Neumann  <sven@picman.org>

	* app/preferences_dialog.c (prefs_save_callback): applied a patch
	from David Odin <David.Odin@bigfoot.com> that fixes a typo in the code.

2001-03-04  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmandrawablelistitem.[ch]
	* app/picmanlistitem.[ch]: new widgets capable of reordering
	themselves using DND.

	* app/picmancontainerlistview.c: removed stuff which is now done
	by the PicmanListItem.

	* app/picmandnd.[ch]: new function picman_dnd_get_drag_data(widget)
	which returns a PicmanViewable using the widget's drag callback.

	* app/picmandrawablelistview.c: implement PicmanContainerView's
	"insert_item" method and enable reordering for the created
	PicmanListItem.

2001-03-03  Michael Natterer  <mitch@picman.org>

	* app/appenums.h: renamed ZoomType to PicmanZoomZype and added it
	here.

	* app/commands.c
	* app/disp_callbacks.c
	* app/nav_window.c
	* app/scale.[ch]: changed accordingly.

	* app/tools/Makefile.am
	* app/tools/magnify.[ch]: back as object.

	* app/tools/tool.c: removed the old ToolInfo entry.

	* app/tools/tools.c: register it.

2001-03-02  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanselectiontool.[ch]: new files ported by
	Dave Neary <dneary@eircom.net>. Changed them a bit to inherit
	from PicmanDrawTool and added implementations of "modifier_key"
	and "oper_update" because they are shared by 4 of the old
	selection tools.

2001-03-01  Daniel Egger  <egger@suse.de>

	* app/fileops.c: Applied patch from Dave Neary to fix
	bug 37633 "File->Revert doesn't resize canvas".

2001-03-01  Stanislav Brabec  <utx@penguin.cz>

        * plugins/common/despeckle.c: Fixed black_level range.
        Valid range should be -1..255, not 0..256, because comaparison
        is > and <=. Bug became visible after last Martin Weber's fix.
        There must be for both black and white levels one extra value
        to cover all numbers 0..255.

2001-03-01  Michael Natterer  <mitch@picman.org>

	* app/tools/crop.[ch]: we need to override PicmanDrawTool's "draw"
	method to actually see something.

	* app/channels_dialog.c
	* app/layers_dialog.c: fixed the crash introduced by the migration
	of gimage->layers and gimage->channels to PicmanContainer.

2001-02-20  Nathan Summers  <rock@picman.org>

	* app/tools/picmantransformtool.c
	* app/tools/picmantransformtool.h: Started work on the TransformCore.  
	Very incomplete.  Needs a friendly visit from genmarshal.pl.  Not yet 
	included in the build.  Move along now, folks, there's nothing more to
	see.

2001-02-28  Nathan Summers  <rock@picman.org>

	* app/tools/crop.c
	* app/tools/crop.h: Fixed a couple instances where the crop tool was
	incorrectly inheriting from PicmanTool instead of PicmanDrawTool.  The crop 
	tool still does not work completely correctly on my machine.  It does
	not show the lines and sometimes it includes garbage.

2001-02-28  Sven Neumann  <sven@picman.org>

	Please, do not change the files in app/pdb directly, they are
	autogenerated. And, please, whatever you change, type make in
	the toplevel srcdir, since pdbgen might decide it has to change 
	some more files because of your changes.
	
	* app/pdb/layer_cmds.c
	* app/pdb/tools_cmds.c
	* app/tools/crop.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/tools.pdb: made everything compile again

2001-02-27  Jay Cox  <jaycox@picman.org>

	* app/appenums.h
	* app/picmanlayer.c
	* app/layers_dialog.c: When adding a layer mask allow the option
	of using the current selection (or it's inverse) to initialise
	the mask.

2001-02-28  Michael Natterer  <mitch@picman.org>

	* app/gdisplay.c
	* app/gimage.c. #include "tools/tool.h"

	* app/tools/edit_selection.[ch]: the arrow_key function is not
	a method of edit_selection but of any tool that needs it.

	* app/tools/picmanpaintbrushtool.c: removed variables.

	* app/tools/move.c: use the arrow_key function.

	* app/tools/tool_manager.h: removed the include of "tool.h"

2001-02-28  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/edit_selection.[ch]: back as real tool which gets
	temporarily pushed to the tool_manager's new tool stack.

	* app/tools/move.c
	* app/tools/text_tool.c: call the edit_selection stuff again.

	* app/tools/tool.c: added a STUB().

	* app/tools/tool_manager.[ch]: implemented tool_manager_push_tool()
	and tool_manager_pop_tool().

2001-02-28  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/bucket_fill.[ch]: one more...

	* app/tools/fuzzy_select.c: everything commented out except the
	find_region stuff.

	* app/tools/picmancolorpickertool.c: cosmetic.

	* app/tools/paint_options.c: #include "bucket_fill.h"

	* app/tools/tool.[ch]: removed STUB()'s.

	* app/tools/tools.c: register it.

2001-02-28  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/ink.[ch]: back as object.

	* app/tools/paint_options.c: #include "ink.h"

	* app/tools/tool.h: removed the type #define.

	* app/tools/tools.c: register it.

2001-02-28  Michael Natterer  <mitch@picman.org>

	* app/context_manager.[ch]: made the global_paint_options public.

	* app/tools/picmantoolinfo.[ch]: added a "tool_context" boolean to
	the constructor and create a private context for the tool
	initialized with global_paint_options' values.

	* app/tools/tool_manager.[ch]: changed tool_manager_register_tool()
	accordingly.

	* app/tools/picmancolorpickertool.c
	* app/tools/measure.c
	* app/tools/move.c
	* app/tools/text_tool.c: changed accordingly.

	* app/tools/paint_options.[ch]: added the fade out and gradient
	options here so they can be used by all paint tools.

	* app/tools/picmanpaintbrushtool.c: removed them here. Changed
	the non_gui stuff: removed the non_gui_paint_func and handle
	the non_gui stuff in the normal paint method. Allocate a
	non_gui_paintbrush instead of the old non_gui_paint_core.

	The non_gui stuff will change totally and will be handled
	by PicmanPaintTool only.

	* app/tools/tool.c: removed the STUB()'s again.

2001-02-27  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am: build the measure tool again.

	* app/tools/picmancolorpickertool.c: correct prototypes for some
	functions so we don't get warnings about incompatible assignments
	in "class_init", chain up in "control".

	* app/tools/picmandrawtool.c: added an implementation of "control"
	which can be called from subclasses so we don't need to call
	PicmanDrawTool's methods directly from there.

	* app/tools/picmanpaintbrushtool.[ch]: create it's tool options so it
	doesn't crash. Commented out the non_gui stuff. We need a different
	interface for this.

	* app/tools/picmanpainttool.[ch]: some cleanups: call the draw tool's
	"control" function, fixed "cursor_update", fixed indentation.

	* app/tools/measure.[ch]: made it work again (properly subclass
	PicmanDrawTool).

	* app/tools/tool.c: re-added the non_gui paintbrush STUB()'s

	* app/tools/tools.c: don't allocate the non_gui stuff.
	PicmanPaintTool is an abstract superclass, so we cannot create
	an instance of it. Moreover, the current non_gui stuff assumes
	that there is something like a "paint_core" and changes it's
	virtual function pointers, breaking the object system totally.

2001-02-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/header.c: applied patch from Chuck Mason 
	<chuckjr@unbounded.com> that fixes wrong output of header plug-in.

2001-02-27  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h
	* app/Makefile.am
	* app/picmandrawablelistview.[ch]: new widget. The upcoming replacement
	for the layers and channels dialogs.

	* app/test_commands.[ch]: put the test dialogs here...

	* app/commands.[ch]: ... and made this one clean again.

	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmancontainerview.[ch]: some signal handling fine tuning.

	* app/picmanimage.[ch]: emits "active_layer_changed" and
	"active_channel_changed" signals now. The semantics of
	gimage->active_layer and gimage->active_channel have changed a bit.
	We now have either an active layer _or_ and active channel (there
	is no active layer any more if a channel is active).

	* app/channel_ops.c
	* app/floating_sel.c
	* app/gdisplay.c
	* app/layers_dialog.c
	* app/menus.c: changed accordingly.

	* app/tools/picmancolorpickertool.c: actually assign the draw_class
	vraiable in the class_init function.

	* app/tools/picmandrawtool.[ch]
	* app/tools/tool.c: removed the _new() functions because these
	objects are abstract superclasses. Did some cleanup.
	Nathan, please configure you editor to _not_ produce any tabs
	in the source code.

	* app/tools/picmanpaintbrushtool.[ch]: "blurb" and "help" are tagged
	with _(), not N_(). Put the register function to the header.

	* po/POTFILES.in: made it compile again.

2001-02-26  Nathan Summers <rock@picman.org>

	* app/tools/picmandrawtool.c
        * app/tools/picmandrawtool.h
        * app/tools/picmanpainttool.c
        * app/tools/picmanpainttool.h
        * app/tools/picmanpainttool_kernels.h: Created PicmanDrawTool and
        PicmanPaintTool, real classes that replace the old DrawCore and
        PaintCore

        * app/Makefile.am
        * app/apptypes.h
        * app/context_manager.c
        * app/gdisplay.c
        * app/gimage_mask.c
        * app/picmanbrush.c
        * app/picmanbrush.h
        * app/picmanbrushgenerated.c
        * app/picmanbrushpipe.c
        * app/picmancontext.c
        * app/info_window.c
        * app/path_transform.h
        * app/undo.c
        * app/pdb/tools_cmds.c
        * app/tools/Makefile.am
        * app/tools/bezier_selectP.h
        * app/tools/picmantoolinfo.c
        * app/tools/measure.c
        * app/tools/measure.h
        * app/tools/move.c
        * app/tools/paint_options.c
        * app/tools/tool.c
        * app/tools/tool.h
        * app/tools/tools.c
        * app/tools/transform_core.h
        * tools/pdbgen/Makefile.am: changed accordingly

        * libpicman/Makefile.am: fixed glitch in build

        * app/tools/picmancolorpickertool.c
        * app/tools/picmancolorpickertool.h
        * app/tools/picmanpaintbrushtool.c
        * app/tools/picmanpaintbrushtool.h:new names

        * app/draw_core.c
        * app/draw_core.h
        * app/tools/color_picker.c
        * app/tools/color_picker.h
        * app/tools/paint_core.c
        * app/tools/paint_core.h
        * app/tools/paint_core_kernels.h
        * app/tools/paintbrush.c
        * app/tools/paintbrush.h: removed

2001-02-25  Michael Natterer  <mitch@picman.org>

	* app/channel_ops.c
	* app/channels_dialog.c
	* app/commands.c
	* app/floating_sel.c
	* app/gdisplay.c
	* app/picmanimage.[ch]
	* app/layer_select.c
	* app/layers_dialog.c
	* app/undo.c
	* app/xcf.c
	* app/tools/move.c: remove direct access of gimage->active_layer and
	gimage->active_channel. Reading access is of course harmless, but
	picman_image_set_active_blah() will trigger a signal emission soon.

	It will probably be neccessary to change the functions to accept
	NULL layers and channels to acheive exactly what weird places like
	floating_sel.c did before by setting it directly.

	* picmantool-1.4.in
	* libpicman/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am
	* plug-ins/libgck/gck/Makefile.am: made linking against stable
	PICMAN installed in the same prefix work again by renaming all our
	libraries explicitly to libpicman<foo>-1.3.* (not as part of the
	libtool release but as part of the library name). Removed the
	libtool release to avoid double versioning. This has to be
	hardcoded in the libraries' Makefile.am ...

	* app/Makefile.am
	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/bmp/Makefile.am
	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/faxg3/Makefile.am
	* plug-ins/fits/Makefile.am
	* plug-ins/flame/Makefile.am
	* plug-ins/fp/Makefile.am
	* plug-ins/gap/Makefile.am
	* plug-ins/gdyntext/Makefile.am
	* plug-ins/gfig/Makefile.am
	* plug-ins/gflare/Makefile.am
	* plug-ins/gfli/Makefile.am
	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/ifscompose/Makefile.am
	* plug-ins/imagemap/Makefile.am
	* plug-ins/maze/Makefile.am
	* plug-ins/mosaic/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/plugin-helper/Makefile.am
	* plug-ins/print/Makefile.am
	* plug-ins/rcm/Makefile.am
	* plug-ins/script-fu/Makefile.am
	* plug-ins/sel2path/Makefile.am
	* plug-ins/sgi/Makefile.am
	* plug-ins/webbrowser/Makefile.am
	* plug-ins/xjt/Makefile.am: ... while all other Makefiles can simply
	link against "libpicman<foo>-$(LT_RELEASE).la"

2001-02-24  Michael Natterer  <mitch@picman.org>

	* app/pixmaps2.h: commented out "text_width" and "text_height"

	* app/tools/Makefile.am
	* app/tools/text_tool.[ch]: "It was really dead, Jim!"

	* app/tools/tool.c: removed STUBs

	* app/tools/tools.c: register it.

2001-02-24  Michael Natterer  <mitch@picman.org>

	* TODO.xml: updated.

	* app/appenums.h
	* app/apptypes.h: prefixed the cursor stuff with "Picman", added
	the new stock tool cursor enum. Removed the old ToolType enum.

	* app/cursorutil.[ch]
	* app/gdisplay.[ch]: removed the old ToolType enum and prefixed
	the functions with "picman_". Also stripped all "toggle cursor"
	stuff from the cursor code, so the new API is easier and not
	depending on the tool system.

	All existing tool cursors can be used via the new stock tool
	cursor enum, so no tool has to fiddle around with bitmap cursors.
	There will be an cursorutil function for registering stock tool
	cursor types on the fly.

	* app/disp_callbacks.c
	* app/scroll.[ch]: moved the display scrollbar callbacks from
	scroll.[ch] to disp_callbacks.c. Removed some crap from scroll.h

	* app/tools/tool.[ch]: removed the BitmapCursor pointers from the
	tool class struct and add cursor and toggle cursor IDs to the
	PicmanTool struct. Work in progress.

	* app/dialog_handler.c
	* app/tools/bezier_select.c
	* app/tools/blend.c
	* app/tools/bucket_fill.c
	* app/tools/by_color_select.c
	* app/tools/clone.c
	* app/tools/color_picker.c
	* app/tools/convolve.c
	* app/tools/crop.c
	* app/tools/dodgeburn.c
	* app/tools/edit_selection.c
	* app/tools/ellipse_select.c
	* app/tools/flip_tool.c
	* app/tools/free_select.c
	* app/tools/fuzzy_select.c
	* app/tools/ink.c
	* app/tools/iscissors.c
	* app/tools/magnify.c
	* app/tools/measure.c
	* app/tools/move.c
	* app/tools/paint_core.[ch]
	* app/tools/perspective_tool.c
	* app/tools/rect_select.c
	* app/tools/rotate_tool.c
	* app/tools/scale_tool.c
	* app/tools/shear_tool.c
	* app/tools/text_tool.c
	* app/tools/transform_core.[ch]: changed accordingly. Did this
	"blind" for most tools because they don't compile. The changes are
	minimal, so there should be no conflicts.

2001-02-24  Michael Natterer  <mitch@picman.org>

	* app/commands.[ch]: added cmd_callbacks for the toolbox and
	the preferences dialog.

	* app/context_manager.c: cleanup.

	* app/picmanpreview.[ch]: made picman_preview_render() public.

	* app/picmantoolinfopreview.c
	* app/tools/picmantoolinfo.c: the tool previews look nice now but
	are still ugly implemented (it renders tons of temp_bufs on each
	state change).

	* app/indicator_area.[ch]: pass a context to the constructor.

	* app/menus.c: don't call the toolbox and the prefs dialog
	directly but dispatch via commands.[ch]

	* app/preferences_dialog.[ch]
	* app/toolbox.[ch]: renamed the constructor / raise function, cleanup.

	* app/tools/color_picker.c: tried to get the shortcut working again.

	* app/tools/paint_options.c: the brush dialog's paint options
	are shown/hidden from the context manager now.

2001-02-23  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c: removed crap from ancient times when tools
	used to be an enum.

	* app/brush_select.[ch]: cleaned up the gui and made global paint
	mode toggling much simpler by expanding vertically instead of
	reparenting.

	* app/context_manager.c: removed hack by using a tool manager
	accessor function.

	* app/picmancontext.c: use the new standard tool info object. Tools
	also _behave_ like all other data types now (can e.g. be
	refreshed).

	* app/tools/tool.[ch]

	* app/tools/picmantoolinfo.[ch]: added an "identifier" which is an
	untranslated string with a meaningful prefix and name, e.g.
	"picman:color_picker_tool". Renamed "tool_name" and "tool_desc"
	to "blurb" and "help", changed the constructor accordingly.
	Added picman_tool_info_get_standard() to make the context work
	with tool refresh.

	* app/tools/tool_manager.[ch]
	* app/tools/tools.c: removed the global list of tool class
	structures because the tool info list is in place.
	Added tool_manager_register_tool_options() which calls
	tool_options_dialog_add() and registers the options in the
	global_tool_info_list.

	* app/tools/Makefile.am
	* app/tools/paint_options.[ch]
	* app/tools/selection_options.[ch]
	* app/tools/tool_options.[ch]
	* app/tools/tool_options_dialog.[ch]: build them all again. This
	is mostly the old tool options system with minor modifications to
	work with the new stuff. The tool options auto-update with the user
	context now, so there are no update functions any more.

	* app/picmandnd.c
	* app/toolbox.c
	* app/tools/color_picker.c
	* app/tools/measure.c
	* app/tools/move.c: changed accordingly.

2001-02-23  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmantoolinfopreview.[ch]: new widget.

	* app/picmanpreview.c
	* app/tools/picmantoolinfo.c
	* app/picmandnd.c: changed for the tool info preview. Still buggy
	and looks a bit funny at the moment :-)

	* app/commands.[ch]
	* app/menus.c: small new feature: shift-X toggles the whole context.

2001-02-23  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/pixmaps.h
	* app/wilber.h: removed some data files from app/

	* pixmaps/Makefile.am
	* pixmaps/default.xpm
	* pixmaps/swap.xpm
	* pixmaps/wilber3.xpm: added them here.

	* app/pixmaps2.h: added the "dialog_bits" stuff here.

	* app/tips_dialog.c
	* app/toolbox.c: use the new XPMs and remove hacks which created
	the GdkPixmaps and GtkPreviews manually.

2001-02-22  Simon Budig  <simon@picman.org>

	* app/interface.c
	* app/gdisplay.h
	* app/gdisplay.c: Icons now update every 7.5 seconds in the
	idle loop. Also the aspect ratio is correct now. Mitch promised
	to hack a preferences option to disable this stuff...  :-)

Thu Feb 22 18:23:10 GMT 2001  Adam D. Moss  <adam@picman.org>

	* tools/pdbgen/pdb/channel.pdb: Save a bunch of slow-witted
	old people like myself from having to upgrade PERL for the sake
	of sugar.  Baby.

2001-02-21  Michael Natterer  <mitch@picman.org>

	* configure.in: forgot one s/picmantool/picmantool-1.4/

	* app/appenums.h: removed "UPDATE_CURSOR" from the ToolAction enum.

	* app/context_manager.c: removed the toolbox toggle button updating
	code here...

	* app/toolbox.c: ...and handle it in the toolbox itself.

	* app/devices.c: removed some obsolete old tool suff.

	* app/tools/Makefile.am
	* app/tools/move.[ch]: reactivated. Disabled the edit_selection
	stuff for now. We need a way to temporary push tools to some stack
	of the tool manager.

	* app/tools/tool.[ch]: removed lot of stuff that is obsolete or
	handled by the PicmanToolInfo object now.

	* app/tools/tool_manager.[ch]: stripped all tool options stuff
	because they will be able to follow tool changes themselves.
	Renamed some functions to be consistent.

	* app/tools/tools.c: register the move tool again.

	* app/cursorutil.c
	* app/disp_callbacks.c
	* app/gimage_mask.c
	* app/global_edit.c
	* app/tools/color_picker.c
	* app/tools/measure.[ch]
	* app/tools/tool_options.c: changed accordingly.

2001-02-21  Simon Budig   <simon@picman.org>

	* app/disp_callbacks.c
	* app/gdisplay.c
	* app/gdisplay.h
	* app/interface.c: Moved the Icon preview stuff to the idle-loop.

2001-02-21  Simon Budig   <simon@picman.org>
	
	* app/interface.c: Fixed stupid bug with the icon preview when
	creating the second preview. Please note that it still crashes
	on the second image, but this is hopefully not my fault...  :-)

2001-02-21  Michael Natterer  <mitch@picman.org>

	Made the tool system work again and integrated it back with the
	PicmanContext. It's a hack between old, new and freshly hacked
	stuff. There are still lots of warnings but at least we can switch
	tools again.

	* app/tools/Makefile.am
	* app/tools/picmantoolinfo.[ch]: resurrected as real object.
	The PicmanToolInfo objects are derived from PicmanData, which gives
	us the tool icon stuff for free. Also, we need a list of _objects_
	which is allocated all the time. All tools are required to have
	a "register" function which registers themselves with the list
	of PicmanToolInfo objects which is maintained by the tool manager.

	* app/tools/tool.[ch]: made a real GtkObject with properly named
	functions out of it. The former "active_tool_control" is of
	course not the default implementation of the tool's "control"
	method but a hack _around_ it, so it went to the tool manager.

	* app/tools/color_picker.[ch]
	* app/tools/measure.[ch]: ditto. Added "register" functions and
	"destroy" implementations so the tools go away after use.

	* app/tools/tool_manager.[ch]: badly hacked at the moment to keep
	both the list of class structures _and_ the tool info list.

	* app/tools/tools.c: call the tools' register functions.

	* app/picmancontext.[ch]: store a pointer to a PicmanToolInfo object
	as "active_tool" in the context, so we're independent of tools
	being allocated or not. It's treated just like a brush or pattern
	now.

	* app/picmandnd.[ch]: made tool DND work like all other DND types.

	* app/devices.[ch]: also here: the tool is just a normal data object
	now, resulting in removal of lots of code.

	* app/commands.c
	* app/context_manager.c: updated the tool select and context stuff
	to work again.

	* app/toolbox.c: removed the old pixmap buttons and put PicmanPreviews
	inside the tool buttons. Still needs an own preview type to
	look nice.

	* app/disp_callbacks.c
	* app/about_dialog.c
	* app/app_procs.c
	* app/appenums.h
	* app/apptypes.h
	* app/gimage.c
	* app/picmanpalette.c
	* app/picmanpreview.c
	* app/picmanrc.c
	* app/info_window.c
	* app/menus.c
	* app/palette_select.h
	* app/scale.c
	* app/scroll.c: lots of changes to make it work again.

2001-02-21  Daniel Egger  <egger@suse.de>

	* app/picmanchecks.h: New file containing the check types.
	
	* app/image_render.h: ... definitions taken from here.
	* app/temp_buf.c:
	* app/temp_buf.h: New function temp_buf_new_check to create
	a new checked temp_buf.

2001-02-20  Simon Budig  <simon@picman.org>
	
	* app/gdisplay.[ch]
	* app/disp_callbacks.c
	* app/interface.c: Added preliminary support for Preview icons.

	This is not finished: We need a better way to get previews with
	a specific depth and probably a rendered Checkerboard for the
	alpha channel. Also the update function is now bound to a click
	in the top left menu-button and should go in some idle-stuff.
	Please test this on various window managers and give some
	feedback. The last point is the aspect ratio of the generated
	previews...

2001-02-20  Nick Lamb  <njl195@zepler.org.uk>

	* libpicmanwidgets/picmanwidgets.c: include string.h

2001-02-20  Michael Natterer  <mitch@picman.org>

	* app/picmandnd.[ch]: removed all brush, pattern, gradient and palette
	DND functions because there are generic PicmanViewable DND functions
	now.

	* app/disp_callbacks.[ch]
	* app/interface.c: changed accordingly.

2001-02-19  Michael Natterer  <mitch@picman.org>

	* app/commands.[ch]
	* app/menus.c: first version of the new layers and channels dialogs.

	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c: allow creation with a NULL container.

	* app/picmandnd.[ch]: added generic DND functions for all drawable
	types (not just setting the DND icon). Started to remove code
	duplication.

	* app/picmandrawablepreview.c: with some magic calculations and ugly
	assumptions the drawable previews now look exactly like in the old
	L&C dialog.

	* app/picmanimagepreview.c: no need to say "return" at the end of a
	void function.

	* app/picmanpreview.[ch]: added the "is_popup" boolean also to the
	default constructor. Call picman_preview_set_viewable() before
	calculating the preview size.

2001-02-19  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanpalette-import.[ch]: new files. The import functions
	stripped from all UI crap.

	* app/palette_import.c: removed from here.

2001-02-19  Sven Neumann  <sven@picman.org>

	* app/picmanimage.[ch]: converted gimage->layers and gimage->channels
	to PicmanLists.
	
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/commands.c
	* app/convert.c
	* app/floating_sel.c
	* app/gdisplay.c
	* app/picmandrawable.c
	* app/layers_dialog.c
	* app/resize.c
	* app/undo.c
	* app/xcf.c
	* app/pdb/display_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/tools/crop.c
	* app/tools/edit_selection.c
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb: changed accordingly

2001-02-19  Michael Natterer  <mitch@picman.org>

	* app/picmancontainer.[ch] (picman_container_insert): new function.

2001-02-19  Michael Natterer  <mitch@picman.org>

	* app/context_manager.c
	* app/picmandatafactory.c
	* app/picmandatalist.[ch]
	* app/picmanlist.[ch]
	* app/module_db.c: return a PicmanContainer from all container
	subclass constructors.

	* app/picmanpalettepreview.c
	* app/palette.c: changed the preview a bit. Still ugly.

2001-02-19  Michael Natterer  <mitch@picman.org>

	* picman.m4
	* picmantool.in: removed.

	* picman-1.4.m4
	* picmantool-1.4.in: added modified versions. picman-1.4.m4 is untested.
	The m4 macro is now called AM_PATH_PICMAN_1_4()

	* .cvsignore
	* Makefile.am
	* configure.in: changed accordingly.

	* libpicman/Makefile.am
	* libpicmancolor/Makefile.am
	* libpicmanmath/Makefile.am
	* libpicmanwidgets/Makefile.am: install the header files in
	$includedir/picman-MAJOR.MINOR/<libname>

	* app/brush_edit.c: increased toplevel container border size to 4.

	* app/picmandatafactoryview.c: don't generate multiple "copy"s when
	duplicating data objects.

	* app/gradient_editor.c: cleaned up the GUI.

	* app/lc_dialog.c: removed the "Close" button.

2001-02-18  Michael Natterer  <mitch@picman.org>

	* app/picmandnd.[ch]: added DND source functions which work by
	GtkType.

	* app/commands.c
	* app/brush_select.c
	* app/gradient_select.[ch]
	* app/pattern_select.c: removed the DND code here because it's all
	done by the PicmanContainerView now.

	* app/picmanbrushpreview.c
	* app/picmangradientpreview.c
	* app/picmanpalettepreview.c
	* app/picmanpatternpreview.c: use the DND by-type connect functions.

	* app/picmanbrushgenerated.c: implemented "duplicate", cleanup.

	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmancontainerview.[ch]: added a "activate_item" signal
	method which is emitted by the subclasses to indicate double click.

	* app/picmandatafactoryview.c: connect to "activate_item" and show
	the editor.

	* app/convert.c
	* app/picmanpalette.[ch]
	* app/palette.c
	* app/paletteP.h
	* app/palette_import.c
	* app/palette_select.[ch]: major cleanup: Behaves like the other
	datatypes now: DND, context stuff, PicmanContainerListViews in
	the dialogs etc. Mostly just removal of code.

	* app/gradient_editor.c: fixed signal blocking/unblocking.

	* plug-ins/script-fu/scripts/Makefile.am: install the "Test Sphere"
	script again.

2001-02-17  Michael Natterer  <mitch@picman.org>

	* app/picmancontainer.[ch]
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmancontainerview.[ch]
	* app/picmanlist.c
	* app/picmanmarshal.[ch]: the PicmanContainer has a new virtual "reorder"
	method which is much more eficient then the current remove/add
	braindeadness when renaming data objects.
	Changed the views to connect to "reorder" and call the
	PicmanContainerView's new "reorder_item" method which then does
	the right thing in the view subclasses.

	* app/picmandatafactory.c
	* app/picmandatafactoryview.c
	* app/picmandatalist.[ch]: removed the data list loading and saving
	stuff from PicmanDataList because that's the job of the
	PicmanDataFactory.

	* app/brush_edit.[ch]
	* app/brush_select.c: cleanup.

	* app/gradient_editor.[ch]: changed it to work like the brush
	editor: return a GradientEditor pointer in the constructor
	and statically store this pointer in the gradient selection file.
	Removed the global "g_editor" variable and added tons of
	GradientEditor* variables to function calls so they know their
	context without the global variable.

	* app/gradient_select.c: changed accordingly.

2001-02-17  Seth Burgess <sjburges@picman.org>
	
	* app/tools/Makefile.am 
        * app/tools/measure.[ch]: added back in, changing as needed for basic 
	operation.  Probably pretty buggy still.

	* app/tools/tools.c: changed one of the tool initializations to be
	the measure tool.  Now only measure tools are availble (though it
	would appear both are visually).  I don't think the toolbox selection 
	stuff is operational yet.

	* app/tools/color_picker.[ch]: minor cleanup

2001-02-16  Stanislav Brabec  <utx@penguin.cz>

        On request of Martin Weber <martweb@gmx.net>.
        * plugins/common/despeckle.c: Fixed comparison *sort_ptr > black_level.
        Only adopting white_level had a visual effect. This fix causes
        that also adopting blck_level works also.

2001-02-14  Michael Natterer  <mitch@picman.org>

	* HACKING: added a note about apptype.h and about not including
	headers in headers.

	* app/apptypes.h: added PicmanTool and BitmapCursor.

	* app/cursorutil.h
	* app/devices.h
	* app/draw_core.h
	* app/tools/color_picker.h
	* app/tools/tool.h
	* app/tools/tool_options.h
	* app/picmancontext.h: removed includes of "tools/tool.h"

	* app/picmanrc.[ch]: indentadion cleanup, added
	"module_db_load_inhibit".

	* app/module_db.c: removed the above variable here.

	* app/picmandata.[ch]: added a vitrual "duplicate" method.

	* app/picmanbrush.[ch]
	* app/picmanbrushgenerated.[ch]
	* app/picmanbrushpipe.[ch]
	* app/picmangradient.[ch]
	* app/picmanpalette.[ch]
	* app/picmanpattern.[ch]: all "load", "new" and "get_standard"
	functions return a PicmanData pointer now.

	* app/picmandatafactory.[ch]: made some stuff const.

	* app/picmandatafactoryview.c: activate the "duplicate" button and
	set the initial button sensitivity correctly.

	* app/brush_select.c
	* app/gradient_select.c
	* app/pattern_select.c: use the new PicmanDataFactoryView.

	* libpicman/Makefile.am: grouped the file to sort out what _may_
	go to subdirs or separate libs.

	* libpicman/picmanenv.[ch]: added many "const".

	* app/app_procs.c
	* app/brush_edit.c
	* app/picmancontext.c
	* app/picmandnd.c
	* app/gradient_editor.c
	* app/palette.c
	* app/palette_import.c
	* app/user_install.c: many related changes.

	* libpicmanmath/picmanmathtypes.h
	* libpicmanmath/picmanvector.[ch]: minor cleanups.

	* plug-ins/script-fu/script-fu.c: picman_data_directory() is const now.

2001-02-13 Nathan Summers <rock@picman.org>

	* configure.in
	* plug-ins/plugin-helper/*: prototype for an extension that allows
	gmodules as plugins.  Known bug: crashes on gmodules with a static
	"query" function
        
	* app/tools/tool.c 
	* app/tools/tool.h: created new PicmanTool object.  Did away with
	ToolInfo.  Most tools still need to be ported over to the new api.

        * app/tools/tools.c: now contains the initialization function to
	register the tools with the Picman

        * app/tools/tools.h: renamed to tool.h

	* app/Makefile.am 
	* app/app_procs.c
        * app/apptypes.h 
	* app/commands.c 
	* app/context_manager.c
        * app/cursorutil.c 
	* app/devices.c 
	* app/devices.h
        * app/disp_callbacks.c 
	* app/draw_core.c 
	* app/draw_core.h
        * app/gdisplay.c 
	* app/gimage.c 
	* app/gimage_mask.c
        * app/picmancontext.c 
	* app/picmancontext.h 
        * app/global_edit.c 
	* app/info_window.c 
	* app/interface.c
        * app/libpicman_glue.c 
	* app/menus.c 
	* app/paint_core.h
        * app/paint_options.h 
	* app/scale.c 
	* app/scroll.c 
	* app/toolbox.c
	* app/undo.c 
	* app/tools/Makefile.am
        * app/tools/color_picker.c 
	* app/tools/color_picker.h
        * app/tools/paint_core.c 
	* app/tools/tool_options.c
        * app/tools/tool_options.h 
	* app/tools/tool_options_dialog.c
	* libpicman/picman.c 
	* plug-ins/Makefile.am: changed acordingly

        * plug-ins/script-fu/script-fu-scripts.c: fixed typo in comment.
	Pathetic, huh?

2001-02-14  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* po/POTFILES.in
	* app/brushes.[ch]
	* app/gradients.[ch]
	* app/palettes.[ch]
	* app/patterns.[ch]: removed.

	* app/picmandatafactory.[ch]: completely manage the data lists,
	including loading with different callbacks per extension.

	* app/picmandatafactoryview.[ch]: enabled "new", "edit", "delete"
	and "refresh".

	* app/context_manager.c: initisalize the data factories.

	* app/picmancontext.c: fixed some bad bugs introduced yesterday.

	* app/gradient_editor.[ch]: removed the public "create" function
	and create the editor implicitly on "set_gradient"

	* app/app_procs.c
	* app/apptypes.h
	* app/brush_edit.h
	* app/brush_select.c
	* app/commands.c
	* app/convert.c
	* app/devices.c
	* app/picmanbrushpipe.c
	* app/picmancontainerview.h
	* app/picmangradient.c
	* app/picmanpattern.c
	* app/gradient_select.c
	* app/palette.c
	* app/pattern_select.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: um, much stuff, mostly "changed
	accordingly" ;-)

2001-02-13  Michael Natterer  <mitch@picman.org>

	* picmanrc.in
	* user_install
	* user_install.bat
	* app/picmanrc.[ch]
	* app/preferences_dialog.c: removed the "brush_vbr_path" variable,
	because all data types will be editable and saveable soon.

	* app/Makefile.am
	* app/apptypes.h
	* app/picmandatafactory.[ch]: new object which holds a data list and
	knows how to create, edit, duplicate etc. the items in it. Will
	completely replace the brushes.[ch], patterns.[ch], ... files soon.

	* po/POTFILES.in
	* app/picmandatacontainerview.[ch]: removed.
	* app/picmandatafactoryview.[ch]: added.

	A view on the PicmanDataFactory with a GUI for creating, editing,
	deleting etc. items (mostly unimplemented).

	* app/context_manager.[ch]: replaced the global data lists by global
	data factories.

	* app/brush_select.c
	* app/brushes.[ch]
	* app/commands.c
	* app/convert.c
	* app/devices.c
	* app/picmanbrush.[ch]
	* app/picmanbrushgenerated.c
	* app/picmancontext.c
	* app/picmandata.[ch]
	* app/picmandatalist.[ch]
	* app/picmandnd.c
	* app/picmangradient.[ch]
	* app/picmanpalette.[ch]
	* app/picmanpattern.[ch]
	* app/gradient_editor.c
	* app/gradient_select.c
	* app/gradients.[ch]
	* app/indicator_area.c
	* app/palette.c
	* app/palette_import.c
	* app/palette_select.c
	* app/palettes.[ch]
	* app/pattern_select.c
	* app/patterns.[ch]
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: changed accordingly.

2001-02-13  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* po/POTFILES.in
	* app/picmandatacontainerview.[ch]: new widget which will replace the
	current brush, pattern, ... selections. To really use it, there
	needs to be a PicmanDataFactory object (coming soon...)

	* app/commands.[ch]
	* app/menus.c: added test data container views.

	* app/paint_funcs_simd.S: #include the implementation with "", not <>

2001-02-13  Seth Burgess  <sjburges@picman.org>

	* plug-ins/perl/Picman/Lib.xs : made perl compilable again.  Didn't
	change to turn back on by default.
	
2001-02-13  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* configure.in
	* cursors/Makefile.am
	* docs/Makefile.am
	* pixmaps/Makefile.am: added Makefiles to cursors, docs and pixmaps
	directories

2001-02-13  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* pixmaps/refresh.xpm: new icon

2001-02-13  Michael Natterer  <mitch@picman.org>

	* app/gradient_editor.[ch]
	* app/gradient_select.[ch]: use PicmanContainerListView instead of
	cooking an own list.

	* app/picmangradient.[ch]: removed the GdkPixmap from the gradient.

	* app/picmancontainerlistview.c: connect the viewable's "name_changed"
	signal to the label.

	* app/picmanmarshal.[ch]
	* app/picmanpreview.[ch]: new virtual function "get_size",

	* app/picmangradientpreview.c: implement "get_size" and return a 3:1
	aspect ratio.

	* app/gradients.c
	* app/palette_select.[ch]
	* app/palettes.c: removed the dialog freeze/thaw functions.

	* app/brush_select.c
	* app/pattern_select.c
	* app/plug_in.c: stuff.

2001-02-12  Michael Natterer  <mitch@picman.org>

	* app/brush_select.[ch]
	* app/pattern_select.[ch]: removed almost all code by using
	the PicmanContainerGridView.

	* app/brushes.c
	* app/patterns.c: brush|pattern_select_freeze|thaw_all() don't
	exist any more.

	* app/devices.c: made it work again.

	* app/picmangradientpreview.c: the gradient popup is 128 x 32 again.

	* app/plug_in.c: follow the brush and pattern dialog function
	renaming.

	* app/picmanpalette.[ch]
	* app/picmanpalettepreview.c: added a "Columns" attribute and show
	the popups accordingly.

	The palette file format has changed again. It now can have an
	optional "Columns: <n>" line after the palette's name.

	* data/palettes/Bgold.gpl
	* data/palettes/Borders.gpl
	* data/palettes/Cascade.gpl
	* data/palettes/China.gpl
	* data/palettes/Coldfire.gpl
	* data/palettes/Dark_pastels.gpl
	* data/palettes/Ega.gpl
	* data/palettes/Gold.gpl
	* data/palettes/Grayblue.gpl
	* data/palettes/Hilite.gpl
	* data/palettes/Kahki.gpl
	* data/palettes/Named_Colors.gpl
	* data/palettes/News3.gpl
	* data/palettes/Op2.gpl
	* data/palettes/Plasma.gpl
	* data/palettes/Visibone.gpl
	* data/palettes/Visibone_2.gpl
	* data/palettes/Web.gpl: added the "Columns" parameter where it
	makes sense and removed those ugly black colors which were hanging
	around as first color of many palettes.

2001-02-12  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am: took picmancontextpreview.[ch] out of the build
	but still left the sources there as reference.

	* app/app_procs.c: initialize the render stuff before creating the
	toolbox (needed for the previews).

	* app/devices.c
	* app/indicator_area.c: use PicmanPreviews instead of
	PicmanContextPreviews.

	* app/context_manager.[ch]: create the global data lists here
	because they now must exist before any context is created.

	* app/brushes.[ch]
	* app/gradients.[ch]
	* app/palettes.[ch]
	* app/patterns.[ch]: removed them here.

	* app/picmancontainer.[ch]: added a "freeze_count" and emit the
	"freeze" and "thaw" signals accordingly.

	* app/picmancontext.[ch]: greatly simplified the way how the
	contexts connect to the data lists (simply keep them connected all
	the time). Also removed all those ugly explicit update functions
	because "thaw" callbacks do this job now.

	* app/picmandata.c: a PicmanData object now becomes dirty on
	"name_changed"; "dirty" now triggers "invalidate_preview" because
	the context does not dispatch these signals any more soon.

	* app/brush_select.c
	* app/convert.c
	* app/picmandnd.c
	* app/gradient_editor.c
	* app/gradient_select.c
	* app/pattern_select.c
	* app/gradient_editor.c
	* app/gradient_select.c
	* app/gradients.[ch]
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: changed accordingly.

2001-02-11  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h: added the datafile loader_func typedefs.

	* app/datafiles.h: removed from here.

	* app/picmancontainer.[ch]: emit "freeze" and "thaw" signals to get
	rid of those blah_select_[freeze|thaw]_all() stuff.

	* app/picmandatalist.[ch]: new function picman_data_list_load() which
	takes a va_list of PicmanDataObjectLoaderFuncs and file extensions
	and is almost a replacement for the four files below.

	* app/brushes.c
	* app/gradients.c
	* app/palettes.c
	* app/patterns.c: very simple now. It may be worth thinking about
	making all PicmanData subclasses managed by a descriptive array in
	the context_manager.

2001-02-11  Michael Natterer  <mitch@picman.org>

	Made a PicmanContainer out of the palette list:

	* app/Makefile.am
	* app/palettes.[ch]: new files for the global palette list.

	* app/picmangradientpreview.[ch]
	* app/picmanpalettepreview.[ch]: new widgets.

	* app/picmanpalette.[ch]: derive it from PicmanData to get all the
	preview etc. stuff.

	* app/datafiles.[ch]: new function datafiles_check_extension(),
	added a "loader_data" parameter to datafiles_read_directories()
	and pass it to the loader function.

	* app/picmancontext.[ch]: added the palette (not really used yet
	except by the test dialogs).

	* app/picmandatalist.[ch]: new function picman_data_list_save_and_clear()
	which does everything needed for patterns_free(), brushes_free() ...

	* app/picmandnd.c: added palette DND.

	* app/app_procs.c
	* app/brushes.c
	* app/color_notebook.h
	* app/commands.c
	* app/convert.c
	* app/picmanbrush.h
	* app/picmanbrushpipe.h
	* app/picmangradient.c
	* app/picmanpattern.h
	* app/picmanpreview.c
	* app/gradients.c
	* app/module_db.c
	* app/palette.[ch]
	* app/paletteP.h
	* app/palette_import.c
	* app/palette_select.[ch]
	* app/patterns.c
	* app/plug_in.c
	* app/pdb/convert_cmds.c
	* app/pdb/palette_cmds.c
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/palette.pdb: lotsa stuff: changed due to the above
	API changes, #define the file extensions in the PicmanData subclasses'
	header files instead of hardcoding them in several places, ...

	* data/palettes/*: The same file format change as for the gradient
	files:

	- Save the palette name in a parsable form (as part of the file
	  format, not in a comment.
	- Removed unserscores from the palette names.
	- Added an extension (Picman PaLettes are ".gpl" files now ;-)

2001-02-11  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmandata.[ch]: new abstract base class for everything
	(except images) which has a filename and can become dirty and must
	be saved.

	* app/picmanbrush.[ch]
	* app/picmangradient.[ch]
	* app/picmanpattern.[ch]: all derived from PicmanData now.

	* app/picmanbrushgenerated.[ch]
	* app/brush_select.c
	* app/brushes.c
	* app/picmanbrushpipe.c
	* app/gradient_editor.c
	* app/gradients.c
	* app/patterns.c: removed lots of code duplication due to common
	file save magic.

	The gradient file format has changed: it now contains the
	gradient's name (no more ugly underscores). The files have the
	extension ".ggr".

	* app/picmangradient.[ch]: save new gradients, load new and old
	gradients.

	* data/gradients/*: removed all old gradients and added the new
	ones.

2001-02-10  David Monniaux  <monniaux@genievre.ens.fr>

	MMX code for paint_funcs. Very partial so far.
	* acconfig.h
	* configure.in: detection of MMX-able assembler and compiler
	* app/Makefile.am
	* app/main.c: detects MMX and acts accordingly
	* app/paint_funcs.c
	* app/paint_funcs_simd.S: #include's appropriate file
	* app/arch/i386/mmx/paint_funcs_mmx.S
	* app/arch/i386/mmx/paint_funcs_mmx.S.m4

2001-02-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/gradient.[ch]: renamed...

	* app/gradient_editor.[ch]: ...to this

	* app/gradient_select.c: changed #include

	* po/POTFILES.in: renamed the file here too

2001-02-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/gradientP.h
	* app/gradient_header.h: removed.

	* app/picmangradient.[ch]: new object -- bye bye "gradient_t"

	* app/gradients.[ch]: new files for managing the gradient list.

	* app/gradient.[ch]: contains only the gradient editor now (which
	still badly pokes around in the PicmanGradient structure).

	* app/app_procs.c
	* app/apptypes.h
	* app/devices.c
	* app/picmancontainerlistview.c
	* app/picmancontext.[ch]
	* app/picmancontextpreview.[ch]
	* app/picmandnd.[ch]
	* app/gradient_select.[ch]
	* app/indicator_area.c
	* app/palette_import.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/tools/airbrush.c
	* app/tools/blend.c
	* app/tools/paint_core.c
	* app/tools/paintbrush.c
	* app/tools/pencil.c
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb: changed accordingly, some
	changes to the preview and view stuff.

	* app/picmanpreview.[ch]: removed the "context" attribute again
	because it was overkill (a simple gtk_signal_connect_object does
	the same as doing the autoconnection magic inside the PicmanPreview
	object).

	* app/commands.[ch]
	* app/menus.c: example views on the gradient container.

2001-02-09  Michael Natterer  <mitch@picman.org>

	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]
	* app/picmancontainerview.[ch]: follow the PicmanPreview API change
	and take only "size" instead of "width" and "height" in the
	constructor.

	* app/picmandnd.[ch]: first attempt to hack GtkType based DND which
	speaks in terms of PicmanViewable instead of Brush, Pattern, ...
	Added functions to remove DND callbacks (used by the multi-views).

	* app/picmanpreview.[ch]: new function picman_preview_set_size_full().

	* app/commands.c: updated the example dialogs to be DND aware.

	* app/picmanimage.c: fixed preview size calculation by ensuring a
	minimal width/height of 1 pixel.
	Reported by Dave Neary <dneary@eircom.net>

2001-02-09  Michael Natterer  <mitch@picman.org>

	* app/picmanpreview.[ch]: moved the constructor-parameter-overkill
	to the new function picman_preview_new_full() and made the
	picman_preview_new() interface simple.

	* app/picmanbrushpreview.c
	* app/picmanpatternpreview.c: added DND support.

	* app/picmandnd.c: use the new preview system.

	* app/picmanconstrainedhwrapbox.c: implement "size_allocate". Ok,
	this is silly -- I will write an own widget which does the
	"scrollable grid of whatever" stuff in one place...

	* app/commands.c
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmanimagepreview.c: follow the PicmanPreview constructor change.

2001-02-09  Michael Natterer  <mitch@picman.org>

	* app/commands.c: changed the test dialogs a bit.

	* app/picmanconstrainedhwrapbox.[ch]: should be called
	PicmanHackedWrapBoxForContainerView now ;-)

	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]: fixed the minimal size setting
	by getting the magic values from the relevan gtk widgets.
	Scroll to the active item if it not visible.

2001-02-08  Michael Natterer  <mitch@picman.org>

	* app/picmanpreview.[ch]: added an (unused) "context" argument
	and a "set_viewable" function.

	* app/picmanconstrainedhwrapbox.c: even more evil than before.

	* app/picmanbrushpreview.c
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmancontainerview.c
	* app/picmanimagepreview.c
	* app/picmanpatternpreview.c: fixed lots of forgotten signal handlers

	* app/commands.[ch]
	* app/menus.c: added "Multi View" dialogs.

2001-02-08  Michael Natterer  <mitch@picman.org>

	* app/picmanpreview.[ch]: added a "border" attribute. The border can
	have any color (which has no sane API yet...). Added "width" and
	"height" attributes and provide a "set_size" function.

	* app/picmanbrushpreview.c
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmanimagepreview.c
	* app/picmanpatternpreview.c: changed accordingly, enabled
	highlighting of the selected item in the grid views.

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/picmanpreview.[ch]: allocate less temp_bufs by removing the
	"create_preview" virtual function and adding a "render" one.

	Implementations have to call the new public function
	picman_preview_render_and_flush() to render their temp_bufs.
	This way, e.g. the PicmanPatternPreview can render the preview
	directly from the pattern's mask.

	* app/picmandrawablepreview.c
	* app/picmanimagepreview.c
	* app/picmanpatternpreview.c: changed accordingly.

	* app/picmanbrushpreview.[ch]: same as above and added BrushPipe
	popup animation.

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/picmanpreview.[ch]
	* app/picmanbrushpreview.c
	* app/picmancontainergridview.c
	* app/picmancontainerlistview.c
	* app/picmanimagepreview.c
	* app/picmanpatternpreview.c: added an "is_popup" parameter to the
	preview constructor so the subclasses can decide if to do special
	stuff like pipe animation.

2001-02-07  Daniel Egger  <egger@suse.de>

	* configure.in: Changed link order in gtkxmhtml check
	to fix bug #12653.

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/picmancontext.[ch]: added "set_by_type", "get_by_type" and
	"changed_by_type" methods which take a GtkType and decide from
	that if to manipulate the Brush, Pattern etc.

	* app/picmancontainerview.[ch]
	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]: added a PicmanContext to the views
	which is used to manage the active item.

	* app/commands.c: pass the user_context to the test views.

	* app/picmanbrushpreview.c
	* app/picmanpatternpreview.c
	* app/picmanpreview.[ch]: added a virtual "needs_popup" method which
	returns a boolean indicating if the viewable is already fully
	visible.

	* app/gimage.[ch]: removed gimage_foreach() and some other
	functions which can easily be done by picman_container_foreach().
	Removed gimage_delete().

	* app/fileops.c
	* app/gdisplay.c
	* app/lc_dialog.c
	* app/nav_window.c
	* app/palette_import.c
	* app/preferences_dialog.c
	* app/xcf.c
	* app/pdb/image_cmds.c
	* tools/pdbgen/pdb/image.pdb: changed accordingly. Switched from
	"disp_count" refcounting to real GtkObject refcounting for
	PicmanImages.

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/picmanbrush.[ch]
	* app/picmanbrushpreview.c: moved the scale and pipe indicator
	rendering code from PicmanBrush to PicmanBrushPreview.
	Removed the "dirty" signal from PicmanBrush and use
	"invalidate_preview" of the PicmanViewable class.

	* app/brush_edit.c
	* app/brush_select.c
	* app/picmanbrushgenerated.c
	* app/picmancontext.c
	* app/picmancontextpreview.c
	* app/tools/paint_core.c: changed accordingly.

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanimagepreview.[ch]: new object with own implementations
	of "create_preview" and "create_popup".

	* app/picmandrawablepreview.c: stuff... still unused.

	* app/picmanpreview.c: fixed idle rendering crashes, don't
	forget popups on GDK_2BUTTON_PRESS.

	* app/app_procs.c: picmanbrushlist.h doesn't exist any more.

	* app/picmanobject.h: removed the PicmanObject typedef because it
	is in apptypes.h

2001-02-07  Hans Breuer <Hans@Breuer.org>

	* */makefile.msc : Picman 1.3 for win32 (msc) builds and runs at 
	this short moment, it's a fast moving target nowadays :-)

	* app/app_procs.c
	* app/picmanbrush.c
	* app/picmanbrushpipe.c
	* app/picmanpattern.c : make sure G_OS_WIN32 is defined (by glib.h 
	inclusion) before actually using it

	* app/plug_in.h 
	* app/datafiles.h : <time.h> for time_t

	* app/tile_swap.c : include <stdio.h> for SEEK_SET

	* app/picmancontainer.c : use G_GNUC_FUNCTION instead of 
	__FUNCTION__ to allow compiling without gcc

	* app/dialog_handler.h : don't use conditional prototypes
	for gmodule exported function but include <gmodule.h> and
	use G_MODULE_EXPORT in prototype, too.

	* app/picmanobject.h : added typedef for PicmanObject

	* libpicman/picman.def : more exported symbols

	* libpicman/picmancolorselector.h : #include <gmodule.h> for
	G_MODULE_EXPORT,  sane prototypes.

	* libpicman/picmanui.def : symbol export update, splitted to
	picmanwidgets.def

	* libpicmancolor/picmancolor.def
	* libpicmanmath/picmanmath.def
	* libpicmanwidgets/picmanwidgets.def : updated

	* libpicmanwidgets/libpicman-glue.c : new file which supports
	real dynamic linking on win32, against exported symbols from
	the application or libpicman. This allows to resolve the
	double dependency for currently 11 functions

2001-02-07  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmandrawable-preview.[ch]: new files formerly known as
	picmandrawablepreview.[ch].

	This a new naming scheme for methods of objects which live outside
	their object's file. The old name implied a derived object (and
	is in fact now taken by a PicmanPreview subclass, see below).

	Further candidates for renaming are e.g. picmandrawable-invert.[ch],
	picmanimage-convert.[ch] etc.  Finaly, the main objects (image,
	drawable) will go to their own directories together with their
	subclasses.

	* app/apptypes.h: added typedefs for the new objects:

	* app/picmanbrushpreview.[ch]
	* app/picmanpatternpreview.[ch]: new subclasses of PicmanPreview.

	* app/picmandrawablepreview.[ch]: contains a subclass of PicmanPreview
	now.

	* app/picmanviewable.[ch]: renamed the virtual functions to
	"get_preview" and "get_new_preview" to avoid confusion with the
	new PicmanPreview subclasses.

	* app/picmanpreview.[ch]: virtualized "create_preview" and
	"create_popup".

	* app/picmanmarshal.[ch]: new marsaller for PicmanPreview.

	* app/channels_dialog.c
	* app/fileops.c
	* app/picmanbrush.c
	* app/picmandnd.c
	* app/picmandrawable.c
	* app/picmanimage.c
	* app/picmanpattern.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/lc_dialog.c
	* app/nav_window.c
	* app/palette_import.c
	* app/undo_history.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

2001-02-06  Michael Natterer  <mitch@picman.org>

	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]: added "min_items_x" and
	"min_items_y" parameters to the constructors.

	* app/picmanpreview.[ch]: added event handling for "click" and
	"popup", show a dummy popup for testing.

	* app/commands.c: changed accordingly.

	* app/menus.c: added a separator and removed N_() from the test stuff.

2001-02-06  Simon Budig  <simon@picman.org>

        * libpicmanwidgets/picmandialog.c

	fixed the documentation.

2001-02-06  Simon Budig  <simon@picman.org>

	* libpicmanwidgets/picmandialog.c
	* app/tools/tool_options_dialog.c

	Implemented a way to connect the delete-event of a picmandialog
	without adding an extra button. If you pass "_delete_event_"
	as button text (untranslated) the button will not be created.
	
	Removed the tool-options "Close" button. Lots of other Close-Buttons
	wait for their removal.

2001-02-06  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanconstrainedhwrapbox.[ch]: A bad hack on top of another
	hack: The GtkHWrapBox "size_request" method _always_ wants a
	maximal requisition height, which it of course gets from a
	container like the scrolled window, yielding in wrong vscrollbar
	calculation.

	* app/picmanbrush.c: create a nice preview with scale and pipe
	indicators.

	* app/picmancontainergridview.[ch]: use the PicmanConstrainedHWrapBox.

	* app/commands.c
	* app/picmancontainerlistview.c
	* app/picmanpreview.c: cleanup, fixed a crash in the preview idle
	rendering function.

2001-02-06  Sven Neumann  <sven@picman.org>

	* data/brushes/hsparks.gih
	* data/brushes/vine.gih: seems we had forgotten to convert these
	to the new format.

2001-02-05  Jay Cox  <jaycox@picman.org>

	* app/picmanhistogram.c: Applied patches by Roel Schroeven
	<rschroev@yahoo.com> that fix histogram with mask calculation bug and
	median calculation bug.

2001-02-06  Michael Natterer  <mitch@picman.org>

	* app/picmancontainergridview.[ch]: add the spacing between the
	previews here instead of expecting an already bordered preview.
	Set the widget background to white.

	* app/picmanpattern.c: removed the white border hack.

2001-02-06  Michael Natterer  <mitch@picman.org>

	* app/picmancontainergridview.[ch]
	* app/picmancontainerlistview.[ch]
	* app/picmancontainerview.[ch]: implemented "set_preview_size".

	* app/commands.c: added a preview size slider to the test dialogs.

2001-02-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmancontainergridview.[ch]: new widget providing a grid view
	in the style of the current brush and pattern selections.

	* app/picmancontainerlistview.[ch]
	* app/picmanpreview.[ch]: the constructors take "width" and "height"
	parameters now.

	* app/picmanviewable.c: if the viewable is not able to generate
	a static (cached) preview, create a new one and cache it ourselves.

	* app/picmanpattern.c: produce a nice preview.

	* app/temp_buf.[ch]: changed temp_buf_copy_area() to take a
	destination offset instead of a border parameter. This function
	was not used at all before.

	* app/commands.[ch]
	* app/menus.c: test dialogs for the grid view.

2001-02-05  Michael Natterer  <mitch@picman.org>

	* app/picmancontainerlistview.[ch]
	* app/picmancontainerview.[ch]
	* app/picmanmarshal.[ch]: moved the signal connecting stuff to the
	PicmanContainerViewClass which has virtual functions for insert,
	remove and clear now which are implemented by the
	PicmanContainerListViewClass.

2001-02-05  Michael Natterer  <mitch@picman.org>

	* app/picmancontainer.[ch]
	* app/picmanlist.[ch]: made the "get_by_name" and the "by_index"
	access functions methods of the PicmanContainerClass. The semantic
	of this index is somewhat unclear if we have e.g. a hash table
	implementation but the container needs to have an order for the
	ContainerView. Finally, the ordering will be a feature of the
	ContainerView.

	* app/picmanmarshal.[ch]: marshallers needed for the new methods.

	* app/brushes.[ch]
	* app/patterns.[ch]: the public global brush and pattern lists
	are PicmanContainers now (they are really PicmanLists of course).

	* app/brush_select.c
	* app/devices.c
	* app/picmancontainerlistview.c
	* app/picmancontext.c
	* app/picmandnd.c
	* app/pattern_select.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: changed accordingly.

2001-02-05  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h: some new files and data types:

	* app/picmanpreview.[ch]: new widgets which provides a view
	of a PicmanViewable.

	* app/picmancontainerview.[ch]: new abstract widget base class for
	views of PicmanContainers of PicmanViewables

	* app/picmancontainerlistview.[ch]: (still) simple implementation of
	a list view of the container.

	* app/picmanbrush.[ch]
	* app/picmanpattern.[ch]: provide dumb implementations of the
	PicmanViewable's "preview" method.

	* app/image_render.c: quick bad hack to enable preview sizes which
	are != "preview_size": Always allocate data chunks for previews up
	to 256 pixels width.

	* app/drawable.c: emit the "incalidate_preview" signal from
	drawable_update(). This may cause useless updates at the moment
	but as we want to move from explicit updates to signal-driven
	model-view stuff it's the right thing (TM).

	* app/commands.[ch]
	* app/interface.c
	* app/menus.c: Added a "Test dialogs" menu to the Toolbox.

	* app/pdb/image_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: propagated the new alpha channel stuff
	to the autogenerated files.

2001-02-05  Nick Lamb  <njl195@zepler.org.uk>

	* app/channels_dialog.c
	* app/picmanimage.c
	* app/picmanimage.h: Initial commit of "Alpha" transparency channel

2001-02-04  Nick Lamb  <njl195@zepler.org.uk>

	* app/patterns.c: Missing <string.h> again

2001-02-04  Nick Lamb  <njl195@zepler.org.uk>

	* app/brushes.c: New file == new missing includes! <string.h>

2001-02-04  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h
	* app/picmanviewable.[ch]: new object. Everything that can have a
	preview will be a PicmanViewable. The virtual functions are
	"invalidate_preview", "preview" and "preview_new".

	* app/picmanmarshal.[ch]: new marshaller needed for the viewable.

	* app/picmandrawable.[ch]
	* app/picmanimage.[ch]: derived from PicmanViewable. Removed the
	preview stuff from the public interface.

	Made a single boolean out of PicmanImage's "comp_preview_valid"
	array because we have only one composite preview.

	* app/picmanlayer.c: made the preview stuff private.

	* app/picmanpreviewcache.[ch]: removed picman_preview_scale()...

	* app/temp_buf.[ch]: ...and added it as temp_buf_scale() here.

	* app/picmandrawablepreview.[ch]: is a private method of
	PicmanDrawable now.

	* app/channels_dialog.c
	* app/convert.c
	* app/drawable.c
	* app/fileops.c
	* app/floating_sel.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmanchannel.c
	* app/picmancontainer.c
	* app/picmandnd.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/lc_dialog.c
	* app/nav_window.c
	* app/palette_import.c
	* app/undo.c
	* app/undo_history.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/tools/crop.c
	* app/tools/edit_selection.c
	* app/tools/ink.c
	* app/tools/paint_core.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb
	* po/POTFILES.in: changed accordingly.

2001-02-04  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanpattern.[ch]: new object.

	* app/apptypes.h: added PicmanPattern, removed GPattern.

	* app/patterns.[ch]: contains only the "patterns_()" functions for
	the global pattern list, s/pattern_list/global_pattern_list/g

	* app/brushes.[ch]: s/brush_list/global_brush_list/g

	* app/pattern_select.[ch]
	* app/picmancontext.[ch]: connect to the Patterns' and the pattern
	list's signals.

	* app/brush_select.[ch]
	* app/devices.c
	* app/disp_callbacks.[ch]
	* app/picmanbrush.c
	* app/picmanbrushgenerated.[ch]
	* app/picmancontextpreview.[ch]
	* app/picmandnd.[ch]
	* app/indicator_area.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/pattern_select_cmds.c
	* app/pdb/patterns_cmds.c
	* app/tools/bucket_fill.c
	* app/tools/clone.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* po/POTFILES.in: changed accordingly.

2001-02-04  Michael Natterer  <mitch@picman.org>

	* app/picmancontainer.[ch]: renamed picman_container_lookup() back
	to picman_container_have(). Virtualized the "add", "remove",
	"have" and "foreach" methods and removed the "children" list.

	* app/picmanlist.[ch]: derived from PicmanContainer now.

	* app/Makefile.am
	* app/picmandatalist.[ch]: new object: an alphabetically sorted
	PicmanList with unique names.

	* app/picmanbrushlist.[ch]: removed. It's job is done by the
	PicmanDataList now.

	* app/brushes.[ch]: new files. Contains the "brushes_()" functions
	for the global brush list.

	* app/app_procs.c
	* app/apptypes.h
	* app/brush_select.[ch]
	* app/colormap_dialog.[ch]
	* app/context_manager.c
	* app/devices.c
	* app/picmanbrush.c
	* app/picmancontext.c
	* app/picmandnd.c
	* app/info_window.c
	* app/lc_dialog.c
	* app/module_db.c
	* app/nav_window.c
	* app/pdb/brush_select_cmds.c
	* app/pdb/brushes_cmds.c
	* app/tools/by_color_select.c
	* app/tools/paintbrush.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* po/POTFILES.in: changed accordingly.

2001-02-04  Nick Lamb  <njl195@zepler.org.uk>

	* app/picmandrawablepreview.c: add <stdlib.h> or <string.h> where needed
	* app/picmanobject.c
	* app/picmanui.c
	* app/image_new.c
	* app/layers_dialog.c
	* app/paint_funcs.c
	* app/palette.c
	* app/palette_import.c
	* app/palette_select.c
	* app/tile_manager.c
	* app/toolbox.c
	* app/user_install.c
	* app/tools/by_color_select.c
	* app/tools/curves.c
	* app/tools/measure.c
	* app/tools/shear_tool.c

2001-02-03  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanset.[ch]: removed.

	* app/picmancontainer.[ch]: some minor fixes, cleanup.

	* app/context_manager.[ch]: made the "image_context" a PicmanContainer
	and moved it here...

	* app/appenv.h
	* app/main.c: ...from here.

	* app/app_procs.c
	* app/colormap_dialog.[ch]
	* app/commands.c
	* app/gimage.c
	* app/picmancontext.c
	* app/picmanimage.c
	* app/info_window.c
	* app/lc_dialog.c
	* app/lut_funcs.c
	* app/module_db.c
	* app/nav_window.c
	* app/palette_import.c
	* app/paths_dialog.c
	* app/pixel_region.c
	* app/scale.c
	* app/scroll.c
	* app/selection.c
	* app/temp_buf.c
	* app/undo.c
	* app/pdb/procedural_db.c
	* app/tools/by_color_select.c
	* app/tools/clone.c
	* app/tools/color_balance.c
	* app/tools/color_picker.c
	* app/tools/convolve.c
	* app/tools/crop.c
	* app/tools/curves.c
	* app/tools/paint_core.c
	* app/tools/transform_core.c: s/PicmanSet/PicmanContainer/g, removed
	many useless #include "appenv.h".

	* app/picmandrawablepreview.c
	* app/gdisplay.c: found two badly crashing bugs i have introduced
	with my last changes here.

2001-02-03  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/apptypes.h

	* app/picmancontainer.[ch]: new (yet unused and untested) object
	which will replace PicmanSet, PicmanList and PicmanBrushList and be the
	container and signal proxy for all collections of PicmanObjects.

2001-02-02  Michael Natterer  <mitch@picman.org>

	* po/POTFILES.in: forgot to rename the files here.

2001-02-01  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanchannel.[ch]
	* app/picmanlayer.[ch]: new files moved here by Yosh.

	* app/channel.[ch]
	* app/layer.[ch]: removed.

	* app/gdisplay.c: cleanup stuff.

	* app/[lotsa files].c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/layer.pdb: changed includes accordingly.

2001-01-31  Seth Burgess <sjburges@picman.org>
	
	* plug-ins/perl/po/POTFILES.in : removed bilb/lib/Picman.pm from list,
	as this is a file generated during the build!!

2001-01-30  Michael Natterer  <mitch@picman.org>

	* app/image_render.[ch]: prefixed all global variables with
	"render_" (we had a global variable named "temp_buf", brrrr),
	general cleanup.

	* app/colormap_dialog.c
	* app/layers_dialog.c: changed accordingly.

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/dialog_types.h: removed because it was unused.

	* app/Makefile.am: removed dialog_types.h, reordered the file list
	to group together what may go to "pixmaps", "widgets" and
	"lowlevel" (???) directories.

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/channel.[ch]: removed channel_update() because channel.c
	should not call gdisplays_update(). Use drawable_update() and
	a subsequent gdisplays_update() instead.

	* app/qmask.c: do as described above.

	* app/channel_ops.c
	* app/channels_dialog.c
	* app/commands.c
	* app/convert.c
	* app/disp_callbacks.c
	* app/equalize.c
	* app/fileops.c
	* app/floating_sel.c
	* app/gdisplay.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmandnd.c
	* app/picmandrawablepreview.c
	* app/picmanhistogram.c
	* app/picmanlayermask.c
	* app/global_edit.c
	* app/histogramwidget.c
	* app/histogramwidget.h
	* app/image_map.c
	* app/image_new.c
	* app/invert.c
	* app/layer.c
	* app/layer_select.c
	* app/paths_dialog.c
	* app/plug_in.c
	* app/scan_convert.c
	* app/undo_history.c
	* app/xcf.c: include picmandrawable.h instead of drawable.h where
	possible, removed useless includes, minor other cleanups.

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmandrawablepreview.[ch]: new file with one set of functions...

	* app/channel.[ch]
	* app/layer.[ch]: ...instead of having everything duplicated three
	times here.

	* app/channels_dialog.c
	* app/floating_sel.c
	* app/floating_sel.h
	* app/picmandnd.c
	* app/picmanimage.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/selection.c
	* app/pdb/drawable_cmds.c
	* tools/pdbgen/pdb/drawable.pdb: changed accordingly, cleanup.

2001-01-29  Sven Neumann  <sven@picman.org>

	* HACKING: defined The PICMAN Hackordnung (ACHTUNG!)

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/undo_history.h: new file.

	* app/apptypes.h: removed the "Channel" typedef.

	* app/channel.[ch]: renamed all functions to picman_channel_*()

	* app/channel_ops.c
	* app/channels_dialog.c
	* app/commands.c
	* app/disp_callbacks.c
	* app/gdisplay.c
	* app/gimage_mask.[ch]
	* app/picmandnd.c
	* app/picmanhistogram.c
	* app/picmanimage.[ch]
	* app/global_edit.c
	* app/layer.c
	* app/layers_dialog.c
	* app/qmask.c
	* app/scan_convert.c
	* app/scan_convert.h
	* app/toolbox.c
	* app/undo.[ch]
	* app/undo_history.c
	* app/xcf.[ch]
	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/pdb_glue.h
	* app/pdb/selection_cmds.c
	* app/pdb/tools_cmds.c
	* app/tools/bezier_select.c
	* app/tools/bezier_selectP.h
	* app/tools/blend.c
	* app/tools/bucket_fill.c
	* app/tools/by_color_select.c
	* app/tools/crop.c
	* app/tools/ellipse_select.c
	* app/tools/free_select.c
	* app/tools/fuzzy_select.c
	* app/tools/fuzzy_select.h
	* app/tools/iscissors.c
	* app/tools/rect_select.c
	* app/tools/text_tool.c
	* app/tools/transform_core.c
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly.

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/pdb_glue.h: new file which contains the stuff that makes
	PDB code generation easier but is ugly when used in the app
	(see my comment in the log below).

	Contains:
	picman_drawable_[layer|layer_mask|channel]()
	[channel|picman_layer]_[set|get]_[name|tattoo]()

	* app/channel.[ch]
	* app/channels_dialog.c
	* app/picmandrawable.h
	* app/picmanimage.c
	* app/picmanlayermask.h
	* app/layer.c
	* app/layer.h
	* app/toolbox.c
	* app/undo.c
	* app/xcf.c
	* app/pdb/channel_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c
	* app/tools/bezier_select.c
	* app/tools/bucket_fill.c
	* app/tools/by_color_select.c
	* app/tools/ellipse_select.c
	* app/tools/free_select.c
	* app/tools/fuzzy_select.c
	* app/tools/iscissors.c
	* app/tools/rect_select.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

2001-01-29  Sven Neumann  <sven@picman.org>

	* AUTHORS
	* app/authors.h
	* app/pdb/channel_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/selection_cmds.c
	* libpicman/picmanchannel_pdb.c
	* libpicman/picmanchannel_pdb.h
	* libpicman/picmanselection_pdb.c
	* libpicman/picmanselection_pdb.h
	* tools/authorsgen/contributors
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/selection.pdb: applied a patch from Adam Spiers 
	<adam@spiers.net> which adds two new PDB functions: selection_combine 
	and channel_combine_masks.

2001-01-29  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h: removed the "Layer" typedef.

	* app/layer.[ch]: removed the defines of the old function names.

	Don't implement methods of the parent class (get_name, get_tattoo, ...)
	but define them as macros. They will go to a separate "pdb_glue.h"
	header because they are used only by the PDB to simplify code
	generation (no application file should say picman_layer_get_tattoo()
	but always picman_drawable_get_tatoo()).

	* app/channel.h
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/commands.c
	* app/convert.c
	* app/disp_callbacks.c
	* app/floating_sel.[ch]
	* app/gdisplay.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/gimage_mask.h
	* app/picmandnd.c
	* app/picmandrawable.h
	* app/picmanimage.[ch]
	* app/picmanlayermask.h
	* app/global_edit.c
	* app/image_new.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/resize.c
	* app/undo.c
	* app/xcf.[ch]
	* app/pdb/drawable_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/tools/bucket_fill.c
	* app/tools/by_color_select.c
	* app/tools/clone.c
	* app/tools/crop.c
	* app/tools/edit_selection.c
	* app/tools/ink.c
	* app/tools/move.c
	* app/tools/paint_core.c
	* app/tools/rect_select.c
	* app/tools/text_tool.c
	* app/tools/transform_core.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb: changed accordingly, cleanup.

2001-01-28  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmanlayermask.[ch]: new files cut out of layer.[ch]. Renamed
	all functions to picman_layes_mask_*(). removed artefacts like
	the ref/unref functions.

	* app/apptypes.h: removed the "LayerMask" typedef.

	* app/layer.[ch]: removed the layer mask stuff and renamed all
	functions to picman_layer_*(). Added temporary typedefs for the old
	function names. The layer mask preview stuff is still there (should
	probably go to new layer_preview.{ch] files).

	* app/picmanimage.[ch]: added
	picman_image_invalidate_[layer|channel]_previews() formerly known as
	[layer|channel]_invalidate_previews().

	* app/channel.[ch]: moved channel_layer_alpha() and 
	channel_layer_mask() here because they are methods of the Channel.

	* app/channel_ops.c
	* app/convert.c
	* app/disp_callbacks.c
	* app/fileops.c
	* app/floating_sel.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmandnd.c
	* app/global_edit.c
	* app/layers_dialog.c
	* app/preferences_dialog.c
	* app/toolbox.c
	* app/undo.c
	* app/xcf.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/tools/crop.c
	* app/tools/text_tool.c
	* app/tools/transform_core.c
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/drawable.pdb: changed accordingly, cleanup.

2001-01-26  Daniel Egger  <egger@suse.de>

	* plug-ins/common/iwarp.c: Cleaned up code and
	implemented 2 small optimisations.

2001-01-26  Daniel Egger  <egger@suse.de>

	* libpicmanmath/picmanvector.c:
	* libpicmanmath/picmanvector.h: Added pass-by-value functions
	to allow code simplifications and functionchaining.

Thu Jan 25 10:22:39 PST 2001 Manish Singh <yosh@picman.org>

	* tools/pdbgen/pdb/channel.pdb: resurrected channel_set_color

2001-01-25  Michael Natterer  <mitch@picman.org>

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmancompat.h: removed.

	The PICMAN 1.0 API is not supported any more !!!

	* plug-ins/print/print-image-picman.c
	* plug-ins/print/print.c
	* plug-ins/print/print_picman.h: a quick fix for old compat cruft.
	This is temporary and will be replaced by Picman-Print's development
	version.

	* plug-ins/xjt/xjpeg.c: use PicmanRGB.

2001-01-25  Sven Neumann  <sven@picman.org>

	* app/libpicman_glue.[ch]: cleanup

	* app/pdb/channel_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/tools_cmds.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/lib.pl
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/tools.pdb: fixed pdbgen code for color type. Seems
	to actually work now.

	* TODO.xml: updated

	* plug-ins/Makefile.am: disabled build of picman-perl until it has 
	catched up with the API changes in libpicman 

2001-01-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_mem_size_entry_new): merged fix 
	from picman-1-2 branch 

2001-01-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/lib.pl
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/tools.pdb: changed these with the help of Yosh. 
	PDB functions take PicmanRGB as color type now.

	* app/plug_in.c
	* app/pdb/channel_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* app/pdb/procedural_db.[ch]
	* app/pdb/tools_cmds.c
	* libpicman/picman.[ch]
	* libpicman/picmanchannel.[ch]
	* libpicman/picmanchannel_pdb.[ch]
	* libpicman/picmanpalette_pdb.[ch]
	* libpicman/picmanprotocol.[ch]
	* libpicman/picmantools_pdb.[ch]: incremented Picman protocol version
	and changed color type from array of chars to PicmanRGB.

	* libpicman/Makefile.am
	* libpicman/picmanpalette.[ch]: removed these files again 

	* app/libpicman_glue.[ch]
	* libpicmanwidgets/picmancolorbutton.c
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/MapObject/mapobject_image.c
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/cubism.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/gif.c
	* plug-ins/common/grid.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/mblur.c
	* plug-ins/common/nova.c
	* plug-ins/common/papertile.c
	* plug-ins/common/png.c
	* plug-ins/common/polar.c
	* plug-ins/common/psd.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/sinus.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/tiff.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/warp.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/gap/gap_filter_iterators.c
	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gdyntext/gdyntext.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gfli/gfli.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/maze/handy.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/xjt/xjt.c: changed accordingly. A few plug-ins need
	to be looked at more closely after this change. I tried to put 
	FIXME comments into those.

2001-01-24  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* picmantool.in: added the new library below.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanchainbutton.[ch]
	* libpicmanwidgets/picmancolorarea.[ch]
	* libpicmanwidgets/picmancolorbutton.[ch]
	* libpicmanwidgets/picmandialog.[ch]
	* libpicmanwidgets/picmanfileselection.[ch]
	* libpicmanwidgets/picmanhelpui.[ch]
	* libpicmanwidgets/picmanpatheditor.[ch]
	* libpicmanwidgets/picmanpixmap.[ch]
	* libpicmanwidgets/picmanquerybox.[ch]
	* libpicmanwidgets/picmansizeentry.[ch]
	* libpicmanwidgets/picmanunitmenu.[ch]
	* libpicmanwidgets/picmanwidgets.[ch]
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgetstypes.h: new shared library.

	Currently there are some ugly dependencies into libpicman. These
	will be removed and go to a "libpicmanglue" library which will be
	a library for functions which share a common interface between
	plug-ins and the app but have different implementations.

	Include "libpicman/picmanunit.h" from "libpicmanwidgets/picmanwidgetstypes.h"
	to simulate this upcoming separation.

	* libpicman/Makefile.am
	* libpicman/picmanchainbutton.[ch]
	* libpicman/picmancolorarea.[ch]
	* libpicman/picmancolorbutton.[ch]
	* libpicman/picmandialog.[ch]
	* libpicman/picmanfileselection.[ch]
	* libpicman/picmanhelpui.[ch]
	* libpicman/picmanpatheditor.[ch]
	* libpicman/picmanpixmap.[ch]
	* libpicman/picmanquerybox.[ch]
	* libpicman/picmansizeentry.[ch]
	* libpicman/picmanunitmenu.[ch]
	* libpicman/picmanwidgets.[ch]: removed from here.

	* libpicman/picmanui.h
	* libpicman/picmanuitypes.h
	* libpicman/makefile.mingw.in
	* libpicman/makefile.msc: changed accordingly.

	* app/[all ui files]
	* app/pdb/palette_cmds.c
	* app/pdb/tools_cmds.c
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/tools.pdb: #include "libpicmanwidgets/picmanwidgets.h"
	and removed useless includes.

	* app/apptypes.h: #include "libpicmanwidgets/picmanwidgetstypes.h"

	* app/Makefile.am
	* plug-ins/[all makefiles which link against libpicmanui]:
	link against libpicmanwidgets.la

	* po-libpicman/POTFILES.in: changed file locations.

2001-01-24  Simon Budig  <simon@picman.org>

	* plug-ins/common/colortoalpha.c: wrapped some actions in a
	picman_undo_push_group_start/end, so you dont have to undo
	two steps when the plugin adds an alpha channel.

2001-01-24  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/.cvsignore
	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/makefile.mingw.in
	* libpicmanwidgets/makefile.msc: library stub. Please ignore for now :)

2001-01-24  Sven Neumann  <sven@picman.org>

	* app/paint_funcs.c: brought the array used for optimization back in
	sync with the LayerModeEffects enum. This was causing really strange
	rendering errors. Started to clean up the file up and removed the 
	unused layer_mode names.
	
	* app/tile.[ch]
	* plug-ins/common/colortoalpha.c: small cleanups

	* po/POTFILES.in: removed app/paint_funcs.c

2001-01-24  Sven Neumann  <sven@picman.org>

	* app/tools/airbrush.c
	* app/tools/by_color_select.c
	* app/tools/color_picker.c: include picmancolor/picmancolor.h

	* libpicmancolor/picmanrgb.c: optimized compositing functions.
	
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/MapObject/mapobject_preview.c: use picman_rgb_composite 
	functions instead of doing the blending manually

	* plug-ins/MapObject/map_object_shade.c: fixed a rendering bug when
	transparent_background == FALSE
	
2001-01-24  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* picmantool.in: added stuff for the new library below.

	* libpicmanmath/.cvsignore
	* libpicmanmath/Makefile.am
	* libpicmanmath/picmanmath.def
	* libpicmanmath/picmanmath.h
	* libpicmanmath/picmanmathtypes.h
	* libpicmanmath/picmanmatrix.c
	* libpicmanmath/picmanmatrix.h
	* libpicmanmath/picmanvector.c
	* libpicmanmath/picmanvector.h
	* libpicmanmath/makefile.mingw.in
	* libpicmanmath/makefile.msc: new shared library. Depends on glib only.

	* libpicman/Makefile.am
	* libpicman/picman.def
	* libpicman/picman.h: removed the math stuff.

	* libpicman/picmanmath.h
	* libpicman/picmanmatrix.[ch]
	* libpicman/picmanvector.[ch]: removed.

	* app/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/pagecurl/Makefile.am: link against libpicmanmath.la

	* app/[many files]
	* libpicmancolor/picmancolorspace.c
	* libpicmancolor/picmanrgb.c
	* libpicman/picmanadaptivesupersample.c
	* libpicman/picmanbilinear.c
	* libpicman/picmanwidgets.c
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c
	* plug-ins/libgck/gck/gckcolor.c
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/image.pdb: include "libpicmanmath/picmanmath.h",
	removed the remaining includes of the old color stuff.

2001-01-23  Michael Natterer  <mitch@picman.org>

	* Makefile.am
	* configure.in
	* picmantool.in: added stuff for the new library below.

	* libpicmancolor/.cvsignore
	* libpicmancolor/Makefile.am
	* libpicmancolor/picmancolor.h
	* libpicmancolor/picmancolorspace.c
	* libpicmancolor/picmancolorspace.h
	* libpicmancolor/picmancolortypes.h
	* libpicmancolor/picmanhsv.c
	* libpicmancolor/picmanhsv.h
	* libpicmancolor/picmanrgb.c
	* libpicmancolor/picmanrgb.h: new shared library which both the app
	and plug-ins link against. The library depends only on glib.

	* libpicmancolor/picmancolor.def
	* libpicmancolor/makefile.mingw.in
	* libpicmancolor/makefile.msc: added Win32 build files which
	definitely don't work.

	* libpicman/Makefile.am
	* libpicman/picmancolor.[ch]
	* libpicman/picmancolorspace.[ch]: removed.

	* libpicman/picman.h
	* libpicman/picmanadaptivesupersample.c
	* libpicman/picmanbilinear.c
	* libpicman/picmanpalette.c
	* libpicman/picmantypes.h: include the stuff from libpicmancolor.

	Plug-Ins don't need to include <libpicmancolor/picmancolor.h>
	explicitely. LibPicman depends on libpicmancolor and thus also includes
	it's headers.

	* libpicman/picman.def
	* libpicman/makefile.mingw.in: fiddled around with Win32 stuff...

	* app/Makefile.am: link against libpicmancolor.la

	* app/apptypes.h: include "libpicmancolor/picmancolortypes.h"

	* app/asupsample.c
	* app/channels_dialog.c
	* app/colormap_dialog.c
	* app/commands.c
	* app/convert.c
	* app/devices.c
	* app/disp_callbacks.c
	* app/drawable.c
	* app/picmancontext.c
	* app/picmandnd.c
	* app/picmanimage.c
	* app/picmanpalette.c
	* app/picmanrc.c
	* app/gradient.c
	* app/libpicman_glue.c
	* app/palette.c
	* app/palette_import.c
	* app/qmask.c
	* app/xcf.c
	* app/tools/paint_core.c
	* app/tools/paintbrush.c
	* app/tools/pencil.c: include "libpicmancolor/picmancolor.h" before all
	picman includes because it's a standalone library.

	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/bmp/Makefile.am
	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/faxg3/Makefile.am
	* plug-ins/fits/Makefile.am
	* plug-ins/flame/Makefile.am
	* plug-ins/fp/Makefile.am
	* plug-ins/gap/Makefile.am
	* plug-ins/gdyntext/Makefile.am
	* plug-ins/gfig/Makefile.am
	* plug-ins/gflare/Makefile.am
	* plug-ins/gfli/Makefile.am
	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/ifscompose/Makefile.am
	* plug-ins/imagemap/Makefile.am
	* plug-ins/maze/Makefile.am
	* plug-ins/mosaic/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/print/Makefile.am
	* plug-ins/rcm/Makefile.am
	* plug-ins/script-fu/Makefile.am
	* plug-ins/sel2path/Makefile.am
	* plug-ins/sgi/Makefile.am
	* plug-ins/webbrowser/Makefile.am
	* plug-ins/xjt/Makefile.am: add libpicmancolor.la to LDADD.

	* INSTALL: don't recommend to --disable-shared for development.

	* TODO.xml: increased some percentages, added plug-in help stuff.

2001-01-23  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/libpicman_glue.[ch]: new files containing stuff needed for
	linking libpicman stuff against the app. This file is not needed
	at all for the app itself and should never be included.

	* app/picmancontext.[ch]: removed from here.

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmanpalette.[ch]: new files for the PDB wrapping
	picman_palette_*_rgb() stuff.

	* libpicman/picmancolor.[ch]: removed the PDB dependency from here.

2001-01-23  Sven Neumann  <sven@picman.org>

	* app/paint_funcs.c
	* app/pixel_processor.c
	* app/tile.c
	* app/tile_cache.c
	* app/tile_manager.c
	* app/tile_pvt.h
	* app/tile_swap.[ch]: cleanups, indentation

2001-01-23  Sven Neumann  <sven@picman.org>

	* app/convert.c
	* app/floating_sel.c
	* app/gimage_mask.c
	* app/picmanimage.c
	* app/global_edit.c
	* app/image_map.c
	* app/image_new.c
	* app/layer.c
	* app/paint_funcs.c
	* app/pixel_region.c
	* app/tile_manager.c
	* app/tile_manager.h
	* app/tile_manager_pvt.h
	* app/undo.c
	* app/xcf.c
	* app/pdb/tools_cmds.c
	* app/tools/flip_tool.c
	* app/tools/perspective_tool.c
	* app/tools/rotate_tool.c
	* app/tools/scale_tool.c
	* app/tools/shear_tool.c
	* app/tools/text_tool.c
	* app/tools/transform_core.c
	* tools/pdbgen/pdb/tools.pdb: made all files execpt xcf.c use the
	TileManager accessor functions instead of accessing the TileManager
	struct directly.

2001-01-23  Sven Neumann  <sven@picman.org>

	* TODO.xml: updated, added sections about libgck and script-fu

2001-01-23  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/edit_selection.[ch]: removed.

	* app/tools/Makefile.am
	* app/tools/edit_selection.[ch]: added.

	* po/POTFILES.in: changed.

2001-01-23  Michael Natterer  <mitch@picman.org>

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmanadaptivesupersample.[ch]
	* libpicman/picmanbilinear.[ch]: new files cut out of LibGCK.

	* plug-ins/libgck/gck/gck.h
	* plug-ins/libgck/gck/gckcolor.c: removed the bilinear and
	supersample code.

	* app/apptypes.h
	* app/asupsample.[ch]
	* app/tools/blend.c: made the adaptive_supersample interface the
	same as in libpicman but don't use the libpicman function yet.

	The libpicman function takes total transparancy into account when
	weighting the 4 resulting RGBA values, the app function always
	weights them equally. Please have a look at the code.

	* plug-ins/Lighting/lighting_image.c
	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/MapObject/mapobject_image.[ch]: changed accordingly.

	* app/disp_callbacks.c: paranoia cleanups.

2001-01-22  Sven Neumann  <sven@picman.org>

	* app/gdisplay.c
	* app/gdisplay_ops.c
	* app/info_window.c
	* app/layer.c
	* app/menus.c
	* app/nav_window.c
	* app/path.c
	* app/scroll.[ch]: removed inclusion of superfluous headers and
	cleaned up the source a little.

2001-01-22  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/tool_options_dialog.[ch]: new files for the tool
	options dialog.

	* app/tools/tools.[ch]: removed from here.

	* app/app_procs.c
	* app/commands.c
	* app/toolbox.c
	* po/POTFILES.in: adjusted.

2001-01-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/selection_options.h: removed.

	* app/tools/Makefile.am
	* app/tools/selection_options.h: added.

	* app/tools/selection_options.c
	* app/tools/paint_options.c: new files cut out of tool_options.c

	* app/tools/tool_options.c: removed the paint & selection
	options code.

	* app/tools/tool_options.h
	* app/tools/paint_options.h: cleanup.

	* po/POTFILES.in: added selection_options.c and paint_options.c

2001-01-22  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/toolbox.[ch]: new files containing most of the code
	from app/interface.[ch]

	* app/interface.[ch]: only contains create_display_shell() now.
	Needs to be somehow merged with other arbitrarily named display
	files around.

	* app/app_procs.c
	* app/menus.c
	* po/POTFILES.in: changed accordingly.

	* app/asupsample.c
	* app/gradient.c
	* app/tile.c: cleanup.

2001-01-22  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/Makefile.am
	* app/tools/Makefile.am: moved all tool sources to app/tools

	* app/app_procs.c
	* app/brush_select.c
	* app/commands.c
	* app/context_manager.c
	* app/convert.c
	* app/cursorutil.c
	* app/devices.c
	* app/disp_callbacks.c
	* app/edit_selection.c
	* app/gdisplay.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmanbrush.c
	* app/picmanbrushgenerated.c
	* app/picmanbrushpipe.c
	* app/picmandnd.c
	* app/picmanrc.c
	* app/global_edit.c
	* app/info_window.c
	* app/interface.c
	* app/menus.c
	* app/path.c
	* app/paths_dialog.c
	* app/paths_dialogP.h
	* app/scale.c
	* app/scroll.c
	* app/undo.c
	* app/pdb/color_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/tools_cmds.c
	* po/POTFILES.in
	* tools/kernelgen.c
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly	

2001-01-22  Daniel Egger  <egger@suse.de>

	* libpicman/picmancolor.c: #include "picmanpalette_pdb.h"
	to shut up the compiler.

Sun Jan 21 15:23:27 PST 2001 Manish Singh <yosh@picman.org>

	* tools/pdbgen/enumgen.pl: handle subdirs

2001-01-21  Simon Budig  <simon@picman.org>

	* app/pdb/README: Added another warning about autogenerated files

2001-01-21  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/app.pl: changed destdir for app-side PDB wrappers to
	app/pdb

	* app/Makefile.am: don't create libpicmanim.a in app.

	* configure.in
	* app/pdb/Makefile.am
	* app/pdb/internal_procs.[ch]
	* app/pdb/procedural_db.[ch]
	* app/pdb/*_cmds.c: moved PDB functions into their own subdirectory.

	* app/internal_procs.[ch]
	* app/procedural_db.[ch]
	* app/*_cmds.c: removed here

	* app/app_procs.c
	* app/batch.c
	* app/bezier_select.c
	* app/brush_select.c
	* app/bucket_fill.c
	* app/colormap_dialog.c
	* app/fileops.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmanhelp.c
	* app/gradient_select.c
	* app/info_window.c
	* app/invert.c
	* app/lc_dialog.c
	* app/menus.c
	* app/nav_window.c
	* app/palette_import.c
	* app/paths_dialog.c
	* app/pattern_select.c
	* app/plug_in.h
	* app/text_tool.c
	* app/xcf.c
	* po/POTFILES.in: changed accordingly
	
2001-01-21  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/palette_import.[ch]: moved the palette_import dialog to
	it's own file.

	* app/gimage.c
	* app/palette.[ch]
	* app/paletteP.h: changed accordingly.

2001-01-21  Simon Budig  <simon@picman.org>

	* modules/colorsel_triangle.c: Fixed the "disappearing
	triangle" bug. The triangle happens to be more triangular
	now too...   :-)

2001-01-21  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/Makefile.am: removed interp_md5.[ch] from
	the build because it was not used at all.

	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/script-fu/script-fu.c: even more pedantic indentation

2001-01-21  Michael Natterer  <mitch@picman.org>

	* app/palette_entries.h: removed.
	* app/picmanpalette.[ch]: new object derived from PicmanObject. Just
	used as a container at the moment (no signals or stuff used).

	* app/palette.[ch]: changed almost every line except in the
	import_dialog part.

	* app/Makefile.am
	* app/apptypes.h
	* app/convert.[ch]
	* app/picmandnd.h
	* app/paletteP.h
	* app/palette_select.[ch]
	* app/convert_cmds.c
	* tools/pdbgen/pdb/convert.pdb: changed accordingly.

	* app/picmandrawable.c: set klass->removed to NULL.

2001-01-21  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]: added a "title" parameter to the
	constructor. Pass a pointer to the ColorNotebook to the callback.
	Added a _get_color() function.

	* app/color_panel.[ch]: added a "title" parameter which is used
	for the notebook.

	* app/channels_dialog.c
	* app/color_area.c
	* app/colormap_dialog.c
	* app/convert.c
	* app/palette_select.c
	* app/qmask.c: changed the calls to color_notebook_new(),
	color_panel_new() and the ColorNotebook callbacks.

	* app/gradient.c: use a ColorNotebook instead of GtkColorSelection.

	* app/palette.c
	* app/palette_entries.h: use PicmanRGB to store the color in the
	PaletteEntry.

	* po/POTFILES.in: added app/color_area.c

2001-01-20  Michael Natterer  <mitch@picman.org>

	* app/gradient.[ch]: made gradient_get_color_at() use PicmanRGB.

	* app/airbrush.c
	* app/blend.c
	* app/picmancontextpreview.c
	* app/gradient_select.c
	* app/paint_core.[ch]
	* app/paintbrush.c
	* app/palette.c
	* app/pencil.c

	* app/gradients_cmds.c
	* app/gradient_select_cmds.c
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb: changed accordingly.

2001-01-20  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]
	* app/picmancontext.[ch]
	* app/picmandnd.h: made the _set_color() and _drop_color() functions
	take a "const PicmanRGB *" parameter.

	* app/by_color_select.c
	* app/channels_dialog.c
	* app/color_area.c
	* app/color_panel.c
	* app/color_picker.c
	* app/color_select.c
	* app/colormap_dialog.c
	* app/disp_callbacks.[ch]
	* app/picmanimage.h
	* app/palette.c: changed accordingly.

	* app/gradient.c
	* app/gradientP.h
	* app/gradient_header.h: use PicmanRGB internally.

2001-01-20  Michael Natterer  <mitch@picman.org>

	* app/picmandrawable.[ch]: made picman_drawable_fill() use PicmanRGB,
	added some "const", delete unused function, reordered some
	functions.

	* app/drawable.c
	* app/qmask.c: follow the change.

2001-01-19  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/appenums.h
	* app/apptypes.h: moved all enums from apptypes.h to the new file
	appenums.h

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/app.pl
	* tools/pdbgen/enums.pl: changed accordingly. Removed some files
	from the list of files to scan for enums.

	* TODO.xml: added two minor UI issues.

2001-01-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gqbist.c: fixed typo, adjusted coding style

2001-01-17  Daniel Egger  <egger@suse.de>

	* PLUGIN_MAINTAINERS: Entered Jens Christian Restemeier as maintainer
	as wished.

	* plug-ins/common/gqbist.c: Applied a patch by Jens Christian 
	Restemeier <jrestemeier@currantbun.com> which fixes a calculus bug, 
	adds antialiasing and beautifies the code quite a bit.

2001-01-17  Sven Neumann  <sven@picman.org>

	* INSTALL: adjusted version numbers, updated, added warning
	
	* configure.in: changed .picman to .picman-1.3

2001-01-17  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.c: factored the color parsing code out to the new
	function parse_color() and made it parse RGB, RGBA, HSV and HSVA
	colors.

	* app/color_notebook.c
	* app/devices.c
	* app/session.c: changed accordingly.

2001-01-16  Sven Neumann  <sven@picman.org>

	* app/color_notebook.c: fixed my last change

	* libpicman/picmancolorarea.c: swapped opaque and transparent areas
	
2001-01-16  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolorspace.c: fixed RGB to HSV routine

	* app/color_notebook.c: tweaked dialog layout a little, disabled
	toggle_buttons if the colorselector does not implement the set_channel
	method.

	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: removed empty set_channel methods

2001-01-16  Sven Neumann  <sven@picman.org>

	* app/devices.c: don't show the alpha value of fore/background colors

2001-01-16  Michael Natterer  <mitch@picman.org>

	* app/color_area.c
	* app/color_notebook.[ch]
	* app/color_panel.c
	* app/picmanrc.c
	* app/session.c: store the color history in sessionrc.

	* app/channels_dialog.c: tweaked the "new channel" and "channel
	atributes" dialogs a bit.

Mon Jan 15 17:22:30 PST 2001 Manish Singh <yosh@picman.org>

	* app/fileops.c: correct spelling of "lose" in revert dialog

2001-01-16  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.c: added a global color history of 16 colors.
	The "Add" button uses neither LRU nor pure right-shift order but
	something in between. The history is scheduled to go to sessionrc.

2001-01-15  Sven Neumann  <sven@picman.org>

	* app/devices.c: use a PicmanColorArea for the foreground color in
	the Device Status dialog and added a background color

2001-01-15  Sven Neumann  <sven@picman.org>

	* app/color_picker.c: enable drags from and disable drops to
	the ColorArea in the color_info dialog. Changed the cursor_update
	function so it only displays the bad cursor when outside the image.

2001-01-15  Michael Natterer  <mitch@picman.org>

	* app/devices.c
	* app/picmanrc.c: save the foreground and background color as array
	of RGBA doubles in "devicerc".

2001-01-15  Sven Neumann  <sven@picman.org>

	* app/color_notebook.c: make use of PicmanColorAreas. Added two
	buttons to set the color to black or white.

2001-01-15  Michael Natterer  <mitch@picman.org>

	* modules/colorsel_water.c: the bottom position of the scale
	represents the minimal pressure now. Also removed the pressure
	value display because it's rather a matter of "more" or "less"
	than of an exact value.

2001-01-15  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.c
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c: tweaked dialog layout a bit.

	* modules/colorsel_water.c: removed all widgets except the color
	selector itself (the history and the "Reset" button will go
	to the ColorNotebook).

2001-01-15  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]
	* app/color_select.c
	* libpicman/picmancolorselector.h
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: use PicmanRGB and PicmanHSV.

	* libpicman/picmancolor.c
	* libpicman/picmancolorspace.[ch]: All rgb_to_hsv functions:

	if r == g == b the difference between the max and min value
	is 0 and we should avoid to divide by it ;-)

2001-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/gdyntext/gdyntext.[ch]
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/gdyntext/gdyntextcompat.[ch]: use PicmanRGB

2001-01-15  Sven Neumann  <sven@picman.org>

	* app/color_panel.c
	* libpicman/picmancolorbutton.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/grid.c
	* plug-ins/common/polar.c
	* plug-ins/common/whirlpinch.c: cleaned up after myself

2001-01-15  Sven Neumann  <sven@picman.org>

	* app/color_panel.[ch]: rewritten as proper widget derived from 
	PicmanColorButton

	* app/channels_dialog.c
	* app/color_picker.c
	* app/qmask.c: use new PicmanColorPanel widget

	* libpicman/picmancolorarea.[ch]
	* libpicman/picmancolorbutton.[ch]: some changes needed to derive from
	PicmanColorButton

	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/grid.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/nova.c
	* plug-ins/common/papertile.c
	* plug-ins/common/sinus.c
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/script-fu/script-fu-scripts.c: follow API changes of
	PicmanColorButton and PicmanColorArea

2001-01-15  Michael Natterer  <mitch@picman.org>

	* app/channel.[ch]
	* app/picmanimage.[ch]
	* app/layer.[ch]: use PicmanRGB for the Channel's, the QuickMask's
	and the LayerMask's color.

	* app/channel_cmds.c
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/qmask.c
	* app/xcf.c
	* tools/pdbgen/pdb/channel.pdb: changed accordingly.

2001-01-15  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]
	* app/color_panel.[ch]
	* app/picmancontext.[ch]
	* app/picmandnd.[ch]: use PicmanRGB instead of a random selection out of
	guchar, gint, guchar[], blah...

	* app/blend.c
	* app/by_color_select.c
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/color_area.c
	* app/color_picker.c
	* app/color_select.c
	* app/colormap_dialog.c
	* app/commands.c
	* app/devices.[ch]
	* app/disp_callbacks.[ch]
	* app/drawable.c
	* app/picmanimage.c
	* app/picmanrc.c
	* app/gradient.c
	* app/paint_core.c
	* app/palette.c
	* app/palette_cmds.c
	* app/qmask.c
	* tools/pdbgen/pdb/palette.pdb: changed accordingly.

2001-01-15  Simon Budig  <simon@picman.org>

	* app/apptypes.h
	I broke the Toolbox. Now it works again. The ToolType-enum *must*
	match the order in the tool_info-Array.

2001-01-15  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolor.[ch]: added function picman_rgb_intensity_uchar()

	* libpicman/picmancolorbutton.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/cubism.c
	* plug-ins/common/gif.c
	* plug-ins/common/grid.c
	* plug-ins/common/mblur.c
	* plug-ins/common/papertile.c
	* plug-ins/common/png.c
	* plug-ins/common/polar.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/warp.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/gap/gap_mov_dialog.c
	* plug-ins/gdyntext/gdyntext.c
	* plug-ins/gfig/gfig.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/maze/handy.c
	* plug-ins/mosaic/mosaic.c
	* plug-ins/pagecurl/pagecurl.c: replaced all occurences of 
	picman_palette_[get|set]_[back|fore]ground() with the respective
	picman_palette_[get|set]_[back|fore]ground_rgb() functions.

2001-01-14  Simon Budig  <simon@picman.org>

	* app/tools.c:
	Reordered some tools. It is IMHO more logical to group the
	"paint-style" and the "blur/smudge"-Tools together.
	The Ordering up to now was a "historical" ordering: Not good...

	I am thinking about grouping the "Non-image modifying"-tools
	(Magnify, Colorpicker, Measure tool) together...
	
2001-01-14  Michael Natterer  <mitch@picman.org>

	* app/channel.[ch]
	* app/drawable.[ch]
	* app/gdisplay.[ch]
	* app/picmandrawable.[ch]
	* app/layer.[ch]:

	- Removed all "typedef drawable_function picman_drawable_function".
	- Renamed all *_get_ID() functions to *_get_by_ID().
	- For symmetry reasons, renamed drawable_ID() to picman_drawable_get_ID().
	- Removed the *_get_ID() functions of PicmanLayer, PicmanLayerMask
	  and PicmanChannel.

	* app/airbrush.c
	* app/bezier_select.c
	* app/blend.c
	* app/brightness_contrast.c
	* app/bucket_fill.c
	* app/by_color_select.c
	* app/clone.c
	* app/color_balance.c
	* app/color_picker.c
	* app/convert.c
	* app/convolve.c
	* app/crop.c
	* app/curves.c
	* app/desaturate.c
	* app/dodgeburn.c
	* app/edit_selection.c
	* app/eraser.c
	* app/fileops.c
	* app/flip_tool.c
	* app/floating_sel.c
	* app/fuzzy_select.c
	* app/gimage.c
	* app/gimage_mask.c
	* app/picmanhistogram.c
	* app/picmanimage.c
	* app/global_edit.c
	* app/histogram_tool.c
	* app/hue_saturation.c
	* app/image_map.c
	* app/ink.c
	* app/invert.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/levels.c
	* app/paint_core.c
	* app/paintbrush.c
	* app/pencil.c
	* app/plug_in.c
	* app/posterize.c
	* app/scan_convert.c
	* app/smudge.c
	* app/text_tool.c
	* app/threshold.c
	* app/transform_core.c
	* app/undo.c
	* app/undo_history.c

	* app/channel_cmds.c
	* app/channel_ops_cmds.c
	* app/color_cmds.c
	* app/display_cmds.c
	* app/drawable_cmds.c
	* app/edit_cmds.c
	* app/floating_sel_cmds.c
	* app/image_cmds.c
	* app/layer_cmds.c
	* app/parasite_cmds.c
	* app/selection_cmds.c
	* app/text_tool_cmds.c
	* app/tools_cmds.c
	* libpicman/picmandrawable_pdb.c
	* tools/pdbgen/pdb.pl
	* tools/pdbgen/pdb/channel_ops.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/tools.pdb: changed accordingly.

2001-01-14  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolor.[ch]: added PicmanHSV type and functions and
	picman_rgb_composite functions

	* libpicman/picmancolorbutton.c: indentation

	* libpicman/picmancolorspace.[ch]: added PicmanRGB <-> PicmanHSV conversion 
	routines

	* libpicman/picmanwidgets.[ch]: removed picman_color_update_uchar function

	* plug-ins/Lighting/lighting_main.[ch]
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/MapObject/mapobject_image.c
	* plug-ins/MapObject/mapobject_main.[ch]
	* plug-ins/MapObject/mapobject_shade.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/nova.c
	* plug-ins/common/papertile.c
	* plug-ins/common/sinus.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/script-fu/script-fu-scripts.c: use PicmanRGB and PicmanHSV 

2001-01-14  Michael Natterer  <mitch@picman.org>

	* app/channel.[ch]
	* app/picmandrawable.[ch]
	* app/layer.[ch]: moved the "removed" signal from PicmanChannel and
	PicmanLayer to PicmanDrawable.

	* app/picmanimage.[ch]: changed accordingly.

2001-01-14  Michael Natterer  <mitch@picman.org>

	* app/docindex.c
	* app/fileops.c
	* app/gdisplay.c
	* app/picmanimage.[ch]:

	Removed the "has_filename" boolean from PicmanImage:

	- to get the filename, ask for PicmanObjects's name.
	- picman_image_filename() returns the *display* filename (and will be
	  renamed to picman_image_display_name() soon), i.e. returns
	  "Unnamed" if object->name == NULL.
	- no need any more to check if the filename is the "" string because
	  PicmanImage overrides PicmanObject's "name_changed" method and
	  sets the name to NULL if it was "".

2001-01-14  Sven Neumann  <sven@picman.org>

	Merged fixes from picman-1-2:

	* app/menus.c
	* app/plug-in.c: added some sanity checks for passed string pointers
	to various public functions in an attempt to fix bug #37622.

	* plug-ins/common/sharpen.c: applied a patch from Jerome Zago 
        <jzago@ifhamy.insa-lyon.fr> that fixes a longstanding bug in the
        sharpen filter which sometimes got the last line wrong. 
	Fixes bug #34155.
	
2001-01-14  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h
	* app/brush_edit.c
	* app/brush_select.c
	* app/brushes_cmds.c
	* app/channel.h
	* app/colormap_dialog.c
	* app/datafiles.[ch]
	* app/devices.c
	* app/docindex.c
	* app/fileops.c
	* app/gdisplay.c
	* app/gimage.c
	* app/picmanbrush.[ch]
	* app/picmanbrushgenerated.[ch]
	* app/picmanbrushlist.[ch]
	* app/picmanbrushpipe.[ch]
	* app/picmancontext.[ch]
	* app/picmancontextpreview.c
	* app/picmandnd.c
	* app/picmandrawable.h
	* app/picmanimage.[ch]
	* app/picmanlist.h
	* app/picmanobject.h
	* app/picmanset.[ch]
	* app/gradient.c
	* app/info_window.c
	* app/layer.[ch]
	* app/module_db.c
	* app/palette.[ch]
	* app/patterns.[ch]
	* app/plug_in.[ch]
	* app/undo_history.c
	* app/xcf.c
	* tools/pdbgen/pdb/brushes.pdb

	- Removed the "name" argument from all objects and use
	  PicmanObject's name.
	- Use the same code in all "uniquefy name" functions (this
	  functionality will be a method of the "PicmanContainer" class).
	- Renamed the parent instances of all objects to "parent instance".
	- Added missing instance and class cast macros.
	- Changed some "gchar *" to "const gchar *" parameters.

2001-01-12  Sven Neumann  <sven@picman.org>

	* TODO.xml: updated status

	* app/picmancontext.c: added temporary functions to make it compile

	* app/pixel_processor.c: include tile.h when ENABLE_MP is defined

	* libpicman/picmancolor.[ch]: added more PicmanRGB functions

	* plug-ins/common/aa.c: merged fix from picman-1-2
	
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/grid.c: use PicmanRGB whereever possible. 
	Still work in progress.

2001-01-11  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolorarea.c: added antialiasing

2001-01-11  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolorbutton.[ch]: allow width/height of the color_area
	to be set to negative values so the PicmanColorButton can be set up
	resizeable.
	
2001-01-11  Sven Neumann  <sven@picman.org>

	* README: changed for picman-1.3

2001-01-11  Valek Filippov  <frob@df.ru>

	* plug-ins/script-fu.c: changed INIT_I18N() to INIT_I18N_UI().

2001-01-10  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolorarea.[ch]: finished new PicmanColorArea widget which
	uses PicmanRGB and handles DND and alpha channel.

	* libpicman/picmancolorbutton.[ch]: use PicmanColorArea. The API of the 
	PicmanColorButton has changed!

	* libpicman/picmanwidgets.[ch]: added temporary function 
	picman_color_update_uchar() to ease migration of plug-ins to PicmanRGB. 
	This function will go away.
	
	* plug-ins/Lighting/lighting_main.h
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_main.h
	* plug-ins/MapObject/mapobject_ui.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/grid.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/nova.c
	* plug-ins/common/papertile.c
	* plug-ins/common/sinus.c
	* plug-ins/gdyntext/gdyntext_ui.c
	* plug-ins/ifscompose/ifscompose.[ch]
	* plug-ins/ifscompose/ifscompose_storage.c
	* plug-ins/ifscompose/ifscompose_utils.c
	* plug-ins/script-fu/script-fu-scripts.c: use new PicmanColorArea and
	PicmanColorButton. Started to introduce PicmanRGB color type. This change
	might have broken some of these plug-ins. This is work in progress.

	* libpicman/Makefile.am: added PicmanColorArea and PicmanColorButton to 
	libpicmani.
	
	* app/picmancontext.[ch]: added picman_palette_get_[fore|back]ground() 
	functions so the app can link against libpicman/picmancolorbutton.o.
	These functions will go away.

	* app/picmandnd.c: use a PicmanColorArea for DND
	
2001-01-10  Michael Natterer  <mitch@picman.org>

	* app/picmandrawable.[ch]: removed the "name" parameter and use
	PicmanObject's name instead.

	* app/channel.c
	* app/channel_ops.c
	* app/channels_dialog.c
	* app/drawable.h
	* app/picmanimage.c
	* app/interface.c
	* app/layer.c
	* app/layer_select.c
	* app/layers_dialog.c
	* app/qmask.c
	* app/undo.c
	* app/xcf.c: changed accordingly, cleanup.

2001-01-10  Michael Natterer  <mitch@picman.org>

	* app/picmanbrushlist.c
	* app/picmandrawable.c: forgot to remove #include "picmansignal.h"

	* app/picmanobject.[ch]: added a "name" argument (not used yet).

2001-01-10  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/picmansignal.[ch]: removed.
	* app/picmanmarshal.[ch]: added.

	* app/channel.[ch]
	* app/picmanbrush.[ch]
	* app/picmanbrushgenerated.c
	* app/picmanbrushlist.[ch]
	* app/picmanbrushpipe.[ch]
	* app/picmancontext.c
	* app/picmandrawable.c
	* app/picmanimage.c
	* app/picmanlist.[ch]
	* app/picmanobject.[ch]
	* app/picmanset.[ch]
	* app/layer.c
	* app/layers_dialog.c
	* app/module_db.c
	* app/parasitelist.[ch]: removed picman_signal_new() and
	PICMAN_TYPE_INIT(). Fixed lots of object related uglyness.

2001-01-09  Sven Neumann  <sven@picman.org>

	Merged fix from picman-1-2:
	
	* app/picmanbrushlist.c
	* app/gradient.c
	* app/palette.c
	* app/patterns.c: check for NULL pointers before doing strcmp on
	default names. The default names for brushes, patterns, ... can 
	be NULL if they were not set in a readable picmanrc file.

	* app/picmanrc.c: warn the user if the systemwide picmanrc couldn't be
	read.

2001-01-09  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.c: Show the "Alpha" scale only when needed.

	* libpicman/picmancolorarea.[ch]: fixed typos.

2001-01-09  Sven Neumann  <sven@picman.org>

	* TODO.xml: add more stuff

2001-01-09  Sven Neumann  <sven@picman.org>

	* app/apptypes.h
	* app/brush_select_cmds.c
	* app/brushes_cmds.c
	* app/layer_cmds.c
	* app/layers_dialog.c
	* app/paint_funcs.c
	* app/tool_options.c
	* app/tools_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/script-fu/script-fu-constants.c
	* tools/pdbgen/enums.pl: applied patch from Oliver Lavery 
	<oliver@zeroknowledge.com> that adds new blending modes 
	(Dodge/Burn/Hardlight). Please play with these new modes 
	and check if they are useful and well-implemented.

2001-01-09  Sven Neumann  <sven@picman.org>

	* HACKING: added notice about autogenerated files.

2001-01-09  Sven Neumann  <sven@picman.org>

	* libpicman/picmancolorarea.[ch]: added a new simple widget which
	provides a color preview area capable of DND. It will be used 
	in the PicmanColorButton and in the color_selectors.

	* libpicman/Makefile.am
	* libpicman/picmanui.h
	* libpicman/picmanuitypes.h: include the new files

	* libpicman/picmancolor.[ch]: use proper names instead of abbreviations

	* app/asupsample.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_shade.c
	* plug-ins/libgck/gck/gckcolor.c: changed accordingly

2001-01-09  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]
	* app/color_select.c: moved the scales and the toggle butttons out
	of the notebook. Added an "Aplha" scale (the opacity is not yet
	shown in the color area). Removed the ColorNotebook structure from
	the header.

	* app/color_area.c: the ColorNotebook struct is no longer public.

	* libpicman/picmancolorselector.h
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: changed the ColorSelector module
	interface again: Pass H, S, V, R, G, B and A in all functions
	and callbacks. Added a "set_channel" method because the channel
	toggles are outside the notebook now. This needs more work...

2001-01-08  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.[ch]
	* app/color_select.c: moved the "old" and "new" color areas from the
	notebook to the action_area.

	* TODO.xml: updated.

	* app/color_area.c
	* app/color_panel.c
	* app/colormap_dialog.c
	* app/palette.c
	* libpicman/picmancolorselector.h
	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: removed the "set_current" parameter all
	over the place because it was always TRUE and not used in the modules
	at all.

2001-01-08  Michael Natterer  <mitch@picman.org>

	* app/color_notebook.c
	* app/color_select.c
	* libpicman/picmancolorselector.h: more cleanup before chopping it up.

2001-01-08  Michael Natterer  <mitch@picman.org>

	Removed GCG:

	* app/colormap_dialog.gc
	* app/colormap_dialog.i.[ch]
	* app/colormap_dialog.p.h
	* app/colormap_dialog.t.h
	* app/picman.gh
	* tools/gcg/*: removed.

	* app/colormap_dialog.[ch]: moved all the colormap_dialog stuff
	here and cleaned up the autogenerated code.

	* autogen.sh
	* configure.in
	* app/Makefile.am
	* app/app_procs.c
	* app/apptypes.h
	* app/color_notebook.h
	* app/commands.c
	* app/picmanset.h
	* app/interface.c
	* po/POTFILES.in
	* tools/Makefile.am: changed accordingly, cleanup.

	* libpicman/picmanunitmenu.c: s/class/klass/

2001-01-07  Michael Natterer  <mitch@picman.org>

	* app/by_color_select.c
	* app/channels_dialog.c
	* app/color_area.c
	* app/color_notebook.[ch]
	* app/color_panel.[ch]
	* app/color_picker.c
	* app/color_select.c
	* app/colormap_dialog.i.c
	* app/devices.c
	* app/disp_callbacks.[ch]
	* app/picmandnd.[ch]
	* app/palette.c
	* app/qmask.c

	* libpicman/picmancolorselector.h

	* modules/colorsel_gtk.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c: made the color_notebook, the color_area
	and DND speak in terms of RGBA instead of RGB. The alpha value is
	not used yet, only the API changed. Everything should work exactly
	as before.

2001-01-07  Michael Natterer  <mitch@picman.org>

	* TODO.xml: add "Cleanup PICMAN's color selectors".

2001-01-07  Michael Natterer  <mitch@picman.org>

	* app/bezier_select.c
	* app/bezier_selectP.h: removed the obscure unused "extend" variable
	from the Bezier Tool structure.

2001-01-07  Michael Natterer  <mitch@picman.org>

	* TODO.xml: added an item to optionally change the image window's
	background.

	* app/preferences_dialog.c: "Disable Tearoff Menus" was not saved
	to disk.

2001-01-04  Asbjorn Pettersen  <asbjornP@dualog.no>

	* modules/picmanmodregister.h: add #include <libpicman/picmantypes.h>
	* plug-ins/common/bz2.c (load_image): fix bug loading bz2 files (OS/2)

2001-01-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/title-header.scm: merged fix from 1.2

2001-01-03  Michael Natterer  <mitch@picman.org>

	* app/levels.c: reverted the behaviour of the "Reset" button back
	to resetting the current channel only. Resetting all channels was
	broken and IMHO cannot work the way it was implemented.

2001-01-03  Michael Natterer  <mitch@picman.org>

	* app/plug_in_cmds.c
	* app/procedural_db_cmds.c
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/app.pl: conditionally include <regex.h> or
	"regexrepl.h", depending on HAVE_GLIBC_REGEX.

2001-01-03  Daniel Egger  <egger@suse.de>

	* app/plug_in_cmds.c:
	* app/procedural_db_cmds.c:
	* plug-ins/script-fu/Makefile.am:
	* plug-ins/script-fu/interp_regex.c:
	* plug-ins/script-fu/regexrepl.c: Conditionally compile
	regex if not available in glibc.
	
	* plug-ins/script-fu/regex.c:
	* plug-ins/script-fu/regex.h: Renamed files to regexrepl.[ch].

2001-01-03  Daniel Egger  <egger@suse.de>

	* configure.in: Extended the glibc regexp check and enabled
	substitution for Makefiles.
	
	* app/Makefile.am: Compile regexp only if not in glibc.
	
	* app/plug_in_cmds.c: 
	* app/procedural_db_cmds.c:
	* app/regexrepl.c: Include the correct local headerfile 
	if no new glibc with regexp is available.
	
	* app/regex.c:
	* app/regex.h: Moved into regexprepl.[ch] to avoid nameclashes. 

2001-01-02  Daniel Egger  <egger@suse.de>

	* acconfig.h:
	* configure.in: Added a check for a glibc compliant
	regex implementation.

2001-01-02  Simon Budig  <simon@picman.org>

	* app/paint_core.c: use floor() before casting to gint when 
	calculating the current brush coordinates. Fixes the jagged brush 
	stroke when stroking a path that leaves the image at the top or left
	edge (bug #6043).
	
2001-01-02  Daniel Egger  <egger@suse.de>

	* app/clone.c:
	* app/picmanimage.c:
	* app/temp_buf.c: Use the new _clear function and more cleanups.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/temp_buf.[ch]: temp_buf_data_clear(): the temp_buf's size is
	(width * height * bytes). Cleanups.

	* app/fileops.c: removed a debugging g_print().

2001-01-02  Daniel Egger  <egger@suse.de>

	* app/temp_buf.c:
	* app/temp_buf.h: Add a new function "temp_buf_data_clear" to
	get a nulled chunk of memory.
	
	* app/iscissors.c: Use it here instead of two expensive for
	loops. Clean up the source a little.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/bezier_select.c
	* app/bezier_selectP.h
	* app/selection_options.h: moved the integer "extend" variable from
	SelectionOptions to the BezierSelect structure because it does not
	have a UI widget. Also initialize it with "0" (was used
	uninitialized before). I have no idea what it does.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/selection_options.h
	* app/tool_options.c: made a correct tool toption out of
	"Interactive" (added a default value and the "Reset" function,
	set unused pointers to NULL).

	* app/iscissors.c: fixed indentation and spacing.

2001-01-02  Daniel Egger  <egger@suse.de>

	* app/iscissors.c:
	* app/selection_options.h:
	* app/tool_options.c: Applied patch by laramieleavitt@onetel.net.uk
	to add an interactive update to the iscissors tool.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/picmanhelp.c (picman_idle_help): s/welcome.html/introduction.html/.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/picmanrc.[ch]
	* app/menus.[ch]
	* app/preferences_dialog.c: added a preferences option to disable
	tearoff menus. Cleanup in preferences.

	* TODO.xml: done.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/commands.c: some nicer prototypes.

	* app/fileops.c: oops, forgot to gtk_widget_show() the open_options.

2001-01-02  Michael Natterer  <mitch@picman.org>

	* app/commands.[ch]
	* app/fileops.[ch]
	* app/gdisplay.c
	* app/menus.c: Implemented "Save a Copy as..." which saves the image
	without changing it's filename.

	* app/layers_dialogP.h: export layers_dialog_layer_merge_query()
	here instead of defining it in commands.c

	* TODO.xml: mark this entry as done :)

2001-01-01  Michael Natterer  <mitch@picman.org>

	* TODO.xml: added a TODO item for "Save a Copy..."

2001-01-01  Michael Natterer  <mitch@picman.org>

	* plug-ins/libgck/gck/gck.h
	* plug-ins/libgck/gck/gckcolor.c: removed the GckRGB color type
	and all it's functions.

	* libpicman/Makefile.am
	* libpicman/picmancolor.[ch]: new files containing the new PicmanRGB color
	type and assorted functions.

	* libpicman/picmancolorspace.[ch]: colorspace conversion routines for
	the new PicmanRGB type. Also taken from LibGCK.

	* libpicman/picman.h
	* libpicman/picmantypes.h: #include "picmancolor.h". It's ugly to include
	it in both files but unavoidable to follow our new "*.c" file include
	policy. This will go away as libpicman will be chopped up into pieces
	anyway.

	* app/apptypes.h
	* app/asupsample.[ch]
	* app/blend.c
	* app/color_transfer.h
	* app/gradient_header.h: removed "color_t" and use PicmanRGB instead.

	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/Lighting/lighting_image.c
	* plug-ins/Lighting/lighting_image.h
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/Lighting/lighting_main.h
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/Lighting/lighting_shade.h
	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/MapObject/mapobject_image.c
	* plug-ins/MapObject/mapobject_image.h
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/MapObject/mapobject_main.h
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_shade.c
	* plug-ins/MapObject/mapobject_shade.h
	* modules/colorsel_triangle.c: s/GckRGB/PicmanRGB/g

	* plug-ins/gdyntext/gdyntextcompat.h: check also for PICMAN's minor
	version when deciding if to add a missing PDB wrapper.
	(All this compat cruft including libpicman/picmancompat.h should go
	away ASAP)

2000-12-31  Michael Natterer  <mitch@picman.org>

	More preparation for LibGCK removal:

	* libpicman/picmancolorspace.[ch]: added a "_int" suffix to all functions
	operating on 3 gint pointers, just like the gdouble functions have
	a "_double" suffix.

	* app/color_balance.c
	* app/hue_saturation.c
	* app/paint_funcs.c
	* modules/colorsel_triangle.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/vinvert.c
	* plug-ins/gflare/gflare.c: changed accordingly.

2000-12-31  Sven Neumann  <sven@picman.org>
            Simon Budig <simon@picman.org>
	
	* app/picmanbrush.c
	* plug-ins/common/gih.c: explicitely cast offset to (off_t) when 
	seeking back. Should fix the problems reading grayscale BrushPipes 
	on IRIX.

2000-12-31  Michael Natterer  <mitch@picman.org>

	* app/apptypes.h: cleaned up a bit.

	* app/asupsample.[ch]
	* app/blend.[ch]
	* app/channel.h
	* app/picmanprogress.[ch]
	* app/layer.h
	* app/perspective_tool.c
	* app/plug_in.h
	* app/rotate_tool.c
	* app/scale_tool.c
	* app/shear_tool.c
	* app/transform_core.[ch]: s/picman_progress/PicmanProgress/g and some
	changes related to the apptypes.h cleanup.

2000-12-31  Michael Natterer  <mitch@picman.org>

	* app/airbrush.[ch]
	* app/bezier_select.c
	* app/bezier_selectP.h
	* app/blend.[ch]
	* app/boundary.h
	* app/brightness_contrast.[ch]
	* app/bucket_fill.c
	* app/by_color_select.c
	* app/clone.[ch]
	* app/color_balance.c
	* app/color_picker.c
	* app/commands.c
	* app/convolve.[ch]
	* app/crop.c
	* app/crop.h
	* app/curves.c
	* app/dodgeburn.[ch]
	* app/edit_selection.[ch]
	* app/ellipse_select.c
	* app/eraser.[ch]
	* app/flip_tool.[ch]
	* app/free_select.[ch]
	* app/fuzzy_select.[ch]
	* app/gdisplay.c
	* app/gimage.c
	* app/histogram_tool.[ch]
	* app/hue_saturation.[ch]
	* app/image_map.[ch]
	* app/ink.[ch]
	* app/iscissors.c
	* app/levels.c
	* app/magnify.[ch]
	* app/move.c
	* app/nav_window.[ch]
	* app/paint_core.[ch]
	* app/paintbrush.[ch]
	* app/path_bezier.[ch]
	* app/path_tool.c
	* app/pencil.[ch]
	* app/perspective_tool.[ch]
	* app/posterize.c
	* app/rect_select.[ch]
	* app/rotate_tool.[ch]
	* app/scale_tool.[ch]
	* app/selection.[ch]
	* app/shear_tool.[ch]
	* app/smudge.[ch]
	* app/text_tool.[ch]
	* app/threshold.c
	* app/tools.[ch]
	* app/transform_core.[ch]: removed the "gdisp_ptr" madness and
	useless casts all over the place. Introduced a "PaintState" enum
	instead of #define's. Various cleanups.

2000-12-30  Michael Natterer  <mitch@picman.org>

	One more 17C3 commit ...

	* plug-ins/libgck/gck/gck.h
	* plug-ins/libgck/gck/gckcolor.c: removed unused stuff.

	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/Lighting/lighting_image.[ch]
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/Lighting/lighting_preview.[ch]
	* plug-ins/Lighting/lighting_shade.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/MapObject/mapobject_image.[ch]
	* plug-ins/MapObject/mapobject_main.c
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_shade.[ch]
	* plug-ins/MapObject/mapobject_ui.c: cleanups in preparation for
	removal of LibGCK.

2000-12-30  Michael Natterer  <mitch@picman.org>

	* app/gimage.[ch]: removed all the
	"typedef gimage_function picman_image_function" stuff so we can clearly
	see what is really a GImage function.
	Removed gimage_get_ID(). Use pdb_id_to_image() instead.

	* app/airbrush.c
	* app/desaturate.c
	* app/disp_callbacks.c
	* app/equalize.c
	* app/fileops.c
	* app/floating_sel.c
	* app/gdisplay_ops.c
	* app/picmandrawable.c
	* app/global_edit.c
	* app/image_map.c
	* app/invert.c
	* app/lc_dialog.c
	* app/paths_dialog.c
	* app/plug_in.c
	* app/xcf.c

	* app/color_cmds.c
	* app/convert_cmds.c
	* app/image_cmds.c
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

2000-12-29  Sven Neumann  <sven@picman.org>

	* TODO.xml: more things to do

2000-12-29  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* app/channel_pvt.h
	* app/drawable_pvt.h
	* app/gdisplayF.h
	* app/picmandrawableP.h
	* app/picmanimageP.h
	* app/layer_pvt.h
	* app/toolsF.h: removed these files.

	* app/apptypes.h
	* tools/pdbgen/enums.pl: added tons of opaque typedefs and enums.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/tools.pdb
	* app/*: chainsaw #include cleanup:

	- Never (never!!) include stuff in header files except where we
	  need access to structures' contents (like derived objects).
	- Added prototypes and proper formating in many files.
	- The #include order in *all* *.c files is as follows:

	#include "config.h"

	#include <system stuff>

	#include <gtk/gtk.h>

	#include "apptypes.h"

	#include "picman stuff"

	#include "libpicman stuff"

	#include "libpicman/picmanintl.h"

	By following this scheme we can easily see a file's dependencies
	from it's #include's and can grep for the inclusion to find out
	where a file is used.

	* tools/pdbgen/app.pl: changed to follow the include scheme above.

	* libpicman/Makefile.am
	* libpicman/picmanuitypes.h: new file, included from libpicman/picmanui.h
	and from app/apptypes.h.

	* libpicman/picmancolorbutton.[ch]
	* libpicman/picmandialog.[ch]
	* libpicman/picmanhelpui.[ch]
	* libpicman/picmanparasite.[ch]
	* libpicman/picmanpatheditor.[ch]
	* libpicman/picmanprotocol.c
	* libpicman/picmanquerybox.[ch]
	* libpicman/picmansizeentry.[ch]
	* libpicman/picmantypes.h
	* libpicman/picmanui.h
	* libpicman/picmanunit.h
	* libpicman/picmanunitmenu.[ch]
	* libpicman/picmanwidgets.[ch]: changed accordingly.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/gdyntext/message_window.c
	* plug-ins/imagemap/imap_default_dialog.c
	* plug-ins/imagemap/imap_file.c: these files used to include
	"libpicman/picmanui.h" without including "libpicman/picman.h". This is
	no longer possible because the libpicmanui headers don't include
	"libpicman/picmanunit.h" any more.

2000-12-29  Asbjorn Pettersen  <asbjornP@dualog.no>

	* app/module_db.c: OS/2 fix. remove picman_color_display_register(),,

2000-12-29  Simon Budig  <simon@picman.org>

	* modules/colorsel_triangle.c   Fixed the same 16->8bit conversion
	bug as in picman-1-2 and removed duplicated code.

2000-12-28  Simon Budig  <simon@picman.org>

	* picman_splash.ppm     A new splash...
	* picman1_2_splash.ppm  A new file for the old splash

	* modules/colorsel_triangle.c   Fixed a warning.
	
2000-12-28  Simon Budig  <simon@picman.org>

	* modules/colorsel_triangle.c
	Cleanup, indentation madness, first steps towards a one-click
	color-selector.
	
2000-12-28  Sven Neumann  <sven@picman.org>

	* app/channel.c
	* app/layer.c: use gtk_object_sink() instead of gtk_object_unref()
	when deleting a layer or channel since only floating objects should
	be destroyed this way. A layer or channel that has been attached
	to an image shall never be deleted.
	
	* app/layer_cmds.c
	* libpicman/picmanlayer_pdb.c
	* tools/pdbgen/pdb/layer.pdb: reenabled the picman_layer_delete() PDB
	function since it might be useful under rare circumstances.
	
2000-12-28  Sven Neumann  <sven@picman.org>

	* app/commands.c
	* app/layer_select.[ch]: small new feature: display a layer preview
	popup when switching the active layer using PageUp/PageDown. Could
	need a little tweaking...
	
2000-12-28  Michael Natterer  <mitch@picman.org>

	* app/channel.[ch]
	* app/drawable.h
	* app/picmandrawable.[ch]
	* app/picmandrawableP.h
	* app/picmanimage.[ch]
	* app/picmanimageP.h
	* app/layer.[ch]
	* app/layer_pvt.h: started a major cleanup of all image/drawable
	files. Added tons of "const PicmanImage *" declarations and properly
	formated the headers.

	* app/bezier_select.c
	* app/channels_dialog.c
	* app/crop.c
	* app/fileops.[ch]
	* app/fuzzy_select.c
	* app/gdisplay.c
	* app/layers_dialog.c
	* app/move.c
	* app/paint_funcs.[ch]
	* app/qmask.c
	* app/undo.c: changed accordingly plus the usual portion of coding
	style paranoia. This is not finished but Sven promised to buy me
	a beer if I commit now ;)

2000-12-28  Sven Neumann  <sven@picman.org>

	* app/boundaryF.h
	* app/gdisplayP.h
	* app/picmanlistP.h
	* app/picmanlutP.h
	* app/picmansetP.h
	* app/parasitelistP.h
	* app/pixel_regionP.h: removed these files

	* app/Makefile.am
	* app/apptypes.h
	* app/boundary.[ch]
	* app/floating_sel.h
	* app/gdisplay.c
	* app/picmanlist.h
	* app/picmanlut.[ch]
	* app/picmanset.[ch]
	* app/parasitelist.[ch]
	* app/pixel_processor.c
	* app/pixel_region.[ch]: moved structure definitions into the
	normal headers, various cleanups

2000-12-28  Sven Neumann  <sven@picman.org>

	* app/channel_cmds.c
	* app/layer_cmds.c
	* libpicman/picmanchannel_pdb.c
	* libpicman/picmanlayer_pdb.c
	* plug-ins/common/warp.c
	* plug-ins/gap/gap_exchange_image.c
	* plug-ins/gap/gap_range_ops.c
	* plug-ins/perl/examples/bricks
	* plug-ins/perl/examples/glowing_steel
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb:

	Two of the picman-perl scripts used to call picman_layer_delete() after
	picman_image_remove_layer(). This will fail since the layer is already 
	scheduled for destruction by removing it from the associated image or
	by deleting that image. It is thus dangerous and superfluous to export
	this feature through the PDB. The picman_layer_delete() is hereby
	obsolete and does nothing any longer. I have removed the code calling
	it from all over the place (it was commented out in almost all places).

	The PDB help for picman_channel_delete() now explicetly tells the user 
	about the proper usage of the procedure.
	
2000-12-28  Michael Natterer  <mitch@picman.org>

	* app/bezier_select.[ch]
	* app/bezier_selectP.h: massive cleanup (prototypes, indentation, ...)

2000-12-28  Michael Natterer  <mitch@picman.org>

	* app/measure.c: cleanup, proper prototypes, ...

2000-12-27  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/csource.c: the size of the string holding the
	image data was one byte too short (we forgot the trailing '\0').
	Reported by <goswin.brederlow@student.uni-tuebingen.de>

2000-12-27  Sven Neumann  <sven@picman.org>

	* TODO.xml
	* docs/make-todo: new files. TODO.xml is a first start on a roadmap
	towards picman-1.4. All new features and major changes need to be 
	defined here to be accepted into the picman-1.3 branch.

2000-12-27  Michael Natterer  <mitch@picman.org>

	* app/picmanimage.c: picman_image_merge_layers(): apply the layer mask
	only if layer->apply_mask is TRUE, cleanup.

2000-12-27  Simon Budig  <simon@picman.org>

	* plug-ins/mosaic/mosaic.c
	* plug-ins/script-fu/scripts/textured-logo.scm
	Implemented a toggle to ask the user, if he wants to allow some
	tiles to be split in two pieces. This enables perfect hexagonal/
	squared/octagonal tiles. Changed the PDB-Interface and changed the
	script using this plug-in.

2000-12-27  Michael Natterer  <mitch@picman.org>

	* app/gimage.h
	* app/picmanimage.[ch]: implemented picman_image_get_layer_by_index(),
	small cleanups.

	* app/commands.c
	* app/layers_dialog.c: use the new function instead of accessing
	the layer list directly.

2000-12-27  Michael Natterer  <mitch@picman.org>

	* app/layers_dialog.c: layers_dialog_scroll_index(): don't fiddle
	around with magic numbers when calculating the layer widget's
	height but simply ask one of them for it's allocation.  Fixes
	positioning when the preview is smaller than the layer widget list
	item.

2000-12-27  Tomas Ogren  <stric@ing.umu.se>

	* plug-ins/ifscompose/ifscompose_storage.c: Remove the last comma in
	  an enum, xlc barfs

Tue Dec 26 11:10:23 PST 2000 Manish Singh <yosh@picman.org>

	* app/patterns.c: fix fd leak on loading

Sun Dec 24 23:18:32 PST 2000 Manish Singh <yosh@picman.org>

	* Made 1.2.0 release
