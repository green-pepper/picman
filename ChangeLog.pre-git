
2009-04-16  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.[ch]: made PicmanCoords* parameter of
	PicmanPaintCore::start() const.

	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmanheal.c
	* app/paint/picmanperspectiveclone.c
	* app/paint/picmansourcecore.c: changed accordingly.

2009-04-13  Tobias Mueller  <tobiasmue@gnome.org>

	Bug 574972 – Grayscale profile should be removed in RGB/Indexed mode

	* app/core/picmanimage-convert.c (picman_image_convert): Remove the ICC 
	profile when image will be converted from/to grayscale mode.
	Patch by Yohinori Yamakawa <yam@yellowmagic.info>

2009-04-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/actions/debug-commands.c: Use the new gegl:introspect
	feature of showing the graph of nodes a given node depends
	on. This gives much better depicted graphs.

2009-04-11  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/*.c: various plug-in parameter cleanups that
	have piled up on my disk: some whitespace fixes and other
	formatting, but mostly changes to make plug-in boolean/enum
	parameter desciptions look more like the ones that are generated
	for core procedures.

2009-04-03  Michael Natterer  <mitch@picman.org>

	Bug 577575 – transform tool fills underlying extracted area wrongly

	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c (picman_*_tool_register): pass
	PICMAN_CONTEXT_BACKGROUND_MASK to the register callback to the tools
	use the global background color.

2009-03-31  Sven Neumann  <sven@picman.org>

	Bug 568479 – add PDB procedures to manipulate size of text box

	* tools/pdbgen/pdb/text_layer.pdb: add picman-text-layer-resize,
	based on a patch from Barak Itkin.

	* app/pdb/internal-procs.c
	* app/pdb/text-layer-cmds.c
	* libpicman/picmantextlayer_pdb.[ch]: regenerated.

2009-03-31  Sven Neumann  <sven@picman.org>

	* plug-ins/file-uri/uri-backend-gvfs.c (copy_uri): simplified the
	code.

2009-03-28  Michael Natterer  <mitch@picman.org>

	Bug 555738 – Image display is wrong after undoing canvas size
	enlargement

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_size_changed_detailed_handler): call
	picman_display_shell_expose_full() because resizing the canvas can
	leave all sorts of display areas unupdated otherwise.

2009-03-28  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_size_changed_detailed_handler): swallow the
	code of picman_display_shell_image_size_starts_to_fit() because it
	didn't make things clearer. Add local variables instead to make
	things more readable.

2009-03-28  Sven Neumann  <sven@picman.org>

	Bug 577024 – help-browser plugin crashes when used with webkit 1.1.3

	* plug-ins/help-browser/help-browser.c (run): call g_thread_init().
	Seems to be needed with newer versions of webkit.

2009-03-28  Michael Natterer  <mitch@picman.org>

	Bug 566575 – Warning when creating sample point and releasing Ctrl
	key too late

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_ruler_button_press): call
	picman_display_shell_update_focus() after changing the tool so the
	new tool has the right state.

2009-03-28  Michael Natterer  <mitch@picman.org>

	Bug 555025 – Action GEGL box widgets weirdness

	Must not set GDK_HINT_MIN_SIZE if we don't actually set a minimum
	size, or the window will be shrinkable to zero and it won't
	expand automatically when its contents' requisition grows.

	* app/widgets/picmandialogfactory.[ch]: add hackish API
	picman_dialog_factory_set,get_has_min_size() because GTK+ itself
	has no API for querying a window's GdkWindowHints.

	(picman_dialog_factory_set_user_pos): set GDK_HINT_MIN_SIZE only if
	the window was being marked as having a minimum size using above
	new API.

	* app/widgets/picmantoolbox.c (picman_toolbox_set_geometry)
	* app/display/picmandisplayshell.c (picman_display_shell_style_set):
	call picman_dialog_factory_set_has_min_size (window, TRUE).

2009-03-27  Sven Neumann  <sven@picman.org>

	Bug 576909 – "_Paste" and "_Paste as" have the same mnemonic

	* app/actions/edit-actions.c: resolved colliding mnemonics.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanscalebutton.c: use GtkScaleButton's accessors.

2009-03-23  Sven Neumann  <sven@picman.org>

	Dropped support for the GnomeVFS file-uri backend. Recent GNOME
	releases use GIO/GVfs and libgnomeui will also go away soon.

	* INSTALL 
	* configure.in: removed checks for libgnomeui and libgnome-keyring.

	* plug-ins/file-uri/Makefile.am
	* plug-ins/file-uri/uri-backend-gnomevfs.c: removed.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.c: use GtkAdjustment's accessors.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_data_drop_handle): use
	GtkSelectionData's accessors.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview-dnd.c: use GtkAdjustment's
	accessors.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c: use GtkAdjustment's accessors.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerbox.c: use accessors instead of
	scrolled_window->vscrollbar.

2009-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancombotagentry.c: use accessors instead of
	widget->window and widget->style.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanzoompreview.c: use GtkAdjustment's accessors.

	* libpicman/picmanprocbrowserdialog.c: use accessors instead of
	dialog->vbox and widget->parent.

2009-03-22  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_run_cmd): added a newline to the output in
	the error case.

	* plug-ins/script-fu/script-fu-eval.c (script_fu_eval_run):
	instead of disabling all output in batch mode, use the usual
	routine for error handling and pass the error string along with
	the return values.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c: use GtkAdjustment's
	accessors.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanscaleentry.c: use GtkAdjustment's accessors.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanquerybox.c (create_query_box): use
	gtk_dialog_get_content_area() instead of dialog->vbox.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantagentry.c: use "list" as variable name for
	iterators to be consistent with the rest of PICMAN; various code
	cleanups.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* modules/color-selector-wheel.c: remove GTK+ version check and
	related evilness because we depend on a proper GTK+ version now.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/gtkscalebutton.[ch]: remove this evil hack.

	* app/widgets/picmanscalebutton.[ch]
	* app/widgets/picmanpropwidgets.c: minor adjustments so the widget
	from GTK+ gets used.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanblobeditor.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmancolorbar.c
	* app/widgets/picmancolordialog.c
	* app/widgets/picmancolorframe.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmancursor.c
	* app/widgets/picmancurveview.c
	* app/widgets/picmandasheditor.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmandockable.c
	* app/widgets/picmanerrordialog.c
	* app/widgets/picmanfgbgeditor.c
	* app/widgets/picmanfgbgview.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanhandlebar.c
	* app/widgets/picmanhistogrambox.c
	* app/widgets/picmanhistogramview.c
	* app/widgets/picmanmessagedialog.c
	* app/widgets/picmannavigationview.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpaletteview.c
	* app/widgets/picmanpatternselect.c
	* app/widgets/picmanprogressbox.c
	* app/widgets/picmanprogressdialog.c
	* app/widgets/picmanscalebutton.c
	* app/widgets/picmanselectiondata.c
	* app/widgets/picmansessioninfo.c
	* app/widgets/picmansettingsbox.c
	* app/widgets/picmanstrokeeditor.c
	* app/widgets/picmantexteditor.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanuimanager.c
	* app/widgets/picmanview-popup.c
	* app/widgets/picmanview.c
	* app/widgets/picmanviewabledialog.c
	* app/widgets/picmanwidgets-utils.c: use accessors for various
	members of GTK+ structures that don't exist any longer when
	GSEAL_ENABLE is defined.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmancanvas.c
	* app/display/picmandisplayshell.c: use accessors for various
	members of GTK+ structures that don't exist any longer when
	GSEAL_ENABLE is defined.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanbrushselectbutton.c
	* libpicman/picmanexport.c
	* libpicman/picmanfontselectbutton.c
	* libpicman/picmangradientselectbutton.c
	* libpicman/picmanimagecombobox.c
	* libpicman/picmanitemcombobox.c
	* libpicman/picmanpaletteselectbutton.c
	* libpicman/picmanpatternselectbutton.c
	* libpicman/picmanprogressbar.c
	* libpicman/picmanui.c
	* libpicman/picmanzoompreview.c
	* tools/test-clipboard.c: use accessors for various members of
	GTK+ structures that don't exist any longer when GSEAL_ENABLE is
	defined.

2009-03-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmancolorscale.c
	* libpicmanwidgets/picmancolorselect.c
	* libpicmanwidgets/picmandialog.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmanmemsizeentry.c
	* libpicmanwidgets/picmanoffsetarea.c
	* libpicmanwidgets/picmanpickbutton.c
	* libpicmanwidgets/picmanpixmap.c
	* libpicmanwidgets/picmanpreview.c
	* libpicmanwidgets/picmanpreviewarea.c
	* libpicmanwidgets/picmanruler.c
	* libpicmanwidgets/picmanscrolledpreview.c
	* libpicmanwidgets/picmanwidgets.c: use accessors for various members
	of GTK+ structures that don't exist any longer when GSEAL_ENABLE
	is defined.

2009-03-19  Sven Neumann  <sven@picman.org>

	* app/actions/context-actions.c (context_actions): 
	* app/paint/picmaninkoptions.c: changed "Aspect" to "Aspect Ratio".

2009-03-19  Sven Neumann  <sven@picman.org>

	Bug 471681 – Keyboard shortcuts for brush size/params need feedback

	* app/core/picmanbrushgenerated.c
	* app/core/picmancontext.c
	* app/paint/picmanpaintoptions.c: applied patch from Stephen G. that
	marks some strings for translation.

2009-03-17  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_save): Drop Windows
	code to remove target file before renaming. g_rename() nowadays
	takes care of allowing replacing existing files on Windows.

2009-03-17  Sven Neumann  <sven@picman.org>

	* configure.in: check for fsync().

	* libpicmanconfig/picmanconfigwriter.c (picman_config_writer_close_file):
	fsync temporary file if destination file exists.

2009-03-17  Tor Lillqvist  <tml@iki.fi>

	* libpicmanconfig/picmanconfigwriter.c
	(picman_config_writer_close_file): Drop Windows code to remove
	target file before renaming. g_rename() nowadays takes care of
	allowing replacing existing files on Windows.

2009-03-16  Sven Neumann  <sven@picman.org>

	* configure.in: bumped GLib version for deprecated symbols.

2009-03-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush-transform.c (picman_brush_real_transform_mask):
	picman_brush_real_transform_pixmap): don't mix variable declarations
	and code. Added missing const qualifiers.

	* plug-ins/common/ripple.c (ripple_horizontal): removed stray
	semicolon.

2009-03-16  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c
	(picman_display_shell_close_dialog): adapt button labels to the
	latest GNOME HIG.

2009-03-16  Tor Lillqvist  <tml@iki.fi>

	* app/version.c (picman_show_library_version): The build-time and
	run-time versions were swapped in the output.

2009-03-14  Sven Neumann  <sven@picman.org>

	Bug 566443 – diagonal method guidelines for crop tool

	* app/tools/tools-enums.[ch]
	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw_guides):
	applied a slightly modified patch from Lukasz Hladowski, based on
	a patch from Tim Jedlicka. This adds diagonal guidelines as
	described by Edwin Westhoff to the rectangle tools.

2009-03-13  Sven Neumann  <sven@picman.org>

	Bug 574427 – Stroke path with paint tool error

	* app/dialogs/stroke-dialog.c: construct the combo-box that
	selects the paint-info object with the PicmanStrokeOptions as
	context. Makes the code much easier and fixes bug #574427.

2009-03-13  Sven Neumann  <sven@picman.org>

	Bug 571117 – lcms plug-in crashes on broken profile

	* plug-ins/common/lcms.c: don't abort on lcms errors.

2009-03-13  Sven Neumann  <sven@picman.org>

	Bug 575006 – Add preferences for snapping

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/display/picmandisplayshell.c: applied part of a patch from
	Akkana Peck. This adds picmanrc properties for the default values
	used for snapping in new image windows. It also changes the
	default value for "Snap to Canvas Edges" to TRUE. Let's test this
	for a while...

2009-03-12  Sven Neumann  <sven@picman.org>

	Bug 573695 – 1-bit white background saved as PBM becomes all black

	* plug-ins/common/file-pnm.c: look at the colormap and test which
	of the two colors is black and which is white.

2009-03-12  Sven Neumann  <sven@picman.org>

	Bug 573070 – crash when working with 1x3200 pixel image

	* app/display/picmandisplayshell.c (picman_display_shell_scale_changed):
	make sure that x_src_dec and y_src_dec never become zero.

2009-03-11  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c (picman_scan_convert_render_full):
	formatting.

2009-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/file-jpeg/jpeg.h (PLUG_IN_BINARY): fixed typo.

2009-03-09  Alexia Death  <alexiadeath@gmail.com>

	* app/paint/picmansmudge.c
	(picman_smudge_class_init): enable scaling for smudge tool
	(picman_smudge_motion): correct comment.

2009-03-08  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_add_channel): corrected
	documentation of the position parameter.

	* app/pdb/image-cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2009-03-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.c
	(picman_container_view_item_selected): formatting.

2009-03-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/stroke-dialog.c (stroke_dialog_response): disconnect
	from the "paint-info" combo-box before destroying the dialog. The
	PicmanContainerView emits "select-item" from its dispose handler.

2009-03-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainercombobox.c
	(picman_container_combo_box_changed): do not attempt to chain up in
	a signal callback.

2009-03-07  Sven Neumann  <sven@picman.org>

	* plug-ins/file-jpeg/jpeg-load.c (load_image)
	* plug-ins/file-jpeg/jpeg-save.c (save_image): need to finish the
	progress update.

2009-03-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanuimanager.c: formatting.

2009-03-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/blinds.c: use enum PicmanOrientationType instead
	of local #defines for HORIZONTAL and VERTICAL with identical
	values. Some indentation and formatting fixups.

2009-03-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererimagefile.c
	(picman_view_renderer_imagefile_get_icon)
	* plug-ins/print/print.c (query): removed GTK+ version checks that
	have become obsolete.

2009-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/file-uri/Makefile.am
	* plug-ins/file-uri/picmanmountoperation.[ch]: removed these files.

	* plug-ins/file-uri/uri-backend-gvfs.c: use GtkMountOperation
	instead of our copy of this widget.

2009-03-05  Sven Neumann  <sven@picman.org>

	* configure.in: depend on GTK+ >= 2.14.4.

	* INSTALL: changed accordingly.

2009-03-05  Sven Neumann  <sven@picman.org>

	Bug 573695 – 1-bit white background saved as PBM becomes all black

	* plug-ins/common/file-pnm.c: need to handle the special case that
	the image colormap has only one entry.

2009-03-04  Sven Neumann  <sven@picman.org>

	Bug 574149 – Can't get name/filename of files loaded from URI

	* tools/pdbgen/pdb/image.pdb: added new procedure picman-image-get-uri.

	* app/pdb/image-cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

	* plug-ins/pypicman/pypicman-image.c: wrap the new procedure into an
	Image attribute.

2009-03-04  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_get_filename): improved docs
	for picman-image-get-filename.

	* app/pdb/image-cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2009-03-04  Sven Neumann  <sven@picman.org>

	Bug 574149 – Can't get name/filename of files loaded from URI

	* tools/pdbgen/pdb/image.pdb (image_get_name_invoker): use
	picman_image_get_display_name().

	* app/pdb/image-cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2009-03-03  Sven Neumann  <sven@picman.org>

	Bug 520078 – Rotate brushes

	* app/core/picmanbrush-transform.c: applied patch from Tal that
	improves bilinear interpolation for the brush transformations and
	fixes a bug in the calculation of the transformation matrix.

2009-03-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanfilteredcontainer.[ch]
	* app/core/picmantag.c
	* app/core/picmantagcache.[ch]: codingstylize. Call iterator GList*
	variables simply "list" just as we call integers simply "i".

2009-03-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantagentry.c (picman_tag_entry_expose): use
	gtk_paint_layout() instead of fiddling with a PangoRenderer
	manually.

2009-03-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantagentry.c (picman_tag_entry_key_press): allow to
	leave the widget with Ctrl+Tab. Handle GDK_KP_Tab and
	GDK_ISO_Left_Tab.
	(picman_tag_entry_expose): 

2009-03-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmantagged.[ch]: add picman_tagged_set_tags() which
	takes a GList of tags.

	* app/widgets/picmantagentry.c (picman_tag_entry_assign_tags): use it.

	(picman_tag_entry_item_set_tags): remove.

2009-03-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancombotagentry.c
	* app/widgets/picmantagentry.c: indentation, spacing, some general
	formatting cleanup.

	(picman_tag_entry_expose): don't leak the PangoAttrList.

2009-03-01  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/ripple.c: use enum PicmanOrientationType instead
	of local #defines for HORIZONTAL and VERTICAL with identical
	values. Some indentation and formatting fixups.

2009-02-28  Sven Neumann  <sven@picman.org>

	* libpicman/picmanregioniterator.c: update the progress less often.

	* plug-ins/common/ripple.c: formatting.

2009-02-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-svg.c: reverted accidental commit.

2009-02-28  Sven Neumann  <sven@picman.org>

	Bug 573488 – Small bug in Filter>Distorts>Ripple

	* plug-ins/common/ripple.c (ripple_vertical): fixed bug spotted in
	SMEAR mode, pointed out by Andreas Groth.

2009-02-28  Sven Neumann  <sven@picman.org>

	Bug 520078 – Rotate brushes

	* app/core/picmanbrush-transform.c: applied patch from Tal that
	implements bilinear interpolation for the brush transformations.

2009-02-28  Martin Nordholts  <martinn@svn.gnome.org>

	* app/actions/debug-commands.c: Properly show name of image graph
	source image

2009-02-26  Sven Neumann  <sven@picman.org>

	* app/gui/gui.c (gui_restore_callback): connect to changes of the
	"user-manual-online" picmanrc property and kill the picman-help
	plug-in as it caches the location of the help pages.

	* app/widgets/picmanhelp.[ch]: added picman_help_user_manual_changed()
	for this purpose.

2009-02-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-pcx.c: sprinkled with const qualifiers.

2009-02-23  Martin Nordholts  <martinn@svn.gnome.org>

	Add a Show Image Graph item to the Debug menu that creates a new image
	showing the GEGL graph for the image. Would benefit from an enhanced
	gegl:introspect op with a clearer graph, but still quite interesting
	in its current shape.

        * app/actions/debug-actions.c
        * app/actions/debug-commands.[ch]
        * menus/image-menu.xml.in

2009-02-23  Martin Nordholts  <martinn@svn.gnome.org>

        * app/gegl/picman-gegl-utils.[ch]: Add a GEGL utility function
	picman_buffer_to_tiles()

2009-02-23  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py (register): warn if a script uses the
	decprecated way of registering its menu location.

2009-02-22  Marco Ciampa  <ciampix@libero.it>

        * app/actions/image-actions.c: fixed duplicated keyboard shortcut

2009-02-21  Martin Nordholts  <martinn@svn.gnome.org>

	Rename gegl-types.h to picman-gegl-types.h as gegl-types.h invades
	on the GEGL namespace

	* app/core/core-types.h
	* app/gegl/Makefile.am
	* app/gegl/picman-gegl-types.h   (renamed from app/gegl/gegl-types.h)
	* app/gegl/picman-gegl-utils.c
	* app/gegl/picman-gegl.c
	* app/gegl/picmanbrightnesscontrastconfig.c
	* app/gegl/picmancolorbalanceconfig.c
	* app/gegl/picmancolorizeconfig.c
	* app/gegl/picmancurvesconfig.c
	* app/gegl/picmandesaturateconfig.c
	* app/gegl/picmanhuesaturationconfig.c
	* app/gegl/picmanlevelsconfig.c
	* app/gegl/picmanoperationcolorbalance.c
	* app/gegl/picmanoperationcolorize.c
	* app/gegl/picmanoperationcurves.c
	* app/gegl/picmanoperationdesaturate.c
	* app/gegl/picmanoperationhuesaturation.c
	* app/gegl/picmanoperationlevels.c
	* app/gegl/picmanoperationpointfilter.c
	* app/gegl/picmanoperationpointlayermode.c
	* app/gegl/picmanoperationposterize.c
	* app/gegl/picmanoperationthreshold.c
	* app/gegl/picmanoperationtilesink.c
	* app/gegl/picmanoperationtilesource.c
	* app/gegl/picmanposterizeconfig.c
	* app/gegl/picmanthresholdconfig.c

2009-02-20  Michael Natterer  <mitch@picman.org>

	Bug 572156 – top left pixel position/coordinate is not 0,0 but 1,1

	* app/display/picmanstatusbar.c
	(picman_statusbar_push_coords)
	(picman_statusbar_update_cursor): fix braino for
	PICMAN_CURSOR_PRECISION_PIXEL_CENTER: going to the pixel's
	center doesn't need any rounding, it simply needs clipping
	the coordinates' fractional parts, gah...

	Review all tools' cursor precision:

	* app/tools/picmanblendtool.c (picman_blend_tool_init): set cursor
	precision to SUBPIXEL.

	* app/tools/picmantexttool.c (picman_text_tool_init)
	* app/tools/picmanmeasuretool.c (picman_measure_tool_init)
	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_init):
	set cursor precision to PIXEL_BORDER.

2009-02-19  Michael Natterer  <mitch@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_save): no need to
	g_strdup_printf() a simple string, use g_strdup() instead.

2009-02-18  Sven Neumann  <sven@picman.org>

	Bug 99457 – Support for dynamics on tilt

	* app/tools/picmanpaintoptions-gui.c
	* app/paint/picmanpaintoptions.[ch]: applied patch from Alexia Death
	that allows to map tilt to the dynamic brush parameters.

2009-02-17  Aurimas Juška  <aurisj@svn.gnome.org>

	* data/tags/picman-tags-default.xml.in: default to empty tag set.
	* data/tags/picman-tags.dtd: changed to allow resources without tags
	assigned.

2009-02-17  Aurimas Juška  <aurisj@svn.gnome.org>

	* po-tags/*: got rid of extra message domain.

	* configure.in:
	* data/tags/Makefile.am: changed accordingly.

2009-02-16  Aurimas Juška  <aurisj@svn.gnome.org>

	* app/core/Makefile.am:
	* app/core/picman-tags.c:
	* app/core/picman-tags.h:
	* app/core/picman-user-install.c (user_install_create_files),
	(user_install_migrate_files):
	* configure.in:
	* data/Makefile.am:
	* data/tags/Makefile.am:
	* data/tags/picman-tags.dtd: added default tag set, support for
	  translating tags into various languages, user installation
	  and migration procedures.

	* data/tags/picman-tags-default.xml.in: initial tag set for testing
	purposes. This has to be replaced with something else before
	translators can start their work.

2009-02-16  Aurimas Juška  <aurisj@svn.gnome.org>

	* app/widgets/picmantagentry.c (picman_tag_entry_set_tag_string):
	fixed popup list (tag cloud) toggling by querying tags immediately
	instead of adding idle handler.

2009-02-16  Aurimas Juška  <aurisj@svn.gnome.org>

	* app/widgets/picmantagentry.c (picman_tag_entry_commit_tags),
	(picman_tag_entry_strip_extra_whitespace): don't cause tag query
	after focus-out. Fixes annoying bug.

2009-02-14  Sven Neumann  <sven@picman.org>

	Bug 99457 – Support for dynamics on tilt

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrush-transform.[ch]
	* app/paint/picmanbrushcore.c
	* app/paint/picmansmudge.c: applied patch from Alexia Death,
	separates brush scaling for x and y.

2009-02-14  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmandrawable.c: Remove
	picman_drawable_update_tile_source_node(), it was not useful.

2009-02-14  Sven Neumann  <sven@picman.org>

	* app/core/picmancoords-interpolate.c
	* app/display/picmandisplayshell-coords.c: applied patch from Alexia
	Death that fixes issues with the new stroke direction code
	(bug #520078).

2009-02-14  Sven Neumann  <sven@picman.org>

	Bug 472644 – Rotate with clipping crops the whole layer

	* app/core/picman-transform-resize.c: applied patch as attached to
	bug #472644. Supposedly fixes the problem of the disappearing
	image.

2009-02-13  Sven Neumann  <sven@picman.org>

	Bug 571628 – Scaling image to 25% turn background from white to grey

	* app/paint-funcs/scale-region.c (pixel_average2): fixed right-shift
	for GRAYA pixels.

2009-02-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_sync_source_node): need
	to rip the floating selection's source node out of its layer's
	graph before using it in the floating selection sub-graph, and
	need to plug it back there when it's not a floating selection any
	longer.

	Unrelated:

	Also introduce a "fs_crop_node" that makes sure the floating
	selection stops at the drawable's boundaries.

	(picman_drawable_visibility_changed): use item->node instead of
	picman_item_get_node() because the latter creates the node on
	demand.

	* app/core/picmandrawable-private.h: add fs_crop_node member.

2009-02-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/file-faxg3/Makefile.am
	* plug-ins/help/Makefile.am
	* plug-ins/metadata/Makefile.am: add $(libpicmanconfig) to LDADD
	where it was missing. Libpicman pulls in libpicmanconfig and these
	plug-ins were linking against the installed libpicmanconfig under
	some #$&%*#%&%$& .la file circumstances.

2009-02-12  Michael Natterer  <mitch@picman.org>

	Bug 567840 – PICMAN's GtkScaleButton conflicts with GTK's

	* app/widgets/gtkscalebutton.c: rename the type to
	"PicmanGtkScaleButton" so we don't crash if the real
	GtkScaleButton type is registered too.

2009-02-11  Sven Neumann  <sven@picman.org>

	* app/core/picmancoords-interpolate.c
	(picman_coords_interpolate_catmull): applied patch from Alexia Death
	that fixes a bug that was introduced by the last commit.

2009-02-10  Sven Neumann  <sven@picman.org>

	* app/core/picmancoords-interpolate.c
	* app/core/picmanbrush-transform.c
	* app/paint/picmanpaintoptions.c
	* app/display/picmandisplayshell-coords.c: applied patch from Alexia
	Death that fixes the direction of brush rotation (bug #520078).

2009-02-10  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-coords.c
	(picman_display_shell_eval_event): applied patch from Alexia Death
	that introduces smoothing for the stroke direction (bug #520078).

2009-02-09  Sven Neumann  <sven@picman.org>

	* app/actions/tools-commands.c (tools_paint_brush_angle_cmd_callback):
	applied patch from Alexia Death that changes the steppings of the
	newly introduced brush rotation actions as suggested in bug #520078.

2009-02-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmangegltool.c (picman_gegl_tool_dialog): seems
	pointless to include the PICMAN-specific GEGL operations as they
	can't be reasonably controlled by the generic GEGL tool user
	interface.

2009-02-09  Michael Natterer  <mitch@picman.org>

	Bug 569470 – pls, introduce an option 'how many latest presets for
	color curves should be saved'

	* app/config/picmanrc-blurbs.h
	* app/config/picmanguiconfig.[ch]: add integer property
	"image-map-tool-max-recent" which defaults to ten. Adding a GUI
	for this IMO needs discussion, the value of ten seems appropriate.

	* app/widgets/picmansettingsbox.[ch]
	(picman_settings_box_add_current): add "gint max_recent" parameter
	and limit the number of recent settings to this number.

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_response):
	pass the new settings property to above function.

2009-02-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c (picman_curves_tool_key_press): if the
	curve view didn't handle the key press, chain up so the normal
	PicmanImageMapTool keys for reset/cancel/ok works.

2009-02-08  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanpaintoptions-gui.c: Fix stack overwrites in
	picman_paint_options_gui()

2009-02-08  Michael Natterer  <mitch@picman.org>

	Bug 520078 – Rotate brushes

	Applied a slightly modified patch from Alexia Death:

	* app/core/core-types.h (struct PicmanCoords): add "direction" member.

	* app/core/picmancoords.c: take direction into account in mix(),
	scalarprod(), length_squared(), manhattan_dist() and equal().

	* app/core/picmancoords-interpolate.c
	(picman_coords_interpolate_catmull): same here.
	* app/display/picmandisplayshell-coords.c

	(picman_display_shell_eval_event): same here.

	* app/paint/picmanpaintoptions.[ch]: add properties for direction
	dynamics and adapt dynamics mixing accordingly.

	* app/paint/picmanbrushcore.c (picman_brush_core_interpolate):
	"interpolate" direction too (in fact, just copy it from
	last_coords since it doesn't change along a straight line).

	* app/paint/picmanpaintcore-stroke.c
	(picman_paint_core_stroke_emulate_dynamics): emulate direction too.

	* app/tools/picmanpaintoptions-gui.c: add GUI for direction dynamics.

2009-02-07  Michael Natterer  <mitch@picman.org>

	Simplify floating selection handling a bit more:

	* app/core/picmandrawable.c
	(picman_drawable_attach_floating_sel)
	(picman_drawable_detach_floating_sel): call
	picman_image_set_floating_selection() from these functions.

	* app/core/picmanfloatingselundo.c (picman_floating_sel_undo_pop)
	* app/core/picmanimage.c (picman_image_add,remove_layer)
	* app/core/picmanlayer-floating-sel.c (floating_sel_to_layer): don't
	call it here because we already call above functions.

2009-02-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c
	(picman_drawable_attach_floating_sel)
	(picman_drawable_detach_floating_sel): call
	picman_drawable_invalidate_boundary(floating_sel). Fixes missing
	selection update after turning a floating selection into a
	layer. It's called redundantly now when adding or deleting a
	floating selection, but that doesn't hurt much.

	* app/core/picmanfloatingselundo.c (picman_floating_sel_undo_pop):
	don't call it here because we already call above functions.

2009-02-07  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimagemap.c: Move undo tiles updating into a helper
	function picman_image_map_update_undo_tiles() so the logic of
	picman_image_map_apply() becomes clearer.

2009-02-07  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimagemap.c: Introduce and use a local helper
	function picman_image_map_kill_any_idle_processors() to get a rid of
	some code duplication.

2009-02-07  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimagemap.c: Introduce and use a local helper
	function picman_image_map_cancel_any_idle_jobs() to get a rid of
	some code duplication.

2009-02-07  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimagemap.c: Fix misindented return statement.

2009-02-06  Sven Neumann  <sven@picman.org>

	* app/actions/tools-commands.c
	(tools_paint_brush_angle_cmd_callback): let the brush angle wrap.

2009-02-06  Sven Neumann  <sven@picman.org>

	* app/actions/tools-commands.c:

2009-02-06  Sven Neumann  <sven@picman.org>

	* app/actions/actions.c (action_select_property): mark strings for
	translation and add translator comments for them.

2009-02-06  Sven Neumann  <sven@picman.org>

	* app/actions/actions.c: prototype action_message() with format
	function attribute and move it to the bottom of the file.

2009-02-06  Sven Neumann  <sven@picman.org>

	* app/actions/tools-commands.c
	(tools_paint_brush_angle_cmd_callback): fixed parameters passed to
	action_select_property().

2009-02-06  Michael Natterer  <mitch@picman.org>

	Bug 471681 – Keyboard shortcuts for brush size/params need
	feedback

	Applied patch from Stephen G. and Sven Neumann which addresses
	above bug:

	* app/actions/actions.[ch]: add new function action_message()
	which pushes a temp message to a display's statusbar.h

	(action_select_property): add PicmanDisplay* parameter and call
	action_message() for int and double property changes.

	* app/actions/tools-commands.c: pass the display to
	action_select_property().

	* app/paint/picmaninkoptions.c: add some blurbs to make it work
	for the ink blob properties.

2009-02-05  Sven Neumann  <sven@picman.org>

	Bug 520078 – Rotate brushes

	Applied patch from Alexia Death:

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrush-transform.[ch]: affine transformations for
	brushes. So far only scaling and rotation is supported. The
	transformation is done using nearest-neighbour. This is a
	regression and we need to add back interpolation before the next
	release.

	* app/paint/picmansmudge.c
	* app/paint/picmanpaintoptions.[ch]
	* app/paint/picmanbrushcore.[ch]: allow to control the brush
	rotation angle.

	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmanbrushtool.c: added UI for controlling the
	brush rotation angle.

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: add actions for controlling the
	brush rotation angle.

2009-02-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.h
	* app/core/picmandrawable-preview.c: move the preview related
	members to the private struct.

	* app/core/picmandrawable.c
	* app/core/picmandrawable-private.h
	* app/core/picmanselection.c: changed accordingly.

2009-02-05  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: sort the types by inheritence again, but
	keep the alphabetic ordering within one level.

2009-02-04  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmandrawable-private.h: new file which contains struct
	PicmanDrawablePrivate. Move some stuff from PicmanDrawable here.

	* app/core/picmandrawable.[ch]
	* app/core/picmandrawable-shadow.c: changed accordingly.

	* app/text/picmantextlayer-xcf.c
	* app/xcf/xcf-load.c: include the private struct for these ugly
	corner cases.

2009-02-02  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-title.c: reverted last change. It's
	not helpful to use different strings for the same information and
	space is not crucial in the window title.

2009-02-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmandisplayshell-title.c: Use the dedicated image
	type strings for the image window title, the enum value strings
	are too verbose.

2009-02-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmandrawable.c: Collect logic to update the
	tile_source_node in a new helper function
	picman_drawable_update_tile_source_node().

2009-02-01  Martin Nordholts  <martinn@svn.gnome.org>

	Applied patch from Alexia Death that prepares brushes for
	arbitrary transforms by renaming stuff with 'scale' to
	'transform'. Takes us one step closer to fixing bug #520078.

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.c
	* app/paint/picmanbrushcore.[ch]
	* app/paint/picmansmudge.c

	* app/core/picmanbrush-transform.[ch]: New names of
	* app/core/picmanbrush-scale.[ch]

	* app/core/Makefile.am: Update.

2009-02-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanlayer.[ch]: Add const qualifier to
	picman_layer_get_floating_sel_drawable().

2009-01-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: removed picman_image_get_type_string()
	again.

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): use the PicmanImageBaseType enum
	instead.

	* app/tools/picmantool.c (picman_tool_oper_update): if the image is
	empty and the tool can't handle that, display a message in the
	statusbar telling the user about this.

2009-01-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel-combine.c (picman_channel_combine_ellipse_rect):
	fixed incorrect optimization that caused glitches in the rounded
	corners on the left side of rectangular selections.

2009-01-28  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanprocedure.c (picman_procedure_execute): don't set an
	error if the procedure was cancelled.

2009-01-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: add new accessor
	picman_layer_get_floating_sel_drawable() which returns the drawable
	the floating layer is attached to.

	* app/core/picmandrawable.c
	* app/core/picmanfloatingselundo.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-quick-mask.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/core/picmanlayer-floating-sel.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/image.pdb: use it instead of accessing
	layer->fs.drawable directly.

	* app/pdb/image-cmds.c: regenerated.

2009-01-26  Michael Natterer  <mitch@picman.org>

	The GEGL projection does floating selections now:

	* app/core/picmandrawable.[ch] (struct PicmanDrawable): add a couple
	of GeglNodes which are used to create a sub-graph for this
	drawable's floating selection.

	(picman_drawable_detach_floating_sel)
	(picman_drawable_attach_floating_sel): new functions to call
	whenever a floating selection gets attached or detached.

	Change the role of the drawable's "source_node": it's no longer a
	direct tile source but an arbitrary graph. Add new internal
	function picman_drawable_sync_source_node() which creates a
	sub-graph for the floating selection within the source node, and
	uses the new "tile_source_node" directly otherwise. Connect to
	"notify" of the floating selection and reconfigure its sub-graph
	when its properties change. This is also one more refactoring in
	the direction of layer trees.

	* app/core/picmanfloatingselundo.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c: call the new attach/detach
	API whenever a floating selection is attached or detached from a
	drawable. This will need more refactoring i guess...

2009-01-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_visibility_changed):
	don't show the floating selection layer in the image graph, it
	will be shown by the drawable it is attached to. This is a temp
	special case hack, but better fits here than into the newly
	created and clean PicmanDrawableStack. The floating selection will
	see the end of its days as layer soon enough anyway.

2009-01-26  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbutton.c (picman_button_clicked): chain up if a
	parent impl exists to be safe against future gtk versions doing
	something in GtkButton::clicked() (as happened in GTK+ trunk).

2009-01-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve-bend.c (p_load_pointfile): check the
	return value of fgets().

2009-01-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanregionselecttool.c
	(picman_region_select_tool_button_release): move variables to local
	scope.

2009-01-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/pdb/picmanprocedure.[ch] (picman_procedure_create_override): New
	helper function that creates a new PicmanProcedure that can be used
	to override an existing procedure.

2009-01-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimage.[ch] (picman_image_get_type_string): New method
	to get a string representation of the image type.

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): Ask the PicmanImage for an image
	type string instead of making assumptions about its
	implementation.

2009-01-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/base/temp-buf.c (temp_buf_copy): Bail out if we fail to
	create a dest buffer.

2009-01-25  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanparamspecs-duplicate.[ch]: new files implementing
	picman_param_spec_duplicate() which is supposed to duplicate any
	picman or gegl GParamSpec (but doesn't do this yet).

	* app/tools/picmangegltool.c: remove the code form here.

2009-01-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmangegltool.c (picman_param_spec_duplicate):
	gegl_color_get_rgba() takes pointers to doubles now, not floats.

2009-01-24  Michael Natterer  <mitch@picman.org>

	Bug 568890 – don't rely on GtkAction implementation details

	* app/widgets/picmanuimanager.c (picman_ui_manager_menu_item_select):
	use gtk_widget_get_action() instead of g_object_get_data(),
	which relies on the name of the data key.

2009-01-23  Kevin Cozens  <kcozens@cvs.gnome.org>

	* libpicmancolor/picmanrgb-parse.c: Applied patch from Andreas Turtschan
	to fix more RGB colour values. Fixes bug #568909.

2009-01-23  Kevin Cozens  <kcozens@cvs.gnome.org>

	* libpicmancolor/picmanrgb-parse.c: Applied patch from Andreas Turtschan
	to fix colour values for slategray and slategrey. Fixes bug #568839.

2009-01-22  Tor Lillqvist  <tml@iki.fi>

	Bug 559408 - Brushes dragged to the image window look strange

	* app/widgets/picmanpixbuf.c (picman_pixbuf_format_compare): Drop
	Windows-specific code to prefer BMP. The BMP format written by
	gdk-pixbuf doesn't support alpha. PNG is better. Note that the
	same bug report also takes up a different problem.

2009-01-21  Sven Neumann  <sven@picman.org>

	Bug 568617 – "Plase" misspelled

	* app/widgets/picmanuimanager.c: fixed typo.

2009-01-20  Martin Nordholts  <martinn@svn.gnome.org>

	Adjust to babl API adjustment by doing
	s/babl_format_from_name/babl_format/

	* app/gegl/picman-gegl-utils.c
	* app/gegl/picmanoperationpointlayermode.c
	* app/gegl/picmanoperationtilesource.c

2009-01-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/*.c
	* plug-ins/color-rotate/color-rotate.c
	* plug-ins/file-bmp/bmp.c
	* plug-ins/file-faxg3/faxg3.c
	* plug-ins/file-fits/fits.c
	* plug-ins/file-fli/fli-picman.c
	* plug-ins/file-ico/ico.c
	* plug-ins/file-jpeg/jpeg.c
	* plug-ins/file-psd/psd-save.c
	* plug-ins/file-psd/psd.c
	* plug-ins/file-sgi/sgi.c
	* plug-ins/file-uri/uri.c
	* plug-ins/file-xjt/xjt.c
	* plug-ins/flame/flame.c
	* plug-ins/fractal-explorer/fractal-explorer.c
	* plug-ins/gfig/gfig.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/gradient-flare/gradient-flare.c
	* plug-ins/help-browser/help-browser.c
	* plug-ins/ifs-compose/ifs-compose.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/lighting/lighting-main.c
	* plug-ins/map-object/map-object-main.c
	* plug-ins/maze/maze.c
	* plug-ins/metadata/metadata.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/print/print.c
	* plug-ins/pypicman/picmanfu.py
	* plug-ins/script-fu/script-fu-script.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/selection-to-path/selection-to-path.c
	* plug-ins/twain/twain.c
	* plug-ins/win-snap/winsnap.c: document the "run-mode" parameter
	as we document enums for core procedures.

2009-01-18  Sven Neumann  <sven@picman.org>

	Bug 568095 – Patch to improve unsharp mask performance

	* plug-ins/common/unsharp-mask.c (box_blur_line): applied another
	patch from Winston Chang with further performance improvements.

2009-01-18  Sven Neumann  <sven@picman.org>

	* configure.in: depend on babl >= 0.0.23 and GEGL >= 0.0.22.

2009-01-18  Sven Neumann  <sven@picman.org>

	* configure.in (CPPFLAGS): added -DBABL_DISABLE_DEPRECATED.

	* plug-ins/common/unsharp-mask.c: formatting.

2009-01-18  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 563337 – Rectangle Select Tool does not allow 1:1 fixed ratio

	* libpicmanwidgets/picmannumberpairentry.c: When testing if the value
	changed on focus-out we shall test against the current values, not
	the default values.

2009-01-17  Michael Natterer  <mitch@picman.org>

	* all files with a GPL header and all COPYING files:

	Change licence to GPLv3 (and to LGPLv3 for libpicman).

	Cleaned up some copyright headers and regenerated the parsers in
	the ImageMap plugin.

2009-01-17  Sven Neumann  <sven@picman.org>

	Bug 568095 – Patch to improve unsharp mask performance

	* plug-ins/common/unsharp-mask.c (unsharp_region): applied patch
	from Winston Chang that improves performance for larger radii by
	approximating the gaussian blur with a three-pass box blur.

2009-01-17  Martin Nordholts  <martinn@svn.gnome.org>

	Adapt to new babl API, s/babl_format/babl_format_from_name/

	* app/gegl/picman-gegl-utils.c
	* app/gegl/picmanoperationpointlayermode.c
	* app/gegl/picmanoperationtilesource.c

2009-01-17  Sven Neumann  <sven@picman.org>

	Bug 568021 – Unused code in unsharp-mask.c

	* plug-ins/common/unsharp-mask.c: applied patch from Winston Chang
	that removes unused code.

2009-01-17  Sven Neumann  <sven@picman.org>

	Bug 568016 – Black pullout parameter of plug-in-newsprint has
	no effect

	* plug-ins/common/newsprint.c: fixed the documentation of the
	colorspace parameter.

2009-01-13  Sven Neumann  <sven@picman.org>

	* INSTALL
	* autogen.sh
	* configure.in: require intltool >= 0.40.1. Looks like that was
	the first version with support for the NC_ keyword.

2009-01-13  Kevin Cozens  <kcozens@cvs.gnome.org>

	* app/tools/picmanforegroundselecttool.c: Corrected spelling error
	spotted by David Gowers.

2009-01-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/config/picmandisplayconfig.c: Allow marching ant speeds as
	slow as one step per 10 seconds since for some remote sessions the
	minimum of 1 step per second is too fast.

2009-01-10  Sven Neumann  <sven@picman.org>

	Bug 471344 – Circular brush strokes are not smooth and have corners

	Bug 127785 – stroking with size linked to pressure sensitivity
	should scale the spacing

	* app/core/picmancoords-interpolate.[ch]
	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-callbacks.[ch]
	* app/display/picmandisplayshell-coords.[ch]: applied patch from
	Alexia Death that introduces a Catmul-Rom splines based event
	interpolation and also adapts the brush spacing to brush size.

2009-01-06  Sven Neumann  <sven@picman.org>

	Bug 565046 – Point snapping to guides does not work outside the
	canvas

	* app/core/picmanimage-snap.c: applied patch from Daniel Hornung
	that introduces the utility function picman_image_snap_grid() to
	clean up and fix guide snapping.

2009-01-06  Sven Neumann  <sven@picman.org>

	Bug 566498 – Noise distribution error in RGB Noise and HSV Noise

	* plug-ins/common/noise-hsv.c
	* plug-ins/common/noise-rgb.c: applied patch from Marco Rossini.

2009-01-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancombotagentry.c
	(picman_combo_tag_entry_constructor): connect to entry->container's
	signals with g_signal_connect_object() so the entry can be
	destroyed without warning/crashing.

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 562818 – First image opened in PICMAN offset

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	Only rely on disp_width/height for border calculation if they are
	larger than 1. If not, special-case the calculation so we don't
	get a severly mispositioned image.

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	Rename border_x to border_width and border_y to border_height.

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 562213 – Align Tool doesn't work properly if it is the active
	tool at startup

	* app/tools/picmanaligntool.c: Perform NULL-pointer dodging to avoid
	crashing.

2009-01-04  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmandock.[ch]: Make instance members private.

	(picman_dock_get_context)
	(picman_dock_get_dialog_factory)
	(picman_dock_get_dockbooks)
	(picman_dock_get_main_vbox)
	(picman_dock_get_vbox)
	(picman_dock_get_id): New getters.

	* app/actions/actions.c
	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.c
	* app/actions/windows-actions.c
	* app/menus/windows-menu.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandock.c
	* app/widgets/picmandock.h
	* app/widgets/picmandockable.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandockseparator.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmansessioninfo-book.c
	* app/widgets/picmansessioninfo-dock.c
	* app/widgets/picmansessioninfo-dockable.c
	* app/widgets/picmantoolbox-color-area.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmantoolbox-image-area.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantoolbox.c: Use new getters.

2009-01-03  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.c: Format static function
	prototypes.

2009-01-01  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: removed unused include.

2009-01-01  Sven Neumann  <sven@picman.org>

	Bug 565112 – code duplication in app/core/picmanimage-snap.c

	* app/core/picmanimage-snap.c: based on a patch from Daniel Hornung,
	add the utility function picman_image_snap_distance().

2009-01-01  Sven Neumann  <sven@picman.org>

	* app/about.h (PICMAN_COPYRIGHT): Happy New Year!

2009-01-01  Sven Neumann  <sven@picman.org>

	Bug 565223 – Perspective transformation jagged edges / comb effect

	* app/core/picman-transform-region.c: reverted the code change, but
	not the cleanups, from commit r26786.

2008-12-31  Sven Neumann  <sven@picman.org>

	* app/widgets/widgets-enums.[ch]: added PicmanTagEntryMode.

	* app/widgets/picmantagentry.[ch]: removed it here. Also did some
	code cleanup, mostly formatting.

	* app/widgets/picmancombotagentry.[ch]
	* app/widgets/picmantagpopup.[ch]: some code cleanup, mostly
	formatting.

2008-12-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemtreeview.h: deleted trailing whitespace.

2008-12-30  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-draw-page.c
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c: optionally draw crop-marks.

2008-12-30  Marco Ciampa  <ciampix@libero.it>

	* app/actions/error-console-actions.c: small typo fix.

2008-12-28  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanitem.c
	(picman_item_get_offset_x)
	(picman_item_get_offset_y): New offset getters for inline use.

	* app/core/picmanchannel.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-resize.c
	* app/tools/picmantexttool.c: Don't access PicmanItem offset members
	directly, use picman_item_set_offset() and
	picman_item_get_offset_[xy]() instead.

2008-12-28  Sven Neumann  <sven@picman.org>

	Bug 563985 – jpg save dialog: "cancel" is treated like "commit"
	for settings

	* plug-ins/file-jpeg/jpeg.c (run): only attach the comment and
	settings to the image if the save was successful.

2008-12-28  Sven Neumann  <sven@picman.org>

	Bug 565362 – the previously opened file is not suggested if picman
	was started from command line

	* app/file/file-open.c (file_open_from_command_line): remember the
	opened image just as if it was opened using the file-open dialog.

2008-12-28  Martin Nordholts  <martinn@svn.gnome.org>

	Use picman_item_set/get_image() instead of accessing the instance
	member directly.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-brightness-contrast.c
	* app/core/picmandrawable-color-balance.c
	* app/core/picmandrawable-colorize.c
	* app/core/picmandrawable-curves.c
	* app/core/picmandrawable-desaturate.c
	* app/core/picmandrawable-hue-saturation.c
	* app/core/picmandrawable-invert.c
	* app/core/picmandrawable-levels.c
	* app/core/picmandrawable-posterize.c
	* app/core/picmandrawable-threshold.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanselection.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/text/picmantextlayer-xcf.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c
	* app/vectors/picmanvectors-preview.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/layer.pdb

	* app/pdb/layer-cmds.c: Regenerated.

2008-12-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.c (picman_int_combo_box_init): use
	the canonical spelling for the 'stock-id' property.

2008-12-27  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.c
	(picman_paint_core_validate_saved_proj_tiles): copy-on-write from
	the projection is not any longer broken, so use it here.

2008-12-27  Sven Neumann  <sven@picman.org>

	Bug 564087 – Using clone tool on a layer with a part out of canvas
	causes crashes

	* app/paint/picmanpaintcore.c (picman_paint_core_paste): intersect the
	rectangle with the extents of the saved projection.

2008-12-27  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c (struct _PixelSurround): formatting.

2008-12-27  Sven Neumann  <sven@picman.org>

	Bug 564593 – crash when the drawable is changed while a color
	tools is active

	* app/core/picmandrawable-shadow.c (picman_drawable_merge_shadow_tiles):
	keep a reference to the shadow tiles because it might otherwise be
	free'd under our feet.

2008-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-gbr.c: let the save procedure accept a
	grayscale layer with alpha channel, as we do in the GIH save
	procedure.

	* plug-ins/common/file-gih.c: when loading a brush mask pipe,
	create grayscale layers without an alpha channel. Changed the save
	procedure to also accept layers without alpha channel.

2008-12-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanlayertreeview.[ch]: Make instance members
	private (they were not accessed from the outside).

2008-12-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanchanneltreeview.[ch]: Make instance members
	private (they were not accessed from the outside).

2008-12-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanitemtreeview.[ch]: Make instance members private
	and add getters that didn't already exist.

	(picman_item_tree_view_get_new_button)
	(picman_item_tree_view_get_edit_button): New getters.

	* app/actions/actions.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanchanneltreeview.c: Use new getters.

2008-12-23  Sven Neumann  <sven@picman.org>

	* configure.in: if supported, add -Wformat-security and
	-Wformat-non-literal to the compiler flags.

2008-12-23  Sven Neumann  <sven@picman.org>

	* app/batch.c
	* tools/picmantool.c: declared functions calling exit() as
	G_GNUC_NORETURN.

2008-12-21  Aurimas Juška  <aurisj@svn.gnome.org>

	* app/widgets/picmantagentry.c: fixed handling of tags which contain
	non-ASCII characters.

2008-12-21  Sven Neumann  <sven@picman.org>

	Bug 564869 – PICMAN crashes on selecting Tools->GEGL operation

	* app/tools/picmantool.c (picman_tool_initialize): check if the tool
	has set an error.

2008-12-21  Sven Neumann  <sven@picman.org>

	Bug 565138 – python-fu-foggify does not check if image is in rgb mode

	* plug-ins/pypicman/plug-ins/foggify.py (foggify): fixed handling of
	grayscale images.

2008-12-20  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Merge the rest of the tagging code developed on the tagging branch
	by Aurimas Juška. Development will now continue in trunk.

	* app/core/picmantag.[ch]: New files (not strictly true but almost)
	implementing the represention of a tag.

	* app/core/picmantagcache.[ch]: New files implementing functionality
	for loading and saving tags to tags.xml, and assigning loaded tags
	to tagged objects.

	* app/core/picmanfilteredcontainer.[ch]: New files implementing a
	tag filtered PicmanContainer.

	* app/widgets/picmantagentry.[ch]: New files implementing a
	GtkEntry-like widget for entering tags.

	* app/widgets/picmancombotagentry.[ch]: New files implementing a
	combobox-like widget for selecting tags.

	* app/widgets/picmantagpopup.[ch]: New files implementing a popup of
	all available tags that can be selected and combined in a
	checkbox-like way.

	* app/core/picman.[ch]: Add a PicmanTagCache member and manage tag
	assignment and saving and loading to/from tags.xml.

	* app/widgets/picmandatafactoryview.c: Add the tag query and tag
	assignment widgets to the UI and show the tag filtered items
	instead of all items.

	* app/core/core-types.h
	* app/widgets/widgets-types.h: Add new types.

	* app/core/Makefile.am
	* app/widgets/Makefile.am: Add new files.

2008-12-20  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Partial merge of code from Aurimas Juška.

	* app/widgets/picmanbrushfactoryview.c: Use the same method for
	getting the PicmanContainer both when adding and when removing the
	spacing-changed handler. It was just a coincidence that the
	previously different methods retured the same PicmanContainer.

2008-12-20  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmandatafactoryview.[ch]
	(picman_data_factory_view_have)
	(picman_data_factory_view_get_children_type)
	(picman_data_factory_view_has_data_new_func): New helper functions
	to lessen level of indirection in client code.

	* app/actions/data-commands.c: Use them.

2008-12-20  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmandatafactoryview.[ch]: Make instance members
	private and add getters for accessed members.

	(picman_data_factory_view_get_edit_button)
	(picman_data_factory_view_get_duplicate_button)
	(picman_data_factory_view_get_data_factory): New getters.

	* app/actions/data-commands.c
	* app/widgets/picmanpatternfactoryview.c: Use new getters.

2008-12-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmandatafactory.[ch]: Make instance members private and
	add getters for required members.

	(picman_data_factory_get_container)
	(picman_data_factory_get_picman)
	(picman_data_factory_has_data_new_func): The new getters.

	* app/actions/context-commands.c
	* app/actions/data-commands.c
	* app/core/picman-gradients.c
	* app/core/picman.c
	* app/core/picmancontext.c
	* app/core/picmandatafactory.c
	* app/core/picmandatafactory.h
	* app/dialogs/convert-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/pdb/picmanpdb-utils.c
	* app/widgets/picmanbrushfactoryview.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanselectiondata.c
	* app/widgets/picmanviewablebox.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb: Use the getters.


	* app/pdb/brush-select-cmds.c
	* app/pdb/brushes-cmds.c
	* app/pdb/gradient-select-cmds.c
	* app/pdb/gradients-cmds.c
	* app/pdb/palette-select-cmds.c
	* app/pdb/palettes-cmds.c
	* app/pdb/pattern-select-cmds.c
	* app/pdb/patterns-cmds.c: Regenerated.

2008-12-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-png.c: reverted last change, it was bogus.

2008-12-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-png.c (load_image) (save_image): use a tile
	cache to optimize pixel access.

2008-12-16  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb: improved docs for
	picman-plugin-help-register.

	* app/pdb/plug-in-cmds.c
	* libpicman/picmanplugin_pdb.c: regenerated.

2008-12-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmangegltool.c (picman_gegl_tool_operation_blacklisted):
	removed 'gegl:stress' from the blacklist. It was put here on wrong
	assumptions.

2008-12-15  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/pattern.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/patterns.pdb: need to do the change to
	temp_buf_get_data() here for the generated PDB code.

2008-12-14  Sven Neumann  <sven@picman.org>

	* app/core/picman.c: reverted last change as it is totally bogus and
	the old code was correct.

2008-12-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picman.c: We shall unref in dispose() and free in
	finalize(), not vice versa.

2008-12-13  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Partial merge of code from Aurimas Juška.

	* app/core/picmandata.c: Implement PicmanTagged::get_identifier() and
	PicmanTagged::get_checksum().

	* app/core/picmanbrush.c:
	* app/core/picmangradient.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: Implement PicmanTagged::get_checksum().
	They all use the PicmanData implementation of
	PicmanTagged::get_identifier().

2008-12-13  Martin Nordholts  <martinn@svn.gnome.org>

	Introduce temp_buf_get_data_size() and use it.

	* app/base/temp-buf.[ch]
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanpatternselect.c

2008-12-13  Martin Nordholts  <martinn@svn.gnome.org>

	s/temp_buf_data/temp_buf_get_data/

	* app/base/pixel-region.c
	* app/base/temp-buf.c
	* app/base/temp-buf.h
	* app/core/picmanbrush-load.c
	* app/core/picmanbrush-scale.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmangradient.c
	* app/core/picmanimage.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern-load.c
	* app/core/picmanpattern.c
	* app/core/picmanpreviewcache.c
	* app/core/picmanviewable.c
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmaneraser.c
	* app/paint/picmanheal.c
	* app/paint/picmanink.c
	* app/paint/picmanpaintbrush.c
	* app/pdb/brush-cmds.c
	* app/pdb/brushes-cmds.c
	* app/pdb/drawable-cmds.c
	* app/pdb/image-cmds.c
	* app/pdb/pattern-cmds.c
	* app/pdb/patterns-cmds.c
	* app/text/picmanfont.c
	* app/tools/picmaniscissorstool.c
	* app/vectors/picmanvectors-preview.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanpatternselect.c
	* app/widgets/picmanviewrenderer.c

2008-12-12  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Partial merge of code from Aurimas Juška.

	* app/core/picmandata.[ch] (picman_data_make_internal): Add an
	'identifier' parameter/instance struct member that can be used to
	identify the internal PicmanData object across sessions. It is the
	internal-object counterpart to a file path.

	* app/core/picman.c
	* app/core/picmancurve.c
	* app/core/picmanbrush.c
	* app/core/picmanpattern.c
	* app/core/picmanpalette.c
	* app/core/picmangradient.c
	* app/core/picman-gradients.c: Assign an identifier to the the
	internal PicmanData objects.

2008-12-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmantagged.c (picman_tagged_get_identifier): Clarify
	documentation.

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Partial merge of code from Aurimas Juška.

	* app/core/picmantag.c: A new minimal PicmanTag type with only a
	picman_tag_equals() class function so that we can

	* app/core/picmantagged.c
	* app/core/picmandata.c (picman_data_add_tag, picman_data_remove_tag):
	Adapt these to PicmanTag being an object instead of a GQuark.

	* app/core/core-types.h: Update PicmanTag typedef.

	* app/core/Makefile.am: Add picmantag.[ch].

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/core-types.h: Sort typedefs.

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/core-types.h: Remove references to typedefs in
	config-types.h that are more annoying than helpful.

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmantagged.c (picman_tagged_add_tag): Remove weird const
	qualifier.

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555954 – Merge Tagging of Picman Resources GSoC Project

	Partial merge of code from Aurimas Juška.

	* app/core/picmantagged.[ch]: Added PicmanTagged::get_identifier() and
	PicmanTagged::get_checksum().

2008-12-11  Martin Nordholts  <martinn@svn.gnome.org>

	s/picman_tagged_get_get_tags/picman_tagged_get_tags/

	* app/core/picmantagged.[ch]

2008-12-10  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb-parse.c: updated link to the color keywords
	in the SVG spec.

2008-12-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel.c
	* app/core/picmandrawable-operation.c
	* app/core/picmandrawablestack.c
	* app/core/picmanimage.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer.c
	* app/core/picmanprojection.c: gegl_node_add_child() and
	gegl_node_remove_child() are public API in GEGL now.

2008-12-04  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picman.c
	* app/widgets/picmandatafactoryview.c: Sort #includes.

2008-12-04  Sven Neumann  <sven@picman.org>

	Bug 563130 – Hue selection mode does not cross the 0-360 degrees line

	* app/core/picmanimage-contiguous-region.c (pixel_difference):
	applied patch from Daniel Hornung.

2008-12-04  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 563179 – Scrollbars not resized when we extend the canvas size

	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_size_changed_detailed_handler): Add explicit
	call to picman_display_shell_scroll_clamp_and_update() at the end to
	make sure it is called.

2008-12-04  Martin Nordholts  <martinn@svn.gnome.org>

	* app/actions/images-actions.c (images_actions_setup): Pass
	arguments to picman_action_group_add_actions() in the right order.

2008-12-04  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/convert.pdb: fixed an error in the documentation
	of the picman-image-convert-rgb procedure.

	* app/pdb/convert-cmds.c
	* libpicman/picmanconvert_pdb.c: regenerated.

2008-12-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.[ch]: also use the translation
	context for the tooltips.

	* app/actions/*.c: added translation context to all tooltips. Also
	improved some tooltips while I was on it.

2008-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-tiff-save.c (save_image)
	(image_is_monochrome): allow to save images that are plain white or
	plain black using the CCITT Fax compression methods.

2008-12-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-ps.c: minor cleanup.

2008-12-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.[ch]: added an extra parameter for
	the translation context to all picman_action_group_add methods.

	* app/actions/*.c: added a translation context to all action
	labels. Also unified and improved the labels and tooltips in a few
	places.

2008-12-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.c: check that the action name is
	unique before adding it to a PicmanActionGroup.

2008-12-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanitem.c (picman_item_get_offset_node): use
	"gegl:translate" instead of "gegl:shift".

2008-12-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c: renamed GeglNode shift to translate.
	Use "gegl:translate" instead of "gegl:shift".

2008-12-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-desktop-link.c: use the G_KEY_FILE_DESKTOP
	defines from GLib.

2008-12-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def: added picman_widgets_error_quark.

2008-12-01  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmanwidgets-error.h: Added 'Since: PICMAN 2.8' to
	PICMAN_WIDGETS_ERROR.

	* libpicmanwidgets/picmanwidgets.h: Added picmanwidgets-error.h.

2008-11-30  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmanwidgets-error.[ch]: New files defining
	PICMAN_WIDGETS_ERROR domain with currently only a
	PICMAN_WIDGETS_PARSE_ERROR error code.

	* libpicmanwidgets/Makefile.am: Add the new files here.

2008-11-27  Sven Neumann  <sven@picman.org>

	Bug 562459 – PF_PALETTE: 'TypeError' when used in a plugin that is
	registered in <Image>

	* plug-ins/pypicman/picmanui.defs (picman_palette_select_button_new):
	the 'title' parameter is optional.

2008-11-27  Michael Natterer  <mitch@picman.org>

	Bug 562427 – Compilation with --as-needed

	* app/Makefile.am (picman_console_2_7_LDADD): add $(GLIB_LIBS) so
	libgthread gets pulled in explicitely.

2008-11-27  Sven Neumann  <sven@picman.org>

	Bug 562386 – PF_SLIDER and PF_SPINNER 'Step' values do not change
	consistently...

	* plug-ins/pypicman/picmanfu.py (SliderEntry): set the precision on
	the slider just as we do it for the spin-button.

2008-11-27  Sven Neumann  <sven@picman.org>

	Bug 562386 – PF_SLIDER and PF_SPINNER 'Step' values do not change
	consistently...

	* plug-ins/pypicman/picmanfu.py (SpinnerEntry): initialize the
	spin-button the way that gtk_spin_button_new_with_range() is
	implemented.

2008-11-26  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 562366 – Default image dimensions are not correctly
	transferred in the file/new dialog box

	* app/dialogs/preferences-dialog.c
	(prefs_template_select_callback): We need to copy the template in
	the same way as in the New Image dialog.

	* app/dialogs/image-new-dialog.c (image_new_dialog_set): ... and
	when we copy the template to the New Image dialog.

2008-11-26  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-duplicate.c: split spaghetti code into lots
	of helper functions.

2008-11-25  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprocbrowserdialog.c (browser_search): show the
	"invalid search term" message in the label below the list instead
	of in the pane on the right side.

2008-11-25  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c: minor code cleanup.

2008-11-24  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/Makefile.am: Sort entries.

2008-11-22  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c: removed reference to picman-remote
	manual page in the generated picmanrc manual page.

2008-11-22  Michael Natterer  <mitch@picman.org>

	* app/core/picmanselection.[ch]: make the entire selection
	API take PicmanSelection arguments, not PicmanChannel.
	Clean up picman_selection_load() a bit.

	* app/actions/select-commands.c
	* app/core/picman-edit.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-quick-mask.c
	* app/tools/picmaneditselectiontool.c
	* tools/pdbgen/pdb/selection.pdb: add the needed casts.

	* app/pdb/selection-cmds.c: regenerated.

2008-11-22  Sven Neumann  <sven@picman.org>

	Bug 561899 – PICMAN can't save to mounted filesystem if file exists

	* plug-ins/file-uri/uri-backend-gvfs.c (copy_uri): pass the
	G_FILE_COPY_OVERWRITE flag to g_file_copy().

2008-11-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]: removed unused methods
	picman_draw_tool_set_vectors() and picman_draw_tool_set_transform()
	and related infrastructure.

2008-11-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrenderervectors.c
	(picman_view_renderer_vectors_draw): inlined local variables that
	are only used once.

2008-11-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.c (picman_draw_tool_real_draw): moved
	vectors drawing to its own function.

2008-11-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]: reordered functions to keep those
	that actually draw together.

2008-11-21  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_get_tiles_at_level)
	cosmetics.

	* app/display/picmandisplayshell-render.[ch]: added const qualifier.

2008-11-21  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmanselectioneditor.c: For consistency, prefix the
	#warning:s with FIXME.

2008-11-21  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmancontainer.[ch]: Move the rest of the class instance
	members to PicmanContainerPriv and rename the member num_children to
	n_children.

2008-11-21  Martin Nordholts  <martinn@svn.gnome.org>

	Use PicmanContainer getters instead of poking into the class
	instance struct.

	* app/actions/context-commands.c
	* app/actions/data-commands.c
	* app/actions/plug-in-commands.c
	* app/actions/templates-commands.c
	* app/core/picman-utils.c
	* app/core/picmandrawablestack.c
	* app/core/picmanitemstack.c
	* app/core/picmanlist.c
	* app/gui/gui-vtable.c
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontainercombobox.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainerentry.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainerpopup.c
	* app/widgets/picmancontainertreeview-dnd.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmancontainerview-utils.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmansettingsbox.c
	* app/widgets/picmanviewablebutton.c

2008-11-20  Martin Nordholts  <martinn@svn.gnome.org>

	s/picman_container_children_type/picman_container_get_children_type/
	s/picman_container_policy/picman_container_get_policy/
	s/picman_container_num_children/picman_container_get_n_children/

	* app/actions/actions.c
	* app/actions/file-actions.c
	* app/actions/file-commands.c
	* app/actions/tool-options-actions.c
	* app/actions/tools-actions.c
	* app/actions/tools-commands.c
	* app/actions/vectors-actions.c
	* app/core/picmancontainer-filter.c
	* app/core/picmancontainer.c
	* app/core/picmancontainer.h
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo.c
	* app/core/picmanimage.c
	* app/core/picmanimagefile.c
	* app/core/picmanlist.c
	* app/core/picmanundostack.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/quit-dialog.c
	* app/display/picmandisplay.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell-title.c
	* app/gui/gui-vtable.c
	* app/menus/tool-options-menu.c
	* app/tools/picman-tools.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanimagepropview.c
	* app/widgets/picmansettingsbox.c
	* app/widgets/picmanviewablebutton.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c

2008-11-20  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmancontainer.[ch]: Don't expose class instance members
	marked as private.

2008-11-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanundo.h (struct PicmanUndoAccumulator): remove members
	"quick_mask_changed" and "alpha_changed" (the former was unused
	and the latter is entirely handled by the image's flush
	accumulator now.

	* app/core/picmanimage-undo.c
	* app/core/picmanlayerundo.c: changed accordingly.

2008-11-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c: add read-only "mask" property.

2008-11-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-quick-mask.c (picman_image_get_quick_mask_state):
	image->quick_mask_state is a boolean, return it directly instead
	of "state != NULL".

2008-11-19  Sven Neumann  <sven@picman.org>

	Bug 558454 – Plugin Map Color Range disappears from PICMAN

	* plug-ins/script-fu/scripts/Makefile.am

	* plug-ins/script-fu/scripts/plug-in-compat.init: new file
	providing compatibility with plug-ins from older PICMAN
	versions. Contains a reimplementation of plug-in-color-map based
	on ideas and code from Eric Lamarque.

	* plug-ins/script-fu/scheme-wrapper.c (tinyscheme_init): load the
	plug-in-compat.init file.

2008-11-19  Martin Nordholts  <martinn@svn.gnome.org>

	* README: Remove reference to the inactive picmanwin-users mailing
	list.

2008-11-18  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 559239 – Error while loading psd-data

	* plug-ins/file-psd/psd-layer-res-load.c (load_layer_resource):
	Layer resource data should not be padded.

2008-11-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unit-editor.c (columns): corrected column
	tooltip (pointed out by Cristian Secară).

2008-11-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c (picman_drawable_visibility_changed):
	chain up unconditionally.

2008-11-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: add boolean property
	"floating-selection" which indicates if the layer is a floating
	selection. Add new API picman_layer_set_floating_sel_drawable()
	which sets layer->fs.drawable and emits notify on the property.
	Did some minor cleanup in the existing property code.

	* app/core/picmanfloatingselundo.c: use the new function instead of
	setting layer->fs.drawable manually.

	* app/core/picmanlayer-floating-sel.c: same here. Remove some
	includes and local variables that are obsolete.

2008-11-16  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.[ch]
	* app/widgets/picmancontainertreeview-private.h: Make the
	renderer_cells and toggle_cells members private.

	(picman_container_tree_view_set_main_column_title)
	(picman_container_tree_view_prepend_toggle_cell_renderer)
	(picman_container_tree_view_prepend_cell_renderer): New interface.

	* app/widgets/picmantoolview.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmancontrollerlist.c: Use new interface.

2008-11-16  Michael Natterer  <mitch@picman.org>

	* app/dialogs/module-dialog.c
	* app/display/picmanscalecombobox.c
	* app/tools/picmangegltool.c
	* app/tools/picmanrectangleoptions.c
	* app/widgets/picmanactionview.[ch]
	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainerentry.[ch]
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanfileprocview.c: s/NUM_COLUMNS/N_COLUMNS/

2008-11-16  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.[ch]: Move container tree view
	model column enums here and call the last enum _N_COLUMNS.

	* app/widgets/widgets-enums.h: Remove the enum. It was meant only
	for the container tree view class hierarchy anyway.

2008-11-16  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.[ch]
	(picman_container_tree_view_set_dnd_drop_to_empty): New setter
	function so that we can make the "gboolean dnd_drop_to_empty"
	class instance member private.

	* app/widgets/picmancontainertreeview-private.h: Move member here.

	* app/widgets/picmancontainertreeview-dnd.c: Go through priv pointer.

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_init): Use
	the new function.

2008-11-16  Sven Neumann  <sven@picman.org>

	* app/app.c
	* app/gegl/picman-gegl.[ch] (picman_gegl_init): set the GEGL cache size
	as large as the PICMAN tile-cache.

2008-11-16  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.h: optimize access to
	PicmanDisplayShell struct members by placing related and frequently
	accessed members like like scale and offset into the same
	cacheline.

	* app/display/picmandisplayshell.c (picman_display_shell_init): resort
	initialization accordingly.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/widgets-enums.h: Put the PicmanContainerTreeView enums
	here instead of exposing them through silly class instance
	members.

	* app/widgets/picmancontainertreeview.[ch]:
	* app/widgets/picmancontainertreeview-dnd.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmansettingseditor.c
	* app/widgets/picmantemplateview.c
	* app/widgets/picmantoolview.c: Clean up and use new enum names.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.[ch]: Don't expose class
	instance struct members that is currently only used within the
	PicmanContainerTreeView implementation.

	* app/widgets/picmancontainertreeview-private.h: New file containing
	the definition of the private struct.

	* app/widgets/picmancontainertreeview-dnd.c: Change accordingly.

	* app/widgets/Makefile.am: Add new file.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancontainertreeview.h: Remove unused instance
	struct member "GQuark invalidate_preview_handler_id".

2008-11-15  Michael Natterer  <mitch@picman.org>

	Bug 560897 – Floating Selection, objects appearing in background

	* app/core/picmandrawable.c (picman_drawable_init_src_region): use the
	right offsets (not off_y for both x and y) when applying the
	floating selection.

2008-11-15  Sven Neumann  <sven@picman.org>

	* app/actions/debug-commands.c
	(debug_benchmark_projection_cmd_callback): run the benchmark in an
	idle callback.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/actions/debug-actions.c: Fix mnemonics for the Debug sub
	menu and the Benchmark Projection item.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 560903 – Explicit zooming with e.g. '1' should handle
	zoom-focus better

	* app/display/display-enums.h: Added
	PICMAN_ZOOM_FOCUS_RETAIN_CENTERING_ELSE_BEST_GUESS.

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_get_zoom_focus): Take the new enum into
	account; if the image is centered, keep it centered, else use the
	best-guess method.

	* app/actions/view-commands.c (view_zoom_explicit_cmd_callback):
	Use the new enum for explicit zooming.

	* app/display/display-enums.c: Regenerated.

2008-11-15  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 560245 – Zoom selection always centered in the Navigation tab

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	Also take the image center and not only the zoom focus point into
	account when deciding whether or not to center the image after
	zoom.

2008-11-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch] (struct PicmanImageFlushAccumulator):
	add member "gboolean floating_selection_changed".

	(picman_image_set_floating_selection): new function which sets
	the image's floating_sel pointer and sets the flag in the
	accumulator to TRUE for later signal emission on flush.

	(picman_image_projectable_flush): emit "floating-selection-changed"
	if the flag in the accumulator is TRUE.

	* app/core/picmanimage.c (picman_image_add,remove_layer)
	* app/core/picmanfloatingselundo.c (picman_floating_sel_undo_pop)
	* app/core/picmanlayer-floating-sel.c (floating_sel_to_layer): use
	picman_image_set_floating_selection() instead of setting
	image->floating_sel manually and remove all calls to
	picman_image_floating_selection_changed().

2008-11-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: rename picman_image_floating_sel() to
	picman_image_get_floating_selection().

	* app/actions/channels-actions.c
	* app/actions/image-actions.c
	* app/actions/layers-actions.c
	* app/actions/layers-commands.c
	* app/actions/select-actions.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-quick-mask.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanselection.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanregionselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/image.pdb: changed accordingly, replaced some
	instances of direct acces by the accessor.

	* app/pdb/image-cmds.c: regenerated.

2008-11-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scroll.[ch]: removed function
	picman_display_shell_scroll_get_scaled_viewport_offset() as it was
	only returning -shell->offset_x and -shell->offset_y and it
	started to show up in profiles.

	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell-transform.c
	* app/display/picmandisplayshell-scale.c: use the shell offsets
	directly.

2008-11-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-preview.c
	(picman_display_shell_draw_quad): check that the resulting area has
	positive width and height.

2008-11-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmancursorview.[ch]: Move the instance struct to the
	header but add a typed opaque priv pointer to it so we can avoid
	exposing implementation details. Also move the class struct to the
	header.

2008-11-13  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb (image_floating_sel_attached_to): get
	rid of useless casts.

	* app/pdb/image-cmds.c: regenerated.

2008-11-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c: add read-only boolean properties "visible"
	and "linked".

2008-11-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: added picman_image_get_display_name().

	* app/dialogs/palette-import-dialog.c
	* app/display/picmandisplayshell-close.c
	* app/display/picmandisplayshell-title.c
	* app/pdb/picmanpdb-utils.c
	* app/widgets/picmanviewabledialog.c: use the new method instead of
	getting the image URI and mangling it with
	file_utils_uri_display_basename().

2008-11-13  Sven Neumann  <sven@picman.org>

	Bug 559292 – SOTA Chrome cannot accept different textures

	* app/pdb/picmanpdb-utils.c (picman_pdb_image_is_base_type)
	(picman_pdb_image_is_not_base_type): picman_object_get_name() may
	return NULL for images. Use picman_image_get_uri() instead.

2008-11-12  Øyvind Kolås  <pippin@picman.org>

	* app/gegl/picmanoperationtilesource.c:
	(picman_operation_tile_source_prepare),
	(picman_operation_tile_source_process): cache the data in
	babl_format ("RaGaBaA float") instead of in the tile managers
	native pixel format to allow direct tile data access at projection
	compositing time.

2008-11-12  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbase.def: sorted.
	* libpicmanmodule/picmanmodule.def: updated.

2008-11-12  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-path.c (picman_config_path_expand_only):
	set the error in the PICMAN_CONFIG_ERROR domain.

2008-11-12  Sven Neumann  <sven@picman.org>

	* libpicmanmodule/picmanmodule.[ch]: added PICMAN_MODULE_ERROR domain.

	* modules/picmaninputdevicestore-hal.c
	* modules/picmaninputdevicestore-dx.c
	* modules/controller-dx-dinput.c: use PICMAN_MODULE_ERROR as error
	domain instead of 0.

2008-11-12  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picmanerror.[ch]: added PICMAN_ERROR as general error domain.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanselection.c
	* app/core/picmantooloptions.c
	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmanheal.c
	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanperspectiveclone.c
	* app/paint/picmansourcecore.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandesaturatetool.c
	* app/tools/picmangegltool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/vectors/picmanvectors-import.c: use PICMAN_ERROR as error domain
	instead of 0, which is not accepted by g_set_error_literal().

	* app/gui/session.c
	* app/menus/menus.c
	* app/vectors/picmanvectors-export.c
	* app/widgets/picmandevices.c: use G_FILE_ERROR as error domain for
	file errors.

2008-11-12  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-icc-profile.c: use the PICMAN_PLUG_IN_ERROR
	domain.

2008-11-12  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanpdberror.h
	* app/plug-in/picmanpluginerror.h: added generic error codes.

	* app/pdb/picmanprocedure.c
	* app/plug-in/picmanpluginprocedure.c: use the PICMAN_PDB_ERROR and
	PICMAN_PLUG_IN_ERROR domains.

2008-11-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmantransformtool.c: Align static function prototypes.

2008-11-11  Sven Neumann  <sven@picman.org>

	Bug 557830 – PDB browser chokes as you are entering regex
	characters

	* libpicman/picmanprocbrowserdialog.c: check if the query is a valid
	regex before calling picman_procedural_db_query().

2008-11-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c: add read-only "offset-x" and "offset-y"
	properties. Call picman_item_set_offset() from all places that set
	offset_x and offset_y in this file. Freeze and thaw GObject
	notification around all calls to virtual functions which might
	emit notify. Add missing notifications whenever width and height
	change.

	* app/core/picmanimage-rotate.c: use picman_item_set_offset() instead
	of setting the values manually.

2008-11-11  Sven Neumann  <sven@picman.org>

	Bug 560300 – Document History did not clear when "Keep record of
	used files" was unchecked

	* app/actions/documents-commands.c (documents_clear_cmd_callback):
	don't purge the entire GtkRecentManager, but only clear items
	added by PICMAN. Do this regardless of the "save-document-history"
	picmanrc option.

2008-11-11  Sven Neumann  <sven@picman.org>

	Bug 560375 – Clearing an already empty document history crashes PICMAN

	* app/actions/documents-commands.c (documents_clear_cmd_callback):
	gtk_recent_manager_purge_items() may return 0 but not set an
	error.

2008-11-11  Michael Natterer  <mitch@picman.org>

	Bug 559580 – Image windows need better default locations

	* app/display/picmandisplayshell.c (picman_display_shell_style_set):
	Only set GDK_HINT_USER_POS on the empty display because it gets a
	position set by picman. All other displays should be placed by the
	window manager. Fixes all displays appearing at 0,0.

2008-11-11  Sven Neumann  <sven@picman.org>

	Bug 558797 – "Export Path" doesn't remember last used folder

	* app/actions/vectors-commands.c: remember last-used folders in
	the Path Import and Export dialogs.

2008-11-11  Sven Neumann  <sven@picman.org>

	Bug 560283 – "Scale image..." causes distortion around edges.

	* app/paint-funcs/scale-region.c (scale): corrected fix for
	bug #556248.

2008-11-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-pdf.c: also return image type and number of
	pages. Followup to bug #559725.

2008-11-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/file-gif-load.c: return image size from the
	"file-gif-load-thumb" procedure.

2008-11-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmancursorview.c
	(picman_cursor_view_update_cursor): Show selection info from the
	image under the cursor.

	(picman_cursor_view_clear_cursor): Start showing selection info from
	the active image again.

2008-11-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanprojection.[ch]
	* app/core/picmanprojection-construct.c: add code that keeps the
	gegl processor around across calls, but destroy it anyway until
	gegl_processor_set_rectangle() is fixed.

2008-11-10  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 559716 – Changing crop size in Crop Tool Options can make UI
	unresponsive

	* app/tools/picmanrectangletool.c: Accept a broader range of x, y,
	width and height values from the tool options so we don't end up
	in an infinite signal emission loop.

2008-11-10  Sven Neumann  <sven@picman.org>

	* app/display/picmancursorview.c: added translation context.

2008-11-10  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 138101 – Pointer (Information) tab should display selection
	bounds

	* app/display/picmancursorview.c: Show the position and size of the
	bounding box of the selection in the active image using the unit
	of the active image window.

	(picman_cursor_view_format_as_unit): Don't add the unit abbreviation
	if the unit is px.

2008-11-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-curves.c (picman_drawable_curves_explicit):
	use PICMAN_CURVE_FREE, not _SMOOTH. Fixes the resp. PDB call.

2008-11-10  Sven Neumann  <sven@picman.org>

	* app/core/picmanunit.c: use NC_() to provide translation contexts.

2008-11-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp-mask.c (unsharp_region): update the
	progress less often.

2008-11-10  Sven Neumann  <sven@picman.org>

	* app/actions/text-tool-actions.c (text_tool_actions): added
	missing mnemonic.

2008-11-10  Sven Neumann  <sven@picman.org>

	Bug 559725 – Allow to set image-type and image-num-layers for
	thumbnail

	* app/file/file-open.[ch] (file_open_thumbnail): added parameters
	for image-type and number of layers. Try to get these from the
	procedure return values. Changes based on a patch from "tks".

	* app/core/picmanimagefile.c (picman_imagefile_create_thumbnail)
	(picman_thumbnail_set_info): set image-type and number of layers if
	specified.

2008-11-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-foreground-extract.c
	* app/core/picmandrawable-preview.c
	* app/core/picmanlayer-project.c: use picman_drawable_get_colormap()
	instead of picman_image_get_colormap().

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 558549 – Stroking a single-point path with a paint tool
	crashes PICMAN

	* app/paint/picmanpaintcore-stroke.c
	(picman_paint_core_stroke_vectors): Return an error message if there
	were not enough points to stroke.

	* app/dialogs/stroke-dialog.c (stroke_dialog_response): Guard
	against crashes if an implementator forgets to set an error.

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmannavigationeditor.c: Clean up and simplify
	little.

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_update_rulers): Avoid critical warnings
	when converting an image window with a unit other than pixels into
	a the empty image window. Probably fixes some of the crashes
	reported by Windows users.

2008-11-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-types.h: move PicmanCursorView typedef from
	here...

	* app/display/display-types.h: ...to here.

2008-11-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.[ch]: remove
	floating_sel_remove() and reorder one function.

	* app/core/picmanimage.c (picman_image_remove_layer): add the single
	line of special code that needs to be done when removing a
	floating selection.

	* app/core/picmanselection.c
	* app/actions/layers-commands.c
	* tools/pdbgen/pdb/floating_sel.pdb: changed accordingly.

	* app/pdb/floating-sel-cmds.c: regenerated.

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo.c: remove enum value
	PICMAN_UNDO_GROUP_FS_REMOVE.

2008-11-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c
	* app/core/picmanimage-convert.c
	* app/core/picmanprojection-construct.c
	* app/tools/picmaneditselectiontool.c
	* app/widgets/picmanlayertreeview.c
	* app/xcf/xcf-save.c: remove inclusion of "picmanlayer-floating-sel.h"

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	Prepare PicmanCursorView for a dependency to PicmanDisplayShell.

	* app/widgets/picmancursorview.[ch]: Move from here...

	* app/display/picmancursorview.[ch]: ...to here.

	* app/widgets/Makefile.am
	* app/display/Makefile.am: Change accordingly.

	* app/actions/cursor-info-actions.c
	* app/dialogs/dialogs-constructors.c
	* app/actions/cursor-info-commands.c
	* app/display/picmandisplayshell-cursor.c: Update includes.

2008-11-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.[ch]: made
	floating_sel_composite() private and simplify it a lot by using
	picman_rectangle_intersect().

2008-11-09  Michael Natterer  <mitch@picman.org>

	Bye bye floating_sel_rigor() and floating_sel_relax():

	* app/core/picmandrawable.[ch] (picman_drawable_init_src_region):
	implement compositing the floating selection on the fly. Add
	return parameter "TileManager **temp_tiles" which returns the temp
	buffer used for compositing; the caller has to unref the tiles.

	* app/core/picmanchannel-project.c
	* app/core/picmanlayer-project.c: unref the temp_tiles.

	* app/core/picmanlayer.[ch]: remove members fs.backing_store and
	fs.initial.

	* app/core/picmanlayer-floating-sel.[ch]: remove functions rigor(),
	relax(), store() and restore(), they are not needed any longer.
	Some minor cleanup, more to come.

	* app/core/picmanprojection-construct.c: don't composite the
	floating selection before projecting because that happens on the
	fly now.

	* app/core/core-enums.[ch]
	* app/core/picmanfloatingselundo.c
	* app/core/picmanimage-undo-push.[ch]: remove the rigor and relax
	undos.

	* app/core/picmandrawable.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/xcf/xcf-save.c: remove all calls to rigor and relax and all
	implementations of virtual functions that were just there to
	rigor/releax around chaining up.

	* tools/pdbgen/pdb/floating_sel.pdb: remove all code from the
	rigor and relax wrappers and deprecate the API.

	* app/pdb/floating-sel-cmds.c
	* libpicman/picmanfloatingsel_pdb.[ch]: regenerated.

	* plug-ins/file-xjt/xjt.c: don't call rigor and relax.

2008-11-09  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmancursorview.[ch]: Don't expose implementation
	details, introduce internal helper functions, and make coordinates
	outside the image be represented with an italic font instead of
	enclosed in parenthesis.

2008-11-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: add optional parameter "PixelRegion
	*destPR" to PicmanDrawable::apply_region().

	* app/core/picmandrawable-combine.[ch]: if the passed destPR is !=
	NULL, write the result of the combination into that region instead
	of the drawable's tiles. The region must have the exact size of
	the result.

	* app/core/picman-edit.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-shadow.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer-floating-sel.c
	* app/paint/picmanpaintcore.c: pass NULL as destPR. Code actually
	using this feature follows.

2008-11-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: add new function
	picman_drawable_init_src_region() which will initialize a
	PixelRegion on this drawable's "projection" (with the floating
	selection combined), but for now just uses drawable->tiles.

	* app/core/picmanchannel-project.c
	* app/core/picmanlayer-project.c: use it instead of
	pixel_region_init() on the drawable's tiles.

2008-11-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-combine.c: cleanup.

2008-11-08  Michael Natterer  <mitch@picman.org>

	Abstract the legacy projection code away into a virtual function
	of PicmanDrawable:

	* app/core/picmandrawable.[ch]: add new virtual function
	PicmanDrawable::project_region() which projects an area of a
	drawable onto a passed in PixelRegion.

	* app/core/Makefile.am
	* app/core/picmanchannel-project.[ch]
	* app/core/picmanlayer-project.[ch]: new files which implement it.

	* app/core/picmanchannel.c
	* app/core/picmanlayer.c: hook it in.

	* app/core/picmanprojection-construct.c: get rid all the projection
	code moved to above new files and project all drawables in one
	loop.

	* app/core/picmanprojectable.[ch]: remove the legacy methods
	get_colormap() and get_components(), they are not needed any
	longer.

	* app/core/picmanimage.c: changed accordingly.

2008-11-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-load.c (picman_palette_load_aco): improved
	error handling. Fixes compiler warnings about ignoring the return
	value of read().

2008-11-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.[ch]: move the invalidate_previews()
	API from here...

	* app/core/picmanitemstack.[ch]: ...to here.

	* app/core/picmanimage.c: changed accordingly.

2008-11-06  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanitemstack.[ch]: new PicmanList subclass which (for
	now) does nothing but taking ownership of its children by the
	means of g_object_ref_sink().

	* app/core/picmandrawablestack.[ch]: derive from PicmanItemStack.

	* app/core/picmanimage.c: use a PicmanItemStack instead of a plain
	PicmanList for the list of vectors. Remove code which takes
	ownerships of added items from picman_image_add_layer(),
	add_channel() and add_vectors().

2008-11-06  Nils Philippsen  <nils@redhat.com>

	* plug-ins/file-jpeg/jpeg-save.c: fix memory leak

2008-11-06  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfigwriter.c (picman_config_writer_linefeed):
	use g_set_error_literal() here as well.

2008-11-06  Sven Neumann  <sven@picman.org>

	* tools/picman-mkenums: use NC_() to mark enum values for translation.
	Use a lower-case short form of the type name as translation context.

	* libpicman/libpicman-intl.h: define the NC_() macro as noop.

	* libpicmanbase/picmanbasetypes.[ch]
	* libpicmanbase/picmanbase.def: added new functions to set and
	get a translation context on an enum type.

	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am
	* app/paint/Makefile.am
	* app/plug-in/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am:
	* libpicmanconfig/Makefile.am
	* libpicmanthumb/Makefile.am
	* libpicmanwidgets/Makefile.am: register the translation context
	with the enum types.

	* app/display/display-enums.h
	* libpicmanbase/picmanbaseenums.h
	* libpicmanconfig/picmancolorconfig-enums.h: removed old-style explicit
	translation context.

	* app/base/base-enums.c
	* app/core/core-enums.c
	* app/display/display-enums.c
	* app/paint/paint-enums.c
	* app/plug-in/plug-in-enums.c
	* app/text/text-enums.c
	* app/tools/tools-enums.c
	* app/widgets/widgets-enums.c
	* libpicmanbase/picmanbaseenums.c
	* libpicmanconfig/picmancolorconfig-enums.c
	* libpicmanwidgets/picmanwidgetsenums.c: regenerated.

2008-11-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c: some minor cleanups.

2008-11-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.[ch]: add new function
	picman_drawable_stack_invalidate_previews() which does just what it
	says.

	* app/core/picmanimage.[ch]: merge invalidate_layer_previews() and
	invalidate_channels_previews() into a single invalidate_previews()
	and replace all calls to the old functions by calls to
	picman_drawable_stack_invalidate_previews().

	* app/file/file-open.c: changed accordingly.

2008-11-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): remove call
	to picman_image_invalidate_layer_previews(), they are invalidated by
	exchanging their tiles and by setting the image's colormap anyway.

2008-11-05  Michael Natterer  <mitch@picman.org>

	This should remove any image or viewable dependency from the
	projection (apart from the projectable's get_image() method, but
	that one is not supposed to return the projection's model but
	rather the image the projection is part of).

	* app/core/picmanprojectable.[ch]: add vfunc get_size() which
	completes the API needed for GEGL projection.

	Add vfuncs get_layers(), get_channels(), get_components() and
	get_colormap() which are needed for the legacy projection code.

	* app/core/picmanimage.c: implement the new methods.

	* app/core/picmanprojection.c
	* app/core/picmanprojection-construct.c: use them and remove all
	calls to image and viewable API.

2008-11-05  Sven Neumann  <sven@picman.org>

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-python/Makefile.in.in
	* po-script-fu/Makefile.in.in
	* po-tips/Makefile.in.in
	* po/Makefile.in.in: prepared for use of the NC_() macro.

2008-11-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanprojectable.[ch]: add signal "structure-changed"
	and API to emit it.

	* app/core/picmanimage.c: emit it when the image emits
	"mode-changed" and "size-changed".

	* app/core/picmanprojection.c: connect to the new signal instead of
	"mode-changed" and "size-changed" to get rid of one more image
	dependency.

2008-11-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-dnd.c
	(picman_display_shell_drop_uri_list): when dropping multiple images
	to the empty image window, open them as seperate images.

2008-11-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanprojectable.[ch]: add vitrual function
	invalidate_preview().

	* app/core/picmanimage.c: implement it and redirect to
	picman_viewable_invalidate_preview().

	* app/core/picmanprojection.c: call the new API instead of
	picman_viewable_invalidate_preview(). Some cleanup in the disabled
	cow-projection code.

2008-11-04  Michael Natterer  <mitch@picman.org>

	Unfinished first step to make the projection independent of
	PicmanImage, also one step closer to layer grouping.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanprojectable.[ch]: add new interface which abstracts
	something that can have a projection attached to it. Has "update"
	and "flush" signals and get_graph() and get_image()
	vfuncs. get_image() is temporary until the hack is finishes.

	* app/core/picmanimage.[ch]: implement PicmanProjectableInterface,
	remove "update" and "flush" signals and made get_graph() a private
	implementation of the interface method. Moved interface method
	implementations after virtual function implementations.

	* app/core/picmanprojection.[ch]: change member "image" to
	"projectable" and use the projectable API as often as
	possible. Still some implicit dependencies on the projectable
	being an image left but it's getting close.

	* app/core/picmanprojection-construct.c: same here.

2008-11-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay-foreach.c: added missing include.

	* app/actions/debug-commands.c
	* plug-ins/common/lcms.c
	* plug-ins/common/mail.c
	* plug-ins/file-bmp/bmp-write.c
	* plug-ins/file-fits/fits.c
	* plug-ins/file-jpeg/jpeg.c
	* plug-ins/file-uri/uri.c
	* plug-ins/help/picmanhelpdomain.c
	* plug-ins/ifs-compose/ifs-compose.c
	* plug-ins/print/print.c: fixed use of g_message() with literal
	strings.

2008-11-04  Sven Neumann  <sven@picman.org>

	* configure.in: bumped minimum required version of GLib to 2.18.0.

	* INSTALL: document the updated dependency.

	* app/core/picman.[ch]: introduced picman_message_literal(), a variant
	of picman_message() that takes a literal string.

	* app/errors.[ch]: removed format arguments from picman_fatal_error()
	and picman_terminate() and let them take a literal string instead.

	* app/tools/picmantool.[ch]: introduced picman_tool_message_literal(),
	a variant of picman_tool_message() that takes a literal string.

	* app/actions/documents-commands.c
	* app/actions/drawable-commands.c
	* app/actions/edit-commands.c
	* app/actions/error-console-commands.c
	* app/actions/file-commands.c
	* app/actions/gradients-commands.c
	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/actions/palettes-commands.c
	* app/actions/plug-in-commands.c
	* app/actions/select-commands.c
	* app/actions/vectors-commands.c
	* app/config/picmanrc.c
	* app/core/picman-modules.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman-units.c
	* app/core/picmanchannel.c
	* app/core/picmancontainer-filter.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage.c
	* app/core/picmanimagefile.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.c
	* app/core/picmanselection.c
	* app/dialogs/convert-dialog.c
	* app/dialogs/dialogs.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/dialogs/quit-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/file/file-open.c
	* app/file/file-procedure.c
	* app/file/file-save.c
	* app/file/file-utils.c
	* app/gegl/picmancurvesconfig.c
	* app/gegl/picmanlevelsconfig.c
	* app/gui/gui-message.c
	* app/gui/gui.c
	* app/gui/session.c
	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmanheal.c
	* app/paint/picmanperspectiveclone.c
	* app/paint/picmansourcecore.c
	* app/pdb/picmanpdb-utils.c
	* app/pdb/picmanprocedure.c
	* app/plug-in/picmanplugin-message.c
	* app/plug-in/picmanplugin.c
	* app/plug-in/picmanpluginmanager-restore.c
	* app/plug-in/picmanpluginprocedure.c
	* app/text/picmantextlayer.c
	* app/tools/picman-tools.c
	* app/tools/picmanaligntool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandesaturatetool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmangegltool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool-settings.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansourcetool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmanactionview.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmancontrollers.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandevices.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanerrordialog.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanpdbdialog.c
	* app/widgets/picmansettingsbox.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmanwidgets-utils.c
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/image.pdb: use the _literal variants for
	g_set_error(), picman_message() and picman_tool_message().

	* app/pdb/convert-cmds.c
	* app/pdb/edit-cmds.c
	* app/pdb/floating-sel-cmds.c
	* app/pdb/image-cmds.c: regenerated.

2008-11-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanprojection.[ch]: remove public functions
	get_tiles(), get_image(), get_image_type() and get_bytes().

	* app/actions/debug-commands.c
	* app/actions/layers-commands.c
	* app/core/picmanprojection-construct.c
	* app/display/picmandisplayshell-render.c
	* app/paint/picmanpaintcore.c
	* tools/pdbgen/pdb/layer.pdb: use the PicmanPickable API insatead.

	* app/pdb/layer-cmds.c: regenerated.

2008-11-04  Sven Neumann  <sven@picman.org>

	* app/base/tile-pyramid.[ch] (tile_pyramid_new):
	* app/core/picmanprojection.c (picman_projection_get_tiles_at_level):
	reverted last change as the code in tile-pyramid does care about
	the pixel format and it should continue to reject types that it
	cannot handle.

2008-11-04  Michael Natterer  <mitch@picman.org>

	* app/base/tile-pyramid.[ch] (tile_pyramid_new): changed "type"
	parameter into "bytes" because tile managers don't care about
	the pixel format of their tiles. Reordered parameters to match
	tile_manager_new().

	* app/core/picmanprojection.c (picman_projection_get_tiles_at_level):
	pass the bytes instead of the image type.

2008-11-04  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am
	* app/text/picmantext-private.h: removed this header file.

	* app/text/picmantextlayout.[ch]: added getters to access the
	resolution, text and PangoLayout.

	* app/text/picmantextlayout-render.c
	* app/tools/picmantexttool.c: use the new getters instead of poking
	into the PicmanTextLayout struct.

2008-11-04  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am
	* app/text/picmantext-bitmap.[ch]: removed.

	* app/text/picmantext-private.h
	* app/text/picmantext-vectors.c
	* app/text/picmantextlayer.c
	* app/text/picmantextlayout-render.[ch]
	* app/text/picmantextlayout.c: removed text render abstraction as
	this is now sufficiently provided by PangoCairo.

2008-11-03  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Reuse the blending
	formula from the legacy Soft light. (Actually the formula comes
	from legacy Overlay but legacy Overlay and Soft light blends
	pixels exactly the same.) I hereby declare the porting of the
	layer modes to this GEGL operation complete. Summary:

	Completely works the same:

	  Normal, Dissolve, Behind, Color Erase, Erase, Anti Erase

	Works the same for 100% opaque layers:

	  Lighten only, Screen, Dodge, Addition, Darken only, Multiply,
	  Dodge, Soft light, Hard light, Difference, Subtract, Grain
	  extract, Grain merge, Divide, Hue, Saturation, Color, Value

	Works different but similar:

	  Overlay now uses the SVG 1.2 overlay formula which is different
	  but similar to legacy Overlay

	  Replace needs to be externally masked to not replace too much,
	  but that is outside the scope of the layer mode porting.

2008-11-03  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanwidgets-constructors.c
	(picman_paint_mode_menu_new): Arrange layer modes into more logical
	and useful groups.

2008-11-03  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am
	* app/paint/Makefile.am
	* app/plug-in/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/widgets/Makefile.am
	* libpicman/Makefile.am
	* libpicmanbase/Makefile.am:
	* libpicmanconfig/Makefile.am
	* libpicmanthumb/Makefile.am
	* libpicmanwidgets/Makefile.am: micro-optimization in the generated
	enum registration code.

	* app/base/base-enums.c
	* app/core/core-enums.c
	* app/display/display-enums.c
	* app/paint/paint-enums.c
	* app/plug-in/plug-in-enums.c
	* app/text/text-enums.c
	* app/tools/tools-enums.c
	* app/widgets/widgets-enums.c
	* libpicmanbase/picmanbaseenums.c
	* libpicmanconfig/picmancolorconfig-enums.c
	* libpicmanwidgets/picmanwidgetsenums.c: regenerated.

2008-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmandrawablemodundo.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanselection.c
	* app/text/picmantext-compat.c
	* app/text/picmantextlayer-xcf.c
	* app/vectors/picmanvectorsmodundo.c
	* app/widgets/picmanviewrendererdrawable.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/layer.pdb: use accessors for item->offset_x,y.
	Some minor unrelated cleanups.

	* app/pdb/layer-cmds.c: regenerated.

2008-11-03  Michael Natterer  <mitch@picman.org>

	* app/actions/vectors-actions.c: include "picmancontainer.h".

2008-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch] (picman_drawable_set_tiles): add
	"PicmanImageType type" parameter because there are only a few calls
	to this function which (can easily pass the current type); however
	most calls to picman_drawable_set_tiles_full() were just using the
	function because of the type argument and passed in the item's
	current offsets (which means peeking into the item struct or using
	temp variables).

	* app/core/picmandrawable-offset.c (picman_drawable_offset)
	* app/text/picmantextlayer.c (picman_text_layer_render)
	* app/tools/picmantransformtool.c (picman_transform_tool_doit): pass
	the type to set_tiles().

	* app/core/picmanchannel.c (picman_channel_convert)
	* app/core/picmanimage-convert.c (picman_image_convert)
	* app/core/picmanlayer.c (picman_layer_convert,add_alpha,flatten):
	change calls to set_tiles_full() into set_tiles() because the
	offset doesn't change.

2008-11-03  Michael Natterer  <mitch@picman.org>

	Bug 559015 – Move tool gives bad information about px moved

	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_init):
	set cursor precision to PIXEL_BORDER because that's what the move
	tool snaps to.

	Unrelated: set CENTER_CROSS_SIZE to an odd number so it's drawn
	symmetrically.

2008-11-03  Sven Neumann  <sven@picman.org>

	Bug 559081 – JPEG Save dialog preview should adjust size units

	* plug-ins/file-jpeg/jpeg-save.c: use g_format_size_for_display()
	to display the JPEG file size.

2008-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: renamed
	picman_item_width() to picman_item_get_width() and
	picman_item_height() to picman_item_get_height().

	* app/actions/channels-commands.c
	* app/actions/drawable-commands.c
	* app/actions/layers-commands.c
	* app/core/<many>.c
	* app/dialogs/offset-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/scale-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell.c
	* app/paint/picmanbrushcore.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmanink.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmansmudge.c
	* app/text/picmantextlayer-xcf.c
	* app/text/picmantextlayer.c
	* app/tools/picmanaligntool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanregionselecttool.c
	* app/tools/picmantexttool.c
	* app/vectors/picmanvectors.c
	* app/vectors/picmanvectorsmodundo.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmanviewrendererdrawable.c
	* app/widgets/picmanviewrenderervectors.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/drawable.pdb: changed accordingly.

	* app/pdb/drawable-cmds.c: regenerated.

2008-11-03  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanitem.c: Instantiate offset_node on-demand.

	* app/core/picmandrawable.c: Use picman_item_set_offset().

2008-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: renamed
	picman_item_offsets() to picman_item_get_offset() and
	picman_item_set_offsets() to picman_item_set_offset().

	* app/actions/drawable-commands.c
	* app/actions/layers-commands.c
	* app/core/<many>.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-preview.c
	* app/display/picmandisplayshell-transform.c
	* app/display/picmandisplayshell.c
	* app/paint/picmanpaintcore-stroke.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmansourcecore.c
	* app/text/picmantextlayer-xcf.c
	* app/tools/<many>.c
	* app/widgets/picmantoolbox-dnd.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/transform_tools.pdb
	* tools/pdbgen/pdb/vectors.pdb: changed accordingly.

	* app/pdb/drawable-cmds.c
	* app/pdb/drawable-transform-cmds.c
	* app/pdb/selection-cmds.c
	* app/pdb/vectors-cmds.c
	* app/pdb/transform-tools-cmds.c: regenerated.

2008-11-02  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanitem.[ch] (picman_item_set_offsets): New function
	that sets the offset of the item and also keeps the offset_node in
	sync.

	* app/core/picmandrawable.c (picman_drawable_real_set_tiles): Use the
	function instead of setting the offsets directly. Fixes corrupted
	display when cropping images with GEGL enabled for the projection.

2008-11-02  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanitem.[ch]: Moved the shift_node from PicmanLayer to
	PicmanItem, and call it offset_node. Also added
	picman_item_get_offset_node() meant to be used in the same way as
	picman_item_offsets().

	(picman_item_real_translate): Keep the offset_node up to date.

	* app/core/picmanlayer.[ch]: Don't manage the offset_node, get it
	from PicmanItem instead.

2008-11-02  Michael Natterer  <mitch@picman.org>

	* app/core/picman.[ch]: add new functions picman_get_image_iter(),
	display_iter() and tool_info_iter().

	* app/tools/picman-tools.c
	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c
	* app/dialogs/quit-dialog.c
	* app/gui/gui.c
	* app/menus/windows-menu.c
	* app/actions/images-commands.c
	* app/actions/tools-actions.c
	* app/actions/windows-actions.c
	* app/actions/tool-options-commands.c
	* app/display/picmandisplay.c
	* app/display/picmandisplay-foreach.c
	* app/widgets/picmantoolbox.c
	* tools/pdbgen/pdb/image.pdb: use them here.

	* app/pdb/image-cmds.c: regenerated.

2008-11-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: add new functions
	picman_image_get_layer_iter(), channel_iter() and vectors_iter()
	which return the GList inside the resp. PicmanList.

	* app/actions/channels-actions.c
	* app/actions/layers-actions.c
	* app/actions/vectors-actions.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-item-list.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage.c
	* app/core/picmanprojection-construct.c
	* app/display/picmandisplayshell-draw.c
	* app/file/file-open.c
	* app/tools/picmanaligntool.c
	* app/tools/picmandrawtool.c
	* app/vectors/picmanvectors-compat.c
	* app/vectors/picmanvectors-export.c
	* app/widgets/picmanlayertreeview.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/image.pdb: use the new functions instead of
	peeking both into the image and the list. Remove inclusions of
	"picmanlist.h" or change them into "picmancontainer.h" if needed.

	* app/pdb/image-cmds.c: regenerated.

2008-11-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.[ch]: add "update" signal with the
	same signature as PicmanImage::update(). Install handlers for the
	drawables' "update" and "visibility-changed" signals and emit
	"update" accordingly, item offsets taken into account. Also emit
	"update" when drawables are added, removed and reordered.

	* app/core/picmanimage.[ch]: remove handlers and tons of code that
	makes sure the image emits "update" on any of the above handled
	events and simply connect the layer and channel stacks' "update"
	signal to picman_image_update().

2008-11-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch]: remove the mask_node and simply set
	both opacity and the layer mask's source node on the opacity_node.
	Needs latest SVN GEGL.

2008-11-02  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanitem.[ch]: Move the base GeglNode here in
	preparation for moving the PicmanLayer gegl:shift op to here as
	well. After all, the offsets are properties of PicmanItem and not
	PicmanLayer.

	* app/core/picmandrawable.[ch]: Delegate appropriate stuff to the
	PicmanItem base class, like part of the visibility toggling and the
	creation and destruction of the PicmanItem node.

	* app/core/picmanlayer.c
	* app/core/picmanchannel.c
	* app/core/picmandrawablestack.c: Changed accordingly, use the new
	function names.

	* app/core/picmanitempropundo.c
	* app/vectors/picmanvectors-warp.c
	* app/vectors/picmanvectorsmodundo.c: Include gegl.h instead of
	glib-object.h

2008-11-01  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_cursor_update): set the MOVE cursor modifier
	when we are in MOVING mode.

	* app/tools/picmantexttool.[ch]: remove members x1,y1,x2,y2 and use
	the rectangle tool's bounding box for creating the text layer (x2
	and y2) were unused anyway. Add boolean member "moving". Implement
	oper_update() and set the tool to moving mode when ALT is pressed.
	Changed button_press(), button_release() and motion() accordingly.
	Some more cleanup and removal of comented out code.

2008-11-01  Sven Neumann  <sven@picman.org>

	* configure.in: include pangoft2 in PANGOCAIRO_CFLAGS and
	PANGOCAIRO_LIBS. We are still using API that is in PangoFT2.

2008-11-01  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]
	* app/tools/tool_manager.[ch]: made all PicmanCoords* in the tool
	API const.

	* app/tools/picmanaligntool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbrushtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancolortool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmaneditselectiontool.[ch]
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanperspectiveclonetool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanregionselecttool.c
	* app/tools/picmanselectiontool.[ch]
	* app/tools/picmansourcetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: changed accordingly and added const
	to all PicmanCoords* in utility functions too.

	* app/tools/picmantexttool.c: don't modify the passed coords. In
	fact, simply removed the code that did because it had no effect.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Replaced the XXX for
	Soft light with a FIXME.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmancolor/picmanhsl.c (picman_hsl_set): Added 'Since: PICMAN 2.8'.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperation*.c: Prefix the PICMAN GEGL operations with
	"picman:" instead of "picman-" so we follow the GEGL prefix style and
	better serialize to XML.

	* app/tools/picman*tool.c

	* app/core/picmandrawable-*.c
	* app/core/picmandrawable.c
	* app/core/picmanimagemap.c
	* app/core/picmanprojection.c: Changed accordingly.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Introduced helper macros
	fooC to properly un-multiply pre-multiplied data without causing
	NaNs. This fixes some compositing issues involving complete
	transparency.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Renamed fooC aliases to
	fooCa since they represent pre-multiplied color data.

2008-11-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Get rid of GRand in
	process() and use a lut instead. A little benchmark showed a
	performance improvement of 78%. Also added defines for the the
	size of the area of which Dissolve repeats it dissolve pattern.

2008-10-31  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Implemented Erase, Anti
	Erase, Color Erase and Replace. These are not normal layer modes
	and handle alpha in their own way. In addition to this, the
	behavior of Replace doesn't map very well to GEGL which uses
	infinite sized "layers".

	Completely works the same:
	 o Erase
	 o Anti Erase
	 o Color Erase

	Works different but similar:
	 o Replace

	* app/paint-funcs/paint-funcs.[ch]: Expose
	paint_funcs_color_erase_helper() so it can be used in the
	PicmanOperationPointLayerMode implementation. Once the migration is
	complete this function can be moved entirely to the op and be
	tailored to work on premultiplied data.

2008-10-31  Sven Neumann  <sven@picman.org>

	Bug 558660 – help behavior for locales without manual translation

	* app/widgets/picmanhelp.c (picman_help_user_manual_is_installed):
	as a fallback check for the english user manual.

2008-10-31  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprocview.c: added basic gtk-doc comment for
	picman_proc_view_new().

2008-10-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_key_press): bail out
	when the passed display is != tool->display. Makes the keyboard
	work in other displays while the text tools is active.

2008-10-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]: add picman_draw_tool_draw_text_cursor()
	which draws a properly transformed cursor that always has the same
	line width.

	* app/tools/picmantexttool.c (picman_text_tool_draw): use it instead
	of drawing a cursor here that is broken at anything but 1:1 zoom.

2008-10-31  Michael Natterer  <mitch@picman.org>

	* app/actions/text-tool-actions.c
	* app/actions/text-tool-commands.c: add missing includes and
	remove unused variable.

2008-10-31  Sven Neumann  <sven@picman.org>

	* configure.in: also check for freetype2 when checking for
	pangocairo. Should fix the build on systems where the FT2 include
	path is not included otherwise.

2008-10-31  Sven Neumann  <sven@picman.org>

	* configure.in: lowered minimum required version of Cairo to 1.6.0.

2008-10-31  Sven Neumann  <sven@picman.org>

	* INSTALL:
	* configure.in: removed checks for PangoFT2.

	* app/config/Makefile.am
	* app/text/Makefile.am
	* app/Makefile.am: removed use of PANGOFT2_CFLAGS and PANGOFT2_LIBS.

2008-10-31  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c
	* app/text/picmanfontlist.c: render font previews using PangoCairo.

2008-10-31  Sven Neumann  <sven@picman.org>

	* configure.in: bumped minimum required version of Cairo to 1.6.4.

	* app/core/picmanscanconvert.c: use cairo_format_stride_for_width().

2008-10-31  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Formating,
	simplification and fixed operator precedence for the seed (not
	that it matters much).

2008-10-31  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): The GEGL API actually
	allows us to handle the Dissolve layer mode as a point op. The
	GEGL implementation of Dissolve uses a faster implementation for
	deterministic behavior than the legacy Dissolve implementation.
	The end result should be identical (although not on the
	pixel-level).

	Completely works the same:
	 o Dissolve

2008-10-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_key_press): bail out
	instead of crashing if the tool has no display.

	(picman_text_tool_draw)
	(picman_text_tool_draw_preedit)
	(picman_text_tool_draw_selection)
	(picman_text_tool_xy_to_offset): need to adjust all drawing and
	event coordinates by a possible negative offset between logical
	rectangle and ink rectangle (if the ink rectangle is larger than
	the logical one).

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): continue normally if
	tool_manager_key_press_active() returns FALSE.

2008-10-30  Sven Neumann  <sven@picman.org>

	* app/text/picman-fonts.c
	* app/text/picmanfont-utils.c: removed unused includes.

2008-10-30  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: remove lots of unused variables,
	apparently my builds were without proper warnings for some time.
	Some formatting cleanup and code reordering.

	* app/actions/text-tool-actions.c
	* menus/text-tool-menu.xml: rename "text-tool-input-methods"
	to "text-tool-input-methods-menu".

2008-10-30  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout.c: fixed order of includes.

	* app/text/picmantext-compat.c: ported to PangoCairo like the rest
	of the text rendering code.

2008-10-30  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout-render.c: removed an obsolete and
	misleading comment.

2008-10-29  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def
	* libpicmanbase/picmanbase.def
	* libpicmancolor/picmancolor.def: updated with new symbols.

2008-10-29  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 558215 – unit and zoom entries in Statusbar not visible

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_size_allocate): Don't try to be clever,
	call picman_display_shell_scaled() whenever the canvas size changes
	so a newly created display shell gets updated properly.

2008-10-29  Sven Neumann  <sven@picman.org>

	Bug 558451 – Cannot build PICMAN using Sun CC on Solaris 2.8

	* app/pdb/picman-pdb-compat.c
	* app/gegl/picmanoperationtilesink.c
	* app/gegl/picmanoperationtilesource.c
	* app/tools/picmangegltool.c: applied patches from Eric Lamarque
	fixing the build using Sun CC on Solaris.

2008-10-29  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Implemented the layer
	modes Hue, Saturation, Color and Value.

	Works the same for 100% opaque layers:
	 o Hue
	 o Saturation
	 o Color
	 o Value

	* libpicmancolor/picmanhsl.[ch]: Added picman_hsl_set().

2008-10-29  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/file-pdf.c: a comment was still saying
	"poppler.c".

2008-10-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanselection.[ch]: change member "gboolean stroking"
	into "gint stroking_count". Add push/pop API to increase/decrease
	the counter. Pretend the selection is empty if the counter is > 0.
	Enables correctly rendering vector layers even if there is a
	selection.

2008-10-29  Sven Neumann  <sven@picman.org>

	Bug 558420 – projection incorrect with alpha-less layers

	* app/core/picmanprojection-construct.c (picman_projection_initialize):
	need to initialize the projection if the covering layer is not
	opaque.

2008-10-29  Sven Neumann  <sven@picman.org>

        Bug 557950 – Scaling in Picman 2.6 is much slower than in Picman 2.4

        * app/paint-funcs/scale-region.c: don't do multi-pass scaling
	when we are scaling up.

2008-10-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanstrokeeditor.c: move the "Antialias" toggle from
	here...

	* app/widgets/picmanfilleditor.c: ...to here because it makes sense
	for both filling and stroking.

2008-10-29  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/picman-online.scm: renamed from
	web-browser.scm.

2008-10-29  Martin Nordholts  <martinn@svn.gnome.org>

	* configure.in: Properly save CFLAGS temporarily.

2008-10-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_button_release):
	turn nested if()s into a switch(release_type).

2008-10-28  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 556603 – Zoom region always zooms in center of image

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_button_release):
	When zooming with a click, use picman_display_shell_scale() instead
	of local zoom logic.

2008-10-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: added "gboolean below" to
	picman_enum_radio_frame_add() and picman_enum_radio_box_add() and
	place the widget right of the radio button unless "below" is TRUE.

	* app/dialogs/convert-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanperspectiveclonetool.c: pass TRUE so everything
	stays as-is.

	* app/widgets/picmanfilleditor.c: pass FALSE if we are editing the
	context's "foreground" and "pattern" properties.

2008-10-28  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c
	(picman_operation_point_layer_mode_process): Put the existing blend
	formulas in expanded switch cases again. We need to keep the more
	complicated layer modes like Hue, Value and Saturation in expanded
	switch cases anyway.

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: some minor cleanups.

	(picman_text_tool_draw): draw a cursor of two pixels width which is
	between glyphs so it is visible both at the left and the right
	border or the rectangle. Also make it look a little more
	cursor-like.

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/actions/text-tool-actions.c
	* app/actions/text-tool-commands.[ch]
	* menus/text-tool-menu.xml: rename action "path-from-text" to
	"text-to-path".

2008-10-27  Michael Natterer  <mitch@picman.org>

	* menus/text-tool-menu.xml
	* app/actions/text-tool-actions.c
	* app/actions/text-tool-commands.[ch]: add "Text along Path" to the
	text tool context menu.

	* app/tools/picmantextoptions.[ch]: remove the text along path
	button here.

	* app/tools/picmantexttool.c: changed accordingly.

	* app/tools/picmantexttool.[ch]: move public functions together,
	move all virtual function implementations together and put them in
	order, made the text along path function public, factor out
	picman_text_tool_xy_to_offset() instead of duplicaing this code
	three times, remove picman_rectangle_tool_frame_item() because it
	doesn't belong here.

	* app/tools/picmanrectangletool.[ch]: add
	picman_rectangle_tool_frame_item() here. Enselic, please process ;)

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/actions/text-tool-actions.c: changed menu labels.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/actions/text-editor-commands.c (text_editor_load_response):
	hide the file dialog instead of destroying it.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmantexttool.c: removed unused includes.

	* app/actions/text-tool-commands.c (text_tool_load_cmd_callback):
	fixed file dialog for opening text files.

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_key_press): take the
	layout line's x coordinate into account so the stuff works for
	right-aligned or centered text.

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_key_press): argh, need
	to speak in byte offsets not character offsets. Do so and avoid
	getting the buffer's text on each keystroke just to do the
	char/byte conversion. Will use the same method for all the other
	places which do similar things.

	(picman_text_tool_connect): minor cleanup.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayer.c (picman_text_layer_render_layout):
	iterate over the tiles instead of rendering row-by-row.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout.c (picman_text_get_pango_context): use the
	Y resolution when creating the fontmap.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout-render.c (picman_text_layout_render_trafo):
	minor cleanup.

2008-10-27  Sven Neumann  <sven@picman.org>

	* app/text/picmantext-bitmap.c: cleanup, removed unused includes.

2008-10-27  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: added new enum PicmanTextHintStyle.

	* libpicman/picmanenums.c.tail
	* tools/pdbgen/enums.pl: regenerated.

	* app/text/picmantext.[ch]: added new property "hint-style". Removed
	"autohint" property and mapped the boolean property "hinting" to
	the new enum property "hint-style".

	* app/text/picmantextlayout-render.c (picman_text_layout_render_flags):
	use "hint-style".

	* app/tools/picmantextoptions.[ch]: changed tool options accordingly.

	* tools/pdbgen/pdb/text_layer.pdb: deprecated the "hinting" API
	and introduced getters and setters for "hint-style".

	* app/pdb/text-layer-cmds.c
	* app/pdb/internal-procs.c
	* libpicman/picmantextlayer_pdb.[ch]: regenerated.

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]: add picman_draw_tool_set_clip_rect()
	which transforms the passed in GdkRectangle before setting it
	on the canvas.

	* app/tools/picmantexttool.c (picman_text_tool_draw): use it instead
	of picman_canvas_set_clip_rect().

2008-10-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.h: add integer x_pos member to remember
	the x cursor position when moving up and down across shorter
	lines.

	* app/tools/picmantexttool.c (picman_text_tool_key_press): implement
	moving the cursor up and down. The x_pos probably needs to be
	reset in a few more places but it seems to work pretty nicely
	already.

2008-10-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: handle Tab, some more cleanup.

2008-10-26  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout-render.c (picman_text_layout_render_flags):
	formatting.

2008-10-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: more cleanup, mostly formatting.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Clamp Grain Extract,
	Grain Merge and Divide.

2008-10-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c: some formatting cleanup.

	* app/tools/picmanrectangletool.c: add one space.

	* app/actions/text-tool-actions.c: look at GDK_SELECTION_CLIPBOARD,
	not PRIMARY, to set the sensitivity of "Paste".

2008-10-26  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.[ch]: some general formatting cleanup.

	(picman_text_tool_key_press): implement ctrl-moving the cursor by
	words, handle Delete.

	(picman_text_tool_delete_text): add boolean "backspace" parameter
	and delete forward when it's FALSE.

	* app/actions/text-tool-commands.c: pass an arbitrary TRUE to
	picman_text_tool_delete_text() (it's not used because when called
	from here, there is always a selection).

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Remove braces in
	formulas, makes everything look cleaner.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Clamp Addition and
	Subtract so that we acheieve consistent blending results. Also,
	our Addition is fine, it is the formula for 'plus' in the SVG 1.2
	draft that is wrong as far as I can see.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Continue the quest of
	overviewable and readable blend formulas. The macro now expands to
	entire case-statements.

2008-10-26  Michael Natterer  <mitch@picman.org>

	Merge on-canvas GSoC project:

	* configure.in: check for pangocairo.

	* app/Makefile.am
	* app/text/Makefile.am: add its CFLAGS and LIBS.

	* app/text/picmantext-bitmap.[ch]
	* app/text/picmantext-private.h
	* app/text/picmantext-vectors.[ch]
	* app/text/picmantextlayer.c
	* app/text/picmantextlayout-render.c
	* app/text/picmantextlayout.c: port to pangocairo.

	* menus/Makefile.am
	* menus/text-tool-menu.xml
	* app/menus/menus.c
	* app/actions/Makefile.am
	* app/actions/actions.c
	* app/actions/text-tool-actions.[ch]
	* app/actions/text-tool-commands.[ch]: add a context menu for the
	text tool similar to GtkEntry's context menu.

	* app/tools/picmanrectangletool.[ch]: add "narrow-mode" property.

	* app/tools/picmantextoptions.[ch]
	* app/widgets/picmantexteditor.[ch]: take a text buffer for the
	standalone text editor window instead of creating one internally.

	* app/tools/picmantexttool.[ch]: all the new wonderful on-canvas
	text editing logic. Wheee!

2008-10-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmantool.c (picman_tool_get_popup)
	* app/tools/tool_manager.c (tool_manager_get_popup_active): added
	missing return value.

2008-10-26  Michael Natterer  <mitch@picman.org>

	Add some infrastructure for the on-canvas text editing GSoC
	project:

	* app/tools/picmantoolcontrol.[ch]: add boolean wants_all_key_events
	member and API to set and get it.

	* app/tools/picmantool.[ch]: add PicmanTool::get_popup() which returns
	the tool's context menu if it has one, or NULL otherwise.

	* app/tools/tool_manager.[ch]: add tool_manager_get_popup_active()
	wrapper.

	* app/display/picmandisplayshell-callbacks.c: check if the tool has
	a popup menu and show it instead of the usual right-click menu.

	Also call the tool's key_press() unconditionally if it wants all
	key events, but this code needs more thinking.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Increase readability by
	introducing short aliases.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: For blend modes with
	conditions, fix so that the conditions are per color
	channel. Acheived by introducing a nice little preprocessor macro.

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Enable the [0..1]
	clamping of the output for Dodge and Burn. Without the clamping
	one gets inconsistent results when blending together identical
	layers but with different opacities. Maybe we should make the
	clamping configurable and introduce a HDR compositing mode or
	something?

2008-10-26  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Implemented Grain
	Extract and Grain Merge. Also corrected the formula for Divide.

	Works the same for 100% opaque layers:
	 o Grain Extract
	 o Grain Merge

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Implement a bunch of
	layer modes. Use the exact SVG 1.2 formula for layer modes that
	have a counterpart in SVG 1.2. Don't clamp the result to [0..1]
	for Dodge and Burn though as we don't need to. Maybe we *should*
	clamp from a compositing point of view, I'm not sure. Also
	reformat the code a bit for readability.

	Keep in mind that we now treat the opacity of all layers the same
	indepentant of the layer mode. That is why most of the new
	implementations doesn't work the same as the legacy ones when
	transparency is involved, only when the layers are completely
	opaque. Another important property for all layer modes implemented
	below is that compositing onto complete transparency gives the
	same result as if the layer would have been in Normal blending
	mode.

	The status of the new layer mode implementations compared to the
	legacy implementations is as follows:

	Completely works the same:
	 o Behind

	Works the same for 100% opaque layers:
	 o Multiply
	 o Screen
	 o Difference
	 o Darken
	 o Lighten
	 o Dodge
	 o Burn
	 o Hard Light
	 o Subtract
	 o Divide

	Works different but similar:
	 o Overlay

	Work in progress:
	 o Soft Light

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationpointlayermode.c: Completed the rename
	with picman:layer-mode -> picman:point-layer-mode and also did some
	formating.

	* app/core/picmanlayer.c: Changed accordingly.

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	* plug-ins/file-psd/psd-save.c
	* plug-ins/file-psd/psd-util.c: Add support for reading/writing
	PSDs with the Linear Dodge layer mode which is the same as PICMANs
	Addition layer mode.

2008-10-25  Michael Natterer  <mitch@picman.org>

	Bug 557870 – "Qmask" message popping up here and there

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): use
	picman_viewable_get_description() instead of picman_object_get_name()
	for displaying the active drawable's name so the quick mask and
	the floating selection have the same names as in the
	layers/channels dialogs.

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationlayermode.[ch]: Rename to

	* app/gegl/picmanoperationpointlayermode.[ch]: so that we can later
	create a common PicmanOperationLayerMode class/interface for
	non-point layer modes like PicmanOperationDissolveLayerMode.

	* app/gegl/Makefile.am
	* app/gegl/picman-gegl.c
	* app/gegl/gegl-types.h: Adjust accordingly.

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	Instead of having one GEGL operation per layer mode, make
	PicmanOperationLayerMode instantiable and add a PicmanLayerModeEffects
	property to it that we check in ::process() to blend pixels
	together.

	* app/gegl/picmanoperationlayermode.[ch]: Do the change described
	above. Currently only Normal and Addition are implemented. Normal
	so that we don't need a special case for the gegl:normal op. Also,
	the Dissolve layer mode is not a point op and needs to be
	implemented elsewhere.

	* app/gegl/picmanoperation*mode.c: Removed.

	* app/gegl/picman-gegl-utils.[ch]: Removed
	picman_layer_mode_to_gegl_operation().

	* app/core/picmanlayer.c

	* app/gegl/Makefile.am
	* app/gegl/picman-gegl.c: Adapt.

2008-10-25  Michael Natterer  <mitch@picman.org>

	Merge a modified and enhanced patch from the vector layer branch:

	* app/core/picmandrawable-stroke.[ch]: add new public API
	picman_drawable_fill_boundary() and picman_drawable_fill_vectors().

	Split the internal code up so that there are functions which turn
	the BoundSegs and PicmanVectors into a PicmanScanConvert and changed
	picman_drawable_stroke_scan_convert() so it can either fill the
	shape or stroke it.

2008-10-25  Michael Natterer  <mitch@picman.org>

	More merging from SOC 2006's vector layer branch:

	* app/core/picmanitem.[ch]: add "gboolean push_undo" to
	PicmanItem::stroke().

	* app/core/picmandrawable-stroke.[ch]
	* app/paint/picmanpaintcore-stroke.[ch]
	* app/paint/picmanpaintcore.[ch] (picman_paint_core_finish): add
	"push_undo" parameters here too.

	* app/actions/select-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanchannel.c
	* app/core/picmanselection.c
	* app/dialogs/stroke-dialog.c
	* app/tools/picmanpainttool.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/paths.pdb: pass TRUE all over the place.

	* app/pdb/edit-cmds.c
	* app/pdb/paint-tools-cmds.c
	* app/pdb/paths-cmds.c: regenerated.

2008-10-25  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationlayermode.c: Make layer modes work on
	premultiplied data. This makes compositing 40% faster on my test
	image with 10 interlaced Normal and Addition mode layers.

	* app/gegl/picmanoperationadditionmode.c: Switch to the
	premultiplied algorithm and remove the experimental ones. The new
	Addition mode has two important differences over the legacy
	Addition mode:

	 o Addition mode now really is commutative as the PICMAN
	   documentation says (this isn't the case for the legacy Addition
	   mode implementation).

	 o Layers in Addition mode are just as opaque as Normal
	   layers. That is, their effect on the composite alpha channel is
	   the same. For discussion, refer to bug #387449.

2008-10-25  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintoptions.h: formatting.

2008-10-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_parent_notify): bail out if
	the notification is not about one of our own properties
	(but from a subclass).

2008-10-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanstrokeoptions.[ch]: add "gboolean use_context_color"
	parameter to picman_stroke_options_new() and set the passed context
	as parent of the new options only if it's TRUE. Also fixed the
	PicmanConfig::duplicate() implementation to really duplicate the
	object and not just return an object containing default values.

	* app/core/picmanfilloptions.[ch]: add picman_fill_options_new().

	* app/actions/select-commands.c
	* app/dialogs/stroke-dialog.c
	* app/actions/vectors-commands.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paths.pdb: pass TRUE to picman_stroke_options_new().

	* app/pdb/edit-cmds.c
	* app/pdb/paths-cmds.c: regenerated.

2008-10-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanfilloptions.[ch]: add non-serializable properties
	pattern-view-type and pattern-view-size which are used only by the
	new UI below.

	* app/widgets/picmanfilleditor.[ch]: added boolean edit-context
	property. If TRUE, add widgets to edit the context's foreground and
	pattern. Add "edit_context" parameter to picman_fill_editor_new().

	* app/widgets/picmanstrokeeditor.[ch]: add the same parameter here.

	* app/widgets/picmanwidgets-utils.[ch]: add picman_enum_radio_box_add()
	which does the same as the existing picman_enum_radio_frame_add().

	* app/dialogs/stroke-dialog.c: pass FALSE for "edit_context"
	because this dialog takes its foreground and pattern from the user
	context and doesn't need it's own GUI for them.

2008-10-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanfilleditor.[ch]: new widget factored out of
	PicmanStrokeEditor.

	* app/widgets/picmanstrokeeditor.[ch]: derive from PicmanFillEditor
	and remove UI for the properties of PicmanFillOptions.

2008-10-24  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanstrokedesc.[ch]: remove this mis-engineered
	abstraction...

	* app/core/picmanstrokeoptions.[ch]: ...and add its properties and
	API here.

	* app/core/picmanitem.[ch]: PicmanItem::stroke() take a
	PicmanStrokeOptions instead of a PicmanStrokeDesc.

	* app/core/picmanchannel.c
	* app/core/picmanselection.c
	* app/vectors/picmanvectors.c
	* app/actions/select-commands.c
	* app/actions/vectors-commands.c
	* app/dialogs/stroke-dialog.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paths.pdb: changed accordingly.

	* app/pdb/edit-cmds.c
	* app/pdb/paths-cmds.c: regenerated.

2008-10-24  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c (picman_dialog_factories_toggle):
	to be on the safe side, always show hidden dialogs when the Tab
	key is used. It should not be possible to get a Tab key-press
	while all displays are iconified, but you never know ...

2008-10-24  Sven Neumann  <sven@picman.org>

	Bug 556896 – Dialogs don't get minimized with single image window

	* app/widgets/picmandialogfactory.[ch]: renamed the new methods to
	picman_dialog_factories_{show|hide}_with_display().
	Remember if the dialogs were hidden using
	picman_dialog_factories_hide_with_display() or using
	picman_dialog_factories_toggle() and keep this into account when
	making them visible again. This ensures that dialogs that were
	hidden using the Tab key won't be shown when the image window is
	uniconified.

	* app/display/picmandisplayshell.c
	(picman_display_shell_window_state_event): changed accordingly.

2008-10-24  Michael Natterer  <mitch@picman.org>

	Another merge from the vector layer branch:

	* app/core/picmanstrokedesc.c (picman_stroke_desc_new): make sure
	each stroke desc always has PicmanPaintInfo.

2008-10-24  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c: For alpha compositing
	consistency, all layers should affect alpha in the same way
	independent of layer mode. Replace the compositing algorithm with
	a version without the flaws discovered so far in the previous
	ones. Don't use it yet though as it requires premultiplied data.

2008-10-24  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-region.c (scale): use the inverse of the
	scale factor so that we can multiply instead of dividing in the
	loops.

2008-10-23  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: rename PicmanStrokeStyle to PicmanFillStyle.

	* app/core/picmanfilloptions.[ch]
	* app/core/picmandrawable-stroke.c
	(picman_drawable_stroke_scan_convert): changed accordingly.

2008-10-23  Michael Natterer  <mitch@picman.org>

	Merge a part of SOC 2006's vector layer branch:

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanfilloptions.[ch]: new PicmanContext subclass factored
	out of PicmanStrokeOptions. Has "style" and "antialias" properties.

	* app/core/picmanstrokeoptions.[ch]: derive from PicmanFillOptions
	and remove said properties.

	* app/core/picmandrawable-stroke.c
	(picman_drawable_stroke_scan_convert): changed accordingly.

2008-10-23  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginprocframe.c
	(picman_plug_in_proc_frame_dispose): set proc_frame->procedure to
	NULL *after* calling picman_plug_in_cleanup(). Fixes the crash on
	windows in bug #557061 (but not the bug).

2008-10-23  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.h: don't #include
	"libpicmanwidgets/picmanwidgets.h".

	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell-scale.c
	* app/tools/picmaneditselectiontool.c: include it here.

2008-10-23  Sven Neumann  <sven@picman.org>

	Bug 556896 – Dialogs don't get minimized with single image window

	* app/display/picmandisplay-foreach.[ch]: added utility function to
	get the number of visible (not withdrawn or iconified) displays.

	* app/widgets/picmandialogfactory.[ch]: added functions to hide and
	show the dock windows. Changed picman_dialog_factories_toggle() to
	use the new functions.

	* app/display/picmandisplayshell.c
	(picman_display_shell_window_state_event): hide the docks if the
	last display is iconified. Unhide them if a display is
	uniconified. Probably needs more work ...

2008-10-23  Sven Neumann  <sven@picman.org>

	* configure.in: removed check for Carbon and added a test for the
	target OS being Darwin instead.

	* app/config/picmanguiconfig.c: use PLATFORM_OSX instead of
	HAVE_CARBON to determine the default "web-browser" command.

2008-10-22  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-preview.c (print_preview_leave_notify_event):
	check the crossing mode and don't unset the "inside" flag when the
	event is caused by a pointer grab/ungrab.

2008-10-22  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 556804 – Zoom drop down doesn't update

	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-callbacks.c: Fix calls to
	picman_display_shell_scaled() when Resize window on zoom is enabled.

2008-10-22  Sven Neumann  <sven@picman.org>

	Bug 524615 – Print not to scale

	* plug-ins/print/print.c: set the unit for dimensions on the Cairo
	context used for printing to GTK_UNIT_PIXELS.

	* plug-ins/print/print-draw-page.c (print_draw_page): changed the
	Cairo scale factors accordingly. Seems to fix printing on Windows.

2008-10-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprogressbox.c: set box->progress to NULL in
	destroy() and check for progress being NULL in various places so
	we don't crash on API calls after the widget is destroyed.

2008-10-22  Sven Neumann  <sven@picman.org>

	Bug 555246 – picman crashes when a file is opened while a preview is
	generating

	* app/widgets/picmanthumbbox.c: set box->progress to NULL in
	destroy() and check for progress being NULL in various places so
	we don't crash on API calls after the widget is destroyed.

2008-10-22  Sven Neumann  <sven@picman.org>

	Bug 556741 – Alpha layer automatically added (in psd format) but
	not desired

	* plug-ins/file-psd/psd-save.c: applied patch from Dennis Ranke
	that flattens the projection for indexed images.

2008-10-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c
	* app/plug-in/picmanplugin-progress.c: formatting.

2008-10-21  Michael Natterer  <mitch@picman.org>

	Bug 555246 – picman crashes when a file is opened while a preview is
	generating

	* app/widgets/picmanfiledialog.c: set dialog->progress to NULL in
	destroy() and check for progress being NULL in various places so
	we don't crash on API calls after the widget is destroyed.

2008-10-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmangegltool.c (picman_param_spec_duplicate):
	GEGL_IS_PARAM_SPEC_PATH() became GEGL_IS_PARAM_SPEC_FILE_PATH()
	in GEGL 0.0.21.

2008-10-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmangegltool.c (picman_gegl_tool_dialog): for the
	combo-box, strip known prefixes from the GEGL operation names and
	use icons instead.

2008-10-21  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c (file_open_recent_cmd_callback): ref
	the PicmanDisplay and PicmanImageFile objects while holding a
	reference to them. Fixes a potential crash if PICMAN is closed while
	the image is being loaded.

2008-10-20  Martin Nordholts  <martinn@svn.gnome.org>

	* menus/image-menu.xml.in
	* app/actions/debug-actions.c
	* app/actions/debug-commands.c: Create dump and non-dump
	groups. Also added a tooltip to the Benchmark Projection action
	and removed report of number of layers.

2008-10-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanerrorconsole.c (picman_error_console_init): don't
	make the font size even smaller. We already use a smaller font in
	the dock windows.

2008-10-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmangradienteditor.c (view_events) (control_events):
	use pointer coordinates from the passed event instead of calling
	gtk_widget_get_pointer().

2008-10-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/bump-map.c (dialog_preview_events): use pointer
	coordinates from the passed event instead of calling
	gtk_widget_get_pointer().

2008-10-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c: set the OK and Reset button insensitive
	until the user has defined a deformation to apply. Cleaned up
	event handling.

2008-10-20  David Odin  <dindinx@picman.org>

	* plug-ins/common/*.c: untabified

2008-10-19  Michael Natterer  <mitch@picman.org>

	* app/actions/debug-actions.c
	* app/actions/debug-commands.[ch]
	* menus/image-menu.xml.in: rename
	debug-dump-projection-benchmarking to debug-benchmark-projection.

2008-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/xmp-parse.c: use GSlice to allocate structs.

2008-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/xmp-encode.c
	* plug-ins/metadata/xmp-parse.c

	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/xmpdump.c: removal of unused includes and
	other minor cleanups.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c: Remove local channel
	offset defines.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperation*mode.c: Refer to the input as 'in'
	instead of 'src', the layer as 'layer' instead of 'aux', and the
	result as 'out' instead of 'dest'.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/base/base-types.h: Rename the convenient channel offset
	defines from CHANNEL_PIX to CHANNEL as this increases readability.

	* app/base/color-balance.c
	* app/base/colorize.c
	* app/base/desaturate.c
	* app/base/hue-saturation.c
	* app/base/siox.c
	* app/base/threshold.c

	* app/core/picman-edit.c
	* app/core/picman-transform-region.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-convert.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage.c
	* app/core/picmanpalette-import.c
	* app/core/picmanpickable.c

	* app/gegl/picmanoperation*mode.c
	* app/gegl/picmanoperationcolorbalance.c
	* app/gegl/picmanoperationcolorize.c
	* app/gegl/picmanoperationhuesaturation.c
	* app/gegl/picmanoperationlevels.c
	* app/gegl/picmanoperationposterize.c
	* app/gegl/picmanoperationthreshold.c

	* app/paint-funcs/subsample-region.c

	* app/paint/picmanclone.c
	* app/paint/picmanpaintbrush.c

	* app/widgets/picmanviewrenderer.c: Adapt.

2008-10-19  Sven Neumann  <sven@picman.org>

	Bug 493778 – metadata plug-in crashes on some images

	* plug-ins/metadata/xmp-encode.c (gen_property): introduced a
	utility function to create XML elements. Deal gracefully with NULL
	and empty values. Does not fix the crash, but fixes a warning that
	has been reported in the same bug report.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/base/base-types.h: There is nothing magic or ugly about the
	convenient defines, remove comments saying so.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c: Refer to the input as 'in'
	instead of 'src', the layer as 'layer' instead of 'aux', and the
	result as 'out' instead of 'dest'. The old terminology clashes
	with at least the SVG 1.2 compositing terminology [1] and there is
	no reason for creating confusion.

	[1] http://www.w3.org/TR/2004/WD-SVG12-20041027/rendering.html

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c: Use local variants of
	channel offset defines, namely RED instead of RED_PIX etc, to
	increase readability.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* app/actions/debug-commands.c
	(debug_dump_projection_benchmarking_cmd_callback): In addition to
	priting how long it takes to validate the projection, also print
	the number of layers in the image.

2008-10-19  Martin Nordholts  <martinn@svn.gnome.org>

	* menus/image-menu.xml.in
	* app/actions/debug-actions.c
	* app/actions/debug-commands.[ch]: Added a 'Dump Projection
	Benchmarking' item to the Debug Menu so that we can test how
	different GEGL graph setups affect performance.

2008-10-19  Michael Natterer  <mitch@picman.org>

	* configure.in: add -Wmissing-format-attribute to CFLAGS.

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_object.h
	* plug-ins/imagemap/imap_source.c
	* plug-ins/imagemap/imap_statusbar.h: add G_GNUC_PRINTF().

2008-10-18  Michael Natterer  <mitch@picman.org>

	* configure.in: add -Wstrict-prototypes to CFLAGS.

2008-10-18  Sven Neumann  <sven@picman.org>

	Applied patch from Alexia Death as attached to bug #471344:

	* app/core/Makefile.am
	* app/core/picmancoords-interpolate.[ch]: new files with
	interpolation code taken from ...

	* app/vectors/picmanbezierstroke.c: ... here.

	* app/Makefile.am (AM_LDFLAGS): make it link.

2008-10-17  Sven Neumann  <sven@picman.org>

	* plug-ins/file-psd/psd-save.c (xfwrite): fixed handling of empty
	strings. Don't quit silently, write an error message to stderr at
	least.

2008-10-17  Sven Neumann  <sven@picman.org>

	* app/core/picman.[ch]: added signal Picman::image-opened to announce
	that an image has been loaded and a display was created for it.

	* app/file/file-open.c (file_open_with_proc_and_display): call
	picman_image_opened() to emit the new signal.

	* app/gui/dbus-service.xml
	* app/gui/picmandbusservice.[ch]: propagate the 'opened' signal to
	listeners of the "org.picman.PICMAN.UI" DBus service.

	* app/gui/gui-unique.c: formatting.

2008-10-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrenderervectors.c
	(picman_view_renderer_vectors_draw): just some cleanup.

2008-10-16  Sven Neumann  <sven@picman.org>

	Bug 556248 – Scaling gives 'jagged' edges

	* app/paint-funcs/scale-region.c (scale): calculate pixel
	contributions based on pixel centers, not on pixel origins.

2008-10-15  Jakub Steiner <jimmac@picman.org>

	* themes/Default/images/stock-gegl.svg:
	* themes/Default/images/stock-gegl-22.svg:
	* themes/Default/images/stock-gegl-22.png: remove white from the
	shadow to render correctly on dark backgrounds.

2008-10-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: reindent the list of PDB types and remove
	the unused and deprecated types "boundary" and "region". Also
	remove "status" because it is unused (and unneeded and
	unimplemented).

2008-10-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmangegltool.c (picman_gegl_tool_operation_blacklisted):
	add the gegl: prefix here too.

	(picman_gegl_tool_get_config): canonicalize the type name of the
	created config class or we crash.

2008-10-14  Michael Natterer  <mitch@picman.org>

	* configure.in
	* app/sanity.c: require GEGL >= 0.0.21.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-brightness-contrast.c
	* app/core/picmandrawable-invert.c
	* app/core/picmanimage.c
	* app/core/picmanimagemap.c
	* app/core/picmanlayer.c
	* app/gegl/picman-gegl-utils.c
	* app/tools/picmanbrightnesscontrasttool.c: GEGL operation names
	are now "gegl:"-prefixed.

	* app/core/picmanimagemap.c: set the node's "dont-cache" property
	unconditionally.

2008-10-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c (picman_dialog_factory_add_dialog):
	let new docks appear at the pointer position.

2008-10-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: add a default implementation of
	PicmanDrawable::get_node() which contains a layer mode node.
	Implement PicmanItem::visibility_changed() and turn the node into a
	nop when the drawable is invisible. Added public function
	picman_drawable_get_mode_node() so subclasses can plug stuff
	into its "aux" pad.

	* app/core/picmanlayer.[ch]
	* app/core/picmanchannel.[ch]: changed accordingly (remove
	duplicated member and code that is now in PicmanDrawable).

2008-10-14  Michael Natterer  <mitch@picman.org>

	* app/gegl/picman-gegl-utils.[ch]: remove function
	picman_bpp_to_babl_format_linear() and add "gboolean linear"
	parameter to picman_bpp_to_babl_format().

	* app/gegl/picmanoperationtilesink.c (process)
	* app/gegl/picmanoperationtilesource.c (prepare): simply pass
	self->linear to above changed function instead of selecting
	between the two old functions.

2008-10-14  Sven Neumann  <sven@picman.org>

	* app/signals.c (picman_init_signal_handlers): comments.

2008-10-13  Sven Neumann  <sven@picman.org>

	Bug 556182 – Could you please explain a few strings [I18N]

	* plug-ins/pypicman/plug-ins/py-slice.py: added translator comments.

2008-10-13  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/signals.[ch]: new files with code split out of main.c.

	* app/main.c: changed accordingly.

2008-10-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c
	(picman_operation_addition_mode_process): Update with a new version
	that is the best known so far (maybe it's even correct?).

2008-10-13  Sven Neumann  <sven@picman.org>

	Bug 547967 – Improve app/paint-funcs/ maintainability

	Applied patch from Luidnel Maignan that splits the legacy code for
	layer modes into new files.

	* app/paint-funcs/Makefile.am
	* app/paint-funcs/layer-modes.[ch]
	* app/paint-funcs/paint-funcs-utils.h: new files with code taken
	from ...

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c: ... these two files.

2008-10-13  Michael Natterer  <mitch@picman.org>

	* app/gegl/picman-gegl-utils.c (picman_layer_mode_to_gegl_operation):
	remove warning because the missing layer modes are now
	"implemented", ha ha.

2008-10-12  Michael Natterer  <mitch@picman.org>

	* app/gegl/picmanoperationpointcomposer.[ch]: renamed this class...

	* app/gegl/picmanoperationlayermode.[ch]: ...to this and add
	an own process() virtual function so we are free to hack even
	more badly in order to support legacy layer modes and proper
	ones which do meaningful things to alpha. Simply redirect
	GeglOperationPointComposer's compose() calls to our own vfunc
	for now.

	* app/gegl/gegl-types.h
	* app/gegl/Makefile.am: changed accordingly.

	* app/gegl/picmanoperation*mode.[ch]: changed parent class and
	implemented process() method accordingly.

2008-10-12  Michael Natterer  <mitch@picman.org>

	* app/gegl/picmanoperationadditionmode.c: commit some #if 0'ed
	experimental code.

	* app/actions/view-commands.c (view_use_gegl_cmd_callback): use
	picman_image_update(), simply exposing the shell doesn't reconstruct
	the projection.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanprojection.h: add a "use_gegl" boolean member.

	* app/core/picmanprojection-construct.c (picman_projection_construct):
	use the boolean instead of hardcoding FALSE.

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]: add a "Use GEGL" action and
	callback which sets the boolean and exposes the display.

	* menus/image-menu.xml.in: add it to the "View" menu.

2008-10-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/gegl/picmanoperationadditionmode.c
	(picman_operation_addition_mode_process): Implement this one.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/gegl/picman-gegl-utils.c (picman_layer_mode_to_gegl_operation):
	it's picman-screen-node not picman-screen_mode.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/gegl/picmanoperationpointcomposer.[ch]: add an empty abstract
	GeglOperationPointComposer subclass which can be used to hook in
	common debug or test or whatever code for below layer modes.

	* app/gegl/picmanoperation*mode.[ch]: add empty stubs of layer mode
	operations which do nothing but copying input to output.

	* app/gegl/Makefile.am
	* app/gegl/gegl-types.h: add them here and reordered things a bit.

	* app/gegl/picman-gegl.c (picman_gegl_init): register the new
	operations.

	* app/gegl/picman-gegl-utils.c (picman_layer_mode_to_gegl_operation):
	return the new operations.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/gegl/picmanoperationpointfilter.c: make it abstract.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/gegl/picman-gegl-utils.c (picman_layer_mode_to_gegl_operation):
	don't return non-existing layer modes (in fact, return "normal"
	for all modes).

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.[ch]: add a projection node and
	implement PicmanDrawable::get_node(). Reconfigure the node in
	visibility_changed(), set_color(), set_opacity() and
	set_show_masked().

	* app/core/picmanimage.c (picman_image_get_graph): enable code that
	projects the channels stack on top of the layer stack.

	* app/core/picmanprojection-construct.c: remove the call to
	picman_projection_construct_channels() from the GEGL code path. Also
	don't touch proj->construct_flag.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_get_node): remove obsolete
	assertion and redundant cast.

2008-10-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.c: add PicmanContainer::add()
	implementation, it's needed after all even though everybody uses
	picman_container_insert() on drawable stacks.

	(picman_drawable_stack_remove_node): no need to have a special check
	for newly added nodes, this can't happen any more now that we have
	an add() impl.

	(picman_drawable_stack_get_graph): free the reverse list.

2008-10-11  Michael Natterer  <mitch@picman.org>

	Fix old bug in the PicmanContainer implementation that wasn't
	visible before the drawable stack completly b0rked when removing
	the second-last item:

	* app/core/picmancontainer.c: add default implementations of ::add()
	and ::remove() and update container->num_children there instead of
	in the picman_container_add() and _remove() wrapper functions.
	This way not only external callbacks connected to the "add" and
	"remove" signals are called with the correct num_children, also
	implemtations of ::add() and ::remove() in subclass have the right
	number available before/after upchaining. Add paranoia code to the
	wrapper functions which check if the subclass reall chains up.

	* app/core/picmanlist.c: chain up in add() and remove().

2008-10-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmandockseparator.c (picman_dock_separator_drag_drop):
	Initialize 'index'.

2008-10-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmandockseparator.c (picman_dock_separator_new): Add a
	GtkAnchorType member to PicmanDockSeparator that specifies where a
	dropped dockable shall be inserted.

	(picman_dock_separator_drag_drop): Get rid of the ugly hack where
	the role of a given separator was based on its position as a child
	in its container. Simply decide what role the separator has by
	loooking at its anchor-member.

	* app/widgets/picmandock.c (picman_dock_init)
	(picman_dock_add_book): Give the PicmanDockSeparators their
	appropriate roles directly at their construction.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.c
	(picman_drawable_stack_add_node)
	(picman_drawable_stack_remove_node): simplify by getting rid of code
	duplication.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawablestack.[ch]: move all the code that creates
	a graph of drawables and all adding/removing/reordering code from
	PicmanImage to this file.

	* app/core/picmanimage.c: remove the code here and use the layer
	stack's subgraph instead. Add #if 0'ed code that blends the
	channels on top of that but that doesn't work because channels
	don't provide nodes yet.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h
	* app/core/Makefile.am
	* app/core/picmandrawablestack.[ch]: new PicmanList subclass stub
	which will manage the subgraphs of layers and channels and is also
	the first step towards layer tree.

	* app/core/picmanimage.c (picman_image_init): keep the layers and
	channels in PicmanDrawableStacks instead of plain PicmanLists.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.[ch]: add virtual function
	PicmanDrawable::get_node() which returns a node to be plugged into
	the projection.

	* app/core/picmanlayer.[ch]: remove public get_node() api and
	implement the virtual function instead.

	* app/core/picmanimage.c: changed accordingly.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmovetool.c (picman_move_tool_button_release): flush
	the image after setting active items back from temporarily
	selected ones. Fixes menu item sensitivity.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c: implement PicmanItem::visibility-changed
	and turn the layer's node into a nop when the layer is invisible.

	(picman_layer_get_node): connect the stuff to a nop here too for
	invisible layers.

2008-10-10  Michael Natterer  <mitch@picman.org>

	Bug 554983 – Layers Projection using GEGL

	First projection using GEGL, wheeeee. Disabled by default because
	it doesn't work with floating selection (and will not, FS
	refactoring is in the queue).

	* app/core/picmanimage.[ch]: add picman_image_get_graph() which
	returns a GeglNode representing the image's projection.

	(picman_image_add_layer_node)
	(picman_image_remove_layer_node): new utility functions to add and
	remove layer nodes to/from the graph.

	(picman_image_add_layer)
	(picman_image_remove_layer)
	(picman_image_position_layer): call them to keep the graph up to date.

	* app/core/picmandrawable.c (picman_drawable_real_update): invalidate
	the source node.

	* app/core/picmanprojection.[ch]: keep a projection graph around and
	add picman_projection_get_sink_node() which returns the node that
	writes to the projection tiles.

	* app/core/picmanprojection-construct.c: add
	picman_projection_construct_gegl() which is a few-liner that uses a
	GeglProcessor to run the projection graph.

	(picman_projection_construct): call the new function (disabled by
	default).

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: add new functions
	picman_image_get_layer_by_index(), _channel_by_index() and
	_vectors_by_index().

	* app/core/picmanprojection-construct.c
	* app/display/picmandisplayshell-layer-select.c
	* app/xcf/xcf-load.c: use them instead of looking the items up
	in image->container and casting the return value.

2008-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_translate)
	(picman_layer_get_node): the "shift" operation's x and y properties
	are doubles not ints.

	(picman_layer_apply_mask): properly disconnect the mask node.

	(picman_layer_set_opacity): the opacity node has a "value" property,
	not "opacity".

2008-10-09  Michael Natterer  <mitch@picman.org>

	Address Bug 554983 – Layers Projection using GEGL

	* app/gegl/picman-gegl-utils.[ch]: add (imcomplete) function
	picman_layer_mode_to_gegl_operation() from bug #554983.

	* app/core/picmandrawable.[ch]: add picman_drawable_get_source_node()
	which returns a PicmanOperationTileSource for the drawable's
	tiles.

	(picman_drawable_real_set_tiles)
	(picman_drawable_configure): set the node's "tiles" property.

	* app/core/picmanlayer.[ch]: add picman_layer_get_node() which returns
	a GeglNode with proxy "input" and "output" pads to be plugged
	into the projection graph. The node has children for opacity,
	mask, layer mode and layer offset.

	(picman_layer_translate)
	(picman_layer_add_mask)
	(picman_layer_apply_mask)
	(picman_layer_set_opacity)
	(picman_layer_set_mode): reconfigure the respective nodes.

	* app/core/picmanimage.[ch]: keep a "graph" node around and destroy
	it in finalize(). Not even a stub, just a silly GEGL dependency.

2008-10-09  Michael Natterer  <mitch@picman.org>

	Add GEGL_CFLAGS and #includes as if picmandrawable.h and picmanimage.h
	had a GEGL dependency (they will have in the next commit, but I
	wanted to keep the commit separate).

	* app/dialogs/Makefile.am
	* app/file/Makefile.am
	* app/gui/Makefile.am
	* app/menus/Makefile.am
	* app/paint/Makefile.am
	* app/plug-in/Makefile.am
	* app/text/Makefile.am
	* app/vectors/Makefile.am
	* app/widgets/Makefile.am
	* app/xcf/Makefile.am: add GEGL_CFLAGS.

	* app/actions/*.c
	* app/core/*.c
	* app/dialogs/*.c
	* app/display/*.c
	* app/file/*.c
	* app/gui/*.c
	* app/menus/*.c
	* app/paint/*.c
	* app/pdb/picmanpdb-utils.c
	* app/pdb/picmanprocedure.c
	* app/plug-in/*.c
	* app/text/*.c
	* app/tools/*.c
	* app/vectors/*.c
	* app/widgets/*.c
	* app/xcf/*.c: add <gegl.h> or replace <glib-object.h> by <gegl.h>
	to all files which include a drawable subclass or picmanimage.h

	* tools/pdbgen/app.pl: include <gegl.h> instead of <glib-object.h>
	in all generated files.

	* app/pdb/*-cmds.c: regenerated.

	* data/images/picman-splash.png: the goat is still sleeping.
	By Aurore Derriennic.

2008-10-09  Michael Natterer  <mitch@picman.org>

	Remove the last code duplication from the undo system (or if not
	the last then at least the most ugly):

	* app/core/picmanimage.[ch] (picman_image_add_layer,channel,vectors):
	add "gboolean push_undo" parameter and add the item without
	touching undo if it's TRUE. Changed assertions from
	g_object_is_floating() to !picman_item_is_attached() so they also
	take items from the undo stack and not only newly created ones.

	(picman_image_remove_layer,channel,vectors): add "push_undo"
	parameter here too. Also add a "new_active" parameter where an
	optional new active item can be passed.

	(picman_image_remove_layer,channel): these functions must not be
	called with push_undo=FALSE and a floating selection attached to
	the layer/channel. This can't currently happen; added warnings in
	case other code is changed and makes it happen anyway.

	* app/core/picmanchannelundo.c
	* app/core/picmanlayerundo.c
	* app/vectors/picmanvectorsundo.c: use above functions to add/remove
	items instead of duplicating (parts of) their code. Pass
	push_undo=FALSE and the previously active item to the remove()
	functions.

	* app/actions/channels-commands.c
	* app/actions/edit-commands.c
	* app/actions/layers-commands.c
	* app/actions/vectors-commands.c
	* app/core/picman-edit.c
	* app/core/picmanchannelundo.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-quick-mask.c
	* app/core/picmanimage-scale.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayerundo.c
	* app/core/picmanselection.c
	* app/core/picmantemplate.c
	* app/display/picmandisplayshell-dnd.c
	* app/text/picmantext-compat.c
	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c
	* app/vectors/picmanvectors-import.c
	* app/vectors/picmanvectorsundo.c
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmanvectorstreeview.c
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/paths.pdb: changed accordingly (pass TRUE
	unless it's a new image like when loading and XCF file).

	* app/pdb/image-cmds.c
	* app/pdb/paths-cmds.c: regenerated.

2008-10-09  Sven Neumann  <sven@picman.org>

	* data/images/Makefile.am
	* data/images/picman-devel-logo.png: added 128x128 version of
	wilber-devel.png.

	* app/dialogs/about-dialog.c (about_dialog_load_logo): use
	picman-devel-logo.png for unstable releasees.

2008-10-09  Sven Neumann  <sven@picman.org>

	Bug 555697 – build fails if configured with --without-libjpeg

	* plug-ins/Makefile.am: applied patch from Simon Zilliken that
	disables the build of the PSD plug-in if JPEG support is disabled.

2008-10-09  Michael Natterer  <mitch@picman.org>

	Bug 134956 – Curves tool doesn't save free curves

	* app/core/picmanmarshal.list
	* app/widgets/picmansettingsbox.[ch]: add signal "file-dialog-setup"
	and emit it when the export/import file chooser is fully
	constructed. Callbacks can then do additional things to the
	dialog, like adding custom buttons.

	* app/tools/picmancurvestool.h
	* app/tools/picmanlevelstool.h: add boolean member
	"export_old_format".

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c (picman_*_tool_dialog): connect to
	the settings box' "file-dialog-setup".

	(picman_*_tool_export_setup): new callback which adds a toggle to
	the file choosers that allows to export to the old format.
	Default saving the new format, we defaulted to the old one before.

	(picman_*_tool_settings_export): check the "export_old_format"
	boolean and only save the cruft format if it is TRUE; chain up
	otherwise, which generically saves the new format.

	* app/tools/picmanlevelstool.c (picman_levels_tool_settings_import):
	add the same file format detection code as in the curves tool
	so it transparently loads old and new levels files.

2008-10-09  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.c (picman_user_install_detect_old):
	use PICMAN_MINOR_VERSION to determine the version to migrate from.

2008-10-09  Michael Natterer  <mitch@picman.org>

	* app/gegl/picmancurvesconfig.c (picman_curves_config_save_cruft):
	when saving a curve of type PICMAN_CURVE_FREE, don't use
	picman_curve_get_point() because that returns nothing for free
	curves.

	(picman_curves_config_load_cruft): reset the curve before loading it.

	* app/core/picmancurve.c (picman_curve_get_point): instead of above
	mentioned uninitialized nonsense, at least return -1,-1 for free
	curves.

2008-10-09  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am
	* tools/Makefile.am: change 2.6 to 2.7 here too.

2008-10-09  Sven Neumann  <sven@picman.org>

	* README
	* NEWS
	* configure.in: bumped version to 2.7.0 after creating a stable
	picman-2-6 branch.

2008-10-09  Sven Neumann  <sven@picman.org>

	* Made 2.6.1 release.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555587 – PSD file crashes PSD plug-in

	* plug-ins/file-psd/psd-load.c (add_merged_image): Handle
	img_a->alpha_names being NULL.

2008-10-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanruler.c: cosmetics.

2008-10-08  Michael Natterer  <mitch@picman.org>

	Quick hack I needed for debugging and which doesn't hurt:

	* tools/test-clipboard.c (test_clipboard_paste): allow to paste to
	STDOUT by passing '-' as filename.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	* plug-ins/file-psd/psd-load.c (add_layers): Decrease scope of
	comp_mode and initialize it.

2008-10-08  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 555222 – PSD Load Plugin: unsupported compression mode

	* plug-ins/file-psd/psd-load.c (add_layers): Some PSD files can
	have channels where a compression method used for the channel data
	is specified, but without any actual channel data. Handle this
	case. Fix inspired by patch from Chris Mohler.

2008-10-08  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c: use a GMutex instead of a GStaticMutex
	as the latter needs API that causes compiler warnings about
	dereferencing of type-punned pointers.

2008-10-07  Michael Natterer  <mitch@picman.org>

	Bug 555362 – picman-remote is not working properly

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_dnd_init): add the
	window itself as drop traget again so picman-remote works.

2008-10-07  Michael Natterer  <mitch@picman.org>

	* app/*/Makefile.am: reorder sections consistently. Remove
	redundant CFLAGS.

2008-10-06  Sven Neumann  <sven@picman.org>

	Bug 555280 – some gif files will not be open

	* plug-ins/common/file-gif-load.c (GetCode): be more tolerant and
	continue loading with a warning message if there are bits missing
	at the end of the file.

2008-10-06  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-region.c (scale_region): removed debug
	output.

2008-10-06  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/file-gih.c
	* plug-ins/common/file-xbm.c: setting a spin button's
	page_increment to 1 is of no use, set it to 10 instead.

2008-10-06  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-menu-path.c (menu_path_mappings): add a
	fallback mapping from <Toolbox> to <Image> so we catch really
	everything that wants to go to <Toolbox>.

2008-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_real_set_display): paranoia
	fix for hypothetical but harmful misbehavior: when setting the
	display from !=NULL to NULL, also set the image to NULL instead of
	relying on whatever obscure implicit behavior of other parts of
	PICMAN which set a new display right away or make sure the image
	goes away together with the display.

2008-10-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_add_mask): g_return_if_fail()
	on the mask's image being the same as the layer's image. The PDB
	already checks for this.

	* app/core/picmanimage.c (picman_image_add_layer,channel,vectors):
	remove calls to picman_item_set_image() because we only accept
	itmes of this image anyway.

2008-10-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin-cleanup.c
	* app/vectors/picmananchor.c: #include <glib-object.h>, not
	"glib-object.h".

2008-10-05  Michael Natterer  <mitch@picman.org>

	* app/gegl/gegl-types.h: including ourselves serves no purpose.

2008-10-05  Michael Natterer  <mitch@picman.org>

	Allow to "Open as Layers" in the empty display:

	* app/widgets/picmanfiledialog.[ch]: add member
	"gboolean open_as_layers". Rename picman_file_dialog_set_image() to
	picman_file_dialog_set_save_image() and add
	picman_file_dialog_set_open_image() which sets both the image to
	load layers into and the "open_as_layers" boolean.

	* app/dialogs/file-open-dialog.c (file_open_dialog_response): look
	at dialog->open_as_layers instead of dialog->image to decide whether
	to open as layers (that's much more obvious). Enable open as layers
	without existing image by creating the image if it doesn't exist.

	* app/actions/file-commands.c (file_open_dialog_show): add "title"
	parameter and take the uri from the image if none was passed. Use the
	new picman_file_dialog_set_open_image() instead of poking into the
	dialog struct. Change callers to pass the title and not get the
	uri from the image; instead always pass the image.

	* app/actions/file-actions.c (file_actions_update): keep
	"Open as Layers" sensitive even without image.

2008-10-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-contiguous-region.c: some formatting cleanups.

	(find_contiguous_segment): changed to return gboolean not gint.

2008-10-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanruler.c: cache the PangoLayout. Use it not
	only for drawing the numbers, but also to calculate the size
	requisition depending on the actual font size.

2008-10-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanruler.c: instead of hardcoding a size
	request, implement GtkWidget::size_request and set the size
	depending on the font-scale.

2008-10-05  Sven Neumann  <sven@picman.org>

	Bug 554890 – JPEG Save Options Dialog does not remember
	Subsampling mode

	* plug-ins/file-jpeg/jpeg.c (run): fixed problem introduced by the
	use of an enum for the subsampling factor.

2008-10-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/web-browser.c: return errors via return_vals
	instead of displaying them with g_message().

2008-10-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanruler.c: increased ruler font scale from
	X_SMALL to SMALL as it appears to be too small for many users.

	* themes/Default/gtkrc: follow that change here, but keep the
	ruler font extra small in the Small theme.

2008-10-04  Sven Neumann  <sven@picman.org>

	* plug-ins/file-jpeg/jpeg-save.c: some cleanups to the subsampling
	code; in an attempt to fix bug #555031.

2008-10-04  Sven Neumann  <sven@picman.org>

	* INSTALL: updated GTK+ requirement.

2008-10-04  Michael Natterer  <mitch@picman.org>

	* configure.in: depend on GTK+ 2.12.5 so motion history events of
	extended input devices have proper timestamps needed by paint
	tools.

2008-10-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanruler.c: make the font scale factor
	configurable in gtkrc.

	* themes/Default/gtkrc
	* themes/Small/gtkrc: for documentation, add the default value here.

2008-10-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/web-browser.c (browser_open_url): removed
	trailing whitespace and corrected error message.

2008-10-03  Hans Breuer  <hans@breuer.org>

	* plug-ins/common/web-browser.c : when ShellExecute() is failing give
	the detailed (currently intentionally untranslated) error message via
	g_message()

	* **/makefie.msc picmandefs.msc app/picmancore.def : updated
	* app/core/picmancurve.c : include <string.h> for memcmp()
	* app/gegl/picmancurvesconfig.c : include <string.h> for strcmp()

2008-10-03  Sven Neumann  <sven@picman.org>

	Bug 554966 – Picman crashes creating a new image using a template

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_update_scrollbars)
	(picman_display_shell_scale_update_rulers): bail out early if
	shell->display is NULL.

2008-10-03  Michael Natterer  <mitch@picman.org>

	Bug 554785 – Compile failure on uri-backend-libcurl

	* plug-ins/file-uri/uri-backend-libcurl.c: apply patch from Robby
	Workman which fixes the build for this file.

2008-10-03  Sven Neumann  <sven@picman.org>

	* configure.in: removed custom error message from checks for babl
	and GEGL. The default error message is a lot more helpful.

2008-10-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmangegltool.c (picman_gegl_tool_operation_blacklisted):
	add "text" to the list of blacklisted operations.

2008-10-02  Michael Natterer  <mitch@picman.org>

	Bug 554646 – Opening Help crashes PICMAN with lqr-plugin installed

	* app/widgets/picmanhelp.c (picman_help_get_help_domains): need to
	assign (*foo)[i] and not *foo[i] of a gchar** returned via return
	value location.

2008-10-02  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginprocframe.c: keep a reference to the
	proc_frame's procedure. We can't asume it's always there since it
	could be a temporary one and its plug-in might die during
	procedure execution, taking the temp_proc with it.

2008-10-02  Martin Nordholts  <martinn@svn.gnome.org>

	Bug 553534 – centering issues after image scaling and setting zoom
	to 100%

	* app/display/display-enums.h: Added a PicmanZoomFocus enum with
	'best guess', 'pointer' or 'image center' values.

	* app/display/picmandisplayshell-scale.[ch]
	(picman_display_shell_scale): Take a PicmanZoomFocus parameter and
	pass it on to

	(picman_display_shell_scale_get_zoom_focus): which returns the
	requested zoom focus point if one was given, else makes a best
	guess.

	* app/actions/view-commands.c
	* app/display/picmanstatusbar.c
	* app/display/picmannavigationeditor.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scale-dialog.c: For explicit-zoom
	commands like "zoom to 100%", always use the image center as the
	zoom focus point. For all other zooming, continue to use the
	best-guess method.

	* app/display/display-enums.c: Regenerated.

2008-10-02  Sven Neumann  <sven@picman.org>

	Bug 554898 – Compile failure on uri-backend-wget.c

	* plug-ins/file-uri/uri-backend-wget.c: removed spurious commas
	that broke the build.

2008-10-01  Sven Neumann  <sven@picman.org>

	* Makefile.am (EXTRA_DIST): added ChangeLog.pre-2-6 and NEWS.pre-2-6.

2008-10-01  Sven Neumann  <sven@picman.org>

	* tools/picmantool.c: create the target directory and intermediate
	parent directories as needed. Restores the behavior of the
	picmantool shell script.

2008-10-01  Sven Neumann  <sven@picman.org>

	* menus/Makefile.am (%.xml): added a dependency on configure.in to
	make sure that the image-menu.xml file is rebuilt when the version
	number is changed.

2008-10-01  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanplugin.c
	* app/widgets/gtkscalebutton.c: : Don't #define _GNU_SOURCE on
	Windows as it confuses newest mingw headers.

2008-10-01  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.6.1 (interface age 1).

2008-09-30  Sven Neumann  <sven@picman.org>

	* Made 2.6.0 release.
