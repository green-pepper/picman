2007-10-24  Sven Neumann  <sven@picman.org>
            Michael Natterer  <mitch@picman.org>

	* Made 2.4.0 release.

2007-10-23  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-combine.c: move variable to local scope.

	* app/core/picman-transform-resize.c: formatting.

2007-10-23  Sven Neumann  <sven@picman.org>

	* data/images/picman-splash.png: splash screen for PICMAN 2.4.

	* authors.xml: added Paul Davey, the artist of the 2.4 splash.

	* AUTHORS: regenerated.

2007-10-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c: fixed handling of the empty selection
	mask (bug #489410).

2007-10-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c: made preview windows transient to the
	plug-in dialog. Simplified "Advanced Options" dialog.

2007-10-23  Michael Natterer  <mitch@picman.org>

	* app/base/pixel-region.c (pixel_region_resize): when resizing,
	don't advance the "data" pointer of regions of contiguous data. I
	should have made this change along with my pixel region cleanup of
	2005-09-03 which sanitized pixel regions of contiguous data.
	Fixes bug #489229.

	* libpicman/picmanpixelrgn.c (picman_pixel_rgn_resize): remove the same
	code here (the removed code was dead since this function refuses
	to be called on pixel regions without a drawable).

2007-10-23  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-combine.c: formatting.

2007-10-23  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpegqual.c: Added hash value for all known
	quantization tables in order to detect transposed tables from
	rotated images or bad matches coming from different tables with
	the same sum.

2007-10-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/depthmerge.c (util_convertColorspace): fixed
	bogus for-loop.

2007-10-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpaintoptions-gui.c: changed aspect ratio of the
	wrap-box used for the "Pressure sensitivity" controls to make them
	fit better into the tool-options.

2007-10-22  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Allow one to three
	digits in octal coded characters.

2007-10-22  Sven Neumann  <sven@picman.org>

	* plug-ins/gflare/gflare.c (plugin_do_non_asupsample): fixed
	initialisation of pixel regions (bug #488845).

2007-10-22  Sven Neumann  <sven@picman.org>

	* plug-ins/gflare/gflare.c: formatting.

2007-10-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmansourcetool.[ch]: don't draw the source brush
	outline while selecting a new source location (bug #488839).

2007-10-22  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: improved display of profiles.

2007-10-22  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpegqual.c (quant_info): Updated table for Adobe
	products.  Thanks to Bart for the sample files.

2007-10-21  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c: Add comment regarding
	the safe-foreign issue.

2007-10-21  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c: Reverted changes in handling
	of string arrays to stay backwards compatible (see bug #317634).

	* plug-ins/script-fu/scripts/font-map.scm: Updated based on change
	in handling of string arrays listed above.

2007-10-21  Michael Natterer  <mitch@picman.org>

	* app/dialogs/fade-dialog.c (fade_dialog_new): revert change below.

	* app/paint-funcs/paint-funcs.c (replace_inten_pixels): also honor
	the passed opacity when there is no mask. Fixes blending in
	replace mode then where is no selection.

2007-10-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/fade-dialog.c (fade_dialog_new): select "Normal"
	when the mode of the operation is "Replace". This is incorrect but
	it makes the dialog a lot easier to use.

2007-10-19  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: tiny cosmetic cleanups.

2007-10-18  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	introduced a utility function to retrieve the screen and monitor.

2007-10-18  Sven Neumann  <sven@picman.org>

	* modules/colorsel_cmyk_lcms.c: ellipsize the profile label. If
	possible, use the profile description as we do in other places.

2007-10-18  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmoduledb.c (picman_module_db_module_initialize):
	simply check for G_MODULE_SUFFIX and remove utility function
	is_valid_module_name().

2007-10-18  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c: lower the upper limit for
	"undo-levels", mainly for getting a smaller entry in the
	Preferences dialog.

	* libpicmanwidgets/picmanmemsizeentry.c (picman_memsize_entry_new):
	seven digits are enough for a memsize entry.
	
2007-10-18  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_size_entry_new):
	moved the calculation of the number of characters to a utility
	function.

2007-10-18  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c (box_filter): fixed
	calculation of the alpha value.

2007-10-17  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c (box_filter): sprinkled
	some const qualifiers.

2007-10-17  Sven Neumann  <sven@picman.org>

	* app/main.c: added back short versions of --picmanrc option and
	--console-messages command-line options.

2007-10-17  Sven Neumann  <sven@picman.org>

	* app/tools/picmanselectionoptions.c: removed a frame.

	* app/tools/picmantransformoptions.c: tweaked layout to reduce
	horizontal extent.

	* app/widgets/picmanviewablebox.c (gradient_box_new): use an icon
	for the "Reverse" check button.

2007-10-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_size_entry_new):
	improved the calculation of the minimum size of the entry.

2007-10-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c: formatting.

	* libpicmanwidgets/picmannumberpairentry.c: fixed formatting and a
	gtk-doc comment.

2007-10-16  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_size_entry_new):
	honor the "show-pixels" and "show-percent" properties of the unit
	param spec.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_start): set
	the image's width/height on the size entries so the percent unit
	works correctly.

2007-10-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmanselectionoptions.c (picman_selection_options_gui):
	changed "Show interactive boundary" to "Interactive boundary".

	* app/tools/picmantextoptions.c: align the color panel with the
	button box below it.

2007-10-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmanaligntool.c: reduced width of the tool options.

2007-10-16  Sven Neumann  <sven@picman.org>

	* app/paint/paint-enums.[ch] (PicmanPerspectiveCloneMode): changed
	"Modify Perspective Plane" to "Modify Perspective".

	* app/tools/picmantextoptions.c (picman_text_options_gui): changed
	"Create Path from Text" to "Path from Text".

	* app/tools/picmanvectoroptions.c (picman_vector_options_gui):
	changed "Create Selection from Path" to "Selection from Path".

2007-10-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.c: redid the x, y, width and
	height entries according to a mockup from peter.

2007-10-16  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_size_entry_new):
	always connect to refval-changed *and* value-changed of the
	PicmanSizeEntry.

2007-10-16  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpatternselectbutton.c
	* libpicman/picmanbrushselectbutton.c
	* libpicmanwidgets/picmancolorarea.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandockbook.c: set GDK_WINDOW_TYPE_HINT_DND on
	popup windows used to implement a DND cursor.

2007-10-16  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/gradient.pdb: increased the arbitrary upper
	limit on the number of segments in
	picman-gradient-segment-range-split-uniform. The old value used to
	create errors in the "Palette to Gradient" script for most of our
	palettes.

	* app/pdb/gradient_cmds.c: regenerated.

2007-10-16  Sven Neumann  <sven@picman.org>

	* libpicman/picmanlayer.c (picman_layer_copy): removed obsolete comment
	about adding alpha before adding a layer above the background layer.

2007-10-15  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c: added translator comment for the
	string "Current". Changed "Auto Shrink Selection" to "Auto Shrink".

2007-10-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanimage-arrange.c (compute_offset): Use
	picman_vectors_bounds() instead of picman_item_offsets|width|height()
	when calculating size and position for a path. Fixes bug #486517.

2007-10-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanaligntool.c (picman_align_tool_draw): Use
	picman_vectors_bounds() instead of picman_item_offsets|width|height()
	when calculating bounding rectangle for a path. Part of a fix for
	bug #486517.

2007-10-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.[ch]: split the "unit" property
	into "position-unit" and "size-unit" and added a unit menu to the
	position widget group. UI pending further changes...

2007-10-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	moved the "Highlight" toggle down to the "Guides" combo.

2007-10-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.[ch]: added the x and y size
	entries to the PicmanRectangleOptionPrivate struct.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_start): set
	the image's resolution on the x, y, width and height size entries.

2007-10-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Reduced the Width: and Height: labels to W: and H:. Please check
	and comment, we need some solution for this group of widgets
	including the unit menu.

2007-10-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	enable the unit menu on the "Height" entry. Looks like crap and
	needs to be changed, but the unit functionality is almost complete
	now.

2007-10-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.[ch]: renamed properties x0 and
	y0 to x and y. Also reordered all property code to be in the same
	order and added some empty lines to group the properties.

	* app/tools/picmanrectangletool.c: changed accordingly.

2007-10-14  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch] (picman_prop_size_entry_new):
	added parameter "gboolean property_is_pixel" which indicates that
	the stored property value is always in pixels and not in the
	selected unit.

	* app/tools/picmantextoptions.c
	* app/widgets/picmanstrokeeditor.c: pass FALSE to keep the old
	behavior.

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	added property "fixed-unit" which is used for all fixed values
	now. Perhaps we need separate units for width/height/size. Enable
	the unit menu on the "Width" and "Height" size entries of the
	"Fixed" section and configure them to store the value in
	pixels. This was the easy part, some other widgets still need unit
	support.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_start): set
	the image's resolution on the size entries changed above.

2007-10-14  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanaligntool.[ch]: Re-wrote the cursor handling
	logic, added cursor modifiers, added hints in the status bar in
	order to make it easier to discover how to use the tool.  Adds new
	translatable strings, fixes bug #486110.

2007-10-14  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_options_notify): When Fixed: Size/Aspect
	ratio numbers are swapped and the Fixed:-rule is active, swap
	width and height on any pending rectangle. Fixes bug #479999.

2007-10-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_apply_aspect): Use ROUND() not round().

2007-10-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c (run): don't use the last-used
	mapping in interactive mode, only do this when called with run-mode
	PICMAN_RUN_WITH_LAST_VALS. Fixes bug #486283.

2007-10-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_apply_aspect): Use round() when solving the
	aspect ratio equations as this produces more accurate results.

2007-10-12  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-stroke.c: formatting.

2007-10-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.[ch]: massively simplified the
	fixed rule widget showing/hiding, fixed their spacing, make sure
	they don't cause UI resizing on rule change.

2007-10-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorselectorpalette.c: #include "picman-intl.h"

2007-10-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorselectorpalette.c: 
	* plug-ins/twain/twain.c: marked strings for translation (bug #485937).

2007-10-12  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Fix off by one error.
	Stop on third digit after backslash when reading octal character.
	Original cause of bug #485538.

2007-10-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	left-align the size entries.

2007-10-11  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): if we need to
	delete/create tools on button press because the active tool
	doesn't support changing drawables, make sure the newly created
	tool gets its focus_display and modifier states set correctly.
	Fixes bug #485119. Improved disabled debug output.

	* app/tools/picmantool.c: stylistic cleanup in debug output.

2007-10-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.[ch]: moved the new string
	escape function here and also it for the non-interactive case.

	* plug-ins/script-fu/script-fu-interface.c: changed accordingly.

2007-10-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c: don't use
	g_strescape() as it mangles UTF-8 strings. Introduced our own
	escape function instead. Fixes bug #485538.

2007-10-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_add_script):
	use G_DIR_SEPARATOR instead of hardcoding the '\' under Windows.

2007-10-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c
	(picman_rectangle_options_string_current_updates): an object can
	access its own private struct directly.

2007-10-10  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerinfo.c
	* app/widgets/picmancontrollers.c: formatting.

2007-10-09  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmannumberpairentry.c
	(picman_number_pair_entry_get_default_text): Correct gtk-doc
	comment.

2007-10-09  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.[ch]: Connect a new function
	picman_rectangle_options_string_current_updates() that updates the
	Fixed: Aspect entry with a 'Current' string when aspect of the
	current pending rectangle is used, and sets sensitivity FALSE on
	aspect ratio changing buttons when that string is shown. Prevents
	the confusion mentioned in bug #479999.

	A new Rectangle Options property 'use-string-current' has been
	added that should be refactored away from the options object along
	with references to option widgets.

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_update_option_defaults): Set default Fixed:
	Aspect ratio to that of the pending rectangle, and always have
	default Fixed: Size as 100x100.

	* app/tools/picmancroptool.c
	(picman_crop_tool_update_option_defaults): Always have default
	Fixed: Size 100x100.

	* libpicmanwidgets/picmannumberpairentry.[ch]
	(picman_number_pair_entry_class_init): Add a new property
	'default-text' that contains text to be shown instead of numbers
	when default numbers are to be shown.
	(picman_number_pair_entry_get_default_text)
	(picman_number_pair_entry_set_default_text): Getter and setter for
	it.

	* libpicmanwidgets/picmanwidgets.def: Updated.

2007-10-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_setup): use the "file-set" signal
	if possible (introduced with gtk+ 2.12). Enable display of hidden
	files if the initial filename is a hidden file.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager-restore.c
	(picman_plug_in_manager_add_from_rc): changed message about missing
	executable and only output it if picman is verbose.

2007-10-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmannumberpairentry.c: fixed ambiguous gtk-doc
	comment.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/tile.[ch]
	* app/base/tile-rowhints.[ch]: moved tile row hints code to its
	own file.
	
	* app/base/tile-cache.c
	* app/base/tile-manager.c
	* app/base/tile-swap.c
	* app/paint-funcs/paint-funcs.c: changed accordingly.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanitem.c
	* app/tools/picmanrectangletool.c
	* app/tools/tools-utils.c: fixed ambiguous gtk-doc comments.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/base/tile-pyramid.c (tile_pyramid_write_quarter): optimized
	the rendering of fully opaque regions.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/base/tile.[ch]
	* app/paint-funcs/paint-funcs.c: moved code to update tile row
	hints to tile.[ch].

2007-10-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanhelpui.c (picman_help_connect): pass canonical
	signal names to gtk_binding_entry_add_signal().

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/actions/window-commands.c: specify alternative button order.

2007-10-09  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c: removed an obsolete comment.

2007-10-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactionview.c
	* app/widgets/picmanhelp.c: specify alternative button order for
	message dialogs.

	* app/dialogs/user-install-dialog.c: removed trailing whitespace.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.c: implement button_release
	and stop the draw tool when in adjust mode. Fixes bug #483912.

	(picman_perspective_clone_tool_mode_notify): start the draw tool.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.c: cosmetics.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererimage.c
	(picman_view_renderer_image_render): as some kind of workaround for
	bug #459518, show the fallback icon when rendering the preview for
	an invisible channel.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]: removed level from
	PicmanDisplayShell struct.

	* app/display/picmandisplayshell-render.c: fixed rendering of the mask.
	Closes bug #448417 again.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorpanel.[ch]: reverted the live update change
	from bug #451568. It causes breakage such as bug #484757.

2007-10-08  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/display/display-enums.[ch]
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-render.c: allow to configure the
	display zoom quality.

	* app/display/picmandisplayshell-transform.c: formatting. 

2007-10-08  Raphaël Quinet  <raphael@picman.org>

	* authors.xml: Added Peter Sikking as author (we do not have a
	more appropriate category for interface architects).

2007-10-07  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig.c: use a neutral gray as the
	default out-of-gamut warning color.

2007-10-06  Manish Singh  <yosh@picman.org>

	* plug-ins/common/poppler.c: Implement non-interactive mode, and make
	it match the old PDF loader API. Fixes bug #483425.

2007-10-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_draw):
	check that there are segments to draw before calling
	picman_draw_tool_draw_boundary().

2007-10-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-colormap.c (picman_image_set_colormap): don't
	delete the colormap on indexed images. Fixes bug #483887.

2007-10-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-colormap.c (picman_image_set_colormap): set all
	entries to zero before assigning the new colormap.

	* app/paint-funcs/paint-funcs.[ch]: added const qualifiers.

2007-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: store the zoom factor. Doesn't
	work currently, but just needs a simple fix in gtkhtml2.

2007-10-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanselection.c (picman_selection_float): don't pop up a
	warning dialog if the selection is empty (bug #483896).
	
	* app/actions/select-commands.c (select_float_cmd_callback): use
	picman_message() here in case that picman_selection_float() fails.

2007-10-06  Manish Singh  <yosh@picman.org>

	* configure.in: ditch stray "," character.

2007-10-05  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	corrected a mistake caused by a misinterpretation of the spec.

2007-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (create_image): check that the
	window shape is non-empty before applying it to the alpha channel.

2007-10-05  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	support the new revision of the ICC Profiles In X specification
	which handles Xinerama setups.

2007-10-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: use the same size for all
	color buttons.

2007-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/perspective-shadow.scm: applied patch
	from Ulf-D. Ehlert with usability improvements (bug #482743).

2007-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mblur.c: restore compatibility by registering an
	extra procedure for the inward/outward parameter (bug #483426).

2007-10-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: allow to configure the
	out-of-gamut warning color.

2007-10-05  Sven Neumann  <sven@picman.org>

	* modules/colorsel_cmyk_lcms.c: always use the configured CMYK
	profile, regardless of the color management mode.

2007-10-05  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-menu-path.c (plug_in_menu_path_map):
	rewritten array handling to make the IRIX MIPSpro compiler happy
	(bug #483619).

2007-10-05  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig.[ch]: added settings for marking
	out-of-gamut colors in the Print Simulation (bug #476824).

	* app/dialogs/preferences-dialog.c: added a check-button for the
	out-of-gamut warning and tweaked the layout of the Color Management
	page to make the relationship of the settings more obvious.

	* modules/cdisplay_lcms.c: mark out-of-gamut colors.

2007-10-04  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c
	* modules/cdisplay_proof.c
	* modules/colorsel_cmyk_lcms.c
	* plug-ins/common/lcms.c 
	* plug-ins/jpeg/jpeg-load.c: use cmsFLAGS_BLACKPOINTCOMPENSATION
	instead of the equivalent cmsFLAGS_WHITEBLACKCOMPENSATION.

2007-10-04  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (jpeg_load_cmyk_transform): use the
	display rendering intent as set in the user's color management
	preferences. Use black point compensation if the rendering intent
	is relative colorimetric.

	* modules/colorsel_cmyk_lcms.c: same change here.

2007-10-03  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: use black point compensation if the
	rendering intent is relative colorimetric.

	* plug-ins/common/lcms.c: use the display rendering intent as set
	in the user's color management preferences as the default for the
	color conversion. Default to using black point compensation if the
	rendering intent is relative colorimetric (bug #475983).

2007-10-03  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/perspective-shadow.scm: applied patch
	from Ulf-D. Ehlert that fixes resizing in the Perspective Shadow
	script (bug #482743).

2007-10-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/scatter_hsv.c (scatter_hsv_dialog): changed the
	dialog title to adopt to the menu label we changed two years ago.

2007-10-02  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/xmp-model.c
	* plug-ins/metadata/xmp-encode.c: replaced calls to g_warning() by
	g_printerr().

2007-10-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/oilify.c (get_map_value): clamp values used for
	the exponent map to 1..255. Fixes bug #478618.

2007-10-02  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/guides-new.scm: Use 'list' to create
	argument list for SF-ADJUSTMENT since it uses a named constant.
	Fixes bug #480799.

2007-10-01  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/burn-in-anim.scm: use RUN-NONINTERACTIVE
	for the run-mode where 0 was used instead.

2007-10-01  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/Makefile.am: moved shadow_bevel.py to
	test-scripts so that it isn't installed by default (bug #482289).

2007-10-01  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/*.scm: use RUN-NONINTERACTIVE for the
	run-mode where 1 was used instead.

2007-10-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: removed
	picman_get_accel_string() and use gtk_accelerator_get_label()
	instead.

	* app/widgets/picmanactionview.c: ditto.

2007-10-01  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/camo.scm
	* plug-ins/script-fu/scripts/distress-selection.scm
	* plug-ins/script-fu/scripts/fuzzyborder.scm
	* plug-ins/script-fu/scripts/old-photo.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/tileblur.scm
	* plug-ins/script-fu/scripts/unsharp-mask.scm: use
	RUN-NONINTERACTIVE for the run-mode instead of TRUE.

2007-09-30  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-render.c: 64bittified the code so
	  that the new renderer also works for big images. Slightly
	  reorganized.

	* app/display/picmandisplayshell-transform.c: Another go at
	  bug #474509. This even might be fixed now...

2007-09-30  Sven Neumann  <sven@picman.org>

	* app/core/picman-utils.c (picman_get_temp_filename): handle a NULL
	extension and create a filename without file extension.

	* tools/pdbgen/pdb/fileops.pdb
	* app/pdb/fileops_cmds.c: allow NULL to be passed as extension
	parameter to picman_temp_name().

2007-09-30  Sven Neumann  <sven@picman.org>

	* app/actions/templates-commands.c: reverted last change. We would
	also have to change a string if we wanted to do this change.

2007-09-30  Sven Neumann  <sven@picman.org>

	* app/actions/templates-commands.c
	(templates_create_image_cmd_callback): when creating an image from a
	template, skip the New Image dialog as suggested in bug #480802.

2007-09-30  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c (pypicman_param_from_tuple): drop the
	reference we added to the args tuple in the error case.

2007-09-30  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/foggify.py: fill layer before using it.
	Fixes bug #481798, thanks to Jakub Friedl for suggesting fix.

2007-09-29  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.c (picman_extension_process): loop around select() as
	long as it returns EINTR. Enables debugging of script-fu on
	OSX (and maybe all BSDish systems).

2007-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: allocate the
	ConsoleInterface struct on the stack.

2007-09-28  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/addborder.scm: Made all the functions
	defined in the file local instead of global to avoid possible
	conflicts with other scripts.

2007-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c: plugged memory leaks.

	* libpicmanbase/picmanprotocol.c (gp_params_destroy): formatting.

2007-09-28  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.c (picman_hsv_to_rgb_int): avoid the
	ambiguity of returning different values for the same color and
	limit the Hue output range to [0..359].

2007-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff-load.c (load_rgba): use
	picman_pixel_rgn_set_row() to set a single row of pixels.

2007-09-28  Sven Neumann  <sven@picman.org>

	* data/images/picman-splash.png: fixed typo.

2007-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image): fixed the twisted logic.

2007-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c: moved handling of the CMYK profile to
	a utility function. Respect the user's color management settings.

2007-09-27  Kevin Cozens  <kcozens@cvs.gnome.org>

	Create SF-RUN-MODE constant for use in Script-Fu. Fixes bug #479893.

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/scheme-wrapper.h: Added set_run_mode_constant()
	which creates a new constant called SF-RUN-MODE. This constant can
	be used by Script-Fu scripts when calling a plug-in that needs to
	know the current run mode.

	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/script-fu-server.c: Added calls to create the
	new SF-RUN-MODE constant.

	* plug-ins/script-fu/scripts/difference-clouds.scm: Pass SF-RUN-MODE
	to the solid noise plug-in instead of always using RUN-INTERACTIVE.

2007-09-27  Michael Natterer  <mitch@picman.org>

	* app/gui/ige-mac-menu.c: new version which correctly updates the
	menus when items are added or removed.

2007-09-27  Sven Neumann  <sven@picman.org>

	* configure.in: define HAVE_LCMS if lcms is available.

	* plug-ins/jpeg/Makefile.am: link with LIBLCMS.

	* plug-ins/jpeg/jpeg-load.c (load_image): when loading a CMYK JPEG
	file and it comes with an embedded CMYK profile, use lcms to do
	the colorspace conversion.

2007-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_thumbnail_image): same change
	here. Moved colorspace conversion to a utility function.

2007-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image): get rid of one of the
	temporary buffers. We don't need an alpha channel on the preview
	layer and we can do the CMYK->RGB conversion in place.

2007-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c (run): show the dialog when called with
	PICMAN_RUN_WITH_LAST_VALS. This is better than just doing nothing
	when being called from the Repeat menu item (bug #480796).

2007-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/add-bevel.scm: fixed PicmanImageType
	parameter passed to picman-layer-new. Do not register the script for
	grayscale images, it doesn't handle them properly.

2007-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c: unified error
	messages, removed trailing newlines.

2007-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: don't create nested undo groups.

2007-09-26  Sven Neumann  <sven@picman.org>

	* app/core/picmanimageundo.c (picman_image_undo_pop): call
	picman_color_managed_profile_changed() if an icc-profile is attached
	or removed from an image by an undo operation (bug #475983).

2007-09-26  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-render.c: fix the numerical overflow
	for the new box-filtering stuff.

	Fixes bug #479807.

2007-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/maze/maze_face.c (maze_dialog): use separate variables
	for width and height entry. Fixes bug #480303.

2007-09-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerwheel.c (picman_controller_wheel_scroll):
	fixed check for modifier keys and always return on a matched
	event (bug #480319). Also reordered the list of events as the code
	does not any longer rely on a certain order.

2007-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/maze/maze_face.c: minor cleanup, removed unused code.

2007-09-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmessagebox.c (picman_message_box_constructor):
	left-align the image.

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/actions/templates-commands.c: use more meaningful stock
	icons for message dialogs.

2007-09-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/decompose.c: reverted "fix" for bug #477008.

	* tools/pdbgen/pdb/display.pdb
	* app/pdb/display_cmds.c: flush the image before creating a new
	display for it. Fixes bug #477008 also for other plug-ins like
	Screenshot.

2007-09-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_widget_accel_changed):
	show the keyboard shortcut in brackets, as we do in other places.

2007-09-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/fuzzyborder.scm: Applied patch from
	Ulf-D. Ehlert which pushes and pops a context to prevent
	changing background colour in the UI. Fixes bug #479974.

2007-09-24  Matic Zgur  <mr.zgur@gmail.com>

	* configure.in: Added 'sl' to ALL_LINUGAS.

2007-09-24  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: fixed error on how many points get
	initialized.
	* app/pdb/vectors_cmds.c: regenerated

	Probably fixes bug #479790.

2007-09-24  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: removed const qualifiers
	to fix compilation on Solaris 8 (bug #479817).

2007-09-24  Michael Natterer  <mitch@picman.org>

	* app/gui/ige-mac-menu.c (ige_mac_menu_add_app_menu_item): allow
	to pass NULL as label and get the label from the menu item.

	* app/gui/gui.c (gui_restore_after_callback): pass NULL as labels
	for the preferences menu items.

2007-09-24  Michael Natterer  <mitch@picman.org>

	* app/gui/ige-mac-menu.[ch]: new versions with slight API renaming
	and new generalized API for adding application menu items.

	* app/gui/gui.c (gui_restore_after_callback): follow API changes
	and add "Preferences", "Keyboard Shortcuts" and "Units" to the
	application menu's preferences section.

2007-09-24  Simon Budig  <simon@picman.org>

	* app/xcf/xcf-load.c: use the correct default values for the
	control points of a loaded path.

	Fixes bug #479176.

2007-09-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/drop-shadow.scm: applied patch from
	Ulf-D. Ehlert which fixes a bug which may shrink the image instead
	of enlarging it (bug #478385).

2007-09-23  Sven Neumann  <sven@picman.org>

	* Made 2.4.0-rc3 release.

2007-09-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooloptionseditor.c
	(picman_tool_options_editor_get_title): avoid the crash reported in
	bug #470304.

2007-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: marked blurbs as translatable.

2007-09-23  Simon Budig  <simon@picman.org>

	* app/display/picmandisplay.c: Accomodate for spill that
	happens by the box filtering.

	Fixes bug #474509. Again. Hopefully.

2007-09-23  Michael Natterer  <mitch@picman.org>

	* menus/toolbox-menu.xml.in: added placeholder File/Preferences
	and move the preferences and keyboard shortcut dialogs there.

	* plug-ins/common/uniteditor.c (query): register the unit editor
	there too.

2007-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/pcx.c: avoid pointer arithmetics on void pointers.
	Fixes compilation on IRIX (bug #479357).

2007-09-23  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleselecttool.c: Reverted commits for
	bug #479426, it's NOTABUG.

2007-09-23  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_should_draw): New name for
	picman_rect_select_selection_visible() which has been changed to
	always return TRUE when the tool is active, i.e. when a rectangle
	is being create or resized. Better fix for bug #479426.

2007-09-23  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_draw): Only draw the rectangle when `Show
	selection' is `true', with the help of a new function
	picman_rect_select_tool_selection_visible(). Fixes bug #479426.

2007-09-23  Simon Budig  <simon@picman.org>

	* plug-ins/common/bumpmap.c: add a few strategically placed
	return TRUEs to stop event propagation.

	Fixes bug #479389

2007-09-23  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-render.c: oops - managed to miss the
	mask rendering.

2007-09-23  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-render.c: use Bresenham stepping
	for the y-direction as well.

	Fixes bug #474509.

	Retired old and unused functions.

2007-09-23  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-render.c: implement
	bresenham-like stepping for interpolating the view in
	x-direction. Since I now know how it is supposed to work
	the y direction will follow shortly.

	Adresses bug #474509.

2007-09-22  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancropoptions.[ch]: Add an allow-growing option.

	* app/tools/picmancroptool.c: Take the new allow-growing option into
	account when setting crop rectangle constraints, and restructure
	the code a bit.
	(picman_crop_tool_execute): Allow rectangles larger than the
	image/layer being sent to picman_image_crop() since that function
	handles that fine. These changes fixes bug #368325.

2007-09-22  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_set_constraint): Enforce constraints of any
	pending rectangle when setting a constraint.

2007-09-22  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: further simplifications.

2007-09-21  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (basic_inchar): Applied
	modified patch from Simon Budig. Any bytes read from a file which
	are not valid UTF-8 characters will be ignored. Fixes bug #476356.

2007-09-21  Sven Neumann  <sven@picman.org>

	General fix for bug #478657:

	* libpicman/picmanaspectpreview.c
	* libpicman/picmandrawablepreview.c
	* libpicman/picmanzoompreview.c: let all preview widgets store the
	state of the Preview toggle. Declared "toggle" parameter as unused.

	* plug-ins/common/*.c: pass NULL for "toggle" to
	picman_drawable_preview_new() and picman_aspect_preview_new().

2007-09-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.c: formatting.

	* libpicmanwidgets/picmanscrolledpreview.c: make use of freeze/thaw to
	reduce the number of updates during initialization.

2007-09-21  Sven Neumann  <sven@picman.org>

	* app/file/file-open.c (file_open_image): set the image clean
	after handling the color profile.

2007-09-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: added a load_proc member to PicmanImage
	and getters and setters for it.

	* app/file/file-open.c (file_open_image): set the load procedure,
	but only if it hasn't been set already. Use the MIME type from the
	load procedure that is set on the image.

	* tools/pdbgen/pdb/fileops.pdb (file_load_invoker): set the load
	procedure. This causes it to be set when the URI plug-in calls
	picman-file-load to load the image.

	* app/pdb/fileops_cmds.c: regenerated.

	* app/widgets/picmanimagepropview.c
	(picman_image_prop_view_label_set_filetype): use the MIME type from
	the load procedure, in case that no save procedure is set.

2007-09-20  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_recent_list_add_uri): use
	"application/octet-stream" as MIME type in case that it is unset.

2007-09-20  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpegqual.c (quant_info): updated the table of
	known devices and software, work in progress.

2007-09-20  Michael Natterer  <mitch@picman.org>

	* menus/image-menu.xml.in: added placeholder Edit/Preferences and
	move the preferences and keyboard shortcut dialogs there.

	* plug-ins/common/uniteditor.c (query): register the unit editor
	there too.

2007-09-19  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c: weight pixels by their alpha value
	(bug #477689).

2007-09-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c: removed extra arguments that were
	added to the compose procedures in the 2.3 development cycle.
	Restores compatibility and fixes bug #477795.

2007-09-19  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpegqual.c: Re-wrote large parts of the code,
	still work in progress: use GOption for command-line options, add
	number of quantization tables in QuantInfo, added info for more
	sources (devices or software) but not verified yet.

2007-09-19  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c: ifdef'ed out some debugging
	statements so that they show up only in unstable releases.

	* plug-ins/jpeg/jpeg.c (run): removed calls to picman_set_data() and
	picman_get_data() so that changes made to the JPEG save settings for
	one file do not affect other files saved later.

2007-09-18  Michael Natterer  <mitch@picman.org>

	* app/gui/gtk-macmenu.[ch]: removed...

	* app/gui/ige-mac-menu.[ch]: ...and replaced by new versions which
	don't use the GTK+ namespace.

	* app/gui/Makefile.am
	* app/gui/gui.c: changed accorgingly.

2007-09-18  Michael Natterer  <mitch@picman.org>

	* configure.in: replaced HAVE_GDK_QUARTZ conditional by
	--disable-toolbox-menu configure switch which defaults to "no"
	normally and to "yes" on quartz.

	* app/widgets/picmantoolbox.c: changed #ifdef accordingly.

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-menu-path.[ch]: new generic machanism to map
	around menu locations. If ENABLE_TOOLBOX_MENU is false, map
	"Xtns" and "Help" from <Toolbox> to <Image>.

	* app/plug-in/picmanpluginmanager-menu-branch.c
	* app/plug-in/picmanpluginprocedure.c: run all menu paths through the
	new mapping function.

	* menus/Makefile.am
	* menus/menus.xsl
	* menus/image-menu.xml.in: add both the "Xtns" and "Help" menus to
	the image menubar if TOOLBOX_MENU is false.

2007-09-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/fileops.pdb: canonicalize the name of the
	thumbnail loader procedure too. Fixes bug #477917.

	* app/pdb/fileops_cmds.c: regenerated.

2007-09-17  Martin Nordholts  <martinn@svn.gnome.org>

	* plug-ins/common/psd-load.c (do_layer_record, load_image):
	Applied slightly modified patch from John Marshall that drops
	adjustment and layer group layers when loading PSD files. Fixes
	bug #474718.

2007-09-17  Nils Philippsen  <nphilipp@redhat.com>

	* plug-ins/common/pcx.c (load_image): verify that the bytesperline
	header field (number of bytes to allocate per plane and line)
	isn't less than the width of the image (bug #477802).

2007-09-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.[ch]: when DND-hovering > 500ms over a
	notebook tab, switch to that tab's page. Suggested by Saul Goode.

2007-09-17  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_proof.c: use a PicmanColorProfileComboBox for
	profile selection.

2007-09-17  Simon Budig  <simon@picman.org>

	* plug-ins/common/decompose.c: flush the displays at the end.

	Fixes bug #477008.

2007-09-17  Simon Budig  <simon@picman.org>

	* app/display/picmandisplayshell-render.c: avoid rendering
	issues by adding xdelta/2 to xstart.

	Probably fixes bug #474509.

2007-09-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/layer.pdb: added picman-layer-flatten.
	Fixes bug #477026. Fixed docs of picman-layer-add-alpha.

	* app/pdb/internal_procs.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]: regenerated.
	* libpicman/picman.def: changed accordingly.

2007-09-15  Michael Natterer  <mitch@picman.org>

	Make layer masks work consistently on layers without alpha.
	Fixes bug #475548.

	* app/core/picmanlayer.c (picman_layer_apply_mask): changed to work
	on layers without alpha.

	* app/actions/layers-commands.c (layers_add_mask_response): don't
	automatically add an alpha channel when adding a layer mask.

2007-09-14  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmandatafiles.c: move private functions to the end
	of the file. Added function is_hidden() and use it in
	picman_datafiles_read_directories(). Moved variables to local
	scopes.

2007-09-14  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_recent_list_add_uri): use the
	untranslated application name. Specify the group "Graphics".

2007-09-14  Sven Neumann  <sven@picman.org>

	* app/base/tile-pyramid.c: formatting.

	* app/display/picmandisplayshell-render.c: removed unused include.

2007-09-13  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/lava.scm: Removed 'from-selection'.
	Reset active layer after calling picman-selection-save. Modified
	version of patch from Jakub Friedl which fixes bug #476672. Don't
	add alpha if drawable already has alpha. Minor format changes.

2007-09-13  Sven Neumann  <sven@picman.org>

	* app/gui/Makefile.am
	* app/gui/gui-vtable.c (gui_recent_list_add_uri): use PICMAN_COMMAND
	instead of hardcoding "picman" as the command line used to launch
	this resource. Use the translated full application name.

2007-09-13  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorprofilestore-private.h
	* libpicmanwidgets/picmancolorprofilestore.c
	* libpicmanwidgets/picmancolorprofilecombobox.c: only keep the eight
	most recently used profiles in the history.

2007-09-13  Nils Philippsen  <nphilipp@redhat.com>

	* app/file/file-save.[ch] (file_save)
	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image)
	* app/actions/file-commands.c (file_save_cmd_callback)
	* app/widgets/picmandnd-xds.c (picman_dnd_xds_save_image): don't pass
	Picman instance to file_save() calls as it's not needed

2007-09-13  Nils Philippsen  <nphilipp@redhat.com>

	Drop own recently used files code in favour of GtkRecentManager:
	
	* app/core/picman-gui.[ch] (picman_recent_list_add_uri)
	* app/gui/gui-vtable.c (gui_recent_list_add_uri): add
	{picman,gui}_recent_list_add_uri(), gui_recent_list_add_uri()
	dispatches to GtkRecentManager

	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image)
	* app/actions/file-commands.c (file_save_cmd_callback)
	* app/widgets/picmandnd-xds.c (picman_dnd_xds_save_image): pass Picman
	instance to file_save() calls
	
	* app/file/file-open.c (file_open_with_proc_and_display)
	(file_open_layers)
	* app/file/file-save.[ch] (file_save): pass Picman instance to
	picman_recent_list_add_uri() calls

	* app/file/picmanrecentitem.[ch]
	* app/file/picmanrecentlist.[ch]: removed

	* app/file/Makefile.am: drop reference to removed files

2007-09-13  Michael Natterer  <mitch@picman.org>

	* configure.in: : remove PANGO_DISABLE_DEPRECATED only for
	pango >= 1.19, PICMAN builds fine against 1.18

2007-09-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.c: removed static variable debug_context
	but keep the warnings about NULL contexts.

2007-09-13  Sven Neumann  <sven@picman.org>

	* app/text/picmanfontlist.c (picman_font_list_add_font): corrected
	Pango version number in comment.

	* app/widgets/picmanundoeditor.c (picman_undo_editor_set_context):
	chain up after initializing the context. Fixes a warning about
	picman_viewable_get_new_preview() being called with a NULL context.

2007-09-13  Michael Natterer  <mitch@picman.org>

	* configure.in: remove FOO_DISABLE_DEPRECATED only for glib >= 2.15
	and gtk+ >= 2.13, PICMAN builds fine against the 2.14 and 2.12 APIs
	apart from:

	* app/tools/picmanselectionoptions.c
	* libpicmanwidgets/picmanhelpui.c: undef GTK_DISABLE_DEPRECATED because
	GtkTooltips is deprecated in gtk+ 2.12.

	* libpicman/picmanui.c
	* plug-ins/common/pat.c: the address of an array is always
	non-NULL, no need to check for that. Fixes new gcc warnings.

2007-09-12  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: (render_image_tile_fault),
	(render_image_tile_fault_one_row): clone the middle row/column when
	walking off the source drawable during downscaling. Probably fixes bug
	#469567.

2007-09-12  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanunitmenu.c (picman_unit_menu_create_selection):
	if the parent toplevel is modal, make the unit selection dialog
	modal too. Fixes bug #389358.

2007-09-12  Sven Neumann  <sven@picman.org>

	* app/base/tile.c (tile_data_pointer): use the offsets modulo
	TILE_WIDTH and TILE_HEIGHT instead of doing the modulo operation
	in each and every caller.

	* app/base/boundary.c
	* app/base/pixel-region.c
	* app/base/tile-manager.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanlayer.c
	* app/display/picmandisplayshell-render.c
	* app/paint-funcs/paint-funcs.c
	* app/paint/picmanpaintcore.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

2007-09-12  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (supersample_dtest): use
	G_SQRT2 instead of defining this constant again.

2007-09-12  Michael Natterer  <mitch@picman.org>

	Bring back our menus when building on OS X but not against the
	quartz GDK backend:

	* configure.in: added conditional HAVE_GDK_QUARTZ.

	* menus/Makefile.am: use it when moving the help menu around.

	* app/dialogs/preferences-dialog.c
	* app/display/picmandisplayshell.c
	* app/gui/gtk-macmenu.c
	* app/gui/gui.c
	* app/widgets/picmantoolbox.c: use #ifdef GDK_WINDOWING_QUARTZ
	instead of #ifdef HAVE_CARBON when enabling the global menubar.

2007-09-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorprofilecombobox.c
	(picman_color_profile_combo_box_new): fixed reference count of the
	profile store.

2007-09-12  Øyvind Kolås  <pippin@picman.org>

	* app/core/picman-transform-region.c: (supersample_dtest): do not invoke
	supersampling for linear, bicubic and lanczos until the largest
	horizontal/vertical difference between transformed pixel corners goes
	above sqrt(2) (this ensures interpolation instead of supersampling is
	used for rotation.)

2007-09-12  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer-filter.c
	(picman_container_filter_by_name): changed to use extended regular
	expression syntax.

2007-09-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: remember color conversion parameters
	(bug #475966).

2007-09-12  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def: added picman_context_list_paint_methods.

	* libpicman/tmpl/picmancontext.sgml: regenerated.

2007-09-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/pnm.c (pnm_load_ascii): fixed loading of PGM
	files with maxval of 1 (bug #475991).

2007-09-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: fixed use of black-point-compensation
	parameter (bug #475952).

2007-09-11  Manish Singh  <yosh@picman.org>

	* plug-ins/common/psp.c: don't use "major" and "minor" as variable
	names, they may conflict with system symbols.

2007-09-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: formatting.

2007-09-11  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_add_layers): make the first of
	the added layers the active layer. Fixes bug #469752.

2007-09-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spread.c (spread_dialog): update the preview on
	"value-changed", instead of "refval-changed". Fixes bug #469360.

2007-09-11  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/context.pdb: add PDB function to determine
	the available paint methods.

	* app/pdb/internal_procs.c
	* app/pdb/context_cmds.c
	* libpicman/picmancontext_pdb.[ch]: regenerated.

	Fixes bug #473513

2007-09-11  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-open-dialog.c: don't reverse the order of URIs
	when opening multiple files as layers. Fixes one aspect of bug
	#469752.

2007-09-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: allow to specify rendering intent and 
	black point compensation. Fixes bug #474787.

2007-09-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/coffee.scm: removed newlines from
	translatable strings. Fixes bug #475553.

2007-09-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lens.c: applied patch from Aurimas Juška which
	simplifies the code by using PicmanPixelFetcher and fixes handling
	of selections in the preview. Fixes the last aspect of bug #356716.

2007-09-10  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.[ch]
	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform.[ch]
	* app/core/picmandrawable.c
	* app/core/picmanimage-item-list.[ch]
	* app/core/picmanitem-linked.[ch]
	* app/core/picmanitem.[ch]
	* app/core/picmanlayer.c
	* app/paint/picmanperspectiveclone.c
	* app/vectors/picmanvectors.c: removed supersample parameter from
	transform functions and perform it depending on the interpolation
	type (bug #473265).

	* app/tools/picmantransformoptions.[ch]
	* app/tools/picmantransformtool.c: removed Supersample toggle from
	the transform tool options.

	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: document that the
	supersample parameter is unused and improved documentation of the
	recursion-level parameter.

	* app/pdb/transform_tools_cmds.c
	* app/pdb/drawable_transform_cmds.c
	* libpicman/picmandrawabletransform_pdb.c: regenerated.

2007-09-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.c
	(picman_perspective_clone_tool_motion): removed unused variable.

2007-09-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psp.c: applied patch from Nils Philippsen that
	fixes an endianess problem (bug #475464).

2007-09-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c (lcms_drawable_transform): copy the alpha
	channel to the destination region. Fixes bug #473998.

2007-09-10  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: minor update for 2.4. Removed bindings for brush
	radius as these keys are now bound by default.

2007-09-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttoolundo.c: removed unused variable.

2007-09-07  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_script_proc):
	applied patch from Kevin Cozens which implements RUN-WITH-LAST-VALS.
	On top of that, factored out script_fu_collect_standard_args()
	which collects DISPLAY,IMAGE,[DRAWABLE|LAYER|...] from the passed
	parameters according to the new calling conventions (the old code
	for INTERACTIVE was broken). Also cleaned up the function a bit.
	Fixes bug #472493.

2007-09-07  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager.c (read_pixel_data_1): use a temporary
	variable to store the return value of tile_manager_get() instead
	of assigning to tm->cached_tile directly to make sure
	tm->cached_num and tm->cached_tile are always in a consistent
	state (the requested tile might be invalid and needs to be
	validated, which would call tile_manager_get() recursively, which
	in turn would clear the cached tile). Fixes bug #472770.

2007-09-06  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_auto_shrink):
	Call picman_rectangle_tool_rectangle_changed and recalculate handle
	sizes after 'Auto shrink selection'. Fixes bug #474344.

2007-09-06  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/contactsheet.scm: Preserve aspect ratio
	of original images. Center thumbnails in space above filename label.
	Added new sheet size of 1600x1200 pixels. Changed a dialog label.

2007-09-06  Simon Budig  <simon@picman.org>

	* plug-ins/common/convmatrix.c: there is no need to mess
	with the selected channels within check_config(). Also fix
	bug with with copying its values into the chanmask
	in convolve_image()

	Fixes bug #472518

2007-09-06  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h: quick fix:
	raise the cell segment size as well as the number of possible
	segments to reduce the likelihood of a failing (make-vector)

	(yes, this is a hack and no proper fix)

2007-09-04  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: Fix initialization of the delta
	vectors. Fixes bug #473515.

2007-09-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.c: remove unbalanced "*/"

	* app/core/picmandrawable-transform.c
	* app/core/picman-transform-resize.c: formatting.

2007-09-04  Simon Budig  <simon@picman.org>

	* app/core/picmanparamspecs.c: fix NULL handling and formatting.

2007-09-03  Michael Natterer  <mitch@picman.org>

	* configure.in: bump version to 2.4.0-rc3.

2007-09-03  Michael Natterer  <mitch@picman.org>

	* Made 2.4.0-rc2 release.

	* app/Makefile.am (dist-dump-picmanrc): added some sed voodoo to
	make sure the num-processors in the distributed picmanrc and its
	manpage don't depend on the machine that does make dist.

2007-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-region.c: Applied slightly reformatted
	patch from Jakub Friedl and Daniel Hornung which ROUND()s the
	floating point result values before assigning them to integers to
	avoid reducing the output space to [0..254] (thus darkening the
	image). Fixes bug #472806.

2007-09-03  Michael Natterer  <mitch@picman.org>

	* data/tips/Makefile.am
	* desktop/Makefile.am:
	s/.intltool-merge-cachemake/.intltool-merge-cache/ to fix
	distcheck, probably a "make" was entered in the wrong window.

2007-09-02  Michael Natterer  <mitch@picman.org>

	* configure.in: bump version to 2.4.0-rc2.

2007-09-02  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmandisplayshell-draw.c
	(picman_display_shell_draw_area): Remove the STRESS_TEST stuff,
	picman_image_invalidate_without_render does not exist anymore
	anyway.

2007-09-02  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_update_option_defaults): New function to
	update default values for Fixed: Size. This function is called to
	update defaults values for Fixed: Size to that of the pending
	rectangle width x height if there is one, or 100x100 otherwise.

	* app/tools/picmancroptool.c
	(picman_crop_tool_update_option_defaults): Set Fixed: Size to the
	size of the pending crop rectangle, or 100x100 if there is none.

2007-09-01  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c
	(picman_crop_tool_update_default_fixed_ratio_options):
	Generalize the default Fixed: Aspect ratio option setting code
	so that it can later be used for Fixed: Size as well, and move
	it to

	* app/tools/picmanrectangletool.[ch]
	(picman_rectangle_tool_pending_size_set)
	(picman_rectangle_tool_constraint_size_set): and use these two new
	functions instead.

2007-08-31  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.[ch]
	* plug-ins/script-fu/tinyscheme/scheme-private.h: make it possible
	for foreign functions to return an error.

	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/scheme-wrapper.c: Make use of this.
	Fixes bug #472026.

2007-08-31  Simon Budig  <simon@picman.org>

	* MAINTAINERS: adjusted to enforced gnome-svn standards  :-(

2007-08-31  Michael Natterer  <mitch@picman.org>

	* app/gui/sync-menu.[ch]: renamed...

	* app/gui/gtk-macmenu.[ch]: ...to these to match new namespace.

	* app/gui/Makefile.am
	* app/gui/gui.c: changed accordingly.

2007-08-31  Michael Natterer  <mitch@picman.org>

	* app/gui/sync-menu.[ch]: new versions with sane namespace and
	support for setting the application menu's "Quit", "About" and
	"Preferences" items.

	* app/gui/gui.c: changed accordingly and use the new menu items
	from the application menu.

2007-08-31  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager.c (tile_manager_get): if
	tile_manager->cached_tile is requested for writing, clear the
	cache before giving out the tile. Fixes bug #472170.

2007-08-31  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: (render_image_tile_fault):
	use nearest neighbour resampling when rendering for a 1byte per pixel
	drawable (ony happens when interacting with the SIOX tool, and then
	the buffer is a indexed; not a greyscale buffer), fixes bug #472027.

2007-08-31  Raphaël Quinet  <raphael@picman.org>

	* app/display/picmandisplayshell-render.c (render_image_tile_fault):
	do not use anti-aliasing when the zoom is exactly 200%.  Fixes bug
	#472150.  Also miscellaneous cosmetic changes.

2007-08-31  Simon Budig  <simon@picman.org>

	* plug-ins/common/antialias.c: fixed subtle cut'n'paste bug,
	made the code a little bit more readable.

2007-08-30  Karine Delvare  <edhel@picman.org>

	* plug-ins/common/illusion.c
	* plug-ins/common/polar.c
	* plug-ins/common/whirlpinch.c: applied patches from Aurimas Juška
	that fixes use of the PicmanZoomPreview widget in those plug-ins (see
	bug #356716), and makes illusion handle selections properly.

2007-08-30  Raphaël Quinet  <raphael@picman.org>

	* authors.xml: updated some entries, added contributors: Nicola
	Archibald, Tim Mooney, Nils Philippsen and Yoshinori Yamakawa

	* AUTHORS: regenerated.

2007-08-30  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.h: remove extraneous comma.

2007-08-30  Michael Natterer  <mitch@picman.org>

	* app/gui/sync-menu.c: take over cosmetic fix from upstream.

	* configure.in: add HAVE_CARBON as AM_CONDITIONAL

	* menus/image-menu.xml.in: add the Help menu to the image menu.

	* menus/Makefile.am
	* menus/menus.xsl: filter it away if we are not on carbon.

	* app/menus/menus.c: added the "help" action group to the image UI
	manager.

2007-08-30  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/tinyscheme/scheme.[ch]
	* plug-ins/script-fu/scheme-wrapper.h: Shuffeled some
	code around to have scheme.c not include scheme-wrapper.h.

2007-08-30  Raphaël Quinet  <raphael@picman.org>

	* data/tips/picman-tips.xml.in: expanded old tip and mentioned that
	it is possible to configure most window managers so that they do
	not steal the Alt key from the applications.  Fixes bug #471565.

2007-08-30  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/pcx.c: applied modified patch from Nils
	Philippsen that adds more sanity checks when loading and saving
	images.  Fixes the reopened bug #471189.

2007-08-30  Michael Natterer  <mitch@picman.org>

	First version of global menubar support for OSX. Work in progress.

	* app/gui/Makefile.am
	* app/gui/sync-menu.[ch]: new files containing code that takes
	a GtkMenuShell and proxies it in the OSX global menubar. Taken
	from http://developer.imendio.com/projects/gtk-macosx/menubar

	* app/gui/gui.c: put the global image popup menu to the menubar.

	* app/dialogs/preferences-dialog.c
	* app/display/picmandisplayshell.c
	* app/widgets/picmantoolbox.c: #ifdef out all menubars in windows.

	* app/Makefile.am (AM_LDFLAGS): add $(CARBON_LDFLAGS)

2007-08-30  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/common/scatter_hsv.c: Randomizing hue of desaturated
	pixels before increasing saturation. Fixes #471476.

2007-08-29  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Applied change suggested
	in SourceForge bug #1593861 which stops integer? from thinking that
	non-numbers are integers.

2007-08-30  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.[ch]
	* plug-ins/script-fu/tinyscheme/scheme-private.h: small changes
	to tinyscheme - mostly removing workarounds for message output.

	* plug-ins/script-fu/scheme-wrapper.[ch]: try to channel the
	output through a central function, have various output functions
	to handle the messages. Remove some hacks.

	* plug-ins/script-fu/script-fu-text-console.c
	* plug-ins/script-fu/script-fu-scripts.[ch]
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/script-fu/script-fu-console.[ch]: use the new
	infrastructure. Remove more hacks.

	* plug-ins/script-fu/servertest.py: small script to test the
	communication with the script-fu-server.

	This hopefully fixes bug #438997

2007-08-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-encode.c (gen_property): escape the text
	values output in the XMP packet.  Based on a bug report and patch
	by John Marshall.  Fixes bug #455481.

2007-08-29  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/common/scatter_hsv.c: Calling randomize_value with
	max value 359 instead of 360 to fix off by 1 error when wrapping
	around.

2007-08-29  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/common/convmatrix.c: Removes the fprint function.
	Values are printed using g_snprintf and "%g" which supresses
	trailing zeroes. Fixes bug #471051.

2007-08-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-save.[ch]
	* plug-ins/jpeg/jpeg.c: change the behavior of the code so that
	"Use quality settings from original image" does what it claims,
	even if these settings are worse than the user's defaults (note
	that the option is not automatically enabled in this case).  Also
	set the subsampling type when that box is checked.

	* plug-ins/jpeg/jpeg-settings.h: formatting.

2007-08-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/pcx.c: applied modified patch from Nils
	Philippsen that uses the glib endianness conversion macros instead
	of the ones provided in the old code (broken on S390/S390x).
	Fixes bug #471189.

2007-08-29  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/lcms.c (lcms_image_apply_profile):
	picman-selection-* procedures operate on the image_ID, not on the
	selection drawable_ID itself. Fixes bug #470589. Also remove the
	saved selection channel after reloading it.

2007-08-29  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/preferences/Makefile.am (PREFS_IMAGES):
	install and distribute the new icons. Fixes bug #436815

2007-08-28  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/folder-palettes-{16,22}*:
	* themes/Default/images/preferences/folder-themes-{16,22}*:
	missing sizes. Addresses bug #436815

2007-08-28  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmandatafiles.c (picman_datafiles_read_directories):
	skip files starting with '.' so we don't try to parse .DS_Store
	and other metadata storage files. Also moved variables to local
	scopes.

2007-08-28  Tor Lillqvist  <tml@novell.com>

	* libpicmanbase/picmanenv.c: Update doc comments about filename
	encoding on Windows. It is now always UTF-8, like in
	GLib. (#471033) Change "Win32" to "Windows" in doc comments.

2007-08-28  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/common/redeye.c: CLAMP()ing the red value
	so that it is in the 0-255 range. Fixes bug #470914.

2007-08-26  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated msvc build
	* app/main.c : include <io.h> for get_osfhandle()
	* plug-ins/jpeg/jpeg-settings.h : prototype
	jpeg_swap_original_settings

2007-08-26  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmancolorprofilestore.h: Add a G_END_DECLS.

2007-08-24  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): use a label that is
	easier to understand.  Required code changes will follow later.

2007-08-24  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-settings.c (jpeg_swap_original_settings): new
	function that swaps the vertical and horizontal axis for the saved
	subsampling parameters and quantization tables.

	* plug-ins/jpeg/jpeg-exif.c (jpeg_exif_rotate): swap the saved
	settings when the image is rotated.  Fixes bug #466593.

2007-08-24  Raphaël Quinet  <raphael@picman.org>

	* tools/pdbgen/pdb/selection.pdb: fixed incorrect description of
	picman-selection-is-empty, reported by pk.  This function returns
	TRUE when the selection is empty, but the description stated the
	opposite.

	* app/pdb/selection_cmds.c
	* libpicman/picmanselection_pdb.c: regenerated.
	
2007-08-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-draw.c
	(picman_display_shell_draw_area): don't use SCALEX()/SCALEY() on x/y
	*and* width/height of the highlight rectangle because that adds up
	the error introduced by the ceil() contained in these macros.
	Instead, scale manually and use ceil() on x/y and floor() on
	width/height. Fixes off-by-one rendering artifacts (bug #467972).

2007-08-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c: don't use g_slice_dup(), that's
	in GLib 2.14 only.

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: s/compute_sample/box_filter/.

2007-08-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c: allocate shell->highlight with
	GSlice.

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: swapped center and middle
	terms around (now center means horizontal (betwen left and right )and
	middle means vertical (between top and bottom)).

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: (compute_sample): removed
	a temporary variable, simplified logic slightly.
	(render_image_tile_fault, render_image_tile_fault_one_row): moved
	sum computation out of loop.

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: Replaced signed integres with
	unsigned ones for weights etc to gain some additional bits of
	precision. Enabled anti-aliasing for zoomlevels between 100% and 200%
	to improve the smoothness of the display at the levels where the size
	differences between pixels yields the most distracting artifacts.

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	Reshuffled shifting code in fixed point code of display to improve
	quality.

	* app/display/picmandisplayshell-render.c:
		(compute_sample): reshuffle a bit of the fixed point induced
		shifting to allow higher precision.
		(render_image_tile_fault): remove need to disable box-filter
		for some non square zoom ratios that was needed before
		compute_sample cleanup.
		, (render_image_tile_fault_one_row): fetch source sample #1
		from the correct tile.

2007-08-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/scatter_hsv.c: stylistic cleanup.

2007-08-24  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/common/scatter_hsv.c: fixing
	bug #469519 and some cleanup.

2007-08-24  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: (compute_sample)
	fixed a division by zero issue. Fixes bug #469785.

2007-08-24  Michael Natterer  <mitch@picman.org>

	* configure.in: applied patch from Tim Mooney which fixes
	configure output if libexif is not found. Fixes bug #469708.

2007-08-23  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: added a static global
	variable with configuration.
	(compute_sample): moved common computation of alpha*weight factors 
	for channel out of loop.

2007-08-23  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: (compute_sample),
	(render_image_tile_fault), (render_image_tile_fault_one_row):
	refactored to use arrays of tiles/source pixels instead of individual
	variables, also modified the order of the 0..8 numbers to sorted
	in increasing row-major order.

2007-08-22  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: replaced bilinear
	interpolation from next larger pyramid level with a boxfilter
	of the next larger pyramid level.

	This is probably the last update to the quality of the display
	in PICMAN 2.4.

2007-08-21  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_update_with_coord): Don't adjust the
	rectangle shape if it is is merely being moved.

2007-08-20  Michael Natterer  <mitch@picman.org>

	* menus/Makefile.am: s/MAINTAINERCLEAN_FILES/MAINTAINERCLEANFILES/
	Fixes bug #468336.

2007-08-18  Michael Natterer  <mitch@picman.org>
	    Simon Budig  <simon@picman.org>
	    Øyvind Kolås  <pippin@picman.org>
	    Roman Joost  <romanofski@picman.org>

	* app/sven.c: changed license from free to bus2342. Congratulations!

2007-08-18  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c (view_actions_update): use _()
	instead of N_() when setting the label of "Revert Zoom"
	directly. Fixes bug #467933.

2007-08-18  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c: Don't make
	PICMAN_RECTANGLE_CONSTRAIN_NONE into PICMAN_RECTANGLE_CONSTRAIN_IMAGE,
	and restructure the code a bit in the rectangle adjustingo
	functions so that they can handle the _NONE constraint. The effect
	of this change is that rectangle based selection tools no longer
	are constrained when using fixed-rules.

2007-08-18  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_button_press): Clear highlight in previously
	active shell when changing active shell.

2007-08-18  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c (picman_crop_tool_button_release): Call
	picman_crop_tool_update_default_fixed_ratio_options after
	picman_rectangle_tool_button_release, so that the state of the
	rectangle tool is reflected when updating the default aspect.

2007-08-18  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c
	(picman_crop_tool_update_default_fixed_ratio_options): Added a
	'ignore_pending' boolean parameter so that the pending rectangle
	can be ignored in picman_crop_tool_execute, as it should be.

2007-08-17  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c
	(picman_crop_tool_constructor): Connect to the "image-changed"
	signal of PicmanContext and update default aspect when image
	changes (fixes bug #417166), by using
	(picman_crop_tool_update_default_fixed_ratio_options): which is a
	new function that does this. This function is called whenever it
	is time to update defualts.

	* app/tools/picmanrectangletool.[ch]: Made
	picman_rectangle_tool_get_constraint part of the rectangle tool API.

2007-08-17  Michael Natterer  <mitch@picman.org>

	* plug-ins/print/print-page-layout.c: set a default page setup on
	the operation if it is NULL to prevent crash in new installations
	(which don't have a setup yet). Fixes bug #467643, patch from
	Stefan Röllin.

2007-08-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanperspectiveclonetool.c (motion)
	* app/tools/picmansourcetool.c (motion): don't allow to ctrl-switch
	between clone and set-source mode while painting. It's totally
	unclear to me why we used to allow this since it doesn't make much
	sense and isn't very intuitive either. Fixes bug #467605.

2007-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/whirlpinch.c: applied patch from Aurimas Juška to
	fix bug #467368.

2007-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/polar.c: applied patch from Aurimas Juška to fix
	bug #467369.

2007-08-16  Raphaël Quinet  <raphael@picman.org>

	* README: updated Mailing Lists section.

2007-08-16  Sven Neumann  <sven@picman.org>

	* Made 2.4.0-rc1 release, a release candidate for PICMAN 2.4.0.

2007-08-15  Sven Neumann  <sven@picman.org>

	* configure.in: bumped the version to 2.4.0-rc1.

	* README
	* INSTALL: updated for the PICMAN 2.4 release candidate(s).

	* data/images/picman-splash.png: added splash screen for the 2.4
	release candidate(s).

	* app/Makefile.am
	* tools/Makefile.am: adjust targets for 2.4.

2007-08-15  Sven Neumann  <sven@picman.org>

	* data/images: renamed old splash and logo images.

2007-08-15  Øyvind Kolås  <pippin@picman.org>

	Improve resampling when zooming out of the image for zoom-ratios that
	are not powers of two.

	* app/display/picmandisplayshell-render.c: added a bilinear filtering
	like weighting of neighbourhood pixels for approximating the
	downsampling from the next larger level in the projection mipmap.
	Also some general code cleanup. Closes bug #76096.

2007-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c (end_print): added a timeout as a
	workaround for bug #466928.

2007-08-15  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: remove PicmanPlugInDebug typedef.

	* app/plug-in/plug-in-types.h: added it here instead.

	* app/core/picmanchannel-combine.h
	* app/widgets/picmanpropwidgets.[ch]: match parameter names
	in .c, .h and API docs to make gtk-doc happy.

2007-08-15  Joao S. O. Bueno Calligaris <gwidion@mpc.com.br>

        * plug-ins/pypicman/pypicman-drawable.c: avoids function call
	with an invalid drawable id
	
2007-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c: applied patch from Stefan
	Röllin that makes the preview resize with the dialog (bug #466923).

2007-08-15  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorprofilecombobox.c
	* libpicmanwidgets/picmancolorprofilestore.c: documentation.

2007-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/fade-outline.scm: removed
	fade-outline script. Fixes bug #466382.

2007-08-15  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: add tooltips to the profile
	combo boxes.

2007-08-14  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorprofilecombobox.[ch]
	* libpicmanwidgets/picmancolorprofilestore.[ch]
	* libpicmanwidgets/picmancolorprofilestore-private.h: changed API to
	deal with filenames instead of URIs.

	* app/widgets/picmanprofilechooserdialog.[ch]: same here.

	* app/dialogs/preferences-dialog.c
	* plug-ins/common/lcms.c: changed accordingly.

2007-08-14  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c
	* plug-ins/common/lcms.c: don't unref the file-chooser dialog.

2007-08-14  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmancolorprofilecombobox.[ch]
	* libpicmanwidgets/picmancolorprofilestore.[ch]
	* libpicmanwidgets/picmancolorprofilestore-private.h: new widget to
	select color profiles.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* app/widgets/picmanprofilechooserdialog.[ch]: remember the name of
	the last previewed profile.

	* app/dialogs/preferences-dialog.c: use the new color profile
	combo-box.

	* plug-ins/common/lcms.c: use the new color profile combo-box.

2007-08-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-item-list.c: fixed API docs.

2007-08-14  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: Fixed regression at zoom
	levels > 100%, and moved some floating point code out of the worker
	function.

2007-08-14  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/dicom.c
	* plug-ins/common/psd-load.c
	* plug-ins/common/sunras.c: applied patch from Nils Philippsen
	that replaces several calls to g_error() by g_message() and
	picman_quit() so that PICMAN does not complain when a plug-in exits.
	Fixes bug #466610.

2007-08-14  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/dicom.c
	* plug-ins/common/psd-load.c
	* plug-ins/common/sunras.c: applied patch from Nils Philippsen
	that replaces several calls to g_error() by g_message() and
	picman_quit() so that PICMAN does not complain when a plug-in exits.
	Fixes bug #466610.

2007-08-14  Øyvind Kolås  <pippin@picman.org>

	* app/display/picmandisplayshell-render.c: replaced a computed lookup
	table acceleration with fixed point logic.

2007-08-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/csource.c (save_image): fixed calculation of
	alpha value (bug #466402).

2007-08-14  Sven Neumann  <sven@picman.org>

	* libpicman/libpicman-intl.h: define Q_() for translation context.

2007-08-13  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: include glib.h before checking for
	G_OS_WIN32. Also #define STRICT for strict type checks.

2007-08-13  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay.c
	* app/display/picmandisplay-render.c: formatting.

2007-08-13  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c (ts_output_string): Use the
	string length in bytes passed in instead of recalculating it.

	* plug-ins/script-fu/tinyscheme/scheme.c: Added comment.

2007-08-13  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c (picman_histogram_get_std_dev): corrected
	caluclation for the histogram in RGB mode (bug #466189).

2007-08-13  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmannumberpairentry.c: use italic font if not in
	user-override mode.

	* app/tools/picmanrectangleoptions.c: removed auto-mode icon.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-auto-mode-16.png
	* libpicmanwidgets/picmannumberpairentry.[ch]: removed
	PICMAN_STOCK_AUTO_MODE.

2007-08-13  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_pdb_dialog_new): added missing cast.

2007-08-13  Sven Neumann  <sven@picman.org>

	* modules/Makefile.am (libcdisplay_lcms_la_LIBADD): link with
	gdi32 on PLATFORM_WIN32.

	* modules/cdisplay_lcms.c: changed include order to fix the build
	on MingW (see bug #78265).

2007-08-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Put the auto-mode GtkImage to the right of the Aspect ratio/Size
	entry instead of to the left.

2007-08-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Set a 16x16 size request on the auto-mode images.

2007-08-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Right-align X, Y, Width and Height entries.

2007-08-12  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.[ch]: Setup a
	PICMAN_STOCK_AUTO_MODE GtkImage to be shown in the options when
	Fixed: Aspect ratio/Size entries are in auto-mode.

	* themes/Default/images/Makefile.am: Added
	stock-auto-mode-16.png (which is a copy of
	preferences/folders-interp-16.png for now).

	* libpicmanwidgets/picmanstock.[ch]: Added PICMAN_STOCK_AUTO_MODE.

2007-08-12  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	applied patch from Yoshinori Yamakawa that adds code to get the
	monitor profile from Win32.

	* app/dialogs/preferences-dialog.c: enabled the toggle for
	"display-profile-from-gdk" on all systems.

2007-08-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumcombobox.h
	* libpicmanwidgets/picmanenumlabel.h
	* libpicmanwidgets/picmanenumstore.h
	* libpicmanwidgets/picmanenumwidgets.h
	* libpicmanwidgets/picmanpropwidgets.h: added missing G_BEGIN_DECLS
	and G_END_DECLS.

2007-08-11  Michael Natterer  <mitch@picman.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: removed unused rectangle tool
	actions.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: further work on the dialog.

2007-08-11  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanstroke-new.[ch]: formatting.

2007-08-11  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am: renamed files:

	* app/plug-in/plug-in-error.[ch]: old names
	* app/plug-in/picmanpluginerror.[ch]: new names

	* app/plug-in/plug-in-icc-profile.c
	* app/file/file-open.c: changed accordingly.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: factored out code to a utility function.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: don't open the destination profile twice.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c (lcms_icc_apply): if the image has a
	selection, save it, unset it and restore it after the conversion.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c
	* plug-ins/common/tiff-load.c
	* plug-ins/jpeg/jpeg-load.c: made the icc-profile undoable and
	persistent.
	
	* devel-docs/parasites.txt: document this.

	* plug-ins/common/lcms.c: made colorspace conversion undoable.
	
	* app/file/file-open.c: disable undo while doing the colorspace
	conversion on load.

2007-08-11  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]
	* libpicmanbase/picmanenv.[ch]: changed enum PicmanUserDirectory and API
	of picman_user_directory() so that g_get_user_special_dir() can be
	used instead as soon as we depend on GLib 2.14.

	* tools/pdbgen/enums.pl: regenerated.

	* app/widgets/picmanfiledialog.c
	* plug-ins/pypicman/picmanmodule.c: changed accordingly.

2007-08-11  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added "<Image>/Image/Mode/Color Profile"
	as a placeholder below the Image Mode radio items.

	* plug-ins/common/lcms.c (query): register menu entries to assign
	and apply color profiles. Dialog implementation is still missing...

2007-08-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c (picman_crop_tool_execute): Initialize
	'tool' before using it.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h: removed now
	unneeded _skey member from union. Part of the revert of bug #374854.

2007-08-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogramview.c (picman_histogram_view_draw_spike):
	pass the maximum value double and draw the histogram one pixel less
	high. Fixes bug #465669.

2007-08-11  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Commited patch from
	Sven Neumann that reverts the optimization patch which stored
	collation keys. See bug #374854.

2007-08-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_update_handle_sizes): Update handle sizes
	based on the shell-visible part of the rectangle.
	(picman_rectangle_tool_start, picman_rectangle_tool_halt):
	Connect/disconnect to the "scrolled" signal of the shell and
	update handle sizes.

2007-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c (print_size_info_set_resolution):
	applied patch from Stefan Röllin that fixes bug #465527.

2007-08-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_button_release): Halt the tool on cancel if a
	rectangle has not previously been created.

2007-08-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_update_highlight): Renamed from
	picman_rectangle_tool_set_highlight
	(picman_rectangle_tool_button_release): Add call to
	picman_rectangle_tool_update_highlight to keep highlight in sync
	when a crop rectangle is cancelled.

2007-08-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanpropwidgets.c
	(picman_prop_number_pair_entry_number_pair_user_override_notify):
	Only set config user override property when it changed, to avoid
	deadlock.

2007-08-11  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): use a more
	understandable label and a tooltip for the option enabling custom
	quantization tables.

2007-08-10  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg.[ch]
	* plug-ins/jpeg/jpeg-save.[ch]: in the JPEG save dialog, removed
	the option "Force baseline JPEG" and added the new option "Use
	custom quantization tables" to allow resaving a JPEG file with the
	same compression settings as the original file. This is useful if
	the quantization tables are different from those that can be
	created by the IJG JPEG library.

	* plug-ins/jpeg/jpeg-settings.[ch]: updated comments, changed the
	return type of jpeg_restore_original_tables() because the IJG JPEG
	library expects unsigned integers.

2007-08-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmannumberpairentry.c: store separators as
	gunichar array. Use the default separator in case that no
	separator is set. Rewritten picman_number_pair_entry_parse_text()
	to handle non-ASCII separators.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmancroptool.c (picman_crop_tool_button_release): Set
	default 'Fixed: Aspect ratio' values to the size of the pending
	crop rectangle. Fixes bug #355545.

	* app/tools/picmanrectangletool.[ch]
	(picman_rectangle_tool_get_rectangle_size): New helper function.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanpropwidgets.c
	(picman_prop_number_pair_entry_config_notify): Fixed bug where
	property notifications were checked against hardcoded property
	names instead of the ones configured to the
	PicmanPropNumberPairEntryData object.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c: Added
	"default-aspect-numerator", "default-aspect-denominator",
	"default-fixed-size-width" and "default-fixed-size-height" as
	non-serialized tool options, and "overridden-fixed-aspect" and
	"overridden-fixed-size" as serialized ones.

	* app/widgets/picmanpropwidgets.c (picman_prop_number_pair_entry_*):
	Added support for the new PicmanRectangleOptions.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmannumberpairentry.c
	(picman_number_pair_entry_parse_text): Remove code that has not with
	parsing to do, so that clients that use this function can be more
	flexible about what to do with parsing results.
	(picman_number_pair_entry_events): Handle results of parsing here
	instead.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanpropwidgets.[ch]: Merged picman_prop_size_2d_* and
	picman_prop_aspect_ratio_* to picman_prop_number_pair_*.

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Use the merged picman_prop_number_pair_entry_new.

2007-08-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_new_with_dialog): added bug number.

2007-08-10  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): minor
	cleanup.

2007-08-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmannumberpairentry.c: formatting.

2007-08-10  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmannumberpairentry.[ch]: Some minor cleanup, and
	(picman_number_pair_entry_set_user_override)
	(picman_number_pair_entry_get_user_override): are now in the API.

	* libpicmanwidgets/picmanwidgets.def: Updated.

2007-08-09  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmannumberpairentry.[ch]: Added properties for
	most of the instance members, and updated API.
	(picman_number_pair_entry_get_aspect)
	(picman_number_pair_entry_get_default_values)
	(picman_number_pair_entry_get_ratio)
	(picman_number_pair_entry_set_aspect)
	(picman_number_pair_entry_set_ratio): Added API functions.

	* libpicmanwidgets/picmanwidgets.def: Updated.

2007-08-09  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-settings.c: store the selected paper-size.

2007-08-09  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: tweaked label positons.

2007-08-09  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-preview.[ch]: while dragging the preview
	image, draw only an outline.

2007-08-09  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: tweaked spacings on the Color
	Management page.

2007-08-09  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c: fixed the behavior when
	changing the unit.

2007-08-08  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print.c: tweaked layout and changed labels to the
	terms used in the EOG print dialog.

2007-08-08  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c: replaced the two Center buttons
	with a combo-box.

2007-08-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.defs: remove reference to now deprecated
	picman_color_display_new() function.

2007-08-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmannumberpairentry.[ch]: formatting. Fixed use
	of instance private data, added missing parameter checks.

2007-08-08  Martin Nordholts  <martinn@svn.gnome.org>

	Renamed PicmanRatioEntry to PicmanNumberPairEntry, and generalized the
	code a lot, so that it can be used both for 'Fixed: Aspect ratio'
	and 'Fixed: Size'. Support is also added for having default values
	and a 'user overrided' value mode.

	* libpicmanwidgets/picmannumberpairentry.[ch]: Now contains the
	rewrite and generalization of PicmanRatioEntry.
	(picman_number_pair_entry_get_type)
	(picman_number_pair_entry_new)
        (picman_number_pair_entry_set_default_values)
	(picman_number_pair_entry_set_values)
        (picman_number_pair_entry_get_values): New libpicmanwidget API.

	* app/widgets/picmanpropwidgets.[ch] (picman_prop_size_2d_new): Added
	new helper widget for setting up a PicmanNumberPairEntry for the
	Fixed: Size entry in the Rectangle Options.

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Use the new picman_prop_size_2d_entry for the Fixed: Size entry.

	* libpicmanwidgets/picmanwidgets.def: Removed picman_ratio_entry_* and
	added picman_number_pair_entry_*.

	* libpicmanwidgets/picmanwidgets.h * libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/Makefile.am (libpicmanwidgets_2_0_la_sources)
	(libpicmanwidgetsinclude_HEADERS): Updated accordingly.

2007-08-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c (lcms_image_get_profile): fixed a bug
	that I introduced earlier today.

2007-08-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprofilechooserdialog.[ch]: use a text view in a
	scrolled window for the preview area.

2007-08-08  Martin Nordholts  <martinn@svn.gnome.org>

	* libpicmanwidgets/picmanratioentry.[ch]: Migrate entry completion
	code and put responsability on clients to set that up when needed.

	* app/tools/picmanrectangleoptions.[ch]: Setup entry completion code
	manually for the PicmanRatioEntry widgets by using
	(picman_rectangle_options_setup_ratio_completion)
	(picman_ratio_entry_history_select, picman_ratio_entry_history_add):
	these new functions.

2007-08-08  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c
	* plug-ins/common/lcms.c: corrected memory handling.
	cmsOpenProfileFromMem() actually copies the data.

	* libpicmanwidgets/picmancolordisplay.c
	* libpicmanwidgets/picmancolordisplaystack.c: disconnect in dispose().

2007-08-08  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): added missing call to
	destroy_preview(). Fixes bug #464457.

	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg.[ch]: renamed global variables used for the
	preview hack.

2007-08-08  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: added buttons to unset the
	color profiles.

	* app/widgets/picmanpropwidgets.c
	* libpicmanwidgets/picmanpropwidgets.c: minor cleanup.

2007-08-08  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/Makefile.am

	* app/paint-funcs/sample-funcs.[ch]: renamed to 
	* app/paint-funcs/subsample-region.[ch]

	* app/paint-funcs/scale-funcs.[ch]: renamed to 
	* app/paint-funcs/scale-region.[ch]

	* app/paint-funcs/reduce-region.[ch]: new files based on a patch
	from Geert Jordaens (bug #464466).

	* app/base/tile-manager-preview.c
	* app/core/picman-transform-region.c
	* app/core/picmanbrush-scale.c
	* app/core/picmandrawable-preview.c
	* app/core/picmandrawable.c: changed accordingly.

2007-08-08  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c
	(picman_rectangle_options_iface_base_init): Serialize Fixed:
	Width/Height/Size to config.

2007-08-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): fixed
	reference count of the display filter stack.

2007-08-08  Martin Nordholts  <martinn@svn.gnome.org>

	* app/widgets/picmanpropwidgets.[ch]
	(picman_prop_aspect_ratio_new)
	(picman_prop_aspect_ratio_changed): Remove fixed_aspect_property.

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Changed accordingly.

2007-08-08  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.[ch]: Use separate
	desired-fixed-size-width/height properties for Fixed: Size instead
	of sharing properties with Fixed: Width/Height.

	* app/tools/picmanrectangletool.c: Use the two new properties for
	Fixed: Size.

2007-08-07  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c: added entries for the right
	and bottom margins. Use the unit from the image size entry.

2007-08-07  Tor Lillqvist  <tml@novell.com>

	* modules/Makefile.am: Add libpicmancolor to cdisplay_libadd.

2007-08-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c (save_image): in the absence of an
	embedded color profile, write the sRGB chunk.

2007-08-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.c
	* app/core/picmanpalette-load.[ch]: applied slightly modified version
	of a patch from Nicola Archibald that adds support for importing
	Adobe Color palette version 1 files (bug #316618).

2007-08-07  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_pdb_dialog_new): as a workaround for
	bug #360106, set a timeout that presents the dialog window.

	* app/widgets/picmanpdbdialog.c (picman_pdb_dialog_set_property):
	formatting.

2007-08-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_get_icc_profile): return NULL
	if the parasite exists but it is empty.

2007-08-07  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgetstypes.h: removed leftover typedef
	for PicmanResolutionEntry.

	* plug-ins/common/poppler.c: added the typedef here.

2007-08-07  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-error.[ch]: new files defining the
	PicmanPlugIn error domain.

	* app/plug-in/plug-in-icc-profile.c (plug_in_icc_profile_apply_rgb):
	set an error code.

	* app/file/file-open.c (file_open_profile_apply_rgb): only do the
	profile conversion if color management is enabled. If the plug-in
	is missing, show a warning and disable color management.
	Fixes bug #434205.

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_rgb_profile): check
	if we actually got a profile before checking its color space.

2007-08-07  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_menu_map):
	added more mappings from old to new Script-Fu menu locations.

2007-08-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]: added PicmanColorConfig and
	PicmanColorManaged as construct-only properties.
	Deprecated picman_color_display_new().

	* libpicmanwidgets/picmanwidgets.def: updated for new symbols.

	* app/widgets/picmancolordisplayeditor.c: use g_object_new() instead
	of picman_color_display_new().

	* modules/cdisplay_lcms.c: use the image's embedded color profile
	for the display filter. Assume sRGB if no monitor profile is
	configured.

	* app/display/picmandisplayshell.c: 
	* app/display/picmandisplayshell-filter.[ch]: pass the display as
	color-managed object to the display filter.

2007-08-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c: added missing static qualifier.

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-handlers.c: implement the
	PicmanColorManaged interface and delegate it to PicmanImage.

2007-08-06  Manish Singh  <yosh@picman.org>

	* configure.in: specify #include correctly for KEY_OK check.

2007-08-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c (run): simplified.

2007-08-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c (load_rsvg_pixbuf): set the base URI so
	that librsvg can resolve relative paths.

2007-08-05  Sven Neumann  <sven@picman.org>

	* configure.in: don't build linux-input controller module if
	KEY_OK is undefined (bug #463729).

2007-08-05  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated msvc build

2007-08-05  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion): When
	a new rectangle is created and Fixed: Size is used, set rectangle
	function to RECT_MOVING.

2007-08-05  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_auto_shrink):
	Update tool options after shrinking.

2007-08-05  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	Aligned widgets.

2007-08-04  Martin Nordholts  <martinn@svn.gnome.org>

	Update rectangle tool options to bring it closer to the spec. The
	major change is the use of a 'Fixed:' check box and a 'Aspect
	ratio/Width/Height/Size' combo box. The check box is togglable
	with Shift while rubber-banding.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_active_modifier_key): Set other side also
	when Shift is released.
	(picman_rectangle_tool_update_options): Don't supress updates of
	tool options on fixed width/height/size
	(picman_rectangle_tool_apply_fixed_height)
	(picman_rectangle_tool_update_with_coord)
	(picman_rectangle_tool_handle_general_clamping): Use new tool option
	interface and members.

	* app/tools/picmanrectangleoptions.[ch]
	(picman_rectangle_options_iface_base_init)
	(picman_rectangle_options_install_properties)
	(picman_rectangle_options_(get|set)_property): Remove and add
	relevant properties.
	(picman_rectangle_options_private_finalize): Unref the new widgets
	used in tool options.
	(picman_rectangle_options_fixed_rule_changed): New, update tool
	options depending on current option state.
	(picman_rectangle_options_gui): Modified according to change log
	entry summary.
	(picman_rectangle_options_unparent_fixed_rule_widgets): New helper.
	(picman_rectangle_options_fixed_rule_active): New, clients should
	use this to find out if a certain fixed-mode is active.

	* app/tools/tools-enums.[ch]: Added PicmanRectangleToolFixedRule.

2007-08-04  Martin Nordholts  <martinn@svn.gnome.org>

	Don't apply fixed aspect on pending rectangles that are not being
	rubber-banded, when this is changed in the rectangle tool options.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_options_notify):
	Don't synthesize motion for fixed aspect ratio options changes

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui): Removed
	callback to
	(picman_rectangle_options_notify_aspect): which is not needed any more,
	and hence is removed.

2007-08-03  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_menu_map): added a
	map from old to new Script-Fu submenus (to be extended).

2007-08-03  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanoffsetarea.c: applied modified patch from
	Aurimas Juška to improve handling of very small images (bug #463096).

2007-08-02  Michael Natterer  <mitch@picman.org>

	Make sure image thumbnails that are saved or given to plugins are
	constructed synchronously. Fixes bug #461703.

	* app/core/picmanprojection.c (picman_projection_pickable_flush):
	invalidate the preview after constructing the projection.

	* app/core/picmanimagefile.c (picman_imagefile_save_thumb)
	* tools/pdbgen/pdb/image.pdb (image_thumbnail): call
	picman_pickable_flush() on the projection so is constructed now, not
	later.

	* app/pdb/image_cmds.c: regenerated.

2007-08-02  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c (picman_crop_tool_cursor_update): no need
	to set the tool cursor here, we already do that in init() and
	never change it.

	* app/widgets/picmancursor.c (picman_cursor_new): don't show the move
	cursor and the move modifier at the same time. Some small
	cleanups.

2007-08-02  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpegqual.c: sprinkled const qualifiers.

2007-08-02  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpegqual.c: added many options, added a list of
	known quantization tables to make comparisons and identification
	of JPEG files easier.

2007-08-01  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb-parse.c: corrected documentation.

2007-07-31  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.c: formatting.

2007-07-31  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolview.c (picman_tool_view_eye_clicked): don't
	leak the GtkTreePath.

2007-07-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tile.c: this plug-in doesn't need a tile cache.

2007-07-30  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin.[ch]: don't call gp_quit_write() on a
	plug-in with a broken pipe. Fixes bug #460878.

2007-07-30  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c
	* libpicmanbase/picmanwire.c: cosmetic changes.

2007-07-30  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_drawable_update): cosmetics.

2007-07-29  Sven Neumann  <sven@picman.org>

	* app/file/file-open.c
	* app/plug-in/plug-in-icc-profile.c: minor cleanups.

2007-07-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: use g_open() to open the file.
	Should fix filename encoding problems on Win32 (bug #461449).

2007-07-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: also calculate the checksum when loading
	the RGB profile from disk (bug #456017).

2007-07-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/jigsaw.c: applied patch from Aurimas Juška
	that changes the Jigsaw plug-in to use a PicmanAspectPreview instead
	of a PicmanZoomPreview (bug #356716).

2007-07-27  Raphaël Quinet  <raphael@picman.org>

	* tools/Makefile.am (test_clipboard_SOURCES)
	* libpicmanthumb/Makefile.am (picman_thumbnail_list_SOURCES): fixed
	typos: SURCES -> SOURCES.

2007-07-27  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-quality.c (jpeg_detect_quality): simplify the
	formula so that it returns a slightly lower estimated quality when
	there is no exact match with the IJG quantization tables.

2007-07-27  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: factored out utility
	function picman_display_shell_update_focus() which sets the active
	tool into the proper state after the canvas received focus.

	(picman_display_shell_canvas_tool_events): use it here instead of
	duplicating the code 3 times.

	(picman_display_shell_ruler_button_press): use it here too so the
	move and color tools don't do weird things in click-to-focus
	mode (when FOCUS_IN is delivered after BUTTON_PRESS).

2007-07-27  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg.[ch]
	* plug-ins/jpeg/jpeg-save.c (save_dialog): Make the "Save XMP
	data" checkbox insensitive if there is no XMP packet to save.

2007-07-26  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-quality.[ch]
	* plug-ins/jpeg/jpeg-settings.[ch]: new files including functions
	for detecting the quality setting of existing JPEG files by
	analyzing their quantization tables, functions for storing this
	quality and other JPEG settings in a parasite, and functions for
	restoring these values.

	* plug-ins/jpeg/jpeg-load.c (load_image): save the original JPEG
	settings in a parasite after reading the JPEG header.

	* plug-ins/jpeg/jpeg.c (run): restore the original JPEG settings
	if they had been attached to a parasite and if they are better
	than the defaults.

	* plug-ins/jpeg/jpeg-save.c (save_image): added new type of
	subsampling 1x2,1x1,1x1, which is useful for images with height >
	width such as rotated images from some cameras.
	(save_dialog): added hints about how the subsampling types can be
	used, marked these strings as translatable.

	* plug-ins/jpeg/jpegqual.c: new utility to report the quality
	settings and sampling factors of existing JPEG files.

2007-07-26  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicman/picman.def: added missing picman_progress_end

2007-07-26  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: call g_thread_init(), just in case...

2007-07-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/xbm.c: change the default mask file suffix from
	"_mask" to "-mask".

2007-07-26  Michael Natterer  <mitch@picman.org>

	* cursors/cursor-move.png
	* cursors/picman-tool-cursors.xcf
	* cursors/xbm/cursor-move.xbm
	* cursors/xbm/cursor-move-mask.xbm: moved the move cursor two
	pixels right and down so it has its hotspot where the small
	crosshair has it. Reduces cursor jumping in the rectangle tool.

2007-07-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-dnd.c: moved common code into new
	utility function picman_display_shell_dnd_flush(). Also move focus
	to the image window from this function.

2007-07-26  Sven Neumann  <sven@picman.org>

	* app/paint/picmanbrushcore.c (picman_brush_core_interpolate): added a
	sanity check.

2007-07-26  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am: moved contactsheet.scm
	to test_SCRIPTS. We should look at it again after the 2.4 release.

2007-07-26  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c: applied patch from Stefan
	Röllin to save and restore the use-full-page setting (bug #387604).

2007-07-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: only show an error dialog if being
	called interactively.

2007-07-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: removed drawable parameter which was
	ignored anyway.

	* plug-ins/print/print-draw-page.c (draw_page_cairo): reverted
	last change. Instead reimplemented the drawing to fetch the pixels
	directly into the cairo image surface.

2007-07-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-draw-page.c (draw_page_cairo): push a group
	around the image surface fills. This seems to get rid of the white
	stripes in the output.

2007-07-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c (run): always call picman_ui_init(), we need
	funtionality from GTK+, even if called non-interactively.

2007-07-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/progress.pdb: added new procedure picman-progress-end.

	* app/pdb/progress_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-settings.[ch]: end the progress and save
	the settings from the "end-print" handler. The plug-in then
	appears finished but keeps running in the background until it has
	finished the print operation.

2007-07-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: delete the export image from the
	"end-print" handler.

2007-07-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_set_active_modifier_state):
	don't have the tool release ALT when the user releases CONTROL.
	Fixes another stuck modifier instance and other modifier
	weirdness.

2007-07-24  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.20.

2007-07-24  Sven Neumann  <sven@picman.org>

	* Made 2.3.19 development release.

2007-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c: string changes.

2007-07-24  Sven Neumann  <sven@picman.org>

	* authors.xml: added Stefan Röllin.

	* AUTHORS: regenerated.

	* plug-ins/print/print-page-layout.c: applied patch from Stefan
	Röllin to restore image offsets (bug #387604).

2007-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-draw-page.c (create_surface_from_rgba):
	use integer arithmetic to do the compositing.

2007-07-24  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* app/gui/gui.c: depend on gtk+ >= 2.10.13. Fixes bug #436242.

	* configure.in: no need to AC_SUBST() PICMAN_API_VERSION twice.

2007-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.c (main_set_title): use
	g_filename_display_basename() instead of g_path_get_basename().

2007-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: set a print job name.

2007-07-24  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: if we created an export image, delete
	it as soon as possible so it isn't left behind if the user kills
	the plug-in later because of printer problems.

2007-07-23  Mukund Sivaraman  <muks@mukund.org>

	* README: Use ~/.picman-2.3 instead of ~/.picman-2.2.

2007-07-23  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.[ch]: removed image_ID from the
	PrintData struct and made sure that the parasites are read from
	and attached to the original image, not the export image.

2007-07-23  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: don't add an alpha channel.

	* plug-ins/print/print-draw-page.c: always use CAIRO_FORMAT_RGB24.

2007-07-23  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection-construct.c: minor code cleanup.

2007-07-23  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c (print_image): only delete the image if
	picman_export_image() actually created a new one.

	* plug-ins/print/print-page-layout.c: some more dialog layout tweaks.

2007-07-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.[ch]: added convenience function
	picman_action_group_activate_action().

2007-07-20  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/tga.c (ReadImage): added support for reading
	indexed TGA images with transparency information in the colormap.
	These images are now promoted to RGBA.  Fixes bug #445559.
	(save_image): save INDEXEDA images correctly instead of saving
	uninitialized tile data to the file.

2007-07-20  Sven Neumann  <sven@picman.org>

	Applied another patch from Stefan Röllin:

	* plug-ins/print/print-page-layout.c: align buttons.

2007-07-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.c (picman_text_set_property): don't call strlen
	on a NULL font name.

2007-07-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: fixed a gtk-doc comment.

2007-07-20  Sven Neumann  <sven@picman.org>

	* app/menus/menus.c (menus_clear): overwrite the menurc with the
	systemwide default. Only if that fails, delete the menurc file.

	* app/dialogs/preferences-dialog.c: string change.

	* app/core/picman-user-install.c: formatting.

2007-07-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanoffsetarea.c
	* plug-ins/print/print-preview.c: set a cursor to indicate that
	the area is interactive.

	* plug-ins/print/print-page-layout.c: minor dialog tweaks.

2007-07-20  Sven Neumann  <sven@picman.org>

	Applied patch from Stefan Röllin attached to bug #387604:

	* plug-ins/print/print-draw-page.c: take offsets into account.

2007-07-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-quick-mask.[ch]: remember whether a channel
	was active before quick mask was activated. Fixes bug #134371.

2007-07-20  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/faxg3/faxg3.c (query): changed the magic string to
	"Research" starting at offset 4 (this also matches the longer
	string "PC Research, Inc" starting at offset 1).  Addresses a part
	of bug #445559.

2007-07-19  Sven Neumann  <sven@picman.org>

	Applied patch from Stefan attached to bug #387604:

	* plug-ins/print/Makefile.am
	* plug-ins/print/print-preview.[ch]: new files implementing a
	print preview similar to PicmanOffsetArea.

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c: adds GUI to adjust the offsets.

2007-07-19  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: renamed picman_image_active_drawable() to
	picman_image_get_active_drawable().

	* app/[lots of files]
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

2007-07-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmancolortool.c (picman_color_tool_draw): chain up.

2007-07-18  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanprocedure.[ch] (picman_procedure_set_strings): added
	const qualifiers.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/sample-funcs.c: unified subsampling code.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/Makefile.am
	* app/paint-funcs/scale-funcs.[ch]
	* app/paint-funcs/sample-funcs.[ch]: moved subsample_region() to
	new file and also moved subsample_indexed_region() there.

	* app/base/tile-manager-preview.c
	* app/core/picmandrawable-preview.c: changed accordingly.

2007-07-17  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg-load.c: Removed obsolete libjpeg error
	manager that was disabling the loading of EXIF data.

2007-07-17  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image): fixed build for
	HAVE_EXIF being undefined.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager-preview.[ch]: added
	tile_manager_get_sub_preview().

	* app/core/picmandrawable-preview.c: use the new function except for
	indexed drawables.

2007-07-17  Raphaël Quinet  <raphael@picman.org>

	Reorganized the way JPEG comments and metadata are loaded.

	* plug-ins/jpeg/jpeg-load.c (load_image): sanitize comments
	containing invalid UTF-8 instead of discarding them.  If there is
	more than one EXIF block in a file, merge all of them instead of
	keeping only the block that contains a thumbnail image (see also
	bug #446809 and bug #358117).  Process XMP after EXIF.

	* plug-ins/jpeg/jpeg.h: include two null characters as part of the
	EXIF header.

	* plug-ins/jpeg/jpeg-exif.c: added jpeg_exif_get_orientation(),
	removed jpeg_apply_exif_data_to_image() because this is now done
	directly in jpeg-load.c.

	* plug-ins/jpeg/jpeg-icc.c
	* plug-ins/jpeg/jpeg-icc.h: removed jpeg_icc_setup_read_profile()
	because jpeg_save_markers() is used directly in jpeg-load.c.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/tile-manager-preview.[ch]: added new file that holds code
	to create a preview from a tile manager.

	* app/core/picmanbuffer.c
	* app/core/picmanimage-preview.c: use the new function instead of
	duplicating this code.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.c (scale_region_no_resample): use
	64 bit integers to avoid an overflow. Fixes bug #457209.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.c: gracefully deal with empty
	colormaps.

2007-07-17  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_setup_exif_for_save): include
	PICMAN version number in the EXIF "software" tag.  This makes it
	easier to debug issues related to metadata.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/core/picman.c (picman_finalize): free the context list.

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	removed unused vbox.

2007-07-17  Simon Budig  <simon@picman.org>

	* app/text/picmantext-private.h
	* app/text/picmantextlayout.c
	* app/text/picmantextlayout-render.c: Fix text rendering for xres != yres.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmenudock.c (picman_menu_dock_new): unref the context.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/core/picmantoolinfo.c (picman_tool_info_new): use the tool-info
	identifier as the name of the tool-options object.

	* app/paint/picmanpaintoptions.c (picman_paint_options_new): use the
	paint-info identifier as the name of the paint-options object.

	* app/paint/picman-paint.c (picman_paint_register): added parameter check.

	* app/tools/picman-tools.c (picman_tools_init): formatting.

2007-07-17  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginprocedure.c
	(picman_plug_in_procedure_set_file_proc): plugged tiny memory leak.

	* libpicmancolor/picmanrgb.c (picman_rgb_min) (picman_rgb_max): formatting.

2007-07-17  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfigwriter.c (picman_config_writer_finish):
	don't free the writer struct too early.

2007-07-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-new.c (picman_image_new_get_last_template): sync
	with the default template. Fixes bug #457286.

2007-07-16  Sven Neumann  <sven@picman.org>

	* plug-ins/uri/uri.c
	* plug-ins/uri/uri-backend.h: get the procedure help strings from
	the backend abstraction.

	* plug-ins/uri/uri-backend-gnomevfs.c
	* plug-ins/uri/uri-backend-libcurl.c
	* plug-ins/uri/uri-backend-wget.c: provide help strings.

2007-07-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: only register one save MIME handler.
	Fixes bug #457045.

2007-07-15  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (struct
	_PicmanRectangleToolPrivate): Added members to keep track of for
	what shell scale the handle sizes were calculated. This is
	necessary so that in
	(picman_rectangle_tool_control): we only update the handle sizes
	when the zoom level has changed. We must test this, because the
	tool is also paused/resumed when highlightning is on, and we don't
	want to update handle sizes just because highlightning happends to
	be on.
	(picman_rectangle_tool_scale_has_changed): Added helper function.

2007-07-14  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_set_highlight): Check against
	tool->display == NULL, this check was lost when this function
	was moved out of picman_rectangle_tool_configure.

2007-07-14  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_control):
	Also update rectangle handle sizes when canvas zoom is
	changed. (Forgot that in previous commit.)

2007-07-14  Martin Nordholts  <martinn@svn.gnome.org>

	Made the rectangle tool handles not resize during rectangle
	manipulation, as outlined in the spec, by separating highlight
	updating and handle size updating calls.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_configure):
	Renamed to
	(picman_rectangle_tool_update_handle_sizes): and moved
	picman_rectangle_tool_set_highlight out of it. These two are now
	called independantly.

2007-07-14  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_clamp_width)
	(picman_rectangle_tool_clamp_height): Fixed crash when creating a
	rectangle with constraints outside of canvas bounds.

2007-07-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_button_release): Don't execute selection if a
	dead area is clicked.

2007-07-13  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_active_modifier_key): Update handle sizes and
	highlight area also when Ctrl is released.

2007-07-13  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/psd-load.c (load_image): safeguard to avoid
	crashes while loading corrupt PSD images.  Fixes bug #327444.

2007-07-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-load.c: use g_printerr() for debug output.

2007-07-12  Sven Neumann  <sven@picman.org>

	Work around Pango appending " Not-Rotated" to font names:

	* app/text/picmantext.c (picman_text_set_property)
	* app/text/picmanfontlist.c (picman_font_list_add_font): strip
	" Not-Rotated" from the font name.

2007-07-12  Sven Neumann  <sven@picman.org>

	* authors.xml: added two more contributors.

2007-07-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-load.c: don't divide by zero when loading a
	layer or mask with zero width or height. Fixes bug #456042.

2007-07-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: clarify which procedures work with RGB
	profiles and which accept profiles for other colorspaces.
	Calculate MD5 checksums of the profile data excluding the header
	and skip attempts to convert between identical profiles (bug #456017).

2007-07-11  Sven Neumann  <sven@picman.org>

	* data/brushes/Calligraphic-Brush-*.vbr
	* data/brushes/Circle-*.vbr
	* data/brushes/Diagonal-Star-*.vbr: restored spacing values. Closes
	bug #157506 again.

2007-07-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/chrome-it.scm
	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/selection-round.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/swirltile.scm
	* plug-ins/script-fu/scripts/waves-anim.scm: added leading zero to
	floating point numbers.

2007-07-11  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c: Removed bitfieldized values from
	the SideToResize enum, they are irrelevant. Also renamed
	HANDLE_SIZE to MAX_HANDLE_SIZE.

2007-07-10  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/3dTruchet.scm: TinyScheme doesn't like
	inexact numbers to start with a decimal point. Added leading '0' to
	two instances of '.2'.

2007-07-10  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg-save.[ch]: fixed an issue with the latest
	changes. Now "Load Defaults" does also work if "Save Defaults"
	wasn't used before.

2007-07-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_setup): added evil hack to work
	around bug #327243 in GtkFileChooserButton.

2007-07-09  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg.c (run): when the save procedure is being
	called with PICMAN_RUN_WITH_LAST_VALS and the image doesn't have the
	"jpeg-save-options" parasite set, show the dialog to give the user
	control over the JPEG encoding parameters.

2007-07-08  Martin Nordholts  <martinn@svn.gnome.org>

	Completely rewrote logic in picman_rectangle_tool_motion, in effect
	also fixing bug #353936 and bug #398188. The general strategy now
	is to have specialized functions doing one thing, and one thing
	only.

	The patch also makes adjusting the rectangle through the keyboard
	and through the rectangle tool options follow tool options.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion):
	Completely refactored.

	(picman_rectangle_tool_active_modifier_key):
	(picman_rectangle_tool_synthesize_motion): Submit to tool options.

	(picman_rectangle_tool_apply_coord)
	(picman_rectangle_tool_clamp)
	(picman_rectangle_tool_clamp_width)
	(picman_rectangle_tool_clamp_height)
	(picman_rectangle_tool_keep_inside)
	(picman_rectangle_tool_keep_inside_horizontally)
	(picman_rectangle_tool_keep_inside_vertically)
	(picman_rectangle_tool_apply_fixed_width)
	(picman_rectangle_tool_apply_fixed_height)
	(picman_rectangle_tool_apply_aspect)
	(picman_rectangle_tool_update_with_coord)
	(picman_rectangle_tool_get_constraints)
	(picman_rectangle_tool_handle_general_clamping): The new specialized
	functions.

2007-07-08  Martin Nordholts  <martinn@svn.gnome.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_active_modifier_key): Block
	picman_rectangle_tool_options_notify when changing fixed-aspect
	through the shift key. Fixes bug #417168.

2007-07-08  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg-save.[ch]: applied patch from Etienne which
	adds configurable default parameters similar to the PNG save plug-in.
	Addresses bug #63610.

2007-07-08  Michael Natterer  <mitch@picman.org>

	* app/actions/select-actions.c (select_actions): renamed action
	"selection-editor-popup" to "selection-popup". Fixes bug #454364.

	* app/widgets/picmandockable.c (picman_dockable_show_menu): warn when
	above bug happens instead of failing silently.

2007-07-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/channel_mixer.c: minor layout tweak.

	* libpicmanwidgets/picmanpreviewarea.c (picman_preview_area_set_colormap):
	clear the colormap to all zeros before setting the new colors.

2007-07-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-load.c
	* plug-ins/common/psd-save.c: use UTF-16 encoding instead of UCS-2
	for layer names (bug #445316).

2007-07-06  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_name_canceled): removed debug output.
	(picman_container_tree_view_clear_items)
	(picman_container_tree_view_remove_item): removed warning; the bug
	this warning referred to has been closed as WONTFIX.

2007-07-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-load.c (do_layer_record): applied part of a
	patch from John Marshall that fixes handling of the short layer
	name (bug #445316).

2007-07-06  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c (xcf_load_image): marked two error messages
	as translatable strings.

	* libpicmanbase/picmanutils.c (picman_any_to_utf8): insert a blank
	before the text that marks the string as invalid.

2007-07-06  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/sunras.c: validate size values read from files
	before using them to allocate memory.

2007-07-06  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/psd-load.c: validate size values read from files
	before using them to allocate memory.

2007-07-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/displace.c: applied patch from Ulf-D. Ehlert
	that fixes disappearing buttons (bug #454011).

2007-07-05  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/psp.c: finished error handling cleanup.

2007-07-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psp.c: some cleanup to the error handling.

2007-07-05  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/psd-load.c (do_layer_record): check for invalid
	number of channels in a layer.

	* plug-ins/common/pcx.c (load_image): check for invalid image
	width or height.

	* plug-ins/bmp/bmpread.c: check for invalid image width or height,
	return if the image could not be read instead of trying to set the
	resolution or to flip a non-existing image.

2007-07-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanerrordialog.c (picman_error_dialog_add): don't
	count the number of repeated messages when the error messages are
	being redirected to stderr already.

2007-07-05  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-read.c (xcf_read_int32) (xcf_read_int8): return the
	number of bytes that have been read from the file.

	* app/xcf/xcf-load.c (xcf_load_prop): return FALSE when reading fails.

2007-07-05  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb.pl (arg_parse): allow the use of constants when
	specifying limits for a PDB type.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb: use PICMAN_MAX_IMAGE_SIZE as limit for
	image and drawable sizes.

	* tools/pdbgen/pdb/selection_tools.pdb: added missing include.

	* app/pdb/channel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2007-07-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_corner): changed
	the highlighting of the side handles to follow changes in the
	specification.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw): cosmetics.

2007-07-05  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/psp.c (read_layer_block): allow layer dimensions
	larger than 32768 while still checking for integer overflows.

2007-07-04  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/pnm.c (load_image)
	* plug-ins/common/psp.c (read_layer_block)
	* plug-ins/common/sunras.c (load_image)
	* plug-ins/common/xbm.c (load_image)
	* plug-ins/common/xwd.c (load_image): validate size values read
	from files before using them to allocate memory (bug #451379,
	thanks to Sean Larsson of iDefense Labs).

2007-07-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/psd-load.c: validate size values read from files
	before using them to allocate memory.

2007-07-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/dicom.c: validate size values read from files
	before using them to allocate memory.

2007-07-04  Sven Neumann  <sven@picman.org>

	* app/paint/picmanbrushcore.[ch]: applied patch from Jens Persson
	that adds a LUT to apply the jitter in polar coordinates (bug #434532).

2007-07-02  Tor Lillqvist  <tml@novell.com>

	* configure.in: Fix bug in saving/restoring LDFLAGS around the
	DirextX DirectInput tests.

2007-06-30  Martin Nordholts  <martinn@svn.gnome.org>

	Started taking PicmanRectangleTool towards the new specification.
	The side handles now have the same width and height as the
	corresponding corner handles, and the size of the side handles do
	not span across the whole rectangle. Side handles also have a
	limited mimimum size, just as corner handles.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_oper_update,
	picman_rectangle_tool_draw, picman_rectangle_tool_configure,
	picman_rectangle_tool_get_anchor): Changed accordingly.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_corner): Changed
	accordingly.

2007-06-29  Martin Nordholts  <martinn@svn.gnome.org>

	Made PicmanRectangleTools remember where the "other side" is when
	fixed-center is turned on, and reset the "other side" to that position
	when fixed-center is turned off again. Fixes bug #398183.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_button_press): Remember "other side".
	(picman_rectangle_tool_active_modifier_key): When fixed-center is turned
	off, reset "other side".
	(picman_rectangle_tool_get_other_side)
	(picman_rectangle_tool_get_other_side_coord)
	(picman_rectangle_tool_set_other_side_coord): New functions.

2007-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/xmp-encode.c
	* plug-ins/metadata/xmp-model.c: don't include picmanui.h.

	* plug-ins/metadata/Makefile.am: don't build interface.c, don't
	link with libpicmanui and libpicmanwidgets.

	* plug-ins/metadata/metadata.c: don't register the metadata editor.

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagecommenteditor.[ch]: fixed spelling error.

	* app/widgets/picmancolorpanel.[ch]: applied slightly modified patch
	from Tor Lillqvist that changes the ColorPanel to provide live
	updates (bug #451568).

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerlist.c (picman_controller_list_init):
	use GTK_STOCK_PROPERTIES instead of GTK_STOCK_EDIT.

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c: as suggested by the HIG, use
	Alt-Return as default shortcut for the Image Properties dialog.

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.c: show the full filename instead
	of the basename and ellipsize it. The tooltip was too hard to
	discover.

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimagecommenteditor.[ch]: new widget derived from
	PicmanImageParasiteView. Basically the code that used to live in
	image-properties-dialog.c.

	* app/dialogs/image-properties-dialog.c: use the comment editor.

2007-06-27  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-properties-dialog.c: allow to edit the comment.

	* app/widgets/picmanimageprofileview.c: enable line wrapping.

2007-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tile.c (tile): call picman_drawable_update() on
	the destination drawable.

	* plug-ins/common/tiff-load.c: formatting.

2007-06-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_clear)
	(picman_image_map_do): update the image, not the drawable so we
	avoid constantly invalidating the drawable preview.

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_response):
	invalidate the drawable preview here.

	* app/paint/picmanpaintcore.c (picman_paint_core_paste)
	(picman_paint_core_replace): clean up drawable offset handling code.

2007-06-27  Michael Natterer  <mitch@picman.org>

	Removed useless image flushing which caused the image preview to
	be updated needlessly:

	* app/core/picmanimagemap.c (picman_image_map_do): don't flush the
	image when the idle rendering is completed, emit our own "flush"
	signal instead just as for the incremental display updates.

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_notify_preview):
	when switching off the preview don't flush the image, only flush
	projection and display.

2007-06-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-properties-dialog.c
	* app/widgets/picmanimageprofileview.c: added margins to text views.

2007-06-26  Michael Natterer  <mitch@picman.org>

	Invalidate the image preview after the projection is
	completely constructed. Fixes bug #449141.

	* app/core/picmanmarshal.list: add VOID:BOOLEAN

	* app/core/picmanimage.[ch]: add boolean parameter
	invalidate_preview to the "flush" signal.

	* app/core/picmanprojection.[ch]: add boolean member
	invalidate_preview to the PicmanProjection struct. Set it to TRUE if
	it was TRUE in the image's "flush" signal. When the projection is
	completely constructed after a flush, invalidate the image's
	preview.

	* app/display/picmandisplay-handlers.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmanimageeditor.c: changed callback signatures
	accordingly.

2007-06-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimageprofileview.c (picman_image_profile_view_query):
	use the name if the description is empty.

2007-06-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c: unset the active color picker when
	the dialog is unmapped. Fixes bug #451272.

	* app/tools/picmanimagemaptool.c: formatting.

2007-06-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-properties-dialog.c
	* app/widgets/picmanimageprofileview.[ch]: show comment and color
	profile in text views instead of using labels. Deals much better
	with longer texts.

2007-06-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.c
	(picman_image_prop_view_label_set_filename): set the full name as
	tooltip.

2007-06-25  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-resize.c: applied patch from Geert
	Jordaens that reimplements the algorithm to determine the largest
	rectangle. Fixes bug #412473.

2007-06-25  Sven Neumann  <sven@picman.org>

	* configure.in: removed extra check for gthread and fold it into
	the GLIB and GTK checks.

	* */Makefile.am: changed accordingly.

	* app/main.c (main): always call g_thread_init().

2007-06-25  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.c: if the wire protocol is used without
	prior initialization, abort with g_error() instead of crashing.

2007-06-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (gradmap_tile_validate): initialize
	the destination pixel region properly. Fixes bug #450291.

2007-06-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (gradmap_tile_validate)
	(find_max_gradient) minor code cleanup.

2007-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/newsprint.c (newsprint_dialog): corrected spacing.

2007-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/align_layers.c: set the minimum grid size to 1.
	Fixes bug #450001.

2007-06-22  Martin Nordholts  <martinn@svn.gnome.org>

	* app/core/picmanprojection-construct.c (picman_projection_initialize):
	Only consider layers with combine mode Normal when testing if any
	layer covers the entire specified area. Fixes bug #440154.

2007-06-22  Sven Neumann  <sven@picman.org>

	* app/core/picman.c (picman_restore): note that loading fonts may take
	a while (on Win32 at least).

2007-06-21  Martin Nordholts  <martinn@svn.gnome.org>

	* app/display/picmandisplayshell-render.c (picman_display_shell_render):
	Refactored the two helper functions render_image_init_info(_full)?
	and always use the shell base scale for the shell->mask. Fixes
	bug #448417.

2007-06-21  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfigwriter.c (picman_config_writer_finish):
	if an error occured while writing the file, propagate the error
	and return FALSE.
	(picman_config_writer_flush): improved error message.

2007-06-21  Sven Neumann  <sven@picman.org>

	* app/base/base-types.h
	* app/base/tile-manager.[ch]
	* app/base/tile-manager-private.h: removed accessors for user_data.
	Instead pass the user_data when setting the validation proc.

	* app/base/tile-pyramid.c
	* app/core/picmanchannel.c
	* app/core/picmanprojection.c
	* app/core/picmanselection.c
	* app/tools/picmaniscissorstool.c: changed accordingly.

2007-06-21  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.[ch]
	* app/base/tile-manager-private.h: removed "level_below" from the
	TileManager struct.

	* app/base/tile-pyramid.c: use the TileManager's user_data to
	store a pointer to the lower level.

2007-06-21  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.[ch]: use gboolean for boolean parameters.

	* app/base/tile-pyramid.c (tile_pyramid_get_memsize): pass TRUE
	for sparse to tile_manager_get_memsize().

	* app/base/tile.c
	* app/base/tile-swap.c: minor cleanups.

	* app/core/picmanprojection.c (picman_projection_get_tiles_at_level):
	inline the creation of the TilePyramid.

2007-06-21  Michael Natterer  <mitch@picman.org>

	Make sure the image preview is only invalidated for visible
	image changes (as it was before the change below).

	* app/core/picmanimage.h (struct PicmanImageFlushAccumulator): added
	member "gboolean preview_invalidated".

	* app/core/picmanimage.c (picman_image_update): set it to TRUE here.

	(picman_image_real_flush): inavlidate the preview only if
	flush_accum.preview_invalidated is TRUE.

2007-06-21  Michael Natterer  <mitch@picman.org>

	Part one of fix for bug #449141 (fixes the projection but still
	leaves some image previews unupdated).

	* app/core/picmanimage.c (lots of functions)
	* app/paint/picmanpaintcore.c (picman_paint_core_finish)
	* app/file/file-open.c (file_open_sanitize_image): removed calls
	to picman_viewable_invalidate_preview(image).

	* app/file/file-open.c (file_open_sanitize_image): update and
	flush the entire image instead. Load plug-ins are not required to
	call picman_drawable_update() or anything else to make sure the
	projection is up-to-date.

	* app/core/picmanimage.c (picman_image_real_flush): invalidate the
	image preview here because we now create it from the projection.
	(this is still not the entirely correct place though).

2007-06-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c: introduced local variables in an
	attempt to make the code a little more readable.

2007-06-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/scale-dialog.c: use the term "layer masks".

2007-06-20  Sven Neumann  <sven@picman.org>

	* app/base/tile-pyramid.[ch]: documentation.

2007-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c (autocrop): fixed an issue with the
	fix for bug #413906.

2007-06-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: applied patch from Paul Seidel
	with further improvements to the playback speed control (bug #338380).

2007-06-20  Sven Neumann  <sven@picman.org>

	* app/base/tile-pyramid.c (tile_pyramid_write_quarter): added missing
	implementations for 1 and 3 bytes per pixel.

2007-06-20  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/base-types.h
	* app/base/tile-pyramid.[ch]: image pyramid code split out of
	PicmanProjection.

	* app/core/picmanprojection.[ch]: use the new TilePyramid.

2007-06-20  Sven Neumann  <sven@picman.org>

	* app/base/tile.[ch]: removed unused function tile_mark_valid().

	* app/base/tile-manager.[ch]: removed unused public API and cleaned
	up internals used for invalidating tiles.

2007-06-20  Sven Neumann  <sven@picman.org>

	* app/base/tile-private.h (struct _Tile): removed unused field
	swap_num.

	* app/base/tile.c (tile_new): initialise most of the Tile struct
	in the allocator.

2007-06-20  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c (init_constants): hardcode
	the built-in units. Dynamically constructing the constants using
	picman_unit_get_singular() doesn't work because it returns a
	translated string.

2007-06-20  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c (script_fu_cc_key_function):
	applied patch from Eric Lamarque with some minor modifications.
	Fixes the remaining aspect of bug #438997.

2007-06-20  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanplugin.c: In GLib 2.13 pipe() is no longer
	defined as a macro in gwin32.h. Define it here in that case.

2007-06-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleselectoptions.c
	(picman_rect_select_options_gui): set proper step and page
	increments in the scale entry for the corner radius.

2007-06-18  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (picman_iscissors_tool_draw): free
	live-wire Curve segment using g_slice_free().

2007-06-18  Sven Neumann  <sven@picman.org>

	* app/file/file-open.c (file_open_from_command_line): use
	picman_message() for error handling.

	* plug-ins/common/psd-load.c (seek_to_and_unpack_pixeldata): check
	channel dimensions to avoid potential integer overflow. Some minor
	cleanups to error messages.

2007-06-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: applied modified patch from
	Paul Seidel that adds controls for the playback speed (bug #338380).

2007-06-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/oilify.c: applied patch from Daniel Richard G.
	which adds a new PDB entry with more options and improves speed
	and quality of the algorithm (bug #347075).

2007-06-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_get_level): take the
	image size into account and return the level that is actually used.
	Fixes bug #448185.

2007-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-save.c: coding style improvements.

2007-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-save.c: applied patch from Eric Ross that
	changes the PSD save plug-in to save an extra data block with the
	layer names in UCS-2 encoding (bug #447267).

2007-06-15  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c (view_actions_update): make sure all
	view actions are insensitive when there is no view.

2007-06-15  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-dobject.c: prepend instead of appending to
	list (patch written earlier).

2007-06-14  Sven Neumann  <sven@picman.org>

	* app/core/picmandatafactory.c
	(picman_data_factory_refresh_cache_remove): micro optimization.

2007-06-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmandatafactory.c (picman_data_factory_data_foreach):
	remove calls to container_freeze() and container_thaw()

	(picman_data_factory_data_reload)
	(picman_data_factory_data_free): add them here instead.

	(picman_data_factory_data_save): remove freeze/thaw calls here
	without any replacement. The list doesn't change by saving its
	items. Fixes insanely long quit time when there are many data
	objects.

2007-06-14  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c: implement the PicmanColorManaged interface.

2007-06-14  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/Makefile.am (picman_thumbnail_list_LDADD): fixed
	parallel builds (bug #447402).

2007-06-13  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: prepend instead of appending to list.

2007-06-13  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (putchars): Update "cursor"
	after writing characters to a string buffer. Fixes bug #446884.

2007-06-13  Sven Neumann  <sven@picman.org>

	* app/app.c (app_exit_after_callback): if PICMAN_UNSTABLE is
	undefined before calling exit() call tile_swap_exit(), not
	base_exit().

2007-06-13  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_exit): call tile_cache_exit() before
	tile_swap_exit(). tile_cache_exit() may use the tile swap in
	pathological cases.

	* app/base/tile-cache.c (tile_cache_exit): warn if the tile cache
	is not empty.

2007-06-13  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c: minor cleanup.

2007-06-13  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: small fix to the previous commit
	in how layers are skipped.

2007-06-13  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: don't load any layers from a TIFF
	directory which don't match the mode of the first image in the TIFF
	directory.

2007-06-13  Sven Neumann  <sven@picman.org>

	* app/errors.[ch]: added errors_exit() and unset the Picman
	reference. Errors may occur after the Picman object has been finalized.

	* app/app.c (app_run): call errors_exit().

2007-06-12  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image): Instead of passing any
	file to libexif blindly, check first that some JPEG APP1 marker
	contains the EXIF header.

	* plug-ins/jpeg/jpeg-exif.c (jpeg_apply_exif_data_to_image):
	removed the tests that were checking for the presence of some EXIF
	tags such as the EXIF version before deciding if the data should
	be processed or not (bug #446809).

2007-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c: initialize the GtkAdjustment used
	for the rotation angle; fixes bug #446681.

2007-06-12  Sven Neumann  <sven@picman.org>

	* app/base/boundary.c (simplify_subdivide): eliminate calls to sqrt().

2007-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd-load.c: applied slightly modified patch from
	Eric Ross that adds support for loading long layer names from the
	extra layer data section (bug #445316).

2007-06-11  Sven Neumann  <sven@picman.org>

	Applied patch from Zbigniew Chyla that further improves the
	boundary_sort() performance (bug #388538):

	* base/boundary.c (cmp_xy): use "y" coordinate as more significant
	one, i.e. compare (ay, ax) to (by, bx), not (ax, ay) to (bx, by).

	* configure.in: bumped version to 2.3.19.

2007-06-11  Sven Neumann  <sven@picman.org>

	* Made 2.3.18 development release.

2007-06-11  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/raw.c (run): if load_image fails, return
	PICMAN_PDB_EXECUTION_ERROR

	* plug-ins/twain/twain.c (run): added missing ;

2007-06-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrenderer.c (picman_view_renderer_init):
	initialize width and height to zero. Fixes bug #446005.

2007-06-11  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-preview.c: don't disable image previews when
	layer previews are disabled. We do not any longer create the image
	preview from the layer previews.

	* app/core/picmanimagefile.c
	* app/widgets/picmanthumbbox.c
	* tools/pdbgen/pdb/image.pdb: thumbnail rendering is not any
	longer disabled if layer previews are turned off.

	* app/config/picmanrc-blurbs.h (THUMBNAIL_SIZE_BLURB): removed note
	that has become invalid by the change above.

	* app/core/picmanitem-preview.c: cosmetics.

	* app/pdb/image_cmds.c: regenerated.

2007-06-11  Sven Neumann  <sven@picman.org>

	* plug-ins/twain/twain.c (run): moved run_mode initialisation up a
	few lines.

	* app/tools/picmanscaletool.c: removed unused variable.

2007-06-11  Mukund Sivaraman  <muks@mukund.org>

	* configure.in: bumped required libexif version to 0.6.15. This
	seems to fix #358117 for the various test images that were reported
	in it, and its duplicates. This version is in Debian testing and
	Fedora 7.

2007-06-11  Sven Neumann  <sven@picman.org>

	Applied the second patch from Zbigniew Chyla. Improves
	boundary_sort() performance by reducing its time complexity from
	O(n*n) to ~O(n*log n) (bug #388538).

	* app/base/boundary.c (boundary_sort): prepare two arrays of
	pointers to segments, each sorted by different pair of
	coordinates ((x1,y1) and (x2,y2)); use new find_segment(),
	passing both arrays to it.
	(find_segment): new implementation that employs binary search to
	find matching segment, using sorted arrays prepared by
	boundary_sort().

2007-06-11  Sven Neumann  <sven@picman.org>

	Applied patch from Zbigniew Chyla from bug #388538:

	* app/base/boundary.c (boundary_sort): simplified a bit by
	replacing "while" with "for" loop, now we don't search from the
	beginning of the array in each iteration.

2007-06-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-resize.[ch]: added
	picman_image_resize_to_selection().

	* app/actions/image-actions.c
	* app/actions/image-commands.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/image-menu.xml.in: added an action and a menu item for it.
	Fixes bug #335672.

	* plug-ins/common/align_layers.c: resolved a conflicting mnemonic.

2007-06-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanselection.c (picman_selection_extract): fixed
	parameter passed to picman_image_get_background(). Fixes bug #445719.

2007-06-08  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.h: Applied patch from Daniel
	Richard G. that defines SCHEME_EXPORT as extern for non-Windows
	systems. Fixes bug #444964.

2007-06-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_alloc_levels): use
	a bit shift instead of a shift and a division.
	(picman_projection_invalidate): same change here.

2007-06-08  Sven Neumann  <sven@picman.org>

	Applied parts of a patch from Daniel Richard G. (bug #445374):

	* themes/Default/images/Makefile.am
	* data/tips/Makefile.am
	* menus/Makefile.am: more srcdir/builddir tweaks.

2007-06-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.h: #define PICMAN_VIEWABLE_PRIORITY_IDLE,
	which is even lower than G_PRIORITY_LOW.

	* app/core/picmanundo.c
	* app/widgets/picmanviewrenderer.c: create previews with
	PICMAN_VIEWABLE_PRIORITY_IDLE so that they are run after the
	projection has been invalidated.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c: formatting.

2007-06-07  Manish Singh  <yosh@picman.org>

	* configure.in: display better error message if PyGTK is too old.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_validate_pyramid_tile):
	folded into a single loop.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_write_quarter):
	weight the pixels by their alpha value.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: removed the boolean from the PicmanImage
	struct that used to track whether the preview was valid.
	(picman_image_invalidate_preview): just set the preview to NULL.

	* app/core/picmanimage-preview.c (picman_image_get_new_preview):
	construct the preview from the projection instead of compositing
	the drawable previews.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c: lazily allocate the tile managers of
	the image pyramid.
	(picman_projection_write_quarter): minor optimization.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/text/Makefile.am
	* app/core/Makefile.am
	* app/tools/Makefile.am
	* app/display/Makefile.am
	* app/widgets/Makefile.am
	* app/base/Makefile.am
	* app/paint/Makefile.am
	* app/plug-in/Makefile.am
	* libpicman/Makefile.am
	* libpicmanthumb/Makefile.am
	* tools/pdbgen/Makefile.am
	* libpicmanwidgets/Makefile.am: applied the remaining parts of the
	patch from Daniel Richard G. to fix out-of-source-tree builds
	(bug #444960).

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_get_level):
	reimplemented without using a logarithm.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am
	* menus/Makefile.am: when calling xsltproc, use the stylesheet from
	$(srcdir). From the patch attached to bug #444960.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am: bail out with an error if xsltproc is
	missing and authors.h needs to be regenerated.

	* libpicmanwidgets/Makefile.am: let picmanwidgets-private.lo, not the
	C file, depend on picman-wilber-pixbufs.h. From the patch attached to
	bug #444960.

2007-06-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/tips-dialog.c: converted to a PicmanDialog.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.[ch]: minor API cleanup. Use horizontal
	and vertical scale to determine the pyramid level to use.

	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell-render.c: follow the API change.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c: cosmetics.

2007-06-06  Martin Nordholts  <martinn@svn.gnome.org>

	Implemented an image pyramid for the PicmanProjection. An image
	pyramid caches a projection at several sizes, causing the
	rendering code not to have to swap in all tiles of a (potentially)
	large image; it can use small versions of the projection if the
	user is zoomed out.

	The image pyramid also imroves visual quality, especially at zoom
	levels where there is a pyramid level that matches perfectly (i.e.
	at e.g. 50%, 25%, and 12.5% zoom). A step on the right track for
	bug #76096.

	* app/core/picmanprojection.[ch]: Adjusted to make use of an image
	pyramid. PicmanProjection now keeps an array of TileManager:s, one
	per pyramid level. Renamed _alloc_tiles to _alloc_levels.

	* app/display/picmandisplayshell-draw.c: (picman_display_shell_draw_area):
	Use the right PicmanProjection level when drawing

	* app/display/picmandisplayshell-render.c: (render_image_init_info_full):
	Setup RenderInfo with level in mind

	* app/base/tile-manager.[ch]: Extended API a bit, nothing complicated.

	* app/base/tile-manager-private.h (struct _TileManager): Keep a
	pointer to the level below for use in an image pyramid.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-preview.c (picman_image_get_new_preview): cleanup.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.c (scale_region): always use
	scale_region_lanczos() for LANCZOS interpolation. Fixes bug #443640.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.c (picman_projection_estimate_memsize):
	the projection is 2 bytes per pixel for grayscale images.

2007-06-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection.[ch]: added function that estimates the
	memory requirements for an image projection.

	* app/core/picmantemplate.c (picman_template_notify): use it.

2007-06-06  Sven Neumann  <sven@picman.org>

	* docs/papers: removed this directory and its contents. The papers
	we used to keep here are only of historical value.

2007-06-06  Michael Natterer  <mitch@picman.org>

	* libpicmanthumb/Makefile.am
	* libpicmanthumb/picman-thumbnail-list.c: added my small thumbnail
	lister before it bit-rots. It prints the filenames of thumbnails
	which match certain criteria. Use the output for further
	processing (e.g. deleting). Doesn't technically belong here but
	can't be added to tools/ because it depends on libpicmanthumb.

2007-06-06  Sven Neumann  <sven@picman.org>

	* papers/script-fu/script-fu.tex: reverted the change here. This
	document only has historical value and must not be changed.

2007-06-06  Mukund Sivaraman  <muks@mukund.org>

	Changed "The PICMAN" to "PICMAN" everywhere, where it's used as a name.

2007-06-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/dialog.c (browser_dialog_goto_index): don't
	expand the row we are going to, only its parent node.

2007-06-05  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: Implement the proposed scheme for
	storing international path names in TIFF files.

2007-06-05  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c
	* plug-ins/imagemap/imap_browse.c
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_selection.c: added const qualifiers.

2007-06-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/dialog.[ch] (browser_dialog_goto_index):
	new function which takes an uri and selects its item from the
	index tree.

	* plug-ins/helpbrowser/helpbrowser.c (temp_proc_run): use it to
	select the right tree item when invoked from picman.

2007-06-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/dialog.c: keep a reverse mapping
	uri -> GtkTreeIter around and use it to select the currently
	displayed help page in the index tree.

2007-06-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/distress-selection.scm: applied patch
	from Saul Goode that enables Distress Selection for grayscale images.

2007-06-04  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c (picman_color_scale_expose):
	revert last change, it looks ugly in themes which actually draw a
	box around the scale.

2007-06-04  Mukund Sivaraman  <muks@mukund.org>

	* app/vectors/picmanvectors-export.c: Added format string to dangerous
	fprintf() call without it, which directly print variable data.

2007-06-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.c (picman_color_scale_expose): pass
	NULL as detail to gtk_paint_box().

2007-06-04  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c (image_actions)
	* app/actions/layers-actions.c (layers_actions): renamed menu
	entries as suggested in bug #443384.

2007-06-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifyoptions.c: remove compat property
	"threshold" because the parser now silently skips unknown
	properties.

2007-06-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush-load.c: applied patch from Eric Lamarque
	which adds support for ABR v6 brushes. Did some minor cleanups in
	the patch, reordered functions and generally fixed error handling
	of the ABR parsers. Fixes bug #377016.

2007-06-04  Michael Natterer  <mitch@picman.org>

	* libpicmanconfig/picmanconfig-deserialize.c: be forward-compatible by
	skipping unknown object properties.

	* app/config/picmanrc-deserialize.c: synced code with
	libpicmanconfig (same stuff should look the same).

	* app/config/picmanrc.c: whitespace.

2007-06-03  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/round-corners.scm: Removed spurious
	call to 'picman-image-undo-disable'. From a patch by Saul Goode.

2007-06-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmandatafactory.c (picman_data_factory_load_data): check
	for errors even if the loader_func returned something so we
	display errors from partially loaded files which contain multiple
	data items.

2007-06-03  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c: let mouse button 1 jump to the
	clicked position directly (just as mouse button 2 does). Feels
	much more intuitive because the result of the operation is visible
	before and color scales have no scroll arrows either.

2007-06-02  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_exit_callback): disconnect the
	gui_display_remove() and gui_display_changed() callbacks before
	deleting the displays, not after (it makes no sense to update the
	GUI while exiting).

2007-06-02  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanchanneltreeview.c: set the "linked" property of
	newly dropped items to FALSE.

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_drop_drawable):
	stylistic cleanup.

2007-06-01  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.c: commented out debug output.

2007-06-01  Sven Neumann  <sven@picman.org>

	* libpicmancolor/Makefile.am
	* libpicmancolor/picmancolor.h
	* libpicmancolor/picmancolortypes.h
	* libpicmancolor/picmancolormanaged.[ch]: added an interface that will
	be used to implement the missing bits of color management.

	* libpicmancolor/picmancolor.def: updated.

2007-06-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am: changed back to using EXTRA_PROGRAMS.

2007-05-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/test-preview-area.c: minor improvements.

2007-05-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am: build test-preview-area to avoid bit
	rot.

	* libpicmanwidgets/test-preview-area.c: fixed compilation.

2007-05-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: unified progress strings.

2007-05-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: minor code cleanup.

2007-05-31  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/queue.c:  allocate structs using GSlice.

2007-05-31  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/FractalExplorer/Dialogs.c: Specify maximum field width in
	fscanf() to avoid buffer overflows.

2007-05-31  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig.c: Specify maximum field width in sscanf() to
	avoid buffer overflows.

2007-05-31  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/spheredesigner.c: Don't write to an uninitialized
	pointer (end).

2007-05-31  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-style.c: Specify maximum field width in
	sscanf() to avoid buffer overflows.

2007-05-31  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gflare/gflare.c: Specify maximum field width in
	fscanf() to avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/mail.c: Added format strings to dangerous
	fprintf() calls without them which directly print variable data.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-style.c: Use a macro for size of style text
	entries array.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/decompose.c: Replaced hardcoded constant with
	sizeof array.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/gtm.c: Replaced g_malloc()+sprintf() with more
	safe g_strdup_printf().

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/decompose.c: Use strncpy() instead of strcpy() to
	avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/compose.c: Specify maximum field width in
	sscanf() to avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/channel_mixer.c: Specify maximum field width in
	fscanf() to avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-style.c: Check and handle case where number of
	style items read can overflow the buffer.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-style.c: Replaced use of g_new()+strcpy() with
	g_strdup().

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/winsnap/winsnap.c: Use strncpy() instead of strcpy() to
	avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/xjt/xjt.c: Replaced use of g_malloc()+strcpy() with
	g_strdup().

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/gqbist.c: Use strncpy() instead of strcpy() to
	avoid buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/gtm.c: Use strncpy() instead of strcpy() to avoid
	buffer overflows.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/jpeg/jpeg.c: Removed redundant image_ID declaration that
	shadowed an outer variable needlessly (found using Splint).

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/sel2path/fit.c: Initialize spline.linearity before use.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/sel2path/spline.c: Initialize spline.linearity before use.

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/script-fu/re/split.c
	* plug-ins/script-fu/re/split.h
	* plug-ins/script-fu/re/main.c
	* plug-ins/script-fu/re/Makefile.am: Created a header file (split.h)
	and added a prototype for split().

2007-05-30  Mukund Sivaraman  <muks@mukund.org>

	* app/tools/picmandrawtool.c: Added missing include.

	* app/tools/picmanbycolorselecttool.c: Removed unused variable.

	* app/plug-in/picmanenvirontable.c: Added cast for callback function.

	* plug-ins/script-fu/tinyscheme/scheme.c: Correctly cast pointer to
	an long integer type.

2007-05-30  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_file.c (do_file_save_as_dialog): set a
	filename based on the image name. Based on a patch from Kevin
	Hurewitz (bug #317916).

	* plug-ins/twain/tw_mac.c: don't use C++ style comments.

2007-05-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/postscript.c: minor code cleanup.

2007-05-29  Sven Neumann  <sven@picman.org>

	* app/base/base-types.h: removed unused typedef.

2007-05-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.c: use GSlice to allocate the transform
	matrix.

2007-05-29  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-import.c: don't memdup gslice-allocated
	memory.

2007-05-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_parasite_attach)
	* app/core/picmanitem.c (picman_item_parasite_attach): allocate the
	temporary PicmanParasite copy on the stack.

2007-05-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_drop_drawable): set
	"linked" and "lock-alpha" to FALSE too.

2007-05-29  Sven Neumann  <sven@picman.org>

	* app/base/tile.[ch]: renamed tile_sanitize_rowhints() to
	tile_allocate_rowhints().

	* app/base/tile-manager.c
	* app/paint-funcs/paint-funcs.c: changed accordingly.

2007-05-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_drop_drawable): also
	set the mode of the new layer to NORMAL and its opacity to OPAQUE.

2007-05-29  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/imagemap/imap_object.c: Use C89 declarations.

2007-05-29  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmantoolbox-dnd.c: make drop-duplicated drawables
	visible before adding them to the image. Spotted by Jimmac.

2007-05-28  Manish Singh  <yosh@picman.org>

        * plug-ins/pypicman/picmancolormodule.c
        * plug-ins/pypicman/picmanenumsmodule.c
        * plug-ins/pypicman/picmanmodule.c
        * plug-ins/pypicman/picmanthumbmodule.c
        * plug-ins/pypicman/picmanuimodule.c
        * plug-ins/pypicman/pypicman-drawable.c
        * plug-ins/pypicman/pypicman-image.c
        * plug-ins/pypicman/pypicman-pdb.c
        * plug-ins/pypicman/pypicman-tile.c: cleanups.

2007-05-28  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager.c (tile_manager_get): allocate
	tile->rowhint using tile_sanitize_rowhints() (which uses GSlice)
	instead of g_memdup(). Fixes bug #441878.

2007-05-28  Michael Natterer  <mitch@picman.org>

	Don't leave the user without progress bar just because the
	display's statusbar is invisible:

	* app/display/picmanstatusbar.[ch]: if the statusbar is invisible
	when a progress wants to be shown, temporarily show it, recording
	the fact in the new boolean "progress_shown" member. Added new API
	picman_statusbar_get/set_visible() which is aware of the new
	temporary visibility state.

	* app/display/picmandisplayshell-appearance.c
	(picman_display_shell_set_show_statusbar)
	* app/display/picmandisplayshell-progress.c
	(picman_display_shell_progress_message): use the new API instead of
	showing/hiding the widget directly.

2007-05-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfgbgview.[ch]: derive from GtkWidget instead of
	GtkDrawingArea so we save a GdkWindow and render on the correct
	background color also for inactive notebook tabs.

2007-05-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.c (floating_sel_attach): set
	"Lock Alpha" to TRUE again on floating selections.

	(floating_sel_to_layer): instead, set it to FALSE when turning
	it into a new layer. Fixes bug #418215 and keeps #161042 closed.

2007-05-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: clamping at 255 is good enough.

2007-05-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: clamp to [0;255]. Fixes bug #441681.

2007-05-27  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.18.

2007-05-27  Sven Neumann  <sven@picman.org>

	* Made 2.3.17 development release.

2007-05-27  Michael Natterer  <mitch@picman.org>

	* app/core/picman-utils.[ch] (picman_container_get_neighbor_of_active):
	new utility function which returns the neighbor of a container's
	active item.

	* app/widgets/picmancontainerview-utils.[ch]
	(picman_container_view_remove_active): remove a container view's
	active item, using above function to select its neighbor.

	* app/actions/data-commands.c
	* app/actions/buffers-commands.c
	* app/actions/documents-commands.c
	* app/actions/templates-commands.c: use above functions to select
	reasonable items when deleting from a list (instead of always
	jumping to the first item).

2007-05-26  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_coordinates_new): update the
	original width and height when the chain-button is changed to the
	active state.

2007-05-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansizebox.c (PicmanSizeBoxPrivate): removed unused
	struct member.

2007-05-26  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmanrgb.c (picman_param_rgb_values_cmp): fully
	initialize all bytes of "int1" and "int2" so we don't produce
	wrong color compare results (and shut up valgrind).
	Fixes bug #353696.

2007-05-26  Michael Natterer  <mitch@picman.org>

	* app/config/picmandisplayconfig.c (picman_display_config_class_init):
	also initialize alpha of xor-color's default value to stop
	valgrind from complaining about uninitialized memory.

2007-05-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/layer-options-dialog.c: do not only declare
	layer_options_dialog_free(), but do actually use it.

2007-05-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/script-fu-text-console.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/scheme-wrapper.h: Applied patch from Eric
	Lamarque that makes use of TinyScheme's interactive mode for
	the text console in Script-Fu. Fixes bug #440674.

2007-05-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lens.c: applied patch from Aurimas Juška that
	fixes use of the PicmanZoomPreview widget (bug #356716).

2007-05-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/Makefile.am: Missed commit of this file.

	* plug-ins/script-fu/scheme-wrapper.h:
	* plug-ins/script-fu/scheme-wrapper.c (ts_output_string): Updated
	to expect a 'const char *' and an int but no file pointer.

	* plug-ins/script-fu/tinyscheme/scheme.c
	* plug-ins/script-fu/tinyscheme/scheme.h: Changes due to use of
	'const char *' for ts_output_routine.

2007-05-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	This is the first part of fixing bugs #438997 and #440674.

	* plug-ins/script-fu/scheme-wrapper.c: Removed ts_output_routine
	declaration from here...

	* plug-ins/script-fu/tinyscheme/scheme.h: and added it here.

	* plug-ins/script-fu/tinyscheme/scheme.c (putchars): Updated to be
	smarter about where it's output needs to be sent.

2007-05-25  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse2.c
	* app/composite/picman-composite-regression.c: minor code cleanup.

2007-05-25  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-sse-test.c
	* app/composite/picman-composite-test.c
	* app/composite/picman-composite-sse2-test.c
	* app/composite/picman-composite-altivec-test.c
	* app/composite/picman-composite-3dnow-test.c
	* app/composite/picman-composite-mmx-test.c
	* app/composite/picman-composite-vis-test.c: minor code cleanup.

2007-05-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfoaux.[ch]
	* app/widgets/picmansessioninfobook.[ch]
	* app/widgets/picmansessioninfodock.[ch]
	* app/widgets/picmansessioninfodockable.[ch]: renamed these...

	* app/widgets/picmansessioninfo-aux.[ch]
	* app/widgets/picmansessioninfo-book.[ch]
	* app/widgets/picmansessioninfo-dock.[ch]
	* app/widgets/picmansessioninfo-dockable.[ch]: ...to these.

	* app/widgets/Makefile.am
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancursorview.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandocked.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmansessioninfo.c: changed accordingly.

2007-05-25  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanparasite.c: allocate parasites using GSlice.

2007-05-25  Sven Neumann  <sven@picman.org>

	* picmantool-2.0.in: require pkg-config and use it to determine
	cflags and libs.

	* docs/picmantool.1.in: document that pkg-config is used and
	recommend to use pkg-config directly.

2007-05-25  Sven Neumann  <sven@picman.org>

	* picmantool-2.0.in: synced --libs output with the pkg-config files.

2007-05-25  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_object.[ch]: applied patch from Kevin
	Hurewitz that adds keyboard control for resizing an area (bug #439226).

2007-05-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-display.c (pypicman_display_new): return None
	if we're passed an ID of -1, like the other PICMAN object constructors.

2007-05-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-display.c: remove the delete method, PyPicman
	objects are supposed to be deleted via picman.delete()

2007-05-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.[ch]
	* app/widgets/picmansessioninfoaux.[ch]
	* app/widgets/picmansessioninfobook.[ch]
	* app/widgets/picmansessioninfodock.c
	* app/widgets/picmansessioninfodockable.[ch]: cleanup.

2007-05-24  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/pypicman-display.c: added an ID attribute and a
	delete method to the Picman.Display object.

	* plug-ins/pypicman/picmanshelf.py (_display_id): use the ID attribute.

	* plug-ins/pypicman/picmanfu.py: enabled support for PF_DISPLAY.

2007-05-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.[ch]: removed more code and cleaned
	up the API.

	* app/widgets/Makefile.am
	* app/widgets/picmansessioninfodock.[ch]: added the removed code here.

	* app/widgets/picmandialogfactory.c: changed accordingly.

2007-05-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.[ch]: removed lots of code...

	* app/widgets/Makefile.am
	* app/widgets/picmansessioninfoaux.[ch]
	* app/widgets/picmansessioninfobook.[ch]
	* app/widgets/picmansessioninfodockable.[ch]: ...and added it here.
	Also allocate all structs using GSLice.

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancursorview.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandialogfactory.c
	* app/widgets/picmandocked.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

2007-05-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/bumpmap.c: formatting, added const qualifiers.

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/dialogs/channel-options-dialog.c
	* app/dialogs/convert-dialog.c
	* app/dialogs/desaturate-dialog.c
	* app/dialogs/fade-dialog.c
	* app/dialogs/image-merge-layers-dialog.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/image-scale-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/dialogs/layer-options-dialog.c
	* app/dialogs/module-dialog.c
	* app/dialogs/offset-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/print-size-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/scale-dialog.c
	* app/dialogs/template-options-dialog.c
	* app/dialogs/vectors-export-dialog.c
	* app/dialogs/vectors-import-dialog.c
	* app/dialogs/vectors-options-dialog.c: allocate structs using GSlice.

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.[ch]: use a GQueue to store the points.

2007-05-23  Sven Neumann  <sven@picman.org>

	* plug-ins/help/picmanhelpitem.c
	* plug-ins/help/picmanhelplocale.c
	* plug-ins/help/help.c
	* plug-ins/help/picmanhelpdomain.c: allocate structs using GSlice.

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintoptions.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/tool_manager.c: allocate structs using GSlice.

2007-05-23  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_cmd_move_sash.c (sash_move): applied
	patch from Kevin Hurewitz that fixes resizing an area while being
	zoomed in (bug #439222).

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/actions/image-commands.c
	* app/actions/templates-commands.c: allocate structs using GSlice.

2007-05-23  Tor Lillqvist  <tml@novell.com>

	* plug-ins/common/tiff-save.c (save_paths): Use memset() instead
	of bzero().

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.c
	* app/core/picmangradient-load.c
	* app/core/picmansamplepoint.c
	* app/core/picmanscanconvert.c
	* app/core/picmanunit.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell-scale.c
	* app/file/picmanrecentitem.c
	* app/gui/splash.c: allocate structs using GSlice.

2007-05-23  Sven Neumann  <sven@picman.org>

	* app/dialogs/tips-parser.c
	* app/display/picmandisplayshell-autoscroll.c
	* app/display/picmandisplayshell-selection.c
	* app/display/picmanstatusbar.c
	* app/menus/plug-in-menus.c
	* app/plug-in/picmanenvirontable.c
	* app/plug-in/picmaninterpreterdb.c
	* app/plug-in/picmanplugindebug.c
	* app/plug-in/picmanpluginshm.c
	* app/text/picmantextundo.c: allocate structs using GSlice.

	* app/widgets/picmanselectiondata.c (picman_selection_data_set_color):
	stack allocate tempory data.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.c
	* app/core/picmanpalette-load.c
	* app/core/picmanpalette.c: use GSlice for palette entries and
	temporary structs.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: allocate structs using GSlice.

	* app/base/tile-swap.[ch]
	* app/xcf/xcf-load.c: removed dead code that used to deal with
	swapping from XCF files. Simplified swap file code quite a bit.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanarea.[ch]
	* app/core/picmanprojection.c
	* app/display/picmandisplay.c: use GSlice to allocate PicmanArea and
	sanitize the API.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.[ch]
	* app/base/tile-manager-private.h: removed unused code.

	* app/base/pixel-surround.c
	* app/base/pixel-region.c: allocate structs using GSlice.

	* app/base/tile.c: allocate TileLink and TileRowHint using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmandialogfactory.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanscanner.c
	* libpicmanwidgets/picmanwidgets.c: allocate structs using GSlice.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifyoptions.[ch]: remove "threshold" from
	the options struct and added compat code in get_property().

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/config/picmanrc-unknown.c
	* app/config/picmanxmlparser.c: allocate structs using GSlice.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors-import.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactionview.c: use GSlice to allocate struct.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollers.c
	* app/widgets/picmandevices.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmaneditor.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmenufactory.c
	* app/widgets/picmanactionfactory.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c (picman_prop_aspect_ratio_new):
	use GSlice and plugged a memleak.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhelp.c
	* app/widgets/picmanuimanager.c
	* app/widgets/picmanview-popup.c
	* app/widgets/gtkwrapbox.c: use GSlice to allocate structs.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/base/tile.[ch]: changed tile_init() to tile_new() and return
	a GSlice-allocated Tile structure.

	(tile_destroy): free it using GSLice.

	* app/base/tile-manager.c: use tile_new() instead of g_new plus
	tile_init(). Also allocate TileManager itself using GSlice.

	* app/xcf/xcf-load.c (xcf_load_parasite): allocate parasites using
	picman_parasite_new().

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/gtkvwrapbox.c
	* app/widgets/gtkhwrapbox.c: use GSlice to allocate structs.

2007-05-22  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-interface.c: use GSlice to allocate
	structs.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawable.c
	* libpicman/picmanpixelfetcher.c
	* libpicman/picmanprogress.c
	* libpicman/picmanpixelrgn.c
	* libpicman/picmanregioniterator.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanfontmenu.c
	* libpicman/picmanpatternmenu.c
	* libpicman/picmanpalettemenu.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushselect.c
	* libpicman/picmangradientselect.c
	* libpicman/picmanfontselect.c
	* libpicman/picmanpatternselect.c
	* libpicman/picmanpaletteselect.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.c: allocate structs using GSlice.

	* libpicmanmodule/picmanmodule.c: allocate PicmanModuleInfo using GSlice.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c (plug_in_args_to_params): free
	parasites using picman_parasite_free()

	* libpicman/picman.c (picman_run_procedure2): free wire messages using
	picman_wire_destroy().

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.c
	* libpicmanwidgets/picmanquerybox.c: allocate structs using GSlice.

2007-05-22  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfigwriter.c: use GSlice for the
	PicmanConfigWriter struct.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/main.c (picman_dbus_open): initialize "uri" to NULL.
	#include "file/file-utils.h"

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager-private.h: formatting.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/actions/data-commands.c
	* app/base/boundary.c
	* app/base/picmanhistogram.c
	* app/base/picmanlut.c
	* app/base/temp-buf.c
	* app/core/picmancontainer.c
	* app/core/picmangradient.c
	* app/core/picmanparamspecs.c
	* app/core/picmanundo.c
	* app/plug-in/picmanplugin-cleanup.c
	* app/plug-in/picmanpluginmanager-data.c
	* app/plug-in/picmanpluginmanager-help-domain.c
	* app/plug-in/picmanpluginmanager-locale-domain.c
	* app/plug-in/picmanpluginmanager-menu-branch.c
	* app/plug-in/picmanpluginprocframe.c
	* app/vectors/picmananchor.c
	* app/widgets/picmansessioninfo.c: use GSlice instead of g_new/g_free
	for structs of fixed size.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprogressbox.c (picman_progress_box_progress_start)
	(picman_progress_box_progress_set_text): process updates.

2007-05-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush.c (picman_brush_get_new_preview): plugged a
	memory leak caused by one variable shadowing another.

	* app/vectors/picmanvectors-import.c (picman_vectors_import): free the
	SvgPath structs.

2007-05-22  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanvectors-warp.c (picman_stroke_warp_point): don't
	leak three PicmanCoords per warped point (eek).

2007-05-21  Sven Neumann  <sven@picman.org>

	* themes/Default/images/preferences/Makefile.am: formatting.

2007-05-21  Sven Neumann  <sven@picman.org>

	* autogen.sh: also look for automake-1.10.

2007-05-21  Sven Neumann  <sven@picman.org>

	* app/core/picman.c (picman_message): documentation.

	* app/actions/documents-commands.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantoolbox-dnd.c: pass parent widgets to picman_message().

2007-05-21  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanprocedure.c (picman_procedure_validate_args): pass the
	PicmanProgress to picman_message().

	* plug-ins/common/bumpmap.c: reduced number of progress updates.

2007-05-21  Jakub Steiner <jimmac@ximian.com>

	* plug-ins/helpbrowser/wilber-reading.{svg,png}: new icon.

2007-05-21  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.h: formatting.

2007-05-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c: use 'program-name' instead of 'name'
	when compiling against GTK+ >= 2.11.0 (see bug #345822). Also set
	the title explicitely (see bug #418434).

2007-05-21  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c: use a #define for the default resolution.

2007-05-20  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff-save.c: correctly pad the path name.

2007-05-20  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c: moved duplicated code to a utility
	function.

2007-05-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainercombobox.c
	* app/widgets/picmancontainerentry.c
	* app/widgets/picmancontainertreeview.c: manage GtkTreeIters with
	gtk_tree_iter_copy/gtk_tree_iter_free instead of g_new/g_free.

2007-05-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_desc_string): make
	sure the description contains no empty lines.

2007-05-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: try to use the window name as
	layer name.

2007-05-18  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: tweaked the page header.

2007-05-18  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanintstore.c (picman_int_store_add_empty): if we
	free the iter with gtk_tree_iter_free() we must also allocate it
	with gtk_tree_iter_copy() or gslice will explode.

2007-05-18  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c (prefs_dialog_new): made the
	page header look like a selected list element.

2007-05-18  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: also removed the frame around
	the page header.

2007-05-17  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Applied patch from
	Eric Lamarque that optimizes backchar() use. See bug #374854.

2007-05-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff-load.c: split code to get the page name
	into a utility function.

2007-05-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_init): unset show-border.

	* app/widgets/picmandockable.c (picman_dockable_expose_event): don't
	paint the extension; reduces visual clutter.

2007-05-17  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c: also remove the border around
	the notebook pages and add 12 px spacing between the page and its
	title instead.

2007-05-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockseparator.c: removed period from tooltip.

	* app/dialogs/preferences-dialog.c
	* app/widgets/picmantoolbox.c: removed frames to reduce visual clutter.

	* app/widgets/picmantoolbox-indicator-area.c: draw with borders.

2007-05-17  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff-load.c: Fix the order of the imported paths.

2007-05-17  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff-save.c: save the paths in the TIFF.
	Please test interoperability with other programs.
	Fixes bug #131982.

	* plug-ins/common/tiff-load.c: fix coordinate reading for
	negative coordinates.

	* app/config/picmanguiconfig.c: Show color swatches by default.

2007-05-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.c
	* libpicman/picmanprogressbar.c
	* plug-ins/script-fu/script-fu-interface.c: use Gtk functions to
	manually iterate the main loop because they release the Gdk lock
	correctly around calling the GLib main loop functions.

2007-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	readded (better) code to deal with full menu paths.

2007-05-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbrushtool.c (picman_brush_tool_constructor): add a
	local PicmanDisplayConfig variable to improve readability.

2007-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mblur.c: applied patch from Jörg Gittinger that
	improves the quality of the Motion Blur filter (bug #380435).

2007-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	removed code that used to deal with full menu paths. All our
	scripts use script-fu-menu-register now.

2007-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/selection-round.scm
	* plug-ins/script-fu/scripts/copy-visible.scm: unmarked strings for
	translation.

2007-05-16  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c (tile_invalidate): if the invalidated
	tile is the cached tile, release the cached tile. Fixes bug #438802.

2007-05-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_sensitive):
	apply sensitivity state to the Cancel button as well.
	(picman_file_dialog_progress_start): make the Cancel button sensitive
	if the progress is cancelable.

	* app/widgets/picmanthumbbox.c (picman_thumb_box_progress_start): if
	embedded in a PicmanFileDialog, make its Cancel button sensitive if
	the progress is cancelable

2007-05-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanthumbbox.[ch]: combined the two progress bars
	(when loading multiple thumbnails) into a single one using a
	PicmanSubProgress.

2007-05-15  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg-load.c: reduced number of progress updates.

2007-05-15  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c (script_fu_extension_init):
	renamed "Utils" to "Utilities".

2007-05-15  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/contactsheet.scm: Use 'img' and not
	'new-img' in make-thumbnail-size routine. Moved menu entry from
	Xtns/Utils to Xtns/Utilities. See bug #132532.

2007-05-15  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanheal.c (picman_heal_motion): convert the source
	region to the dest region's type, not the other way around
	(using the wrong if() condition when doing so). Fixes bug #390938.

2007-05-15  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c (marshall_proc_db_call): Allow
	any number type in a vector to be passed in PDB call as an INT*ARRAY.
	Updated error messages accordingly. Fixes bug #435640.

2007-05-15  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c (browser_dialog_open): don't show
	the window yet. The user might not have the help pages installed.

	* plug-ins/helpbrowser/wilber-reading.png: use the new style Wilber.

2007-05-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/wmf.c
	* plug-ins/fits/fits.c
	* plug-ins/sel2path/sel2path.c
	* plug-ins/xjt/xjt.c: added missing calls to
	picman_window_set_transient().

2007-05-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c
	* plug-ins/common/tiff-load.c
	* plug-ins/common/postscript.c
	* plug-ins/common/poppler.c: added missing calls to
	picman_window_set_transient().

	* libpicman/picmanpixbuf.c (picman_layer_new_from_pixbuf): reduced
	number of progress updates.

2007-05-14  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.c (file_utils_filename_to_uri): fix check on
	the GError returned by file_utils_filename_is_uri().

2007-05-14  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanenv.c: #include <CoreServices/CoreServices.h>,
	not "...".

2007-05-14  Michael Natterer  <mitch@picman.org>

	* configure.in: added check for OSX' Carbon framework.

	* libpicmanbase/Makefile.am (libpicmanbase_2_0_la_LDFLAGS): add
	$(CARBON_LDFLAGS)

	* libpicmanbase/picmanenv.c (picman_user_directory): add Carbon version.

	(find_folder): new Crabon-only utility function.

2007-05-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-transform.c: fixed gtk-doc comment.

2007-05-14  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c: add binding for picman_user_directory().

2007-05-14  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.[ch] (file_utils_filename_is_uri): new function,
	fixed and factored out of file_utils_filename_to_uri().

	* app/main.c (picman_dbus_open): use it here instead of a simple
	strstr(filename, "://").

2007-05-14  Tor Lillqvist  <tml@novell.com>

	* libpicmanbase/picmanenv.c: Undef DATADIR before including <shlobj.h>
	to avoid collision with DATADIR enum in objidl.h. Define
	CSIDL_MYDOCUMENTS, CSIDL_MYMUSIC and CSIDL_MYVIDEO in case missing
	from shlobj.h.

	* libpicmanbase/Makefile.am: Link with -lole32 on Win32 for
	CoTaskMemFree().

2007-05-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_new): add a
	shortcut to the user's Pictures folder.

	* libpicmanbase/xdg-user-dir.c: cosmetic changes.

2007-05-13  Sven Neumann  <sven@picman.org>

	* plug-ins/help/picman-help-lookup.c: include libpicmanbase/picmanbase.h.

2007-05-13  Sven Neumann  <sven@picman.org>

	* app/file/Makefile.am
	* app/file/xdg-user-dir.c[ch]: removed here ...

	* libpicmanbase/Makefile.am
	* libpicmanbase/xdg-user-dir.[ch]: ... and moved to libpicmanbase.

	* libpicmanbase/picmanbaseenums.[ch]: added PicmanUserDirectory enum.

	* libpicmanbase/picmanenv.[ch]: added new function to identify special
	user folders. Added Win32 specific code and use xdg_user_dir_lookup()
	on other platforms.

	* libpicman/picmanenums.c.tail
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def: updated.

2007-05-11  Sven Neumann  <sven@picman.org>

	* app/file/Makefile.am
	* app/file/file-procedure.[ch]
	* app/file/file-utils.[ch]: split functions dealing with file
	procedures into their own file and renamed them.

	* app/file/file-open.c
	* app/dialogs/file-save-dialog.c
	* app/actions/file-commands.c
	* app/widgets/picmanthumbbox.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanimagepropview.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly

        * app/pdb/fileops_cmds.c: regenerated.

2007-05-11  Karine Delvare  <edhel@picman.org>

	* plug-ins/common/illusion.c: use the new preview transform function,
	see bug #356716.

2007-05-11  Sven Neumann  <sven@picman.org>

	* app/file/Makefile.am
	* app/file/xdg-user-dir.[ch]: added a slightly modified copy of
	xdg-user-dirs-lockup.c from freedesktop.org.

2007-05-11  Sven Neumann  <sven@picman.org>

	* app/main.c (picman_dbus_open): don't attempt the conversion if the
	argument is already an URI.

2007-05-11  Sven Neumann  <sven@picman.org>

	* app/main.c (picman_dbus_open): convert filenames to absolute file
	URIs before passing them to dbus_g_proxy_call().

2007-05-10  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_command.c: finished port of Undo and Redo
	menus to GtkAction. Closes bug #138841.

2007-05-10  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: remove parameter definition special
	casing that was based on menu and plugin types. Instead expect the
	script to specify all its parameters in its register call, and hide
	the UI elements for the parameters we are already passed in
	interactive mode. For compatibilty, this is only turned on when you
	specify the "menu" named argument in the register call, or if you pass
	an empty label. This should fix bug #104639.

	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/colorxhtml.py
	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/py-slice.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py
	* plug-ins/pypicman/plug-ins/whirlpinch.py: update to register image and
	drawable parameters explicitly.

2007-05-10  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-image.c: bind picman_image_resize_to_layers.

2007-05-10  Sven Neumann  <sven@picman.org>

	* plug-ins/flame/rect.c: reduced the number of progress updates.

2007-05-09  Karine Delvare  <edhel@picman.org>

	* plug-ins/common/waves.c: use the new preview transform function,
	see bug #356716.

2007-05-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c (lcms_icc_apply): improved handling of
	attached non-RGB profiles.

	* plug-ins/common/oilify.c: use PICMAN_RGB_LUMINANCE() instead of
	the self-made INTENSITY macro.

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: reduced number of progress updates.

2007-05-09  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c (script_fu_browse_response):
	focus the console entry, set the cursor position to the first
	parameter and present the console window.

2007-05-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-preview.c
	(picman_display_shell_draw_tri_row)
	(picman_display_shell_draw_tri_row_mask): don't call gdk_draw_pixbuf()
	with a zero width. Fixes bug #349483.

2007-05-08  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-encode.c (gen_property): quick workaround
	for bug #436077.  A better solution will follow later.

2007-05-08  Karine Delvare  <edhel@picman.org>

	* plug-ins/common/flarefx.c: use the new preview transform function,
	see bug #356716.

2007-05-08  Karine Delvare  <edhel@picman.org>

	* plug-ins/common/papertile.c: Replace tile size with width & height,
	without changing the plug-in interface (bug #87092).

2007-05-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantexteditor.c: use GtkWindow::transient-for just
	for the fun of using another GTK+ 2.10 feature.

2007-05-07  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch] (PicmanCloneType): changed strings.

2007-05-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanbrushtool.[ch] (picman_brush_tool_draw): moved
	brush drawing code to the new function picman_brush_tool_draw_brush().

	* app/tools/picmansourcetool.c: (picman_source_tool_draw): draw the
	brush outline at the source position (bug #435545).

2007-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/blur.c (blur_prepare_row): clamp to the first
	row, not the second. Also update the progress less often.

2007-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: reduce rounding errors when converting
	between premultiplied and separated alpha. Fixes bug #383870.

2007-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/fits/fitsrw.c
	* plug-ins/fits/fits.c: applied modified patch from Peter
	Kirchgessner. Fixes creation of the last data record and makes
	handling of float values independent of the locale (bug #351656).

2007-05-06  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: don't add the radiobuttons into a
	GtkFrame.

	* plug-ins/pypicman/plug-ins/sphere.py: added a PF_RADIO parameter
	as an example and for testing purposes.

2007-05-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mapcolor.c: try to do something reasonable for
	the empty source range (bug #436145).

2007-05-06  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: start with a reasonable size and
	paned position and remember the window size and paned position at
	least within a PICMAN session.

2007-05-06  Sven Neumann  <sven@picman.org>

	* picmantool-2.0.in: define datarootdir before datadir (bug #436386).

2007-05-06  Sven Neumann  <sven@picman.org>

	* configure.in: require libexif >= 0.6.0.

	* plug-ins/jpeg/picmanexif.[ch]: removed picman_exif_entry_get_value()
	which was needed to work with libexif < 0.6.0.

	* plug-ins/jpeg/jpeg.c: declare the global ExifData here instead
	of in picmanexif.c.

	* plug-ins/jpeg/jpeg-exif.c: cosmetics.

2007-05-06  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_apply_exif_data_to_image): only
	check for EXIF_TAG_GPS_VERSION_ID if it's defined (see bug #377917).
	This tag was added in libexif 0.6.13.

2007-05-06  Sven Neumann  <sven@picman.org>

	* configure.in (AM_INIT_AUTOMAKE): pass dist-bzip2 to automake.

2007-05-06  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am (DISTCLEANFILES): clean picmanversion.h.

	* plug-ins/metadata/Makefile.am (CLEANFILES): clean testbase64.

	* po/Makefile.in.in (mostlyclean): clean .intltool-merge-cachemake

	* tools/pdbgen/Makefile.am: use DISTCLEANFILES instead of
	MAINTAINERCLEANFILES.

2007-05-06  Sven Neumann  <sven@picman.org>

	* tools/defcheck.py: improved path handling. Allow to pass the
	source directory on the command-line.

	* Makefile.am (check-defs): pass $(top_srcdir) to defcheck.py.
	(validate-authors): validate authors.xml in the srcdir.

	* menus/Makefile.am (validate): changed output for consistency.

2007-05-06  Sven Neumann  <sven@picman.org>

	* Makefile.am (DISTCHECK_CONFIGURE_FLAGS): --enable-gtk-doc
	(EXTRA_DIST): added mkinstalldirs, the po-* Makefiles need it.
	(check-defs): use tools/defcheck.py from $(top_srcdir).

2007-05-06  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/edit.pdb: make picman-edit-paste-as-new not fail
	at an empty clipboard, but return -1 as image id.

	* app/pdb/edit_cmds.c
	* libpicman/picmanedit_pdb.c: regenerated.

	* plug-ins/script-fu/scripts/paste-as-brush.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: Changed
	accordingly, fixes bug #357059.

	* modules/controller_linux_input.c: changed some axis names to make
	more sense.

2007-05-06  Sven Neumann  <sven@picman.org>

	* po-*/Makefile.in.in: reverted last change, it didn't work.

2007-05-06  Sven Neumann  <sven@picman.org>

	* po-*/Makefile.in.in: include po/Makefile.in.in and override
	@GETTEXT_PACKAGE@ instead of keeping five copies.

2007-05-06  Sven Neumann  <sven@picman.org>

	* HACKING: suggest to use pango-1-16.

	* configure.in: added --enable-gtk-doc-app option and an automake
	conditional for it.

	* devel-docs/Makefile.am: build the app directory conditionally.

	* devel-docs/app/Makefile.am: override disthook since we don't
	want to distribute any generated files.

2007-05-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl (generate_pspec): use $flags and not a
	literal PICMAN_PARAM_READWRITE for the image paramspec's flags.

	* app/pdb/image_cmds.c: regenerated.

2007-05-05  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (convolve_region): instead of just
	copying the border pixels, convolute the full region and extend
	the borders.

	* app/paint/picmanconvolve.[ch]: removed broken code that used to
	deal with the image borders. Fixes bug #434279. Also reduced the
	matrix sizes to 3x3 as only the inner 3x3 values were nonzero.

2007-05-05  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/papertile.c: whitespace cleanup, tabs -> spaces.

2007-05-05  Roozbeh Pournader  <roozbeh@farsiweb.info>

	* configure.in: Added 'fa' (Persian) to ALL_LINGUAS.

2007-05-05  Sven Neumann  <sven@picman.org>

	* app/base/picmanlut.[ch]
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: reverted the changes done for bug
	#331782. See the bug report for an explanation.

2007-05-05  Mukund Sivaraman  <muks@mukund.org>

	* app/gui/splash.c: reverted the progress bar size change.

2007-05-05  Mukund Sivaraman  <muks@mukund.org>

	* app/gui/splash.c: make the splash progress bar lean and mean.

2007-05-05  Mukund Sivaraman  <muks@mukund.org>

	* app/base/picmanlut.[ch]
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: Fixed the value channel color
	correction in the curves and levels tools to only modify the
	value channel and not the hues. Fixes bug #331782.

2007-05-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_boundary): fixed
	off-by-one (too large) drawing of boundaries by copying the resp.
	code and its obscure comment from picmandisplayshell-selection.c
	Fixes bug #416432.

2007-05-04  Sven Neumann  <sven@picman.org>

	* app/dialogs/tips-dialog.c: make the tips label selectable.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/contactsheet.scm: added missing
	ellipsis to menu label and fixed default fonts.

	* plug-ins/script-fu/scripts/script-fu-set-cmap.scm: added missing
	ellipsis to menu label and corrected menu location.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c (autocrop): crop the image, even if
	the layer is fully opaque. Fixes bug #413906.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c (guess_bgcolor): special case fully
	transparent regions, just as we do in app/core/picmanimage-crop.c.
	Fixes bug #357554.

	* app/core/picmanimage-crop.c: cosmetics.

2007-05-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush-load.c: applied slightly modified patch from
	Eric Lamarque that adds support for loading .abr v2 Photoshop
	brushes (bug #435635).

2007-05-04  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin-cleanup.c: removed debug output.

2007-05-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/maze/maze.c: reduced the number of progress updates.

2007-05-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/edge.c: reduced the number of progress updates.

2007-05-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/fractaltrace.c: whoops. fixed progress when
	selections exist.

2007-05-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/fractaltrace.c: reduced the number of progress
	updates.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/dog.c: reduced the number of progress updates.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c (gauss_rle): fixed a bug in my last change.
	Also reduced the number of progress updates.

2007-05-04  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprogress.c (picman_progress_update): print a warning
	on stderr if a plug-in updates the progress too frequently.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/ifscompose/ifscompose_utils.c: reduce the number of
	progress updates.

2007-05-04  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_progress_message):
	reverted last change, the behavior is different.

2007-05-04  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_progress_message):
	removed code that guards us from multiline messages. This happens
	later in picman_statusbar_vprintf() anyway.

2007-05-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/poppler.c: removed unused functionality from the
	resolution entry widget.

2007-05-04  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/psd-load.c: Fixed bogus argument in call to
	picman_progress_update().

2007-05-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def: removed resolution entry symbols.

2007-05-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanresolutionentry.[ch]: removed
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/Makefile.am: changed accordingly

	* plug-ins/pypicman/picmanui.defs: resolution entry api removed

	* plug-ins/common/poppler.c: resolution entry code added
	here, with unused api removed.

	Addresses (maybe fixes) bug #351281.

2007-05-03  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (convolve_region): minor cleanup.

2007-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/despeckle.c: applied patch from Geert Jordaens
	plus some minor cleanups. Fixes bug #433251.

2007-05-03  Sven Neumann  <sven@picman.org>

	Handle the core part of bug #434274:

	* app/core/picmanchannel.c (picman_channel_real_boundary): return
	FALSE for an empty channel.

	* app/core/picmanitem.[ch]: added a progress parameter to
	picman_item_stroke.

	* app/core/picmanchannel.c (picman_channel_stroke)
	* app/core/picmanselection.c (picman_selection_stroke): pass progress
	to picman_message().

	* app/actions/vectors-commands.c
	* app/actions/select-commands.c
	* app/dialogs/stroke-dialog.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/paths.pdb: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/paths_cmds.c: regenerated.

	* app/core/picmanlayermaskundo.c: added a missing cast.

2007-05-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorframe.c (picman_color_frame_update): hide the
	Index label if the color index is -1 (happens with sample_average).

2007-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icosave.c
	* plug-ins/winicon/icodialog.c: show a warning when the user is
	about to create a file using newer features of the icon file format.
	Loosely based on a patch from Aurimas Juška. Fixes bug #409467.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanpickable.c (picman_pickable_pick_color): reduce
	rounding errors.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanpickable.[ch]: removed get_color_at() from the
	PicmanPickable interface. Implement the same functionality using
	get_pixel_at() but with a saner API.

	* app/core/picmandrawable.c
	* app/core/picmanprojection.c
	* app/core/picmanimagemap.c: removed get_color_at() implementations.

	* app/tools/picmanbycolorselecttool.c: adapt to API change of
	picman_pickable_get_color_at().

	* app/tools/picmanrectangleselecttool.c: added missing include.

2007-05-02  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/svg.c: Make size loading work properly with
	new librsvg versions.

	* configure.in: bumped required librsvg version to 2.14.

2007-05-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/poppler.c (load_dialog): set a size request on
	the PicmanPageSelector widget.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.c
	(picman_perspective_clone_tool_cursor_update): if we are in adjust
	mode, skip the PicmanBrushClass when chaining up. Fixes bug #354933.

2007-05-02  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c (ts_get_error_msg): applied
	patch from Eric Lamarque that fixes Script-Fu server output
	(bug #431623).

2007-05-02  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/jpeg/jpeg-exif.c: Check if any other IFDs exist before
	rejecting an image's EXIF info. Fixes bug #377917.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/paint/picmansmudge.c (picman_smudge_start)

	* app/paint/picmanconvolve.c (picman_convolve_motion): use
	picman_pickable_get_pixel_at() to get the color to use with
	color_region(). Fixes Smudge and Convolve tools on grayscale images.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanparamspecs.c (picman_param_string_validate): the GLib
	version that has string validation fixed is 2.12.12.

2007-05-02  Martin Nordholts  <martinn@svn.gnome.org>

	When adjusting a rectangle it feels unintuitive that the center of
	the rectangle when Ctrl is used lands on the corner that was used
	to resize the rectangle. This commit changes the center of the
	rectangle when Ctrl is used on a already-created rectangle to the
	center of the rectangle when the user starts adjusting the size.

	* app/tools/picmanrectangletool.c (struct
	_PicmanRectangleToolPrivate): Added center_[xy]_on_fixed_center
	members that keeps track on where the center of the rectangle
	should be when the Ctrl modifier is used.

	* app/tools/picmanrectangletool.c: Added convenience function
	picman_rectangle_tool_get_fixed_center_coords.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_button_press): Sets the
	center_[xy]_on_fixed_center members depending on whether the button
	press modifies an existing rectangle or creates a new one.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_active_modifier_key): Adjusted to accomodate to
	above mentioned changes.

2007-05-02  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c: cosmetics.

2007-04-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanselection.[ch] (picman_selection_extract): changed
	"drawable" parameter to "pickable" and added some special casing
	for the PICMAN_IS_DRAWABLE(pickable) case in the implementation.

	* app/core/picmandrawable-transform.c: changed accordingly.

	* app/core/picman-edit.c: ditto. Removed utility function
	picman_edit_extract_visible() and simply use picman_edit_extract() for
	"copy visible", passing image->projection. Fixes bug #434102.

2007-04-30  Michael Natterer  <mitch@picman.org>

	* themes/Default/gtkrc: set GtkButton::focus-line-width to 1 and
	GtkButton::focus-padding to 0, just like in the Small theme (it
	was always meant to be that way, stupid copy'n'paste...)

2007-04-29  Christophe Merlet  <redfox@redfoxcenter.org>

	* configure.in: Added "oc" (Occitan) to ALL_LINGUAS.

2007-04-28  Tor Lillqvist  <tml@novell.com>

	* picman-zip.in: Add libpicmanconfig to the developer package. Remove
	the separate gif plug-in cruft. Fix a few typos.

2007-04-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c: add optional run_mode keyword argument
	to pdb calls.

2007-04-28  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.c
	* app/widgets/picmandnd-xds.c
	* plug-ins/helpbrowser/dialog.c: use gdk_atom_intern_static_string().

2007-04-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanpickable.[ch]: added get_pixel_at() method to the
	PicmanPickable interface. This gives direct access to the pixel
	without converting it to an RGB color.

	* app/core/picmandrawable.c
	* app/core/picmanimagemap.c
	* app/core/picmanprojection.c: implement the new method and also use
	it to reimplement get_color_at().

	* app/core/picmanimage-crop.c (picman_image_crop_guess_bgcolor): use
	picman_pickable_get_pixel_at(). Fixes auto-shrink on indexed and
	grayscale images.

2007-04-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sunras.c (set_color_table): guard against a
	possible stack overflow.

2007-04-27  Sven Neumann  <sven@picman.org>

	* configure.in: use PANGO_DISABLE_DEPRECATED for pango < 1.17.

	* plug-ins/common/sample_colorize.c: removed unused variable.

2007-04-27  Sven Neumann  <sven@picman.org>

	* configure.in: depend on poppler-glib >= 0.4.1.

	* plug-ins/common/poppler.c: removed ifdefs to handle older
	versions of the poppler library. Removed "antialias" toggle from
	the procedure API and from the GUI; it's not supported by poppler.

2007-04-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/truchet.scm: fixed typo in procedure
	name (bug #433772).

2007-04-27  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/gflare/gflare.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/xjt/xjt.c
	* plug-ins/metadata/xmp-parse.c
	* plug-ins/flame/flame.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/compressor.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/mail.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/ifscompose/ifscompose.c: Open files in binary mode
	("rb" and "wb").

2007-04-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: renamed PicmanParamSpecString's
	flag "no_validate" to "allow_non_utf8".

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/*.pdb: renamed argument flag
	"no_validate" (which turns off utf8-validation for strings) to
	"allow_non_utf8" and renamed "no_success" (which turns off
	argument validation alltogether) to "no_validate".
	Doesn't affect generated code.

2007-04-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/display.pdb (display_is_valid)
	* tools/pdbgen/pdb/drawable.pdb (drawable_is_valid)
	* tools/pdbgen/pdb/image.pdb (image_is_valid)
	* tools/pdbgen/pdb/vectors.pdb (vectors_is_valid): it's the
	argument flag "no_success" which turns off validation, not
	"no_validate" (how obvious). Also fixed drawable and vectors
	procedures to check for !picman_item_is_removed() instead of
	picman_item_is_attached() (a newly created item is unattached
	but valid).

	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/vectors_cmds.c: regenerated.

2007-04-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/pattern.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/gradient_select.pdb: some argument cleanup: use
	"=> 1" instead of "=> '1'" for setting argument flags, also made
	argument property order consistent so flags come before "desc".
	Doesn't affect generated code.

2007-04-26  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c: document the image_types parameter (bug #326988).

2007-04-26  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (gaussian_blur_region)
	* plug-ins/common/blur.c (blur)
	* plug-ins/common/gauss.c (do_encoded_lre) (do_full_lre): reduce
	rounding errors.

	* plug-ins/common/checkerboard.c (checkerboard_dialog): layout
	improvements.

2007-04-26  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-save.c: disabled the layer offsets saving
	code. This can be re-enabled in 2.6, when the load plug-in is
	patched to support these saved offsets.

	* plug-ins/common/tiff-load.c: marked the code for the above
	with a TODO comment.

2007-04-26  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-save.c: save the layer offsets too, to
	fix bug #419578.

2007-04-26  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/gfig/gfig-dobject.c: properly parse files with CRLF
	line-endings which were created in the past in Windows. Fixes
	a part of bug #346988.

	* plug-ins/gfig/gfig.c: open files in binary mode so that the same
	line-endings are used on all platforms.

2007-04-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c (picman_brush_scale_size): removed bogus
	"return" from void function. Fixes bug #433339, patch from Eric
	Lamarque.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: set a different filename when
	the number of pages loaded is lower than the number of pages
	in the TIFF file.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: set the filename to the original
	filename in case of single-page loads.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c: moved the non-interactive check out
	of load_dialog() and into run().

2007-04-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.c (picman_param_string_validate): added
	#warning to use GParamSpecString's features once we depend on a
	fixed version.

2007-04-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch] (struct PicmanParamSpecString)
	(picman_param_spec_string): added "gboolean non_empty" to require
	the string being non-empty. Changed validation accordingly.
	Also fixed validation for static strings (we were happily
	freeing and modifying them before).

	* app/xcf/xcf.c: filenames should be non-empty.
	* app/pdb/picman-pdb-compat.c: compat strings shouldn't.

	* tools/pdbgen/app.pl: add support for $arg->{non_empty} and
	changed generation of calls to picman_param_spec_string().

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/vectors.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/progress.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/unit.pdb
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/buffer.pdb: require non-empty strings for data
	object names, procedure names, unit strings, PDB data identifiers
	and buffer names. Removed some manual strlen() checks, all other
	places just got better error reporting for free (proper validation
	error instead of unspecific execution error).

	* app/pdb/*_cmds.c: regenerated.

2007-04-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c: removed...

	* plug-ins/common/gif-load.c
	* plug-ins/common/gif-save.c
	* plug-ins/common/psd-load.c
	* plug-ins/common/psd-save.c: ...and renamed to make sense.

	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am: changed accordingly.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: make progress bars progress to
	completion.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: indentation changes.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: fixed the names of the plug-in
	binaries in PLUG_IN_BINARY.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* configure.in
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am
	* plug-ins/common/tiff-load.c
	* plug-ins/common/tiff-save.c: split TIFF load and save
	functionality into different plug-ins.

	* plug-ins/common/mkgen.pl: modified to allow plug-ins to override
	auto-generated library env; also use underscores instead of hyphens
	in the generated Makefile.am.

	* plug-ins/common/tiff.c: removed.

2007-04-25  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (convolve_region): round pixel values
	instead if just casting the float to an integer. Fixes bug #432978.

2007-04-25  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c: whitespace cleanup.

	* plug-ins/common/despeckle.c: minor cleanups.

2007-04-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c: also use the middle mouse
	button for panning.

	* plug-ins/common/nova.c: override the default mouse handling of
	the PicmanScrolledPreview and allow to reposition the center using
	the left mouse button. Fixes bug #364432.

	* app/tools/picmanrectangletool.c: formatting.

2007-04-24  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.17.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff.c: initialize the pages[] array with
	the page sequence for non-niteractive runs. Otherwise it'll
	simply load N copies of page 0.

2007-04-25  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff.c: fixed an issue where the page selection
	dialog was being shown even for non-interactive runs.

2007-04-24  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/tiff.c: added support to load multi-page TIFF
	images as single layered image or multiple individual per-page
	images, after prompting the user for choice using a
	PicmanPageSelector widget. Fixes the rest of bug #138495.

2007-04-24  Mukund Sivaraman  <muks@mukund.org>

	* libpicmanwidgets/picmanpageselector.c: updated the API documentation
	to indicate that the returned array is sorted.

2007-04-24  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/poppler.c: set the page selector target
	from lastvals before showing the dialog

2007-04-24  Sven Neumann  <sven@picman.org>

	* Made 2.3.16 development release.

2007-04-24  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: fiddle with test_config_LDFLAGS to make
	test-config link again.

	* plug-ins/common/wind.c: increased MAX_STRENGTH to 100.

2007-04-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: unset 'show-border' on the
	GtkNotebook that holds the hints.

2007-04-24  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginprocedure.[ch]: use GQuark for locale and
	help domains to avoid duplicating the same strings many times.

	* app/plug-in/picmanpluginmanager-restore.c: removed FIXME.

2007-04-24  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager-restore.c
	(picman_plug_in_manager_restore): set the default plug-in locale
	domain on all PicmanPlugInDefs which don't register a locale domain
	themselves. Fixes bug #430146.

2007-04-22  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush.pdb (brush_rename)
	* tools/pdbgen/pdb/gradient.pdb (gradient_rename)
	* tools/pdbgen/pdb/palette.pdb (palette_rename): don't allow the
	empty string as new name. Fixes bug #431845.

	* app/pdb/brush_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/palette_cmds.c: regenerated.

2007-04-21  Sven Neumann  <sven@picman.org>

	* app/widgets/dbus-service.xml
	* app/widgets/picmandbusservice.[ch]: use "uri" instead of "filename"
	in the D-Bus methods.

2007-04-20  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: enable word-wrapping in
	the Script-Fu console.

2007-04-19  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINGUAS): added 'km' (Khmer) (bug #420417).

2007-04-19  Sven Neumann  <sven@picman.org>

	* configure.in: bump the required version of pygtk to 2.10.4.
	Older versions have a bug in the code generator (bug #381389).

2007-04-18  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: don't override LDFLAGS, use AM_LDFLAGS instead.

2007-04-18  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/picmanpluginmanager.[ch]
	* app/plug-in/picmanpluginmanager-restore.[ch]: moved
	picman_plug_in_manager_restore() to its own file.

	* app/core/picman.c: changed accordingly.

	* app/Makefile.am (LDFLAGS): convince the linker to do its job.

2007-04-18  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	try to improve readability by moving code to helper functions.

2007-04-18  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmaninterpreterdb.[ch]: added a function that
	returns all file extensions registered in the interpreter db.

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	if the PATHEXT environment variable is set, append all registered
	file extensions to it. This way PICMAN can recognize Python scripts
	as plug-ins on platforms where the executable bit is unknown.

2007-04-18  Sven Neumann  <sven@picman.org>

	* data/tips/picman-tips.xml.in: fixed a typo.

2007-04-18  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c
	(picman_scrolled_preview_nav_button_press): applied patch from
	Aurimas Juška that fixes positioning of the quick navigation
	popup (bug #430917).

2007-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c (fp_render_preview): removed a conditional
	that has become obsolete now. Fixed indentation.

2007-04-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreviewarea.c: allow the draw, blend, mask
	and fill methods to be called with zero width or height. Nothing
	will be drawn, but it's still a valid call.

2007-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c: deal better with drawables that are not
	the same size as the image. Fixes bug #430455.

2007-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c: use g_malloc(); plugged memory leaks.

2007-04-17  Sven Neumann  <sven@picman.org>

	Allow other applications to open images in PICMAN as if they were
	new images (without associating a filename). Fixes bug #423118.

	* app/file/file-open.[ch]: added parameter 'as_new' to
	file_open_image() and its variants.

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/core/picmanimagefile.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmantoolbox-dnd.c: changed accordingly.

	* app/app.[ch]
	* app/main.c: added new command-line option '--as-new'.

	* app/widgets/picmandbusservice.[ch]
	* app/widgets/dbus-service.xml: added new method OpenAsNew to the
	D-Bus interface.

	* docs/picman.1.in: document the new command-line option.

2007-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/neon-logo.scm: applied slightly
	modified patch from Aurimas Juška which fixes bug #167260 by not
	allowing the selection to shrink too much.

2007-04-17  Michael Natterer  <mitch@picman.org>

	* app/config/picmanrc.c
	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/picmanplugin.c
	* app/gui/themes.c: don't translate --verbose or g_printerr()
	messages, they are debugging output that often ends up in bugzilla
	and should not depend on the locale.

2007-04-17  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gqbist.c: applied slightly modified patch from
	Aurimas Juška which adds an undo button to go back to the previous
	state. Fixes bug #356662.

2007-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/print/Makefile.am: use GTK_CFLAGS and GTK_LIBS.

2007-04-16  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: documentation fix.

2007-04-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancellrendereraccel.[ch]: remove
	PicmanCellRendererAccel.

	* app/widgets/picmanactionview.c: use GtkCellRendererAccel instead.
	If an action has no label, use its name as label. Always show the
	"Name" column because there are too many actions with confusingly
	similar names.

2007-04-16  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* app/gui/gui.c (gui_sanity_check): require gtk+ >= 2.10.6.

2007-04-16  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/lighting_ui.c: applied patch from Aurimas
	Juška that fixes sensitivity of input fields related to the light
	type (bug #359833).

2007-04-13  Michael Natterer  <mitch@picman.org>

	* app/base/base-types.h
	* app/base/temp-buf.[ch]: remove redundant and inconsistently used
	MaskBuf type and API.

	* app/core/picmanbrush-scale.c
	* app/paint/picmanbrushcore.[ch]: use TempBuf and its API instead.
	This also optimizes away a useless memset() on brush scaling,
	we completely fill each of the created buffers anyway.

2007-04-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleselecttool.c: implement
	PicmanTool::key_press and delegate to the rectangle tool or the edit
	selection tool. This resurrects positioning of floating selections
	with the cursor keys.

2007-04-12  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/display.pdb (display_delete): added a note that
	calling this function may cause data loss.

	* app/pdb/display_cmds.c
	* libpicman/picmandisplay_pdb.c: regenerated.

2007-04-12  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-parse.c: made the parser more tolerant and
	accept XMP blocks that are not using the namespace prefixes
	recommended by the XMP specification.

2007-04-12  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-commands.c: if a plug-in or script
	registered with a DISPLAY argument after the run-mode argument,
	then pass the ID of the active display to the script, optionally
	followed by image and drawable IDs.

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h: added SF-DISPLAY parameter.

2007-04-12  Sven Neumann  <sven@picman.org>

	* plug-ins/sel2path/*.[ch]: updated copyright header.

2007-04-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/channel_mixer.c
	* plug-ins/gfig/gfig-style.c: get rid of compiler warnings about
	dereferencing type-punned pointers.

2007-04-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c
	* app/tools/picmancurvestool.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf-load.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancolorframe.c: get rid of compiler warnings about
	dereferencing type-punned pointers.

2007-04-12  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.[ch] (struct _GPParam): don't redefine
	the PicmanParasite struct, just use it.

	* libpicman/picman.c: include picmanparasite.h.

	* libpicman/picmanitemcombobox.c (picman_item_combo_box_new): initialize
	combo_box_type to suppress a compiler warning.

	* libpicmanwidgets/picmanmemsizeentry.c (picman_memsize_entry_new):
	avoid dereferencing a type-punned pointer.

2007-04-11  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-display-filter-contrast-24.svg
	* themes/Default/images/stock-display-filter-colorblind-24.svg
	* themes/Default/images/stock-display-filter-contrast-24.png
	* themes/Default/images/stock-display-filter-colorblind-24.png
	* themes/Default/images/stock-display-filter-contrast-16.svg
	* themes/Default/images/stock-display-filter-colorblind-16.svg
	* themes/Default/images/stock-display-filter-lcms-24.svg
	* themes/Default/images/stock-display-filter-contrast-16.png
	* themes/Default/images/stock-display-filter-colorblind-16.png
	* themes/Default/images/stock-display-filter-lcms-24.png
	* themes/Default/images/stock-display-filter-lcms-16.svg
	* themes/Default/images/stock-display-filter-gamma-24.svg
	* themes/Default/images/stock-display-filter-lcms-16.png
	* themes/Default/images/stock-display-filter-gamma-24.png
	* themes/Default/images/stock-display-filter-gamma-16.svg
	* themes/Default/images/stock-display-filter-gamma-16.png: how
	could I have gone to LGM with a straight face without finishing
	these?

2007-04-11  Sven Neumann  <sven@picman.org>

	* INSTALL: document the new options (and some not so new ones).

	* configure.in: applied patch from Hanno Boeck that adds more
	configure options (bug #425267).

2007-04-11  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose_utils.c (ifs_render): applied
	patch from Aurimas Juška to fix bug #428556.

2007-04-11  Mukund Sivaraman  <muks@mukund.org>

	* app/display/picmanstatusbar.c: Fixes a bug (#428493) where
	  picman_statusbar_push_temp() expects vaargs and
	  picman_statusbar_progress_message() directly passes a message
	  to it as the format string.. in this case the message
	  contains % (in the filename) and no arguments.

2007-04-09  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanperspectiveclone.c
	* app/paint/picmanpaintoptions.c: #include "libpicmanmath/picmanmath.h"

2007-04-01  Michael Natterer  <mitch@picman.org>

	* app/base/Makefile.am
	* app/base/brush-scale.[ch]: removed these files.

	* app/core/Makefile.am
	* app/core/picmanbrush-scale.[ch]: added the functions here as
	static utility functions. Also move the default implementations of
	PicmanBrush::scale_size(), ::scale_mask() and ::scale_pixmap() here,
	including their utility functions.

	* app/core/picmanbrush.c: remove all scale stuff and
	include "picmanbrush-scale.h" instead.

	(picman_brush_get_new_preview): use PicmanBrush's scale functions
	instead of the now private ones. Cleanup.

	(picman_brush_scale_mask)
	(picman_brush_scale_pixmap): return a copy of the buf for
	scale == 1.0.

2007-03-31  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/svg.c:
	* plug-ins/common/tiff.c:
	* plug-ins/common/wmf.c:
	* plug-ins/jpeg/jpeg-load.c: some file load plug-ins did call
	picman_quit() in their load functions. This aborts the plug-in
	instead of returning a PICMAN_PDB_EXECUTION_ERROR. The run()
	function in each plug-in was already prepared to do this on
	errors.

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-blend.c: use SQR(x) instead of x*x.

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_start): set
	core->saved_proj_tiles to NULL after unrefing them.

	* app/paint/picmanpaintcore.h: whitespace fixes.

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.[ch]: made the
	PicmanRectangleOptionsPrivate struct public (ha ha).

	(picman_rectangle_options_gui): replaced the "Auto shrink selection"
	toggle by a normal button that needs to be clicked explicitely.

	* app/tools/picmanrectangletool.c: access members of
	PicmanRectangleOptionsPrivate directly instead of reading them into
	local variables using g_object_get(), this makes the code quite
	more readable. Some code cleanup.

	(picman_rectangle_tool_button_release): get rid of the confusing
	auto-shrink madness on button release...

	(picman_rectangle_tool_start)
	(picman_rectangle_tool_halt): ...instead, connect to the option's
	auto shrink button and shrink on "clicked".

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleselecttool.c: read the "operation" member
	of PicmanSelectionOptions directly.

	* app/tools/picmanellipseselecttool.c (picman_ellipse_select_tool_draw):
	chain up instead of calling picman_rectangle_tool_draw() directly,
	don't #include "picmanrectantletool.h".

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c: access the PicmanCropOptions structure
	directly to read the "layer_only" option (don't use g_object_get),
	some code cleanup.

2007-03-31  Michael Natterer  <mitch@picman.org>

	Statusbar messages shouldn't depend on the emission of unrelated
	signals:

	* app/widgets/picmanuimanager.c (picman_ui_manager_connect_proxy):
	connect to the menu items' "select" and "deselect" signals here...

	(picman_ui_manager_item_realize): ...instead of here.

2007-03-31  Michael Natterer  <mitch@picman.org>

	* app/actions/dialogs-actions.c
	* app/actions/dock-actions.c
	* app/actions/edit-actions.c
	* app/actions/file-actions.c
	* app/actions/help-actions.c
	* app/actions/layers-actions.c
	* app/actions/plug-in-actions.c
	* app/actions/tools-actions.c
	* app/actions/vectors-actions.c
	* app/actions/view-actions.c
	* app/actions/window-actions.c: add many missing action tooltips
	and fixed some broken/inconsistent ones. Sorry for the big string
	change but the inconsistencies were just too big to ship 2.4 like
	that.

2007-03-30  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c: hardcode the result of
	log (1.0 / 255.0) and avoid a useless call to sqrt().

2007-03-30  Sven Neumann  <sven@picman.org>

	* app/paint/picmanheal.c (picman_heal_laplace_iteration)
	(picman_heal_laplace_loop): compare square of errors instead of
	calculating the square root. Rewritten loop to avoid code duplication.

2007-03-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]
	* app/tools/picmanperspectiveclonetool.c
	* app/tools/picmantransformtool.c: compare squared distances.

2007-03-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw_guides):
	hardcode the result of sqrt(5).

2007-03-29  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_check_click_distance): don't
	compare the result of sqrt() with something, compare the original
	value with something's square instead.

2007-03-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushgenerated.c (picman_brush_generated_calc): moved
	generation of the lookup table to it's own function. Also changed
	SUPERSAMPLING from 5 to 4. Let's see if someone complains...

2007-03-29  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpixelrgn.c: code cleanup. Removed MEMCPY_IS_NICE
	define and unconditionally use memcpy().

2007-03-29  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpixelrgn.c (picman_pixel_rgn_init): initialize
	rowstride to zero; it's meaningless as long as data is NULL.

2007-03-28  Sven Neumann  <sven@picman.org>

	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.c: regenerated.

2007-03-28 João S. O. Bueno Calligaris <gwidion@mpc.com.br>

        * tools/pdbgen/pdb/layer.pdb: clarified documentation for
	add_mask procedure; fixed typo in documentation for create_mask.

2007-03-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandbusservice.[ch]
	* app/widgets/dbus-service.xml: added a boolean return value to
	the D-Bus Open method.

2007-03-27  Sven Neumann  <sven@picman.org>

	* app/file/file-open.[ch]: changed file_open_from_command_line()
	to deal with a single filename only.

	* app/widgets/picmandbusservice.[ch]
	* app/widgets/dbus-service.xml: changed the D-Bus Open method to
	take only a single filename.

	* app/app.c
	* app/main.c: changed accordingly.

2007-03-26  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/compressor.c (save_image, load_image):
	Check if the files to be read or written and the temporary files
	have been opened. Otherwise, bail out safely instead of causing a
	crash. Fixes bug #422444.

2007-03-26  Sven Neumann  <sven@picman.org>

	* app/widgets/dbus-service.xml
	* app/widgets/picmandbusservice.h: be more specific in the D-Bus
	service and interface name.

2007-03-23  Sven Neumann  <sven@picman.org>

	Make XOR color configurable (bug #421466):

	* app/config/picmanrc-blurbs.h
	* app/config/picmandisplayconfig.[ch]: added picmanrc option for the
	XOR color.

	* app/display/picmancanvas.[ch]: keep a reference to the Picman object
	and take the XOR color from PicmanDisplayConfig.

	* app/display/picmandisplayshell.c: pass picman to picman_canvas_new().

2007-03-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c (picman_layer_add_mask): allow adding a mask
	to a layer without alpha channel (bug #316207).

2007-03-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: fixed incorrect PDB documentation.

2007-03-21  Martin Nordholts  <martin@svn.gnome.org>

	* plug-ins/common/svg.c (run): Added comment to explain why the
	svg file provided resolution is not clamped against
	PICMAN_MIN/MAX_RESOLUTION.

2007-03-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): don't
	call picman_zoom_model_zoom() before assigning shell->display. Fixes
	bug #421044.

2007-03-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmanblendtool.c (picman_blend_tool_button_release): fixed
	typo spotted by Bill Skaggs.

2007-03-21  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-preview.c
	(picman_display_shell_trace_tri_edge): be more robust to avoid
	crashes like bug #420595.

2007-03-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancursorview.[ch] (picman_color_frame_update_cursor):
	disallow passing a NULL image.

	(picman_color_frame_clear_cursor): new function that clears the
	cursor view.

	* app/widgets/picmancolorframe.c (picman_color_frame_update): if
	color_frame->sample_valid is FALSE, don't do any color
	transformations and don't construct any string because none
	of them is going to be used (all labels will show "n/a").

	* app/display/picmanstatusbar.[ch]: renamed set_cursor() API
	to update_cursor().

	* app/display/picmandisplayshell-cursor.c
	(picman_display_shell_update_cursor): move variables to local
	scopes. Follow PicmanStatusbar API change. Cleanup.

	(picman_display_shell_clear_cursor): ditto. Follow PicmanCursorView
	API change.

2007-03-20  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-actions.c
	* app/menus/plug-in-menus.c: PicmanPlugInProcedure has a boolean
	member "file_proc" now, use it instead of checking prefixes,
	extensions and magics manually.

	* app/plug-in/picmanpluginprocedure.c
	(picman_plug_in_procedure_set_mime_type)
	(picman_plug_in_procedure_set_thumb_loader): set
	plug_in_proc->file_proc to TRUE here too.

	* plug-ins/common/pnm.c: register "image/x-portable-anymap" as
	mime-type and "pnm" as extension for file-pnm-save so it's
	recognized as file procedure.

2007-03-19  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c (picman_install_procedure): rephrased new
	documentation.

2007-03-19  Michael Natterer  <mitch@picman.org>

	Make sure we create actions for all plug-in procedures which have
	a menu_label, so it's possible to assign shortcuts to them.
	Fixes bug #371300.

	* app/actions/plug-in-actions.c (plug_in_actions_setup): removed
	duplicate code and simply call plug_in_actions_register_procedure()
	on all actions, it already does all needed checks and signal
	connections by itself.

	(plug_in_actions_update)
	(plug_in_actions_register_procedure)
	(plug_in_actions_unregister_procedure): unified checks for whether
	a plug-in procedure needs an action or not: it needs either a
	menu_label or menu_paths and must not have extensions, prefixes or
	magics.

	* libpicman/picman.c (picman_install_procedure): document that it's
	possible to install shortcut-only procedures by registering a
	menu_label but no menu_paths.

2007-03-19  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: changed labels for
	PicmanTransformDirection to make the corrective transform feature
	more obvious.

2007-03-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c: cosmetic cleanup.

2007-03-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c
	(picman_brush_core_scale_mask)
	(picman_brush_core_scale_pixmap)
	(picman_brush_core_get_brush_mask): remove parameter
	"gdouble scale" and use core->scale.

	(picman_brush_core_paste_canvas)
	(picman_brush_core_replace_canvas)
	(picman_brush_core_get_brush_mask)
	(picman_brush_core_color_area_with_pixmap): don't pass core->scale.
	As below, passing anything else makes no sense.

	(picman_brush_core_interpolate): cleanup.

2007-03-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.[ch]
	(picman_brush_core_color_area_with_pixmap): removed parameters
	"PicmanImage *dest" (because it's always the passed drawable's
	image) and "gdouble scale" (because passing anything but
	brush_core->scale makes no sense whatsoever).

	* app/paint/picmanpaintbrush.c (_picman_paintbrush_motion): changed
	accordingly.

2007-03-18  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c: simplified brush scale calculation by
	making sure that brush_core->scale always contains a value that's
	suited as input for picman_brush_scale_mask/pixmap() (bug #419290).

	(picman_brush_core_calc_brush_size): removed this function. All
	places can now call picman_brush_scale_size() directly with
	core->scale as parameter.

	(picman_brush_core_calc_brush_scale): new function which returns
	a linear scale factor which contains both the area-based pressure
	scale factor and the linear paint options scale factor.

	(picman_brush_core_start)
	(picman_brush_core_get_paint_area): use the new function instead
	of doing these calculations manually.

	(picman_brush_core_interpolate): remove call to
	picman_brush_core_scale_brush_size() and use core->scale directly.

	(picman_brush_core_get_paint_area)
	(picman_brush_core_scale_mask)
	(picman_brush_core_scale_pixmap): use picman_brush_scale_size()
	instead of the removed picman_brush_core_scale_brush_size().

	(picman_brush_core_create_bound_segs): use only
	paint_options->brush_scale here since the canvas brush preview
	always has to asume full pressure.

	* app/core/picmanbrush.c (picman_brush_scale_size): special case
	scale == 1.0 and return the mask's width/height without calling
	the virtual function.

2007-03-18  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.c (file_check_single_magic): jikes, the
	offset is to be interpreted as offset from the start of the file
	for offset >= 0, not offset > 0.

2007-03-17  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.c (file_check_single_magic): allow negative
	offsets in magics and interpret them as relative to the end of the
	file.

	(file_utils_find_proc)
	(file_check_magic_list): some cleanup.

	* plug-ins/common/tga.c (query): register the magic string
	"TRUEVISION-XFILE.\0" 18 bytes before the end of the file.
	This way, "new style" TGA files are detected regardless of
	their filename. "old style" TGA files still need the right
	extension to be treated as TGA. Added "vda", "icb" and "vst"
	to the list of extensions. Fixes bug #133798.

2007-03-17  Michael Natterer  <mitch@picman.org>

	Make the height of the previews in data editors configurable.
	Fixes bug #337757.

	* app/widgets/picmandataeditor.[ch]: add member "view" which needs
	to be set by subclasses. Add style property "minimal-height" which
	defaults to 96. Add style_set() implementation which sets
	editor->view's height to the configured value.

	* app/widgets/picmanbrusheditor.[ch]
	* app/widgets/picmangradienteditor.[ch]
	* app/widgets/picmanpaletteeditor.[ch]: use data_editor->view for
	storing the view widget and removed own view members. Remove
	separate #defines for the view's default width and height, it's
	width follows the dialog anyway.

	* themes/Default/gtkrc: document the default value of 96.

	* themes/Small/gtkrc: set it to 64.

2007-03-17  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-compat.init: Fixed syntax
	error in string-trim-left function (spotted by Saul Goode). Added
	compatability routine for 'verbose'.

2007-03-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_register):
	register the tool with PICMAN_PAINT_OPTIONS_CONTEXT_MASK and
	PICMAN_CONTEXT_GRADIENT_MASK so its tool options are suited
	as parameter object for stroking (the stroke button in the
	tool options was using default values before).

2007-03-16  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginprocframe.c
	(picman_plug_in_proc_frame_get_return_vals): don't just g_free() the
	GValueArray after we memcpy()-stole its values because this both
	leaks the contained array of GValues and crashes with glib trunk
	where GValueArray is slice-allocated. Instead, free the array of
	GValues manually, set it to NULL and use g_value_array_free().

2007-03-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu.c: remove N_() from calls to
	picman_plugin_menu_register().

2007-03-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/spyropicman.scm: update the progress
	to avoid looking like the script hangs. Fixes bug #356677.

	* plug-ins/script-fu/script-fu-interface.c
	(script_fu_interface_report_cc): if the command starts with
	"picman-progress-", the script is obviously showing a progress bar
	for itself, so clear the text instead of showing an endless number
	of "picman-progress-update" messages. Also fixed manual main loop
	iteration.

2007-03-16  Michael Natterer  <mitch@picman.org>

	Fix stuck progress bars (bug #393832):

	* app/plug-in/picmanplugin-progress.[ch] (picman_plug_in_progress_end):
	added PlugInProcFrame parameter instead of blindly using the topmost
	in the procedure stack...

	* app/plug-in/picmanpluginprocframe.c
	(picman_plug_in_proc_frame_dispose): ...because we call it from here,
	when the proc_frame is already removed from the procedure stack.

	Unrelated:

	* plug-ins/script-fu/scripts/difference-clouds.scm: use
	RUN-INTERACTVE instead of 0, added (picman-displays-flush)

	* plug-ins/common/snoise.c (solid_noide): update the progress to
	1.0 after rendering.

2007-03-15  Michael Natterer  <mitch@picman.org>

	* data/brushes/Makefile.am: group files by type.

2007-03-15  Martin Nordholts  <martinn@svn.gnome.org>

	Converted .gbr to .vbr brushes where possible. Fixes bug #322176 and
	bug #157506.

	* data/brushes/Makefile.am: Changed .gbr for .vbr-counterparts for
	converted brushes.

	* data/brushes/*circle.gbr:
	* data/brushes/*fcircle.gbr:
	* data/brushes/DStar*.gbr:
	* data/brushes/callig*.gbr: Removed.

	* data/brushes/Circle-*.vbr:
	* data/brushes/Circle-Fuzzy-*.vbr:
	* data/brushes/Diagonal-Star-*.vbr:
	* data/brushes/Calligraphic-Brush-*.vbr: Added.

2007-03-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanaligntool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanvectortool.c: remove picman_tool_pop_status() from
	control() implementations because PicmanTool does this generically now.

	* app/tools/picmanblendtool.c
	* app/tools/picmanselectiontool.c: remove entire control()
	implementations because they were doing nothing else.

2007-03-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpaintoptions-gui.c (picman_paint_options_gui): "adj"
	is a GtkObject not a GtkWidget, also moved it to its local scope.

2007-03-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_halt): check
	if tool->display is there before dereferencing it (bug #418504).

	(picman_rectangle_tool_start): add "display" parameter and set
	tool->display here.

	(picman_rectangle_tool_button_press): pass the display to start()
	and don't set tool->display here.

2007-03-14  Michael Natterer  <mitch@picman.org>

	Make the status display stuff local to PicmanTool:

	* app/tools/tool_manager.c (tool_manager_control_active): don't
	call picman_tool_clear_status().

	* app/tools/picmantool.[ch]: make picman_tool_clear_status() a
	private function. Move call to picman_tool_clear_status() from
	real_control() to control(). Check the status_displays too in
	picman_tool_real_has_display() and picman_tool_has_image() so the
	normal mechanism of control(HALT)ing (and thus popping all
	status messages) the tool on display close works.

2007-03-14  Michael Natterer  <mitch@picman.org>

	Fix stuck statusbar messages when changing tools (bug #398913):

	* app/tools/picmantool.[ch]: keep a list of status_displays around.
	Update the list in all status push, replace and pop functions.
	Added picman_tool_clear_status() which removes the status messages
	from all displays in the list. Call the function from
	picman_tool_real_control(HALT).

	* app/tools/tool_manager.c (tool_manager_control_active): if we
	can't call picman_tool_control() because we have no display to pass,
	still call picman_tool_clear_status() so the messages go away from
	displays the tool was only hovering.

2007-03-14  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin.c (picman_plug_in_new): require either
	"procedure" or "prog" being non-NULL, not both of them at the same
	time. Get the executable name from the procedure if the procedure
	was passed.

	* app/plug-in/picmanpluginmanager-call.c
	(picman_plug_in_manager_call_run): pass a NULL prog since we already
	pass the procedure.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: sprinkled some const
	qualifiers and removed obscure shift code in favor of letting the
	compiler do this optimization.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]: renamed newly added members
	to scale_x and scale_y and removed the SCALEFACTOR macros.

	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-transform.c
	* app/display/picmannavigationeditor.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanrectangletool.c: changed accordingly.

2007-03-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c: some minor fixes and stylistic
	paranoia i overlooked in last night's late review.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]: cache the display scale
	factors in the PicmanDisplayShell struct and recalculate it in
	picman_display_shell_scale_factor_changed().

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_set_dot_for_dot)
	* app/display/picmandisplayshell-handlers.c
	(picman_display_shell_resolution_changed_handler)
	(picman_display_shell_monitor_res_notify_handler): update the scale
	factors by calling picman_display_shell_scale_factor_changed().

	* app/display/picmandisplayshell-transform.c
	* app/display/picmannavigationeditor.c: code cleanup.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c (struct _PixelSurround): documentation.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_drb): moved calculations out of MIN() macro.

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintoptions.c: limit brush scale to [0.01, 10.0]

2007-03-14  Sven Neumann  <sven@picman.org>

	* app/base/brush-scale.c: minor cleanups, moved calculations out
	of the MIN() macro, avoid unneeded floating-point calculations.

2007-03-14  Martin Nordholts  <martinn@svn.gnome.org>

	Made brushes upscalable by using scale_region. Downscaling still
	uses functions in app/base/brush-scale.c (because of better
	performance). Parametric brushes of course recalculates masks
	instead of using bitmap scaling. Fixes bug #65030.

	* app/core/picmanbrush.[ch]: Added a private scale_buf method which
	uses scale_region (with PICMAN_INTERPOLATION_LINEAR) to scale its
	masks and pixmaps. Also added public virtual method scale_size to
	PicmanBrush (overridden by PicmanBrushGenerated) which calculates the
	buffer sizes for a given brush scaled with a given scale.

	* app/core/picmanbrushgenerated.c: Implemented the new scale_size
	method inherited from PicmanBrush, and modified
	picman_brush_generated_calc to use this helper function.

	* app/tools/picmanpaintoptions-gui.c (picman_paint_options_gui): Made
	the brush Scale-slider logarithmic.

	* app/paint/picmanpaintoptions.c (picman_paint_options_class_init):
	Changed Scale scale to [0.0, 10.0].

	* app/paint/picmanbrushcore.c:
	(picman_brush_core_calc_brush_size): Refactored 'get brush size' code
	to where it belongs, in PicmanBrush-classes, and allowed scales
	larger than 1.0.

2007-03-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandialogfactory.[ch]: added new ugly function
	picman_dialog_factory_hide_dialog() which does gtk_widget_hide() and
	sets the stored visibility state to PICMAN_DIALOG_VISIBILITY_INVISIBLE
	in order to avoid re-showing dialogs that were already insivible due
	to TAB-toggling when we gtk_widget_hided them.

	* app/tools/picmantransformtool.c
	* app/tools/picmanimagemaptool.c: use the new function instead of
	gtk_widget_hide() to hide tool dialogs. Fixes bug #414006.

2007-03-13  Sven Neumann  <sven@picman.org>

	* data/brushes/Makefile.am
	* data/brushes/thepicman.gbr
	* data/brushes/xcf.gbr: removed two legacy brushes.

2007-03-13  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/script-fu/script-fu-console.c: Fix for bug #417467
	based on modified patch by Eric Lamarque and suggested by Mitch.
	Allows build without warnings and correct localization for Solaris
	and other platforms.

2007-03-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_response):
	added a g_return_if_fail() check to catch bug #414006.

2007-03-13  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_label_set_attributes): fixed
	implementation for PANGO_ATTR_STRIKETHROUGH, spotted by Behdad
	Esfahbod.

2007-03-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-transform.c: code cosmetics.

2007-03-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifytool.[ch]: lots of fixes and changes:

	- Request click events and use them instead of looking at the
	  distance the mouse travelled ourselves.
	- Also zoom when the user draws a very thin rectangle or just a
	  line, there is no reason to treat that as click.
	- Changed all calculations and stored values to double so the tool
	  continues to work smoothly at high zoom levels.
	- Fix scale calculation when zooming out (was totally b0rk).
	- Changed offset calculation when zooming out so that the current
	  viewport ends up within the drawn rectangle (which is the
	  opposite of what zooming in does).

2007-03-12  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin.[ch]: picman_plug_in_get_undo_desc() uses
	picman_plug_in_procedure_get_label(). Made the return value const.

	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/undo.pdb: changed accordingly.

	* app/actions/plug-in-actions.c: cosmetics.

	* app/pdb/undo_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/drawable_cmds.c: regenerated.

2007-03-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.c
	* app/tools/picmanpaintoptions-gui.c
	* app/base/brush-scale.[ch]
	* app/base/temp-buf.[ch]
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanbrushcore.c: revert last commit. The patch needs
	more review and it's easier to start from quare one than have
	patches on top of patches.

2007-03-11  Michael Schumacher  <schumaml@cvs.gnome.org>

	Made brushes scalable (both up and down) by using existing
	scaling routines, and also refactored some brush-code. Patch by
	Martin Nordholts. Fixes bug #65030.

	* app/paint/picmanbrushcore.c:
	(picman_brush_core_calc_brush_length_scale) Refactored 'get brush
	size' code to where it belongs, in PicmanBrush-classes, and renamed
	picman_brush_core_calc_brush_size to
	picman_brush_core_calc_brush_length_scale.

	* app/paint/picmanpaintoptions.c (picman_paint_options_class_init):
	Changed Scale scale to [0.0, 100.0].

	* app/base/temp-buf.[ch] (mask_buf_new): Change signature to also
	take a bpp parameter.

	* app/base/brush-scale.[ch]: Changed brush_scale_(mask|pixmap) to
	the new brush_scale_buf, which uses existing scaling routines
	(scale_region) instead of dedicated down-scaling only routines.

	* app/tools/picmanpaintoptions-gui.c (picman_paint_options_gui): Made
	the brush Scale-slider logarithmic.

	* app/core/picmanbrushgenerated.c: Implemented the new
	get_scaled_size method inherited from PicmanBrush, and modified
	picman_brush_generated_calc to use this helper function.

	* app/core/picmanbrush.[ch]: Added public virtual method
	get_scaled_size to PicmanBrush, overridden by PicmanBrushGenerated,
	which calculates the buffer sizes for a given brush scaled with a
	given scale. Also changed calls to brush_scale_(mask|pixmap) to
	the new brush_scale_buf.

2007-03-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_motion):
	removed default label from enum switch statement.

2007-03-10  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_update): while the
	statusbar is being used as a progress bar, only show progress
	messages.

2007-03-10  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginprocedure.[ch]: cache the result of
	picman_plug_in_procedure_get_label() and made the return value const.

	* app/actions/plug-in-actions.c
	* app/plug-in/picmanplugin-cleanup.c
	* app/plug-in/picmanpluginmanager.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanimagepropview.c: changed accordingly.

	* app/file/file-open.c
	* app/file/file-save.c: include the plug-in name (or actually the
	label) in the error messages.

2007-03-10  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: don't include libpicmanmath/picmanmathtypes.h

	* app/base/base-types.h: include it here. Also include
	libpicmancolor/picmancolortypes.h

2007-03-10  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.16.

2007-03-10  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.[ch] (enum PicmanButtonReleaseType): added
	value PICMAN_BUTTON_RELEASE_NO_MOTION.

	* app/tools/picmantool.[ch]: when click events are requested and the
	click was too long for a "click" event, send a NO_MOTION event if
	the pointer didn't move at all.

	* app/tools/picmanbucketfilltool.c: treat NO_MOTION as tool
	confirmation too.

	* app/tools/picmanfreeselecttool.c: request click events and treat
	both CLICK and NO_MOTION as tool confirmation.

	* app/tools/picmanrectangletool.c: ignore NO_MOTION.

2007-03-09  Sven Neumann  <sven@picman.org>

	* Made 2.3.15 development release.

2007-03-09  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am: fixed build of test-config.

2007-03-09  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-util-setpt.scm: Removed
	erroneous comment block.

	* plug-ins/script-fu/scripts/script-fu-set-cmap.scm: Use only
	American (USA) spelling in translatable strings.

2007-03-09  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: include "libpicmanmath/picmanmathtypes.h"
	instead of "libpicmanmath/picmanmath.h".

	* app/core/picmanbrush.h
	* app/paint/picmanpaintcore.h
	* app/paint/picmanperspectiveclone.h
	* app/text/picmantext.h
	* app/tools/picmantransformtool.h: include picmanvector.h and
	picmanmatrix.h explicitely where they are needed in public structs.

	* app/*/*.c
	* tools/pdbgen/pdb/paths.pdb: include "libpicmanmath/picmanmath.h"
	where needed.

	* app/pdb/paths_cmds.c: regenerated.

2007-03-09  Michael Natterer  <mitch@picman.org>

	* app/tools/*.c: remove useless includes. Some minor cleanup.

2007-03-09  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: replaced inner loop by a call to memcpy.

2007-03-09  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: fixed handling of uncovered regions.

2007-03-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_key_press):
	added missing call to picman_rectangle_tool_update_options (). Fixes
	bug #416268.

2007-03-09  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanblendtool.c (picman_blend_tool_push_status): make
	the new feature visible in the status bar (alas, this implies a
	new translatable string).

2007-03-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanblendtool.h (struct PicmanBlendTool): renamed
	members and added last_x and last_y to remember the last mouse
	coords.

	* app/tools/picmanblendtool.c: changed accordingly. Take drawable
	offset into account in button_release() and remove offset
	calculations from all other places. Enabled using ALT for moving
	the entire line.

2007-03-08  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c (pixel_surround_get_data): do one less
	call to tile_manager_get_tile().

2007-03-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbucketfilltool.[ch]: request click events, removed
	target_x,y struct members and button_press() implementation and
	use the coords passed in button_release(). Also make sure that
	a click has no effect in areas where we show the bad corsor.

2007-03-08  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: support mnemonics in parameter labels.

	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/colorxhtml.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py
	* plug-ins/pypicman/plug-ins/palette-offset.py
	* plug-ins/pypicman/plug-ins/palette-sort.py: added mnemonics.

2007-03-08  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: fixed boundary case.

2007-03-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch]: picman_prop_string_combo_box_new()
	takes a GtkTreeModel, not a GtkTreeStore.

2007-03-08  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/winicon/main.c (run): fixed the incorrect declaration
	of the values[] array.  Thanks to Petr Gajdos <pgajdos@suze.cz>
	for reporting this problem and for supplying a patch.

2007-03-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantransformtool.[ch]: removed shell_desc member from
	PicmanTransformToolClass and just use the tool blurb instead.

2007-03-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_key_press):
	added missing call to picman_rectangle_tool_rectangle_changed().
	Fixes bug #415833.

2007-03-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanvectoroptions.c (picman_vector_options_gui): describe
	usage of modifiers as suggested in bug #415796.

2007-03-07  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c (pixel_surround_lock): reduced number
	of calls to tile_manager_get_tile().

2007-03-07  Michael Natterer  <mitch@picman.org>

	Clean up fix for bug #328001:

	* app/tools/picmaneditselectiontool.[ch] (process_event_queue_keys):
	made private again.

	(picman_edit_selection_tool_translate): new function which has an
	additional PicmanTransformType parameter to determine what transform
	to perform. Do all the work here, ignoring the key event's
	modifier state.

	(picman_edit_selection_tool_key_press): just determine the transform
	type from the key event's modifier state and call
	picman_edit_selection_tool_translate().

	* app/tools/picmanmovetool.c (picman_move_tool_key_press): removed all
	code and call picman_edit_selection_tool_translate() with
	options->move_type. Moved the function to its proper place in the
	file.

2007-03-07  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: keep an internal buffer filled with
	the background color and use it for out of bounds requests. Speed
	up filling the internal buffer by copying data row-by-row.

2007-03-06  Sven Neumann  <sven@picman.org>

	Patch by Martin Nordholts. Fixes bug #328001.

	* app/tools/picmaneditselectiontool.[ch] (process_event_queue_keys):
	Made process_event_queue_keys public for use of picmanmovetool.c.
	Still needs to be renamed and moved to another place.

	* app/tools/picmanmovetool.c (picman_move_tool_key_press): Created
	picman_move_tool_key_press() which takes care of events that
	picman_edit_selection_tool_key_press() is not is able to
	handle. Otherwise just pass key events on to that method.

2007-03-05  Manish Singh  <yosh@picman.org>

	* configure.in: Make --without-script-fu work. Also make the spacing
	line up again in the post configure option summary.

2007-03-05  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c: changed strings as suggested in bug #304148).

2007-03-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_execute): if the user clicks inside an
	existing selection, initialize the rectangle tool to the entire
	selection, not just to the part of it that is within the active
	drawable. Also removed some dead code.

2007-03-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanstrokeeditor.c: added missing cast.

2007-03-05  Michael Natterer  <mitch@picman.org>

	Makes default Select -> Border behaviour consistent, and makes
	'sticky image edges' optional by adding a checkbox in the Border
	Selection dialog. Patch by Martin Nordholts. Fixes bug #350009.

	* app/actions/select-commands.c (select_border_cmd_callback)
	(select_border_callback): Added edge-lock checkbox to dialog and
	modified calls accordingly.

	* app/paint-funcs/paint-funcs.c (border_region)
	(compute_transition): Fixed algorithm. (compute_transition is a
	helper function to the algorithm). Also clarified many parts of
	the algorithm with comments.

	* app/paint-funcs/paint-funcs.h
	* app/core/picmanchannel.[ch]
	* app/core/picmanselection.c: Added gboolean edge_lock to function
	calls/signatures.

	* app/pdb/selection_cmds.c: Regenerated.

2007-03-05  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: added typdef PicmanMemsizeFunc.

	* app/core/picman-utils.[ch]: added _foreach() variants of
	GHashTable, GList and GSList functions which take PicmanMemsizeFunc
	callbacks. Added picman_parasite_get_memsize(). Added "data_size"
	parameter to picman_g_hash_table_get_memsize().

	* app/core/picman.c
	* app/core/picmanpalette.c
	* app/core/picmanparasitelist.c
	* app/pdb/picmanpdb.c
	* app/plug-in/picmanpluginmanager.c: use the new functions instead
	of itering manually or ignoring the containers' elements. Changed
	callers of picman_g_hash_table_get_memsize().

2007-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colorify.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/retinex.c: resolved clashing mnemonics (bug #414656).

2007-03-05  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/common/psd.c: De-tabified. Fixed limit checks on resource
	ID's used for path data. Added comments showing decimal value of image
	resource ID's

	* plug-ins/common/psd_save.c: De-tabified. Added support for layer
	modes HARDLIGHT_MODE and SOFTLIGHT_MODE. Added comments showing
	decimal value of image resource ID's

2007-03-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.c (picman_object_get_memsize): don't pass
	random strings to g_print() without running them through %s.
	Fixes crash/warning when the string contains '%'.

2007-03-04  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated

2007-03-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-scale.c: only change the remembered
	last scale value if the last change occured more than a second ago.

	* app/tools/picmanrectangletool.c: fixed compiler warnings.

2007-03-03  Roman Joost  <romanofski@picman.org>

	* authors.xml: added missing, active documentation authors.

2007-03-02  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-serialize.c
	* libpicmanconfig/picmanconfig-error.c
	* libpicmanconfig/picmanconfig-path.c
	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-utils.c
	* libpicmanconfig/picmanconfig-iface.c: corrected copyright notice
	(bug #413731).

2007-03-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-blend.c (picman_drawable_blend): use
	picman_drawable_bytes_with_alpha() instead of manually adding
	alpha to the value returned by picman_drawable_bytes()

2007-03-01 João S. O. Bueno Calligaris <gwidon@mpc.com.br>

        * plug-ins/common/postscript.c: add callback to resolution
	changes in the Postscript load dialog to update the image size
	in pixels. Fixes bug #413347.

2007-03-01  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanmeasuretool.c (picman_measure_tool_cursor_update):
	don't suggest Shift when a new point cannot be added to point 0.

2007-02-28  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanmeasuretool.[ch]: added status bar help messages
	explaining the usage of the modifiers.

	* app/tools/picmanvectortool.c (picman_vector_tool_status_update):
	suggest Ctrl for edit mode, to close the path or move handles.

	* app/tools/picmancroptool.c (picman_crop_tool_button_release):
	"press enter" should be "press Enter", as in the other tools.

2007-02-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmeasuretool.c: made labels selectable.

2007-02-28  João S. O. Bueno Calligaris <gwidion@mpc.com.br>

        * app/tools/picmanrectangletool.c: removes recursive code
	when adjusting rectangle size. Fixes bug #410234.

2007-02-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmantool.c (picman_tool_check_click_distance):
	simplified callers and moved calculations out of the SQR() macro.

2007-02-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleselecttool.c
	(picman_rect_select_tool_rectangle_changed): don't change the
	selection while the tool is active. Fixes bug #398185. Thanks to
	Martin Nordholts for investigating this problem.

	* app/tools/picmanrectangletool.c: minor cleanup.

2007-02-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_check_click_distance): need to
	check the distance in screen coords, not image coords.

	* app/tools/picmanmovetool.c (picman_move_tool_button_release): forgot
	two manual checks for GDK_BUTTON3_MASK.

2007-02-28  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-resize.c: even more whitespace cleanup.

2007-02-28  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-resize.c: removed trailing whitespace.

2007-02-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-scale.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-flip.c: cosmetics.

2007-02-27  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: documentation.

2007-02-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]: clean up last commit a bit. Pass the
	recorded button_press_coords to PicmanTool::button_release() when a
	click was detected.

2007-02-27  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c: increased default value for
	"undo-size" to 64 MB.

	* app/config/picmanguiconfig.c: increased default value for
	'max-new-image-size' to 128 MB.

2007-02-27  Michael Natterer  <mitch@picman.org>

	Improve click behavior of rectangle tools. Addresses bug #410670.

	* app/tools/picmantoolcontrol.[ch]: added "gboolean wants_click"
	member and getters/setters.

	* app/tools/picmantool.[ch] (struct PicmanTool): added members
	in_click_distance, press_coords and press_time.

	(picman_tool_button_press): if the tool wants click events, record
	press_coords and press_time.

	(picman_tool_motion): check if we are still in click distance.

	(picman_tool_button_release): ditto. If we are still in click
	distance, synthesize a motion event back to the recorded
	press_coords and send the tool release_type = CLICK.

	(picman_tool_check_click_distance): utility function which checks
	the current coords and time against the recorded ones, using
	gtk-double-click-time and gtk-double-click-distance as thresholds.

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleselecttool.c: request click events
	and handle them.

	* app/tools/picmanrectangletool.[ch]: handle click events. Removed
	picman_rectangle_tool_no_movement().

2007-02-27  Michael Natterer  <mitch@picman.org>

	Step one towards enabling tool cancellation by other means than
	mouse button 3 and towards proper "clicked" semantics.

	* app/tools/tools-enums.[ch]: added enum PicmanButtonReleaseType
	which can be one of { NORMAL, CANCEL, CLICK } (click is curently
	unused).

	* app/tools/picmantool.[ch] (PicmanTool::button_release): added
	"release_type" parameter.

	(picman_tool_button_release): if the state contains
	GDK_BUTTON3_MASK, call the tool's button_release() with CANCEL,
	use NORMAL otherwise.

	* app/tools/picmanaligntool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolortool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanregionselecttool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c (button_release): added
	"release_type" parameters and get rid of own checks for
	GDK_BUTTON3_MASK.

2007-02-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanblendoptions.c (picman_blend_options_gui): set the
	gradient-type and gradient-repeat combo boxes to ELLIPSIZE_END so
	the blend options can be one tool icon size smaller without
	scrolling horizontally.

2007-02-27  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.c: update the progress less often.

2007-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmansubprogress.[ch]: allow the parent progress to be NULL.
	Documented the API.

	* app/core/picmanimage-scale.c: use the sub-progress unconditionally.

2007-02-27  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmansubprogress.[ch]: added PicmanSubProgress, an object
	that implements the PicmanProgress interface and maps progress
	information to a sub-range of the parent progress.

	* app/core/picmanimage-scale.c (picman_image_scale): use the new object.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (normalize_coords): removed a
	redundant condition and marked another one as unlikely.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-scale.c
	* app/actions/image-commands.c: cosmetics.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_doit): queue
	a redraw of the canvas instead of exposing the transform
	preview. Removes annoying flicker when the tool is finished.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c: moved common code to an
	inlined function. picman_transform_region_lanczos() now also does
	supersampling.  Removed boundary checks and clamping as
	PixelSurround and read_pixel_data_1() already deal with this for
	us. Gives another small speedup.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region_lanczos):
	use PixelSurround instead of read_pixel_data_1(). This yields a
	dramatic speedup.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region_lanczos):
	iterate	over tiles instead of rows in the destination buffer.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region): moved
	linear and cubic code to their own functions and let them iterate
	over tiles instead of rows in the destination buffer.

2007-02-26  Sven Neumann  <sven@picman.org>

	* authors.xml: restored alphabetical order.

2007-02-26  Sven Neumann  <sven@picman.org>

	* Makefile.am: added a dependency for AUTHORS on authors.xsl.

	* authors.xsl: changed to list contributors with their role.

	* AUTHORS: regenerated.

2007-02-26  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/screenshot.c: added checks for X11 Shape
	Extension and build the shaped window feature conditionally.

2007-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c: added more const qualifiers.

2007-02-25  Marco Ciampa  <ciampix@libero.it>

	* authors.xml: added italian contributor

2007-02-24  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region_nearest):
	operate on tiles instead of iterating row by row.

2007-02-24  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region):
	moved nearest-neighbor code to it's own function to improve
	performance and readability.

2007-02-23  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region): moved
	lanczos code into it's own function to improve readability.

2007-02-23  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.[ch]: do less tile lock and release
	operations by reusing the last locked tile if possible. Allow to
	call pixel_surround_lock() several times without unlocking.

	* app/core/picman-transform-region.c: don't unlock the PixelSurround
	so that the locked tile can be reused. Yields about 30% speedup
	for transformations.

2007-02-23  Tor Lillqvist  <tml@novell.com>

	* configure.in: Remove space after the -L in what we add to
	LDFLAGS for DirectInput.

2007-02-23  Tor Lillqvist  <tml@novell.com>

	* plug-ins/common/psd.c: Inspired by mail from a user, improve
	some error messages to be more informative. Use g_message()
	instead of plain printf() in a couple of places in situations that
	probably are commonly encountered. (There are probably still more
	of such printf() calls in the code.) picman_quit() doesn't return,
	not need to do anything else after calling it.

2007-02-23  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c (pixel_surround_lock): code cleanup.

2007-02-23  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.c: allocate the PixelSurround struct and
	its buffer in one chunk.

2007-02-23  Sven Neumann  <sven@picman.org>

	* app/base/base-types.h
	* app/base/pixel-surround.[ch]: hide PixelSurround struct and
	cleaned up the PixelSurround API.

	* app/core/picman-transform-region.c: changed accordingly. Also
	sprinkled some const qualifiers.

2007-02-22  Sven Neumann  <sven@picman.org>

	* app/base/tile.[ch]: made tile_ref_count a static variable and
	added a function to access it.  Declared other (unused) global
	counters as static variables and moved them into #ifdefs.

	* app/base/tile-swap.c: use the function instead of declaring
	tile_ref_count as extern.

	* app/base/tile-manager.c
	* app/base/pixel-surround.c: cosmetics.

2007-02-23  Tor Lillqvist  <tml@novell.com>

	* configure.in: Fix logic error in saving and restoring CPPFLAGS
	for the DirectInput checks.

2007-02-22  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/Makefile.am
	* plug-ins/script-fu/scripts/Makefile.am: stop installing any test
	scripts.

2007-02-22  Sven Neumann  <sven@picman.org>

	* app/dialogs/authors.xsl: use a named template to avoid code
	duplication.

2007-02-22  Tor Lillqvist  <tml@novell.com>

	* modules/picmaninputdevicestore.c: Define
	GET_MODULE_HANDLE_EX_FLAG_FROM_ADDRESS if necessary.

	* configure.in: Add --with-directx-sdk switch instead of relying
	on CPPFLAGS and LDFLAGS. Drop the --without-directinput switch.

2007-02-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am: added an explicit dependency on authors.h.

2007-02-21  Tor Lillqvist  <tml@novell.com>

	* modules/Makefile.am: It's pointless to build
	libcontroller_midi.la on Windows, even if it happens to compile
	and build. There are no MIDI "device files" on Windows. A totally
	specific MIDI API would have to be used.

2007-02-20  DindinX  <dindinx@picman.org>

	* plug-ins/common/gee.c: use our indentation and spacing way.

2007-02-20  Tor Lillqvist  <tml@novell.com>

	* app/widgets/picmancontrollereditor.c
	(picman_controller_editor_sel_changed): Guard against event being
	NULL.

	* modules/controller_dx_dinput.c: New file. Low level
	PicmanController support for DirectInput controllers on Win32.

	* modules/picmaninputdevicestore.c: Add implementation for
	DirectInput devices.

	* modules/Makefile.am: Add libcontroller_dx_dinput.la with above
	source files.

2007-02-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: reworked shape support. Instead of
	fiddling with pixbuf pixels, do most of the work in the core.

2007-02-20  Sven Neumann  <sven@picman.org>

	* app/dialogs/authors.xsl: changed XPath expression to only match
	on contributors that have been active in the 2.4 development cycle.

2007-02-20  Tor Lillqvist  <tml@novell.com>

	* configure.in: Add check for DirectX DirectInput header and
	library. To disable, pass --without-directinput. To find the
	DirectInput headers and libraries, one needs to set CPPFLAGS and
	LDFLAGS env vars appropriately for now. It should really add a
	--with-dx-sdk switch instead. Set HAVE_DX_DINPUT config.h macro
	and HAVE_DX_DINPUT Automake conditional.

2007-02-20  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am: let authors.h depend on authors.xsl.

	* app/dialogs/authors.h: removed from repository, it's generated.

	* app/dialogs/authors.xsl: only include contributors that have
	contributed to PICMAN 2.x. We might want to limit this even further.

2007-02-19  Karine Delvare  <edhel@picman.org>

	* authors.dtd
	* authors.xml: added mandatory last-active attribute, and added
	several 2.4 contributors.

	* AUTHORS
	* app/dialogs/authors.h: regenerated.

2007-02-19  Manish Singh  <yosh@picman.org>

	* modules/picmaninputdevicestore.c: picman_input_device_store_type
	should be set to G_TYPE_NONE in the !HAVE_LIBHAL case.

	* modules/controller_linux_input.c: we can't use
	PICMAN_TYPE_INPUT_DEVICE_STORE in the !HAVE_LIBHAL case.

2007-02-19  Michael Natterer  <mitch@picman.org>

	* modules/picmaninputdevicestore.c: define picman_input_device_store_type
	also for the !HAVE_LIBHAL case.

2007-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: check the return value of
	picman_image_flatten(). Fixes the crash reported in bug #395385.

2007-02-19  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: changed description for
	PICMAN_INTERPOLATION_LANCZOS to "Sinc (Lanczos3)". More correct and
	more in sync with the other terms.

2007-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (atom2str): use
	locale-independent function to convert a float value to a string.

2007-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/neon.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/pix.c
	* plug-ins/common/psd.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/metadata/interface.c
	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-pdb.c
	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/xjt/xjpeg.c
	* plug-ins/xjt/xjt.c: use g_printerr() instead of fprintf().

2007-02-19  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin.c (picman_plug_in_add_temp_proc)
	* app/plug-in/picmanplugindef.c (picman_plug_in_def_add_procedure):
	remove duplicate procedures before adding the new one.

	* app/plug-in/picmanplugin-message.c
	(picman_plug_in_handle_proc_install): don't remove duplicates here.

2007-02-19  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/plug-in/plug-in-def.[ch]: removed...

	* app/plug-in/picmanplugindef.[ch]: ...and added as object. Merged
	locale and help domain setters into one function each.

	* app/plug-in/picmanplugin-message.c
	* app/plug-in/picmanplugin.[ch]
	* app/plug-in/picmanpluginmanager-call.[ch]
	* app/plug-in/picmanpluginmanager-file.c
	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/plug-in-rc.c
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/plug_in_cmds.c: regenerated.

2007-02-18  Michael Natterer  <mitch@picman.org>

	* app/text/picmantext-parasite.c
	* plug-ins/flame/libifs.c: use g_strtod() instead of atof()
	because these files have to parse strings that never had a clearly
	specified format.

	* plug-ins/script-fu/tinyscheme/scheme.c (bug #409091)
	* plug-ins/imagemap/imap_cern.l
	* plug-ins/imagemap/imap_csim.l
	* plug-ins/imagemap/imap_csim.y
	* plug-ins/imagemap/imap_ncsa.l: use g_ascii_strtod() instead of
	atof() because scheme code and imagemap files with wrong decimal
	separators are clearly broken and should be rejected.

	* plug-ins/imagemap/imap_cern_lex.c
	* plug-ins/imagemap/imap_csim_lex.c
	* plug-ins/imagemap/imap_csim_parse.c
	* plug-ins/imagemap/imap_ncsa_lex.c: regenerated.

	* plug-ins/common/sample_colorize.c: round numbers using sane code
	instead of sprintf() and atod().

	* plug-ins/Lighting/lighting_ui.c: removed some dead code.

2007-02-18  Sven Neumann  <sven@picman.org>

	* app/actions/edit-commands.c (edit_copy_cmd_callback): show an
	informational message in the statusbar. There is otherwise no
	indication that something has happened.

2007-02-18  Michael Natterer  <mitch@picman.org>

	* libpicmanthumb/picmanthumbnail.c (picman_thumbnail_set_from_thumb):
	return failure if the thumbnail PNG contains no Thumb::URI tag.

2007-02-18  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginprocedure.[ch]: add "locale_domain" and
	"help_domain" members and APIs to get/set them. Removed locale and
	help domain parameters from all other functions.

	* app/plug-in/picmanplugin.c (picman_plug_in_add_temp_proc)
	* app/plug-in/plug-in-def.c (plug_in_def_add_procedure)
	(plug_in_def_set_locale_domain_name)
	(plug_in_def_set_help_domain_name): make sure all plug-in procedures
	have locale and help domains.

	* app/plug-in/picmanpluginmanager.[ch]: removed function
	picman_plug_in_manager_get_label().

	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/picmanplugin-cleanup.c
	* app/actions/plug-in-actions.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanimagepropview.c: changed (simplified) accordingly.

2007-02-18  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpixbuf.c (picman_pixbuf_targets_add): skip Windows
	ICO as writable format. It's not well suited as a general image
	exchange format and the GdkPixbuf save routine seems to be buggy.

2007-02-18  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/png.c: Moved an invariant (in the last
	  changeset to this file) out of the loop.

2007-02-17  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h: Add define for
	symkey() to quiet the compiler.

	* plug-ins/script-fu/tinyscheme/scheme.c (basic_inchar): Return
	blank when invalid UTF-8 character is encountered while reading
	from memory. Point to start of next valid character on error.

2007-02-17  Michael Natterer  <mitch@picman.org>

	* app/core/picman-utils.[ch]
	* app/core/picman.c
	* app/widgets/picmancontrollerinfo.c
	* libpicmanwidgets/picmancontroller.c: removed various boolean_handled
	signal accumulators and use g_signal_accumulator_true_handled().

2007-02-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: changed hint and button label.

2007-02-16  Mukund Sivaraman <muks@mukund.org>

	* plug-ins/common/png.c: improved handling of incomplete PNG files;
	fixes bug #137327.

2007-02-16  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c: use GTK_STOCK_SAVE as icon
	for the message dialog.

	* app/actions/data-commands.c (data_delete_cmd_callback): improved
	delete dialog.

2007-02-16  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c: let picman_gamma() return 2.2 and document the
	fact that this is a fixed value and that all pixel data is in the
	sRGB colorspace.

	* plug-ins/common/mng.c: removed check for picman_gamma() returning 1.0.

2007-02-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: added a button icon and fixed use of
	gtk_vbox_new().

2007-02-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: added hints to the dialog.

2007-02-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: for shaped windows, add an alpha
	channel and erase pixels outside the shape.

2007-02-14  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c
	* app/plug-in/picmanpluginprocedure.[ch]: added utility function to
	retrieve the translated blurb of a plug-in procedure. Make sure
	that gettext isn't called with the empty string.

2007-02-14  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: when multi-line strings end up
	being passed to the statusbar, only show the first line.

2007-02-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: added CCITT Group 3 and 4 compression
	schemes to TIFF save plug-in. These modes are selectable for
	indexed image with a b/w colormap only. Fixes bug #162119 with the
	help of Manfred Joerg.

2007-02-13  Raphaël Quinet  <raphael@picman.org>

	* modules/picmaninputdevicestore.c (picman_input_device_store_new):
	fix function prototype for when libhal is not available.

2007-02-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: update the progress less often.

2007-02-13  Sven Neumann  <sven@picman.org>

	* modules/picmaninputdevicestore.[ch]
	* modules/controller_linux_input.c: improved error handling.

2007-02-13  Sven Neumann  <sven@picman.org>

	* modules/picmaninputdevicestore.c: keep devices sorted alphabetically.

2007-02-13  Michael Natterer  <mitch@picman.org>

	* modules/picmaninputdevicestore.[ch]: made dynamically loadable
	using GTypeModule.

	* modules/controller_linux_input.c (picman_module_register):
	register the new dynamic type.

2007-02-13  Sven Neumann  <sven@picman.org>

	* modules/controller_linux_input.c (key_events): corrected string
	(bug #407214).

2007-02-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerlist.c (picman_controller_list_edit_clicked):
	don't use button as parent widget, it might be NULL.

2007-02-13  Sven Neumann  <sven@picman.org>

	* modules/picmaninputdevicestore.[ch]: added signals "device-added"
	and "device-removed".

	* modules/controller_linux_input.c: allow to hot-plug the
	configured input device.

2007-02-12  Mukund Sivaraman <muks@mukund.org>

	* plug-ins/imagemap/imap_cmd_guides.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_main.h
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_object.c
	* plug-ins/imagemap/imap_preferences.h
	* plug-ins/imagemap/imap_object.h: Cleaned up some warnings in
	the imagemap plug-in; also fixed many function declarations.

2007-02-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstringcombobox.c: fixed some issues with the
	new widget.

	* modules/controller_linux_input.c: define a property for the
	device store and use the device file as provided by the store.

	* modules/picmaninputdevicestore.c: removed debug output.

2007-02-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstringcombobox.c (picman_string_model_lookup)
	* modules/picmaninputdevicestore.c (picman_input_device_store_lookup):
	fixed wrong use of GValue.

2007-02-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanstringcombobox.[ch]: added PicmanStringComboBox.

	* libpicmanwidgets/picmanpropwidgets.[ch]: added a prop widget
	constructor that uses the new widget.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* app/widgets/picmancontrollereditor.c: use a PicmanStringComboBox if
	the module specifies a tree model with string values.

	* modules/picmaninputdevicestore.c: minor cleanup.

	* modules/controller_linux_input.c: keep a pointer to the input
	device store and unref it in the finalizer.

2007-02-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerlist.c (picman_controller_list_edit_clicked):
	use a PicmanDialog instead of a PicmanViewableDialog.

2007-02-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c
	* libpicmanwidgets/picmanpropwidgets.c: most property widgets rely on
	a writable property. Check for that or make the widget non-editable
	if the G_PARAM_WRITABLE flag is unset.

2007-02-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollereditor.c: minor refactoring.

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_label_new): allow
	this function to be used with properties that are transformable to
	string values, not only with string properties.

2007-02-12  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: set translation domain for the
	registered enum type.

2007-02-12  Sven Neumann  <sven@picman.org>

	* configure.in: lower minimum required version of libhal to 0.5.7.

	* modules/picmaninputdevicestore.c: don't list PC Speaker, even
	though the kernel claims that it would be an input device.

2007-02-11  Sven Neumann  <sven@picman.org>

	* modules/picmaninputdevicestore.c: don't limit the store to
	"input.mouse", list all input devices.

2007-02-11  Sven Neumann  <sven@picman.org>

	* configure.in: check for libhal if Linux Input support is enabled.

	* modules/Makefile.am
	* modules/picmaninputdevicestore.[ch]: added class derived from
	GtkListStore that keeps a list of devices with capability
	"input.mouse".

	* modules/controller_linux_input.c: for now, just instantiate a
	PicmanInputDeviceStore.

2007-02-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontainer.c (picman_container_deserialize): plug leak
	introduced with last commit: simply always use the deserialized
	name, also on ojects already existing in the container.

2007-02-10  Sven Neumann  <sven@picman.org>

	* modules/controller_linux_input.c
	* modules/controller_midi.c: changed license to GPL, updated
	copyright and module info.

2007-02-10  Michael Natterer  <mitch@picman.org>

	Made templates say "ppi" instead of "dpi". Fixes bug #376990:

	* app/core/picman-templates.c
	(picman_templates_migrate_get_child_by_name): find the child also
	if the name differs only in the substrings "dpi" and "ppi".

	* app/core/picmancontainer.c (picman_container_deserialize): if we
	found a child, give it the deserialized name if it isn't the same
	as its old name.

	* etc/templaterc: applied patch from Michael Schumacher that
	replaces "dpi" by "ppi".

2007-02-10  Michael Natterer  <mitch@picman.org>

	* modules/controller_linux_input.c: added some code stolen from
	DirectFB and forgotten on my disk a long time ago which queries
	the input device for available keys and axes (just for debugging
	purposes for now). Also add one more button event and some
	debugging output for incoming events.

2007-02-09  Michael Natterer  <mitch@picman.org>

	* modules/controller_linux_input.c (linux_input_read_event): fix
	last commit a bit...

2007-02-09  Michael Natterer  <mitch@picman.org>

	* modules/controller_linux_input.c (linux_input_read_event): emit
	PICMAN_CONTROLLER_EVENT_VALUE, not TRIGGER for movements on relative
	axes. Reduces the number of events significantly. Now we can start
	thinking what to do with them...

2007-02-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanenvirontable.c: renamed newly added functions to
	picman_environ_table_str_hash() and picman_environ_table_str_equal()
	and always use them. Move the #ifdef G_OS_WIN32 inside the
	functions.

2007-02-09  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanenvirontable.c
	(picman_environ_table_case_insensitive_hash)
	(picman_environ_table_case_insensitive_equal): Win32-only case-
	insensitive hash and equality functions.
	(picman_environ_table_load): On Win32, use the above functions for
	the vars hash table. This fixes the problem that occurs when the
	actual PATH environment variable is spelled Path (as it seems to
	often be), but the default.env file as set up by the installer
	provides PATH. They didn't match so both would be passed to the
	plug-in child process, and apparently which one then was used to
	look for DLLs was more or less random. If it was the original
	Path, it didn't contain the directories the installer put in PATH
	in default.env, and plug-ins didn't find the DLLs.

2007-02-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c: moved ratio entry up.

2007-02-09  Michael Natterer  <mitch@picman.org>

	* app/dialogs/module-dialog.c (dialog_info_init): ellipsize the
	module info labels so they don't make the dialog grow when
	browsing the module list.

2007-02-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: moved duplicated code to
	utility function picman_rectangle_tool_set_highlight().

2007-02-08  Michael Natterer  <mitch@picman.org>

	* app/paint/paint-types.h
	* app/paint/*.h: move opaque typedefs of object instances to
	paint-types.h, don't typedef empty class stuctures as their parent
	class (gtk-doc gets confused), cleanups.

2007-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c
	* app/widgets/picmanpropwidgets.[ch]: moved code around.

2007-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c (picman_rectangle_options_gui):
	code cleanup. Pack the widgets the way we usually do this.

2007-02-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c: applied patch from Robert
	Helgesson. Adds documentation (bug #405760).

2007-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumwidgets.c
	(picman_enum_stock_box_new_with_range): reduced default spacing.

	* app/tools/picmancurvestool.c (picman_curves_tool_dialog): don't
	increase the box's spacing.

	* app/tools/picmanrectangleoptions.c: added portrait/landscape
	buttons.

	* app/widgets/picmanpropwidgets.c (picman_prop_aspect_ratio_new):
	reduced default width of entry.  Swap width and height when the
	aspect changes and fixed-aspect is chosen.

2007-02-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c
	* app/widgets/picmanpropwidgets.[ch]: cleaned out some cruft. Still
	work in progress.

2007-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanratioentry.c (picman_ratio_entry_set_fraction):
	emit property change notifications.

2007-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumwidgets.c
	(picman_enum_stock_box_new_with_range): use GTK_RELIEF_NONE for the
	buttons.

2007-02-08  Sven Neumann  <sven@picman.org>

	* app/widgets/widgets-enums.c
	* libpicmanwidgets/picmanwidgetsenums.[ch]: moved enum PicmanAspectType
	to libpicmanwidgets.

	* libpicmanwidgets/picmanratioentry.[ch]: added property "aspect" with
	getters and setters.

	* libpicmanwidgets/picmanwidgets.def: updated.

2007-02-08  Michael Natterer  <mitch@picman.org>

	Unbreak rectangle select tool undo handling a bit:

	* app/tools/picmanrectangleselecttool.c (picman_rect_select_tool_select):
	add boolean return value indicating if something was actually selected.

	(picman_rect_select_tool_rectangle_changed): peek the newly pushed
	undo only if we selected something.

2007-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanratioentry.[ch]: added history and completion.
	This will need more work.

2007-02-07  Sven Neumann  <sven@picman.org>

	* README: eliminated another redundant article.

2007-02-07  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.[ch]: remove enum PicmanColorPickMode...

	* app/widgets/widgets-enums.[ch]: ...and add it here.

	* app/widgets/picmangradienteditor.c: merge separate functions for
	picking FG and BG colors and update the new color area from the
	merged function.

2007-02-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c
	* app/widgets/picmangrideditor.c: slightly increased the height of
	color buttons.

2007-02-07  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.[ch]: applied patch from Joao
	S. O. Bueno Calligaris which adds a preview for the color the
	cursor is currently hovering and reduces excess precision when
	displaying color components and gradient positions (bug #400907).

2007-02-07  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c: don't compare floating
	point numbers for equality.

2007-02-07  Sven Neumann  <sven@picman.org>

	* app/gui/gui.c: #define DBUS_API_SUBJECT_TO_CHANGE to fix
	compilation with outdated versions of D-Bus.

2007-02-07  Sven Neumann  <sven@picman.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-scale.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/image-menu.xml.in: applied patch from Robert Helgesson that
	adds "Revert Zoom" functionality (bug #338168).

2007-02-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanundo.[ch]: made time a property and added utility
	functions to work the undo's age.

	* app/tools/picmantexttool.c: use the utility functions.

2007-02-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image):
	let the return value indicate whether the file has been saved.
	(file_save_dialog_response): only hide the dialog after the image
	has been saved.

2007-02-05  Sven Neumann  <sven@picman.org>

	* picmanui.pc.in (Requires): require picman-2.0 >= $PICMAN_APP_VERSION.

2007-02-05  Sven Neumann  <sven@picman.org>

	* picman.pc.in (Requires)
	* picmanui.pc.in (Requires): substitute minimum required versions of
	glib and gtk+ instead of hardcoding them.

2007-02-03  Michael Natterer  <mitch@picman.org>

	Remove support for the old undo pop and free cruft:

	* app/core/core-types.h: remove typedefs PicmanUndoPopFunc and
	PicmanUndoFreeFunc.

	* app/core/picmanundo.[ch]: remove members and properties size,
	data, pop_func and free_func.

	* app/core/picmanimage-undo.[ch] (picman_image_undo_push): remove
	parameters size, struct_size, pop_func and free_func.

	* app/core/picmanimage-undo-push.c
	* app/tools/picmantransformtool.c
	* app/paint/picmanink.c
	* app/paint/picmanpaintcore.c: change calls to above function
	accordingly.

2007-02-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanfloatingselundo.[ch]: implement PICMAN_UNDO_FS_TO_LAYER.

	* app/core/picmanimage-undo-push.c: use it. Also changed
	picman_image_undo_push_cantundo() to not pass a pop function to
	picman_image_undo_push().

2007-02-03  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanforegroundselecttool-undo.[ch]
	* app/tools/picmantransformtool-undo.[ch]: removed...

	* app/tools/Makefile.am
	* app/tools/tools-types.h
	* app/tools/picmanforegroundselecttoolundo.[ch]
	* app/tools/picmantransformtoolundo.[ch]: ...and added a proper undo
	classes.

	* app/tools/picmantransformtool.c: push undos using the new class.

2007-02-03  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-undo.[ch]
	* app/paint/picmanink-undo.[ch]: removed...

	* app/paint/Makefile.am
	* app/paint/paint-types.h
	* app/paint/picmanpaintcoreundo.[ch]
	* app/paint/picmaninkundo.[ch]: ...and added as proper undo classes.

	* app/paint/picmanpaintcore.[ch]
	* app/paint/picmanink.c: push undos using the new classes.

2007-02-03  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c: Made fseek() and ftell() use glong
	for offsets instead of gint32

2007-02-02  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]: renamed to app/app.[ch].

	* app/Makefile.am
	* app/main.c: changed accordingly.

2007-02-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mosaic.c (find_gradients): fixed problem pointed
	out in bug #403580.

2007-02-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_toggle_clicked):
	changed function signature according to changes in internal undo API.

2007-02-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimageundo.[ch]
	* app/core/picmanitempropundo.[ch]: implement image and item
	parasite attach and remove undos. They are image/item properties
	after all.

	* app/core/picmanimage-undo-push.[ch]: use them here and move the
	undo functions to the resp. image and item property sections.

2007-02-02  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_file.c
	* plug-ins/metadata/interface.c
	* plug-ins/script-fu/script-fu-console.c: set
	do-overwrite-confirmation on file save dialogs and removed custom
	confirmation dialogs where present.

2007-02-02  Sven Neumann  <sven@picman.org>

	* app/actions/error-console-commands.c
	* app/actions/gradients-commands.c
	* app/actions/text-editor-commands.c
	* app/dialogs/vectors-export-dialog.c
	* app/dialogs/vectors-import-dialog.c
	* app/tools/picmanimagemaptool.c (picman_image_map_tool_settings_dialog):
	set default response and do-overwrite-confirmation on the file
	chooser dialogs. Fixes bug #403449 for all core dialogs.

2007-02-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprogressbox.c: ellipsize progress label.

	* app/widgets/picmanprogressdialog.c: set a fixed width for progress
	dialogs.

	* libpicman/picmanprogressbar.c: ellipsize progress label.

2007-02-01  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.c
	* app/widgets/picmanwidgets-utils.c (picman_get_screen_resolution):
	changed the default monitor resolution to 96 dpi and also use that
	as a fallback value.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c (picman_item_parasite_detach): require "name"
	being non-NULL.

	* app/core/picmanimage-undo-push.c (undo_pop_parasite): removed dead
	code which handled parasites of the Picman itself, don't include
	"picman-parasites.h".

	Require "parasite" and "name" being non-NULL in all public
	parasite undo functions.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanmaskundo.c
	* app/core/picmanitempropundo.c: implement PicmanObject::get_memsize()
	instead of fiddling with undo->size.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.[ch]
	(picman_image_undo_push_fs_to_layer): removed "drawable" parameter
	because it's always the drawable the floating selection is
	attached to.

	* app/core/picmanlayer-floating-sel.c (floating_sel_to_layer):
	changed accordingly.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanfloatingselundo.[ch]: new undo class for
	PICMAN_UNDO_FS_RIGOR and PICMAN_UNDO_FS_RELAX.

	* app/core/picmanimage-undo-push.c: use it here.

	* app/core/picmanimageundo.c
	* app/core/picmandrawableundo.c: implement PicmanObject::get_memsize()
	instead of fiddling with undo->size.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/vectors-types.h
	* app/vectors/picmanvectorsmodundo.[ch]: new undo class for
	PICMAN_UNDO_VECTORS_MOD.

	* app/core/picmanimage-undo-push.c: use it here.

	* app/core/picmandrawablemodundo.h: fix typo in include guard.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmandrawablemodundo.[ch]: new undo class for
	PICMAN_UNDO_DRAWABLE_MOD.

	* app/core/picmanimage-undo-push.c: use it here.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanlayermaskpropundo.[ch]: new undo class for
	PICMAN_UNDO_LAYER_MASK_APPLY and PICMAN_UNDO_LAYER_MASK_SHOW.

	* app/core/picmanimage-undo-push.c: use it here.

2007-01-31  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanchannelundo.[ch]
	* app/core/picmanlayerundo.[ch]
	* app/core/picmanlayermaskundo.[ch]: new undo classes implementing
	channel, layer and layer mask add and remove undos.

	* app/vectors/Makefile.am
	* app/vectors/vectors-types.h
	* app/vectors/picmanvectorsundo.[ch]: vectors add and remove undos.

	* app/core/picmanimage-undo-push.[ch]: use the new undo classes.
	Removed "position" parameter from all "add" functions because
	it's useless.

	* app/core/picmanimage.c: changed accordingly.

2007-01-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): if we can't
	grab the pointer, use the window under the pointer instead of
	bailing out with an error message.

2007-01-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (shoot_dialog): fixed tooltip.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannelundo.[ch]: renamed these files...

	* app/core/picmanmaskundo.[ch]: ...to these. We'll need the name
	PicmanChannelUndo for something else later.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimage-undo-push.c: changed accordingly.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/vectors-types.h
	* app/vectors/picmanvectorspropundo.[ch]: new undo class which
	implements PICMAN_UNDO_VECTORS_REPOSITION.

	* app/core/picmanimage-undo-push.c: use it here.

	* app/Makefile.am: another lame linker hack to make it build with
	the new file that is not used in app/vectors/ itself.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/core/picmanguideundo.c
	* app/core/picmanimageundo.c
	* app/core/picmanlayerpropundo.c
	* app/core/picmansamplepointundo.c
	* app/core/picmandrawableundo.c
	* app/core/picmanitempropundo.c
	* app/core/picmanchannelpropundo.c
	* app/core/picmanchannelundo.c
	* app/core/picmanitemundo.c: chain up last in PicmanUndo::free(), use
	switch() in place of if/else when there is more than one undo type
	implemented in one file, g_assert_not_reached() in default:, some
	minor cleanups.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/text/picmantextundo.[ch]: add support for
	PICMAN_UNDO_TEXT_LAYER_MODIFIED.

	* app/core/picmanimage-undo-push.c: use it here.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanguideundo.[ch]
	* app/core/picmansamplepointundo.[ch]: new classes implementing
	guide and sample point undos.

	* app/core/picmanimage-undo-push.c: use them and remove all guide
	and sample point code.

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmansamplepoint.[ch]: new files implementing new(),
	ref() and unref() and the new PICMAN_TYPE_SAMPLE_POINT boxed type.

	* app/core/picmanimage-sample-points.[ch]: removed ref() and unref()
	functions here.

	* app/core/picmanimage.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo-push.c
	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-draw.c
	* app/tools/picmancolortool.c
	* app/widgets/picmansamplepointeditor.c
	* app/xcf/xcf-save.c: changed accordingly.

	* app/core/picmanimage-rotate.c (picman_image_rotate_sample_points):
	added missing call to picman_image_undo_push_sample_point().

2007-01-30  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]: drop the "image" from
	PICMAN_UNDO_IMAGE_GUIDE, PICMAN_UNDO_IMAGE_SAMPLE_POINT,
	picman_image_undo_push_image_guide() and
	picman_image_undo_push_image_sample_point()

	* app/core/picmanimage-undo.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-sample-points.c
	* app/core/picmanimage-rotate.c
	* app/tools/picmanmeasuretool.c: changed accordingly.

2007-01-29  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]: reordered IMAGE_GRID and
	IMAGE_COLORMAP to be before IMAGE_GUIDE and IMAGE_SAMPLE_POINT.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimageundo.[ch]: add support for IMAGE_GRID and
	IMAGE_COLORMAP undos.

	* app/core/picmanimage-undo-push.c: use PicmanImageUndo for grid and
	colormap undos.

2007-01-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.[ch]: return a PicmanUndo* instead
	of gboolean from all undo_push functions. Simplifies the new
	properly done functions quite a bit.

2007-01-29  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanchannelpropundo.[ch]: new undo class which handles
	CHANNEL_REPOSITION and CHANNEL_COLOR.

	* app/core/picmanimage-undo-push.c: use the new undo class and
	remove the resp. code here.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanlayerpropundo.[ch]: new undo class which handles
	LAYER_REPOSITION, LAYER_MODE, LAYER_OPACITY and LAYER_LOCK_ALPHA.

	* app/core/picmanimage-undo-push.c: use the new undo class and
	remove the resp. code here.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanitempropundo.[ch]: new undo class which handles
	ITEM_RENAME, ITEM_DISPLACE, ITEM_VISIBILITY and ITEM_LINKED undos.

	* app/core/picmanimage-undo-push.c: use the new undo class and
	remove the resp. code here.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanimageundo.[ch]: new undo class which handles
	PICMAN_UNDO_IMAGE_TYPE, PICMAN_UNDO_IMAGE_SIZE and
	PICMAN_UNDO_IMAGE_RESOLUTION.

	* app/core/picmanimage-undo-push.c: use the new undo class and
	remove the resp. code here.

	* app/core/picmanimage-undo.h: changed include guards to not
	conflict with picmanimageundo.h

2007-01-28  Sven Neumann  <sven@picman.org>

	* app/dialogs/authors.xsl: fixed spelling of "auto-generated".

	* app/tools/picmanrectangletool.c: removed unused declaration.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawableundo.c (picman_drawable_undo_constructor):
	add the passed TileManager's size to undo->size.

	* app/core/picmanimage-undo-push.c (picman_image_undo_push_drawable):
	no need to get and pass the TileManager's size here.

2007-01-28  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanchannelundo.[ch]: new PicmanItemUndo subclass which
	handles all the channel undo stuff itself.

	* app/core/picmanimage-undo-push.c: removed all channel undo code
	here and simply create a PicmanChannelUndo instance.

2007-01-26  Tor Lillqvist  <tml@novell.com>

	Fix #398311 in PICMAN until corresponding abstraction has been added
	to GLib:

	* app/base/tile-private.h: Use gint64 instead of off_t. (I assume
	the configury makes sure PICMAN is always compiled as
	large-file-aware on Unix with an off_t of at least 64 bits?)

	Introduce wrapper macros LARGE_SEEK() and LARGE_TRUNCATE(). On
	Win32 LARGE_SEEK() calls _lseeki64() in the Microsoft C library,
	and LARGE_TRUNCATE calls a new internal function
	picman_win32_large_truncate(). On Unix they call lseek() and
	ftruncate().

	* app/base/tile-swap.c: Use gint64 instead of off_t. Use
	LARGE_SEEK() and LARGE_TRUNCATE() instead of lseek() and
	ftruncate().
	(picman_win32_large_truncate): New function. Calls LARGE_SEEK() and
	SetEndOfFile().

	* app/xcf/xcf-load.c (xcf_swap_func): Use LARGE_SEEK() instead of
	lseek().

2007-01-26  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: applied patch from Joao
	S. O. Bueno Calligaris that fixes rectangle resizing (bug #400283).

2007-01-26  Tor Lillqvist  <tml@novell.com>

	Make the handling of console output make more sense Win32. Should
	mostly fix #400927.

	* app/app_procs.c (app_exit): Drop the Win32 "This console window
	will close in ten seconds" message from here.
	(app_run): Drop the call to FreeConsole() from here. PICMAN is built
	as a GUI executable on Windows, and in case we do open a fresh
	console window in main() (see below), we shouldn't then
	immediately close it here.

	* app/errors.c (errors_init): Drop printing the "You can mimize
	this window, but don't close it" message on Win32 from here.

	* app/main.c (picman_open_console_window): New Win32-only
	function. If either stdout or stderr are unconnected, open a new
	console window and connect stdout and/or stderr to it as
	needed. Set the console title to "PICMAN output. You can minimize
	this window, but don't close it." Register an atexit function that
	waits for the user to close the console window.
	(wait_console_window): New Win32-only function. Registered as an
	atexit function when PICMAN has opened a new console window. Prompts
	the user to type any character to close the window.
	(main, picman_show_version): Always call picman_open_console_window()
	in the unstable version. As the "This is a development version of
	PICMAN. Debug messages may appear here" message says, one point of
	the unstable version is that debug messages should be visible, so
	I think it makes sense to always see them in an unstable
	version. In stable versions, call picman_open_console_window() only
	if options that cause output that the user wants to see were
	given, like --help and --version.

2007-01-25  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanplugin.c (picman_plug_in_open): On Win32 prevent
	plug-in from inheriting PICMAN's ends of the pipes. Fixes #363501.

2007-01-24  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/palette-offset.py: applied patch from
	Tim Mooney (bug #400389).

2007-01-24  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: implement keyboard navigation as
	in the spec but without pointer warping. Basically works but needs
	further tuning.

2007-01-24  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: don't emit signals by name if we
	know the signal ID.

2007-01-24  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: reverted previous change.
	Keyboard navigation for the rectangle tools has been speced out
	differently and changes to the spec should be discussed beforehand.

2007-01-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* app/tools/picmanrectangletool.c: Applied patch from Joao S. O. Bueno
	Calligaris that allows size of rectangle selection to be changed via
	the keyboard arrow keys. Ctrl + arrow increases size of selection in
	the direction of the arrow. Ctrl + Shift + arrow decreases size of
	selection.

2007-01-23  Kevin Cozens  <kcozens@cvs.gnome.org>

	* app/actions/context-actions.c
	* app/actions/tools-actions.c: s/minumum/minimum/ typo
	spotted by Joao S. O. Bueno Calligaris.

2007-01-23  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.15.

2007-01-23  Sven Neumann  <sven@picman.org>

	* Made 2.3.14 development release.

2007-01-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c (type_combo_callback): code cleanup.

2007-01-23  Sven Neumann  <sven@picman.org>

	* app/main.c: improved output.

	* docs/picman.1.in
	* docs/picman-remote.1.in: document the new behaviour and
	command-line parameter.

2007-01-23  Sven Neumann  <sven@picman.org>

	* app/widgets/dbus-service.xml: added Activate method.

	* app/widgets/picmandbusservice.[ch]: raise the toolbox from the
	Activate method. Do nothing when no URIs are passed.

	* app/main.c: try the Activate method on the org.picman.PICMAN service
	when being called without any filenames on the command-lines.

2007-01-22  Sven Neumann  <sven@picman.org>

	* app/main.c: simplified handling of d-bus errors.

2007-01-22  Sven Neumann  <sven@picman.org>

	* app/file/file-open.[ch]: added utility function that handles
	opening files passed on the command-line.

	* app/app_procs.c
	* app/widgets/picmandbusservice.c: use the new function instead of
	duplicating the code.

2007-01-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpixbuf.c (picman_pixbuf_from_data): free the thumbnail
	data that used to be leaked for grayscale thumbnails.

2007-01-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmanui.c (picman_ui_init): no need to construct (and leak)
	command-line arguments when initializing GTK+.

2007-01-22  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintbrush.c: added some comments.

	* app/paint/picmanpaintcore.c: sprinkled with const qualifiers.

2007-01-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandatafactoryview.c: don't add the open-as-image
	button to all data factory views.

	* app/widgets/picmanpatternfactoryview.c: but do it here for the
	Pattern dialog.

2007-01-22  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/script-fu/scripts/guides-new-percent.scm: replaced
	license statement according to bug #119667.

2007-01-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.[ch]: maintain an is_drawn boolean which
	indicates whether the drawn stuff is currently visible. Added
	picman_draw_tool_is_drawn() to obtain it.

	* app/tools/picmanbrushtool.c (picman_brush_tool_draw): don't create
	the brush outline segments for the purpose of undrawing (if we
	don't have the segments, we can hardly have drawn them before).
	Fixes artifacts when the brush is being scaled or changed.

	* app/core/picmanbrush.c: don't call brush_scale_mask() and
	brush_scale_pixmap() with zero width or height. Fixes warnings
	from these functions.

2007-01-21  Tor Lillqvist  <tml@novell.com>

	* configure.in: Add AC_MSG_RESULT([no]) to the fail branch of
	PKG_CHECK_MODULES tests to make the output from configure
	cleaner. Add proper quotes around $have_gnomevfs in a test to
	avoid "test: too many arguments" warning. Add fail branch to the
	test for dbus-glib so that it isn't a hard requirement.

2007-01-21  Michael Natterer  <mitch@picman.org>

	* modules/controller_midi.c (midi_set_device): set the name
	of the alsa client to "PICMAN" and the name of the port to
	"PICMAN MIDI Input Controller". Provides reasonable strings in
	apps which display "client::port" as well as in apps which
	display only "port".

2007-01-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: reworded Monitor Resolution
	section as suggested in bug #398851.

2007-01-21  Raphaël Quinet  <raphael@picman.org>

	* app/display/picmanstatusbar.[ch]
	* app/tools/picmantool.[ch]: add optional help text at the end of
	the messages generated by picman_statusbar_push_coords() and
	picman_statusbar_push_length().

	* app/tools/picmancolortool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanrectangletool.c: use the updated functions.

	* app/tools/picmanblendtool.c
	* app/tools/picmancolorpickertool.c: added status bar messages.

2007-01-20  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_control): pop the
	status bar message when the tool is halted.  This fixes a bug that
	was leaving messages in the status bar if the mouse pointer was in
	the image and the user switched to another tool with the keyboard.

2007-01-20  Michael Natterer  <mitch@picman.org>

	Close the display after "Save as" when invoked via the "Close
	Without Saving" dialog. Fixes bug #383700.

	* app/actions/actions-types.h: added enum PicmanSaveMode { SAVE,
	SAVE_AS, SAVE_A_COPY, SAVE_AND_CLOSE }.

	* app/actions/file-actions.c: changed the 4 save actions into
	PicmanEnumActions with above enum as values.

	* app/actions/file-commands.[ch]: merged the save callbacks into
	one and pass a "close_after_saving" boolean to
	file_save_dialog_show().

	* app/widgets/picmanfiledialog.[ch]: added "gboolean
	close_after_saving" parameter to picman_file_dialog_set_image() and
	to the PicmanFileDialog struct.

	* app/dialogs/file-save-dialog.c: if the file was saved
	successfully and close_after_saving is TRUE, close the display if
	the image has not become dirty again in the meantime.

2007-01-20  Sven Neumann  <sven@picman.org>

	* HACKING: removed obsolete paragraph about authorsgen.

2007-01-20  Mukund Sivaraman <muks@mukund.org>

	* configure.in: Lowered required dbus-glib version from 0.71 to
	  0.70 to make it build with stock FC6 (tested to work properly).

2007-01-20  Mukund Sivaraman <muks@mukund.org>

	* autogen.sh
	* README.i18n: Updated with Subversion instructions.

2007-01-20  Mukund Sivaraman <muks@mukund.org>

	* HACKING: Updated with Subversion instructions.

2007-01-19  Sven Neumann  <sven@picman.org>

	* app/main.c: call gdk_notify_startup_complete() when we have
	delegated the work to another PICMAN instance and are about to quit.

2007-01-19  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: check for D-Bus GLib bindings.

	* app/Makefile.am
	* app/main.c: check if an interactive PICMAN instance proposes
	itself on the D-Bus and delegate to it. Allow this behaviour to be
	overridden by using the --new-instance command-line option.

	* app/widgets/Makefile.am
	* app/widgets/picmandbusservice.[ch]
	* app/widgets/dbus-service.xml: added an object that offers a
	D-Bus service.

	* app/gui/Makefile.am
	* app/gui/gui.c: connect to the D-Bus and export the PicmanDBusService.

2007-01-19  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.[ch]: let the filename -> uri functions take
	a Picman parameter instead of the list of load procedures.

	* app/core/picmanimage.c
	* app/app_procs.c
	* app/dialogs/file-open-location-dialog.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c: regenerated.

2007-01-19  Sven Neumann  <sven@picman.org>

	* app/app_procs.c
	* app/file/file-utils.[ch]: moved code from app_procs.c to file-utils.

2007-01-19  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmaniscissorstool.[ch]: Added some status bar messages.
	Use ISCISSORS_OP_CONNECT to let the user know when the cursor is
	above the first point and the user can connect and close the
	curve.  Allow the user to press Enter or Escape to confirm the
	selection or cancel the tool.  Fixes bug #398309.

2007-01-18  Michael Natterer  <mitch@picman.org>

	* app/pdb/color_cmds.c: regenerated.

2007-01-18  Kevin Cozens  <kcozens@cvs.gnome.org>

	* tools/pdbgen/pdb/color.pdb: allow low value to be equal to the high
	value for PDB call to picman-threshold. From a patch by Dave Gowers.
	Fixes bug #397903.

2007-01-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c (bender_type_callback): check data
	before accessing it to avoid crashing while the dialog is being
	constructed. Fixes bug #395798.

2007-01-16  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c (file_open_dialog_show): use the
	toplevel widget as transient parent.

2007-01-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprofilechooserdialog.c: use GTK_RESPONSE_ACCEPT
	to make it work properly with GtkFileChooserButton.

2007-01-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanprofilechooserdialog.c: include *.icm files in
	the filter. Add a shortcut to the systemwide color profile folder.

2007-01-16  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin-message.c (picman_plug_in_handle_proc_run):
	fixed comment.

2007-01-15  Michael Natterer  <mitch@picman.org>

	* app/base/pixel-region.c (pixel_region_set,get_row): add support
	for non-tiled regions.

	* app/paint/picmanperspectiveclone.[ch]: replace handmade
	transformation code by a call to picman_transform_region(). Fix
	getting the original pixels for src_pickable != dest_drawable
	(bug #394610). Various small fixes and cleanups.

2007-01-15  Hans Breuer  <hans@breuer.org>

	* plug-ins/makefile.msc : define YY_NO_UNISTD_H to compile
	imagemap with msvc/win32

2007-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_exif_rotate_query): ellipsize
	the image name displayed below the thumbnail.

2007-01-15  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.[ch]
	* app/actions/file-actions.c
	* menus/image-menu.xml.in: removed "file-open-from-image" action
	and simply use "file-open-image" from both File menus. Makes the
	behavior more predictable and removes unneeded complexity.

2007-01-15  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c (picman_time_since): round up
	to full hours for time periods over two hours.

2007-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c: cleaned up sanity checks and
	handling of undo groups. Fixes bug #395798.

2007-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_csim_lex.c
	* plug-ins/imagemap/imap_ncsa_parse.[ch]
	* plug-ins/imagemap/imap_ncsa_lex.c
	* plug-ins/imagemap/imap_cern_lex.c
	* plug-ins/imagemap/imap_csim_parse.[ch]
	* plug-ins/imagemap/imap_cern_parse.[ch]: regenerated using GNU
	Bison 2.3.  Should fix bug #396261.

2007-01-15  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c: use ngettext() for the
	close dialog. Fixes bug #396513.

2007-01-14  Hans Breuer  <hans@breuer.org>

        * plug-ins/script-fu/tinyscheme/scheme.[ch] : to make it compile with
        msvc redefine stricmp after including <string.h> and protect gccism
        #warning with #ifdef __GNUC__, also some more exports
	* plug-ins/script-fu/scheme-wrapper.c : simple 'extern' does not work
	to get variables across modules boundaries for msvc, use SCHEME_EXPORT
	Together fixes bug #396268

2007-01-13  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated
	* app/display/picmandisplay-handlers.c : #include "file/file-utils.h"
	for file_utils_uri_display_name
	* plug-ins/imagemap/imap_statusbar.c : g_snprintf instead of snprintf

2007-01-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/displace.c
	* plug-ins/common/tileit.c
	* plug-ins/script-fu/scripts/news-text.scm: fixed typos (bug #396169).

2007-01-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmanaspectpreview.c: implement PicmanPreview's transform()
	and untransform() methods.

2007-01-13  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanthumbbox.[ch]: save some string copies by
	changing picman_thumb_box_set_uri() to picman_thumb_box_take_uri().

2007-01-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c: applied patch from Robert Krawitz
	that adds HSL support (bug #395928).

2007-01-12  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmananchor.[ch]: renamed picman_anchor_duplicate()
	to picman_anchor_copy().

	* app/vectors/picmanstroke.c (picman_stroke_real_duplicate): changed
	accordingly.

2007-01-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmandashpattern.[ch]: register PICMAN_TYPE_DASH_PATTERN
	as boxed type. Added "new" to function names which create dash
	patterns. Changed and renamed GValue functions to functions which
	convert the dash pattern between GArray and GValueArray.

	* app/core/picmanstrokeoptions.c
	* app/widgets/picmancellrendererdashes.c
	* app/widgets/picmanstrokeeditor.c: changed accordingly.

	* app/widgets/picmandasheditor.c: ditto. Get rid of the recently
	added manual memory management. The list store manages boxed types
	all by itself.

2007-01-12  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/vectors.pdb: added PDB functions to validate
	display, drawable, image and vectors IDs.

	* app/pdb/image_cmds.c
	* app/pdb/vectors_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/drawable_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmandisplay_pdb.[ch]
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2007-01-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumstore.c: added a construct-only property
	to specify the enum-type.

2007-01-12  Sven Neumann  <sven@picman.org>

	* app/about.h (PICMAN_COPYRIGHT): updated copyright.

	* app/main.c: use application name as summary in the help output.

2007-01-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mail.c: use the base64 encoder from glib.

2007-01-12  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/sanity.c: depend on glib >= 2.12.3.

	* HACKING: updated branches.

	* libpicmanwidgets/picmanintstore.c: added a construct-only property
	that allows to specify the GType of the user-data column.

2007-01-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanstrokeeditor.c: fixed memory management of dash
	patterns (bug #395043).

2007-01-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.[ch]: added transform and untransform
	methods.

	* libpicman/picmanzoompreview.c: more cleanups. Override the new
	PicmanPreview methods.

	* plug-ins/common/nova.c: use the new transform functions.

	* libpicmanwidgets/picmanwidgets.def: updated.

2007-01-11  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.c: code cleanup. Added missing sanity
	checks.

2007-01-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fractaltrace.c: fixed spelling error pointed out
	by Ulf-D. Ehlert (bug #395384).

2007-01-10  Simon Budig  <simon@picman.org>

	* modules/controller_linux_input.c: fix the directions of the
	relative events.

	* plug-ins/common/normalize.c: fix warning about comment starting
	inside a comment. Untabbified.

2007-01-09  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c (picman_remote_find_window): check Atoms
	before using them. Fixes bug #392111.

2007-01-09  Sven Neumann  <sven@picman.org>

	* HACKING
	* tools/pdbgen/lib.pl
	* tools/pdbgen/app.pl: fixed spelling of "auto-generated".

	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/gradient_select.pdb: improved wording and fixed
	spelling errors.

	* libpicman/picman.c: fixed spelling errors.

	* app/pdb/*.h:
	* libpicman/picman*_pdb.[ch]: regenerated.

2007-01-08  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: increased statusbar message timeout
	to 5 seconds.

2007-01-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/difference-clouds.scm: removed wrong
	and useless call to picman-drawable-update.

	* plug-ins/script-fu/scripts/drop-shadow.scm: removed hyphen from
	menu entry and description.

2007-01-08  Marco Ciampa  <ciampix@libero.it>

	* configure.in: Added 'eo' (Esperanto) to ALL_LINGUAS

2007-01-07  Michael Natterer  <mitch@picman.org>

	* modules/controller_linux_input.c (rel_events): add more relative
	events.

2007-01-05  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushselectbutton.c: reverted the change for bug
	#356901 and instead applied a patch from Kyoichiro Suda that's
	actually a better fix and also plugs a memleak (see bug #393158).

2007-01-05  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c (ReadImage): applied patch from Aurimas
	Juška. Use the alpha channel if and only if a bitmap contains at
	least one non-zero value. Fixes bug #352262.

2007-01-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/nova.c: minor code cleanup. Changed mnemonic of
	the menu entry.

2007-01-04  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/script-fu/scripts/old-photo.scm: fixed crash when
	Mottle option is selected (mLayer was incorrectly declared).

2007-01-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreviewarea.c: fixed clipping (bug #392692).

2007-01-04  Tor Lillqvist  <tml@novell.com>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): Add
	workaround for a problem that occurs on Win32 when one has opened
	an image from the root of a drive letter and then does Save As.

2007-01-03  Raphaël Quinet  <raphael@picman.org>

	* libpicmanwidgets/Makefile.am (libpicmanwidgetsinclude_HEADERS):
	install picmanratioentry.h, otherwise it is not possible to build
	any plug-ins including picmanwidgets.h.

2007-01-03  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushselect.c
	* libpicman/picmanprogress.c
	* libpicman/picmangradientselect.c
	* libpicman/picmanfontselect.c
	* libpicman/picmanpatternselect.c
	* libpicman/picmanpaletteselect.c: removed pointless and partly wrong
	information from picman_install_temp_proc() calls.

2007-01-03  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushselectbutton.c (picman_brush_select_button_new):
	initialize opacity, spacing and paint mode as described by the API
	docs. Fixes bug #356901.

2007-01-03  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig.c: fixed blurb.

2007-01-03  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_about.c: make the About dialog transient
	to the main window and close it when the Close button is pressed.

	* plug-ins/imagemap/imap_cmd_guides.c: use a PicmanHintBox.

	* plug-ins/imagemap/imap_menu.c: marked menu labels and tooltips for
	translation.

2007-01-03  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/images/Makefile.am
	* plug-ins/imagemap/images/stock-map-info.png
	* plug-ins/imagemap/imap_stock.[ch]: removed custom info icon.

	* plug-ins/imagemap/imap_menu.c: use GTK_STOCK_INFO instead.

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_default_dialog.c: make dialogs transient
	to the main window and the main window transient to the image window.

2007-01-03  Tor Lillqvist  <tml@novell.com>

	* plug-ins/common/lcms.c (run): Fix mixup in retrieving the
	filename parameter.

2007-01-02  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: fixed order of parameters (pointed out
	by Yoshinori Yamakawa).

2007-01-02  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanratioentry.c: corrected API docs.

2006-12-31  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Don't include malloc.h
	file. Fixes bug #391195.

2006-12-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_synthesize_motion): restore old function and
	push a pause/resume to avoid tool redraws from the motion handler.

2006-12-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpropwidgets.c
	(picman_prop_ratio_entry_notify): compile before you commit :P

2006-12-30  Simon Budig  <simon@picman.org>

	* libpicmanwidgets/picmanratioentry.[ch]: New files implementing a widget
	for entering ratios. Will be improved over time...

	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/Makefile.am: changed accordingly.

	* app/widgets/picmanpropwidgets.c: use it for the crop/rectangle
	select tools.

2006-12-30  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: use a GtkMessageDialog to display errors.

	* plug-ins/print/print-settings.c: use g_warning() for problems
	that shouldn't ever happen.

2006-12-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmanscaletool.c (picman_scale_tool_size_notify): take
	the aspect ratio from the size box when the user activates the
	constraint by pressing the chain button.

2006-12-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformtool.[ch]: store the original aspect ratio.
	Let the Ctrl key toggle the aspect ratio constraint also while the
	mouse is being pressed.

	* app/tools/picmanscaletool.c (picman_scale_tool_motion): use the
	original aspect ratio when applying the constraint.

2006-12-29  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: show print status information.

2006-12-29  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c
	* app/main.c: call g_thread_init() as the very first function in
	main().

2006-12-29  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb: export picman_get_default_unit() to
	the PDB.

	* app/pdb/picmanrc_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanpicmanrc_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print.c: initialize units the same way the core
	Print Size dialog does it.

2006-12-28  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-settings: removed unused settings, bumped
	format version. Store resolution and unit in the image parasite.

	* plug-ins/print/print-page-layout.c: deal gracefully with no
	default page setup.

2006-12-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanunitmenu.c: use the toplevel widget as the
	dialog's parent.

2006-12-28  Sven Neumann  <sven@picman.org>

	* print-draw-page.c: fill rectangles instead of masking the spans.

2006-12-28  Seth Burgess  <sjburges@picman.org>

	* app/widgets/picmandasheditor.h
	* app/widgets/picmanhistogramview.h: fixed improper _GET_CLASS macros

2006-12-28  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c: limit the image size to the
	printable area.

	* plug-ins/print/print-draw-page.c: commented out unused code.

2006-12-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.c: comment.

2006-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print.h: Clarified labels. Removed unused caption
	user interface.  Commented out the UI for the info header; it will
	eventually come back.

2006-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-draw-page.c: paint the background in white.
	Show progress, use a tile cache.

	* plug-ins/print/print.c: removed broken custom preview
	implementation.

2006-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-draw-page.c: draw in spans of tile height.

2006-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print.[ch]: don't set the resolution and unit on
	the image, only initialize the dialog with these values.

2006-12-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_load_save):
	show a message in the statusbar when settings are saved.

2006-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tileit.c: corrected label (bug #389779).

2006-12-26  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print: minor cleanups.

	* plug-ins/print/print-page-layout.c: cleanup up GUI code.

	* plug-ins/print/print-settings.c (check_version): check keyfile
	before accessing it. Cleaned up error handling.

2006-12-25  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print-draw-page.c
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c
	* plug-ins/print/print.c: formatting, minor cleanups, untabified.

2006-12-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.c
	(picman_layer_tree_view_set_context): don't do stuff on NULL mask
	view renderers. Fixes bug #389307.

2006-12-24  Mukund Sivaraman  <muks@mukund.org>

	* app/core/Makefile.am
	* app/core/picman-transform-resize.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable-transform.h
	* app/core/picmandrawable.c
	* app/core/picmanimage-item-list.c
	* app/core/picmanimage-item-list.h
	* app/core/picmanitem-linked.c
	* app/core/picmanitem-linked.h
	* app/core/picmanitem.c
	* app/core/picmanitem.h
	* app/core/picmanlayer.c
	* app/pdb/drawable_transform_cmds.c
	* app/text/picmantextlayer-transform.c
	* app/text/picmantextlayer-transform.h
	* app/tools/picmantransformoptions.c
	* app/tools/picmantransformtool.c
	* app/vectors/picmanvectors.c
	* libpicman/picmandrawabletransform_pdb.c
	* libpicman/picmandrawabletransform_pdb.h
	* libpicman/picmanenums.c.tail
	* libpicmanbase/picmanbase.def
	* libpicmanbase/picmanbaseenums.c
	* libpicmanbase/picmanbaseenums.h
	* tools/pdbgen/enums.pl
	* tools/pdbgen/pdb/drawable_transform.pdb: implemented UI and PDB
	for new clipping modes for affine transforms (crop to largest
	rectangle, and crop to largest rectangle with the source's aspect
	ratio); fixed various bugs in the largest rectangle computation
	code; set padding to 6 in the transformation tool options.

2006-12-22  Sven Neumann  <sven@picman.org>

	* data/tips/picman-tips.xml.in: another tips change (bug #141443).

2006-12-22  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): reverted previous change. The
	viewable description can have multiple lines, it's not suited for
	the window title and statusbar.

2006-12-22  Sven Neumann  <sven@picman.org>

	* data/tips/picman-tips.xml.in: use U+2192 RIGHTWARDS ARROW for menu
	paths.

2006-12-22  Sven Neumann  <sven@picman.org>

	* data/tips/picman-tips.xml.in: applied patch from David Gowers
	(bug #141443).

2006-12-22  Sven Neumann  <sven@picman.org>

	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman-units.c
	* app/widgets/picmancontrollers.c: changed the header that is
	written to config files that are rewritten on exit.

	* app/tools/picmaniscissorstool.c: comment.

2006-12-22  Sven Neumann  <sven@picman.org>

	* app/pdb/misc_cmds.c
	* app/pdb/parasite_cmds.c: changed wording in API docs.

	* app/pdb/misc_cmds.c
	* app/pdb/parasite_cmds.c
	* libpicman/picmanmisc_pdb.c
	* libpicman/picmanparasite_pdb.c: regenerated.

2006-12-22  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c: added a "Don't ask me again" toggle
	to the EXIF rotation query dialog. Store the user's choice in the
	"exif-orientation-rotate" parasite.

	* devel-docs/parasites.txt: document the new global parasite.

2006-12-20  Sven Neumann  <sven@picman.org>

	* configure.in: set variable PICMAN_COMMAND depending on whether
	picman-remote is being built or not.

	* desktop/picman.applications.in (command)
	* desktop/picman.desktop.in.in (Exec): use @PICMAN_COMMAND@. Fixes
	bug #361768.

2006-12-20  Sven Neumann  <sven@picman.org>

	* data/tips/picman-tips.xml.in: changed tip based on a suggestion
	from David Gowers. Corrected menu location of Curves and Levels
	tools.

2006-12-18  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c (edit_actions): changed
	"undo-editor-popup" to "undo-popup". This was forgotten in the fix
	for #345251. Fixes bug #386960.

2006-12-18  Sven Neumann  <sven@picman.org>

	* app/gui/gui.c: cleaned up the code that shows the toolbox when
	the last display is closed.

2006-12-18  Sven Neumann  <sven@picman.org>

	* app/paint/picmanbrushcore.c (picman_brush_core_interpolate): applied
	patch from Aurore D that improves jitter for brushes with an angle
	close to 90° (bug #386061).

2006-12-18  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-icc-profile.[ch]
	* plug-ins/common/lcms.c: removed run-mode argument from
	plug-in-icc-profile-info. Added new procedure to obtain information
	about a color profile on disk.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanprofilechooserdialog.[ch]: added a first draft
	of a file-chooser dialog for selecting a color profile.

	* app/dialogs/preferences-dialog.c: use it.

2006-12-18  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch]
	* libpicmanwidgets/picmanwidgets.def: added new function
	picman_prop_file_chooser_button_new_with_dialog().

2006-12-16  Mukund Sivaraman  <muks@mukund.org>

	* app/core/picman-transform-resize.c: Fixed code in
	picman_transform_resize_crop() to calculate the maximum rectangle in
	the quadrilateral which results after a transform; added a function
	parameter for aspect ratio too.

2006-12-16  Tor Lillqvist  <tml@novell.com>

	* app/core/picmantooloptions.c: On Win32, include picmanwin32-io.h for
	S_IRGRP and friends.

2006-12-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_add_layers): fixed order of
	layers for the position == -1 (add above avtive layer) case.
	Fixes bug #386199.

2006-12-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanuimanager.[ch]: added new function
	picman_ui_manager_activate_action() as a shortcut for looking up the
	action and activating it.

	* app/display/picmandisplayshell-close.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmantooloptionseditor.c: use the new function.

	* app/actions/file-commands.c
	* app/dialogs/file-save-dialog.c: minor code cleanup.

2006-12-14  Michael Natterer  <mitch@picman.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.[ch]: applied modified patch from
	David Gowers which adds brush spacing actions. Fixes bug #385679.

2006-12-14  Michael Natterer  <mitch@picman.org>

	Applied slightly modified patch from David Gowers which abstracts
	away and unifies searching a color in a palette (bug #132146):

	* app/core/picmanpalette.[ch]: added picman_palette_find_entry().

	* app/widgets/picmancolorselectorpalette.c
	* app/widgets/picmanpaletteeditor.c: use it for selecting matching
	colors from the active palette.

2006-12-13  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h
	* plug-ins/script-fu/tinyscheme/scheme.c: Optimizations for string
	comparisons. Time spent in oblist_find_by_name() reduced by ~50%
	during startup by use of stored collation keys. Fixes bug #374854.

2006-12-13  Sven Neumann  <sven@picman.org>

	* app/tools/tools-enums.[ch]: added missing define
	PICMAN_TYPE_RECTANGLE_CONSTRAINT. Removed unused descriptions.

	* app/tools/picmanrectangletool.c: made "constraint" an enum property.

2006-12-13  Øyvind Kolås  <pippin@picman.org>

	* app/core/picmanprojection.h: indentation fix.

2006-12-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c: removed button reliefs to reduce
	visual clutter. Added tooltips to the menu and navigation buttons.

2006-12-12  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/burn-in-anim.scm: Don't allow one of the
	two layers to be a floating selection. Fixes bug #384096.

2006-12-12  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c (edit_actions_update): plugged a tiny
	memleak.

2006-12-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_get_tab_widget): check
	ui_manager before accessing it. Fixes warnings on destruction.

2006-12-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new):
	slightly increased size of the quick-mask and zoom-mode buttons.
	Also changed the style to not displace the icon when the buttons
	are pressed.

	* app/display/picmandisplayshell.[ch]
	* app/display/picmandisplayshell-appearance.c: changed "origin_button"
	to "origin". Don't draw it as a button but use an event box just
	like we do for the navigation icon in the lower right corner.

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): use the viewable description
	for the drawable's name. We don't want to see "Qmask" in the
	statusbar.

	* app/widgets/picmanwidgets-utils.c (picman_button_menu_position): fix
	for the case where button is not really a GtkButton but has it's
	own window.

	* app/widgets/picmanhelp-ids.h: changed help ID, removed unused one.

	* libpicmanwidgets/picmanstock.c
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-quick-mask-off-12.png
	* themes/Default/images/stock-quick-mask-off-16.png
	* themes/Default/images/stock-quick-mask-on-12.png
	* themes/Default/images/stock-quick-mask-on-16.png: cropped empty
	space from the quick-mask icon.

2006-12-12  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: only show the Cancel button while
	we are displaying a cancelable progress. Also removed obsolete
	workaround for a resize problem that doesn't show up any longer.

2006-12-11  Manish Singh  <yosh@picman.org>

	* plug-ins/common/mkgen.pl: GTK_LIBS and GLIB_LIBS should be
	listed before optional libs, to make sure any -L args from pkg-config
	take.

	* plug-ins/common/Makefile.am: regenerated.

2006-12-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-progress.c
	(picman_display_shell_progress_message): info messages go to the
	statusbar, no matter if it's visible or not. We don't want a
	dialog to pop up.

2006-12-11  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c: don't message "Image saved" from here.

	* app/core/picmanimage.[ch]: introduced new signal "saved".

	* app/file/file-save.c (file_save): call picman_image_saved() from here.

	* app/display/picmandisplay-handlers.c: connect to PicmanImage::saved
	and show the "Image saved" message. Makes it show up on all displays
	and regardless of how the file was saved.

	* app/display/picmandisplay.c: fixed typo in comment.

2006-12-11  Sven Neumann  <sven@picman.org>

	* app/actions/file-actions.c
	* app/actions/file-commands.[ch]
	* app/display/picmandisplayshell-close.c: introduced new action
	'file-save-and-close' and moved display deletion there.

2006-12-11  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c (file_open_layers): use the image file's
	basename as layer name if we import only one layer or if
	merge_visible was requested. Use "basename - layer name"
	otherwise. Fixes bug #384472.

2006-12-11  Sven Neumann  <sven@picman.org>

	* app/core/picmantooloptions.[ch]: added API to delete saved
	tool-options.

	* app/tools/picman-tools.c: don't deal with saving presets, just
	load them on startup. Create the tool-options directory when
	saving tool-options.

	* app/core/picmantoolpresets.[ch]: added new signal that is emitted
	whenever the presets changes. Create the tool-options directory
	when saving a preset.

	* app/widgets/picmantooloptionseditor.[ch]: listen to the "changed"
	signal of PicmanToolPresets and queue an idle save.

2006-12-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: reset to factory defaults instead of
	popping up a warning dialog when the user clicks "Load Defaults"
	and hasn't saved default values yet (bug #384673).

2006-12-11  Sven Neumann  <sven@picman.org>

	* app/actions/tool-options-commands.c
	* app/core/picmantoolpresets.[ch]
	* app/tools/picman-tools.c: code cleanup.

2006-12-10  Sven Neumann  <sven@picman.org>

	* app/actions/tool-options-commands.c
	(tool_options_save_new_cmd_callback): pass the toplevel widget as
	parent to picman_query_string_box().

2006-12-10  Sven Neumann  <sven@picman.org>

	* app/core/picmantoolpresets.c: do not create empty presets files.

2006-12-10  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmantoolpresets.[ch]: added PicmanToolPresets, derived
	from PicmanList.

	* app/core/picmantoolinfo.[ch]: use the new type, renamed
	member "options_presets" to "presets".

	* app/actions/tool-options-actions.c
	* app/actions/tool-options-commands.c
	* app/core/picmantooloptions.[ch]
	* app/menus/tool-options-menu.c
	* app/widgets/picmantooloptionseditor.c: changed accordingly.

	* app/tools/picman-tools.c: let the PicmanToolPresets object deal with
	loading and saving the presets from ${picmandir}/tool-options.

	* app/core/picmancontainer-filter.c
	* app/core/picmandocumentlist.c
	* app/core/picmanlist.c
	* app/text/picmanfontlist.c: use canonical property names.

2006-12-10  Sven Neumann  <sven@picman.org>

	* modules/controller_midi.c (midi_set_device): use
	g_get_application_name() for the client name; made the name of the
	ALSA port translatable.

2006-12-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorselectorpalette.[ch]
	* app/widgets/picmancontrollerinfo.[ch]
	* app/widgets/picmancontrollerkeyboard.[ch]
	* app/widgets/picmancontrollerwheel.[ch]: forgot LIBPICMAN -> PICMAN

2006-12-10  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c: also scale the brush's spacing (by
	scaling its x_axis and y_axis). Addresses bug #65030.

2006-12-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushpipe.h: fix whitespace.

2006-12-09  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/add-bevel.scm: Removed duplicate
	variable declaration from let block.

2006-12-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/antialias.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/mng.c
	* plug-ins/common/normalize.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/psd.c
	* plug-ins/common/svg.c
	* plug-ins/common/tga.c
	* plug-ins/twain/twain.c
	* plug-ins/winsnap/winsnap.c: unified copyright notices, got rid of
	"The PICMAN" in a few more places.

2006-12-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorselectorpalette.[ch]
	* app/widgets/picmancontrollerinfo.[ch]
	* app/widgets/picmancontrollerkeyboard.[ch]
	* app/widgets/picmancontrollerwheel.[ch]: license is GPL, not LGPL.

2006-12-09  Sven Neumann  <sven@picman.org>

	* app/gui/gui.c: use "PICMAN" instead of "The PICMAN".

	* app/core/picmanimagefile.c (picman_imagefile_save_thumb): use "PICMAN"
	in the 'Software' tag when writing thumbnails.

	* app/composite/picman-composite.html: removed outdated document.

2006-12-09  Sven Neumann  <sven@picman.org>

	* In all files, changed the standard copyright notice to say
	"PICMAN - The GNU Image Manipulation Program".

2006-12-07  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/re/re.c: Minor changes to quiet the compiler.

	* plug-ins/script-fu/tinyscheme/CHANGES: Updated to version from
	the 1.38 version of TinyScheme.

	* plug-ins/script-fu/tinyscheme/scheme.c: Added some changes from the
	1.38 version of TinyScheme. Added fix for bug #1589701 (reported on
	SourceForge.net).

	* plug-ins/script-fu/tinyscheme/scheme.h: Added a prototype to quiet
	the compiler. Added one change from the 1.38 version of TinyScheme.

2006-12-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c (picman_brush_class_init)
	* app/core/picmanbrushgenerated.c (picman_brush_generated_new): gah,
	should use the right binary for testing. Fixes the new spacing
	property.

2006-12-07  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.c: when creating the user directory,
	create parent directories if they don't exist.

2006-12-07  Sven Neumann  <sven@picman.org>

	* configure.in: require bind_textdomain_codeset(). Fixes bug #362983.

2006-12-07  Sven Neumann  <sven@picman.org>

	* app/tools/picman-tools.c (picman_tools_save): reverted my last change;
	will have to address this differently.

2006-12-06  Sven Neumann  <sven@picman.org>

	* app/tools/picman-tools.c (picman_tools_save): only write a .presets
	file if the presets container is not empty.

2006-12-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/xpm.c: applied patch by Min Sik Kim. Fixes build
	with Quartz GDK backend (bug #382929).

2006-12-06  Michael Natterer  <mitch@picman.org>

	* libpicmanconfig/picmanconfig-utils.c: don't cast the return value of
	g_value_get_object(), it's a gpointer.

2006-12-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c: made "spacing" a property.

	* app/core/picmanbrushgenerated-save.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c: use it. Don't access brush->spacing
	manually, always use accessors.

2006-12-05  Sven Neumann  <sven@picman.org>

	* tools/Makefile.am
	* tools/rmshm: removed this undocumented tool.

2006-12-05  Simon Budig  <simon@picman.org>

	* plug-ins/common/antialias.c: trivial fix for bug #382445

2006-12-04  Sven Neumann  <sven@picman.org>

	* app/tools/picmanperspectiveclonetool.h: removed unused defines.

2006-12-03  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_init): don't
	autoscroll with paint tools.

2006-12-02  Mukund Sivaraman  <muks@mukund.org>

	* devel-docs/debug-plug-ins.txt: added a recipe for debugging
	plug-ins

2006-12-02  Mukund Sivaraman  <muks@mukund.org>

	* configure.in: dropped the required libcurl version to 7.15.1
	* plug-ins/Makefile.am: made uri build on win32 if libcurl is
	detected

2006-12-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/film.c: applied patch from Aurimas Juška. Fixes
	crash when opening layers with offsets and/or smaller than image
	(bug #364429).

2006-11-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c (picman_prop_color_button_new):
	removed obsolete parameter from gtk-doc comment.

2006-11-30  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.def
	* libpicmanbase/picmanbase.def: move around version number symbols
	here too. Fixes bug #380658.

2006-11-28  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.[ch]: removed picman_foo_version variables.

	* libpicmanbase/picmanenv.[ch]: added them here.

	* app/sanity.c: added sanity_check_picman() and abort if the libpicman
	version picman is compiled with is not exactly the same we encounter
	at runtime.

2006-11-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-api.h
	* plug-ins/pypicman/pypicman.h
	* plug-ins/pypicman/picmanmodule.c: export common object types via
	_PyPicman_API, and remove the PDBFunction_Type hack. Also define
	the common object structures here.

	* plug-ins/pypicman/pypicman.h: remove hack for Python < 2.3, since
	we require Python 2.3 now.

	* plug-ins/pypicman/picmanui.override
	* plug-ins/pypicman/picmanui.py: create and use specialized wrappers
	for get/set_active methods for PicmanIntComboBox and derived types.
	Fixes #376102.

2006-11-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: applied patch from Aurimas Juška
	that fixes conversion with dithering of transparency (bug #358851).

2006-11-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c (picman_prop_color_button_new): typo.

2006-11-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c (load_image) (save_image): set the
	warning and error handlers after opening the file. We get two
	errors otherwise.

2006-11-27  Sven Neumann  <sven@picman.org>

	* app/base/color-balance.c (color_balance_transfer_init): applied
	patch from Saul Goode (bug #379611), then cleaned up further.

2006-11-26  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (is_integer): Fix revealed
	bug in TinyScheme initialization which results in a seg fault.
	Removing fix for now.

2006-11-26  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (is_integer): Check cell
	type for T_NUMBER in addition to checking if it is an integer.
	Fixes TinyScheme bug #1593861 reported on SourceForge. Fixed
	prototype for dump_mark_stack(). Quieted compiler warnings.

	* plug-ins/script-fu/scripts/script-fu-compat.init: Added delq,
	prin1, and print.

2006-11-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushclipboard.c
	* app/core/picmanpatternclipboard.c
	* app/core/picmantooloptions.c
	* app/core/picmanundo.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmandock.c
	* app/widgets/picmanimageparasiteview.c
	* app/widgets/picmanimagepropview.c: no need to cast the return
	value of g_value_get_object(), it's a gpointer.

2006-11-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* app/pdb/picmanprocedure.c: Fix for minor typo in error message.

	* plug-ins/Lighting/lighting_main.c (check_drawables): Only validate
	ID's for drawables that will be used. Disable use of env map (and not
	bump map) if env drawable is of wrong type.

	* plug-ins/script-fu/ftx/ftx.c: Eliminated some compiler warnings.

2006-11-25  Simon Budig  <simon@picman.org>

	* libpicmanwidgets/picmanresolutionentry.c
	* libpicmanwidgets/picmanwidgets.def: fix typo in a function name.

	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanpaletteeditor.c
	* app/actions/gradient-editor-actions.c
	* app/actions/palette-editor-actions.c: handle all enum values
	and use sane ones.

	* app/widgets/picmancontrollerinfo.c: fix a warning.

2006-11-24  Simon Budig  <simon@picman.org>

	* app/core/picmandrawable.c
	* app/core/picmanprojection.c: fix the warnings about the interface
	initialization.

2006-11-24  Simon Budig  <simon@picman.org>

	* libpicmanmodule/picmanmodule.[ch]: put the module prototypes into a
	proper place.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_lcms.c
	* modules/cdisplay_proof.c
	* modules/colorsel_cmyk.c
	* modules/colorsel_cmyk_lcms.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c
	* modules/controller_linux_input.c
	* modules/controller_midi.c: reverted.

2006-11-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-compat.init: Fixed cut and
	paste error in the fix for unbreakupstr.

2006-11-24  Simon Budig  <simon@picman.org>

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_lcms.c
	* modules/cdisplay_proof.c
	* modules/colorsel_cmyk.c
	* modules/colorsel_cmyk_lcms.c
	* modules/colorsel_triangle.c
	* modules/colorsel_water.c
	* modules/controller_linux_input.c
	* modules/controller_midi.c: fixed prototype warning, untabbified.

2006-11-24  Simon Budig  <simon@picman.org>

	* plug-ins/sel2path/sel2path_adv_dialog.c
	* plug-ins/xjt/xjt.c: more warning fixes, untabbified.

2006-11-24  Simon Budig  <simon@picman.org>

	Fixing include/declaration issues in the application:

	* app/composite/picman-composite-sse2.c: disable unused debugging code

	* app/paint-funcs/paint-funcs.[ch]
	* app/paint-funcs/scale-funcs.[ch]: fix include files, add some
	prototypes, make some other functions static.

	* app/core/picmanbuffer.c
	* app/core/picmandrawable-preview.c: changed accordingly.

	* app/tools/picmaneditselectiontool.[ch]: untangle .c and .h file.

	* app/widgets/picmanfiledialog.c: add missing #include.

2006-11-24  Tor Lillqvist  <tml@novell.com>

	* libpicman/picman.h (MAIN): Add prototype for WinMain to avoid gcc
	warning.

2006-11-24  Sven Neumann  <sven@picman.org>

	* plug-ins/flame/libifs.[ch]
	* plug-ins/flame/rect.c
	* plug-ins/maze/algorithms.c
	* plug-ins/maze/handy.c
	* plug-ins/maze/maze.h
	* plug-ins/sel2path/fit.c
	* plug-ins/sel2path/pxl-outline.h: fixed prototypes.

2006-11-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-vectors.c: bezier_stroke_new_moveto and
	bezier_stroke_new_ellipse are now class methods of
	VectorsBezierStroke.

	* plug-ins/pypicman/picmanmodule.c: vectors import now has better
	error handling and cleanup. Also stick VectorsBezierStroke in
	the picman namespace so the class is available for constructing.

2006-11-24  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.14.

2006-11-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-compat.init: Added make-list.
	Corrected name of unstrbreakup to unbreakupstr and fixed bug in it.
	Fixed butlast to handle lists with one entry.

2006-11-23  Sven Neumann  <sven@picman.org>

	* Made 2.3.13 development release.

2006-11-23  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff.c: fix warning about uninitialized variable

2006-11-23  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am (test_config_LDADD): reordered to make
	the test link again.

2006-11-23  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/vectors.pdb: minor documentation fixes,
	following the renaming.

	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanpaths_pdb.c
	* libpicman/picmanvectors_pdb.c: regenerated.

2006-11-23  Simon Budig  <simon@picman.org>

	* plug-ins/pypicman/picmanmodule.c: follow the function renaming
	as well. Why didn't this complain when I compiled earlier?

2006-11-23  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/ftx/Makefile.am
	* plug-ins/script-fu/re/Makefile.am
	* plug-ins/script-fu/tinyscheme/Makefile.am: cleaned up Makefiles.
	Fixed for srcdir != builddir.

2006-11-23  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: renamed picman_vectors_new_from_*
	to picman_vectors_import_from_*, as discussed in bug #378394.

	* plug-ins/common/svg.c
	* libpicman/picman.def: changed accordingly.

	* libpicman/picmanvectors_pdb.[ch]
	* app/pdb/vectors_cmds.c: regenerated.

2006-11-23  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h
	* plug-ins/script-fu/tinyscheme/scheme.[ch]: Changed tinyscheme
	to provide a safe spot to protect intermediate values from the
	garbage collector. Fixes some really ugly problems with arrays.

	Most likely not the best solution, we need to discuss this with
	the tinyscheme maintainers.

	* plug-ins/script-fu/scheme-wrapper.c: changed accordingly, plus
	reordering some stuff to protect it from the eager GC.

2006-11-23  Sven Neumann  <sven@picman.org>

	* cursors/Makefile.am (EXTRA_DIST): added xbm/cursor-mouse-mask.xbm.

2006-11-23  Michael Natterer  <mitch@picman.org>

	* plug-ins/help/picmanhelpitem.[ch]
	* plug-ins/help/picmanhelplocale.[ch]: added some EEKy members to
	the structs where the browser can store its state.

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/helpbrowser.c: link against libpicmanhelp.a
	and implement all the help ID mapping ourselves.

	* plug-ins/helpbrowser/dialog.[ch]: added a tree view with the
	help IDs of the current help domain. Double click to jump to an
	item. Very early-stage code and very unusable, please try anyway.

	* app/widgets/picmanhelp.c: if the help browser is available, call
	it directly, not via the help plug-in.

2006-11-23  Sven Neumann  <sven@picman.org>

	* plug-ins/help/Makefile.am (libpicmanhelp_a_SOURCES): removed help.h.

	* Makefile.am (EXTRA_DIST): removed po-*/update.sh.

2006-11-23  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin-cleanup.c: remove useless newlines from
	debugging output.

2006-11-23  Michael Natterer  <mitch@picman.org>

	* plug-ins/help/Makefile.am: link libpicmanhelp as not installed .a

	* plug-ins/help/picmanhelpdomain.[ch] (picman_help_domain_map): return
	the PicmanHelpLocate the ID was found in.

	* plug-ins/help/picman-help-lookup.c
	* plug-ins/help/help.c: changed accordingly.

	* plug-ins/help/picmanhelp.h: disable debug output.

2006-11-23  Simon Budig  <simon@picman.org>

	* app/display/picmancanvas.c: Change the color for XOR drawing. This
	guarantees that there is always a contrast between the original
	image pixels and the stuff drawn on top of it.

2006-11-23  Michael Natterer  <mitch@picman.org>

	* data/images/picman-splash.png: new splash. Image taken by Kristian
	Rietveld; Retouching by Simon Budig and myself.

2006-11-23  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanprocedure.c (picman_procedure_validate_args): made
	validation error messages more human-readable and prepared the
	code for validating return values.

2006-11-23  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanprocedure.c (picman_procedure_validate_args): special
	case invalid drawable and image IDs and try to give a somewhat
	more helpful error message (addresses bug #378334).

2006-11-23  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: marked the new functions as new in 2.4.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-11-22  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/image.pdb: Added functions to easily determine
	the position of a layer/channel/vectors object in its respective
	stack.

	* libpicman/picman.def: added new symbols

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanimage_pdb.[ch]: regenerated.

2006-11-22  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: Enable scrolling while dragging
	the nodes of a path. Fix warning when deleting the last node
	of a stroke.

2006-11-22  Michael Natterer  <mitch@picman.org>

	* app/actions/actions.c (action_select_property): add support for
	G_TYPE_INT properties.

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: add actions and callback which
	affect the foreground select tool's stroke-width property.

	* app/tools/picmanforegroundselecttool.c: map tool-action-value-2
	(tool tip size) to the new action.

	* app/tools/picmanpaintoptions-gui.c: fixed visibility of the brush
	scale slider.

2006-11-22  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.[ch]: applied modified patch from Adrian
	Likins which adds a GRand to the PicmanBrushCore struct and uses it
	instead of using g_random_foo() functions. Fixes bug #377981.

2006-11-22  Sven Neumann  <sven@picman.org>

	* app/gui/gui-message.c (gui_message_error_console): don't raise
	and focus the error console for not so severe error messages. Fixes
	bug #322210 and bug #373254.

	* app/widgets/picmanerrorconsole.c (picman_error_console_init): reduced
	font sizes in error console.

2006-11-22  Simon Budig  <simon@picman.org>

	* app/xcf/xcf-load.c: load the channels in the proper order.
	fixes bug #378003. Thanks to Chris Mohler for spotting this.

2006-11-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanchainbutton.c: code cleanup, seems to fix
	bug #376668.

2006-11-21  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush.pdb (brush_get_pixels): the pixmap's size
	is width * height * bpp, not just width * height.

	* app/pdb/brush_cmds.c: regenerated.

2006-11-21  Simon Budig  <simon@picman.org>

	* plug-ins/metadata/metadata.h: fixed typo spotted by John Marshall
	(bug #377811). Thanks for spotting this.

2006-11-21  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_run_cmd): check argument types before
	assigning them. Allows to use a batch processor processor without
	a run-mode parameter.

2006-11-21  Sven Neumann  <sven@picman.org>

	* etc/templaterc: applied patch from Michael Schumacher that
	replaces 'dpi' with the more correct 'ppi' (bug #376990).

2006-11-20  Michael Natterer  <mitch@picman.org>

	* plug-ins/help/domain.[ch]
	* plug-ins/help/help.h: removed these files...

	* plug-ins/help/picmanhelptypes.h
	* plug-ins/help/picmanhelp.[ch]
	* plug-ins/help/picmanhelpdomain.[ch]
	* plug-ins/help/picmanhelpitem.[ch]
	* plug-ins/help/picmanhelplocale.[ch]: ...completely chopped them
	and added a new private utility library. Soon to be used by the
	helpbrowser too.

	* plug-ins/help/Makefile.am
	* plug-ins/help/picman-help-lookup.c
	* plug-ins/help/help.c: changed accordingly.

2006-11-20  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke.[ch]
	* tools/pdbgen/pdb/vectors.pdb
	* plug-ins/pypicman/pypicman-vectors.c: Applied patch from
	Joao S. O. Bueno Calligaris that adds some missing transformations
	to the PDB-API for strokes. Fixes bug #129598.

	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-11-18  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c (marshall_proc_db_call): Set
	return_val before destroying values[] as it may still be needed.

2006-11-18  Michael Natterer  <mitch@picman.org>

	* etc/gtkrc: remove example about adding a help keybinding
	(bug #375952).

2006-11-18  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-rc.c (plug_in_def_deserialize): applied
	patch from Jernej Simoncic which enables environment variables and
	${picman_foo} variables in plug-in filename and converts them to
	filesystem encoding. Fixes bug #375349.

	(plug_in_rc_write): write UTF-8 filenames to pluginrc.

2006-11-18  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: Properly handle PDB_LAYERs
	and PDB_CHANNELs when passed by the menus in the resp. dialogs

2006-11-17  Michael Natterer  <mitch@picman.org>

	Got rid of the word "editor" were it was good for nothing but
	exposing an implementation detail in public API and installed
	files.  Fixes bug #345251:

	* app/actions/colormap-editor-actions.[ch]
	* app/actions/colormap-editor-commands.[ch]
	* app/actions/sample-point-editor-actions.[ch]
	* app/actions/sample-point-editor-commands.[ch]
	* menus/colormap-editor-menu.xml
	* menus/sample-point-editor-menu.xml
	* menus/selection-editor-menu.xml
	* menus/undo-editor-menu.xml: removed.

	* app/actions/colormap-actions.[ch]
	* app/actions/colormap-commands.[ch]
	* app/actions/sample-points-actions.[ch]
	* app/actions/sample-points-commands.[ch]
	* menus/colormap-menu.xml
	* menus/sample-points-menu.xml
	* menus/selection-menu.xml
	* menus/undo-menu.xml: added.

	* app/actions/Makefile.am
	* menus/Makefile.am
	* app/actions/actions.c
	* app/menus/menus.c
	* app/menus/plug-in-menus.c
	* app/plug-in/picmanpluginprocedure.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmansamplepointeditor.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanundoeditor.c
	* plug-ins/common/colormap-remap.c: changed accordingly.

2006-11-17  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c (file_open_profile_apply_rgb): don't pass
	GRAY images to plug_in_icc_profile_apply_rgb().

2006-11-17  Simon Budig  <simon@picman.org>

	* app/plug-in/picmanpluginprocedure.c: Fix the registration to
	properly test for the parameter types.

2006-11-17  Simon Budig  <simon@picman.org>

	* app/core/picmanparamspecs.c: Hack up picman_value_set_item() to do
	the correct thing for subtypes of PicmanItems.

	* app/actions/plug-in-commands.c: Don't rely on the PicmanValues for
	type checking, pass the param specs to the _collect functions and
	use them for typechecking.

2006-11-17  Michael Natterer  <mitch@picman.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: added actions and callbacks for
	the new paint options brush scale property. Assigned new
	shortcuts: '<' and '>' are now changing tool-value-1 and '[' and
	']' are changing tool-value-2

	* app/actions/context-actions.c: removed the shortcuts from the
	brush size actions.

	* app/tools/picmanbrushtool.c
	* app/tools/picmancolortool.c: set tool-value-2 to brush-scale and
	to color-average-radius, so '[' and ']' always affect the size of
	the tip of the active tool. tool-value-1 is connected to
	context-opacity so that is changeable using '<' and '>' now.

2006-11-17  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.override: override the wrapper for
	picman_int_combo_box_get_active() and let it return the selected
	integer instead of the index in the combo (bug #376102).

2006-11-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/ccanalyze.c: removed file information as this is
	now shown in the "Image Properties" dialog.

2006-11-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (store_string): A minor
	optimization. Don't bother to store normalized string.

2006-11-16  Simon Budig  <simon@picman.org>

	* plug-ins/pypicman/picmanfu.py: added PF_VECTORS type.

	* plug-ins/pypicman/picmanui.py
	* plug-ins/pypicman/picmanui.override: add code for the vectors combo box

	* plug-ins/pypicman/picmanui.defs
	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-api.h: changed accordingly, untabbified.

	* plug-ins/pypicman/pypicman.h: untabbified.

2006-11-16  Michael Natterer  <mitch@picman.org>

	Made all brushes scalable from the tool options. So far only
	downscaling is supported since we lack an algorithm for bitmap
	brush upscaling. Addresses bug #65030.

	* app/paint/picmanpaintoptions.[ch]: added "brush-scale" property.

	* app/paint/picmanbrushcore.[ch]: separate pressure logic from brush
	scaling logic and take paint_options->brush_scale into account.
	Added picman_brush_core_create_bound_segs() which returns BoundSegs
	of the correctly scaled brush mask for the brush preview on the
	canvas.

	* app/tools/picmanbrushtool.c: use picman_brush_core_create_bound_segs()
	instead of doing this here (also removes all knowledge about lowlevel
	stuff from this file). Connect to notify::brush-scale of the
	paint options and invalidate the brush core's brush accordingly.

	* app/tools/picmanpaintoptions-gui.c: added brush scale slider.

2006-11-16  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/script-fu-types.h
	* plug-ins/script-fu/script-fu-scripts.c: add a SF-VECTORS type for
	script-fu.

	* plug-ins/script-fu/script-fu-interface.c: use a vectors
	combobox for the GUI.

	* plug-ins/script-fu/scripts/test-sphere.scm: test it as well.

2006-11-16  Simon Budig  <simon@picman.org>

	* libpicman/picmanui.def: added new symbols.

2006-11-16  Simon Budig  <simon@picman.org>

	* libpicman/picmandrawablecombobox.[ch]: removed...

	* libpicman/picmanitemcombobox.[ch]: and added here. Factored out
	a lot of common code and added a combo box for vectors objects.

	* libpicman/Makefile.am
	* libpicman/picmanui.h
	* libpicman/picmanuitypes.h: changed accordingly.

2006-11-15  Sven Neumann  <sven@picman.org>

	* cursors/Makefile.am
	* cursors/cursor-move.png
	* cursors/picman-tool-cursors.xcf
	* cursors/xbm/cursor-move-mask.xbm
	* cursors/xbm/cursor-move.xbm: added new cursor.

	* app/widgets/picmancursor.c
	* app/widgets/widgets-enums.h: added as PICMAN_CURSOR_MOVE.

	* app/tools/picmanrectangletool.c: use instead of a cursor modifier.

2006-11-15  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanrectangleselecttool.c: removed function from the
	properties. Added getter and setter functions instead. Redraw the
	tool whenever the function changes.

2006-11-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrush.c (picman_brush_real_scale_pixmap): use
	brush_scale_pixmap(), not brush_scale_mask().

2006-11-15  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/FractalExplorer/FractalExplorer.h
	* plug-ins/FractalExplorer/FractalExplorer.c (explorer_render_row):
	Removed 'static' from the routines declaration. Changed routine to
	use a switch instead of a series of if statements.

	* plug-ins/FractalExplorer/Dialogs.c: Removed duplicate code by
	using call to explorer_render_row().

2006-11-15  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff.c: adapt the special casing for libtiff
	warning messages about unknown tags for the apparently newer
	message text.

2006-11-14  Simon Budig  <simon@picman.org>

	* plug-ins/common/tiff.c: Import paths embedded into the
	PHOTOSHOP-tag. Please test!

2006-11-15  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/FractalExplorer/Dialogs.c: Fixed bug #372671 and made
	loglog smoothing work again.

2006-11-14  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/scripts/grid-system.scm: don't register in the
	menus. The script duplicates functionality of the better plugin,
	has a very obscure UI and registers under the same name as the plugin.

2006-11-14  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-open-location-dialog.c: don't use
	picman_dialog_set_sensitive(); just make the entry not editable and
	the dialog's OK button insensitive.

	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanwidgets-utils.[ch]: moved picman_dialog_set_sensitive()
	implementation into picman_file_dialog_set_sensitive().

2006-11-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: reduced the size of the side
	handles to two third the size of the corner handles.

2006-11-13  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf.c (xcf_load_invoker): fix g_str_has_prefix() change
	below. Now we can open XCF files again. Fixes bug #374657.

2006-11-12  Michael Natterer  <mitch@picman.org>

	* app/base/base.c
	* app/core/picman-user-install.c
	* app/core/picmanbrushgenerated-load.c
	* app/core/picmancontainer.c
	* app/core/picmangradient-load.c
	* app/core/picmanpalette-load.c
	* app/core/picmanparamspecs-desc.c
	* app/dialogs/tips-parser.c
	* app/menus/plug-in-menus.c
	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/picmanpluginprocedure.c
	* app/text/picmantext-parasite.c
	* app/tools/picmanforegroundselecttool.c
	* app/widgets/picmanselectiondata.c
	* app/xcf/xcf.c: use g_str_has_prefix() instead of strncmp().

2006-11-11  Michael Natterer  <mitch@picman.org>

	* configure.in: added -Winit-self and -Wpointer-arith to CFLAGS.

2006-11-11  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanselectiontool.c
	(picman_selection_tool_modifier_key): Fix behavior so that when Alt
	is down, it appears as if no other modifier was pressed.
	Fixes bug #349338.

2006-11-09  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c (marshall_proc_db_call): Use
	vectors instead of the non-standard array structure. Also made some
	minor coding style changes in the file.

	* plug-ins/script-fu/tinyscheme/opdefines.h
	* plug-ins/script-fu/tinyscheme/scheme-private.h
	* plug-ins/script-fu/tinyscheme/scheme.h
	* plug-ins/script-fu/tinyscheme/scheme.c: Removed all code related
	to the handling of the non-standard array structure. Added one small
	change to scheme.c to fix problems compiling with MSVC in Windows.

	* plug-ins/script-fu/scripts/script-fu-compat.init: Changed array
	references to use vector references.

2006-11-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/rcm/rcm.c
	* plug-ins/rcm/rcm_misc.c: fix warning about missing declaration
	and did some code shuffling and cleanup.

2006-11-09  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Moved too much. Moved some
	array declarations out of here...

	* plug-ins/script-fu/tinyscheme/scheme-private.h: and back to here.

2006-11-09  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme-private.h: Moved various
	declarations and defines out of here...

	* plug-ins/script-fu/tinyscheme/scheme.c: and added them here in
	keeping with the original 1.38 version of TinyScheme. Only include
	unistd.h if it exists.

	* plug-ins/script-fu/ftx/ftx.c: Only include unistd.h if it exists.

2006-11-09  Michael Natterer  <mitch@picman.org>

	Properly abstract brush scaling:

	* app/core/picmanbrush.[ch]: added virtual functions
	PicmanBrush::scale_mask() and ::scale_pixmap() and default
	implementations which call the functions in base/brush-scale.c.

	* app/core/picmanbrushgenerated.c: factored out brush calculation to
	an internal utility function and call that function from ::dirty()
	and from the new ::scale_mask().

	* app/core/picmanbrushcore.c: use picman_brush_scale_mask/pixmap()
	instead of using the lowlevel scale functions directly. Fixes the
	uglyness that we were scaling generated brushes instead of simply
	recalculating them in the right size.

2006-11-09  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.h: fixed wrong include guard comment.

2006-11-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: don't include <malloc.h>
	Fixes the build on OSX (or maybe BSD in general).

2006-11-09  Sven Neumann  <sven@picman.org>

	* configure.in: added missing quotes in test for libcurl.

	* app/plug-in/picmanpluginprocedure.c
	(picman_plug_in_procedure_add_menu_path): try not to crash on
	invalid menu paths and avoid a string copy for the common case.

	* app/composite/picman-composite-mmx.c: commented out unused code.

2006-11-08  Simon Budig  <simon@picman.org>

	* tools/defcheck.py: don't bail out successfully after the first test,
	don't bail out prematurely on a failed test and actually spot double
	symbols in .def-files if they follow immediately each other...

2006-11-08  Sven Neumann  <sven@picman.org>

	* tools/Makefile.am (EXTRA_DIST): added defcheck.py.

	* tools/defcheck.py: keep a list of .def files, glob didn't work
	for me. Also bail out with a reasonable message if not being
	called from the toplevel source directory.

	* Makefile.am (dist-hook): check .def files for consistency.

2006-11-08  Jakub Steiner <jimmac@ximian.com>

	* stock-tool-foreground-select: update SIOX icon based on feedback
	on the mailing list.

2006-11-08  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/scheme-wrapper.h
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-text-console.c: Removed obsolete
	verbose level code.

	* plug-ins/FractalExplorer/FractalExplorer.c: Added missing default
	value to wvals structure.

2006-11-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: removed dead code.

2006-11-07  Simon Budig  <simon@picman.org>

	* tools/defcheck.py: provide an exit code indicating if the
	check was passed.

2006-11-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_oper_update):
	simplified.

2006-11-07  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanmodule.c: added context_push() and
	context_pop() methods to the picman module.

	* plug-ins/pypicman/plug-ins/sphere.py: use them.

2006-11-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c: undef DEBUG_SPEW again.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw):
	don't draw the handles while the rectangle is being moved.

2006-11-07  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/ts-helloworld.scm: test scripts
	aren't localized, but should still follow the menu guidelines.

2006-11-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch] (picman_draw_tool_draw_corner):
	improved highlighting.
	(picman_draw_tool_draw_arc_by_anchor): take width and height
	arguments instead of radius_x and radius_y.

	* app/tools/picmaniscissorstool.c
	* app/tools/picmanvectortool.c: slightly increased handle sizes.

	* app/tools/picmanmeasuretool.c: increased size of the end points.

	* app/tools/picmanperspectiveclonetool.c: increased handle size.

	* app/tools/picmanrectangletool.c: renamed variables.

	* app/tools/picmansourcetool.c: use a single define for the target size.

	* app/tools/picmantransformtool.[ch]: increased handle size. Made
	the area that can be grabbed identical to the displayed handle.
	Replaced filled circle with a circle outline and a cross.

	* app/tools/picmantransformtool-undo.c: follow renaming of define in
	picmantransformtool.h.

2006-11-07  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.c (file_utils_find_proc): improved error
	reporting.

2006-11-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch] (picman_draw_tool_draw_corner)
	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw):
	highlight the handles on mouse-over.

2006-11-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]: let picman_draw_tool_draw_corner()
	also handle north, south, east and west corners and allow for
	filled corners.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw): simplified.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.[ch]
	* app/tools/picmanrectangletool.c: changed the way that the handles
	are drawn. This is still work in progress.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/xcf-save.c: formatting.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_check_uri): use
	file_utils_uri_display_basename() instead of g_path_get_basename()
	to get an uri's basename.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/file/file-save.c (file_save): only save a thumbnail if we
	are saving as XCF.  Fixes bug #25272.

	* tools/pdbgen/pdb/fileops.pdb: create a libpicman wrapper for the
	"picman-file-save-thumbnail" procedure.

	* app/pdb/fileops_cmds.c
	* libpicman/picmanfileops_pdb.[ch]: regenerated.

	* plug-ins/common/compressor.c (save_image): ask the core to save
	a thumbnail for compressed XCF files.

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): take the additional row/column
	of pixels the grid line takes at the bottom/right side into account.
	Fixes bug #369656.

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.[ch]: made picman_rectangle_tool_halt()
	private. Get rid of some more local variables (use private->foo
	instead). Fixed statusbar rectangle size display. Some indentation
	cleanup.

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleoptions.c
	(picman_rectangle_options_iface_base_init): remove
	PICMAN_CONFIG_PARAM_SERIALIZE from the x0, y0, width, height,
	center-x and center-y properties. Fixes bug #346683.

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]: moved stuff from
	PicmanTool::initialize() to GObject::constructor() and removed all
	initialize functions entirely. initialize() only needs to be
	implemented if the tool has a dialog or if initialization() can
	fail. Also moved some type-checking casts after the
	g_return_if_fail()s

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleselecttool.[ch]: cache the round-corners
	and corner-radius properties in the PicmanRectSelectTool struct,
	connect to "notify" of PicmanRectSelectOptions and update display
	drawing when the options change.

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleoptions.c: whitespace stuff.

2006-11-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tileit.c: applied patch from Saul Goode to fix
	confusion with flip direction (bug #365436).

2006-11-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.[ch]
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanrectangleselecttool.[ch]
	* app/tools/picmanrectangletool.[ch]: removed dispose() and
	finalize() implementations. The finalize() ones did nothing and
	dispose() was only redundantly disconnecting from signals that
	were connected using connect_object() anyway. Some cosmetic
	cleanups all over the place.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/actions/file-actions.c
	* app/actions/file-commands.[ch]
	* menus/image-menu.xml.in: renamed file-open-as-layer to
	file-open-as-layers to complete the changes done to fix bug #358082.

2006-11-05  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-region.c: applied patch from gg that
	removes duplicated code (bug #358481).

2006-11-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c: merged all tool options notify
	callbacks into a single one and added utility function
	picman_rectangle_tool_synthesize_motion() to improve
	maintainability.

2006-11-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion): need
	to subtract the snap_x and snap_y values from the coords before
	calling ourselves recursively, otherwise we run into an infinite
	recursion.

2006-11-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c: removed
	picman_rectangle_tool_get_function() and set_function().

2006-11-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c: pause the draw tool earlier in
	motion() so we don't get artifacts when the function changes.
	Fixed inside_x and inside_y usage in oper_update(). Get rid of
	some local variables in draw().

2006-11-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c: fixed snapping. Replaced lots of
	g_object_get() by simply accessing private->member. Misc small
	cleanups.

2006-11-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_do): moved call to
	picman_item_get_image() out of the loop.

	* app/base/pixel-region.c
	* app/core/picmanitem.c: formatting.

2006-11-03  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: update the configuration dialog when
	then color configuration is changed.

	* plug-ins/common/lcms.c: be even more robust.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancolordialog.c: temporarily attach the context to
	the PicmanColorConfig object while calling the color selector's
	set_config().

	* app/widgets/picmancolorselectorpalette.c: moved widget creation
	and signal connecting to PicmanColorSelector::set_config() and
	use the context attached to the passed PicmanColorConfig object.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanbrushes.c
	* libpicman/picmangradients.c
	* libpicman/picmanimage.c
	* libpicman/picmanlayer.c
	* libpicman/picmanpalette.c
	* libpicman/picmanpalettes.c
	* libpicman/picmanpatterns.c
	* libpicman/picmanselection.c: also let all non-generated deprecated
	functions see their declarations.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added picman_image_add_layers() which
	takes a list of layers and viewport coordinates to center the
	layers in.

	* app/dialogs/file-open-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanlayertreeview.c: use it instead of having the
	same code three times.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorselectorpalette.c
	(picman_color_selector_palette_set_color): select a matching color
	in the palette if possible.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmancolorselectorpalette.[ch]: new widget featuring
	a proof-of-concept palette color selector. It always shows the
	current palette and doesn't bother to have any features yet. If I
	don't get around finishing this I will disable it for the 2.4
	release, but it's better kept in CVS than on my disk...
	Addresses bug #132146.

	* app/widgets/picmancolordialog.c (picman_color_dialog_new): attach
	the passed context to the dialog so the palette selector can find
	it (puke).

	* app/gui/gui.c (gui_restore_callback): register the new object
	with the GType system.

2006-11-03  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch] (enum PicmanUndoType): added value
	PICMAN_UNDO_GROUP_LAYER_ADD.

	* app/file/file-open.[ch]: changed file_open_layer() to
	file_open_layers(), added parameter "gboolean merge_visible",
	return a GList of layers.

	* app/dialogs/file-open-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanlayertreeview.c: pass merge_visible = FALSE and
	add all returned layers to the image. Fixes bug #358082.
	(contains lots of duplicated code, will factor that out later).

	* tools/pdbgen/pdb/fileops.pdb (load_layer): pass merge_visible = TRUE
	(load_layers): new wrapper which returns all the image's layers.

	* app/pdb/fileops_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanfileops_pdb.[ch]: regenerated.

	* libpicman/picman.def: changed accordingly.

2006-11-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: use picman_any_to_utf8().

2006-11-03  Sven Neumann  <sven@picman.org>

	* app/dialogs/fade-dialog.c (fade_dialog_new): use "Fade" instead
	of "OK" in action button, added mnemonics.

2006-11-03  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-properties-dialog.c (image_comment_update)
	* app/text/picmantext-parasite.c (picman_text_from_gdyntext_parasite):
	use picman_any_to_utf8() to deal with invalid UTF-8 strings.

2006-11-03  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimageparasiteview.[ch]: made non-abstract.

	* app/dialogs/image-properties-dialog.c: show a "Comment" tab if
	the image contains a "picman-comment" parasite.

2006-11-03  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimageparasiteview.[ch]: new abstract base class.

	* app/widgets/picmanimageprofileview.[ch]: derive from
	PicmanImageParasiteView.

2006-11-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: pass the number of bytes to
	picman_parasite_new(), not the number of characters.

2006-11-03  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/tinyscheme/scheme.c (utf8_stricmp): use
	g_utf8_casefold() to implement case insensitive sorting.

2006-11-02  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/Makefile.am: Removed USE_STRCASECMP. Use the
	setting for USE_STRLWR that is used in TinyScheme.

	* plug-ins/script-fu/tinyscheme/Makefile.am: Removed USE_STRCASECMP.

	* plug-ins/script-fu/tinyscheme/scheme.c
	* plug-ins/script-fu/tinyscheme/scheme.h: Added missing SCHEME_EXPORT
	to a couple of function declarations. Eliminated USE_STRCASECMP by
	using internal UTF8 string comparison routine.

	* plug-ins/script-fu/tinyscheme/scheme-private.h: Stop some compiler
	warnings.

2006-11-02  Michael Natterer  <mitch@picman.org>

	Don't let each terminating plug-in procedure end its progress,
	because that progress may still be in use by another plug-in.

	* app/plug-in/picmanplugin-progress.[ch]
	(picman_plug_in_progress_attach)
	(picman_plug_in_progress_detach): new functions which maintain
	a simple attach count for a PicmanProgress

	* app/plug-in/picmanplugin-progress.c
	* app/plug-in/picmanpluginprocframe.c: call attach() when setting
	proc_frame->progress. Call detach() in picman_plug_in_progress_end()
	and only call picman_progress_end() if detaching lowered the attach
	count to 0.

2006-11-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/flarefx.c (flare_center_create)
	* plug-ins/common/nova.c (nova_center_create): don't expand the
	coordinates widget horizontally.

	* plug-ins/common/lcms.c: added padding.

2006-11-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): fix rendering for
	n_columns == 1 (bug #369368).

2006-11-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: improved wording.

2006-11-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): fix cell_width calculation
	again so we don't cut off cells. Don't write beyond the buffer's
	size, fixes random crashes.

2006-11-01  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c: Added two missing deprecated
	constants. Updated some comments and removed one obsolete comment.

	* plug-ins/script-fu/scripts/test-sphere.scm: Fixed example of how
	to use named constants in a list by using the 'list' function.

2006-11-01  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: removed frames. Saves a few pixels
	and reduces visual clutter.

2006-11-01  Sven Neumann  <sven@picman.org>

	* app/file/file-open.c: always deal with embedded color profiles.

	* app/dialogs/preferences-dialog.c: reordered items in Color
	Management section, added some spacing.

	* app/config/picmanrc-blurbs.h
	* libpicmanconfig/picmancolorconfig.c
	* plug-ins/common/lcms.c: string changes for consistency.

2006-11-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: redid the dialog without using markup.

2006-11-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): make sure we calculate the
	right number of columns and don't render more cells than columns
	in one row.

2006-11-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: improved dialog.

2006-11-01  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: use "PICMAN", not "the PICMAN".

2006-11-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandataeditor.c
	* app/widgets/picmanpaletteeditor.c: set the editable state, not the
	sensitivity of the entries according to the data's editable state.

2006-11-01  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: string change.

	* app/dialogs/preferences-dialog.c: added a combo box for the
	color-profile-policy.

2006-11-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: in interactive mode, return an extra
	boolean indicating the choice for the "Don't ask me again" toggle.

	* app/plug-in/plug-in-icc-profile.c: look for the extra return
	value and update the "color-profile-policy" in picmanrc.

2006-11-01  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginprocframe.c
	(picman_plug_in_proc_frame_get_return_vals): no need to truncate the
	GValueArray if the plug-in returned too much values, simply return
	all values instead.

2006-10-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am: link lcms with libpicmanui.

	* plug-ins/common/lcms.c: added a confirmation dialog, work in
	progress...

2006-10-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mkgen.pl: add GTK_LIBS if ui is set, otherwise
	add GLIB_LIBS.

	* plug-ins/common/plugin-defs.pl: no need to define libdep any
	longer.

	* plug-ins/common/Makefile.am: regenerated. Identical except for
	two plug-ins that incorrectly linked with libpicmanui.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* configure.in: add -Wmissing-declarations and -Wmissing-prototypes
	to CFLAGS if the compiler supports them. Still warns in some files
	but most stuff compiles cleanly after all the cleanups below.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: declare all register_foo_procs() functions
	in internal_procs.h instead of internal_procs.c and include
	internal_procs.h from all foo_cmds.c files.

	* app/pdb/*_cmds.c
	* app/pdb/internal_procs.[ch]: regenerated.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/lib.pl: if a generated file in libpicman contains
	deprecated procedures, #undef PICMAN_DISABLE_DEPRECATED and include
	its header explicitly, to make sure all deprecated procedures are
	declared properly. Removed $privatevars cruft.

	* libpicman/picmanbrushes_pdb.c
	* libpicman/picmancolor_pdb.c
	* libpicman/picmandrawable_pdb.c
	* libpicman/picmangradients_pdb.c
	* libpicman/picmanpalettes_pdb.c
	* libpicman/picmanpaths_pdb.c
	* libpicman/picmanpatterns_pdb.c
	* libpicman/picmantexttool_pdb.c
	* libpicman/picmantransformtools_pdb.c: regenerated.

2006-10-31  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/py-slice.py: string fixes.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/gradient.pdb: made private functions static.

	* app/pdb/gradient_cmds.c: regenerated.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* plug-ins/faxg3/Makefile.am
	* plug-ins/faxg3/run_tbl.c: removed this file. Apparently it
	was never needed.

2006-10-31  Simon Budig  <simon@picman.org>

	* tools/defcheck.py: hack to check the consistency of the .def files
	for the libraries. Invoke after building PICMAN, needs "nm" to work.

	* libpicmanwidgets/picmanwidgets.def: removed obsolete symbol.

2006-10-31  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c: made
	picman_display_shell_ruler_button_press() static.

2006-10-31  Simon Budig  <simon@picman.org>

	* libpicman/picman.def: Added missing picman-version symbols.

	* tools/pdbgen/pdb/vectors.pdb: force the libpicman-API to return
	success values for the picman_vectors_new_from_*  functions.

	* libpicman/picmanvectors_pdb.[ch]: regenerated

	* plug-ins/pypicman/picmanmodule.c: changed accordingly, untabbified.

	* plug-ins/common/svg.c: Don't use deprecated API, untabbified.

2006-10-30  Michael Natterer  <mitch@picman.org>

	* plug-ins/Lighting/lighting_apply.c
	* plug-ins/Lighting/lighting_preview.c
	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/libifs.c
	* plug-ins/gfig/gfig-arc.c
	* plug-ins/gfig/gfig-bezier.c
	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-line.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-spiral.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/picmanressionist/general.c
	* plug-ins/picmanressionist/ppmtool.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/picmanressionist/preview.h
	* plug-ins/picmanressionist/size.h
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/uri/uri-backend-gnomevfs.c
	* plug-ins/uri/uri-backend-libcurl.c
	* plug-ins/uri/uri-backend-wget.c
	* plug-ins/winicon/icoload.c
	* plug-ins/winicon/icosave.c: another bunch of missing includes,
	missing "static" and wrong declarations found by -Wmissing-foo

2006-10-30  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-text-console.c: include our own
	header file. Minor cosmetics.

2006-10-30  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c: changed default for
	"interpolation-type" to Cubic (bug #367532).

2006-10-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansessioninfo.c (picman_session_info_save):
	eliminate compiler warning.

2006-10-30  Michael Natterer  <mitch@picman.org>

	* app/actions/brush-editor-actions.c
	* app/base/tile-manager-crop.c
	* app/config/picmanconfig-file.c
	* app/core/picman-gradients.c
	* app/core/picmandrawable-histogram.c
	* app/core/picmanimage-colorhash.c
	* app/core/picmanimage-undo-push.c
	* app/dialogs/convert-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/display/picmandisplayshell-callbacks.c
	* app/gui/gui-vtable.c
	* app/paint/picmanheal.c
	* app/paint/picmanpaintcore-undo.c
	* app/plug-in/plug-in-enums.h
	* app/vectors/picmanstroke-new.c
	* app/vectors/picmanvectors-warp.c
	* app/widgets/picmanviewablebox.c
	* app/widgets/picmanviewrenderer-frame.c
	* app/widgets/picmanviewrenderer-utils.c
	* app/xcf/xcf-save.c
	* libpicmanwidgets/picmancontroller.c: all .c files should include
	their headers and all private functions should be static.
	(-Wmissing-declarations -Wmissing-prototypes rocks!)

2006-10-29  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-actions.c (plug_in_repeat_actions): use the
	"value" field for the PicmanRunMode, it used to be "0" to reference
	the first plug-in in the history.

	* app/actions/plug-in-commands.[ch] (plug_in_repeat_cmd_callback):
	always pick the first item from the history and use the passed
	value as PicmanRunMode instead of determining it from the action's
	name.

2006-10-29  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-actions.c: use PicmanPlugInActions instead of
	PicmanEnumActions so the menu items show any kind of icons (not only
	stock-id icons). Now if any plug-in that shows up in the history
	registered non-stock-id icons, this change would be actually
	useful ;) Fixes bug #338525.

	* app/actions/plug-in-commands.[ch] (plug_in_history_cmd_callback):
	new callback for the history, much simpler than
	plug_in_repeat_cmd_callback().

2006-10-29  Michael Natterer  <mitch@picman.org>

	* modules/colorsel_cmyk_lcms.c: added hackish flag to prevent it
	from emitting signals during destruction.

2006-10-29  Michael Natterer  <mitch@picman.org>

	* app/config/picmanrc.[ch]: added picman_rc_migrate() which resets
	all PicmanParamConfigPath properties to default values.

	* app/core/picman-user-install.c (user_install_migrate_files): use
	the function. Fixes bug #332620.

2006-10-29  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-icc-profile.c
	* plug-ins/common/lcms.c: the plug-in doesn't handle GRAY* images.

2006-10-29  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanpdb-query.c (picman_pdb_print_entry): use
	picman_pdb_get_strings() so we dump the right blurb and help for
	deprecated procedures.

2006-10-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/picmancons.py: refactored, some UI polish.

	* plug-ins/pypicman/plug-ins/colorxhtml.py
	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/palette-offset.py
	* plug-ins/pypicman/plug-ins/palette-sort.py
	* plug-ins/pypicman/plug-ins/palette-to-gradient.py
	* plug-ins/pypicman/plug-ins/py-slice.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py: use booleans instead
	of numbers for readability in gettext.install calls.

2006-10-28  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/paste-as-brush.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: Some variables
	were not being declared before first use. Spotted by Saul Goode.

2006-10-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/picmancons.py: can't use gettext.install
	here because sys.displayhook fills __builtins__._ too and it'd
	be best to maintain that behavior.

2006-10-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/picmancons.py: "Apply" output from the
	procedure browser windows now replaces the current line, to maintain
	semantics of the old console.

2006-10-28  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanpdb-query.c: include deprecated procedures in the
	output of picman-pdb-dump. Added #define DEBUG_OUTPUT which allows
	to dump to a format that works as input for "diff" and allows to
	easily compare two picman version's PDB API.

2006-10-28  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-utils.[ch]
	(picman_transform_matrix_flip_free): removed unused x,y,width,height
	parameters.

	* tools/pdbgen/pdb/drawable_transform.pdb: changed accordingly.

	* app/pdb/drawable_transform_cmds.c: regenerated.

2006-10-27  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmandata.c (picman_data_class_init): fix typo
	in property construction code.

2006-10-27  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated

2006-10-27  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig-enums.[ch]
	* libpicmanconfig/picmancolorconfig.c
	* libpicmanconfig/picmanconfig.def: removed unused enum
	PicmanColorFileOpenBehaviour.

	* app/core/core-enums.[ch]: added enum PicmanColorProfilePolicy.

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: added property "color-profile-policy".

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-icc-profile.[ch]: new files that wrap usage
	of the lcms plug-in.

	* app/file/file-open.c: implement the user-configured policy for
	embedded color profiles.

	* app/widgets/picmanimageprofileview.c: use the wrapper to call the
	plug-in-icc-profile-info procedure.

	* app/widgets/picmantoolbox-dnd.c: pass TRUE for "attach_comment"
	parameter to picman_create_image().

	* app/core/picmantemplate.c
	* app/file/Makefile.am: cosmetic changes.

	* app/Makefile.am: some resorting to make the beast link again.

2006-10-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: don't hardcode font sizes,
	moved newlines out of translatable strings.

2006-10-27  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin-message.c (picman_plug_in_handle_proc_run):
	don't send a return value if executing the procedure closed the
	plug-in (as is the case with picman-quit). Fixes bug #332608.

2006-10-27  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am: reverted changes from 2006-04-06
	and build screenshot plug-in optionally again. Fixes bug #364852.

	* plug-ins/common/mkgen.pl: reverted addition of 'extralibs'
	parameter that was introduced for the screenshot plug-in only.

2006-10-27  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region):
	prefix parameters x1, y1, x2, y2 with "dest_".

	* app/core/picmandrawable-combine.c
	(picman_drawable_real_replace_region): cosmetic.

2006-10-27  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-vectors.c: wrap
	picman_vectors_stroke_new_from_points in the form of a
	VectorsBezierStroke constructor.

	* plug-ins/pypicman/picmanmodule.c: wrap picman_vectors_new_from_file
	and picman_vectors_new_from_string.

	* plug-ins/pypicman/pypicman-pdb.c: PDB_VECTORS should be translated
	into Vectors objects.

2006-10-26  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-compat.init: Return empty
	string if sep is at end of string in strbreakup.

2006-10-26  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/script-fu-compat.init: Added strbreakup,
	strcat, strcmp, string-trim, string-trim-left, string-trim-right, and
	unstrbreakup.

2006-10-26  Jakub Steiner <jimmac@ximian.com>

	* stock-display-filter-proof:
	* stock-controller-keyboard:
	* stock-controller-linux-input: ruin more of Michael's artwork

2006-10-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/paths.pdb: use canonical procedure names.

	* app/pdb/paths_cmds.c: regenerated.

2006-10-26  Simon Budig  <simon@picman.org>

	* app/vectors/picmanstroke-new.h: New header file for the
	PicmanStroke factory.

	* app/vectors/Makefile.am
	* app/vectors/picmanstroke.h: changed accordingly.
	* tools/pdbgen/pdb/vectors.pdb: changed accordingly plus a bugfix.

	* app/pdb/vectors_cmds.c: regenerated.

2006-10-26  Simon Budig  <simon@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/picmanstroke.h
	* app/vectors/picmanstroke-new.c: new factory for PicmanStrokes.

	* tools/pdbgen/pdb/vectors.pdb: use it for
	picman_vectors_stroke_new_from_points()

	* libpicman/picman.def: added new symbol

	* tools/pdbgen/pdb/paths.pdb: deprecated completely! Yay!

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanpaths_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-10-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimageprofileview.[ch]: update the profile
	information from an idle handler.

	* plug-ins/common/lcms.c: bug fixes and robustness.

2006-10-26  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-region.c (picman_transform_region): make
	lanczos work for orig_tiles that don't start at 0,0. Please folks,
	some basic testing of anything but the most simple use case next
	time.

2006-10-26  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picman-transform-region.[ch]: new files containing
	picman_transform_region() and all its voodoo utility functions.

	* app/core/picmandrawable-transform.c: removed the stuff here.

2006-10-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_affine): factored out new function
	picman_transform_region() that contains all the actual transform
	magic, doesn't use a PicmanDrawable, and transforms into a passed
	PixelRegion. Will be used for perspective clone after some more
	changes.

2006-10-26  Mukund Sivaraman  <muks@mukund.org>

	* configure.in: Removed spaces from enable_python assignment

2006-10-26  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/edit.pdb: added picman_edit_stroke_vectors ()
	* tools/pdbgen/pdb/paths.pdb: deprecated picman_path_stroke_current ()

	* libpicman/picman.def: updated.

	* app/pdb/edit_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanedit_pdb.[ch]
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

2006-10-26  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]
	(picman_image_transform_rgb)
	(picman_image_transform_color)
	(picman_image_transform_temp_buf): changed PicmanDrawable parameter to
	"PicmanImageType dest_type".

	(picman_image_get_foreground)
	(picman_image_get_background): ditto and reordered parameters.

	* app/core/picman-edit.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-merge.c
	* app/core/picmanlayer.c
	* app/core/picmanselection.c
	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmaneraser.c
	* app/paint/picmanheal.c
	* app/paint/picmanink.c
	* app/paint/picmanpaintbrush.c: changed accordingly.

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_affine): set the progress to 1.0
	when done, some tiny cleanups around lanczos.

2006-10-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable-transform.c
	(picman_drawable_transform_tiles_affine): fix indentation and
	spacing in the lanczos code. Removed trailing whitespace.

2006-10-25  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/paths.pdb: removed picman-paths-import-string, it
	didn't exist in 2.2 and therefore doesn't need to be deprecated.

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

	* libpicman/picman.def: changed accordingly.

2006-10-25  Simon Budig  <simon@picman.org>

	* app/vectors/vectors-enums.h: Oops. Need to specify both
	pdb-skip and skip.

	* libpicman/picman.def
	* libpicmanconfig/picmanconfig.def
	* libpicmanmath/picmanmath.def
	* libpicmanthumb/picmanthumb.def
	* libpicmanwidgets/picmanwidgets.def: .def-file maintenance. Hope my
	changes are correct...

	With the help from
	   nm .libs/libpicmanfoo-2.0.so |\
	   sed -ne "s/.* T \([a-zA-Z0-9][a-zA-Z0-9_]*\)/\t\1/p" |\
	   (echo EXPORTS ; LC_ALL=C sort )

	* libpicmanwidgets/picmanpageselector.c: marked stretch_frame_image()
	as static.

	* libpicman/picmanenums.c.tail
	* libpicman/picmanenums.h
	* tools/pdbgen/enums.pl: regenerated.

2006-10-25  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-import.[ch]: extended picman_vectors_import()
	and friends with a parameter for returning the newly generated vectors.

	* app/actions/edit-commands.c
	* app/actions/vectors-commands.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanvectorstreeview.c: Changed accordingly.

	* app/vectors/vectors-enums.h: moved the PicmanVectorsStrokeType to...
	* libpicmanbase/picmanbaseenums.h: ... this file.

	* app/vectors/Makefile.am: Changed accordingly
	* app/vectors/vectors-enums.c: removed accordingly.

	* tools/pdbgen/pdb/vectors.pdb: new functions
	picman_vectors_new_from_file() and picman_vectors_new_from_string().

	* tools/pdbgen/pdb/paths.pdb: deprecated the previous functions.

	* libpicmanbase/picmanbase.def
	* libpicman/picman.def: added new symbols

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* app/vectors/vectors-enums.c
	* libpicman/picmanenums.h
	* tools/pdbgen/enums.pl
	* libpicman/picmanpaths_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]
	* libpicmanbase/picmanbaseenums.c

2006-10-25  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/difference-clouds.scm: added new script
	"Difference Clouds" written by Martin Nordholts (bug #363458).

2006-10-25  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/erase-rows.scm
	* plug-ins/script-fu/scripts/hsv-graph.scm: don't ever use the term
	"drawable" in user-visible strings.

2006-10-25  Michael Natterer  <mitch@picman.org>

	Added mechanism that should prevent undo corruption by
	broken plug-ins and scripts. Work in progress.

	* app/plug-in/Makefile.am
	* app/plug-in/picmanplugin-cleanup.[ch]: new files that (for now)
	keep track of the undo groups plug-in procedures open and close,
	and can fix an image's undo group state after a plug-in messed.

	* app/plug-in/picmanpluginprocframe.h (struct PicmanPlugInProcFrame):
	keep a list of plug-in cleanup structs.

	* app/plug-in/picmanpluginprocframe.c
	(picman_plug_in_proc_frame_dispose): call picman_plug_in_cleanup() if
	the list is not empty.

	* tools/pdbgen/pdb/undo.pdb: keep track of undo groups using
	the new picman_plug_in_cleanup_undo_group_start() and _end()
	functions. Fail if any of the functions returns FALSE.

	* app/pdb/undo_cmds.c: regenerated.

2006-10-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: added signals "parasite-attached" and
	"parasite-detached".

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimageprofileview.[ch]: draft of a new widget that
	displays color profile information.

	* app/widgets/picmanimagepropview.c: minor cleanup and bug fix.

	* app/dialogs/image-properties-dialog.c: added Color Profile
	information.

	* plug-ins/common/lcms.c: bug fixes.

2006-10-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-vectors.c: remove_stroke is now a Vectors
	object method. Also implement, get_ID, get_vectors_ID, and get_points
	for VectorsStroke.

2006-10-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c (marshall_proc_db_call):
	Break out of for loop before i gets updated when error was detected
	to make sure error message reports correct parameter number.
	Reworded two error messages.

2006-10-24  Simon Budig  <simon@picman.org>

	* app/vectors/Makefile.am
	* app/vectors/vectors-enums.h
	* app/vectors/vectors-types.h: added new file for the vectors enums,
	adjusted Makefile.am for the generation of vectors-enums.c

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/vectors.pdb: Added implementation for
	picman-vectors-stroke-get-points which returns the control points for
	the stroke.
	Renamed picman-vectors-stroke-remove to picman-vectors-remove-stroke.

	ATTENTION: this breaks scripts using this function, a simple name
	change is enough to make it work again.
	Also please note that yosh reordered the return values of
	picman-vectors-stroke-interpolate, so your scripts need adjustment
	there as well.

        * tools/pdbgen/pdb/paths.pdb: deprecate picman-path-get-points. Yay!

	* libpicman/picman.def: added new symbol

	* plug-ins/pypicman/pypicman-vectors.c: reflect name change of
	picman_vectors_remove_stroke ().

	* app/vectors/vectors-enums.c
	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanenums.c.tail
	* libpicman/picmanenums.h
	* libpicman/picmanpaths_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]
	* tools/pdbgen/enums.pl: regenerated.

2006-10-24  Michael Natterer  <mitch@picman.org>

	* tools/picman-mkenums (parse_trigraph): quote "true" to fix warning
	about reserved word.

2006-10-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-vectors.c: Vector object wrapper API.

	* plug-ins/pypicman/Makefile.am: add above file.

	* plug-ins/pypicman/picmanshelf.py
	* plug-ins/pypicman/pypicman.h
	* plug-ins/pypicman/picmanmodule.c: hook the new objects in.

	* plug-ins/pypicman/pypicman-image.c: get_vectors accessor.

2006-10-24  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: fix spelling of "precision", and
	tweak some outargs around to the libpicman api is a bit friendlier.

	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-10-24  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrotatetool.c (picman_rotate_tool_dialog): show two
	decimal digits when editing "Pixels" in the "Center" size entry.
	Addresses bug #363775.

2006-10-23  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	if plug_in_rc_parse() returns an empty list it's not neccessarily
	an eror, so check the "error" variable before accessing it.
	Fixes bug #363345.

2006-10-23  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am
	* plug-ins/common/antialias.c: added "Auntie Alias" by Adam
	D. Moss, a plug-in which does nice antialiasing on lineart using
	the Scale3X edge-extrapolation algorithm.

2006-10-23  Michael Natterer  <mitch@picman.org>

	* app/pdb/picman-pdb-compat.c (picman_pdb_compat_procs_register):
	it's picman-layer-set,get-lock-alpha, not picman-drawable.

2006-10-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: removed some fields from the icc-info
	return values.  Changed image-type to "*" for all procedures.

2006-10-23  Michael Natterer  <mitch@picman.org>

	* app/base/base-enums.c: forgot to commit the latest version of
	this file (only a typo fix).

2006-10-23  Sven Neumann  <sven@picman.org>

	* configure.in: use LIBLCMS instead of LCMS_LIBS.

	* modules/Makefile.am: changed accordingly.

	* plug-ins/common/mkgen.pl: link plug-ins with the same libraries
	and in the same order as defined in the picman.pc and picmanui.pc files.

	* plug-ins/common/Makefile.am: regenerated.

	* plug-ins/common/lcms.c: implemented missing functionality.

2006-10-23  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/unsharp-mask.scm: reverted Kevin's
	change. This script should not register a menu entry and it
	doesn't need to be translated. It only exists for backward
	compatibility.

2006-10-23  Kevin Cozens  <kcozens@cvs.gnome.org>

	* Makefile.am: Moved an out of order entry.

	* plug-ins/script-fu/scripts/beveled-button.scm
	* plug-ins/script-fu/scripts/fuzzyborder.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: Formatting changes.

	* plug-ins/script-fu/scripts/coolmetal-logo.scm: Changed two colours
	to named colour.

	* plug-ins/script-fu/scripts/picman-labels.scm: Moved a double quote.

	* plug-ins/script-fu/scripts/spinning-globe.scm: Fixed duplicate
	variable reference in let block.

	* plug-ins/script-fu/scripts/tileblur.scm: Wrong version got commited.

	* plug-ins/script-fu/scripts/unsharp-mask.scm: Added missing menu
	register block.

2006-10-22  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/pyconsole.py
	* plug-ins/pypicman/plug-ins/picmancons.py: Make CTRL-D close the
	console.

2006-10-21  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/pyconsole.py: Windows is dumb, special
	case out picman invocation just like we did for gtkcons.py

2006-10-21  Michael Natterer  <mitch@picman.org>

	Added "Edit -> Fade" which allows to modify the paint mode and
	opacity of the last drawable operation (fill, plugins etc.).
	Started from a patch by Bill Skaggs. Fixes bug #170707.

	* app/base/base-enums.[ch] (enum PicmanLayerModeEffects): register
	the values REPLACE_MODE, ERASE_MODE and ANTI_ERASE_MODE with
	the type system.

	* app/widgets/picmanpropwidgets.[ch]
	* app/widgets/picmanwidgets-constructors.[ch]: added "gboolean
	with_replace_modes" to the paint mode menu constructors.

	* app/tools/picmanpaintoptions-gui.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanlayertreeview.c: pass with_replace_modes = FALSE.

	* app/core/picmandrawableundo.[ch]: added members which keep tiles,
	paint mode and opacity of the pasted pixels.

	* app/core/picmanimage-undo.[ch] (picman_image_undo_get_fadeable):
	returns a PicmanUndo suitable for a fade operation, or NULL.

	* app/core/picman-edit.[ch] (picman_edit_fade): implements the actual
	fade by undoing the last operation and then re-applying the pixels
	with different paint mode and opacity.

	* app/core/picmandrawable-combine.c: store the pasted pixels in
	the PicmanDrawableUndo.

	* app/actions/edit-actions.c
	* app/actions/edit-commands.[ch]: action and callback for fade.

	* app/dialogs/Makefile.am
	* app/dialogs/fade-dialog.[ch]: the fade dialog.

	* app/widgets/picmanhelp-ids.h: the fade help ID.

	* menus/image-menu.xml.in: added a menu entry in "Edit".

2006-10-20  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/stddefs.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: added wrapper for
	picman-round-rect-select. Added feather_radius_x and _y to
	picman-by-color-select-full and picman-fuzzy-select-full.

	* app/pdb/internal_procs.c
	* app/pdb/selection_tools_cmds.c
	* libpicman/picmanselectiontools_pdb.[ch]: regenerated.

	* libpicman/picman.def: changed accordingly.

2006-10-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.defs: clone methods can't be marked as
	constructors.

	* plug-ins/pypicman/Makefile.am
	* plug-ins/pypicman/procbrowser.c: Remove one-off PicmanProcBrowserDialog
	wrapper. Nobody but the console should've been using it anyway.

	* plug-ins/pypicman/picmanui.override: overrides for PicmanEnumLabel,
	PicmanIntComboBox, and PicmanProcBrowserDialog constructors, as well
	as picman_browser_add_search_types.

	* plug-ins/pypicman/plug-ins/pyconsole.py: New console widget,
	taken from GGAP (http://ggap.sourceforge.net)

	* plug-ins/pypicman/plug-ins/gtkcons.py: removed.

	* plug-ins/picmancons.py: use new console widget, and the
	PicmanProcBrowserDialog binding directly. Still a little rough in
	places.

	* plug-ins/pypicman/plug-ins/pdbbrowse.py: removed, it's redundant.

	* plug-ins/pypicman/plug-ins/Makefile.am: reflect above changes.

2006-10-20  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scheme-wrapper.c: Moved the MIN and MAX entries
	for image size and resolution to script_constants structureas they
	are not deprecated constants.

	* plug-ins/script-fu/scripts/script-fu.init: Removed CR in line endings.

	* plug-ins/script-fu/scripts/*.scm: Fixed a number of regressions that
	snuck in during the last big update of the scripts. This update
	reduces the number of differences to the original scripts (other than
	formatting). Some additional formatting changes in a few scripts.
	Updates to use colour names in register block where possible. Fixed a
	bug in burn-in-anim.scm. Minor cleanup of font-map.scm. Simplified
	the bug fix in tile-blur.scm.

2006-10-20  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c (init_constants):
	* plug-ins/script-fu/script-fu-scripts.c minor cleanups.

2006-10-20  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmandrawableundo.[ch]: new undo class for drawable undos.
	This was lurking on my disk too long...

	* app/core/picmanimage-undo-push.c (picman_image_undo_push_drawable):
	use it instead of implementing it manually.

2006-10-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/procbrowser.c: use pypicman_init_pygobject here too.
	Report and patch from Eric Lamarque (fixes bug #363516).

2006-10-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c
	(picman_transform_tool_button_release): call response(OK) instead of
	calling doit() directly, so all transform confirmation goes
	through response() now.

2006-10-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_draw): show
	the outline of the selection while transforming it.
	Fixes bug #362587.

2006-10-19  Michael Natterer  <mitch@picman.org>

	* app/actions/tools-actions.c (tools_alternative_actions): remove
	the accelerator from the "Arbitrary Rotation" action, Shift+R
	should switch to the rotate tool, not switch to the rotate tool
	*and* select "Transform Layer" from the tool options.

2006-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/script-fu.init: don't load
	script-fu-compat.init here.

	* plug-ins/script-fu/scheme-wrapper.c (tinyscheme_init): load it
	here, from the same place where script-fu.init was found.

	* plug-ins/script-fu/script-fu-interface.c: made the code more
	robust against invalid adjustment types.

2006-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.[ch]
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h: don't look at the menu path
	to see if a script is image-based. Instead check the passed and the
	expected parameter types.

	* plug-ins/script-fu/scripts/tileblur.scm: global variables won't
	work with tiny-scheme.

2006-10-19  Tor Lillqvist  <tml@novell.com>

	* plug-ins/script-fu/tinyscheme/scheme.c
	(file_push, port_rep_from_filename): Open files in binary mode.

2006-10-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_draw): allow
	showing the grid for path transforms. Fixes bug #362588.

2006-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.[ch]: search script-fu.init in
	the scripts search path instead of looking for it in a hardcoded
	directory.

	* plug-ins/script-fu/script-fu-scripts.[ch]
	* plug-ins/script-fu/script-fu.c: changes needed for above change.

2006-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/script-fu-console.c: use g_fopen() from gstdio.h.

	* plug-ins/script-fu/script-fu-scripts.c: removed unused defines.

2006-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/distress-selection.scm: changed range
	for Smoothness value as suggested in bug #363381. Also fixed a typo
	in the menu label.

2006-10-19  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-draw.c (picman_display_shell_draw_area):
	fixed calculation of display area in preparation of fixing bug #362915.

	* plug-ins/common/whirlpinch.c: removed unused define.

2006-10-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: added
	picman_prop_expanding_frame_new() which creates a frame with a
	toggle button in the title.

	* app/tools/picmanblendoptions.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangleselectoptions.c
	* app/tools/picmanselectionoptions.c: use it instead of duplicating
	this code all over the place.

2006-10-18  Michael Natterer  <mitch@picman.org>

	Applied modified patch from Martin Nordholts which adds a "Rounded
	Corners" option to the rectangle select tool. Fixes bug #86279.

	* app/core/picmanchannel-combine.[ch]: added
	picman_channel_combine_ellipse_rect(). Use it from
	picman_channel_combine_ellipse().

	* app/core/picmanchannel-select.[ch]: added
	picman_channel_select_round_rect()

	* app/tools/picmanrectangleselectoptions.[ch]: added properties
	"round-corners" and "corner-radius" and GUI for the new propeties.

	* app/tools/picmanrectangleselecttool.h: added macro
	PICMAN_RECT_SELECT_TOOL_GET_OPTIONS().

	* app/tools/picmanrectangleselecttool.c (picman_rect_select_tool_draw):
	draw round corners if enabled.

	(picman_rect_select_tool_real_select): use
	picman_channel_select_round_rect() if enabled.

	* app/tools/picmanselectionoptions.[ch]: added "antialias_toggle"
	to the PicmanSelectionOptions struct so the rect select options
	can set its sensitivity.

	Unrelated:

	* app/tools/picmanellipseselecttool.c (picman_ellipse_select_tool_draw):
	use 360 * 64 instead of 23040.

2006-10-18  Sven Neumann  <sven@picman.org>

	* [lots of files]: there's no need to make GTypeInfo and
	GInterfaceInfo structs static.

2006-10-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/unsharp-mask.scm: this script should
	not register in the menus. Also unmarked strings for translation.

2006-10-18  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (find_mnemonic_widget): special
	case PicmanSizeEntry and use the last entry.

	* app/tools/picmanrotatetool.c
	* app/tools/picmansheartool.c: added mnemonics (bug #162541).

2006-10-18  Michael Natterer  <mitch@picman.org>

	Separate selection tool function (select, move, cut, ...) from
	selection mode (replace, add, ...). Fixes bug #313634 (that bug
	wasn't triggered any more in HEAD, but was still there).

	* app/tools/tools-enums.h: renamed enum SelectOp to SelectFunction
	and replaced the values REPLACE, ADD, SUBTRACT and INTERSECT by a
	single value SELECT.

	* app/tools/picmanselectiontool.h (struct PicmanSelectionTool):
	renamed member "op" to "function". Changed "SelectOps saved_op" to
	"PicmanChannelOps saved_operation".

	* app/tools/picmanselectiontool.c: we always have the right
	PicmanChannelOps in the tool options, so simply use it instead of
	mixing up unrelated stuff in one enum. Results is some medium-ugly
	nested switches, but is generally much cleaner than before.

	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanregionselecttool.c: changed accordingly. Use the
	operation from the tool options instead of selection_tool->op when
	making the actual selection.

2006-10-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleselecttool.[ch]
	* app/tools/picmanellipseselecttool.c: use enum PicmanChannelOps
	instead of SelectOps.

2006-10-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanselectioneditor.c: use enum PicmanChannelOps
	instead of SelectOps (which is a tool state).

2006-10-17  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginprocedure.c
	(picman_plug_in_procedure_set_image_types): include the procedure
	name in the output on stderr.

2006-10-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/web-browser.scm: reviewed blurbs and
	marked them for translation.

2006-10-17  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c (explorer_dialog): removed
	null character (bug #362832).

2006-10-17  Sven Neumann  <sven@picman.org>

	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: mention paths in the tooltips.

2006-10-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.[ch]
	(script_fu_output_to_console): added a length parameter to avoid
	needless string duplication.

	* plug-ins/script-fu/scheme-wrapper.c (ts_output_string): changed
	accordingly.
	(my_err): in console mode, send error messages to the console.

2006-10-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/tinyscheme/scheme.c: Eliminated compiler warnings.

	* plug-ins/script-fu/scripts/script-fu-compat.init: Added 'nil'.

2006-10-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: removed the "floating" flag and the
	floating/sink API.

	(picman_item_init): call g_object_force_floating() instead.

	* app/core/picmanimage.c
	* app/core/picmanlayer.c
	* app/xcf/xcf-load.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb: use combinations of
	g_object_ref_sink() and g_object_unref() instead of
	picman_item_sink(). Use g_object_is_floating() instead of
	picman_item_is_floating().

	* app/pdb/drawable_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2006-10-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* configure.in: Set enable_python to yes if it wasn't set to no.
	Fixes display of Python status in "Optional Plug-Ins" section.

	* plug-ins/script-fu/scripts/script-fu-compat.init: Added
	'the-environment'.

2006-10-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.c: #include "core/picman.h" for
	picman_message().

2006-10-16  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/Makefile.am
	* plug-ins/winicon/icodialog.c
	* plug-ins/winicon/icoload.c
	* plug-ins/winicon/icosave.c
	* plug-ins/winicon/main.h: applied patch from Aurimas Juška that
	adds support for the loading and saving Vista 256x256 PNG
	Compressed Icons (bug #352899).

	* configure.in
	* plug-ins/Makefile.am: don't build the winicon plug-in if PNG
	support has been explicitely disabled.

2006-10-16  Tor Lillqvist  <tml@novell.com>

	* libpicman/picmanui.c (picman_window_set_transient_for)
	* app/widgets/picmanwidgets-utils.c (picman_window_set_transient_for):
	These functions are used for cross-process transient-for, which
	causes hangs on Win32. Bypass on Win32 for now. (#359538)

2006-10-16  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icodialog.c
	* plug-ins/winicon/icoload.c
	* plug-ins/winicon/icosave.c: applied patches from Aurimas Juška
	that add support for saving 24 bit files and fix a bug in the
	load routines for this format (bug #352899).

2006-10-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: fixed some minor user
	interface and coding style issues.

2006-10-15  Kevin Cozens  <kcozens@cvs.gnome.org>

	With this commit we finally say goodbye to SIOD. This large set of
	changes updates the Script-Fu plug-in to use the TinyScheme Scheme
	interpreter. These changes originated with changes originally made
	to Script-Fu which created Tiny-Fu (aka. the picman-tiny-fu module).

	* plug-ins/script-fu/Makefile.am
	* plug-ins/script-fu/script-fu-console.c
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-scripts.h
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/script-fu/script-fu-text-console.c
	* plug-ins/script-fu/script-fu.c: Updated with the changes made to
	these files as part of the work on the Tiny-Fu project.

	* plug-ins/script-fu/scheme-wrapper.c
	* plug-ins/script-fu/scheme-wrapper.h: Renamed from siod-wrapper.[ch]
	and updated based on differences to ts-wrapper.[ch] from picman-tiny-fu.

	* plug-ins/script-fu/ftx/*
	* plug-ins/script-fu/re/*
	* plug-ins/script-fu/tinyscheme/*
	* plug-ins/script-fu/scripts/script-fu.init
	* plug-ins/script-fu/scripts/script-fu-compat.init
	* plug-ins/script-fu/scripts/contactsheet.scm
	* plug-ins/script-fu/scripts/script-fu-set-cmap.scm
	* plug-ins/script-fu/scripts/script-fu-util-setpt.scm
	* plug-ins/script-fu/scripts/ts-helloworld.scm: Added all of these
	files and directories from Tiny-Fu. Updated the Makefile.am files
	of ftx, re, and tinyscheme now they are in the PICMAN source tree.

	* plug-ins/script-fu/scripts/*.scm: All scripts have been updated as
	needed to ensure they will work with the TinyScheme interpreter. Most
	of the files have been reformatted making it easier to see the syntax
	of Scheme and making them easier to read.

	* plug-ins/script-fu/scripts/Makefile.am: Updated script file lists.

	* plug-ins/script-fu/siod-wrapper.c
	* plug-ins/script-fu/siod-wrapper.h
	* plug-ins/script-fu/siod/*: Removed obsolete files.

	* configure.in: Updated list of files in AC_CONFIG_FILES. Changed
	--disable-script-fu to --without-script-fu which it should have
	been when originally added.

	* INSTALL: Updated to show change to --without-script-fu.

2006-10-15  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.c (file_utils_filename_to_uri): if the
	passed filename starts with a valid, but unhandled uri scheme,
	fail with an error saying "URI scheme 'foo:' is not supported"
	instead of treating it as relative file path. Fixes bug #358203.

	* app/dialogs/file-open-location-dialog.c
	(file_open_location_response): don't close the dialog on errors
	that are related to the entered URI because these errors are
	failed user input validation, not failed open.

2006-10-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanview-popup.c: close the popup when a drag starts.

2006-10-15  Michael Natterer  <mitch@picman.org>

	Applied slightly modified patch from Martin Nordholts which
	implements more fine-grained steps for actions. Fixes bug #165612.

	* app/actions/actions-types.h: add additional values to
	enum PicmanActionSelectType.

	* app/actions/actions.[ch] (action_select_value)
	(action_select_property): handle them here and added "small_inc"
	and "delta_factor" parameters.

	* app/actions/context-actions.c: added small and percent actions
	for the brush radius.

	* app/actions/context-commands.c
	* app/actions/layers-commands.c
	* app/actions/tools-commands.c
	* app/actions/view-commands.c: pass small and percent increase
	values to the action_select_foo() functions.

	* app/actions/context-commands.c (context_brush_radius_cmd_callback):
	make sure we don't end up with 1.1, 2.1 etc brush radius values.

2006-10-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/rcm/rcm_callback.c: use GDK_INVERT instead of GDK_XOR
	with white foreground color.

2006-10-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/imagemap/imap_cmd_move.c
	* plug-ins/imagemap/imap_cmd_move_sash.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_object.c: use GDK_XOR instead of
	GDK_EQUIV. Fixes bug #311621.

2006-10-14  Michael Natterer  <mitch@picman.org>

	* app/dialogs/convert-dialog.c
	* app/dialogs/desaturate-dialog.c
	* app/dialogs/grid-dialog.c
	* app/dialogs/image-properties-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/dialogs/layer-options-dialog.c
	* app/dialogs/print-size-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/scale-dialog.c
	* app/dialogs/vectors-options-dialog.c: don't allow "context" to
	be NULL in any dialog constructor.

2006-10-14  Michael Natterer  <mitch@picman.org>

	Remember the settings in the scale and resize dialogs for images
	and layers. Fixes bug #164995, bug #316392, and bug #357424.

	* app/dialogs/scale-dialog.h: removed PicmanScaleCallback typedef.

	* app/dialogs/dialogs-types.h: added it here.

	* app/dialogs/image-scale-dialog.[ch]: made the ImageScaleDialog
	struct private, return a GtkWidget* from image_scale_dialog_new()
	and use a PicmanScaleCallback in the public API.

	* app/actions/actions-types.h: #include "dialogs/dialogs-types.h"

	* app/actions/image-commands.c: changed according to image scale
	dialog changes. Remember the scale dialog's unit (if it is
	"percent") and interpolation type across dialog invocations. Also
	remember the resize dialog's unit (if it is "percent").

	* app/actions/layers-commands.c: remember scale and resize dialog
	stuff as in image-commands.c

2006-10-14  Michael Natterer  <mitch@picman.org>

	* app/core/picmangrid.c: don't #include "libpicmanbase/picmanlimits.h"

	* app/core/picmanimage-undo-push.c: one more g_message() converted
	to picman_message().

2006-10-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangleselecttool.c (picman_rect_select_tool_execute):
	flush the image after clearing the selection and after anchoring
	a floating layer. Fixes bug #362096.

2006-10-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmancropoptions.c (picman_crop_options_[gs]et_property):
	minor cleanup.

2006-10-12  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/imagemap/imap_main.c (do_data_changed_dialog): Fixed
	compiler warning by using proper cast.

2006-10-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/scale-funcs.c:  apply modified patch
	from GG to improve accuracy of Lanczos,  probably fixes
	bug #358481.

2006-10-12  Sven Neumann  <sven@picman.org>

	* INSTALL: improvements based on a patch from bug #361672.

2006-10-12  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.c (picman_stock_items): added a mnemonic
	for PICMAN_STOCK_TOOL_CROP.

	* plug-ins/common/gif.c (bad_bounds_dialog): improved warning dialog.

2006-10-11  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmanthumb/picmanthumb.def: added picman_thumb_file_type_get_type

2006-10-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/scale-funcs.[ch]: apply patch from GG
	to improve accuracy of Lanczos, from bug #358481.

2006-10-11  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.13.

2006-10-11  Sven Neumann  <sven@picman.org>

	* Made 2.3.12 development release.

	* plug-ins/pypicman/Makefile.am (codegen_files): added missing files.

2006-10-11  Raphaël Quinet  <raphael@picman.org>

	* app/xcf/xcf-load.c (xcf_load_tile_rle): workaround for bug
	#357809: avoid crashing when invalid offsets are read for a
	compressed tile in the XCF file.

2006-10-11  Sven Neumann  <sven@picman.org>

	* modules/Makefile.am: build the color-managed CMYK color selector
	with the same filename as the naïve implementation; they are
	mutually exclusive.

2006-10-11  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanpdb.c: added missing casts.

2006-10-10  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-colors.c: Add slice support to the colors
	types. Fixes bug #360423.

2006-10-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/nova.c: applied patch from Aurimas Juška that
	adds a missing cast which should fix bug #340073.

2006-10-09  Tor Lillqvist  <tml@novell.com>

	* configure.in: Suffix LCMS with EXEEXT. Unbreaks build on Win32.

2006-10-09  Michael Natterer  <mitch@picman.org>

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/actions/drawable-commands.c
	* app/actions/gradients-commands.c
	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/actions/palettes-commands.c
	* app/actions/select-commands.c
	* app/actions/vectors-commands.c
	* app/core/picman-contexts.c
	* app/core/picman-documents.c
	* app/core/picman-edit.c
	* app/core/picman-modules.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman-units.c
	* app/core/picmanchannel.c
	* app/core/picmandatafactory.[ch]
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimagefile.c
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanpdbprogress.c
	* app/core/picmanselection.c
	* app/dialogs/palette-import-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/gui/session.c
	* app/gui/themes.c
	* app/pdb/picmanprocedure.c
	* app/plug-in/picmanplugin-message.c
	* app/plug-in/picmanplugin.c
	* app/plug-in/picmanpluginmanager-file.c
	* app/plug-in/picmanpluginmanager.c
	* app/text/picmantextlayer-xcf.c
	* app/text/picmantextlayer.c
	* app/widgets/picmancontrollers.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandevices.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanuimanager.c
	* app/widgets/picmanvectorstreeview.c
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/palette.pdb: convert lots of g_message() to
	picman_message(). Make sure we never pass unknown strings (like
	error->message) to printf-like functions directly; run them
	thorugh "%s" instead. Don't translate some messages which should
	never happen.

	* app/pdb/brush_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/palette_cmds.c: regenerated.

2006-10-09  Sven Neumann  <sven@picman.org>

	* app/dialogs/tips-parser.[ch]: accept printf-style format strings.

	* app/dialogs/tips-dialog.c: avoid markup in translatable messages
	(bug #360458).

2006-10-09  Michael Natterer  <mitch@picman.org>

	Added message severities and make sure all messages are routed
	through a central function, so redirecting to the error console or
	stderr work again:

	* app/core/core-enums.[ch]: added enum PicmanMessageSeverity { INFO,
	WARNING, ERROR }.

	* app/core/picman.[ch] (picman_message)
	(picman_message_valist): added severity parameter. Changed
	"PicmanProgress *progress" parameter to "GObject *handler", where
	"handler" can be either a PicmanProgress, a GtkWidget or NULL.

	* app/core/picman-gui.[ch] (picman_show_message): ditto. Honor
	--console-messages again. Always dispatch to the GUI message
	handler first if it exists.

	* app/gui/gui-message.[ch]: pass severity parameters around.

	(gui_message_error_dialog): if "handler" is a progress, dispatch
	the message to it first. If it is a widget (and *not* a progress),
	use a GtkMessageDialog on top of that widget's toplevel. Fall
	back to the usual PicmanErrorDialog otherwise.

	* app/core/picmanprogress.[ch] (picman_progress_message): added
	severity parameter. Also added boolean return value to the virtual
	function so it can decide to fail if it can't handle the message.

	* app/display/picmandisplay.c: implement PicmanProgress::message() and
	redirect the message to PicmanDisplayShell.

	* app/display/picmandisplayshell-progress.c: implement
	PicmanProgress::message() and redirect the message to PicmanStatusbar
	if it is not an error and if the status bar is visible.

	* app/display/picmanstatusbar.[ch]: implement PicmanProgress::message(),
	but fail on messages that contain a newline. Show the right icons
	for the message severities (work in progress).

	* app/display/picmandisplayshell.[ch]: removed
	picman_display_shell_message() and its _valist() variant.

	* app/widgets/picmanerrorconsole.[ch]: show the right icons for the
	message severities.

	* app/widgets/picmanthumbbox.c (picman_thumb_box_progress_message):
	return TRUE to swallow all messages.

	* app/widgets/picmanwidgets-utils.[ch]: removed
	picman_show_message_dialog(). Added picman_get_message_stock_id().

	* app/errors.c
	* app/actions/edit-commands.c
	* app/actions/error-console-commands.c
	* app/actions/file-commands.c
	* app/actions/select-commands.c
	* app/actions/text-editor-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimagefile.c
	* app/dialogs/convert-dialog.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/pdb/picmanpdb.c
	* app/plug-in/picmanplugin.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmantool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmanactionview.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanpdbdialog.c
	* app/widgets/picmanvectorstreeview.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/palette.pdb: added severity parameter to
	picman_message() calls. Convert all calls to
	picman_show_message_dialog() and picman_display_shell_message() to
	picman_message(). Also converted some more g_message() calls.

	* app/pdb/brush_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/palette_cmds.c: regenerated.

2006-10-07  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: Don't use Python 2.4 specific functions,
	nor deprecated sys module attributes. Fixes bug #360411.

2006-10-06  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanaligntool.c (picman_align_tool_initialize): added
	missing GError** parameter.

2006-10-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/convmatrix.c: commit patch from GG that
	cleans up code and adds (commented out) support for larger
	matrices, with some coding style fixes; see bug #357085.
	This plug-in still needs help, though.

2006-10-06  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-open-location-dialog.c
	(file_open_location_response): slightly better error handling;
	doesn't address bug #358203 yet.

	* app/file/file-utils.c (file_check_single_magic)
	(file_check_magic_list): code cleanup.

2006-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c: changed some labels to be
	more descriptive instead of explaining the meaning in a tooltip.
	Set slider senitivity according to fractal type.

2006-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c: don't show fractional values
	for the ITER parameter; it is being used as an integer. Also make
	sure that it never becomes zero as that used to crash the plug-in.

2006-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c: save files using
	g_ascii_formatd() (fixes bug #360095).

2006-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icodialog.[ch]
	* plug-ins/winicon/icoload.[ch]
	* plug-ins/winicon/icosave.[ch]
	* plug-ins/winicon/main.[ch]: applied patch from Aurimas Juška
	with code cleanup and fixes for bug #346016 and other issues
	(see bug #352899).

2006-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/*.scm: applied patch from Saul Goode
	with review and localisation of Script-Fu procedure blurbs
	(bug #351283).

2006-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig-dialog.c: reverted change for bug #356901.

	* plug-ins/script-fu/scripts/test-sphere.scm: removed superfluous
	comment.

2006-10-04  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.defs
	* plug-ins/pypicman/picmanui.override: new style constructors for
	PicmanColorButton and PicmanColorScale.

2006-10-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushgenerated-load.c
	* app/core/picmangradient-load.c
	* app/core/picmanpalette-load.c
	* app/core/picmanpalette-save.c: read and write all files in binary
	mode. Improved parser error messages (added line numbers). Minor
	changes to simply read DOS files instead of barfing on them.

2006-10-04  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c: unset scroll-lock (bug #359548).

2006-10-04  Sven Neumann  <sven@picman.org>

	* plug-ins/maze/maze_face.c: minor code cleanup.

2006-10-03  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c: a FALSE return from
	picman_drawable_mask_bounds() doesn't mean failure. Restore old
	behavior. Fixes bug #357223.

2006-10-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/dialogs/offset-dialog.c:  apply patch from David
	Gowers, with minor cleanups, to use item dimensions rather
	than image dimensions; fixes bug #358322.

2006-10-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.[ch]: change labels for transform
	type enum.

	* app/tools/picmanmoveoptions.c:
	* app/tools/picmantransformoptions.c:  change "Affect:" to
	"Move:" or "Transform:", respectively.  Fixes bug #358824.

2006-10-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-convert.c
	(median_cut_pass2_nodestruct_dither_rgb): adjust alpha-dithering
	and make code more readable; fixes bug #358851 as suggested
	by Tor Lillqvist.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette-load.[ch]: added
	picman_palette_load_detect_format().

	* app/core/picmanpalette-import.c: removed it here. Also removed all
	file I/O related includes.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette-load.[ch]: added functions to load ACT,
	RIFF and PSP palette files but don't use them as data file
	loaders (yet?)

	* app/core/picmanpalette-import.c (picman_palette_import_from_file):
	use the functions instead of implementing all formats inline.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanpalette-load.[ch]
	* app/core/picmanpalette-save.[ch]: new files.

	* app/core/picmanpalette.[ch]: removed loading and saving code here.

	* app/core/picman.c
	* app/core/picmanpalette-import.c: changed accordingly.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient-save.[ch]: renamed
	picman_gradient_save_as_pov() to picman_gradient_save_pov().

	* app/actions/gradients-commands.c
	(gradients_save_as_pov_ray_response): changed accordingly.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanbrushgenerated-load.[ch]
	* app/core/picmanbrushgenerated-save.[ch]
	* app/core/picmanbrushpipe-load.[ch]: new files.

	* app/core/picmanbrushgenerated.[ch]
	* app/core/picmanbrushpipe.[ch]: removed loading and saving code here.

	* app/core/picman.c: changed accordingly.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanpattern-load.[ch]: new files.

	* app/core/picmanpattern.[ch]: removed the loading stuff here.

	* app/core/picman.c: changed accordingly.

2006-10-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient-load.h: keep the file extension defines
	here, just as we do it for brushes.

	* app/core/picmangradient.h: removed them here.

	* app/core/picmangradient.c: changed accordingly.

2006-10-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.[ch]
	(picman_image_convert_set_dither_matrix): applied patch from David
	Gowers (bug #359175) and did some further cleanup.

2006-10-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c (iwarp_dialog): use a PicmanHintBox.

2006-10-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.[ch] (picman_toolbox_new): changed Picman
	parameter to PicmanContext and use it instead of getting the user
	context from the Picman.

	(toolbox_tool_button_toggled): set the tool on the dock's
	context instead of the user context.

	* app/dialogs/dialogs-constructors.c (dialogs_toolbox_get): pass
	the context to picman_toolbox_new() instead of context->picman.

2006-10-02  Jakub Steiner <jimmac@ximian.com>

	* stock-controller-midi*:
	* stock-controller-wheel*: start replacing mitch's masterpieces
	with these boring ones.

2006-10-02  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.c: remove the temp message idle source
	in GtkObject::destroy().

2006-10-01  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]
	* libpicmanwidgets/picmancontroller.[ch]: added "const gchar *stock_id"
	members to the class structs.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-controller-16.png
	* themes/Default/images/stock-controller-24.png
	* themes/Default/images/stock-controller-keyboard-16.png
	* themes/Default/images/stock-controller-keyboard-24.png
	* themes/Default/images/stock-controller-linux-input-16.png
	* themes/Default/images/stock-controller-linux-input-24.png
	* themes/Default/images/stock-controller-midi-16.png
	* themes/Default/images/stock-controller-midi-24.png
	* themes/Default/images/stock-controller-wheel-16.png
	* themes/Default/images/stock-controller-wheel-24.png
	* themes/Default/images/stock-display-filter-colorblind-16.png
	* themes/Default/images/stock-display-filter-colorblind-24.png
	* themes/Default/images/stock-display-filter-contrast-16.png
	* themes/Default/images/stock-display-filter-contrast-24.png
	* themes/Default/images/stock-display-filter-gamma-16.png
	* themes/Default/images/stock-display-filter-gamma-24.png
	* themes/Default/images/stock-display-filter-lcms-16.png
	* themes/Default/images/stock-display-filter-lcms-24.png
	* themes/Default/images/stock-display-filter-proof-16.png
	* themes/Default/images/stock-display-filter-proof-24.png: added
	icons for the various display filters and controllers. Made them
	as ugly as sin to trigger some replacement pain in the relevant
	people ;)

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_lcms.c
	* modules/cdisplay_proof.c
	* modules/controller_linux_input.c
	* modules/controller_midi.c
	* app/widgets/picmancontrollerkeyboard.c
	* app/widgets/picmancontrollerwheel.c: set icons.

	* app/widgets/picmancolordisplayeditor.c
	* app/widgets/picmancontrollerinfo.c
	* app/widgets/picmancontrollerlist.c: show them in the display filter
	and controller GUIs.

2006-10-01  Michael Natterer  <mitch@picman.org>

	* themes/Small/gtkrc: it makes little sense to set focus-line-width
	to 0 (hiding the focus line) but still leave padding for it (by
	writing focus-line-padding instead of focus-padding), gah...

	Instead, set focus-line-width = 1 and focus-padding = 0, resulting
	in a visible focus line without adding any extra allocation.

2006-10-01  Michael Natterer  <mitch@picman.org>

	Get rid of one more user context hack:

	* app/dialogs/stroke-dialog.c: attach the saved-stroke-desc to the
	picman object instead of to the passed context in one function, and
	to the user context in the other (coincidentially these contexts
	were the same).

	* app/actions/select-commands.c
	* app/actions/vectors-commands.c: changed accordingly. Pass the
	callback's context instead of the user context to
	stroke_dialog_new().

2006-10-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanstrokeeditor.c (picman_stroke_editor_constructor):
	fix dialog layout (bug #309740).

2006-09-29  Bill Skaggs  <weskaggs@primate.ucdavis.ed>

	* plug-ins/jpeg/jpeg-exif.c: don't let libexif crash us when
	loading image with exif data but no thumbnail.  Works around
	bug #358117.

2006-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: show a dialog for execution errors.

2006-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lcms.c: added more procedures that need to be
	implemented.

2006-09-28  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/lcms.c: build framework for ICC color conversion
	plug-in using littleCMS.

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]: added
	picman_display_shell_message() and a valist variant and decide here
	where the message is shown.

	* app/actions/edit-commands.c (edit_paste)
	* app/tools/picmantool.c (picman_tool_message): use the new message API.

2006-09-28  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.[ch]: added _valist() variants
	of all printf-style functions.

	* app/tools/picmantool.[ch] (picman_tool_push_status)
	(picman_tool_replace_status)
	(picman_tool_message): take printf-style ... arguments and use the
	new valist() variants of the statusbar API to avoid additional
	strdups. Revert previous commit from Sven, he will add back that
	feature differently right away :)

	* app/tools/picmanmeasuretool.c
	* app/tools/picmanpainttool.c: use the new printf-style status API
	where possible.

	* app/tools/picmantransformtool.c: accidentially removed
	"core/picman.h", added it back.

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/core/picman.[ch]: added picman_message_valist().

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/core/picman.h: formatting.

	* app/tools/picmantool.c (picman_tool_message): use picman_message() if
	the statusbar is not visible.

2006-09-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]: added picman_tool_message() which uses
	the new statusbar messages.

	* app/tools/picmantool.c
	* app/tools/picmanpainttool.c: use it instead of accessing the
	statusbar directly.

	* app/tools/picmantransformtool.c: use it instead of picman_message().

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c: some more cleanup.

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.h
	* app/composite/picman-composite-generic.c
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c: added lots of const qualifiers,
	moved variables to local scopes.

	* app/base/pixel-processor.c: formatting.

2006-09-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_do): reverted previous
	change; copy_region() is needed here.

2006-09-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_do): removed a redundant
	call to copy_region().

2006-09-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanconvolvetool.c (picman_convolve_tool_register):
	changed menu label to "Bl_ur / Sharpen" and shortcut to Shift+U.
	Fixes bug #356137. Use "Blur / Sharpen" for all strings.

	* app/tools/picmandodgeburntool.c (picman_dodge_burn_tool_register):
	changed strings from "Dodge/Burn" to "Dodge / Burn".

2006-09-26  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.c
	* app/paint/picmanheal.c
	* app/paint/picmanperspectiveclone.c
	* app/tools/picmanblendtool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: message review. Thanks to Bill.

2006-09-26  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.[ch]: added GError** parameter to
	PicmanPaintCore::start().

	* app/tools/picmanpainttool.c (button_press): display the error in
	the statusbar.

	* app/paint/picmanpaintcore-stroke.c: pass a NULL error, effectively
	swallowing mssages. Will fix that later.

	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmansourcecore.c: changed accordingly. Set the error
	instead of calling g_message().

	* app/paint/picmanheal.c
	* app/paint/picmanperspectiveclone.c: implement start() and bail out
	early on indexed drawables instead of showing a g_message() in
	other functions that are called later.

	* app/tools/picmantool.[ch]: added GError** to PicmanTool::initialize().

	* app/tools/picmantool.c (picman_tool_initialize): display the error
	in the statusbar. Keep the external API GError-free.

	* app/tools/picmanrectangletool.[ch]: added GError** to
	picman_rectangle_tool_initialize().

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanperspectiveclonetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformtool.c: changed accordingly. Set the
	errors in initialize() instead of using picman_message().

	* app/tools/picmanblendtool.c: implement initialize() and bail out
	early on indexed images instead of showing a picman_message() in
	button_press().

2006-09-26  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.c: added some missing g_return_if_fail()
	and moved variables to local scopes.

2006-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/wmf.c (load_image): transfer the pixels
	tile-by-tile instead of doing it row-by-row.

2006-09-26  Sven Neumann  <sven@picman.org>

	* modules/Makefile.am
	* modules/colorsel_cmyk_lcms.c: new CMYK color-selector that uses
	littleCMS for the RGB <-> CMYK conversion. This is built instead
	of the standard CMYK color-selector if lcms is available.

	* libpicmanwidgets/picmancolornotebook.c
	* libpicmanwidgets/picmancolorselection.[ch]
	* libpicmanwidgets/picmancolorselector.[ch]
	* libpicmanwidgets/picmanwidgets.def: added API to set the color
	management configuration on color selectors.

	* libpicmanwidgets/picmanwidgetstypes.h: include
	libpicmanconfig/picmanconfigtypes.h.

	* app/dialogs/grid-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/widgets/picmancolordialog.c
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmangrideditor.[ch]
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmantoolbox-color-area.c: set the color management
	configuration on (hopefully) all color selectors.

	* modules/cdisplay_lcms.c: use a PicmanHintBox widget.

2006-09-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend-libcurl.c: while downloading, use the
	same progress messages as the gnomevfs backend. Minor whitespace
	and indentation cleanup.

2006-09-24  Mukund Sivaraman  <muks@mukund.org>

	* plug-ins/uri/uri-backend-libcurl.c
	* plug-ins/uri/Makefile.am
        * configure.in: added a URI backed which uses the libcurl library

2006-09-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmandrawable-transform.c: apply patch from Geert
	Jordaens to improve Lanczos performance; probably fixes bug
	#355178.

2006-09-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/ripple.c: set min for "period" scale entry to 1
	instead of 0, and add error check for noninteractive.  Fixes bug
	#357431.

2006-09-24  Michael Natterer  <mitch@picman.org>

	* app/actions/context-commands.c: don't allow editing of read-only
	generated brushes. Addresses bug #357436.

2006-09-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/script-fu/scripts/line-nova.scm: Change min for
	randomness from 0 to 1, should fix bug #357433.

2006-09-24  Michael Natterer  <mitch@picman.org>

	Some more proper typing instead of using pointers:

	* libpicmanconfig/picmanconfig-params.h: added macro
	PICMAN_CONFIG_INSTALL_PROP_BOXED().

	* app/core/picmancontainer.c: made "children-type" a GParamSpecGType.

	* app/widgets/picmancontrollerinfo.c: made "mapping" a
	GParamSpecBoxed and use g_hash_table_unref() instead of destroy().

	* app/widgets/picmanpdbdialog.c: made "select-type" a GParamSpecGType.

	* app/dialogs/module-dialog.c
	* app/widgets/picmancolordisplayeditor.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanpluginaction.c: use proper object types, boxed
	types and G_TYPE_GTYPE instead of G_TYPE_POINTER for various list
	stores and signal signatues.

2006-09-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_apply): don't restore
	the entire affected area of the drawable here (it can take *long*
	on large selections).

	(picman_image_map_do): do it here instead, as we idle-process the
	chunks. Slightly reduces overall speed but improves responsiveness
	*massively*

	(picman_image_map_get_color_at): fixed to honor undo tiles offset
	and be readable.

	(picman_image_map_commit)
	(picman_image_map_clear)
	(picman_image_map_clear): don't unref the image_map here. Objects
	don't memory manage themselves.

	Cleaned up the entire file and got rid of all sorts of uglyness.

	* app/tools/picmanimagemaptool.c: unref the image_map here.

	* app/tools/picmancurvestool.c (curves_graph_events): update the
	preview on button_press when we are dragging a free curve.

2006-09-24  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c (curves_graph_events): jikes, update
	the preview only if we actually drag the curve, not on any mouse
	movement.

2006-09-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]: put back code for responding
	to modifiers pressed after mouse1-down, at mitch's request.

2006-09-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]:simplify code by removing
	unneeded properties and getters/setters.

2006-09-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanselectionoptions.c: move "auto-shrink" and
	"shrink-merged" from selection options to rectangle options where
	they belong; now shown for crop tool as well as rect select.

2006-09-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanpropwidgets.c
	* app/tools/picmanrectangleoptions.c: add functionality for aspect
	ratio control.

2006-09-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: add new actions for toggling
	"fixed-aspect" and "fixed-center" options of rectangle tools.

	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmancroptool.c: rely on new actions for keyboard
	control, not on modifiers pressed after mouse1-down.

2006-09-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanpropwidgets.[ch]
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangletool.c: more work on option layout and
	handling.

2006-09-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanpropwidgets.[ch]: revert previous change;
	was not necessary.

2006-09-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_progress_style_set):
	terminate the spaces string correctly. Spotted by bill.

2006-09-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.[ch]: changed all message setting
	functions to use printf-style argument lists. Added new API to
	show a temporary message that stays on top regardless of any other
	message activity and disappears after 3 seconds.

	* app/actions/edit-commands.c: show a statusbar message when
	pasting fails because the clipboard contains no image data. Pop a
	dialog when "Paste as New" fails. Addresses bug #357059 for
	internal functions.

	* app/display/picmandisplayshell-title.c
	* app/gui/gui.c
	* app/tools/picmantool.c: changed accordingly.

2006-09-22  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: always recalculate the
	selection when restarting it.

2006-09-22  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_space_released): also look at
	shell->space_release_pending when deciding whether to return early.

2006-09-22  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/colorxhtml.py: create output that at
	least vaguely resembles XHTML.

2006-09-22  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/colorxhtml.py: pass the correct function
	name to inspect.getsourcefile().

2006-09-22  Sven Neumann  <sven@picman.org>

	* app/gui/gui-message.c
	* app/widgets/picmanwidgets-utils.[ch]: moved utility function to
	picmanwidgets-utils.

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: added a progress parameter to
	picman_pdb_dialog_new() and make the dialog transient to the progress
	window.

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb: pass progress to
	picman_pdb_dialog_new().

	* app/pdb/brush_select_cmds.c
	* app/pdb/font_select_cmds.c
	* app/pdb/gradient_select_cmds.c
	* app/pdb/palette_select_cmds.c
	* app/pdb/pattern_select_cmds.c: regenerated.

	* libpicman/picmanselectbutton.c: cosmetics.

2006-09-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanpropwidgets.c (picman_prop_aspect_ratio_new):
	some small bug-fixes.

	* app/tools/picmanrectangleoptions.[ch]: major revision.  Got
	rid of lots of unneeded getter/setter-clutter, simplified
	set of options and appearance of gui.  Still work in progress.

	* app/tools/picmanrectangleselectoptions.c
	* app/tools/picmanrectangletool.c: corresponding changes.

2006-09-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanselectionoptions.[ch]: remove
	rectangle-related options no longer used anywhere.

2006-09-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanpropwidgets.[ch]: added
	picman_prop_toggle_button_new(), and re-implemented
	picman_prop_check_button_new() in terms of it, as basically
	a convenience function now.

2006-09-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/scale-funcs.[ch]:  commit patch from "gg"
	to fix Lanczos problems, addresses bug #167956 and
	bug #355178.

2006-09-21  Sven Neumann  <sven@picman.org>

	* README.i18n: mention po-python.

	* plug-ins/pypicman/plug-ins/py-slice.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py: prepared for translation.

2006-09-21  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added align-tool (bug #356260).

	* plug-ins/pypicman/plug-ins/palette-to-gradient.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py: prepared for translation.

2006-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/palette-offset.py
	* plug-ins/pypicman/plug-ins/palette-sort.py: prepared for translation.

2006-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.override (_wrap_picman_dialog_new)
	* plug-ins/pypicman/pypicman-drawable.c (drw_set_name): allow String
	or Unicode objects.

	* plug-ins/pypicman/plug-ins/colorxhtml.py
	* plug-ins/pypicman/plug-ins/foggify.py: prepared for translation.

2006-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig-dialog.c: pass correct parameters to
	picman_brush_select_button_new(). Fixes bug #356901.

	* plug-ins/script-fu/scripts/test-sphere.scm: use 100.0 as the
	default opacity for SF-BRUSH.

2006-09-21  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c (read_pixel_data_1) (write_pixel_data_1):
	use the same code on all platforms. The optimization for bytes == 4
	was pointless anyway.

2006-09-21  Michael Natterer  <mitch@picman.org>

	* app/base/tile-manager.c (read_pixel_data_1): fix build on
	big endian.

2006-09-21  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): use
	setpgid() instead of setpgrp(), the latter has a different number
	of arguments on darwin. Let's see where it breaks now...

2006-09-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolornotebook.c: use canonical names for
	style properties.

2006-09-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/picmancanvas.[ch]
	* app/tools/picmandrawtool.[ch]: remove recently added code relating
	to stippled xor drawing -- not handled well by some display
	drivers.

	* app/tools/picmanrectangletool.c: improve drawing of handles.

2006-09-20  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c (drw_set_name): use
	PyUnicode_Check() instead of PyString_Check().

	* plug-ins/pypicman/plug-ins/clothify.py: reverted localisation;
	this plug-in isn't installed by default.

2006-09-20  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/picmancons.py: need to call gettext.install
	here, otherwise we can't use _() in the register() call.

	* plug-ins/pypicman/picmanfu.py: don't call gettext.install() for the
	plug-in. Translate the blurb used as a user hint.

2006-09-20  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c (read_pixel_data_1) (write_pixel_data_1):
	fixed endian issues (bug #340965).

2006-09-20  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin.c (picman_plug_in_close): if the plug-in is
	in a different process group than PICMAN, kill the entire group so
	the plug-in's children are killed too.

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): open
	a process group so the wget process gets killed (bug #356643).

2006-09-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrambox.c: draw slider positions more
	accurately, fixed incorrect use of GtkAdjustments.

2006-09-20  Sven Neumann  <sven@picman.org>

	* app/paint/picmanperspectiveclone.c: removed unused variables and
	unused macro.

2006-09-20  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourcecore.c: implement PicmanPaintCore::start()
	and set paint_core->use_saved_proj to TRUE when we are using
	the destination drawable image's projection as source. Return
	FALSE from start() if there is no src_drawable set and removed
	checks for src_drawable != NULL further down in the code path.

	* app/tools/picmanperspectiveclonetool.c (button_press)
	* app/tools/picmansourcetool.c (button_press): don't fiddle with
	paint_core->use_saved_proj here.

	* app/paint/picmanclone.c: implement PicmanPaintCore::start() and
	return FALSE if we are in pattern mode and there is no pattern to
	clone from. Removed PicmanPaintCore::paint() implementation because
	all it did was popping a message if there is no pattern. Removed
	check for pattern != NULL and cleaned up the file a bit.

	* app/paint/picmanperspectiveclone.c (paint): removed message about
	no pattern to clone from.

2006-09-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient.[ch]: added picman_gradient_flatten() which
	creates a copy of a gradient with all colors that refer to FG or
	BG turned into constant colors.

	* app/core/picmandrawable-blend.c (gradient_fill_region): create a
	flat copy of the gradient if it contains FG/BG colors. Avoids
	gazillions of context color lookups while rendering, depending on
	gradient and blend complexity.

2006-09-19  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: allow to pass a (domain, path) tuple
	as value for the domain argument of the register() call. Document
	the domain argument.

2006-09-19  Sven Neumann  <sven@picman.org>

	* app/core/picman.c (picman_message): don't leak the message.

	* app/file/file-utils.c (file_utils_find_proc): clear the error
	if we found a file procedure by matching the file extension.

	* plug-ins/common/png.c (load_image): don't call picman_quit() if
	opening the file fails but return with PICMAN_PDB_EXECUTION_ERROR.

2006-09-19  Michael Natterer  <mitch@picman.org>

	Fix disabling of deprecated procedures (bug #345733):

	* app/pdb/picmanpdb.c (picman_pdb_register_procedure): silently drop
	deprecated procedures if they are disabled via --pdb-compat-mode.

	* app/plug-in/picmanplugin-message.c (picman_plug_in_handle_proc_run):
	remove code that handles deprecated procedures even when they are
	disabled, the change above makes this impossible.
	Call plug_in_params_to_args() also if we didn't find the
	procedure, so the PDB doesn't choke on NULL args.

2006-09-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanaligntool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanhealtool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmaninktool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpaintbrushtool.c
	* app/tools/picmanpenciltool.c
	* app/tools/picmanperspectiveclonetool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantexttool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmanvectortool.c:  Apply patch from J. Baker,
	with some modifications, to improve tooltips and tool
	names.  Almost fixes bug #356137.

2006-09-18  Sven Neumann  <sven@picman.org>

	* app/tools/picmanaligntool.c: rewrote the UI without tables and
	separators (eek). Also fixes bug #355986.

2006-09-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am
	* plug-ins/pypicman/picmanthumb.defs
	* plug-ins/pypicman/picmanthumb.override
	* plug-ins/pypicman/picmanthumbmodule.c: Bindings for libpicmanthumb.

2006-09-17  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.c (user_install_migrate_files):
	do not migrate toolrc and the tool-options folder.

2006-09-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.override: override implementation of
	picman_window_set_transient so we pass the correct type to the
	C function.

2006-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: try to set a reasonable tile cache size
	for load and save operations.

2006-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lens.c: applied patch from Aurimas Juška which,
	among other changes, ports the plug-in to PicmanZoomPreview
	(bug #324849).

2006-09-17  Sven Neumann  <sven@picman.org>

	* picmanui.pc.in (Libs): added picmanmodule-2.0, removed
	picmanconfig-2.0 which is already refered to from picman-2.0.pc.

2006-09-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: reverted Bill's change. Applying
	the delay before the selection makes as much sense as doing it
	afterwards. Do it consistently at least.

2006-09-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-colors.c: HSV and HSL now handle integer
	values the same way as the RGB and CMYK objects do, for consistency.

2006-09-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-colors.c: Use proper return value types
	for object constructors. Fixes bug #354555.

2006-09-16  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py
	* plug-ins/pypicman/plug-ins/gtkcons.py: let the gettext module

	* po-python/POTFILES.in
	* plug-ins/pypicman/picmanui.py: Mark a couple strings for translation
	here.

2006-09-16  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanperspectiveclonetool.c (button_press)
	* app/tools/picmansourcetool.c (button_press): need to instruct the
	paint_core to make a copy of the projection whenever we clone from
	the same *image*, not from the same display. Fixes crash when
	cloning from the same image's projection in another view
	(bug #356209).

2006-09-15  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: when shooting a region, apply delay
	_after_ selecting region, applying before is useless.

2006-09-15  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanmodule.c: added domain_register method.

	* plug-ins/pypicman/picmanfu.py: define N_(). Added an optional
	"domain" parameter to the register() method. Register the domain
	with PICMAN and initialize gettext if it is specified.

	* plug-ins/pypicman/plug-ins/picmancons.py: use N_() to mark menu
	label and blurb for translation. Specify the translation domain.

	* plug-ins/pypicman/plug-ins/gtkcons.py: use gettext API for modules.

2006-09-15  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/Makefile.am
	* plug-ins/pypicman/pypicman-intl.h: added header file for i18n support.

	* plug-ins/pypicman/picmanmodule.c: bind to the picman20-python
	translation domain.

	* plug-ins/pypicman/procbrowser.c: marked a string for translation.

2006-09-15  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: translate strings in the picman20-python
	textdomain.

	* plug-ins/pypicman/plug-ins/gtkcons.py: fixed a translation mark.

2006-09-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c (run): only store the settings if run
	interactively. Fixes bug #356044.

2006-09-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	Trying to implement some usability recommendations from
	Peter Sikking: bigger handles, more feedback to user.

	* app/display/picmancanvas.[ch]: add
	PICMAN_CANVAS_STYLE_XOR_STIPPLED to set of styles.

	* app/tools/picmandrawtool.[ch]
	(picman_draw_tool_draw_rectangle_stippled): new function.
	Needs a better stipple pattern, though.

	* app/tools/picmanrectangletool.c: bigger handles in corners,
	and highlight thing that user is currently moving.

2006-09-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanrectangletool.c: even if constraining to boundaries,
	keep updating rectangel when pointer goes outside boundaries.
	Fixes bug #355740.

2006-09-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanpropwidgets.[ch]: add prop widget specially
	for controlling aspect ratio.

	* app/tools/picmanrectangleoptions.ch]: use "aspect-numerator"
	and "aspect-denominator" properties instead of "aspect",
	and use new prop widget in gui to set and display them.

	* app/tools/picmanrectangletool.c: calculate aspect from
	numerator and denominator.

2006-09-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancurvestool.c (curves_graph_events): when editing a
	"smooth" curve, update the image while dragging instead of on
	button_release. Suggested by Joel Becker.

2006-09-14  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/gtkcons.py: use gtk.CLOSE instead of
	"Close" to clarify why this string doesn't need to be marked for
	translation.

2006-09-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollereditor.[ch]
	* app/widgets/picmancontrollerlist.c: pass a PicmanContext to
	picman_viewable_dialog_new().

2006-09-14  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c
	* app/dialogs/preferences-dialog.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmancontrollereditor.c:
	* plug-ins/common/autocrop.c
	* plug-ins/common/max_rgb.c: resolved conflicting mnemonics, added
	some new ones (bug #355761).

2006-09-14  Jakub Steiner <jimmac@ximian.com>

	* themes/.../help-system.png:
	* themes/.../help-system-22.png: update to the tango styling.

2006-09-14  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: marked strings for translation.

2006-09-14  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-open-location-dialog.c: set a context on the
	PicmanContainerEntry.

2006-09-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerentry.c: Don't popup the completion
	when there is only a single match because we already use inline
	completion.

2006-09-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerentry.c: implement
	PicmanContainerView::set_context() and set the renderers'	contexts.
	Fixes more preview rendering warnings.  Connect to
	GtkEntryCompletion::match-selected in addition to GtkEntry::changed
	to select the active item. Makes the whole thing work a lot better.

2006-09-13  Michael Natterer  <mitch@picman.org>

	Need to be more careful with setting a tool's focus_dislay now
	that tools can receive modifier events in more circumstances
	(fixes warnings with PicmanEditSelectionTool)

	* app/tools/picmantool.c (picman_tool_button_release): ref the tool
	around the function's body (PicmanEditSelectionTool unrefs itself in
	button_release()), don't reset the active_modifier_state if it is 0.

	(picman_tool_set_focus_display): reset the active_modifier_state if
	it is != 0 and the tool had an old focus_display.

	* app/tools/tool_manager.c (tool_manager_push,pop_tool): set the
	old active_tool's focus_display on the new one.

2006-09-13  Sven Neumann  <sven@picman.org>

	* Makefile.am
	* configure.in
	* po-python: added basic infrastructure for a picman20-python
	translation domain.

	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/pypicman/plug-ins/gtkcons.py: mark some strings for
	translation, based on a patch from David Gowers (bug #351287).

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanperspectiveclonetool.h: added macro
	PICMAN_PERSPECTIVE_CLONE_TOOL_GET_OPTIONS()

	* app/tools/picmanperspectiveclonetool.c: use it. Some minor
	cleanups, removed unused includes.

2006-09-13  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: use the canonical form when
	refering to parameters in the procedure description.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansmudge.c: cosmetic cleanups, renamed
	picman_smudge_nonclipped_painthit_coords() to
	picman_smudge_brush_coords ().

2006-09-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmancroptool.c (picman_crop_tool_register): removed
	"Resize" from the tool name and description.

2006-09-13  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: changed mnemonics (bug #355761).

2006-09-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/lens.c: added Lens Distortion plug-in. Written by
	David Hodson and ported to newer PICMAN APIs by Aurimas Juška and me
	(bug #324849).

2006-09-13  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-new-dialog.c (image_new_create_image): ref the
	context before destroying the dialog.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbrushtool.c: simplified by calling
	picman_draw_tool_pause/resume() unconditionally (it does no harm,
	regardless of whether the tool is in color picking mode or not).
	Return early in picman_brush_tool_draw() if color picking is
	enabled.

	* app/tools/picmansmudgetool.c (picman_smudge_tool_init): don't enable
	color picking, the tool doesn't use FG or BG.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmansourcetool.c (picman_source_tool_control): chain
	up before clearing src_drawable and src_display, so the draw
	tool can undraw the source marker. Fixes bug #355746.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.c (picman_clone_motion): don't access the
	src_pickable when cloning from a pattern. Fixes runtime warnings.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmeasuretool.h
	* app/tools/picmanpainttool.h: fixed _GET_OPTIONS() macros.

2006-09-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmanblendtool.c (picman_blend_tool_active_modifier_key):
	update coordinates in status bar.

2006-09-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/pix.c (query): changed label to not include a
	"|" which can be easily confused with a translation context.

2006-09-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmeasuretool.c (picman_measure_tool_active_modifier_key):
	update status bar and optional dialog window.

2006-09-13  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_set_active_modifier_state):
	added local "gboolean press" variables to improve readability.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/tiff.c: added a parargaph of the original
	copyright notice that was forgotten when originally pasting it.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmeasuretool.[ch]: implement active_modifier_key()
	and give immediate feedback when Control (constrain to 15 degrees)
	is toggled. Did a s/mtool/measure/g.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.c (picman_tool_button_release): reset the
	active_modifier_state *after* invoking the tool's button_release().

	* app/tools/picmanblendtool.[ch]: implement active_modifier_key()
	and give immediate feedback when Control (constrain to 15 degrees)
	is toggled.

2006-09-12  Michael Natterer  <mitch@picman.org>

	Added new tool API for modifier key events while the tool
	is active and implement it in the rect select and crop tools.
	Fixes bug #316156 and bug #355302.

	* app/tools/picmantool.[ch]: added PicmanTool::active_modifier_key()
	and public function picman_tool_set_active_motifier_state(). Remember
	the active_state at button_press and reset it on button_release.
	Ignore releases of modifiers that were pressed at button_press (but
	only ignore them once).

	* app/tools/tool_manager.[ch]: added wrapper
	tool_manager_active_modifier_state_active().

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_events): return FALSE for all modifiers even
	when mouse button 1 is pressed.

	(picman_display_shell_canvas_tool_events): when bouse button 1 is
	pressed *and* the tool is active, dispatch the new active_modifier
	events to tools.

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.[ch]: implement active_modifier_key()
	instead of modifier_key().

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c (selection_undraw): need
	to restart the selection here. Should fix bug #355395 and bug #355456.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmanbrushtool.c (picman_brush_tool_cursor_update): if
	the "bad" cursor modifier is set, show the cursor regardless of
	the picmanrc "show-paint-tool-cursor" setting.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourcecore.[ch]: made picman_source_core_motion() a
	public function for the time being, pending further refactoring.

	* app/paint/picmanperspectiveclone.[ch]: derive from PicmanClone and
	remove everything that is already imeplemented in the parent
	classes. Particularly, removed motion() implementation in favor
	of a get_source() implementation and simply use PicmanClone's
	motion(). Also refuse to work on indexed drawables.

	* app/paint/picmanperspectivecloneoptions.[ch]: derive from
	PicmanCloneOptions and remove everything that is already done by the
	parent classes.

	* app/tools/picmanperspectiveclonetool.c: changed
	accordingly. Doesn't derive from PicmanSourceTool yet since there is
	some virtual function refactoring in PicmanSourceTool missing.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-generic.c
	* app/core/picmanimage-convert.c
	* app/actions/view-actions.c
	* app/dialogs/grid-dialog.c
	* app/dialogs/offset-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/display/picmannavigationeditor.c
	* app/tools/picmaniscissorstool.c
	* app/widgets/picmantoolbox-image-area.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/cubism.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/exchange.c
	* plug-ins/common/fp.c
	* plug-ins/common/gif.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/laplace.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/nova.c
	* plug-ins/common/psp.c
	* plug-ins/common/randomize.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/tga.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/vpropagate.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gflare/gflare.c
	* plug-ins/ifscompose/ifscompose.c: removed unused macros.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrenderer-frame.c: removed unused variables.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpaletteeditor.c (picman_palette_editor_get_index):
	applied a modified patch from David Gowers that changes the search
	behaviour to favour colors in the neighborhood of the selected color
	(bug #355520).

2006-09-12  Sven Neumann  <sven@picman.org>

	* configure.in: mention the Win32 twain plug-in in the summary.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolortool.c (picman_color_tool_button_press)
	(picman_color_tool_button_release): chain up to activate/halt the tool.

	* app/tools/picmanpainttool.c (picman_paint_tool_button_press)
	(picman_paint_tool_button_release)
	(picman_paint_tool_motion): if the color tool is enabled, chain up
	early and return. Fixes selection PAUSE/RESUME mismatch that was
	hiding this display's selection forever when moving sample points.

2006-09-12  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansourcetool.c
	* app/tools/picmanvectortool.c: back out change committed on
	2006-08-21 which passed modifier events to tools even while mouse1
	was down. This generated way too much unexpected events that would
	have to be special cased in all tools. Will implement an
	alternative solution soon.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerpopup.c: removed unused includes.

2006-09-12  Sven Neumann  <sven@picman.org>

	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanperspectiveclonetool.c
	* app/tools/picmanregionselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmanvectortool.c: removed trailing dot from statusbar
	messages.

	* app/widgets/picmanwidgets-utils.c (picman_suggest_modifiers): don't
	use "try" if the modifier action has been specified.

2006-09-12  Pema Geyleg  <pgeyleg@gmail.com>

	* configure.in: Added 'dz' (Dzongkha) to ALL_LINGUAS

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.c: string changes.

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager.[ch]: added a convenience function
	to retrieve the translated procedure label.

	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanimagepropview.c: use it.

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager-locale-domain.h: corrected comment.

	* app/widgets/picmanimagepropview.[ch]: added file related info to
	the Image Properties dialog as requested in bug #86276.

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: pass the user context to
	picman_container_combo_box_new().

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: use "Solid color" as description for
	PICMAN_STROKE_STYLE_SOLID.

	* app/widgets/picmanstrokeeditor.c: moved "style" control further up
	to make it less ambiguous (bug #309740).

	* app/dialogs/stroke-dialog.c (stroke_dialog_new): pass the context
	to picman_container_combo_box_new().

2006-09-11  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c (picman_drawable_preview_draw_area):
	fixed calculation of offset into the source buffer (bug #353639).

2006-09-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: minor cleanup.

2006-09-11  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_ruler_button_press): don't just
	unconditionally use the active tool for sample point moving if it
	is a PicmanColorTool, use it only if it is a PicmanColorTool but *not*
	a PicmanPaintTool with color picking disabled. Fixed bug #355237.

2006-09-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/depthmerge.c (dialogDepthMap2ChangedCallback):
	change "depthMap1Drawable" to "depthMap2Drawable" to fix
	typo introduced in version 1.35 committed on 2004-04-21.
	Should fix bug #355219.

2006-09-10  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c: added a thumbnail to the "Rotate
	Image?" query dialog as suggested in bug #355213.

2006-09-10  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_check_uri):
	after appending an extension, invoke "response" on the dialog and
	bail out, so the file chooser re-runs the overwrite-confirm check.

2006-09-10  Sven Neumann  <sven@picman.org>

	* app/errors.c
	* app/gui/gui-vtable.c: minor cleanup.

2006-09-09  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-perspective*.xcf:
	forgot to add the source XCFs

2006-09-09  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.c (picman_clone_line_image): changed src_pickable
	parameter to src_type.

	(picman_clone_motion): allow the passed srcPR to have alpha even if
	the source pickable is flat. Pass the correct PicmanImageType to
	picman_clone_line_image().

2006-09-09  Sven Neumann  <sven@picman.org>

	* app/app_procs.c
	* app/errors.[ch]: moved some code from app_run() to errors_init().

2006-09-09  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]
	* app/main.c: initialize the error subsystem after the picman object
	has been created.

	* app/errors.[ch]: store a reference to the picman object (eek) and
	use it to call picman_gui_ungrab() before g_on_error_query().

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: added picman_gui_ungrab().

2006-09-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/emboss.c: hopefully really fixed bug #353227
	this time.

2006-09-09  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c: added missing include.

	* app/display/display-enums.[ch]
	* app/dialogs/preferences-dialog.c: changed labels for
	"space-bar-action" preference. Suggestions welcome for further
	improvements.

2006-09-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-pdb.c: reorder includes to avoid preprocessor
	symbol redefinition warnings.

2006-09-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-pdb.c: #define NO_IMPORT_PYGOBJECT, so
	the internal pygobject API symbol is only defined once.

2006-09-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c: use coordinates from
	the current device when starting to scroll. Grab the keyboard and
	pointer when panning with the space bar.

2006-09-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/text/picmantextlayout-render.c (picman_text_layout_render_glyphs):
	handle tabs correctly, as instructed by behdad.  Fixes
	bug #353132.

2006-09-08  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: added GUI for "space-bar-action".

2006-09-08  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanperspectiveclone.c (picman_perspective_clone_motion):
	must not clamp the paint area against the boundary of the
	src_tiles. Various small cleanups.

	* app/paint/picmansourcecore.[ch] (PicmanSourceCore::motion): removed
	src_image parameter.

	Added new virtual function PicmanSourceCore::get_source() and moved
	the source PR initialization code to its default implementation.
	(PicmanPerspectiveClone will override this method later).

	* app/paint/picmanclone.c (picman_clone_motion)
	* app/paint/picmanheal.c (picman_heal_motion): changed accordingly.

2006-09-08  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/display/display-enums.[ch]: added new picmanrc option
	"space-bar-action" and default to "pan". Will add a GUI for this later.

	* app/display/picmandisplayshell-callbacks.c: respect the new option
	and either pan the display or push the move tool. Fixes bug #349903.

2006-09-08  Sven Neumann  <sven@picman.org>

	* app/core/picman.[ch]: added function picman_get_tool_info().

	* app/actions/tools-commands.c
	* app/actions/vectors-commands.c
	* app/tools/picmanpainttool.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox.c: use the new function instead of poking
	into picman->tool_info_list.

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.[ch]: moved code that deals with
	the space key into separate functions. Added space_shaded_tool
	to PicmanDisplayShell instead of using a static variable for it.

	* app/tools/tool_manager.c: removed unused include.

2006-09-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c: mark "Space" and "Backslash"
	for translation (using the same translation context as in GTK+).

2006-09-08  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated

	* app/paint/picmanperspectiveclone.c : error C2057: expected constant
	expression. Stack allocation of dynamic sized arrays is afaik a GCC
	extension, use g_alloca() instead.

2006-09-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanperspectiveclonetool.c
	(picman_perspective_clone_tool_register): fix the tool's menu path
	and accelerator.

2006-09-07  Jakub Steiner <jimmac@ximian.com>

	* stock-tool-perspective-clone*png: add the element of perspective
	in. Perhaps needs a bit of work on the anti-aliasing still.

2006-09-07  Michael Natterer  <mitch@picman.org>

	Merged the "soc-2006-perspective-clone" branch. That branch is
	now officially closed and all further fixes and changes have to
	be applied to HEAD.

	Did some minor adjustments, mostly small indentation and spacing
	fixes. Derive the tool from PicmanBrushTool and renamed the enum
	added to paint-enums.h and it values, added stock icon and menu
	entry.

	Thanks a lot to Pedro Alonso Ferrer!

	* app/paint/paint-enums.[ch]: new enum PicmanPerspectiveCloneMode.

	* app/paint/Makefile.am
	* app/paint/picmanperspectiveclone.[ch]
	* app/paint/picmanperspectivecloneoptions.[ch]: the perspective
	clone core and its options.

	* app/paint/picman-paint.c: register it.

	* app/tools/Makefile.am
	* app/tools/picmanperspectiveclonetool.[ch]: the perspective clone tool.

	* app/tools/picman-tools.c: register it.

	* app/tools/picmanpaintoptions-gui.c: show the widgets that are used
	by perspective clone.

	* app/widgets/picmanhelp-ids.h: the help ID.

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-perspective-clone-16.png
	* themes/Default/images/tools/stock-tool-perspective-clone-22.png
	* libpicmanwidgets/picmanstock.[ch]: its stock ID and icons.

	* menus/image-menu.xml.in: added it to the menu.

2006-09-07  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.12.

2006-09-07  Sven Neumann  <sven@picman.org>

	* Made 2.3.11 development release.

2006-09-07  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanfreeselecttool.c: removed unused variable.

2006-09-07  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanchainbutton.c: added "position" construct-only
	property to allow construction using g_object_new().

	* plug-ins/pypicman/picmanui.defs: use new style constructors for some
	more widgets.

2006-09-07  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.defs: updated the PicmanHintBox constructor
	definition to use pygtk 2.8 features.

	* plug-ins/pypicman/picmanui.override: removed hand-written constructor.

2006-09-07  Sven Neumann  <sven@picman.org>

	* app/base/pixel-region.[ch]
	* app/base/tile-manager.[ch]
	* app/base/tile-swap.[ch]: removed code that tried to swap in
	tiles asynchronously (but ended up calling nothing).

2006-09-07  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c
	* app/base/tile-manager.c
	* app/base/tile-private.h
	* app/base/tile.c: removed tile locking macros that were only used
	for the threaded tile swapper.

2006-09-07  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourcecore.[ch] (picman_source_core_motion): pass
	the src_offset_x and src_offset_y as separate parameters to
	PicmanSourceCore::motion().

	* app/paint/picmanheal.c (picman_heal_motion): changed accordingly.

	* app/paint/picmanclone.c (picman_clone_motion): ditto and use the new
	values for pattern cloning instead of asuming stuff that relies on
	knowledge of picman_source_core_motion()'s internals.

2006-09-07  Sven Neumann  <sven@picman.org>

	* configure.in: removed --enable_threaded_tile_swapper option.

	* app/base/tile-cache.c
	* app/base/tile-private.h
	* app/base/tile-swap.c
	* app/base/tile.c: removed threaded tile swapper code which has
	been sitting here unused for too long.

2006-09-07  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourcecore.[ch] (picman_source_core_motion): pass
	the width and height of the sub-area of paint_area to
	PicmanSourceCore::motion().

	* app/paint/picmanclone.c (picman_clone_motion)
	* app/paint/picmanheal.c (picman_heal_motion): use the new parameters
	instead of taking these values from srcPR->w and ->h, which was
	very confusing.

2006-09-07  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c (edit_actions_setup): set the context
	property on the "edit-fill-pattern" action.

2006-09-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.[ch]: add PicmanRectangleConstraint
	enum.

	* app/tools/picmanrectangletool.[ch]: replace "constrain"
	boolean with "constraint" enum property.  Implement
	constraints in motion handler -- the implementation
	is rather elegant but pretty tricky.

	* app/tools/picmancroptool.c: constrain to image bounds,
	or to active drawable bounds if "current layer only"
	option is checked.

	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanrectangleselecttool.c: no constraint.

	This addresses bug #353936 -- I would say fixes it, but it
	probably needs some fine-tuning.  Also perhaps fixes
	bug #329817 a bit better than before.

2006-09-06  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager-history.c
	(picman_plug_in_manager_history_add): bail out early if the
	procedure is already at the start of the list.

2006-09-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.[ch]: remove PicmanCropMode enum;
	missed in previous commit.

2006-09-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancroptool.c
	* app/tools/picmancropoptions.[ch]: remove "crop vs resize"
	option, as recommended in bug #353936.

2006-09-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/scale-funcs.[ch]: apply patch from Geert
	Jordaens to improve Lanczos scaling, with coding style
	cleanups; partly fixes bug #167956.

2006-09-06  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-commands.c (plug_in_run_cmd_callback)
	(plug_in_repeat_cmd_callback): also add the procedure to the
	history if it is called from the "Recently Used"  menu.

	* plug-ins/common/vpropagate.c: changed progress text.

2006-09-06  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: document the new menu registration syntax.

2006-09-06  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.defs
	* plug-ins/pypicman/picmanui.override: wrap the new PicmanHintBox widget.

	* plug-ins/pypicman/picmanfu.py: use it to display the blurb.

	* plug-ins/pypicman/plug-ins/py-slice.py: added missing verb in blurb.

2006-09-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanhintbox.[ch]: added simple widget to display
	a user hint. Having this as a widget will allow us to change the
	look, perhaps even using style properties.

	* libpicmanwidgets/picmanwidgets.def: added the new symbols.

	* app/dialogs/keyboard-shortcuts-dialog.c
	* plug-ins/common/colormap-remap.c
	* plug-ins/common/redeye.c: use the new widget instead of
	duplicating the code.

2006-09-05  Michael Natterer  <mitch@picman.org>

	* app/actions/debug-actions.c
	* app/actions/debug-commands.[ch]
	* menus/toolbox-menu.xml.in: added "Dump Attached Data" menu item
	which prints the stuff that is attached to the picman and
	user_context objects.

2006-09-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/redeye.c (dialog): use the wilber icon / label
	combination for hints that is also used in colormap-remap.

2006-09-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]: added picman_tool_get_options() so tools
	don't need to include "core/picmantoolinfo.h" just to get to their
	options.

	* app/tools/picman*tool.h: added macros PICMAN_FOO_TOOL_GET_OPTIONS()
	which return specific tool options types and do all casting
	themselves.

	* app/tools/*.c: use the new macros and don't include
	"core/picmantoolinfo.h" in most files.

	* app/tools/picmancolorpickertool.c (picman_color_picker_tool_register):
	make it use the parent context's FG and BG.

	* app/tools/picmancolortool.c (picman_color_tool_real_picked): set the
	color on the tool's options, not on the user context.

2006-09-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanmenudock.c: don't #include "core/picmantoolinfo.h"

2006-09-05  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	don't specialcase picman->no_interface; it's a pointless optimization.

2006-09-05  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	sort the load and save procedures after adding them to the
	database, otherwise there is nothing to sort.

2006-09-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanselectiondata.c: disabled debug spew.

	* plug-ins/common/raw.c: fixed saving of INDEXEDA drawables. Added
	code to load such files. Fixes bug #354034.

2006-09-05  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: switch from a short
	timeout to an idle handler for starting the animation.

2006-09-05  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanheal.c (picman_heal_motion): corrected origPR
	extents calculation. Makes the tool work at image borders
	where it used to warn.

	(picman_heal_laplace_iteration)
	(picman_heal_region): minor coding style stuff.

2006-09-05  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourcecore.[ch] (picman_source_core_motion): do a
	lot of stuff that was duplicated in clone and heal. Added lots of
	parameters to PicmanSourceCore::motion() to get the stuff down to
	clone and heal.

	* app/paint/picmanclone.c (picman_clone_motion): changed accordingly.

	* app/paint/picmanheal.c (picman_heal_motion): ditto. Made it work for
	dest_drawable != src_pickable. Always add alpha to all buffers and
	convert the source buffer to the dest drawable's color space
	because the algorithm works only on buffers of same depth.

2006-09-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-selection.c: more code cleanup.
	Monitor the shell's window state visibility and don't run the
	timeout if the shell is fully obscured, iconified or withdrawn.

2006-09-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: code cleanup. Only use
	a timeout if there is actually a selection and if it is not hidden.

2006-09-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.[ch]: hide the internal API.

	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.[ch]
	* app/tools/picmancolortool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmovetool.c: changed accordingly.

	* app/config/picmandisplayconfig.c
	* app/dialogs/preferences-dialog.c: increased the default marching
	ants speed.

2006-09-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.[ch]: some cleanup. Made
	the Selection struct private and removed unused state member.
	Removed redundant parameter from picman_display_shell_selection_start().

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: changed accordingly.

2006-09-04  Michael Natterer  <mitch@picman.org>

	* app/paint/paint-enums.[ch]: removed enum PicmanHealAlignMode, we
	use the PicmanSourceAlignMode now and can always disable REGISTERED
	in the GUI should it turn out to be really totally pointless.

	* app/paint/Makefile.am
	* app/paint/picmanhealoptions.[ch]: removed. Its properties are
	completely covered by PicmanSourceOptions.

	* app/paint/picmanheal.[ch]: derive from PicmanSourceCore.

	* app/tools/picmanhealtool.[ch]: derive from PicmanSourceTool.

2006-09-04  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added the Heal tool to the Tools menu.

2006-09-04  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-heal*: touch up the heal
	brush tool icon

2006-09-04  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c: only run the idle swapper if needed and
	use a lower priority for the timeout.

2006-09-04  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmansourcetool.[ch]: new class which is essentially a
	copy of PicmanCloneTool with s/clone/source/ plus some minor
	modifications.

	* app/tools/picmanclonetool.[ch]: remove almost everything and
	derive from PicmanSourceTool.

2006-09-03  Michael Natterer  <mitch@picman.org>

	* app/dialogs/palette-import-dialog.[ch]: removed
	palette_import_dialog_show() and palette_import_dialog_destroy()
	and don't remember the created dialog internally. Instead, made
	palette_import_dialog_new() public.

	* app/dialogs/dialogs.c
	* app/dialogs/dialogs-constructors.[ch]: register it with the
	toplevel dialog factory as singleton toplevel.

	* app/actions/palettes-commands.c (palettes_import_cmd_callback):
	use the dialog factory to create the palette import dialog.

2006-09-03  Michael Natterer  <mitch@picman.org>

	* app/paint/picmansourceoptions.[ch] (struct PicmanSourceOptions): added
	non-property boolean member "use_source" which defalts to TRUE.

	* app/paint/picmancloneoptions.c: imeplement GObject::notify() and
	set source_options->use_source to TRUE if the clone type is
	PICMAN_IMAGE_CLONE.

	* app/paint/picmansourcecore.h: removed bogus
	picman_source_core_register() prototype.

2006-09-03  Sven Neumann  <sven@picman.org>

	* app/paint/picmanpaintcore.[ch]: added construct-only property
	"undo-desc". Use this when pushing an undo instead of attempting
	an unsuccessful lookup of the PicmanPaintInfo object.

	* tools/pdbgen/pdb/paint_tools.pdb
	* app/tools/picmanpainttool.c: use paint_info->blurb as undo
	description when constructing the paint core.

	* app/pdb/paint_tools_cmds.c: regenerated.

2006-09-03  Hans Breuer  <hans@breuer.org>

	* app/core/picman-gradients.c : include "picmancontext.h" for
	picman_context_set_gradient().

	* **/makefile.msc app/picmancore.def : updated

2006-09-03  Michael Natterer  <mitch@picman.org>

	* app/paint/paint-enums.[ch]: renamed enum PicmanCloneAlignMode to
	PicmanSourceAlignMode.

	* app/paint/Makefile.am
	* app/paint/picmansourcecore.[ch]
	* app/paint/picmansourceoptions.[ch]: new classes which contain the
	source selection functionality factored out of the clone core and
	options.

	* app/paint/picmanclone.[ch]
	* app/paint/picmancloneoptions.[ch]: remove that functionality here
	and derive from the new classes.

	* app/tools/picmanclonetool.c: changed accordingly.

2006-09-02  Michael Natterer  <mitch@picman.org>

	Merged the "soc-2006-healing-brush" branch. That branch is now
	officially closed and all further fixes and changes have to be
	applied to HEAD.

	Did some minor adjustments, mostly small indentation and spacing
	fixes. Derive the tool from the newly introduced PicmanBrushTool
	which did not exist when the branch was created.

	Thanks a lot to Kevin Sookocheff for this nice contribution!

	* app/paint/paint-enums.[ch]: new enum PicmanHealAlignMode.

	* app/paint/Makefile.am
	* app/paint/makefile.msc
	* app/paint/picmanheal.[ch]
	* app/paint/picmanhealoptions.[ch]: the heal core and its options.

	* app/paint/picman-paint.c: register the heal core.

	* app/tools/Makefile.am
	* app/tools/makefile.msc
	* app/tools/picmanhealtool.[ch]: the heal tool.

	* app/tools/picman-tools.c: register the heal tool.

	* app/tools/picmanpaintoptions-gui.c: show the widgets that are used
	by heal.

	* app/widgets/picmanhelp-ids.h: the heal help ID.

	* tools/pdbgen/stddefs.pdb
	* tools/pdbgen/pdb/paint_tools.pdb: the heal PDB wrappers.

	* app/widgets/widgets-enums.h
	* app/widgets/picmancursor.c
	* cursors/Makefile.am
	* cursors/makefile.msc
	* cursors/tool-heal.png
	* cursors/xbm/tool-heal.xbm
	* cursors/xbm/tool-heal-mask.xbm: a new cursor for the heal tool.

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am
	* themes/Default/images/makefile.msc
	* themes/Default/images/tools/stock-tool-heal-16.png
	* themes/Default/images/tools/stock-tool-heal-22.png: new stock
	icons for the heal tool.

	* app/pdb/internal_procs.c
	* app/pdb/paint_tools_cmds.c
	* libpicman/picmanpainttools_pdb.[ch]: regenerated.

2006-09-02  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.c
	* app/paint/picmanink.c: minor cosmetic cleanup merged from the
	soc-2006-healing-brush branch.

2006-09-02  Michael Natterer  <mitch@picman.org>

	* app/dialogs/quit-dialog.c (quit_close_all_dialog_new): create a
	temporary context for the container view so its renderers have one.

2006-09-01  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/gradient-example.scm: pop the context
	before rendering the gradient so we draw the gradient with the
	user's colors, not with the ones the script uses temporarily.

2006-09-01  Michael Natterer  <mitch@picman.org>

	This commit *should* fix the remaining missing contexts for
	preview creation. Eek at me if it doesn't.

	* app/core/picmanundo.c: pass a struct containing a context to
	picman_undo_create_preview_idle().

	* app/widgets/picmanundoeditor.[ch]: implement
	PicmanDocked::set_context(), remember the context and use it for the
	undo treeview.

	* app/widgets/picmanviewrenderergradient.c: disable debugging output.

2006-09-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanaction.[ch]: added a context property and use
	it when creating PicmanViews.

	* app/actions/file-actions.c: set the context on the "Open Recent"
	actions.

2006-09-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainercombobox.c: implement set_context() and
	set the view renderers' contexts.

	(picman_container_combo_box_insert_item): unselect after inserting
	the first item, PicmanContainerView doesn't select items by itself.

	* app/dialogs/image-new-dialog.c: create a local context for the
	combo box, connect to the context's "template-changed" signal
	instead of the combo boxed's "select-item", fix some stuff and
	don't leak the local PicmanTemplate.

2006-09-01  Sven Neumann  <sven@picman.org>

	* app/core/picmangradient.c: disallow NULL context and removed code
	that used to deal with this case.

2006-09-01  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/gradient.pdb: minor documentation fix

	* app/pdb/gradient_cmds.c
	* libpicman/picmangradient_pdb.c: regenerated

2006-09-01  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.[ch]: use a hash table instead of object
	data to maintain context ids. Saves lots of pointless string copies.

2006-09-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewabledialog.[ch]: added PicmanContext
	parameters and create the PicmanView with that context.

	* app/widgets/picmancolordialog.[ch]
	* app/dialogs/convert-dialog.[ch]
	* app/dialogs/desaturate-dialog.[ch]
	* app/dialogs/grid-dialog.[ch]
	* app/dialogs/image-properties-dialog.[ch]
	* app/dialogs/layer-add-mask-dialog.[ch]
	* app/dialogs/offset-dialog.[ch]
	* app/dialogs/print-size-dialog.[ch]
	* app/dialogs/resize-dialog.[ch]
	* app/dialogs/scale-dialog.[ch]
	* app/dialogs/stroke-dialog.[ch]
	* app/dialogs/template-options-dialog.[ch]
	* app/dialogs/vectors-options-dialog.[ch]: added PicmanContext
	parameters here too and pass them to picman_viewable_dialog_new().

	* app/actions/colormap-editor-commands.c
	* app/actions/drawable-commands.c
	* app/actions/gradient-editor-commands.c
	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/actions/palette-editor-commands.c
	* app/actions/select-commands.c
	* app/actions/vectors-commands.c
	* app/actions/view-commands.c
	* app/dialogs/channel-options-dialog.c
	* app/dialogs/dialogs-constructors.c
	* app/dialogs/image-merge-layers-dialog.c
	* app/dialogs/image-scale-dialog.c
	* app/dialogs/layer-options-dialog.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-scale.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmancolorpanel.c
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmantoolbox-color-area.c: pass contexts to above
	dialog constructors.

2006-09-01  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererdrawable.c: fixed includes for
	picman_rectangle_intersect().

2006-09-01  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrenderer.c
	(picman_view_renderer_real_set_context): ref the context.

2006-09-01  Sven Neumann  <sven@picman.org>

	* app/core/picmangradient-load.c (picman_gradient_load): use sizeof()
	instead of hardcoding the buffer size.

2006-09-01  Michael Natterer  <mitch@picman.org>

	Extended the PICMAN Gradient file format to contain the endpoint
	color types for each segment (this is backward compatible because
	old parsers just ignore excess fields at the end of segment
	lines). Fixes bug #128367.

	* app/core/picmangradient-load.c: optionally load two more fields
	per segment line which contain the color types.

	* app/core/picmangradient-save.c: save the color types at the end of
	the segment lines.

2006-09-01  Michael Natterer  <mitch@picman.org>

	* app/actions/gradient-editor-actions.c
	* app/actions/gradient-editor-commands.[ch]: added actions and
	callbacks to select a gradient segment's left and right color
	type. Handle FG/BG color correctly in a few places. Use
	PicmanDataEditor's context instead of the user context.

	* menus/gradient-editor-menu.xml: added the actions to the menu.

	Cleanup:

	* app/actions/palette-editor-actions.c
	* app/actions/palette-editor-commands.c: use PicmanDataEditor's
	context instead of the user context.

	* app/actions/brush-editor-actions.c: remove unused context
	variable.

2006-08-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.c
	(picman_container_view_real_set_container)
	(picman_container_view_real_set_context)
	(picman_container_view_item_selected)
	(picman_container_view_thaw): support setting a context even if
	the viewed container's children_type is *not* a property of
	PicmanContext. This removes a major restriction of container
	views and allows to get rid of some hacks:

	* app/widgets/picmanitemtreeview.[ch]: removed PicmanContext member
	and implement PicmanContainerView::set_context() instead of
	PicmanDocked::set_context().

	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanlayertreeview.c: use PicmanContainerView's context
	instead of PicmanItemTreeView's and implement PicmanContainerView's
	set_context() instead of PicmanDocked's.

	* app/actions/actions.c (action_data_get_picman)
	(action_data_get_context): don't special-case PicmanItemTreeView any
	more, it's just like a normal PicmanContainerView now.

	* app/widgets/picmancontrollerlist.c
	(picman_controller_list_constructor): set a context on the
	PicmanContainerView so its renderers have a context to use.

2006-08-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.[ch]: remember the context passed to
	picman_thumb_box_new() and use it instead of the user context when
	creating thumbnails.

2006-08-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.[ch] (struct PicmanGradientEditor):
	removed PicmanContext member I added before deciding it needs to be
	added to PicmanDataEditor.

	Use PicmanDataEditor's context instead of the bogus one. Also use
	the data editor's context instead of the user context wherever it
	was used.

	* app/widgets/picmanpaletteeditor.c: use PicmanDataEditor's context
	instead of the user context here too.

2006-08-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmangradient.[ch] (picman_gradient_has_fg_bg_segments):
	new funtion which returns TRUE if any of the gradient's segments
	refer to FG of BG.

	(picman_gradient_segment_get_left_color_type)
	(picman_gradient_segment_set_left_color_type)
	(picman_gradient_segment_get_right_color_type)
	(picman_gradient_segment_set_right_color_type): new accessors for
	the new PicmanGradientColor stuff.

	(picman_gradient_segment_split_midpoint)
	(picman_gradient_segment_range_flip)
	(picman_gradient_segment_range_replicate): split, flip and replicate
	the segments' color_types too.

	* app/widgets/picmanviewrenderer.[ch]: added virtual functions
	::set_context() and ::invalidate() and call them.

	* app/widgets/picmanviewrenderergradient.[ch]: implement the virtual
	functions. Connect to the context's "foreground-changed" and
	"background-changed" signals if the gradient contains FG or BG
	colors and invalidate the renderer whenever they change.

	* app/core/picman-gradients.c: removed signal connections which
	invalidated the gradients on FG/BG changes of the user context.

2006-08-31  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/happy-valley-relief.py: fixed a typo.

2006-08-31  Sven Neumann  <sven@picman.org>

	* app/tools/picman-tools.c: use italic style for the informative label.

2006-08-31  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-mmx.c: moved declarations at the
	beginning of the functions.

	* app/tools/picmantransformtool.c (picman_transform_tool_doit):
	display a message if no paths are available. Could catch this
	earlier, but this is the least intrusive change to fix bug #353495.

2006-08-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c: similar cleanup, removed unused parameters.

2006-08-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: removed debugging output; minor cleanup.

2006-08-30  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/png.c: when saving an IA image, don't load
	the entire image into memory to search for an unused color.
	Fixes bug #308909.

2006-08-30  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h
	* app/dialogs/preferences-dialog.c
	* app/tools/picmanmoveoptions.c: string changes as suggested in
	bug #353440.

2006-08-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/emboss.c: fixed off-by-one error and cleaned up
	the code a bit. Fixes bug #353227.

2006-08-29  Michael Natterer  <mitch@picman.org>

	Changed PicmanViewable preview rendering to have a context to get
	FG/BG/whatever from. Use the context to enable dynamic FG/BG
	colors in gradients. Fixes bug #127676 and bug #352214. Addresses
	bug #128367 (doesn't fix it because there's no loading/saving and
	no GUI yet).

	* app/core/core-enums.[ch]: added enum PicmanGradientColor to enable
	specifying gradient colors in terms of foreground and background.

	* app/core/picmangradient.[ch]: added color_type members to the
	PicmanGradientSegment struct and honor them in
	picman_gradient_get_color_at(). Added PicmanContext parameters to all
	functions which finally call get_color_at().

	* app/core/picman-gradients.c: use the new method to implement the
	builtin gradients.

	* app/core/picmanviewable.[ch]: added PicmanContext parameters to all
	get_preview() and get_pixbuf() functions.

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmandrawable-preview.[ch]
	* app/core/picmangradient.c
	* app/core/picmanimage-preview.[ch]
	* app/core/picmanimagefile.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmanundo.[ch]
	* app/text/picmanfont.c
	* app/vectors/picmanvectors-preview.[ch]: changed ::get_preview()
	and ::get_pixbuf() implementations accordingly.

	* app/core/picmandrawable-blend.c
	* app/core/picmanpalette-import.[ch]
	* app/dialogs/dialogs-constructors.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/resize-dialog.c
	* app/display/picmandisplayshell-layer-select.c
	* app/display/picmandisplayshell.c
	* app/display/picmannavigationeditor.c
	* app/paint/picmanpaintoptions.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmantexttool.c
	* app/actions/gradient-editor-commands.c
	* app/widgets/picmanaction.c
	* app/widgets/picmanbrusheditor.[ch]
	* app/widgets/picmanbufferview.c
	* app/widgets/picmancellrendererviewable.c
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmanclipboard.c
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancomponenteditor.c
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontainercombobox.c
	* app/widgets/picmancontainereditor.c
	* app/widgets/picmancontainerentry.c
	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.[ch]
	* app/widgets/picmandataeditor.[ch]
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmandnd.[ch]
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmangradienteditor.[ch]
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanpaletteeditor.[ch]
	* app/widgets/picmanpropwidgets.[ch]
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmanthumbbox.[ch]
	* app/widgets/picmantoolbox-image-area.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantooloptionseditor.c
	* app/widgets/picmanundoeditor.c
	* app/widgets/picmanvectorstreeview.c
	* app/widgets/picmanview-popup.[ch]
	* app/widgets/picmanview.[ch]
	* app/widgets/picmanviewablebutton.c
	* app/widgets/picmanviewabledialog.c
	* app/widgets/picmanviewrenderer.[ch]
	* app/widgets/picmanviewrenderer-frame.c
	* app/widgets/picmanviewrendererbrush.c
	* app/widgets/picmanviewrendererbuffer.c
	* app/widgets/picmanviewrendererdrawable.c
	* app/widgets/picmanviewrenderergradient.c
	* app/widgets/picmanviewrendererimage.c
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb: added tons of PicmanContext members
	and parameters, implement PicmanDocked::set_context() in many
	widgets. Pass these locally remembered contexts to PicmanViewable
	functions. Did some minor cleanups on the way. There are still
	some minor FIXMEs around where the code uses a NULL context (which
	is allowed by the APIs)

	* app/pdb/drawable_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2006-08-29  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c: minor cleanup.

2006-08-29  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmanrectangle.[ch]: added new files that hold
	picman_rectangle_intersect(), factored out of the core.

	* libpicmanbase/picmanbase.def: updated.

	* app/core/picman-edit.c
	* app/core/picman-utils.c
	* app/core/picman-utils.h
	* app/core/picmanchannel-combine.c
	* app/core/picmandrawable-foreground-extract.c
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/core/picmanimage-preview.c
	* app/core/picmanlayer.c
	* app/core/picmanscanconvert.c
	* app/display/picmandisplayshell-draw.c: changed includes accordingly.

	* libpicman/picmandrawablepreview.c: don't duplicate
	picman_rectangle_intersect() here, use the function in libpicmanbase.

	* app/base/siox.c: use picman_rectangle_intersect() to reduce the
	working area to the region of interest. Fixes bug #340422.

2006-08-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/postscript.c (dither_grey): code cleanup and fix
	for bug #353381 (crash when Preview option is selected).

2006-08-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/dog.c (query): Removed incorrect mention of
	Gauss IIR in blurb (the plug-in uses the RLE algorithm).

2006-08-29  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin.c (picman_plug_in_recv_message): use
	picman_message() if a plug-in crashes.

2006-08-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-duplicate.c (picman_image_duplicate)
	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): a
	somewhat hackish implementation of what's suggested in bug #353246.
	Let the save dialog default to the folder of the duplicated image.

2006-08-29  Sven Neumann  <sven@picman.org>

	* app/display/picmannavigationeditor.c: some adjustments to the fix
	for bug #346880.

2006-08-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerview.[ch]: made set_context() a
	virtual function of the PicmanContainerView interface.

2006-08-28  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.[ch]
	* app/tools/picmantexttool.c
	* app/widgets/picmantexteditor.[ch]: make the text editor transient
	to the display shell.

2006-08-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpdbdialog.c (picman_pdb_dialog_run_callback):
	picman_show_message_dialog() takes a GtkWidget, cast the dialog
	variable accordingly.

2006-08-28  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.c: avoid crashing on newer versions of
	the winicon file format (bug #352899).

2006-08-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanairbrushtool.c
	* app/tools/picmanalignoptions.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickeroptions.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancropoptions.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanflipoptions.c
	* app/tools/picmanhistogramoptions.c
	* app/tools/picmaninkoptions-gui.c
	* app/tools/picmanmagnifyoptions.c
	* app/tools/picmanmeasureoptions.c
	* app/tools/picmanmoveoptions.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangleselectoptions.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmantextoptions.c
	* app/tools/picmantransformoptions.c
	* app/tools/picmanvectoroptions.c: code cleanup.

2006-08-27  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolortool.c (picman_color_tool_real_picked): applied
	modified patch from David Gowers which selects a matching color
	from the palette editor's active palette. I'm not sure if this
	behavior is desirable but we'll never find out if we dont't try.
	Fixes bug #343358.

2006-08-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanselectiontool.c (picman_selection_tool_modifier_key):
	When Alt is down, don't allow other modifiers to change the
	operation shown in the options.  Fixes bug #349338.

2006-08-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanchannel-select.[ch]: add push_undo arguments
	to several picman_channel_select_foo functions.

	* app/actions/vectors-commands.c
	* app/core/picmanchannel-select.c
	* app/core/picmanchannel-select.h
	* app/pdb/paths_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/vectors_cmds.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanvectortool.c
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/selection_tools.pdb
	* tools/pdbgen/pdb/vectors.pdb:  add push_undo argument
	to function calls where needed.

2006-08-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/picmannavigationeditor.c: put zoom label next to
	scrollbar instead of above it; fixes bug #346880.

2006-08-25  Sven Neumann  <sven@picman.org>

	* docs/picman.1.in: updated the URL of the user manual.

2006-08-25  Sven Neumann  <sven@picman.org>

	* configure.in: print the value of $datarootdir in the summary.

	* app/base/tile-swap.c (tile_swap_in_attempt): fixed error
	handling in this unused function.

2006-08-25  Michael Natterer  <mitch@picman.org>

	* app/actions/file-actions.c (file_actions_setup)
	(file_actions_last_opened_update): if there are too few images in
	the document history, use the action's name as label for the empty
	slots, to keep the translation of "" from showing up in the
	shortcut editor.

2006-08-24  Sven Neumann  <sven@picman.org>

	* desktop/picman.desktop.in.in (Categories): removed "Application"
	which is not any longer in the Desktop Menu spec.

2006-08-24  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icodialog.c
	* plug-ins/winicon/icosave.c: fixed handling of indexed images
	(bug #342883).

2006-08-24  Sven Neumann  <sven@picman.org>

	* configure.in: add -Wdeclaration_after_statement to the CFLAGS if
	the compiler supports this flag.

	* docs/picman.1.in: explain ${datarootdir}.

2006-08-24  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-preview.c
	(picman_display_shell_draw_tri): just return if gdk_drawable_get_size()
	returns 0 for width or height (bug #340056).

2006-08-24  Sven Neumann  <sven@picman.org>

	* INSTALL: mention that multi-processor support is on by default.

	* app/base/tile-cache.c: fixed compilation if multi-processor
	support is disabled (bug #352609).

2006-08-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.h
	* app/tools/picmantransformtool.[ch]: add support for handles at
	midpoints of edges.

	* app/tools/picmanscaletool.c: use midpoint handles for scaling
	with fixed width or height.  Fixes bug #344955.

2006-08-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: removed "(Fastest)" from "None"
	and added translation context (bug #343576).

	* app/actions/select-actions.c (select_actions): added translation
	context for "None" and "All".

	* app/widgets/picmanactiongroup.c: strip translation context from
	all labels.

	* libpicmanwidgets/picmanpageselector.c: fixed singular form.

2006-08-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.h: do the change for bug #343576 here;
	the .c file is generated.

2006-08-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/common/png.c: revert changes accidentally
	committed in previous commit.

2006-08-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanbase/picmanbaseenums.c: Don't label Lanczos as "best".
	Addresses bug #343576.

2006-08-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion):
	respect "fixed-center" constraint even if "fixed-aspect"
	or "aspect-square" constraints are active.

2006-08-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion):
	remove some constraining code that shouldn't have been there,
	and simplify a bit.

2006-08-22  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-regression.[ch]: use gulong instead
	of u_long. Should fix bug #352221.

2006-08-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.h
	* libpicmanbase/picmanreloc.h
	* libpicman/picmandrawablepreview.h
	* libpicman/picmantile.h
	* libpicman/picmanunitcache.h
	* libpicmanthumb/picmanthumb-utils.h
	* libpicmanwidgets/picmancolorarea.h
	* libpicmanwidgets/picmanhelpui.h: moved G_GNUC_INTERNAL before the
	return value (bug #352268).

	* tools/pdbgen/lib.pl : changed code generation rules to place
	G_GNUC_INTERNAL before the return value.

	* libpicman/*_pdb.h: regenerated.

2006-08-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrotatetool.c (picman_rotate_tool_motion): fixed code
	that moves the angle between +/- pi (bug #352341).

2006-08-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanclonetool.c
	* app/tools/picmanforegroundselecttool.c: rewrite modifer_key
	functions more readably; no functional changes.

2006-08-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/picmandisplayshell-callbacks.c: allow modifier key events
	for Shift and Control to be propagated even if button1 is down.

	* app/tools/picmanclonetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanvectortool.c: change  modifier_key method
	to prevent any bad consequences.

	* app/tools/picmanrectangletool.[ch]: add modifier_key handler, and
	use it to toggle "make-square" if Shift is pressed while button1
	is down, and "fixed-center" if Control is pressed while button1 is
	down.

	* app/tools/picmanrectangleselecttool.c
	(picman_rectangle_tool_modifier_key): call rectangle tool modifer_key
	method after chaining up.

2006-08-18  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpaletteselectbutton.c
	(picman_palette_select_button_set_palette): check that the palette
	name actually refers to an existing palette and use the active
	palette if name is NULL or empty (like the other select buttons).

	* plug-ins/pypicman/plug-ins/palette-offset.py: use an integer value
	for a PF_INT parameter.

2006-08-18  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: check if the menupath starts with
	<Image> instead of checking that it does not start with <Toolbox>.
	Makes the scripts in <Palettes> work to some extent.

2006-08-18  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py (register): derive the menupath from
	the label before adding to _registered_plugins_.

	* plug-ins/pypicman/Makefile.am: moved clothify.py to test-scripts,
	it doubles the functionality of script-fu-clothify.

	* plug-ins/pypicman/plug-ins/benchmark-foreground-extract.py
	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/palette-sort.py
	* plug-ins/pypicman/plug-ins/palette-to-gradient.py: changed menu
	registration in some places that I missed earlier.

2006-08-17  Sven Neumann  <sven@picman.org>

	* libpicman/picmanpixbuf.[ch]: added a convenience function to create
	a layer from a GdkPixbuf.

	* plug-ins/common/poppler.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/svg.c: use picman_layer_new_from_pixbuf().

	* libpicman/picmanui.def: updated.

2006-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/poppler.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/svg.c: improved progress handling.

2006-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: added an optional menu parameter to
	the register call to simplify menu registration. Also restored
	menupath specific mangling of the procedure arguments.

	* plug-ins/pypicman/plug-ins/*.py: use the menu parameter instead
	of defining a function to call on query.

	* plug-ins/pypicman/plug-ins/sphere.py: do it old-style here for
	testing.

2006-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod/sliba.c (aref1): when accessing members
	of tc_byte_array, cast them to guint8.

2006-08-16  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmancolor/picmancolor.def
	* libpicmanwidgets/picmanwidgets.def: added some missing entries

2006-08-16  Michael Schumacher  <schumaml@cvs.gnome.org>

	* app/Makefile.am: added $(SYMPREFIX) to the -u flags

2006-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanmodule.c: added menu_register method.

	* plug-ins/pypicman/plug-ins/*.py: use picman.menu_register().

2006-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py: allow '-' in procedure and parameter
	names.

	* plug-ins/pypicman/plug-ins/*.py: use canonical procedure and
	parameter names.

2006-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/*.py: use picman_plugin_menu_register().

2006-08-16  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin.c: improved debugging output.

	* libpicman/picmanpaletteselect.c: the palette callback gets passed
	the number of colors.

2006-08-16  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c: cleanup.

	* app/tools/picmanbrushtool.c: don't include picman-intl.h.

2006-08-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c (autocrop): fixed overzealousness
	when cropping on a drawable border (bug #337888).

2006-08-16  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c: actually enable tile cache locking and
	added a missing lock in tile_idle_preswap(). Should fix bug #346923.

2006-08-15  Mukund Sivaraman  <muks@mukund.org>

	* app/dialogs/about-dialog.c: Added a label about unstable status
	to the about dialog.

2006-08-15  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/tools-types.h
	* app/tools/picmanbrushtool.[ch]: new PicmanPaintTool subclass which
	completely handles brush outline drawing.

	* app/tools/picmanpainttool.[ch]: removed all brush stuff here.

	* app/tools/picmanclonetool.[ch]
	* app/tools/picmanconvolvetool.[ch]
	* app/tools/picmandodgeburntool.[ch]
	* app/tools/picmanerasertool.[ch]
	* app/tools/picmanpaintbrushtool.[ch]
	* app/tools/picmansmudgetool.[ch]: derive from PicmanBrushTool.

	* app/tools/picmaninktool.c: removed now obsolete cursor_update()
	implementation.

2006-08-15  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_start):
	added check for PICMAN_TRANSLATE_MODE_MASK_COPY_TO_LAYER which was
	forgotten when this mode was introduced.

2006-08-15  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch] (picman_shm_addr): the return value isn't const.

	* app/tools/picmancurvestool.c (curves_graph_events): fixed cursor
	handling on button press and release events.

2006-08-15  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: do not add a toggle for
	"transient-docks" in stable releases (bug #322577).

2006-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.[ch]
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c: applied patch from Piotr Filiciak that
	merges the save dialogs and completes the changes in bug #342355.

2006-08-15  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint/picmanbrushcore.c (picman_brush_core_color_area_with_pixmap):
	kludge to adjust offset for even-dimensioned brushes; fixes
	bug #166622.

2006-08-15  Sven Neumann  <sven@picman.org>

	* app/core/picmanviewable.h: increased PICMAN_VIEWABLE_MAX_PREVIEW_SIZE
	to 2048 to workaround bug #307314.

2006-08-15  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: applied patch from David
	Gowers that adds extended PDB interface for picman-edit-bucket-fill,
	picman-by-color-select and picman-fuzzy-select. Fixes bugs #348291 and
	#347499.

	* app/pdb/edit_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/selection_tools_cmds.c
	* libpicman/picmanedit_pdb.[ch]
	* libpicman/picmanenums.c.tail
	* libpicman/picmanenums.h
	* libpicman/picmanselectiontools_pdb.[ch]
	* tools/pdbgen/enums.pl: regenerated.

	* libpicman/picman.def: updated.

2006-08-15  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-save.c (xcf_save_tile_rle): coding style.

	* plug-ins/winicon/icodialog.c: removed leftover debug output.

2006-08-15  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated

	* app/xcf/xcf-save.c(1464) : error C2036: 'void *' : unknown size
	pointer arithmetics on void a pointer looks like a GCC extension
	* app/tools/picmanbrightnesscontrasttool.c
	  app/tools/picmancolorbalancetool.c
	  app/tools/picmanhuesaturationtool.c
	  app/tools/picmancolorizetool.c : #include "core/picman.h" for picman_message
	* app/tools/picmaniscissorstool.c : use RINT() rather than rint()
	* app/widgets/picmancontrollerlist.c : #include "picmanwidgets-utils.h"
	for picman_show_message_dialog
	* app/core/picmanprogress.c(229) : 'picman_progress_message' must
	return a value

2006-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/plug-ins/Makefile.am: moved whirlpinch.py to the
	test_scripts category to prevent it from being installed in stable
	releases (bug #46001).

2006-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c: has only one return value if called
	as recompose. Fixes the trigger for bug #350226.

2006-08-14  Michael Natterer  <mitch@picman.org>

	Fixed rounding and double vs. integer inconsistency when dealing
	with mouse coordinates. Fixes bug #350694.

	* app/tools/picmaniscissorstool.c
	(clicked_on_vertex)
	(clicked_on_curve): added double x and y parameters and use them
	instead of the integer iscissors->x and ->y. Cleaned up the
	functions a bit.

	(picman_iscissors_tool_button_press)
	(picman_iscissors_tool_motion): changed accordingly, also rint() the
	passed mouse coords when assigning them to iscissors->x and ->y.

	Unrelated cleanup:

	(iscissors_free_buffers): removed, folded into reset()
	(precalculate_arrays): removed, folded into class_init()

2006-08-14  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c
	* docs/picman-remote.1.in: applied patch from Michael Klein that adds
	an option to print out the XID of the toolbox window (bug #351205).

2006-08-14  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.c: open the file in binary mode.
	Pointed out by Aurimas Juska; fixes bug #172503.

2006-08-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion):
	simplified code for statusbar display.

2006-08-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: changed the limits for "pressx"
	and "pressy". It's wrong to disallow negative values here.

2006-08-14  Sven Neumann  <sven@picman.org>

	* app/actions/context-commands.c (context_brush_radius_cmd_callback)
	(context_actions_update)
	* app/core/picmanbrushgenerated.c (picman_brush_generated_class_init):
	set upper brush size limit to 4000 pixels. Fixes bug #351175.

2006-08-14  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (picman_iscissors_tool_oper_update):
	do not select ISCISSORS_OP_MOVE_POINT for terminal points. Fixes
	bug #132352.

2006-08-14  Michael Natterer  <mitch@picman.org>

	* libpicman/picmandrawablepreview.c (picman_drawable_preview_draw_area):
	draw only within the intersection of the the passed coordinates
	and the selection to avoid access to non-existant (out-of-image)
	selction tiles. Fixes bug #350760.

2006-08-14  Sven Neumann  <sven@picman.org>

	* app/core/picman-edit.c (picman_edit_make_buffer): do not autocrop
	the buffer contents, always keep the selection size (bug #350897).

2006-08-13  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangleoptions.c: restore rectangle settings.
	Fixes bug #346683.

2006-08-11  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/controllers-22.png
	* themes/Default/images/preferences/controllers-22.xcf
	* themes/Default/images/preferences/session-22.png
	* themes/Default/images/preferences/session-22.xcf:
	  fixed a few problems wrt transparency.

2006-08-11  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/preferences/*-22: added a few missing
		preference icons at 22x22px.

2006-08-11  Sven Neumann  <sven@picman.org>

	* app/actions/error-console-commands.c
	* app/actions/text-editor-commands.c: use picman_show_message_dialog().

2006-08-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: introduced a simple message
	dialog to use when there's no progress but a parent widget.

	* app/dialogs/convert-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/tools/picmanimagemaptool.c
	* app/widgets/picmanactionview.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanpdbdialog.c
	* app/widgets/picmanvectorstreeview.c: use the new utility function
	instead of g_message().

2006-08-11  Sven Neumann  <sven@picman.org>

	* app/gui/gui-message.c (gui_message_error_dialog): use the global
	error dialog if the progress is a PicmanProgressDialog.

2006-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.defs: wrap picman_window_set_transient()
	into a method of PicmanDialog.

	* plug-ins/pypicman/picmanfu.py: call dialog.set_transient().

2006-08-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c: pack the main vbox
	expanding so that the progress bar sticks to the bottom of the
	dialog.

	* plug-ins/pypicman/picmanfu.py: moved blurb label to the top, use
	italic style for it. Add a progress bar unconditionally and use a
	PicmanProgressBar for it. Commented out the progress label until it
	is actually used.

2006-08-10  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.[ch]: added a GError parameter to
	file_utils_find_proc().

	* app/actions/file-commands.c
	* app/dialogs/file-save-dialog.c
	* app/file/file-open.c
	* app/widgets/picmandnd-xds.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c: regenerated.

2006-08-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanwidgets.c (picman_coordinate_callback):
	Don't stop emission of "value-changed" signal.  Fixes
	bug #346088.  Let's see if it breaks anything else...

2006-08-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.[ch]: if the user is
	modifying a rectangle and the mode is REPLACE, don't
	show the marching ants for the previous selection, because
	it confuses users.  Should fix bug #347945.

2006-08-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c: fixed the check for an empty image.

2006-08-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/xcf/xcf-private.h
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c: save sample points in xcf files,
	and load them.  Fixes bug #342480.

2006-08-10  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.c: added a copy of g_unescape_uri_string()
	from glib/gconvert.c and use it to improve the results of
	file_utils_uri_display_name() and file_utils_uri_display_basename().

2006-08-10  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c: use picman_message().

	* app/dialogs/preferences-dialog.c: use a GtkMessageDialog and
	make it transient for the preferences dialog.

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_notify): use
	gtk_file_chooser_unselect_all() to unset the filename.

2006-08-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c: for load and save errors, use a
	GtkMessageDialog and make it transient for the tool dialog.

	* app/tools/picmanvectortool.c: use picman_message().

2006-08-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.[ch]
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c: improved error handling for
	picman_image_map_tool_settings_load().

	* app/tools/picmanposterizetool.c: added missing include.

	* app/config/picmanconfig-file.c: rephrased error messages.

2006-08-10  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/interface.c (metadata_dialog): set a border
	width of 12 on the toplevel container.

2006-08-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/oilify.c (run): the plug-in has one return
	value, not two (the trigger of the crasher in bug #350555).

2006-08-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c (plug_in_params_to_args): it's a
	bad idea to access an array before checking if it's long enough.
	Fixes bug #350555. Also added some comments, the logic here is
	really weird.

2006-08-09  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.c
	* libpicmanwidgets/picmandialog.c: fixed gtk-doc comments.

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-transform.[ch]: added new function
	picman_display_shell_transform_segments().

	* app/display/picmandisplayshell-selection.c (selection_transform_segs)
	* app/tools/picmanregionselecttool.c
	(picman_region_select_tool_calculate): use the new function instead
	of looping over the segments.

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-draw.c (picman_display_shell_draw_pen)
	(picman_display_shell_draw_vector): use the new transform functions.

	* app/tools/picmandrawtool.c  (picman_draw_tool_draw_lines)
	(picman_draw_tool_draw_strokes): bail out early if num_points == 0.

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-transform.[ch]: renamed
	transform_coords() to transform_coordinate(); same for the
	untransform variant. Added new functions transform_points() and
	transform_coords() that work on arrays.

	* app/display/picmandisplayshell-autoscroll.c
	* app/display/picmandisplayshell-callbacks.c: changed accordingly.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_lines)
	(picman_draw_tool_draw_strokes): use the new transform functions.

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmaniscissorstool.c (iscissors_draw_curve):
	implement using picman_draw_tool_draw_lines().

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_dispose):
	chain up.

	* libpicman/picmanzoompreview.[ch]: added API to get a pointer to the
	PicmanZoomModel used by the preview and added a constructor that
	allows to pass a model.

	* libpicman/picmanui.def: updated.

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanfreeselecttool.c (picman_free_select_tool_draw):
	implement using picman_draw_tool_draw_lines().

2006-08-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainercombobox.[ch]: allow to configure the
	ellipsize property of the text renderer.

	* app/dialogs/image-new-dialog.c: don't pack the template combo-box
	expanding, unset the ellipsize property.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/core/picman.[ch]: added new function picman_message() as a
	replacement for g_message(). Part of the fix for bug #347214.

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/actions/layers-commands.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimagefile.c
	* app/core/picmanitem.c
	* app/core/picmanlayer.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/pdb/picmanpdb.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c
	* app/widgets/picmanwidgets-utils.c
	* app/xcf/xcf-load.c
	* app/xcf/xcf-private.h
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/palette.pdb: use picman_message() instead of
	picman_message() whenever we have a PicmanProgress.

	* app/pdb/brush_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/palette_cmds.c: regenerated.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: renamed picman_message() to picman_show_message()

	* app/errors.c
	* tools/pdbgen/pdb/message.pdb: changed accordingly.

	* app/pdb/message_cmds.c: regenerated.

2006-08-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/warp.c (diff_prepare_row): applied patch from
	Robert Ögren to fix a segfault on 64bit architectures (bug #327479).

2006-08-08  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.c: fixed gtk-doc comments.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanpluginmanager-history.[ch]: added API to remove
	a procedure from the history.

	* app/plug-in/picmanpluginmanager.c
	(picman_plug_in_manager_remove_temp_proc): remove the procedure from
	the history.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/picmanpluginmanager-history.[ch]: new files that deal
	with the history of plug-in procedures.

	* app/actions/plug-in-actions.[ch]
	* app/plug-in/picmanpluginmanager.[ch]: changed accordingly.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-commands.c (plug_in_run_cmd_callback): add
	all procedures that take an image paramter to the history of
	last-used procedures. Fixes bug #348243.
	(plug_in_repeat_cmd_callback): use plug_in_collect_drawable_args()
	to construct the procedure arguments.

	* app/actions/plug-in-actions.c
	* app/plug-in/picmanpluginmanager.[ch]: renamed "last_plug_ins" to
	"history"; it's actually a list of procedures.

2006-08-08  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: changed limits in
	picman_drawable_thumbnail() and picman_drawable_sub_thumbnail() to 1024
	(PICMAN_VIEWABLE_MAX_PREVIEW_SIZE) and added an assertion like the
	one we have in image.pdb.

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.c: regenerated.

	* libpicman/picmanpixbuf.c: increased the limit to 1024 here as well.

2006-08-08  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-deserialize.c
	(picman_config_deserialize_property)
	* libpicmanconfig/picmanconfig-serialize.c
	(picman_config_serialize_property): check if the properties
	owner_type is an object type before calling g_type_class_peek().

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangleoptions.c
	(picman_rectangle_options_interface_get_type): made PicmanToolOptions a
	prerequisite of the PicmanRectangleOptions interface.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_interface_get_type): made PicmanDrawTool a
	prerequisite of the PicmanRectangleTool interface.

2006-08-08  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c
	(file_save_dialog_new): removed workaround for a GtkFileChooser
	bug that doesn't seem to be needed any longer.
	(file_save_dialog_check_uri): commented out debug spew.

2006-08-07  Raphaël Quinet  <raphael@picman.org>

	* HACKING: Mention that the mailing list is a good place to
	discuss patches (if they need to be discussed).

2006-08-07  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	added missing call to picman_window_set_transient(). Fixes bug #348249.

2006-08-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.c
	(picman_action_group_add_string_actions): added missing cast.

2006-08-06  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanutils.c (picman_strip_uline): restore unescaping
	of "__"-escaped underlines which was broken since the addition of
	"(_X)"-stripping.

2006-08-06  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: Applied patch from Karl Günter
	Wünsch which finishes improving rectangle tools behaviour when
	resizing with fixed ratio. Fixes bug #349337.

2006-08-05  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/picmanpluginprocedure.[ch]
	* app/pdb/picmantemporaryprocedure.[ch]: removed these files...

	* app/plug-in/Makefile.am
	* app/plug-in/picmanpluginprocedure.[ch]
	* app/plug-in/picmantemporaryprocedure.[ch]: ...and added them here.

	* app/Makefile.am
	* app/config/Makefile.am: reordered stuff to make it link again.

	* app/pdb/picmanpdb.c: removed picman_pdb_eek() hack.

	* app/actions/plug-in-actions.c
	* app/dialogs/file-save-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/file/file-utils.c
	* app/menus/plug-in-menus.c
	* app/plug-in/picmanplugin-message.c
	* app/plug-in/picmanplugin-progress.c
	* app/plug-in/picmanplugin.c
	* app/plug-in/picmanpluginmanager-call.c
	* app/plug-in/picmanpluginmanager-file.c
	* app/plug-in/picmanpluginmanager-query.c
	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/picmanpluginprocframe.c
	* app/plug-in/plug-in-def.c
	* app/plug-in/plug-in-rc.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanpluginaction.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/plug_in.pdb: changed includes accordingly.

	* app/pdb/plug_in_cmds.c: regenerated.

2006-08-05  Michael Natterer  <mitch@picman.org>

	* app/config/Makefile.am: make test-config build again.

2006-08-05  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanpdb.c: remove temporary cruft i forgot before.

2006-08-05  Michael Natterer  <mitch@picman.org>

	* app/pdb/picman-pdb-compat.[ch]: added
	picman_pdb_compat_procs_register().

	* app/pdb/picman-pdb.[ch]: removed these files.

	* app/pdb/picmanpdb.c
	* app/core/picman.c: changed accordingly.

	* app/pdb/Makefile.am: build a separate libappinternal-procs.a

	* app/Makefile.am: link it.

2006-08-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager-file.c: don't #include
	"pdb/picman-pdb-compat.h".

2006-08-05  Michael Natterer  <mitch@picman.org>

	Applied (modified and enhanced) patch from Chris Moller which allows
	tools to distinguish similar colors not only by composite, but also
	by R, G, B, H, S and V. Fixes bug #348291.

	* app/core/core-enums.[ch]: added new enum PicmanSelectCriterion
	which can be one of { COMPOSITE, R, G, B, H, S, V }.

	* app/core/picmanimage-contiguous-region.[ch]: added
	select_criterion params and create the region based on difference
	by the selected criterion.

	* app/core/picmanchannel-select.[ch]
	* app/core/picmandrawable-bucket-fill.[ch]: take criterion params and
	pass them through to the contiguous region functions.

	* app/tools/picmanbucketfilloptions.[ch]
	* app/tools/picmanselectionoptions.[ch]: added criterion properties
	and GUI to select it.

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanfuzzyselecttool.c: pass the selected criterion to
	the resp. core functions.

	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanselectioneditor.c
	* app/display/picmandisplayshell-dnd.c
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: changed accordingly
	(simply pass PICMAN_SELECT_CRITERION_COMPOSITE in most cases).

	* app/pdb/edit_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2006-08-05  Raphaël Quinet  <raphael@picman.org>

	* app/core/picmangradient-load.c (picman_gradient_load): Do not crash
	when loading corrupt gradient files.  Ensure that error messages
	are correctly reported with g_set_error() instead of g_message().
	Fixes bug #349996.

	* plug-ins/imagemap/imap_ncsa.l: Do not declare a symbol "link"
	because this conflicts with the system call declared in
	<unistd.h>.  Renamed that symbol "imap_link".  Fixes bug #349589.

	* plug-ins/imagemap/imap_ncsa_lex.c: Updated by hand in order to
	avoid large changes introduced by more recent versions of flex.

2006-08-04  Raphaël Quinet  <raphael@picman.org>

	* tools/pdbgen/stddefs.pdb
	* tools/pdbgen/pdb/convert.pdb: Attributed custom dither code to
	David Gowers and updated my e-mail address for the PDB.

	* app/pdb/convert_cmds.c
	* app/pdb/undo_cmds.c
	* libpicman/picmanconvert_pdb.c: Regenerated.

2006-08-04  Raphaël Quinet  <raphael@picman.org>

	* app/core/picmanimage-convert-data.h
	* app/core/picmanimage-convert.c
	* app/core/picmanimage-convert.h
	* tools/pdbgen/pdb/convert.pdb: Applied slightly modified patch
	from David Gowers allowing a custom dither matrix to be used when
	converting images to indexed mode.  Fixes bug #136604.

	* app/pdb/convert_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanconvert_pdb.h
	* libpicman/picmanconvert_pdb.c: Regenerated.

	* app/tools/picmanselectiontool.c: N_() should have been _().

2006-08-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpropwidgets.c: some doc fixes.

2006-08-04  Michael Natterer  <mitch@picman.org>

	* app/actions/image-actions.c: cosmetics.

	* app/core/picmanimage.c: factor common code out to new utility
	function picman_image_get_item_by_tattoo(), minor cleanups.

2006-08-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_bounds)
	* app/core/picmandrawable.c (picman_drawable_mask_bounds)
	(picman_drawable_mask_intersect): allow to pass in NULL return
	locations for any of the boundary return values.

	* app/tools/picmanselectiontool.c (picman_selection_tool_oper_update):
	don't require hovering the selection for moving the selected
	pixels, since this can be distinguished by looking at the
	modifiers now. Check for the presence of any selected pixels
	instead. Fixes bug #349341.

2006-08-03  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanselectiontool.c (picman_selection_tool_oper_update):
	use picman_suggest_modifiers().

	* app/tools/picmanclonetool.c (picman_clone_tool_oper_update): suggest
	Ctrl only when cloning from the image, not from a pattern

	* app/tools/picmansmudgetool.c (picman_smudge_tool_init): don't
	suggest Ctrl for that tool, even if it can be used.

2006-08-02  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_oper_update): Allow
	some paint tools to not suggest using the Ctrl modifier.

	* app/tools/picmanvectortool.c (picman_vector_tool_status_update):
	slightly more elegant way to free the status string.

2006-08-02  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/pat.c: enable "activates-default" on the name
	entry. Fixes bug #349614. Removed the name entry's callback and
	simply get the string after running the dialog.

2006-08-02  Raphaël Quinet  <raphael@picman.org>

	* app/widgets/picmanwidgets-utils.h
	* app/widgets/picmanwidgets-utils.c (picman_suggest_modifiers):
	New utility function to build status bar messages while allowing
	dynamic names for the modifiers.

	* app/tools/picmanpainttool.h
	* app/tools/picmanpainttool.c: Added new members to the class in
	order to allow paint tools to set different status messages for
	the normal case or when drawing a line.

	* app/tools/picmanclonetool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmansmudgetool.c: Use the new functions to set
	appropriate messages in the status bar.  Still work in progress,
	partial fix for bug #124040.

	* app/tools/picmanvectortool.c: Use picman_suggest_modifiers().

2006-07-31  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: Applied patch from Karl Günter
	Wünsch which Corrects the asyncronicity between mouse cursor and
	selected edge on egde resizing. Partial fix for bug #349337.

2006-07-31  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanselectionoptions.c (picman_selection_options_gui):
	use g_type_is_a() where possible instead of checking individual
	tool types separately.

2006-07-31  Michael Natterer  <mitch@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanregionselecttool.[ch]: new abstract base class
	which does about the same as PicmanFuzyySelectTool did, apart from
	creating the mask of the selected region.

	* app/tools/picmanbycolorselecttool.[ch]
	* app/tools/picmanfuzzyselecttool.[ch]: removed all code and only
	implement PicmanRegionSelectTool::get_mask(). Fuzzy and by-color
	select behave exactly the same now. Fixes bug #126748.

2006-07-31  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compose.c (run): enable "compose_by_drawable"
	for PICMAN_RUN_WITH_LAST_VALS, since these values are drawable IDs,
	not image IDs. Fixes bug #346859.

2006-07-30  Raphaël Quinet  <raphael@picman.org>

	* app/tools/picmanpainttool.c
	* app/tools/picmanvectortool.c
	* app/tools/picmanselectiontool.c: Update the status bar messages.
	Work in progress, partial fix for bug #124040.

2006-07-30  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: check zero division in the right
	place. Fixes bug #348807.

2006-07-28  DindinX  <dindinx@picman.org>

	* plug-ins/bmp/bmpwrite.c: small cleanups.

2006-07-28  Simon Budig  <simon@picman.org>

	* plug-ins/sel2path/sel2path.c: ported to new vectors API,
	removed some of the cruft (there is plenty here...).

2006-07-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanbycolorselecttool.c: removed GObject::dispose()
	implementation (no need to disconnect from a signal connected with
	g_signal_connect_object). Code cleanup in some functions.

2006-07-28  Simon Budig  <simon@picman.org>

	* libpicman/picman.def: added the new symbol

	* tools/pdbgen/pdb/vectors.pdb: cosmetics.

	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-07-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantoolcontrol.[ch]: minor code cleanup.

2006-07-28  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: implemented picman-vectors-to-selection.
	* tools/pdbgen/pdb/paths.pdb: deprecated picman-path-to-selection.

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanpaths_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-07-27  Raphaël Quinet  <raphael@picman.org>

	* HACKING: Clarify how patches can be submitted.

2006-07-27  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/grid.c: fix my fix.

2006-07-27  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/grid.c: width and height were reversed when
	setting refval boundaries in a couple of places; problem
	pointed out by Maciej Katafiasz on irc.

2006-07-27  Jakub Friedl  <jfriedl@suse.cz>

	* plug-ins/script-fu/scripts/spyropicman.scm: updated web URL

2006-07-26  Michael Natterer  <mitch@picman.org>

	* desktop/picman.desktop.in.in: added X-GNOME-Bugzilla-Component,
	X-GNOME-Bugzilla-Version and X-GNOME-Bugzilla-OtherBinaries to
	make new bug-buddy happy. Fixes bug #348859.

2006-07-26  Michael Natterer  <mitch@picman.org>

	* app/actions/select-commands.c (select_shrink_callback): the
	"shrink from border" toggle value needs to be negated for being
	used as internal "edge lock" parameter. Fixes bug #348839.

2006-07-26  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): removed code that was
	special-casing RTL since gtk_tree_view_get_path_at_pos() takes
	this correctly into account now. Fixes bug #348347.

	* app/widgets/picmandockable.c (picman_dockable_size_allocate): fix
	menu button positioning for RTL.

2006-07-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanlevelstool.c (levels_input_area_event): Applied
	patch from Wim Lewis which fixes major uglyness (the code was
	rounding using sprintf() and atof() -- puke). Fixes bug #348317.

2006-07-20  Sven Neumann  <sven@picman.org>

	* app/core/picman-edit.c: formatting.

2006-07-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.override: manually wrap the function
	picman_brush_select_button_get_brush().

2006-07-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/py-slice.py: use PF_DIRNAME for save_path.
	Fixes bug #138714.

2006-07-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.py: make DrawableSelector work again.

2006-07-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.py: make the FileSelector class work again.

	* plug-ins/pypicman/picmanfu.py: add PF_FILENAME and PF_DIRNAME to
	match script-fu. Also, if the default value for PF_FILE ends in '/',
	it goes PF_DIRNAME mode.

2006-07-19  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanui.py: font select API is get_font, not
	get_font_name.

2006-07-19  Manish Singh  <yosh@picman.org>

	This is the start of wrapping much more of the PICMAN API in Python.
	It's not complete yet, some things are broken.

	* plug-ins/pypicman/picmancolormodule.c
	* plug-ins/pypicman/pypicmancolor.h
	* plug-ins/pypicman/pypicmancolor-api.h
	* plug-ins/pypicman/pypicman-colors.c: wrapped PicmanHSV, PicmanHSL, and
	PicmanCMYK. Fleshed out a bit more of PicmanRGB as well. Made the API
	exportable to other modules.

	* plug-ins/pypicman/pypicman-rgb.c: removed, subsumed into
	pypicman-colors.c.

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-pdb.c: PDB calls receive and create
	picmancolor.RGB objects now.

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-api.h: export pypicman_drawable_new.

	* plug-ins/pypicman/picmancolor-types.defs
	* plug-ins/pypicman/picmanenums-types.defs
	* plug-ins/pypicman/picmanui.defs
	* plug-ins/pypicman/picmanui.override
	* plug-ins/pypicman/picmanuimodule.c: new module for PICMAN UI widget
	bindings.

	* plug-ins/pypicman/picmanui.py
	* plug-ins/pypicman/picmanfu.py: use some of the new widgets.

	* plug-ins/pypicman/Makefile.am: hook all the above into the build
	system.

	* plug-ins/pypicman/plug-ins/palette-sort.py: use new color API.

2006-07-19  Manish Singh  <yosh@picman.org>

	* libpicman/picmangradientselectbutton.c
	* libpicman/picmanpatternselectbutton.c: Make doc comments match
	reality.

2006-07-19  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmandialog.[ch]: add picman_dialog_add_button[s] API,
	primarily for language bindings.

2006-07-19  Manish Singh  <yosh@picman.org>

	* libpicmancolor/picmancmyk.[ch]
	* libpicmancolor/picmanhsl.[ch]
	* libpicmancolor/picmanhsv.[ch]: create boxed types for PicmanCMYK,
	PicmanHSL, and PicmanHSV.

	* libpicmancolor/picmancolor.h
	* libpicmancolor/Makefile.am: include new picmanhsl.[ch] files.

2006-07-19  Sven Neumann  <sven@picman.org>

	Make message dialogs transient for the progress window. Addresses
	bug #347214.

	* app/core/picman-gui.[ch]: added a progress parameter to
	picman_message().  Let picman_message() deal with optionally
	delegating the message to picman_progress_message().

	* app/errors.c: changed accordingly.

	* app/core/picmanprogress.[ch] (picman_progress_message): return a
	boolean indicating whether the message was handled.

	* app/gui/Makefile.am
	* app/gui/gui-message.[ch]
	* app/gui/gui-vtable.c: moved message handling to a new file. Only
	use the global error dialog for messages without a progress.
	Otherwise attach an error dialog to the progress and try to make
	it transient to the progress window.

	* tools/pdbgen/pdb/message.pdb:
	* app/plug-in/picmanplugin-progress.[ch]: don't delegate messages to
	the progress interface, this is handled by picman_message() now.

	* app/pdb/message_cmds.c: regenerated.

	* app/plug-in/picmanplugin.c
	* app/actions/documents-commands.c: formatting.

2006-07-18  Kevin Cozens  <kcozens@cvs.gnome.org>

	* INSTALL: Document --enable-profile, --disable-python, and
	--disable-script-fu.

2006-07-18  Sven Neumann  <sven@picman.org>

	* app/config/picmanbaseconfig.c: increased default tile cache size
	to 1GB.

	* app/config/picmancoreconfig.c: doubled the default undo-size.

	* app/config/picmanrc-blurbs.h (TILE_CACHE_SIZE_BLURB): rephrased.

2006-07-18  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c: improved tooltips for strong
	undo/redo actions (bug #347675).

2006-07-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): use
	file_utils_uri_display_basename() instead of g_path_get_basename()
	to get an uri's basename. Fixes bug #347544.

2006-07-18  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpaletteeditor.c (picman_palette_editor_get_index,
	 picman_palette_editor_set_index, picman_palette_editor_max_index):
	fixed potential crash based on a patch from David Gowers (bug #347593).

2006-07-18  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: fixed docs for picman-image-add-layer
	as pointed out in bug #347861.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-07-16  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-rgb.c: picmancolor.RGB is now a sequence,
	so we can swap it in for PDB color types.

2006-07-16  Manish Singh  <yosh@picman.org>

        * configure.in: bump up python requirement to 2.3.5 and pygtk to
        2.8.0, in preparation for depending on features not in prior
        releases.

2006-07-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* configure.in
	* plug-ins/Makefile.am: Added --disable-script-fu to allow building
	of PICMAN without the Script-Fu plug-in. See bug #347570.

2006-07-16  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_setup_exif_for_save): set Software
	to "PICMAN", not "The PICMAN".

2006-07-16  Sven Neumann  <sven@picman.org>

	* app/errors.h (picman_fatal_error, picman_terminate): use G_GNUC_PRINTF.

2006-07-14  Maurits  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_grid.h
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.c: fixed problem with zoom menu

2006-07-14  Mukund Sivaraman  <muks@mukund.org>

	* app/config/picmanbaseconfig.c: if possible, detect the number of
	online CPUs in the system and use that instead of the default value
	of 2 for the number of pixel processors. Also made the default value
	1 where it's not possible to detect the number of CPUs. Uses twice
	the number for development versions.

2006-07-13  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_set_cursor): set the
	sensitivity of the cursor label before converting the coordinates
	to the display unit (bug #347339).

2006-07-13  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.[ch]
	* plug-ins/bmp/bmpwrite.c: simplified run() method, renamed a
	variable.

2006-07-13  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: increased timeout to 5 seconds (bug #347345).

2006-07-12  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.[ch]
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c: applied a slightly modified patch from
	Piotr Filiciak that adds support for 16/32 bit bitmaps and support
	for alpha channel (bug #342355).

2006-07-12  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c
	* app/pdb/picmanpluginprocedure.c: formatting.

2006-07-11  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-write.[ch]: added const qualifiers.

2006-07-11  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c
	* app/xcf/xcf-private.h
	* app/xcf/xcf-save.c
	* app/xcf/xcf.c: do progress updates when loading/saving XCF files.

2006-07-11  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf.c: minor cleanup.

	* app/core/picmanimage-merge.[ch]: made picman_image_merge_layers() a
	static function, it isn't used outside this file.

2006-07-10  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c: use a signed variable when attempting to
	skip over unknown properties and check for EOF.  Fixes bug #345802.

	* app/xcf/xcf-read.c: cleanup, nothing really changed

2006-07-10  Sven Neumann  <sven@picman.org>

	* app/tools/picmandrawtool.c: documentation based on a patch from
	Tom Lechner (bug #346959).

2006-07-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: don't cast between PicmanRGB and
	PicmanVector; it works but it's ugly and caused compiler warnings.

2006-07-07  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c (prefs_dialog_new): changed
	"display" to "image window" in user visible string.

2006-07-07  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* app/gui/gui.c: relaxed required version for gtk+ to 2.8.17 and
	pango to 1.12.2 so that it compiles on Ubuntu (Dapper Drake).

2006-07-07  Sven Neumann  <sven@picman.org>

	Use Ctrl-P as the default keyboard shortcut for Print (bug #302870):

	* app/actions/dialogs-actions.c: removed Ctrl-P shortcut from
	Palettes dialog.

	* etc/Makefile.am
	* etc/menurc: added a default menurc file that binds Ctrl-P to
	file-print-gtk.

	* app/core/picman-user-install.c: install the default menurc.

2006-07-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancoloreditor.c
	* libpicmanwidgets/picmancolorselection.c: in the tooltip for the hex
	entry, mention that it also accepts CSS color names.

	* libpicmanwidgets/picmanwidgets.c (picman_scale_entry_new_internal):
	use an invisible event box for the tooltip.

2006-07-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.[ch]: corrected comment (bug #346755).

2006-07-06  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-save.c (xcf_save_image_props): removed redundant
	call to xcf_save_prop() for PROP_PARASITES. Spotted by Henning
	Makholm (bug #346754).

2006-07-06  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c (xcf_load_vector): applied a patch from
	Henning Makholm that introduces a sanity check on the number of
	axes (bug #346742).

2006-07-06  Sven Neumann  <sven@picman.org>

	* app/base/boundary.[ch]
	* app/base/picmanlut.c
	* app/base/pixel-processor.c
	* app/base/pixel-region.[ch]
	* app/base/temp-buf.[ch]
	* app/base/tile-manager.[ch]
	* app/base/tile.c: code cleanup.

2006-07-05  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_average_text_area): unset the test
	strings after calculating the text color.

2006-07-05  Sven Neumann  <sven@picman.org>

	* app/gui/themes.h (themes_get_theme_file): G_GNUC_NULL_TERMINATED.

2006-07-05  Sven Neumann  <sven@picman.org>

	* INSTALL: updated dependencies.

2006-07-05  Sven Neumann  <sven@picman.org>

	* libpicman/picman*selectbutton.[ch]: use const for G_CONST_RETURN.

2006-07-05  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanenv.h
	* libpicmanbase/picmanmemsize.h
	* libpicmanbase/picmanparasiteio.[ch]
	* libpicmanbase/picmanutils.h
	* libpicmanconfig/picmanconfig-path.[ch]
	* libpicmanthumb/picmanthumb-utils.[ch]: marked some functions with
	G_GNUC_MALLOC.

	* plug-ins/common/dicom.c: use g_date_set_time_t() instead of the
	deprecated g_date_set_time().

2006-07-05  Michael Natterer  <mitch@picman.org>

	* configure.in: depend on glib >= 2.10.2, gtk+ >= 2.8.18
	and pango >= 1.12.3. Define FOO_DISABLE_DEPRECATED also for
	glib 2.12, gtk+ 2.10 and pango 2.14

	* app/sanity.c
	* app/gui/gui.c: adjusted sanity checks accordingly.

	* app/dialogs/stroke-dialog.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanuimanager.c
	* libpicmanwidgets/picmanhelpui.c
	* libpicmanwidgets/picmanmemsizeentry.c
	* plug-ins/helpbrowser/picmanthrobber.c: replace gtk_object_sink()
	by combinations of g_object_ref_sink() and g_object_unref().

2006-07-05  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.11.

2006-07-05  Sven Neumann  <sven@picman.org>

	* Made 2.3.10 development release.

2006-07-05  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def
	* libpicman/picmanui.def: updated lists of exported symbols.

2006-07-05  Sven Neumann  <sven@picman.org>

	* data/images/picman-splash.png: new splash image contributed by
	Philip Lafleur (bug #346096).

2006-07-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanthumbbox.c: ellipsize the filename label.

2006-07-03  Michael Natterer  <mitch@picman.org>

	* app/gui/splash.[ch]: added "be_verbose" parameters and be
	verbose about which splash image is actually loaded.

	* app/gui/gui.c (gui_init): pass picman->be_verbose to
	splash_create().

2006-06-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): don't leak X
	resources.

2006-06-30  Simon Budig  <simon@picman.org>

	* app/widgets/picmanstrokeeditor.c: unref the old StrokeOptions
	when new ones get set as a property. Spotted by Henk Boom.

2006-06-29  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/print/print.[ch]
	* plug-ins/print/print-draw-page.[ch]
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-settings.c: implement preview internally,
	assorted other small changes.

2006-06-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: use macros in an attempt to make
	the key grabbing code more readable.

2006-06-29  Sven Neumann  <sven@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplayshell-progress.[ch]: new files,
	implementing the PicmanProgress interface by delegation to
	PicmanStatusbar.

	* app/display/picmandisplayshell.c (G_DEFINE_TYPE): call
	picman_display_shell_progress_iface_init().

	* app/display/picmandisplay.c: delegate progress calls to
	PicmanDisplayShell instead of shell->statusbar.

2006-06-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): allow the
	usage of Escape together with CapsLock, NumLock and ScrollLock.

2006-06-29  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): use 0 instead
	of AnyModifer in the call to XGrabKey.  This prevented the
	cancellation of the screenshot with Escape in some environments.

2006-06-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: added an else that we lost somehow.

2006-06-28  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: improved calculation of text color based on
	the splash image (bug #165760).

2006-06-28  Sven Neumann  <sven@picman.org>

	* app/menus/plug-in-menus.c (plug_in_menus_setup): generate unique
	keys so that two procedures can be installed to the same menu entry.
	Addresses bug #346001.

2006-06-28  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: fixed typo spotted by Jakub Friedl.

2006-06-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mail.c
	* plug-ins/common/screenshot.c: updated inlined icons from Tango
	Icon library.

2006-06-28  Sven Neumann  <sven@picman.org>

	* libpicman/picmanfontselectbutton.[ch]
	* libpicman/picmangradientselectbutton.[ch]
	* libpicman/picmanpaletteselectbutton.[ch]
	* libpicman/picmanpatternselectbutton.[ch]: for consistency with
	PicmanBrushSelectButton dropped the _name suffix from the getter
	and setter API.

	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpalettemenu.c
	* libpicman/picmanpatternmenu.c
	* plug-ins/gfig/gfig-style.c
	* plug-ins/script-fu/script-fu-interface.c: changed accordingly.

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanbrushselectbutton.[ch]
	* libpicman/picmanselectbutton.c: cleanup for consistency.

2006-06-28  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/text_tool.pdb: applied a (slightly modified)
	patch from Joao that improves PDB documentation (bug #345926).

	* app/pdb/text_tool_cmds.c
	* libpicman/picmantexttool_pdb.c: regenerated.

2006-06-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanstrokedesc.[ch]: removed broken implementation of
	picman_stroke_desc_duplicate() and reimplement it by overriding the
	duplicate() method of the PicmanConfig interface.

2006-06-27  Sven Neumann  <sven@picman.org>

	Applied patch from Zbigniew Chyla (bug 345982):

	* app/widgets/picmanactiongroup.c (picman_action_group_add_string_actions)
	strip translation context from translated entries[i].label.

	* app/tools/picmanmagnifytool.c: added translation context.

2006-06-27  Sven Neumann  <sven@picman.org>

	Applied patch from Zbigniew Chyla (bug 345982):

	* app/tools/picmantransformtool.[ch]: added undo_desc field for
	storing undo string and use that, not tool_info->blurb.

	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: set undo_desc.

2006-06-27  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_proof.c: use the PicmanColorRenderingIntent enum
	from libpicmanconfig instead of duplicating it.

2006-06-27  Sven Neumann  <sven@picman.org>

	Changes based on a patch from Zbigniew Chyla (bug #345982):

	* libpicmanbase/picmanutils.c: strip translation context from enum
	descriptions.

	* libpicmanbase/picmanbaseenums.h
	* libpicmanconfig/picmancolorconfig-enums.h: added translation context
	to some enums.

	* libpicmanbase/picmanbaseenums.c
	* libpicmanconfig/picmancolorconfig-enums.c: regenerated.

2006-06-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanunit.c: applied patch from Zbigniew Chyla that adds
	translation context to some problematic strings (bug #345982).

2006-06-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel-select.c
	* app/core/picmandrawable-bucket-fill.c
	* app/core/picmandrawable-transform.c
	* app/core/picmanimage-crop.c
	* app/dialogs/image-scale-dialog.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanmovetool.c
	* plug-ins/gfig/gfig-dialog.c: applied patch from Zbigniew Chyla
	that adds translation context to some problematic strings
	(bug #345982).

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanui.py: applied patch from Joao S. O. Bueno
	Calligaris that makes PF_FILE use a GtkFileChooserButton. Fixes
	bug #326986.

2006-06-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_notify_type):
	do not call bounds() and recalc() with a NULL display.  Added
	sanity checks for the display parameter to both functions.
	Fixes bug #345791.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_menu.c: commented out the non-functional
	Zoom menu.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_preview.c: improved dialog layout.

2006-06-27  Michael Natterer  <mitch@picman.org>

	* plug-ins/print/print-draw-page.c: s/uft8/utf8/ makes it compile.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/illusion.c
	* plug-ins/script-fu/script-fu.c some more canonical procedure
	names that we missed earlier.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CML_explorer.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/mblur.c
	* plug-ins/common/png.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/tga.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/tiler.c
	* plug-ins/common/unsharp.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gfli/gfli.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/script-fu/script-fu.c
	* plug-ins/twain/twain.c
	* plug-ins/winsnap/winsnap.c: use canonical parameter names.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/MapObject/mapobject_main.c: use canonical procedure and
	parameter names. Marked procedure blurbs for translation.

	* plug-ins/winicon/main.c: use canonical procedure and parameter
	names.

2006-06-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmanalignoptions.c: removed unused includes and stubs.

2006-06-27  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h (NUM_PROCESSORS_BLURB): simplified.

	* app/config/picmanguiconfig.c: changed default window hints back to
	"normal". Fixes bug #344242.

2006-06-27  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig-dialog.[ch]
	* plug-ins/gfig/gfig-dobject.h
	* plug-ins/gfig/gfig.[ch]: put extern variables where they belong.
	Patch from Daniel Richard G. (bug #342455).

2006-06-27  Sven Neumann  <sven@picman.org>

	Based on a patch from Zbigniew Chyla:

	* app/core/picmanunit.c (_picman_unit_get_singular, _picman_unit_get_plural):
	don't call gettext() on strings returned by _picman_unit_get_user_unit().

2006-06-27  Sven Neumann  <sven@picman.org>

	Applied patch from Zbigniew Chyla (bug 345982):

	* app/picman-intl.h
	* libpicman/stdplugins-intl.h: removed most content and include
	<glib/gi18n.h> instead.

	* libpicman/libpicman-intl.h: define ngettext() macro as wrapper around
	dngettext().

2006-06-27  Sven Neumann  <sven@picman.org>

	I18n improvements based on a patch from Zbigniew Chyla:

	* app/main.c:
	* modules/controller_midi.c
	* plug-ins/script-fu/scripts/guides-new.scm: marked strings for
	translation.

	* app/widgets/picmandock.c
	* libpicmanwidgets/picmanpageselector.c
	* plug-ins/common/plugin-browser.c: use ngettext() for plural forms.

2006-06-27  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c (picman_export_image): use NULL as the
	special value, not "silent".

	* plug-ins/print/print-draw-page.c: changed accordingly.  Also
	fixed handling of filename encoding.

2006-06-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicman/picmanexport.c: if format arg is "silent", export
	without popping a dialog -- saves duplicating code.

	* plug-ins/print/print-draw-page.c
	* plug-ins/print/print-draw-page.h
	* plug-ins/print/print-page-layout.c
	* plug-ins/print/print-page-layout.h
	* plug-ins/print/print-settings.c
	* plug-ins/print/print-settings.h
	* plug-ins/print/print.h:         new files

	* plug-ins/print/Makefile.am
	* plug-ins/print/print.c:  modified

	Progress toward GtkPrintOperation plug-in.  Should already
	be usable, but very ugly.

2006-06-26  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_pdb_dialog_new): hide the button-bar.

2006-06-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c: use STOCK_WARNING instead of
	STOCK_WILBER_EEK for the quit dialog.

2006-06-25  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c: quick fix so colors in the PDB work
	again.

2006-06-25  Manish Singh  <yosh@picman.org>

	* libpicman/picmanuitypes.h
	* libpicman/picmanselectbutton.[ch]: abstract class for resource selection
	buttons.

	* libpicman/picmanfontselectbutton.[ch]: derive from PicmanSelectButton.

	* libpicman/picmanbrushselectbutton.[ch]
	* libpicman/picmangradientselectbutton.[ch]
	* libpicman/picmanpaletteselectbutton.[ch]
	* libpicman/picmanpatternselectbutton.[ch]: replacements for
	picman_foo_select widgets, akin to PicmanFontSelectButton.

	* libpicman/picmanbrushmenu.[ch]
	* libpicman/picmangradientmenu.[ch]
	* libpicman/picmanpalettemenu.[ch]
	* libpicman/picmanpatternmenu.[ch]: deprecate old API, and reimplement
	in terms of PicmanFooSelectButton.

	* libpicman/picmanfontmenu.[ch]: change to use the PicmanSelectButton API.

	* libpicman/picmanuimarshal.list: new marshallers for the above new
	widgets.

	* libpicman/picmanui.h: add new headers.

	* libpicman/Makefile.am: add new files.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-style.[ch]
	* plug-ins/script-fu/script-fu-interface.c: use new API.

2006-06-25  Manish Singh  <yosh@picman.org>

	* libpicman/picmanbrushes.c
	* modules/cdisplay_colorblind.c: fix some ytpos.

2006-06-25  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in-params.c
	* libpicman/picman.[ch]
	* libpicmanbase/picmanprotocol.[ch]
	* plug-ins/common/colormap-remap.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/grid.c
	* plug-ins/pypicman/pypicman-pdb.c
	* plug-ins/script-fu/siod-wrapper.c
	* tools/pdbgen/pdb.pl: turn d_int8 and d_int8array into guint8.
	Fixes bug #344431.

2006-06-25  DindinX  <dindinx@picman.org>

	* plug-ins/common/tga.c: untabified.

2006-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	ellipsize the progress label to avoid dialog resizing.

2006-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_preview.[ch]: moved rulers out of the
	scrolled window and update them when the scroll adjustments
	change. Fixes bug #341149.

	* plug-ins/imagemap/imap_about.c
	* plug-ins/imagemap/imap_menu.c: unrelated cleanups.

2006-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: the name of the binary is "print".

2006-06-23  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: applied patch from Eric Lamarque that adds
	a new function to check for a valid URI. Fixes bug #332835.

2006-06-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* configure.in: adjust requirements for building gtk-print plug-in
	-- requires gtk+ 2.9.3.

	* plug-ins/print/Makefile.am
	* plug-ins/print/print.c: new plug-in using GtkPrintOperation.
	Mainly infrastructure at this point -- output is wildly
	incorrect.

2006-06-22  Sven Neumann  <sven@picman.org>

	* menus/toolbox-menu.xml.in: moved separator.

2006-06-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c: (picman_transform_tool_control):
	always upchain.

	(picman_transform_tool_cursor_update): use the small crosshair
	instead of PICMAN_CURSOR_MOUSE as default cursor to avoid hotspot
	jumping.

	(picman_transform_tool_doit): call prepare() after bounds().

2006-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c
	* plug-ins/common/colormap-remap.c
	* plug-ins/helpbrowser/dialog.c: popup the menu on Shift-F10.

2006-06-22  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c (prefs_dialog_new): pack the
	page icon with 6px padding too, just as the page label.

2006-06-21  Sven Neumann  <sven@picman.org>

	* app/tools/picman-tools.c (picman_tools_restore): don't attempt to
	reorder to a position >= container->num_children.

2006-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: Always use crosshair cursor
	if shift or ctrl are down; fixes bug #345551.

2006-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c: moved hints to the bottom.

2006-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c: applied patch from Mukund
	Sivaraman that adds a "Reverse Order" option in favor of having
	ascending and descending sort functions.

2006-06-21  Sven Neumann  <sven@picman.org>

	* docs/Makefile.am (EXTRA_DIST): stop distributing Wilber.svg.

	* libpicmancolor/picmancolorspace.h: formatting.

2006-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: if there is a floating
	selection and mouse is clicked outside it without movement, anchor it.

	* app/tools/picmanrectangletool.c: corner handle area was scaling
	improperly when image was zoomed.

2006-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/dialogs/authors.h: autogenerated file; committing changes
	caused by Roman's previous commit.

2006-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c: added a right-click menu that
	allows to sort the colormap by hue, saturation or value.

2006-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c: added a Reset button and
	prepared for colormap sorting.

2006-06-21  Roman Joost  <romanofski@picman.org>

	* AUTHORS
	* authors.xml: sorted previously added names alphabetically

2006-06-21  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch] (picman_shm_addr): return a const pointer.
	(picman_message_func): removed wrong cast.

2006-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/warp.c: minor code cleanup.

2006-06-21  Roman Joost  <romanofski@picman.org>

	* AUTHORS
	* authors.xml: added active docwriters from the PICMAN manual

2006-06-20  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/print/Makefile.am: added build infrastructure for new
	print plug-in.

2006-06-20  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/Makefile.am
	* plug-ins/common/gnomeprint.c
	* plug-ins/common/winprint.c: removed gnomeprint and winprint
	plug-ins. We will have a plug-in based on GtkPrint for PICMAN 2.4.

2006-06-20  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/print: removed the picman-print plug-in. gutenprint comes
	with a PICMAN plug-in, so there is no point in supporting this any
	longer.

2006-06-20  Sven Neumann  <sven@picman.org>

	* authors.xml: only use the "artist" role for the newly added
	contributors.

2006-06-20  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): don't
	try to set "." as current_folder_uri.

2006-06-20  Sven Neumann  <sven@picman.org>

	* app/dialogs/tips-dialog.c: use PICMAN_STOCK_INFO for the tips dialog.

	* data/images/Makefile.am: do not install unused wilber icons.

2006-06-20  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-wilber-*: tweak shape a bit
	* data/images/wilber-icon.png, picman-logo.png: reflect the changes
	  here as well.

2006-06-20  Jakub Steiner <jimmac@ximian.com>

	* authors.xml: add Andreas, Lapo and Bill as artists.

2006-06-20  Sven Neumann  <sven@picman.org>

	* themes/Default/images/preferences/Makefile.am: install icons at
	22x22 pixel size.

	* app/dialogs/preferences-dialog.c (prefs_notebook_append_page):
	try to load icons at 22x22 instead of scaling down the large one.

2006-06-20  Sven Neumann  <sven@picman.org>

	* themes/Default/Makefile.am
	* themes/Default/imagerc: removed imagerc, it was outdated anyway.

	* themes/Default/images/Makefile.am: don't install the icons that
	are compiled in.

2006-06-20  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/*xcf: forgot the source xcfs

2006-06-20  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/*: apply Tango style on the default iconset.
	A teamwork of Andreas Nilsson, Lapo Calamandrei, William
	Szilvester and myself.

2006-06-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl

	* plug-ins/common/desktop-link.c: new load plug-in that parses a
	.desktop file and if it is a link, asks PICMAN to open the file the
	link points to (bug #326956).

2006-06-20  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c (about_dialog_create): only unref the
	logo pixmap if it is not NULL; loading it may fail.

2006-06-20  Sven Neumann  <sven@picman.org>

	* app/tools/tools-enums.h: added TRANSFORM_HANDLE_NONE (will get
	rid of TRANSFORM_CREATING later).

	* app/tools/picmantransformtool.[ch]: added member "use_handles" and
	default to FALSE for all "use_foo" variables.  Only deal with the
	handles the specific transform tool asks for.  Set cursors
	according to the active handle.

	* app/tools/picmanfliptool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c: changed accordingly.

2006-06-19  Sven Neumann  <sven@picman.org>

	* app/actions/error-console-commands.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell-scale.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmantexttool.c
	* app/widgets/picmancellrendereraccel.c
	* app/widgets/picmanviewabledialog.c
	* app/widgets/picmanviewrenderer.c: changed casts in calls to
	g_object_add_weak_pointer() to silence compiler warnings.

2006-06-19  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.c (DEFAULT_WEB_BROWSER): changed to
	"firefox", most distributions seem to have renamed the binary.

2006-06-19  Sven Neumann  <sven@picman.org>

	* data/images/picman-logo.png: replaced with the application logo
	(bug #343948).

	* data/images/picman2_2_logo.png: the old logo, as a reference.

	* app/dialogs/about-dialog.c: let GtkAboutDialog deal with the
	logo.  Moved the text animation below the copyright notice.

	* app/pdb/picmanpluginprocedure.c
	(picman_plug_in_procedure_add_menu_path): added the argument type
	checks for the new locations. Factored out duplicated code.

	* app/menus/menus.c (menus_init): add the "plug-in" action
	group to the resp. UI managers.

	* app/menus/plug-in-menus.c (plug_in_menus_menu_path_added):
	support them here too.

	* app/widgets/picmanimageeditor.[ch]
	* app/widgets/picmanitemtreeview.[ch]: added get_image() functions.

	* app/actions/plug-in-commands.c: added new utility functions
	which collect plug-in arguments from PicmanImageEditor and
	PicmanItemTreeView widgets.

	* menus/channels-menu.xml
	* menus/colormap-editor-menu.xml
	* menus/layers-menu.xml
	* menus/vectors-menu.xml: added separators.

	* menus/image-menu.xml.in: added a "Colormap" placeholder in
	Colors/Map

	* plug-ins/common/colormap-remap.c (query): register a menu
	entry in <ColormapEditor> and moved the existing one to the
	"Colormap" placeholder. Also register an icon to make this
	menu item clearly distinct from the others in that menu.

	Unrelated:

	* plug-ins/common/colormap-remap.c (run): cleaned up quite a
	bit. Fixed last-vals code and simplified map handling.

	(remap_swap): removed, folded into run().

	(remap_dialog): use the passed map to initialize the dialog so it
	starts with the last-vals. Tweaked layout to have 16 columns
	and simplified cell renderer creation.

2006-06-16  Manish Singh  <yosh@picman.org>

	* app/errors.c
	* app/main.c
	* app/file/picmanrecentlist.c
	* libpicmanbase/picmansignal.c
	* libpicman/picman.c
	* modules/controller_midi.c
	* plug-ins/common/gqbist.c: use _GNU_SOURCE instead of the other
	_FOO_SOURCE variables to support -ansi -pedantic on glibc systems,
	since anything else breaks compilation of otherwise working code.
	Fixes bug #344203.

2006-06-16  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-colormap-*.png
	* themes/Default/images/stock-indexed-palette-*.png: renamed
	stock-indexed-palette to stock-colormap.

	* libpicmanwidgets/picmanstock.[ch]: deprecated
	PICMAN_STOCK_INDEXED_PALETTE in favor of PICMAN_STOCK_COLORMAP.

	* app/actions/actions.c
	* app/actions/colormap-editor-actions.c
	* app/actions/colormap-editor-commands.c
	* app/actions/context-actions.c
	* app/actions/dialogs-actions.c
	* app/dialogs/dialogs.c: use the new stock-id.

2006-06-16  Sven Neumann  <sven@picman.org>

	* app/pdb/picmanpluginprocedure.c (picman_plug_in_procedure_get_label):
	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	when cutting away ellipsis, also look for U+2026 HORIZONTAL ELLIPSIS.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: improved error message.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/convert-script: removed; it's barely useful
	nowadays.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c: removed the About
	dialog.  That information is available from the Procedure Browser
	and scripts should look and feel as much like plug-ins as
	possible.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-types.h (struct SFScript): renamed
	member "help" to "blurb" since that's what it is being used for
	when the script procedure is registered.

	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c: changed accordingly.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_add_script):
	use a canonical name for the automatically added run-mode parameter.
	Untabbified.

2006-06-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanlist.c (picman_list_new, picman_list_new_weak): for
	debugging purposes, set the children type as the name of the list.

2006-06-16  Sven Neumann  <sven@picman.org>

	* app/actions/debug-actions.c: no need to be extra concise here.

2006-06-16  Sven Neumann  <sven@picman.org>

	* app/actions/image-commands.c (image_convert_cmd_callback):
	always call picman_image_flush() so that the image mode radio
	buttons reflect the image state.  Attach the indexed conversion
	dialog to the shell to avoid multiple instances.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mapcolor.c (query): marked blurb for translation.

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colormap-remap.c: renamed to "Rearrange Colormap".

2006-06-16  Sven Neumann  <sven@picman.org>

	* plug-ins/rcm/rcm.c
	* plug-ins/rcm/rcm_dialog.c: renamed to "Rotate Colors"; it
	doesn't actually work on indexed images at all.

2006-06-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl

	* plug-ins/common/colormap-remap.c: added new plug-in for colormap
	manipulation written by Mukund Sivaraman.

2006-06-15  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): remove
	duplicate colors for all palette types (except for MAKE_PALETTE
	since there shouldn't be any unused colors then).  That's what
	the PDB documentation claims the function would be doing.

	* app/dialogs/convert-dialog.c: allow use of the "Remove unused
	colors" toggle for all but the optimized palette.

2006-06-15  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c (image_actions_update): improved
	code to set the image mode radio actions; set their sensitivity
	also.

	* app/actions/image-commands.c (image_configure_grid_cmd_callback):
	fixed cast to silence compiler warning.

2006-06-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_get_tab_widget): set
	the event box' window invisible so we get the right background
	with all themes.

2006-06-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: Fix sporadic crash
	resulting from previous change.

2006-06-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: As suggested by Joao,
	halt tool on changes to selection or image size.

2006-06-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/vinvert.c: another patch from Mukund that cleans
	up i18n initialization.

2006-06-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanbycolorselect.c: fix crash when changing
	threshold with no display active.

2006-06-14  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c: use radio items for the Image mode
	as suggested in bug #344871.

	* app/actions/image-commands.[ch] (image_convert_cmd_callback):
	changed accordingly.

2006-06-14  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/[many].pdb: in help texts, refer to other
	procedures using_c_syntax(). This way gtk-doc can cross-reference
	them correctly in libpicman, and app.pl will transform them
	'to-canonical-names' for PDB registering.

	* app/pdb/[many]_cmds.c
	* libpicman/[many]_pdb.c: regenerated.

2006-06-13  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanbycolorselect.[ch]: allow modifying threshold
	without having to re-click on image each time.  Fixes
	bug #126748.

2006-06-13  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanenvirontable.c (picman_environ_table_populate):
	Free the string vector returned by g_listenv().

	* libpicmanwidgets/picmanwidgets.def: Remove deprecated
	picman_prop_file_entry_new.

2006-06-13  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* menus/image-menu.xml.in: remove strong/weak undo from menu;
	still available using Shift-Ctrl-[ZY].  See bug #144854.

2006-06-13  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/vinvert.c: applied patch from Mukund Sivaraman
	which speeds up the plug-in significantly by using an optimized
	RGB <-> HSV conversion and proper region iterating. Did some more
	cleanups.

2006-06-13  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.h: doubled the size of
	the preview and adapted the dialog layout to the larger preview.

2006-06-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	Finally implemented the suggestion in bug #144854, of
	"strong" undo/redo commands that continue undoing so long
	as they only encounter visibility changes.

	* app/actions/edit-actions.c
	* app/actions/edit-commands.c
	* app/actions/edit-commands.h: added "strong undo"
	and "strong redo" commands/actions.

	* app/core/picmanimage-undo.[ch]: added functions
	picman_image_strong_undo() and picman_image_strong_redo().

	* app/core/picmanundo.[ch]: added utility function
	picman_undo_is_weak().

	* app/widgets/picmanhelp-ids.h:added id's.

	* menus/image-menu.xml.in: added to edit menu, bound to C-S-z and
	C-S-y.

	This will no doubt need tweaking, but I will consider it
	to fix bug #144854.

2006-06-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/gnomeprint.c: try not to distort
	image when printing.  Fixes bug #344547 but this
	plug-in needs a lot more work to be useful.

2006-06-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: don't autoshrink when
	there is no display; fixes crash reported by Carol.

2006-06-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.c: fix three issues identified by
	jimmac: (1) when shift or ctrl are pressed, should start a new
	rect regardless of pointer loc; (2) zoom was incorrectly affecting
	width of sensitive areas; (3) must emit "rectangle-changed" after
	keyboard-driven rectangle movement.

2006-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.[ch]: applied patch from
	Joao S. O. Bueno Calligaris that makes the plug-in work on grayscale
	images and makes it override the alpha channel (bug #340771).

2006-06-12  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanenvirontable.c (picman_environ_table_populate):
	Use g_listenv() and g_getenv() instead of looking at environ
	directly. Fixes breakage on Win32 when any (!) environment
	variable has a non-ASCII value, as environ is in system codepage,
	while we want UTF-8.

2006-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/redeye.c (remove_redeye): cleanup, use
	picman_drawable_mask_intersect(), reduced number of progress updates.

2006-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/snoise.c (solid_noise): cleanup, use
	picman_drawable_mask_intersect(), reduced number of progress updates.

2006-06-12  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.c (picman_zoom_preview_get_source):
	documentation.

	* plug-ins/common/channel_mixer.c: minor cleanup and loop unrolling.
	Introduced an inline function to avoid code duplication.

2006-06-12  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	removed check for success again; it is being checked in the for()
	loop already.

2006-06-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanellipseselecttool.c (picman_ellipse_select_tool_draw):
	Call picman_rectangle_tool_draw.

2006-06-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c: handle situations
	where the user "flips" the rectangle while modifying it.
	This solution is not perfect, but better than before.

	* app/tools/picmanrectangletool.c: remove unneeded variable.

2006-06-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleselecttool.c
	* app/tools/picmanrectangletool.c: make auto-shrink work.  Does
	the wrong thing for ellipse-select, though.

2006-06-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	Following up on previous commit, with assist from yosh.

	* app/tools/picmannewrectselectoptions.[ch]
	* app/tools/picmannewrectselecttool.[ch]: removed

	* app/tools/picmanrectangleselectoptions.[ch]: magic-moved
	from picmannewrectselectoptions.[ch]

	* app/tools/picmanrectangleselecttool.[ch]: magic-moved
	from picmannewrectselecttool.[ch]

	* app/tools/Makefile.am
	* app/tools/picman-tools.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanellipseselecttool.h
	* app/tools/picmanselectionoptions.c: change file names to
	refer to moved files.

2006-06-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	Here is the big change-over, finally.

	* app/tools/picmanrectselecttool.[ch]: removed.

	* app/tools/Makefile.am
	* app/tools/picman-tools.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanellipseselecttool.h
	* app/tools/picmannewrectselectoptions.c
	* app/tools/picmannewrectselectoptions.h
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmannewrectselecttool.h
	* app/tools/picmanselectionoptions.c
	* app/widgets/picmantoolbox.c
	* menus/image-menu.xml.in: get rid of the "new" in everything
	referring to the new rect select tool, except filenames.  This
	will wait for yosh to perform cvs-magic-foo.

	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangletool.[ch]: fix a couple of minor
	problems that popped up during testing.

2006-06-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmaneditor.c (picman_editor_add_action_button): simply
	use picman_button_new() instead of g_object_new(). Don't set the
	"use-stock" property and reordered some code. Keeps GtkButton from
	thinking that is has constructed the button's child itself and
	thus makes the function more rubust against changes in GtkButton.

2006-06-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancroptool.c
	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanrectangletool.[ch]: code cleanups

	* app/tools/picmannewrectselecttool.[ch]: try to do what
	the user intuitively expects when deciding which selection
	operation to perform.  When modifying an existing rectangle,
	always use the operation with which it was created.

2006-06-10  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	Additional simplifications for return values by using the same
	code for all INT32 PDB types. Wrong member name was being used
	for INT16 and INT8 return types. Added back if statement that
	was removed but is needed.

2006-06-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancropoptions.c: clean up code.

	* app/tools/picmannewrectselecttool.c: really remove some
	commented-out code.

	* app/tools/picmanrectangleoptions.[ch]: add "aspect-square"
	and "controls-expanded" properties.  Show "Make square" and
	"Expand from center" in options so that we don't need modifier
	keys to do this.  Place numerical entries inside an expander
	and hide them by default.

2006-06-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/core-enums.[ch]: add PicmanAlignReferenceType enum

	* app/core/picmanimage-arrange.c: support using a channel as
	reference for alignment.

	* app/tools/picmanaligntool.[ch]: support aligning with a list item,
	image, selection, active layer, active channel, or active path.
	Now similar in form and function to Inkscape Align/Distribute
	dialog.

2006-06-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanfileentry.[ch]: deprecate the PicmanFileEntry
	widget, use GtkFileChooserButton instead.

	* libpicmanwidgets/picmanpatheditor.c: undef PICMAN_DISABLE_DEPRECATED
	as long as we are still using PicmanFileEntry here.

	* libpicmanwidgets/picmanpropwidgets.[ch]: removed
	picman_prop_file_entry_new(); use picman_prop_file_chooser_button_new()
	instead.

2006-06-09  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_run_cmd): formatting.

2006-06-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/png.c
	* po/Makefile.in.in: revert changes inintentionally included
	in previous commit.

2006-06-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/core-enums.[ch]: add PICMAN_ARRANGE_FOO values
	to PicmanAlignmentType, and change CENTER to HCENTER,
	MIDDLE to VCENTER.

	* app/core/picmanimage-arrange.c: extensively rewritten
	to handle arrangement of objects, and to do the
	required sorting of lists by offset.

	* app/tools/picmanaligntool.[ch]: added ability to arrange
	groups of layers etc with constant spacing.  Also try
	to change things so that the tool aligns with the
	object that users expect intuitively.

2006-06-08  Simon Budig  <simon@picman.org>

	* plug-ins/common/sel_gauss.c: fix the EXPAND macro to make
	picky compilers happy. Fixes bug #344326, spotted by
	Eric Lamarque.

2006-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	simplified quite a bit by using the same code for all INT32 PDB
	types.

2006-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c (script_fu_eval_run):
	in case of an error, output the SIOD error message to stderr.

	* plug-ins/script-fu/siod-wrapper.c: minor cleanup.

2006-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/siod-wrapper.c: allow CSS color keywords to
	be used in place of the '(r g b) color notation.

	* plug-ins/script-fu/scripts/test-sphere.scm: documented this new
	feature.

	* plug-ins/script-fu/scripts/*.scm: replaced some colors with
	color names.

2006-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c (menu_popup): do not use
	gtk_menu_attach_to_widget() but gtk_menu_set_screen(). Menus don't
	like to be attached multiple times.

2006-06-07  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-arrange.[ch]: added, utility function for
	aligning and arranging things in an image.

	* app/core/picmanitem-align.[ch}: removed, no longer needed.

	* app/core/picmanimage-item-list.[ch] (picman_image_item_list_align):
	removed this function, no longer used.

	* app/core/Makefile.am: changes described above.

	* app/core/picmanguide.c: remove bit of cruft left accidentally.

	* app/tools/picmanalignoptions.[ch]: remove "alignment type"
	option, not needed at this point.

	* app/tools/picmanaligntool.[ch]: numerous changes, most
	importantly ability to align guides, and use them for
	alignment.  More work coming on this tool.

2006-06-07  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanguide.[ch]: add "removed" signal and associated
	paraphernalia.

	* app/core/picmanimage-guides.c (picman_image_remove_guide): call
	picman_guide_removed() to cause signal emission.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmannewrectselecttool.c: removed extra semicolon to
	fix build on Solaris (bug #344203).

2006-06-07  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/picmandisplayshell.c (picman_display_shell_expose_guide):
	fix typo, s/get_position/get_orientation/.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanguide.c: removed unused includes and property blurbs;
	fixed registration of the "id" property, it is not a PICMAN_CONFIG
	property.

2006-06-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanguide.[ch]: added picman_guide_get_ID().

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-guides.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-snap.c
	* app/core/picmanimage-undo-push.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell.c
	* app/tools/picmanmovetool.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/guides.pdb: use accessors instead of accessing
	PicmanGuide's struct members directly.

	* app/pdb/guides_cmds.c: regenerated.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/actions/error-console-actions.c:
	* app/actions/error-console-commands.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/error-console-menu.xml: added "select-all" action as
	suggested in bug #328838.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanguide.[ch]: added a setter for "orientation".

	* app/core/picmanimage-resize.c (picman_image_resize_with_layers):
	removed unused variable; use for() loops to iterate over guides
	and sample points.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanguide.[ch]: derive from GObject, we don't need any
	PicmanObject functionality here.  Declare "orientation" and "id"
	properties CONSTRUCT_ONLY, added a picman_guide_new() function and
	emit notify on position changes.

	* app/core/picmanimage-guides.c: use picman_guide_new() to instantiate
	guides.

	* app/core/picmanimage.c (picman_image_get_memsize): formatting.

2006-06-07  Michael Natterer  <mitch@picman.org>

	* app/actions/context-commands.c: cosmetic cleanup.

	* app/core/core-types.h: move the PicmanGuide typedef to the
	"misc objects" section.

	* app/tools/picmanforegroundselecttool.c: cosmetic cleanup.

	* app/tools/picmanmeasuretool.c (picman_measure_tool_cursor_update):
	use the new corner and side cursors instead of using X cursors.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): renamed local variable
	"update_cursor" to "update_sw_cursor", it has confused me too
	often...

2006-06-07  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanguide.[ch]: new files, implementing PicmanGuide as a
	PicmanObject

	* app/core/Makefile.am: add new files as sources

	* app/core/picmanimage-guides.[ch]: use the new object instead of
	defining PicmanGuide here as a struct.

	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-resize.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-snap.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell.c
	* app/tools/picmanmovetool.c
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/guides.pdb: include "core/picmanguide.h", and use
	g_object_ref/unref instead of picman_image_guide_ref/unref.

	* app/pdb/guides_cmds.c: regenerated.

2006-06-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_initialize):
	initialize guide with the option's guide value.
	(picman_rectangle_tool_notify_guide): always sync with the option's
	guide value, even when tool->display is NULL.

2006-06-06  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangle.c: added guide notification.

2006-06-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw): removed
	unused variable; other cleanups.

2006-06-06  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: cleanup, moved the guide drawing
	to a utility function.

2006-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c: minor cleanup, plugged a
	tiny memleak in script_fu_find_scripts().

2006-06-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_notify_highlight): minor cleanup.

2006-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.[ch]
	* plug-ins/script-fu/script-fu.c (script_fu_refresh_proc): applied
	a modified patch from Kevin Cozens.  Fixes bug #330981.

2006-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/decompose.c: applied a modified patch from
	Clarence Risher that adds support for a registration color
	(bug #338049).

2006-06-06  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmancolorspace.[ch] (picman_rgb_to_hsv4): added a
	const qualifier.

2006-06-06  Michael Natterer  <mitch@picman.org>

	* app/tools/picmannewrectselecttool.c
	(picman_new_rect_select_tool_cancel)
	(picman_new_rect_select_tool_rectangle_changed): flush the image
	after changing it.

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_halt): don't
	flush it here.

2006-06-06  Sven Neumann  <sven@picman.org>

	* app/actions/select-commands.c: minor cleanup.

2006-06-05  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/scale-funcs.c (scale_region_lanczos):
	fix variable declarations accidentally changed from gdouble
	to gint in revision 1.7; fixes bug #343804.

2006-06-06  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.10.

2006-06-05  Sven Neumann  <sven@picman.org>

	* Made 2.3.9 development release.

2006-06-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmandrawtool.c
	(picman_draw_tool_draw_rectangle_by_anchor)
	(picman_draw_tool_draw_arc_by_anchor): subtract 1 from outlined
	width/height instead of adding 1 to filled.

2006-06-05  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw): use
	PicmanDrawTool API, not PicmanCanvas one. Some cleanup.

2006-06-05  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/selection.pdb: fixed documentation of
	picman-selection-sharpen (bug #343911).

	* libpicman/picmanselection_pdb.c: regenerated.

2006-06-05  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]
	* app/core/picmanchannel.[ch]
	* app/core/picmanselection.c:
	* app/actions/select-commands.c: further cleaned up the patch from
	bug #88633.

2006-06-05  Karine Delvare  <edhel@picman.org>

	* app/tools/tools-enums.[ch]: added PicmanRectangleGuide enum.

	* app/tools/picmancropoptions.c
	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangletool.c: added PicmanRectangleGuide option to
	draw guides inside the rectangle. Fixes bug #323669.

2006-06-05  Michael Natterer  <mitch@picman.org>

	Applied slightly modified patch from saulgoode which allows to
	border a selection without feathering. Fixes bug #88633.

	* app/paint-funcs/paint-funcs.[ch] (border_region): added boolean
	"feather_border" parameter.

	* app/core/picmanchannel.[ch]: PicmanChannel::border(): ditto.

	* app/core/picmanselection.c: changed accordingly.

	* app/actions/select-commands.c: added a toggle to the border
	dialog and pass it to picman_channel_border().

	* tools/pdbgen/pdb/selection.pdb: pass TRUE here.

	* app/pdb/selection_cmds.c: regenerated.

2006-06-05  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.[ch]: removed enum PicmanRectangleMode.

	* app/tools/picmanrectangletool.[ch]: added virtual function
	PicmanRectangleTool::cancel(). Added public wrapper for it. Removed
	coordinates paramaters from picman_rectangle_tool_execute(). Removed
	picman_rectangle_tool_response(), need to call either execute() or
	cancel() now. Added picman_rectangle_tool_halt() which disconnects
	the tool from the display without canceling it.

	* app/tools/picmancroptool.c: changed accordingly.

	* app/tools/picmannewrectselecttool.c: moved the rectangle creating
	code from the execute() implementation to the new function
	picman_new_rect_select_tool_rect_select(). Added cancel()
	implementation which pops the remembered undo step if
	appropriate. Call the new rect_select() wrapper from
	rectangle_changed() so we don't create the rectangle on both
	button_release *and* execute(), breaking modifiers and stuff.

2006-06-05  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_create): connect to "expose-event" with
	G_SIGNAL_CONNECT_AFTER so that the text is rendered on the image.

2006-06-05  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: added back support for animated splashes but
	continue to use the optimized code for static splash images.

2006-06-05  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.[ch]
	* app/app_procs.c: always migrate old user settings during user
	installation.

	* app/dialogs/user-install-dialog.[ch]: don't ask questions and
	only show the dialog in case of an error.

2006-06-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: formatting.

2006-06-04  Seth Burgess <sjburges@picman.org>

	* plug-ins/common/png.c: fixed file_png_set_defaults; wrong # of
	  return values, missing "set" if/else set, wrong set param count,
	  and off by one error in the parameter indexes.  Thanks to Kevin
	  on helping track these down.

2006-06-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c:
	* app/tools/picmannewrectselecttool.c: enable canceling of
	current action by holding down mouse button 3.

2006-06-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanscaletool.c (picman_scale_tool_size_notify):
	strcmp() the property name, so we don't change the size on random
	property changes. Fixes the tool reverting to the previous
	width/height on each new transform (destroying the previous size
	box causes it to emit stuff like "notify::visible").

	(picman_scale_tool_prepare): additionally, disconnect from the size
	box before destroying it (paranoia).

2006-06-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmannewrectselectoptions.c: turn highlighting off by
	default.

2006-06-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_draw):
	draw anchors in corners; clean up code a bit.

	* app/tools/picmannewrectselecttool.c: actually remove some code
	previously commented out.

2006-06-04  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_callback): fix typo so the "notify"
	signal doesn't stay blocked.

	* app/dialogs/preferences-dialog.c: added "Reset" button which
	resets all prefs values to their defaults. Fixes bug #342112.

2006-06-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.[ch]: add new signal
	"rectangle-changed" and method rectangle_changed.
	Emit them on button release and when dimensions are
	changed in controls.

	* app/tools/picmannewrectselecttool.c: use rectangle_changed
	method to change selection, undoing previous change if
	necessary.

2006-06-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanthumbbox.c (picman_thumb_box_new): changed
	mnemonic from "_Preview" to "Pr_eview" because the GTK+ HEAD
	file chooser has a "_Places" mnemonic now.

	* app/widgets/picmancomponenteditor.c: minor cleanup.

2006-06-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorframe.c (picman_color_frame_set_color): use
	picman_rgba_distance() instead of picman_rgb_distance(), so alpha
	changes update the color frame too.

2006-06-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: renamed
	picman_image_coords_in_active_drawable() to
	picman_image_coords_in_active_pickable() and added boolean
	"sample_merged" and "selected_only" parameters. Use floor()
	instead of ROUND(), we want to round to the actual pixel, not to
	the nearest pixel boundary.

	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolortool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmantransformtool.c: changed accordingly. Removed
	quite some duplicated code which checked sample_merged and the
	mask value at the cursor location.

	* app/tools/picmanbycolorselecttool.c: use the hand tool cursor,
	there's also a hand in the toolbox icon. Fixed cursor_update()
	function to set the bad modifier when there is no pickable pixel
	at the cursor loction.

	* app/tools/picmanfuzzyselecttool.c: added cursor_update()
	implementation which does the same as by_color_select's one.

	* app/tools/picmanselectiontool.c
	(picman_selection_tool_cursor_update): don't override the bad
	modifier which was set by a subclass' cursor_update().

2006-06-03  Michael Natterer  <mitch@picman.org>

	Make better use of the available 32x32 pixels so the cursors look
	less crowded:

	* cursors/cursor-corner-*.png
	* cursors/cursor-side-*.png
	* cursors/xbm/cursor-corner-*.xbm
	* cursors/xbm/cursor-side-*.xbm: made the crosshair lines one
	pixel longer.

	* cursors/modifier-join.png
	* cursors/modifier-pattern.png
	* cursors/xbm/modifier-join-mask.xbm
	* cursors/xbm/modifier-join.xbm
	* cursors/xbm/modifier-pattern-mask.xbm
	* cursors/xbm/modifier-pattern.xbm: moved one pixel to the right.

	* cursors/tool-*.png
	* cursors/xbm/tool-*.png: moved closer to the bottom right corner.

	* cursors/picman-tool-cursors.xcf: ditto.

2006-06-03  Michael Natterer  <mitch@picman.org>

	* app/tools/picmannewrectselecttool.c
	(picman_new_rect_select_tool_button_press): check for function ==
	INACTIVE, not CREATING || EXECUTING when checking whether to start
	moving.

	* app/tools/picmanselectiontool.c (picman_selection_tool_oper_update):
	changed modifiers so alt+ctrl does cut+float+move and alt+shift
	does copy+float+move.

2006-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: move statically declared
	variables into "private" struct.

2006-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanbase/Makefile.am: include picmancpuaccel.h in
	libpicmanbaseinclude_HEADERS; missed in Sven's changes.

2006-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmannewrectselecttool.[ch]: use RECT_INACTIVE state,
	(but doesn't seem to do anything).  More importantly, change
	logic so that button_release executes the tool, and button
	release undo's if appropriate.

2006-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.[ch]: add new function RECT_INACTIVE
	for cases where no rectangle exists.  This may take some
	tweaking to get right.

2006-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_button_press):
	if function is RECT_CREATING, start a new rectangle.

	* app/tools/picmannewrectselecttool.c: remove g_printerr statement that
	mitch added for debugging.

2006-06-02  Michael Natterer  <mitch@picman.org>

	* cursors/Makefile.am
	* cursors/cursor-corner-bottom-left.png
	* cursors/cursor-corner-bottom-right.png
	* cursors/cursor-corner-top-left.png
	* cursors/cursor-corner-top-right.png
	* cursors/cursor-side-bottom.png
	* cursors/cursor-side-left.png
	* cursors/cursor-side-right.png
	* cursors/cursor-side-top.png
	* cursors/xbm/cursor-corner-bottom-left-mask.xbm
	* cursors/xbm/cursor-corner-bottom-left.xbm
	* cursors/xbm/cursor-corner-bottom-right-mask.xbm
	* cursors/xbm/cursor-corner-bottom-right.xbm
	* cursors/xbm/cursor-corner-top-left-mask.xbm
	* cursors/xbm/cursor-corner-top-left.xbm
	* cursors/xbm/cursor-corner-top-right-mask.xbm
	* cursors/xbm/cursor-corner-top-right.xbm
	* cursors/xbm/cursor-side-bottom-mask.xbm
	* cursors/xbm/cursor-side-bottom.xbm
	* cursors/xbm/cursor-side-left-mask.xbm
	* cursors/xbm/cursor-side-left.xbm
	* cursors/xbm/cursor-side-right-mask.xbm
	* cursors/xbm/cursor-side-right.xbm
	* cursors/xbm/cursor-side-top-mask.xbm
	* cursors/xbm/cursor-side-top.xbm: new cursors for edge and corner
	resizing. They perfectly align with the small crosshair and can be
	used together with tool cursors and cursor modifiers.

	* cursors/picman-tool-cursors.xcf: add them here too.

	* app/widgets/widgets-enums.h: add them to the PicmanCursorType enum.

	* app/widgets/picmancursor.c: add them here too.

	* app/display/picmandisplayshell-cursor.c: treat them like the small
	crosshair (don't replace them by the small crosshair but use them
	as-is). Also allow the bad modifier with the large crosshair.

	* app/tools/picmanrectangletool.c
	(picman_rectangle_tool_cursor_update): use the new cursors. Don't
	call picman_tool_set_cursor() here.

	(picman_rectangle_tool_response): reset "function" to RECT_CREATING
	when resetting the tool.

	* app/tools/picmanselectiontool.[ch] (struct PicmanSelectionTool):
	added boolean member "allow_move" which defalts to TRUE.

	(picman_selection_tool_oper_update): don't move masks, floating
	selections or anything when "allow_move" is FALSE. Changed
	behavior of click inside a selection to simply create a new
	selection, need to press alt+shift now to drag-float the
	selection. Please test this, it's a pretty fundamental change!

	(picman_selection_tool_cursor_update): use the tool's configured
	cursor instead of always PICMAN_CURSOR_MOUSE, so this function can
	be called after picman_rectangle_tool_cursor_update() to add the
	plus, minus etc. modifiers.

	* app/tools/picmannewrectselecttool.c: implement
	PicmanTool::cursor_update() and call
	picman_rectangle_tool_cursor_update() from there. Chain up to get
	the plus, minus etc. modifiers added.

	Re-enble selection moving:

	(picman_new_rect_select_tool_oper_update): set PicmanSelectionTool's
	"allow_move" to FALSE unless the rectangle tool is in an idle
	state.

	(picman_new_rect_select_tool_button_press): allow a selection moving
	to be started if the rectangle tool is idle. Fall back to starting
	a rect select if picman_selection_tool_start_edit() returned FALSE.

2006-06-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mkgen.pl: always look at $plugins{$_}->{cflags}.

	* plug-ins/common/plugin-defs.pl: use MMX_EXTRA_CFLAGS for the
	selective gaussian blur plug-in.

	* plug-ins/common/Makefile.am: regenerated.

2006-06-02  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanparasite.[ch]: hide the PicmanParamSpecParasite
	struct like we do with other custom param specs.

2006-06-02  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch]
	* libpicman/picman.def: removed picman_use_cpu_accel() again. libpicman
	handles this transparently by calling picman_cpu_accel_set_use().

2006-06-02  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.c (picman_composite_use_cpu_accel):
	need to test for PICMAN_COMPOSITE_OPTION_NOEXTENSIONS.

	* libpicman/picman.c (picman_config): call picman_cpu_accel_set_use() from
	here, not in picman_main().

	* plug-ins/common/sel_gauss.c: applied patch from Loren Merritt
	that adds MMX code to boost the plug-in speed (bug #342860).

2006-06-02  Sven Neumann  <sven@picman.org>

	Moved the CPU detection code to libpicmanbase (see bug #342860):

	* app/base/Makefile.am
	* app/base/cpu-accel.[ch]
	* app/base/test-cpu-accel.c: removed here...

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmancpuaccel.[ch]

	* libpicmanbase/test-cpu-accel.c: ... and added here again with
	some API changes.

	* app/composite/Makefile.am
	* app/composite/make-installer.py: changed accordingly.

	* app/composite/picman-composite-*-installer.c: regenerated.

	* libpicman/picman.c (picman_main): call picman_set_use_cpu_accel().

	* libpicmanbase/picmanbase.def: updated.

2006-06-01  Michael Natterer  <mitch@picman.org>

	* cursors/Makefile.am
	* cursors/modifier-bad.png
	* cursors/xbm/modifier-bad-mask.xbm
	* cursors/xbm/modifier-bad.xbm: new "bad" cursor modifier.
	Replaces the "bad" cursor.

	* cursors/picman-tool-cursors.xcf: added it here too.

	* app/widgets/widgets-enums.h: added PICMAN_CURSOR_MODIFIER_BAD.

	* app/widgets/picmancursor.c: add the bad modifier. Leave the bad
	cursor there for now.

	* app/display/picmandisplayshell-callbacks.c
	* app/tools/picmanaligntool.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolortool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: use the modifier instead of the
	cursor. Fixes hotspot jumping when switching between normal and
	bad cursors. The changed cursor_update() functions even make more
	sense IMHO. Fixes bug #158407.

2006-06-01  Sven Neumann  <sven@picman.org>

	Added basic framework for plug-ins to access the use_cpu_accel
	configuration (bug #342860):

	* app/composite/picman-composite.[ch]: added new function
	picman_composite_use_cpu_accel().

	* libpicmanbase/picmanprotocol.[ch]: added use_cpu_accel to the config
	message.

	* app/plug-in/picmanpluginmanager-call.c: pass the return value of
	picman_composite_use_cpu_accel() for config.use_cpu_accel.

	* libpicman/picman.[ch]: make the config value accessible by means of
	a new function picman_use_cpu_accel().

	* libpicman/picman.def: updated.

2006-06-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sel_gauss.c: applied patch from Loren Merritt
	that replaces the floating-point implementation of selective
	gaussian blur with a fixed-point version (bug #342860).

2006-05-31  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.[ch]: add "constrain" property to
	specify whether to clip at image bounds when computing dimensions.

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c: set "constrain" to TRUE.

	* app/tools/picmanellipseselecttool.c: set "constrain" to FALSE.

	Hopefully fixes bug #329817.

2006-05-31  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorscale.c: removed #define SHADOW 1, it's
	not a constant value. Use the GtkRange::trough-border style
	property instead.

2006-05-30  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-parse.c: protect against broken XMP blocks
	using rdf:Alt instead of rdf:Seq.  Fixes bug #343315.

	* plug-ins/metadata/xmpdump.c (main): call g_set_prgname() to get
	better messages from glib.

	* data/images/picman-splash.png: new splash screen, waiting for the
	old animation feature to be restored.

2006-05-30  Michael Natterer  <mitch@picman.org>

	Honor active components when pasting. Fixes bug #150845:

	* app/core/picmanlayer-floating-sel.c (floating_sel_composite):
	don't temporarily set all image components to active while
	compositing.

	* app/core/picmanimage.c (picman_image_set_component_active):
	relax()/rigor() the floating selection around setting the "active"
	flag. Also make sure the projection is updated correctly.

2006-05-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.c (picman_data_editor_name_activate)
	* app/widgets/picmandatafactoryview.c
	(picman_data_factory_view_tree_name_edited): strip the newly
	entered name from whitespace and reject empty names.

2006-05-30  Manish Singh  <yosh@picman.org>

	* app/batch.c (batch_run): PICMAN_BATCH_INTERPRETER can be set in
	the environment to override the default batch interpreter procedure.

	* plug-ins/pypicman/plug-ins/happy-valley-relief.py: basic python
	code evaluator function.

	* plug-ins/pypicman/plug-ins/Makefile.am: add above file.

2006-05-30  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: Other code places should allow
	menu paths to be None too.

2006-05-30  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: Allow menu paths to be None.

2006-05-30  Manish Singh  <yosh@picman.org>

	* app/file/picmanrecentlist.c: #define _GNU_SOURCE instead of
	_SVID_SOURCE, so we get all the declarations we need. Fixes
	bug #342390.

2006-05-29  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmanpixmap.c: #include "config.h"

2006-05-29  Manish Singh  <yosh@picman.org>

	* app/errors.c
	* app/main.c
	* app/file/picmanrecentlist.c
	* libpicman/picman.c
	* libpicmanbase/picmansignal.c
	* modules/cdisplay_lcms.c
	* modules/cdisplay_proof.c
	* modules/controller_midi.c
	* plug-ins/common/gqbist.c
	* plug-ins/metadata/xmp-schemas.h: miscellaneous fixes for building
	with -ansi -pedantic. Mostly #define _FOO_SOURCE stuff. Thanks to
	Daniel Richard G. for the patch. Fixes bug #342390.

2006-05-30  Tor Lillqvist  <tml@novell.com>

	* libpicmanwidgets/picmanwidgets.def: Sync.

2006-05-29  Sven Neumann  <sven@picman.org>

	* configure.in: use PANGO_DISABLE_DEPRECATED for pango < 0.13.0.

	* app/text/picmantext-vectors.c: added const qualifiers to the
	FT_Vector parameters of the FT_Outline_Funcs.

2006-05-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c
	(picman_dialog_factory_dialog_new_internal): code cleanup; only call
	gtk_window_present() if called with present == TRUE.

2006-05-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushgenerated.c (picman_brush_generated_load): don't
	choke on brush files with empty names (bug #343140).
	(picman_brush_generated_save): warn about brushes with empty names.

2006-05-29  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandock.c (picman_dock_key_press_event): make sure
	that text widgets get all key events first. Fixes bug #301006.

2006-05-29  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-server.c: suppress progress popups
	by installing progress handlers that do nothing (bug #317498).

	* plug-ins/script-fu/script-fu-interface.c: formatting.

2006-05-29  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/channel.pdb (channel_combine_masks): push a
	channel undo. Fixes bug #343026.

	* app/pdb/channel_cmds.c: regenerated.

2006-05-29  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/presets.c: check for NULL before using a
	string pointer. Fixes bug #343121.

2006-05-28  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/pnm.c: applied patch from Martin Collins which
	adds PBM (bitmap) support. Fixes bug #167578. Did some additional
	cleanups and sprinkled some picman_progress_update(1.0).

2006-05-28  Michael Natterer  <mitch@picman.org>

	Applied patch from David Gowers which adds actions to select
	palette and colormap colors. Modified the patch quite a bit.
	Fixes bug #130123.

	* app/widgets/picmancolormapeditor.[ch]
	* app/widgets/picmanpaletteeditor.[ch]: add functions get_index()
	which gets the currently selected color's index (optionally the
	index of a passed color), set_index() which sets the selected
	color by index, and max_index() which returns the maximum possible
	color index.

	* app/dialogs/dialogs-constructors.c: changed accordingly.

	* app/actions/context-actions.c
	* app/actions/context-commands.[ch]: actions and callbacks which
	use the new functions.

2006-05-28  Akkana Peck  <akkana@cvs.gnome.org>

	* plug-ins/script-fu/scripts/reverse-layers.scm: revert
	previous change: allow layers without alpha to be moved up.

2006-05-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette-import.[ch]: added support for extracting
	colors from the selected pixels only.

	* app/dialogs/palette-import-dialog.c: added "Sample merged" and
	"Selected Pixels only" toggles. Fixes bug #316212. Cleaned up the
	code quite a bit.

2006-05-28  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolorpickertool.c (picman_color_picker_tool_picked):
	removed all code except info dialog updating and chain up instead.

	* app/tools/picmancolortool.c (picman_color_tool_real_picked): newly
	added default implementation. Also updates the colormap dialog and
	picks into a palette.

	* app/tools/picmanpainttool.c (picman_paint_tool_color_picked):
	removed. The default impl. does this and much more now. Hopefully
	fixes bug #320660.

2006-05-27  Akkana Peck  <akkana@cvs.gnome.org>

	* plug-ins/script-fu/scripts/reverse-layers.scm: if any layers
        are opaque, make them transparent when reversing. Current CVS
        allows moving opaque layers above the bottom, but that might change.

2006-05-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-crop.c (picman_image_crop_guess_bgcolor):
	remove code duplication, cleanup.

2006-05-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.h: fix spacing broken by tab removal.

2006-05-27  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/enumcode.pl: cast the return value of
	picman_enums_get_type_names() to (const gchar **) to fix compiler
	warning.

	* libpicman/picmanenums.c.tail: regenerated.

2006-05-26  Manish Singh  <yosh@picman.org>

	* picman.pc.in: define datarootdir, so we work with newer autoconf.

2006-05-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/reverse-layers.scm: new script from
	Akkana Peck which reverses the layers in an image.

2006-05-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/dicom.c: applied patch from Dov Grobgeld
	with several fixes for dicom loading, fixes bug #163256.

2006-05-26  Michael Natterer  <mitch@picman.org>

	* app/dialogs/palette-import-dialog.c: set the "Number of colors"
	and "Interval" widgets insensitive for indexed images.
	Fixes bug #342970.

2006-05-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/png.c: moved "Load defaults" and "Save defaults"
	buttons to a separate line. Fixes bug #310291.

2006-05-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/picmanexif.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.h
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h: fix multiply-defined linker symbols;
	fixes bug #342456.

2006-05-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/copy-visible.scm: use canonical
	procedure names in the help string.

2006-05-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h (SWAP_PATH_BLURB, TEMP_PATH_BLURB):
	use "folder" in place of "directory".

	* app/dialogs/preferences-dialog.c: use GtkFileChooserButtons for
	the "swap-path" and "temp-path" preferences and a simple GtkEntry
	for the "web-browser" preference.

	* modules/cdisplay_proof.c: use a GtkFileChooserButton instead of
	a PicmanFileEntry widget.

2006-05-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_tool_list_thaw): the
	default tool is the paintbrush, not rect select.

	* app/tools/picman-tools.c (picman_tools_register): attach the default
	visibility state to the tool_info.

	* app/actions/tools-commands.c (tools_reset_cmd_callback): use the
	attached boolean instead of reimplementing the default visibility
	logic.

2006-05-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/raw.c (load_dialog): use a GtkFileChooserButton
	instead of a PicmanFileEntry widget.

	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h: use GtkFileChooserButton
	for SF_FILENAME and SF_DIRNAME parameters.

2006-05-24  Sven Neumann  <sven@picman.org>

	* app/dialogs/palette-import-dialog.c: use a GtkFileChooserButton
	instead of a PicmanFileEntry widget.

	* data/palettes/Tango.gpl (Name): removed "Palette" from name.

2006-05-24  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpatheditor.[ch]: renamed a parameter, updated
	gtk-doc comment.

2006-05-24  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanfileentry.c: use GTK_STOCK_OPEN instead of
	"..."  to label the "Browse" button. This makes the widget more
	similar to the GtkFileChooserButton and addresses bug #342749.

2006-05-24  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanpdb.c (picman_pdb_real_register_procedure)
	(picman_pdb_real_unregister_procedure): use g_hash_table_replace()
	instead of g_hash_table_insert() and make sure the used key is
	always the name of the first procedure in the list.
	Fixes bug #342578.

	(It's actually a miracle that only the PDB browser crashed, and
	not PICMAN, since we were using pointers to g_free()'d memory as
	keys when different plug-ins registered procedures with the same
	name)

2006-05-23  Sven Neumann  <sven@picman.org>

	* configure.in: improved output for missing libasound.

2006-05-23  Michael Natterer  <mitch@picman.org>

	Fix for bug #333156:

	* app/paint-funcs/paint-funcs-types.h (enum CombinationMode):
	added value COMBINE_INTEN_A_INDEXED.

	* app/paint-funcs/paint-funcs.c
	(combine_inten_a_and_indexed_pixels): new function which
	implements the new CombinationMode.

	(combine_sub_region)
	(combine_regions): added the needed bits to call the new function.

	* app/core/picmanprojection-construct.c (project_indexed): added
	mask PixelRegion parameter since that's supported by paint-funcs
	now, replaced g_warning() about unimplemented combine type
	by call to combine_regions(..., COMBINE_INTEN_A_INDEXED).

	(picman_projection_construct_layers): pass the mask to
	project_indexed() and removed comments about not supporting it.

2006-05-23  Karine Delvare  <edhel@picman.org>

	* app/core/picmancontext.c
	* app/tools/picman-tools.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectselecttool.c
	* app/widgets/picmantoolbox.c
	* menus/image-menu.xml.in: replace old rect select by new in the
	toolbox.

2006-05-23  Karine Delvare  <edhel@picman.org>

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.[ch]: eek, I broke the build.

2006-05-23  Karine Delvare  <edhel@picman.org>

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c: revert rect select execution on
	leaving, revert auto-conversion to selection.

2006-05-23  Karine Delvare  <edhel@picman.org>

	* app/tools/picmannewrectselecttool.c: don't execute
	picman_rectangle_tool_response() twice. Fixes bug #342506.

2006-05-23  Sven Neumann  <sven@picman.org>

	It makes more sense to have PicmanData::dirty indicate a name change
	than to invalidate the previews whenever the name changes.

	* app/core/picmandata.c: call picman_object_name_changed() from
	picman_data_real_dirty() instead of implementing
	PicmanObject::name-changed and calling picman_data_dirty() from there.

	* app/core/picmanbrushclipboard.c
	* app/core/picmanpalette.c
	* app/core/picmanpatternclipboard.c: call picman_data_dirty() in place
	of picman_object_name_changed().

	* app/core/picmanbrushgenerated.c (picman_brush_generated_dirty):
	chain up unconditionally.

2006-05-23  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: add the drawable's offset
	to the x and y returned by picman_drawable_mask_intersect() because
	all transform functions expect image coordinates.
	Fixes bug #342548.

	* app/pdb/drawable_transform_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2006-05-23  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantransformtool.c (picman_transform_tool_dialog_update):
	don't call the virtual function if there is no dialog.

	(picman_transform_tool_recalc): show the dialog here after updating it.

	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c (dialog_update): don't show it here.

2006-05-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_control): remove
	some #if 0'ed cruft.

2006-05-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.[ch]: re-apply heavily modified patch
	from Michael Schumacher which shows the clone source even while
	not painting. Fixes bug #324224. Did some additional cleanup.

2006-05-22 Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/png.c: fix remapping of colors when
	saving IndexedA images; fixes bug #303864.

2006-05-22  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-commands.c (plug_in_collect_image_args):
	removed debugging output.

	* app/tools/picmanscaletool.c: create the PicmanSizeBox in the
	prepare() method to make entering relative sizes work.

2006-05-22  Sven Neumann  <sven@picman.org>

	* app/tools/picmanscaletool.c (picman_scale_tool_prepare): initialize
	width, height and keep-aspect properties of the size box.

2006-05-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c: revert previous change. Tools must
	not do anything essential in cursor_update(), and poking in the
	PicmanClone struct is a bad hack. Will look into this.

2006-05-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanclonetool.c:  apply patch from Michael
	Schumacher to show clone source even while not
	painting; fixes bug #324224.

2006-05-21  Michael Natterer  <mitch@picman.org>

	* app/tools/tools-enums.h (enum PicmanToolAction): prefix with
	PICMAN_TOOL_ACTION_

	* app/display/picmandisplay.c
	* app/display/picmandisplayshell.c
	* app/tools/picmanaligntool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancolortool.c
	* app/tools/picmancroptool.c
	* app/tools/picmandrawtool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanfreeselecttool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantexttool.c
	* app/tools/picmantool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c
	* app/tools/tool_manager.c: changed accordingly. Introduce a
	common style for PicmanTool::control()'s switch() block. Some
	minor cleanups.

2006-05-21  Michael Natterer  <mitch@picman.org>

	* app/tools/tool_manager.c (tool_manager_image_clean_dirty): don't
	try to reset the active tool by destroying and re-creating it
	because this doesn't work while picman->busy is TRUE. Call
	tool_manager_control_active(HALT) instead, which is the right way
	to do it anyway. Fixes bug #330083.

	Sprinkled some local variables all over the place to get rid of a
	gazillion tool_manager->active_tool.

2006-05-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanaligntool.c: get rid of "dispose" method, use
	tool-control-halt to shut things down instead.

2006-05-21  Michael Natterer  <mitch@picman.org>

	One of the following changes fixes a crash on exit when there is a
	cut buffer and a clipboard manager is runnig. I don't care which,
	since they are all the right thing to do:

	* app/widgets/picmandialogfactory.c (picman_dialog_factory_finalize):
	don't remove the factory from the hash table of all factories here...

	(picman_dialog_factory_dispose): ...but here. Use the right key for
	the toolbox factory.

	(picman_dialog_factories_set_busy)
	(picman_dialog_factories_unset_busy): check the return value of
	g_type_class_ref() before using it.

	Unrelated:

	(picman_dialog_factory_dispose): free the list of open dialogs here,
	not in dispose(). Don't leak all the factory's session infos.

2006-05-21  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanimage-item-list.[ch]: new files with functions to
	translate, flip, rotate, transform and align a list of items
	inside an undo group.

	(picman_image_item_list_get_list): returns a list of items matching
	any combination of PicmanItemTypeMask and PicmanItemSet.

	* app/core/picmanitem.[ch]: added new function picman_item_is_in_set().

	* app/core/picmanitem-linked.[ch]: use the new functions. Removed
	picman_item_linked_get_list().

	* app/tools/picmaneditselectiontool.c: use
	picman_image_item_list_get_list() instead of
	picman_item_linked_get_list().

	* app/core/picmanimage-resize.c
	* app/tools/picmanaligntool.c: use the new functions instead of
	creating and iterating the lists manually.

2006-05-20  Manish Singh  <yosh@picman.org>

	Fixes to address -ansi -pedantic compilation (bug #342390).
	Thanks goes to Daniel Richard G. for noticing and suggesting
	fixes.

	* libpicmanbase/picmansignal.c: #include "config.h" and define
	__POSIX_SOURCE for sigaction stuff.

	* app/base/tile-swap.c (tile_swap_test): use more portable
	S_IRUSR and S_IWUSR, instead of S_IREAD and S_IWRITE.

	* plug-ins/common/ripple.c
	* plug-ins/imagemap/imap_main.c: use C89 comments.

	* plug-ins/Lighting/lighting_preview.h: don't define spin widget
	variables here...

	* plug-ins/Lighting/lighting_ui.[ch]: ... and instead take care
	of them here.

2006-05-19  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanwidgets.c (picman_coordinates_callback):
	use ROUND() to prevent incorrect chainbutton logic.  Fixes
	bug #336259.

2006-05-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanscaletool.c (picman_scale_tool_dialog_update,
	picman_scale_tool_size_notify): use the same rounding to determine
	width and height from the TransInfo struct.

2006-05-19  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/vpropagate.c: swap meanings of "dilate" and
	"erode"; fixes bug #156545.

2006-05-19  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/tga.c: gracefully handle incorrect alpha info in
	header; fixes bug #306675.

2006-05-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem-linked.h: remove enum PicmanItemLinkedMask...

	* app/core/core-enums.[ch]: ...and add it here as PicmanItemTypeMask.
	Renamed enum PicmanImageResizeLayers to PicmanItemSet.

	* app/core/picmanitem-linked.[ch]
	* app/core/picmanimage-resize.[ch]
	* app/dialogs/resize-dialog.[ch]
	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/tools/picmaneditselectiontool.c: changed accordingly.

2006-05-19  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/image.pdb: do not use enum values in C syntax
	to describe the image mode.

	* app/pdb/convert_cmds.c
	* app/pdb/image_cmds.c
	* libpicman/picmanconvert_pdb.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-05-19  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: turn c_style_procedure_names() in
	$proc->{help} into 'canonical-procedure-names'.

	* tools/pdbgen/pdb/color.pdb: std_pdb_deprecated() expects
	canonical procedure names.

	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/drawable_transform_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/progress_cmds.c: regenerated.

2006-05-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmantransformoptions.[ch]: removed one of the two
	constrain properties.

	* app/tools/picmanrotatetool.c
	* app/tools/picmantransformtool.c: changed accordingly.

	* app/tools/picmanscaletool.c: sync "constrain" with the size-box's
	"keep-aspect" property.

2006-05-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansizebox.c: connect to the chain-button and
	update the "keep-aspect" property when it is toggled.

2006-05-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanaligntool.c (picman_align_tool_register): actually
	use the new tool icon.

2006-05-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/dialogs/file-save-dialog.c: make sure to disconnect
	callback added in previous change.

2006-05-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/dialogs/file-save-dialog.c: make sure dialog has
	not been destroyed when setting sensitive; fixes
	bug #322978.

2006-05-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanparamspecs-desc.c: use the enum's name instead of
	the nick, strip the "PICMAN_" prefix and canonicalize it.

2006-05-18  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c (script_fu_run): reverted one
	aspect of the last change and always load the scripts again.

2006-05-18  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/app.pl
	* tools/pdbgen/lib.pl: removed code that used to fiddle with the
	argument descriptions.

	* tools/pdbgen/pdb/*.pdb: removed %%desc%% placeholders, added some
	missing argument descriptions.

	* app/pdb/*_cmds.c
	* libpicman/picmandrawabletransform_pdb.c
	* libpicman/picmanfloatingsel_pdb.c
	* libpicman/picmangradient_pdb.c
	* libpicman/picmanpainttools_pdb.c: regenerated.

	* app/core/Makefile.am
	* app/core/picmanparamspecs-desc.[ch] (picman_param_spec_get_desc):
	new function that creates a parameter description for the PDB.

	* app/pdb/picmanpdb-query.c
	* app/pdb/procedural_db_cmds.c: use the new function to create the
	descriptions on the fly.

2006-05-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanhuesaturationtool.c: add tooltips to all hue
	partition radio buttons.

	* app/tools/picmantextoptions.[ch]
	* app/tools/picmanvectoroptions.[ch]: add the widgets that are
	needed by the tools as members to the options structs instead of
	attaching them with g_object_set_data().

	* app/tools/picmantexttool.c
	* app/tools/picmanvectortool.c: access the struct members instead of
	using g_object_get_data().

2006-05-17  Kevin Cozens  <kcozens@cvs.gnome.org>

	* configure.in: Added quotes in two AM_CONDITIONAL lines to avoid
	complaints of "test: too many arguments" when running ./configure.

2006-05-18  Michael Natterer  <mitch@picman.org>

	* app/tools/picman-tools.c (picman_tools_init): move the align tool
	after the move tool.

2006-05-17  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* themes/Default/images/tools/stock-tool-align-16.png
	* themes/Default/images/tools/stock-tool-align-22.png
	* libpicmanwidgets/picmanstock.c
	* libpicmanwidgets/picmanstock.h
	* themes/Default/images/Makefile.am: add new (ugly) icon
	for alignment tool.

	* app/tools/picmanaligntool.c: use the new icon; change
	"pressed" to "clicked" for buttons.

2006-05-17  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_set_vectors): use
	the same method as the newly added text tool code for finding a
	suitable display for the vectors.

2006-05-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushclipboard.c
	(picman_brush_clipboard_buffer_changed)
	* app/core/picmanpatternclipboard.c
	(picman_pattern_clipboard_buffer_changed): limit the size of
	clipboard brushes and patterns to 512x512 pixels to prevent OOM
	conditions when copying from huge drawables.

2006-05-17  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanaligntool.[ch]: major change in ui, to make
	this tool behave like alignment tools found in vector apps.
	now you select items by clicking or drawing a rubber-band
	rectangle, add items by holding down shift, and then press
	a button to align all the selected items.

2006-05-17  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-commands.c: moved the collection of plug-in
	args to a utilty function. Add another function that is called
	when the plug-in lives in <Brushes>, <Palettes> etc. and pass the
	active object's name to the plug-in.

	* plug-ins/pypicman/plug-ins/Makefile.am
	* plug-ins/pypicman/plug-ins/palette-offset.py
	* plug-ins/pypicman/plug-ins/palette-sort.py
	* plug-ins/pypicman/plug-ins/palette-to-gradient.py: added new
	scripts written by Joao S. O. Bueno Calligaris and fixed by Carol
	Spears. Changed them myself again. The stuff doesn't work as
	expected because python-fu has too much asumptions in its
	register() code, and the sort script doesn't implement all modes
	of Adrian's palette sorting perl script. Addresses bug #104639.

2006-05-17  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbrushclipboard.c
	(picman_brush_clipboard_buffer_changed)
	* app/core/picmanpatternclipboard.c
	(picman_pattern_clipboard_buffer_changed): remove calls to
	picman_data_dirty() because the emission of "name-changed" takes
	care of that.

2006-05-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushclipboard.c
	(picman_brush_clipboard_buffer_changed)
	* app/core/picmanpatternclipboard.c
	(picman_pattern_clipboard_buffer_changed): emit "name-changed" so that
	the description is being updated.

2006-05-17  Michael Natterer  <mitch@picman.org>

	* app/core/picman.c (picman_real_initialize): add a clipboard pattern
	to the pattern factory (forgot to commit this file).

2006-05-17  Manish Singh  <yosh@picman.org>

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in
	* po-tips/Makefile.in.in: revert previous changes, it doesn't
	look straightforward to change these without bumping up the
	intltool dependency.

2006-05-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanresolutionentry.c: synced function names with
	the header file.

	* libpicmanwidgets/picmanwidgets.def: added missing entries.

2005-05-16  Manish Singh  <yosh@picman.org>

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in
	* po-tips/Makefile.in.in: synchronized with po/Makefile.in.in.

	* picmantool-2.0.in
	* picmantool-win32.c.in: add reference to datarootdir.

2006-05-16  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanpatternclipboard.[ch]: new PicmanPattern subclass
	that auto-updates its contents from picman->global_buffer.

	* app/core/picman.c (picman_real_initialize): add a clipboard pattern
	to the pattern factory.

	* app/widgets/picmanaction.c (picman_action_set_proxy): replace the
	PicmanView by a new one if the viewable type changes, instead of
	running into a warning (didn't happen before because this is only
	used for imagefiles and patterns, which didn't have subclasses).

2006-05-16  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: check if the tool has a display
	before using it

2006-05-16  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.[ch]: implement copy_color() and
	copy_color_pixels() which copy only the color bytes into a dest
	that has one byte less than src. Renamed component_pixels() to
	copy_component_pixels().

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmanbrushclipboard.[ch]: new PicmanBrush subclass that
	auto-updates its contents from picman->global_buffer.

	* app/core/picman.c (picman_real_initialize): add a clipboard brush to
	the brush factory. Fixes bug #111082.

2006-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/*/*.c: declared PicmanPlugInInfo and PicmanParamDef arrays
	as const.

2006-05-16  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c: removed empty quit() method.
	Only load scripts when extension-script-fu is started.

	* plug-ins/script-fu/script-fu-scripts.c: minor cleanup.

2006-05-16  Sven Neumann  <sven@picman.org>

	* app/app_procs.c (app_run): indentation.

	* app/core/picman.c (picman_real_initialize)
	* app/plug-in/picmanpluginmanager.c (picman_plug_in_manager_restore):
	moved a call to status_callback() to the plug-in manager.

2006-05-16  Kristian Rietveld  <kris@gtk.org>

	* configure.in: correct small typo.

2006-05-15  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/colorxhtml.py: Minor cleanups.

2006-05-15  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmanmodule/Makefile.am: added missing GLIB_LIBS to
	LIBADD. The recent changes to the gmodule check in configure.in
	had broken the build.

2006-05-15  Sven Neumann  <sven@picman.org>

	* app/plug-in/picmanplugin.c: removed debugging output.

2006-05-15  Sven Neumann  <sven@picman.org>

	* app/*/*.c:
	* lib*/*.c: removed erroneous semicolon after G_DEFINE_TYPE macros.

2006-05-15  Sven Neumann  <sven@picman.org>

	* app/core/picman-utils.c: include "libpicmanconfig/picmanconfig.h".

2006-05-14  Michael Natterer  <mitch@picman.org>

	Allow to initialize a new layer mask with any of the image's
	channels. Fixes bug #310207.

	* libpicmanbase/picmanbaseenums.h (enum PicmanAddMaskType): added
	value PICMAN_ADD_CHANNEL_MASK.

	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmanlayer.[ch] (picman_layer_create_mask): added
	PicmanChannel* parameter. Hacked the PICMAN_ADD_SELECTION_MASK code a
	bit so it can handle PICMAN_ADD_CHANNEL_MASK too. Cleaned up the
	function a bit.

	* app/dialogs/layer-add-mask-dialog.[ch]: added a menu of the
	image's channels.

	* app/actions/layers-commands.c (layers_add_mask_response): pass
	the channel selected in the menu to picman_layer_create_mask().

	* tools/pdbgen/pdb/layer.pdb (layer_create_mask): use the image's
	active channel when PICMAN_ADD_CHANNEL_MASK is passed. Fail if there
	is no active channel.

	* app/pdb/layer_cmds.c: regenerated.

2006-05-14  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_set_layer): find a
	suitable display and fully set up the tool (just as the vector
	tool does). Fixes bug #322182.

	(picman_text_tool_button_press): chain up to activate the tool.

	(picman_text_tool_set_drawable): removed redundant check.

2006-05-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_transform): add an alpha
	channel if the layer has none and interpolation is requested.
	Works around bug #315048, the real fix would be to implement
	interpolation on layers without alpha.

2006-05-13  Michael Natterer  <mitch@picman.org>

	Added some new text layer actions and menu items (bug #316299).

	* app/actions/layers-actions.c: added actions for "Text to Path",
	"Text along Path" and "Text to Selection" (use the alpha to
	selection callback for text to selection)

	* app/actions/layers-commands.[ch]: added
	layers_text_to_vectors_cmd_callback() and
	layers_text_along_vectors_cmd_callback().

	* app/widgets/picmanhelp-ids.h: help IDs for the new actions.

	* menus/image-menu.xml.in
	* menus/layers-menu.xml: added them to the layers menus in the
	image window and the layers dialog.

2006-05-13  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated
	* app/core/picman-util.c : dont include "config/picmanbaseconfig.c", it
	gives an redefinition error with msvc. Instead include
	config/picmanbaseconfig.h and libpicmanconfig/picmanconfig-path.h

	* plug-ins/common/psd_save.c : fix c99isms (declarations only at the
	start of a block)

2006-05-12  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanview.h: save 20 bytes per instance by using
	single bits instead of 6 gbooleans.

	* app/widgets/picmanview.c: some code cleanup.

	* app/widgets/picmanviewrendererbrush.c: don't #include "picmanbrush.h".

	* app/widgets/picmanviewrendererbuffer.c: #include "picmanviewable.h"
	instead of "picmanbuffer.h".

	* app/widgets/picmanviewrenderergradient.c
	* app/widgets/picmanviewrendererimagefile.c
	* app/widgets/picmanviewrendererimagefile.h: micro cosmetics.

2006-05-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/imagemap/imap_csim.y: fix warning about unused return
	value of g_list_append().

	* plug-ins/imagemap/imap_csim_parse.[ch]: regenerated (using
	bison 2.1 instead of 2.0, lots of things changed, please test).

2006-05-12  Michael Natterer  <mitch@picman.org>

	* configure.in: check for gmodule-no-export-2.0, not for
	gmodule-2.0. Also removed gobject-2.0 from the gmodule check, i
	have no idea why it was there.

	* libpicmanmodule/Makefile.am: s/GMODULE/GMODULE_NO_EXPORT/ because
	we only want to import modules here, not export our own symbols.

	(note that this change is actually useless, because libpicmanmodule
	 exports its symbols anyway, but it's more correct this way).

2006-05-12  Michael Natterer  <mitch@picman.org>

	* app/config/Makefile.am: make test-config link again.
	Fixes bug #340601.

2006-05-11  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanpdb-query.c (picman_pdb_proc_info): restored old
	version of this function, it was correct after all (spotted by
	Kevin Cozens).

2006-05-11  Michael Natterer  <mitch@picman.org>

	Applied modified patch from Michael J. Hammel which allows to
	remove all keyboard shortcuts from the menus (fixes bug #331839):

	* app/dialogs/preferences-dialog.c: added "Remove all keyboard
	shortcuts" button to the "Interface" section.

	* app/menus/menus.[ch]: added menus_remove() which does the
	shortcut removal.

2006-05-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererbrush.c
	* app/widgets/picmanviewrendererbuffer.c: use
	picman_viewable_get_size() and get rid of useless
	local "brush" and "buffer" variables.

2006-05-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c: code cleanup, no logic changed.

	* app/widgets/picmantoolbox-color-area.c: make the very first click
	on the color area work as expected.

2006-05-10  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-mmx.c
	(picman_composite_swap_rgba8_rgba8_rgba8_mmx): applied patch from
	Mukund that replaces remaining movntq instructions in MMX assembly
	(bug #162778).

2006-05-09  Simon Budig  <simon@picman.org>

	* themes/Default/images/stock-color-triangle-16.png: New icon
	to reflect the corrected triangular color selector.

2006-05-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_new)
	* app/core/picmanitem.c (picman_item_configure)
	* app/display/picmandisplay.c (picman_display_new): make sure IDs wrap
	correctly at G_MAXINT and skip IDs which are currently in use.

	It makes no sense to treat picman->image_table and picman->images
	differently, since they keep the same set of images. And it makes
	no sense to treat picman->displays and picman->images differently.
	Moved all container adding into the objects' constructors:

	* app/core/picman.c (picman_create_image): don't add the new image
	to picman->images here...

	* app/core/picmanimage.c (picman_image_constructor): ...but here.

	* app/core/picman-gui.c (picman_create_display): don't add the new
	display to picman->displays here...

	* app/display/picmandisplay.c (picman_display_new): ...but here.

2006-05-09  Michael Natterer  <mitch@picman.org>

	* app/gui/gui-vtable.c: don't #include "pdb/picmanpluginprocedure.h".

2006-05-08  Simon Budig  <simon@picman.org>

	* plug-ins/script-fu/siod/sliba.c: Insert a missing break that
	was responsible for a weird output of integer arrays.
	Untabbified.

2006-05-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_new): set the
	alternative button order here...

	* app/dialogs/file-open-dialog.c (file_open_dialog_new)
	* app/dialogs/file-save-dialog.c (file_save_dialog_new): ...instead
	of here.

2006-05-08  Simon Budig  <simon@picman.org>

	* plug-ins/common/postscript.c: fix typo...

2006-05-08  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-enums.[ch]: changed enum PlugInImageType
	to PicmanPlugInImageType.

	* app/pdb/picmanpluginprocedure.[ch]: changed accordingly.

2006-05-08  Simon Budig  <simon@picman.org>

	* plug-ins/common/postscript.c: improve the error message when
	spawning ghostscript does not work. See bug #340996. Untabbified.

2006-05-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmandrawable.c: don't #include "picman.h".

2006-05-07  Simon Budig  <simon@picman.org>

	* modules/colorsel_triangle.c: Make the hue angle behave
	mathematically correct. Fixes bug #141922

	* plug-ins/script-fu/scripts/circuit.scm: Fix multi line description.

	* docs/Wilber.svg: Add xmlns attribute to the svg element, so
	firefox renders it when reading it from disk.

2006-05-07  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	return early if the shell is already at the requested zoom level.
	(paranoia addition for bug #165032, which was already fixed by the
	fix for bug #164281)

2006-05-07  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanbrusheditor.c: hide the button bar, which is
	useless for the brush editor. Fixes user confusion (bug #306704).

2006-05-06  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c: connect to the context's
	"brush-changed" signal and update the brush core's brush
	accordingly. Fixes inconsistent brush preview when not moving
	the mouse while the brush changes (bug #323404).

2006-05-06  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: added "gboolean none_ok" members
	to PicmanParamSpecImageID, PicmanParamSpecItemID and
	PicmanParamSpecDisplayID.  If none_ok is set, allow '0' and '-1' as
	valid IDs. Added "none_ok" parameter to all ID param spec
	constructors.

	* app/xcf/xcf.c: require real image IDs, but allow images without
	active drawable.

	* app/pdb/picman-pdb-compat.c: set none_ok to TRUE in all compat
	param specs, so only IDs that are really random garbage don't pass
	validation. Fixes validation errors with 0 and -1 IDs (bug #339840).

	* tools/pdbgen/app.pl: set none_ok to FALSE by default. Added
	support for $arg->{none_ok} to control it.

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/progress.pdb
	* tools/pdbgen/pdb/text_tool.pdb: use none_ok instead of
	no_success (which disables validation entirely).

	* app/pdb/[many]_cmds.c: regenerated.

2006-05-05  Manish Singh  <yosh@picman.org>

	* plug-ins/common/gifload.c (DoExtension): Revert back to unsigned
	chars for the buffer, and only cast to gchar if we know we're dealing
	with a comment. Fixes bug #339865.

2006-05-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager-call.[ch]
	(picman_plug_in_manager_call_run): changed parameter "gint display_ID"
	to "PicmanObject *display".

	* app/pdb/picmanprocedure.[ch]
	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c: changed
	PicmanProcedure::execute_async() the same way.

	* app/plug-in/picmanpluginmanager.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/widgets/picmanhelp.c: changed accordingly.

2006-05-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager.[ch]: added signals
	"plug-in-opened" and "plug-in-closed". Added functions
	picman_plug_in_manager_add_open_plug_in() and _remove_open_plug_in()
	which maintain the list of open plug-ins and emit the signals.

	* app/plug-in/picmanplugin.c (picman_plug_in_open)
	(picman_plug_in_close): don't touch manager->open_plug_ins and don't
	ref/unref the plug-in. Call above new functions instead. Don't
	call picman_pdb_dialogs_check().

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: removed picman_pdb_dialogs_check().

	* app/widgets/picmanpdbdialog.[ch]: removed
	picman_pdb_dialogs_check_callback() and connect to the
	plug-in-manager's "plug-in-closed" signal instead.

2006-05-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginshm.c: cleaned up a bit.

	(picman_plug_in_shm_new): return NULL if anything goes wrong,
	instead of a PicmanPlugInShm structure that contains no shm (we
	don't need multiple cases of "there is no shm"),

	* app/plug-in/picmanpluginmanager.[ch]
	(picman_plug_in_manager_get_shm_ID)
	(picman_plug_in_manager_get_shm_addr): removed these functions.

	* app/plug-in/picmanpluginmanager-call.c (picman_plug_in_manager_call_run)
	* app/plug-in/picmanplugin-message.c (picman_plug_in_handle_tile_req):
	get the shm ID and addr directly from manager->shm if it exists,
	use -1 and NULL otherwise.

	Unrelated:

	* app/plug-in/picmanpluginmanager.c: move most stuff from
	picman_plug_in_manager_exit() to picman_plug_in_manager_finalize().
	Simplify plug-in killing in _exit().

2006-05-04  Sven Neumann  <sven@picman.org>

	* app/core/picman-user-install.[ch]: added a "verbose" parameter.

	* app/app_procs.c (app_run): abort if the user installation fails.

2006-05-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin.[ch] (struct PicmanPlugIn): remove member
	"name" and unused cruft "ref_count". Reordered other members a bit.

	(picman_plug_in_new): set PicmanObject's name to
	g_filename_display_basename(path) instead.

	Use PicmanObject's name instead of plug_in->name for error messages
	and pass the full path to picman_plug_in_debug_argv()

	* app/plug-in/picmanplugindebug.c (picman_plug_in_debug_argv): extract
	the path's basename ourselves.

	* app/plug-in/picmanplugin-message.c: PicmanObject's name for
	error messages.

2006-05-04  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.c (picman_string_array_new)
	(picman_param_string_array_validate): restore the strict checks
	on string arrays.

	* app/plug-in/picmanpluginmanager-help-domain.c
	(picman_plug_in_manager_get_help_domains): return NULL string arrays
	when there are 0 help domains to fix the inconsistency at its root.

2006-05-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanplugin.c
	* app/plug-in/picmanpluginmanager-call.c: use the right procedure
	types in calls to picman_plug_in_proc_frame_foo().

2006-05-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanselectiondata.c
	(picman_selection_data_get_tool_info): port to using
	picman_selection_data_get_object(), it was simply forgotten.
	Fixes tool dropping (bug #336402).

2006-05-03  Michael Natterer  <mitch@picman.org>

	Made an object out of the plug-in struct. Also change refcounting
	considerably:

	- picman_plug_in_open() adds a reference that is only dropped by
	  picman_plug_in_close().
	- temporarily ref the plug-in while handling messages.
	- remporarily ref the plug-in while a recursive main loop is
	  running.
	- each caller of picman_plug_in_new() also unrefs the plug-in before
	  returning, the only reference that persists across functions
	  (that keeps the plug-in alive) is the one added by open().

	* app/plug-in/plug-in.[ch]
	* app/plug-in/plug-in-context.[ch]
	* app/plug-in/plug-in-message.[ch]
	* app/plug-in/plug-in-progress.[ch]: removed these files...

	* app/plug-in/picmanplugin.[ch]
	* app/plug-in/picmanplugin-context.[ch]
	* app/plug-in/picmanplugin-message.[ch]
	* app/plug-in/picmanplugin-progress.[ch]: ...and added here as GObject.

	* app/plug-in/plug-in-proc-frame.[ch]: removed...

	* app/plug-in/picmanpluginprocframe.[ch]: ...and added with a namespace.

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/plug-in/picmanpluginmanager-call.c
	* app/plug-in/picmanpluginmanager-file.c
	* app/plug-in/picmanpluginmanager.[ch]
	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c
	* app/pdb/picmantemporaryprocedure.h
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/progress.pdb
	* tools/pdbgen/pdb/undo.pdb: changed accordingly.

	* app/pdb/context_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/help_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/progress_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2006-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c: removed some unused code, untabified.

2006-05-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanparamspecs.c (picman_string_array_new,
	picman_param_string_array_validate): relaxed the checks so that
	PicmanStringArray deals correctly with (length == 0 && data != NULL).
	Fixes bug #340365.

2006-05-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.c: allow Merge operations on single
	layers as suggested in bug #340491.

2006-05-02  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-enums.[ch]: added enum PicmanPlugInCallMode
	which can be one of { NONE, QUERY, INIT, RUN }.

	* app/plug-in/Makefile.am
	* app/plug-in/picmanpluginmanager-run.[ch]: removed again...

	* app/plug-in/picmanpluginmanager-call.[ch]: ...and added
	here. Added picman_plug_in_manager_call_init() and
	picman_plug_in_manager_call_query().

	* app/plug-in/plug-in.[ch]: removed plug_in_call_query() and
	plug_in_call_init().

	(struct PlugIn): removed members "init", "query" and "synchronous".

	(plug_in_open): added parameters "call_mode" and "synchronous".

	* app/plug-in/picmanpluginmanager.c
	* app/plug-in/plug-in-message.c
	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/plug_in_cmds.c: regenerated.

2006-05-02  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: code cleanup, rephrased radio
	button labels.

2006-05-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainercombobox.c
	(picman_container_combo_box_remove_item): turned a #warning into an
	explanation because the bug it referred to is marked as WONTFIX.

2006-05-02  Sven Neumann  <sven@picman.org>

	* libpicman/picmanproceduraldb.[ch] (picman_procedural_db_set_data):
	added const qualifier.

2006-05-02  Sven Neumann  <sven@picman.org>

	* fileicon.ico
	* wilber.ico: new icons for the Windows build created by Jernej
	Simončič based on the icons drawn by Jimmac (bug #340223).

2006-04-29  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in.[ch]: removed plug_in_push() and
	plug_in_pop()...

	* app/plug-in/picmanpluginmanager.[ch]: ...and added them here as
	picman_plug_in_manager_plug_in_push() and _pop()

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_run): changed
	accordingly.

	* app/plug-in/plug-in.c (plug_in_close): removed an unused
	variable, moved another one to a local scope.

	* app/plug-in/plug-in.h: indentation.

2006-04-29  Michael Natterer  <mitch@picman.org>

	* app/plug-in/picmanpluginmanager-locale-domain.c
	(picman_plug_in_manager_get_locale_domains): NULL-terminate string
	arrays here too, so they can be freed with g_strfreev() (even
	though they currently aren't).

	* app/widgets/picmanhelp.c: set the plug-in arguments
	correctly. Fixes warnings and makes help work again.

2006-04-29  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: fixed signal connection.

	* app/core/picman-user-install.c: indentation.

2006-04-29  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am (AM_CPP_FLAGS): define PICMAN_APP_VERSION.

	* app/core/picman-user-install.c: use PICMAN_APP_VERSION instead of
	hardcoding it.

2006-04-29  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picman-user-install.[ch]: new files based on code that
	used to live in user-install-dialog.c.

	* app/dialogs/user-install-dialog.[ch]: only the dialog code
	remained here.

	* app/app_procs.c: use the new user-install API.  Perform a
	non-interactive user installation when running without a display.

2006-04-29  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/picmanpluginmanager-locale-domain.c
	(picman_plug_in_manager_get_locale_domains): NULL-terminate the
	locale_domains and locale_paths string vectors, as they are freed
	with g_strfreev() in picman_plug_in_manager_restore().

	* app/plug-in/plug-in.c (plug_in_close): Make it compile again on
	Win32. Use g_usleep() instead of select()/Sleep() Unix/Windows
	ifdef.

2006-04-29  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-run.[ch]: removed...

	* app/plug-in/picmanpluginmanager-run.[ch]: ...and added as methods
	of PicmanPlugInManager.

	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c: changed accordingly.

2006-04-29  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.[ch]: removed unused code and
	unused parameters passed to user_install_dialog_run().

	* app/app_procs.c (app_run): changed accordingly.

2006-04-29  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/plug-in/picmanpluginmanager.[ch]: new object which keeps all
	plug-in related stuff that was kept in the Picman instance. Has
	"menu-branch-added" and "last-plug-in-changed" signals.

	* app/plug-in/plug-ins.[ch]: removed, all its functions are in
	PicmanPlugInManager now.

	* app/core/picmanmarshal.list: new marshaller for the new object.

	* app/core/picman.[ch]: removed all plug-in related stuff and keep a
	PicmanPlugInManager around.

	* app/plug-in/plug-in-data.[ch]
	* app/plug-in/plug-in-file.[ch]
	* app/plug-in/plug-in-help-domain.[ch]
	* app/plug-in/plug-in-locale-domain.[ch]
	* app/plug-in/plug-in-menu-branch.[ch]
	* app/plug-in/plug-ins-query.[ch]: removed...

	* app/plug-in/picmanpluginmanager-data.[ch]
	* app/plug-in/picmanpluginmanager-file.[ch]
	* app/plug-in/picmanpluginmanager-help-domain.[ch]
	* app/plug-in/picmanpluginmanager-locale-domain.[ch]
	* app/plug-in/picmanpluginmanager-menu-branch.[ch]
	* app/plug-in/picmanpluginmanager-query.[ch]: ...and added as
	methods of PicmanPlugInManager.

	* app/plug-in/plug-in-debug.[ch]
	* app/plug-in/plug-in-shm.[ch]: removed...

	* app/plug-in/picmanplugindebug.[ch]
	* app/plug-in/picmanpluginshm.[ch]: ...and added as properly
	namespaced structs with constructors and destructors.

	* app/core/Makefile.am
	* app/core/picmanenvirontable.[ch]
	* app/core/picmaninterpreterdb.[ch]: removed...

	* app/plug-in/picmanenvirontable.[ch]
	* app/plug-in/picmaninterpreterdb.[ch]: ...and added here unchanged.

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: remove picman_menus_create_branch() and all
	related stuff.

	* app/actions/plug-in-actions.[ch]: connect to the
	plug-in-manager's "menu-path-added" signal and create menu branch
	actions accordingly.

	* app/plug-in/plug-in-context.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-run.[ch]
	* app/plug-in/plug-in.[ch]
	* app/app_procs.c
	* app/actions/file-commands.c
	* app/actions/plug-in-commands.c
	* app/core/picmanimage.c
	* app/dialogs/file-open-location-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/file/file-open.c
	* app/gui/gui.c
	* app/menus/plug-in-menus.c
	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanthumbbox.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/progress.pdb
	* tools/pdbgen/pdb/undo.pdb: follow above refactoring.

	* app/pdb/context_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/help_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/progress_cmds.c
	* app/pdb/undo_cmds.c: regenerated.

2006-04-28  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: code and user interface cleanup.

2006-04-28  Tor Lillqvist  <tml@novell.com>

	* HACKING: Clarify the wording about TABs. s/bracket/brace/ .

2006-04-27  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-locale-domain.[ch] (plug_in_locale_domains):
	new function which returns string arrays of all registered locale
	domains and paths.

	(plug_in_standard_locale_domain): removed this function. The
	standard plug-in domain is included in the domains returned by
	plug_in_locale_domains().

	* app/plug-in/plug-ins.c (plug_ins_init): simply bind the text
	domains here instead of calling picman_menus_init(). Destroy
	picman->plug_in_defs much earlier.

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: removed picman_menus_init().

	* app/menus/plug-in-menus.[ch]: removed plug_in_menus_init(),
	binding text domains is completely done in the core now.

2006-04-27  Michael Natterer  <mitch@picman.org>

	Added some signals inspired by Rockwalrus' libpdb:

	* app/pdb/picmanpdb.[ch]: added signals "register-procedure" and
	"unregister-procedure".

	* app/pdb/picmanpluginprocedure.[ch]: added signal "menu-path-added".

	* app/actions/plug-in-actions.[ch]
	* app/menus/plug-in-menus.[ch]: connect to the new signals and
	create/destroy plug-in actions and menus accordingly. Made all
	needed functions private and merged some of them with the newly
	added signal callbacks.

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c: removed picman_menus_create_item() and
	picman_menus_delete_item() and all related stuff.

	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins.c: removed calls to the removed functions.

	* app/plug-in/plug-ins.c (plug_ins_init): add the plug-in
	procedures to the PDB *after* calling picman_menus_init() so their
	locale domains are properly initialized when the menus are
	created.

2006-04-27  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c: fixed argument order for using
	PICMAN_CONFIG_INSTALL_PROP_RGB().

2006-04-27  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.[ch]: hide the PicmanParamSpecRGB struct
	again.  Added getter for the has_alpha field.

	* libpicmancolor/picmancolor.def: updated.

	* app/config/picmanconfig-dump.c
	* libpicmanconfig/picmanconfig-serialize.c: use
	picman_param_spec_rgb_has_alpha() instead of accessing the
	PicmanParamSpecRGB struct directly.

2006-04-27  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.[ch]: added "has_alpha" to PicmanParamSpecRGB.
	Made the PicmanParamSpecRGB struct public. When validating a color,
	only look at the alpha channel if has_alpha is set.

	* libpicmanconfig/picmanconfig-params.h: added "has_alpha" to the
	PICMAN_CONFIG_INSTALL_PROP_RGB macro definition.

	* libpicmanconfig/picmanconfig-serialize.c: serialize color values as
	"(rgb r g b)" if the param-spec indicates that the alpha channel
	is meaningless.

	* app/config/picmanconfig-dump.c: take "has_alpha" into account when
	documenting color properties.

	* app/core/picmancontext.c
	* app/core/picmangrid.c
	* app/display/picmandisplayoptions.c
	* app/text/picmantext.c
	* app/widgets/picmanaction.c
	* app/widgets/picmancolorbar.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c: specify whether color properties
	have an alpha channel.

	* tools/pdbgen/app.pl: handle "has_alpha" for color paramaters.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/grid.pdb
	* tools/pdbgen/pdb/image.pdb: set the "has_alpha" flag where
	appropriate.

	* app/pdb/picman-pdb-compat.c (picman_pdb_compat_param_spec): set
	"has_alpha" to TRUE for PICMAN_PDB_COLOR.

	* app/pdb/channel_cmds.c
	* app/pdb/context_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/grid_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

	* app/config/picmandisplayconfig.c (picman_display_config_class_init):
	removed unused code.

2006-04-27  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.h: indentation.

2006-04-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpluginaction.[ch]: use a GParamSpecObject instead
	of GParamSpecPointer for the "procedure" property. Keep a reference
	on the action's procedure. Did a global s/proc/procedure/.

2006-04-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/warp.c: some cleanup, still a mess.

2006-04-27  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-commands.c (plug_in_repeat_cmd_callback):
	truncate the value array to the number of actually set parameters.

2006-04-27  Michael Natterer  <mitch@picman.org>

	* app/Makefile.am (SUBDIRS): changed order of subdirs to match the
	bottom-up module dependency order more closely.

2006-04-27  Michael Natterer  <mitch@picman.org>

	* configure.in: use G_DISABLE_DEPRECATED also when building
	against glib 2.10

2006-04-27  Michael Natterer  <mitch@picman.org>

	* app/menus/menus.c: namespace cleanup: renamed
	menu_can_change_accels() to menus_can_change_accels().

2006-04-26  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (depth_first_search): added newlines.

	* app/core/picmanimage-contiguous-region.c: added const qualifiers.

2006-04-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: use picman_progress_set_text() instead
	of picman_progress_init() to change the progress text.

2006-04-26  Sven Neumann  <sven@picman.org>

	* app/actions/vectors-commands.c
	(vectors_selection_to_vectors_cmd_callback): do not pass an
	invalid drawable to the plug-in, just omit the argument.
	Fixes bug #339759.

2006-04-26  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.c: code cleanup, moved variables into
	local scopes, added const qualifiers.

2006-04-26  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/pdb-types.h
	* app/pdb/picmanpdb.[ch]: new object PicmanPDB which keeps all
	procedures and functions to register and run them. Renamed all
	functions and did some cleanups.

	* app/pdb/picman-pdb.[ch]
	* app/core/picman.[ch]: removed the same stuff here.

	* app/pdb/picman-pdb-query.[ch]: removed these files...

	* app/pdb/picmanpdb-query.[ch]: ...added here as members of PicmanPDB.

	* app/pdb/picman-pdb-compat.h: fix include guard.

	* app/batch.c
	* app/actions/vectors-commands.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanhelp.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed includes and function
	calls accordingly.

	* tools/pdbgen/app.pl: pass around PicmanPDB instead of Picman
	pointers to register the internal procedures with. Changed some
	newlines in the generated code.

	* app/pdb/*_cmds.c
	* app/pdb/internal_procs.[ch]: regenerated.

	* app/core/picmanpdbprogress.[ch]
	* app/widgets/picmanpdbdialog.[ch]: added "pdb" CONSTRUCT_ONLY
	properties.

	* app/plug-in/plug-in-progress.c
	* app/gui/gui-vtable.c: pass picman->pdb when creating them.

	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpatternselect.c: use the new local pdb pointers
	instead of some foo->bar->picman->pdb overkill.

2006-04-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanthresholdtool.c: added an "Auto" button and
	initialize the tool with a default threshold of 127 again.
	Removed some cruft and did some cleanup.

2006-04-25  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c: code cleanup, moved variables into
	local scopes, added const qualifiers.

2006-04-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanchannel.c (picman_channel_real_border)
	* app/paint-funcs/paint-funcs.c (border_region): added some empty
	lines to improve readability.

2006-04-24  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: moved the installation log
	into a GtkExpander.

	* app/actions/dialogs-commands.c (dialogs_create_dock): added
	const qualifiers to fix compiler warnings.

2006-04-24  Sven Neumann  <sven@picman.org>

	* plug-ins/xjt/xjt.c: undef PICMAN_DISABLE_DEPRECATED to fix the
	build on IRIX MIPSpro (bug #339336).

2006-04-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c: implement a thumbnail load procedure
	that loads only the first frame of a GIF animation.

2006-04-24  DindinX  <dindinx@picman.org>

	* plug-ins/common/redeye.c: use a zoom preview instead of a drawable
	one.

2006-04-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/redeye.c: added Redeye Removal plug-in, written
	by Robert Merkel and Andreas Røsdal. Fixes bug #91795.

2006-04-23  Manish Singh  <yosh@picman.org>

	* plug-ins/common/plugin-defs.pl: use PNG_CFLAGS for the png plugin.

	* plug-ins/common/Makefile.am: regenerated.

2006-04-23  Manish Singh  <yosh@picman.org>

	* plug-ins/common/png.c: don't use long deprecated libpng API, and
	drop support for ancient libpng versions. Fixes bug #339402.

	* configure.in: use pkg-config to detect libpng. This means we now
	require at least libpng 1.2.2, but that's over four years old, so
	that shouldn't be that big a deal.

2006-04-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewabledialog.c: added "viewable" as a property.

2006-04-23  Sven Neumann  <sven@picman.org>

	* app/dialogs/module-dialog.c
	* app/dialogs/palette-import-dialog.c: use PicmanDialog instead of a
	PicmanViewableDialog with a NULL viewable.

	* app/widgets/picmanviewabledialog.c: deprecate use of
	PicmanViewableDialog with a NULL viewable.

	* app/dialogs/resolution-calibrate-dialog.c: whitespace.

2006-04-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch] (picman_prop_scale_entry_new):
	renamed parameters to please gtk-doc.

2006-04-21  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: minor string changes.

	* app/config/picmanrc.c: declared an array as const.

	* app/dialogs/user-install-dialog.c: further streamlining of the
	user installation.

2006-04-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: in an effort to basically
	get rid of the user installation dialog, removed the license and
	tuning pages as well as the code that was responsible for the
	nifty orange style. More to come ...

2006-04-21  Sven Neumann  <sven@picman.org>

	Applied a slightly modified version of a patch from Lode Leroy
	(bug #336183):

	* app/base/picmanhistogram.[ch]: added new function
	picman_histogram_get_threshold() that returns an optimal
	binarization threshold.

	* app/tools/picmanthresholdtool.c: use the new function to
	initialize the Threshold tool.

2006-04-21  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_utf8_strtrim): strlen != sizeof

2006-04-21  Sven Neumann  <sven@picman.org>

	* app/base/curves.c
	* app/widgets/picmansessioninfo.c: minor code cleanup, removed
	trailing whitespace.

2006-04-20  Simon Budig  <simon@picman.org>

	* app/base/curves.c: implemented a new interpolation for the
	"smooth" curve type. This fixes the artefacts as described in
	bug #169078 although there definitely is room for improvement.

	This has an impact on the API as now the curves used by the
	picman-curves-spline PDB call change. I do however believe, that
	the change is for good and the old behaviour was simply buggy.

2006-04-20  Tor Lillqvist  <tml@novell.com>

	* app/widgets/picmansessioninfo.c (get_appropriate_monitor): New
	helper function. Same functionality as
	gdk_screen_get_monitor_at_window(), except that it takes a window
	geometry as parameter and not the window itself.
	(picman_session_info_set_geometry): Make sure the window is
	completely inside a monitor. (#339099, #324254)

2006-04-20  Simon Budig  <simon@picman.org>

	* plug-ins/common/convmatrix.c: only access existing toggle buttons.
	Fixes bug #339124.

2006-04-20  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: convolve_region() takes a
	const matrix parameter.

	* app/paint/picmanconvolve.c
	* app/tools/picmaniscissorstool.c: use const convolution matrices.

	* libpicmanbase/picmanutils.c (picman_utf8_strtrim): avoid another small
	relocation.

	* modules/colorsel_cmyk.c
	* regexrepl/regex.c: use const arrays of const strings.

2006-04-19  Simon Budig  <simon@picman.org>

	* plug-ins/imagemap/imap_main.c: removed unused code
	Fixes bug #339046

	* tools/pdbgen/pdb/paths.pdb: removed deprecated docs
	* app/pdb/paths_cmds.c: regenerated

2006-04-19  Sven Neumann  <sven@picman.org>

	* app/composite/make-installer.py: generate const arrays.

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-generic-installer.c
	* app/composite/picman-composite-mmx-installer.c
	* app/composite/picman-composite-sse-installer.c
	* app/composite/picman-composite-sse2-installer.c: regenerated.

2006-04-19  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: removed an unneeded call to
	gtk_widget_realize() (bug #324254). Sprinkled const qualifiers to
	avoid relocations.

2006-04-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: fixed bug in range calculation
	that caused display errors in the last row (bug #338378).

2006-04-19  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg.c (run): initialize global variables. Fixes
	bug #338373.

	* plug-ins/jpeg/NEWS: removed.

	* app/core/picmanparamspecs.c: indentation.

2006-04-18  Manish Singh  <yosh@picman.org>

	* app/core/picmanpickable.c (picman_pickable_flush): do not return
	a value with void functions. Fixes bug #338904.

2006-04-18  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c: indentation.

2006-04-18  Sven Neumann  <sven@picman.org>

	* app/actions/dialogs-commands.c
	* app/config/picmanconfig-dump.c
	* app/core/picmancontext.c
	* app/core/picmandocumentlist.c
	* app/core/picmanparasitelist.c
	* app/display/picmandisplayshell.c: avoid unnecessary relocations.

2006-04-18  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Remove obsolete entry for no_NO

2006-04-18  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_drb): sync parameter names with the
	declaration in the header file.

2006-04-18  Manish Singh  <yosh@picman.org>

	* app/core/picmanparamspecs.c: void functions should not try to return
	values. Fixes bug #338792.

2006-04-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanclipboard.c (picman_clipboard_set_buffer): fix
	parameter name in API docs.

2006-04-15  Michael Natterer  <mitch@picman.org>

	* app/core/picman-utils.[ch]: added
	picman_g_type_instance_get_memsize() and
	picman_g_param_spec_get_memsize().
	Changed picman_g_object_get_memsize() to use
	picman_g_type_instance_get_memsize().
	Handle more boxed types in picman_g_value_get_memsize().

	* app/core/picman.c (picman_get_memsize): add the memsize of some
	members that are new or were forgotten.

	* app/pdb/picmanprocedure.c
	* app/pdb/picmanpluginprocedure.c: implement PicmanObject::get_memsize().

2006-04-14  Manish Singh  <yosh@picman.org>

	* app/plug-in/plug-in.h: Some compilers don't handle "'" in #error
	directives well. Reword to not use a contraction.

2006-04-13  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c: code cleanup by Clarence Risher
	(bug #338002).

2006-04-13  Sven Neumann  <sven@picman.org>

	* app/actions/file-actions.c: resolved conflicting mnemonic for
	the "Acquire" submenu.

2006-04-12  Karine Delvare  <edhel@picman.org>

	* app/tools/picmannewrectselecttool.c: auto-convert rectangle to
	selection after creating or reiszing it.

2006-04-12  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.9.

2006-04-12  Sven Neumann  <sven@picman.org>

	* Made 2.3.8 development release.

2006-04-12  Sven Neumann  <sven@picman.org>

	* app/*.[ch]
	* app/*/*.[ch]: converted tabs to spaces.

2006-04-12  Sven Neumann  <sven@picman.org>

	* libpicman*/picman*.[ch]: converted tabs to spaces.

2006-04-12  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/lib.pl: create code with spaces instead of tabs.

	* libpicman/picman*_pdb.[ch]: regenerated.

2006-04-12  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c
	* tools/kernelgen.c: converted tabs to spaces.

2006-04-12  Sven Neumann  <sven@picman.org>

	* app/pdb/picman-pdb.c (picman_pdb_init_procs): removed profiling code.

2006-04-11  Carol Spears  <carol@picman.org>

	* data/images/picman-splash.png: new splash, nicknamed "Where's bolsh?".

2006-04-11  Manish Singh  <yosh@picman.org>

	* desktop/Makefile.am: honor $(DESTDIR). Fixes bug #338147. Also
	some minor cleanups.

2006-04-11  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c: increased SELECTION_BORDER to 8.

2006-04-11  Kevin Cozens  <kcozens@cvs.gnome.org>

	* app/pdb/picman-pdb-query.c: Changed formatting of output from
	picman-procedural-db-dump to make it more easily human (and machine)
	readable. Fixes bug #337843.

2006-04-11  Sven Neumann  <sven@picman.org>

	* app/units.c
	* app/core/picman-contexts.c: converted tabs to spaces.

2006-04-11  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.[ch]
	* tools/pdbgen/pdb/fileops.pdb: fix typo: s/thumnail/thumbnail/

	* app/pdb/fileops_cmds.c: regenerated.

2006-04-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.[ch]: removed antique
	picman_context_get_name() and _set_name().

	* app/actions/vectors-commands.c: #include "picman-utils.h"

2006-04-10  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_add_to_db): don't iterate the
	list of plug-in procedures here, take a PicmanPlugInProcedure
	argument instead.

	(plug_ins_init): iterate the list here, just as all other lists
	too. Renamed local "filename" variable to "pluginrc". Moved
	"basename" to local scopes.

	* tools/pdbgen/pdb/procedural_db.pdb: minor cleanup.

	* app/pdb/procedural_db_cmds.c: regenerated.

2006-04-10  Sven Neumann  <sven@picman.org>

	* libpicmanmodule/picmanmoduledb.c (picman_module_db_module_remove_func):
	don't ignore the return value of g_list_remove().

2006-04-10  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.[ch]: added file_utils_load_thumbnail() and
	file_utils_save_thumbnail().

	* tools/pdbgen/pdb/fileops.pdb: remove lots of code and includes
	and use the new functions.

	* app/pdb/fileops_cmds.c: regenerated.

2006-04-10  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-file.c: some cleanup.

	(plug_in_file_register_load_handler)
	(plug_in_file_register_save_handler): first check if we have the
	procedure, then check its arguments, not the other way around
	(using an additional lookup). Old weird code was needed because
	these functions were split between app/plug-in and app/pdb.

	* app/plug-in/plug-in-file.h: whitespace.

2006-04-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanzoommodel.c (picman_zoom_model_zoom_step):
	declared the array of zoom factors as const.

2006-04-10  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.[ch]: take const arrays of action
	entries.

	* app/actions/*-actions.c: declare action arrays as const.

2006-04-10  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.[ch]: removed the plug_ins_file_foo()
	functions.

	* tools/pdbgen/pdb/fileops.pdb: removed lots of load and save
	handler register code.

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-file.[ch]: added everything in these new
	files. Load and save handlers are installed with
	plug_in_file_register_load_handler() and _save_handler() which
	also check the passed file procedure's parameters.

	* app/pdb/fileops_cmds.c: regenerated.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-ins-help.[ch]
	* app/plug-in/plug-ins-locale.[ch]: remove these files again...

	* app/plug-in/plug-in-help-domain.[ch]
	* app/plug-in/plug-in-locale-domain.[ch]: ... and add them here
	with changed namespace.

	* app/plug-in/plug-in-menu-branch.[ch]: new files keeping menu
	branches registered by plug-ins.

	* app/plug-in/plug-ins.[ch]: removed the menu branch stuff here.

	* app/actions/plug-in-actions.c
	* app/menus/plug-in-menus.c
	* app/plug-in/plug-in.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanhelp.c
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/help_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins.[ch]: remove plug_ins_add_internal() and
	made plug_ins_procedure_insert() public as plug_ins_procedure_add().
	There's no reason internal plug-ins should be treated differently.

	* app/xcf/xcf.c: use plug_ins_procedure_add().

	* app/plug-in/plug-ins-help.c: fix comment.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.[ch] (plug_in_params_destroy):
	removed this function. We only have shallow GPParam arrays in the
	core that can be freed with g_free(), and gp_params_destroy()
	could always be used for freeing deep copies.

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-run.c: simply g_free() the GPParam arrays.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.[ch]: removed function
	plug_in_proc_args_check().

	* app/pdb/picmanpluginprocedure.[ch]: added new function
	picman_plug_in_procedure_add_menu_path() which performs all menu
	path checks that were in the function above and adds the new
	menu_path to the procedure's list of menu_paths.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install)
	* app/plug-in/plug-in.c (plug_in_menu_register): use the new
	function and removed manual adding of the menu path to
	proc->menu_paths.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-ins-help.[ch]
	* app/plug-in/plug-ins-locale.[ch]: new files managing plug-in
	help domains and locale domains.

	* app/plug-in/plug-ins.[ch]: removed the functions here. Minor
	unrelated cleanups.

	* app/plug-in/plug-in.c
	* app/actions/plug-in-actions.c
	* app/menus/plug-in-menus.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanhelp.c
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed includes accordingly.

	* app/pdb/help_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-rc.[ch] (plug_in_rc_parse): return a GSList*
	of PlugInDefs instead of a boolean. Don't return anything if any
	parse error occurs (before, we trusted PlugInDefs from partially
	broken files). Don't call plug_ins_def_add_from_rc() and don't
	#include "plug-ins.h".

	* app/plug-in/plug-ins.[ch]: made plug_ins_def_add_from_rc()
	private and call it on all PlugInDefs returned by plug_in_rc_parse().
	Renamed plug_ins_init_file() to plug_ins_add_from_file()

	(plug_ins_init): remove code that checks for duplicate plug-in
	procedures...

	(plug_ins_procedure_insert): ... and add it where it belongs.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf.c (xcf_init): don't register the XCF procedures
	with the PDB here...

	* app/plug-in/plug-ins.c (plug_ins_add_to_db): ... instead, don't
	special case internal procedures here so they get registered along
	with all other plug-in procedures.

2006-04-09  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-def.c (plug_in_def_set_mtime): set the mtime
	of all the plug_in_def's procedures too.

	* app/plug-in/plug-in-params.c: don't include "plug-in.h"

	* app/plug-in/plug-in-rc.c: minor cleanup. Fixed one error
	return value.

	* app/plug-in/plug-in.c (plug_in_push): simply use g_slist_remove();
	fiddling with list nodes manually is a questionable "optimization"
	for removing the first list element.

	* app/plug-in/plug-ins.c (plug_ins_init): some cleanup.

2006-04-08  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: center constraint with control
	key.

2006-04-07  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_run)
	(plug_in_handle_proc_return_priv): removed PlugInBlocked cruft,
	it was probably unused since ages.

	(plug_in_handle_proc_return_priv): removed...

	(plug_in_handle_proc_return)
	(plug_in_handle_temp_proc_return): ...and added its only remaining
	function call here.

	(plug_in_handle_tile_req): check if the requested drawable ID
	is really a drawable (not a vectors or...)

	(plug_in_handle_proc_install): cleanup.

2006-04-07  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-run.[ch]: made plug_in_run_temp() public and
	changed its parameters to match the ones of plug_in_run().

	* app/pdb/picmanprocedure.[ch]: added PicmanProcedure::execute_async()
	which takes an additional display_ID parameter and returns nothing.

	* app/pdb/picmanpluginprocedure.c
	* app/pdb/picmantemporaryprocedure.c: implement it, using
	plug_in_run() and plug_in_run_temp().

	* app/core/picman-utils.[ch]: added picman_value_array_truncate()
	which takes a GValueArray and the number of values to truncate the
	array to.

	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/pdb/picman-pdb.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanhelp.c: use picman_procedure_execute_async()
	instead of plug_in_run() and don't #include "plug-in-run.h".
	Truncate GValueArray passed to plug-ins again, and don't just pass
	some default values to the noninteractive args.

	Unrelated:

	* tools/pdbgen/pdb/plug_in.pdb: don't call
	picman_menus_create_branch() here.

	* app/plug-in/plug-ins.c (plug_ins_menu_branch_add): call it here
	instead.

	* app/pdb/plug_in_cmds.c: regenerated.

2006-04-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.h: added "guint disconnected : 1", we
	have enough space for flags now.

	* app/core/picmanobject.c (picman_object_dispose): use the new
	object->disconnected flag instead of attaching that boolean to the
	object.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf.c (xcf_loaders): declared the array as const.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/actions/tool-options-commands.c
	* app/core/picman.c
	* app/core/picmanbrushpipe.c
	* app/core/picmanbuffer.c
	* app/core/picmancontext.c
	* app/core/picmandatafactory.c
	* app/core/picmangradient-load.c
	* app/core/picmanimage-merge.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanitem.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/core/picmanlist.c
	* app/core/picmanpalette.c
	* app/dialogs/template-options-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/file/file-open.c
	* app/paint/picman-paint.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmandatafactoryview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantemplateview.c
	* app/widgets/picmantoolbox-dnd.c: use picman_object_set_static_name()
	and picman_object_take_name() where appropriate.

2006-04-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanobject.[ch]: added flag "guint static_name : 1" and
	new APIs picman_object_set_static_name() and _take_name().

	* app/pdb/picmanprocedure.[ch]: removed member "name". Use
	PicmanObject's name instead.

	* app/actions/plug-in-actions.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/menus/plug-in-menus.c
	* app/pdb/picman-pdb-query.c
	* app/pdb/picman-pdb.c
	* app/pdb/picmanpluginprocedure.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins-query.c
	* app/plug-in/plug-ins.c
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/fileops.pdb: use PicmanObject API to set/get
	a procedure's name.

	* app/pdb/*_cmds.c: regenerated.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.[ch]: renamed picman_drawable_shadow() to
	picman_drawable_get_shadow_tiles().

	* app/core/picmanimage.[ch]: renamed picman_image_shadow() to
	picman_image_get_shadow_tiles() and picman_image_free_shadow() to
	picman_image_free_shadow_tiles().

	* app/core/picmandrawable-desaturate.c
	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-invert.c
	* app/core/picmandrawable-levels.c
	* app/core/picmanimagemap.c
	* app/plug-in/plug-in-message.c
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/image.pdb: changed accordingly.

	* app/pdb/color_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.[ch]: renamed picman_drawable_cmap() to
	picman_drawable_get_colormap() and let it return a const array.

	* app/core/picmandrawable-convert.c
	* app/core/picmanimage-convert.c
	* app/core/picmanselection.c
	* app/display/picmandisplayshell-preview.c: changed accordingly.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable.[ch]: renamed picman_drawable_data() to
	picman_drawable_get_tiles().

	* app/[lots of files]: changed accordingly.

2006-04-07  Michael Natterer  <mitch@picman.org>

	* app/pdb/picman-pdb.c (picman_pdb_register)
	(picman_pdb_unregister): ref all registered procedures.

	* app/xcf/xcf.c
	* tools/pdbgen/app.pl: unref newly created procedures after
	registering them.

	* app/core/picman.[ch]: renamed member "plug_in_proc_defs" to
	"plug_in_procedures". Renamed "proc_def" variables to "procedure".

	* app/actions/plug-in-actions.c
	* app/menus/plug-in-menus.c: changed accordingly.

	* app/plug-in/plug-ins.[ch]: keep a reference to all procs which
	are in picman->plug_in_procedures.

	(plug_ins_exit): unref them all and free the list. Apparently we
	were leaking them before on exit.

	* app/plug-in/plug-in-def.[ch]: s/proc_defs/procedures/. Ref
	procedures added with plug_in_def_add_procedure(). Added
	plug_in_def_remove_procedure() which unrefs them again. Removed
	"free_proc_defs" parameter from plug_in_def_free() and always
	unref the procedures.

	* app/plug-in/plug-in.[ch]: added plug_in_add_temp_proc() and
	plug_in_remove_temp() proc. Ref the added procedures.

	* app/plug-in/plug-in-message.c: use the new APIs instead of
	adding/removing procs and temp procs from their lists manually.
	Unref the newly created procedure after adding them to the
	plug_in_def or plug_in.

	* app/plug-in/plug-in-rc.[ch]
	* app/plug-in/plug-ins-query.c
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-04-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.[ch] (picman_image_merge_visible_layers):
	allow to discard invisible layers as suggested in bug #337557.

	* app/actions/image-commands.c
	* app/dialogs/image-merge-layers-dialog.[ch]: added a check button
	to the Merge Visible Layers dialog to control the new feature.

	* app/file/file-open.c
	* tools/pdbgen/pdb/image.pdb: pass FALSE for the new parameter.

	* app/pdb/image_cmds.c: regenerated.

2006-04-06  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite.c: removed unused global arrays.

2006-04-06  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/enumcode.pl: generate a const arrays of const strings.

	* libpicman/picmanenums.c.tail: regenerated.

2006-04-06  Sven Neumann  <sven@picman.org>

	* app/dialogs/authors.xsl: generate const arrays of const strings.

	* app/dialogs/authors.h: regenerated.

2006-04-06  Sven Neumann  <sven@picman.org>

	* app/core/picmancontext.c
	* app/core/picmanimage.c
	* app/paint-funcs/paint-funcs.c
	* app/widgets/picmancontrollerkeyboard.c
	* app/widgets/picmancontrollerwheel.c
	* app/widgets/picmancursor.c
	* app/widgets/picmandockable.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandockseparator.c
	* libpicman/picmanbrushselect.c
	* libpicman/picmanfontselect.c
	* libpicman/picmangradientselect.c
	* libpicman/picmanpaletteselect.c
	* libpicman/picmanpatternselect.c
	* libpicmanwidgets/picmanchainbutton.c
	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c
	* libpicmanwidgets/picmanpickbutton.c
	* libpicmanwidgets/picmanstock.c: sprinkled some const qualifiers.

2006-04-06  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c (picman_data_error_quark)
	* libpicmanconfig/picmanconfig-error.c (picman_config_error_quark)
	* libpicmanthumb/picmanthumb-error.c (picman_thumb_error_quark):
	g_quark_from_static_string() is already reasonably fast, not much
	point in caching the result.

2006-04-06  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.c: added some documentation.

2006-04-06  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-enums.h
	* libpicmanbase/picmanbaseenums.h: moved PicmanRunMode enum to libpicmanbase.

	* app/plug-in/plug-in-enums.c
	* libpicman/picmanenums.h
	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def: updated.

2006-04-06  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-types.h
	* app/plug-in/plug-in-proc-def.[ch]: removed...

	* app/pdb/Makefile.am
	* app/pdb/pdb-types.h
	* app/pdb/picmanpluginprocedure.[ch]: ...and added here. Virtualized
	get_progname().

	* app/pdb/picmantemporaryprocedure.[ch]: new class derived from
	PicmanPlugInProcedure.

	* app/pdb/picmanprocedure.[ch] (struct PicmanProcedure): remove union
	exec_method and all the structs it needed. Procedure execution is
	properly virtualized now. Removed picman_procedure_initialize() and
	grow the args and values arrays dynamically in
	picman_procedure_add_argument()/return_value(). Added marshal_func
	parameter to picman_procedure_new().

	* app/actions/plug-in-actions.c
	* app/actions/plug-in-commands.c
	* app/core/picman-gui.c
	* app/dialogs/file-save-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/file/file-utils.c
	* app/gui/gui-vtable.c
	* app/menus/plug-in-menus.c
	* app/plug-in/plug-in-def.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins-query.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanpluginaction.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/app.pl: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

	* app/pdb/picman-pdb.c: added uglyness to make the app link again.

2006-04-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/compose.c: add layers in the expected order.

	* plug-ins/common/decompose.c: fixed out-of-bounds access to layer
	array (bug #322310).

2006-04-06  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-run.[ch]: removed plug_in_repeat()...

	* app/actions/plug-in-commands.c: ...and merged it into
	plug_in_repeat_cmd_callback(). It's essentially the same code as
	plug_in_run_cmd_callback() and there's no reason (except
	historical ones) to keep its implementation separate.

2006-04-06  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/mkgen.pl
	* plug-ins/common/plugin-defs.pl: introduced a new parameter
	'extralibs' and changed mkgen.pl to treat this equally to
	'optional' for non-optional plug-ins that needs different libs on
	different platforms

	* plug-ins/common/Makefile.am: regenerated

2006-04-05  Michael Schumacher  <schumaml@cvs.gnome.org>

	* configure.in: don't exclude the screenshot plug-in on os_win32

	* plug-ins/common/Makefile.am: change $(SCREENSHOT) into screenshot
	to make the screenshot plug-in build and install on the Microsoft
	Windows platform.

2006-04-05  Sven Neumann  <sven@picman.org>

	* app/base/lut-funcs.[ch]: minor code cleanup, renamed a function,
	declared some functions as static.

	* app/core/picmandrawable-equalize.c: changed accordingly.

2006-04-05   Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c
	* app/widgets/picmanimagepropview.c
	* app/widgets/picmansizebox.c
	* app/widgets/picmantemplateeditor.c: replaced "dpi" with "ppi"
	(bug #326718).

2006-04-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc-frame.[ch]: added
	plug_in_proc_frame_get_return_vals().

	* app/plug-in/plug-in-run.c: removed plug_in_get_return_vals()
	and call plug_in_proc_frame_get_return_vals() instead.
	Don't leak stuff in case calling the plug-in fails.

2006-04-05  Tor Lillqvist  <tml@novell.com>

	* app/core/picmanobject.c (picman_object_get_memsize): Check if
	object->name is NULL before attempting to pass it to
	g_strdup_printf(). Use "anonymous" for unnamed objects.

2006-04-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c: pulse the progress when loading an
	animation because we cannot tell beforehand how many frames are to
	be loaded.

2006-04-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install):
	don't canonicalize names of GParamSpecs, they do this themselves.

2006-04-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-types.h
	* app/plug-in/plug-in-proc-def.[ch]: renamed to PicmanPlugInProcedure
	and made a GObject derived from PicmanProcedure (instead of having
	a pointer to a PicmanProcedure). Added image_types and file_magic
	utility functions taken from plug-ins.[ch]. Still lives in the
	same crappy files because I am undecided where to put it...

	* app/pdb/picmanprocedure.c (picman_procedure_real_execute): removed
	switch() statement and always call the internal marshaller because
	PicmanProcedure::execute() is properly overridden by
	PicmanPlugInProcedure now.

	* app/plug-in/plug-ins.[ch]: removed the mime_type and file_magic
	utilities added to PicmanPlugInProcedure.

	* app/actions/file-commands.c
	* app/actions/plug-in-actions.[ch]
	* app/actions/plug-in-commands.[ch]
	* app/core/picman-gui.[ch]
	* app/core/picman.[ch]
	* app/core/picmanimage.[ch]
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/dialogs/print-size-dialog.c
	* app/file/file-open.[ch]
	* app/file/file-save.[ch]
	* app/file/file-utils.[ch]
	* app/gui/gui-vtable.c
	* app/menus/plug-in-menus.[ch]
	* app/plug-in/plug-in-def.[ch]
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins-query.c
	* app/widgets/picmanactiongroup.[ch]
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanfiledialog.[ch]
	* app/widgets/picmanfileprocview.[ch]
	* app/widgets/picmanpluginaction.[ch]
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/plug_in.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c
	* app/pdb/plug_in_cmds.c: regenerated.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanprocedure.[ch]: made it a GObject. Removed member
	"static_proc". Renamed picman_procedure_init() to
	picman_procedure_initialize().

	* app/pdb/picman-pdb.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-proc-def.c
	* app/plug-in/plug-in-rc.c
	* app/xcf/xcf.c: changed accordingly.

	* tools/pdbgen/app.pl: register all internal procs
	dynamically. The static proc structs are gone.

	* tools/pdbgen/pdb/fileops.pdb: cosmetic change.

	* app/pdb/*_cmds.c: regenerated.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/procedural_db.[ch]
	* app/pdb/procedural-db-query.[ch]: removed...

	* app/pdb/picman-pdb.[ch]
	* app/pdb/picman-pdb-query.[ch]: ...and added namespacefied.

	* app/batch.c
	* app/actions/vectors-commands.c
	* app/core/picman.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/file/file-utils.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-params.c
	* app/plug-in/plug-in-proc-def.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-ins-query.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpatternselect.c
	* app/widgets/picmanpdbdialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/picmanargument.[ch]: removed...

	* app/pdb/picman-pdb-compat.[ch]: ...and added with renamed functions.
	Added picman_pdb_compat_param_spec().

	* app/pdb/picmanprocedure.[ch]: removed picman_procedure_add_compat_arg()
	and _add_compat_value(). Use picman_pdb_compat_param_spec() plus
	picman_procedure_add_argument()/return_value() instead.

	* app/pdb/procedural-db-query.c
	* app/pdb/procedural_db.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-params.c
	* app/plug-in/plug-in-rc.c
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/xcf/xcf.c: no need to use compat functions here.

	* app/pdb/procedural_db_cmds.c: regnerated.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview-dnd.c
	(picman_container_tree_view_drag_leave)
	(picman_container_tree_view_drag_motion): use the correct API to
	unset the tree view's drop indicator. Apparently using the wrong
	API has stopped working due to changes in GtkTreeView...

2006-04-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c (save_image): nicer progress update when
	saving GIF animations.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gifload.c (ReadImage): update the progress text
	to show the frame number when loading multi-frame GIFs.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/pdb/pdb-types.h
	* app/pdb/picmanargument.[ch]: removed struct PicmanArgument, struct
	PicmanArgumentSpec, picman_argument_init() and
	picman_arguments_destroy().

	* app/pdb/picmanprocedure.h (struct PicmanProcedure): use arrays of
	GParamSpec* for kepping proc inargs/outargs.

	* app/pdb/picmanprocedure.[ch]
	* app/pdb/procedural_db.[ch]
	* app/plug-in/plug-in-params.[ch]
	* app/plug-in/plug-in-proc-frame.[ch]
	* app/plug-in/plug-in-run.[ch]: use GValueArrays for procedure
	arguments and return values. Removed all n_args and n_return_vals
	parameters because GValueArrays know their length.

	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/pdb/procedural-db-query.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpatternselect.c
	* app/widgets/picmanpdbdialog.[ch]
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly. Also
	removed #include "picmanargument.h" from most files.

	* app/pdb/*_cmds.c: regenerated.

2006-04-04  Sven Neumann  <sven@picman.org>

	* app/text/picmanfont.c: moved new code to a utility function. Avoid
	use of deprecated Pango API. Removed tabs and trailing whitespace.

2006-04-04  Tor Lillqvist  <tml@novell.com>

	* app/text/picmanfont.c (picman_font_get_new_preview): Provide
	script-specific short sample strings instead of "Aa" for fonts
	that seem to be designed for some specific non-Latin
	script. Pending a complete redesign and reimplementation of font
	selection, this is at least an improvement, and a partial solution
	to #137624.

2006-04-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c (plug_in_params_to_args): don't
	compare GType with PicmanPDBArgType (never "clean up" before
	committing ;)

2006-04-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: added a shitload of new GTypes and
	corresponding GParamSpecs to use them as PDB arguments.
	Each PicmanPDBArgType has one or more corresponding GTypes in the
	core now.

	* app/pdb/picmanargument.[ch] (struct PicmanArgument)
	(struct PicmanArgumentSpec): removed "type" member because the
	GValue's/GParamSpec's GType carries just as much information now.

	(picman_argument_type_to_pdb_arg_type): new function which maps
	GTypes to PicmanPDBArgType.

	(picman_pdb_arg_type_to_string): formerly known as
	procedural_db_type_name().

	* app/pdb/picmanprocedure.[ch]
	* app/pdb/procedural_db.[ch]: completely switch to GValue. Use the
	new GParamSpecs for procedure arguments. PicmanPDBArgType is only
	used for adding compat args/values of plug-in procedures.

	(procedural_db_run_proc): the va_list expects a sequence of
	(GType, value, GType, value, ..., G_TYPE_NONE) now.

	* app/plug-in/plug-in-params.[ch]: changed accordingly.

	(plug_in_param_defs_check): removed this function.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install): use
	plug_in_proc_args_check() instead and initialize the PicmanProcedure
	before doing so.

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb.pl: use the new param spec types and their
	utility functions. Changed argument/value registration
	accordingly.

	* app/pdb/procedural-db-query.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpatternselect.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-04-03  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: remove newline flood.

	* app/pdb/internal_procs.c: regenerated shorter.

2006-04-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: improved API documentation for
	picman-drawable-fill (bug #336864).

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.c: regenerated.

2006-04-03  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c: reduced precision of the
	display of time since the last change.

2006-04-03  Sven Neumann  <sven@picman.org>

	* app/tools/picmanscaletool.c: added a PicmanSizeBox as a replacement
	for the InfoDialog widgets. Needs more work ...

2006-04-03  Sven Neumann  <sven@picman.org>

	* desktop/Makefile.am: added an install hook that touches the
	toplevel icon theme directory as required by the spec.

2006-04-02  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c: handle storage of PICMAN_PDB_INT32
	plug-in params in GValues of type G_TYPE_UINT, they are used for
	guides and tattoos.

	* tools/pdbgen/pdb/guides.pdb (image_find_next_guide): don't
	validate the "guide" parameter, because 0 is an allowed value
	here.

	* app/pdb/guides_cmds.c: regenerated.

2006-04-02  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: square constraint with shift key.

2006-04-02  Michael Natterer  <mitch@picman.org>

	Silence compiler warnings about...

	* app/config/picmanrc-unknown.c: ...unused return value of
	g_slist_concat().

	* app/tools/picmandrawtool.c: ...uninitialized variabe.

	* app/xcf/xcf-save.c: ...pointer signedness.

2006-04-02  Michael Natterer  <mitch@picman.org>

	* libpicman/picmantile.c (picman_tile_cache_insert): silence warning
	about unused return value of g_list_concat().

2006-04-02  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: added a const_type member to all PDB types.
	Removed casts from all get_value_funcs which return const
	pointers, they can stay const now.

	* tools/pdbgen/app.pl: use the const_type to declare input args.

	* app/pdb/picmanprocedure.h: pass const arguments to the internal
	marshallers.

	* app/xcf/xcf.c: changed accordingly.

	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/paths.pdb: added some const qualifiers.

	* tools/pdbgen/lib.pl: use the const_type for input args instead
	of adding the const qualifier based on the type.

	* app/pdb/_cmds.c
	* libpicman/picmanparasite_pdb.[ch]: regenerated.

	Unrelated:

	* app/pdb/picmanargument.c (picman_arguments_destroy): no need any
	more to destroy the argument array in reverse order (we don't need
	access to the previous element because arrays in GValues memory
	manage themselves now).

2006-04-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparasitelist.[ch] (picman_parasite_list_add): removed
	the return value again.

	(picman_parasite_list_find): return a const parasite.

	* app/core/picman-parasites.[ch]
	* app/core/picmanimage.[ch]
	* app/core/picmanitem.[ch] (*_parasite_attach): take a const
	parasite. Make a local copy of the parasite struct because
	picman_parasite_shift_parent() changes it.

	(*_parasite_find): return a const parasite.

	* app/core/picmantemplate.c
	* app/text/picmantextlayer-xcf.c
	* app/xcf/xcf-load.c: changed accordingly.

2006-04-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-undo-push.[ch]
	(picman_image_undo_push_image,item_parasite): use "const PicmanParasite*"
	instead of gpointer for the parasite parameter.

	* app/core/picmanparasitelist.[ch] (picman_parasite_list_add): added
	const to the parasite parameter, return the actually added
	parasite (which is a copy).

	* app/core/picmanunit.[ch] (_picman_unit_new): added const to all
	string parameters.

2006-04-02  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/lib.pl: use the variable initializer defined with
	the PDB type instead of figuring it manually. Removed a line of
	code that checked for enums without "Picman" prefix.

	* libpicman/picmanbrush_pdb.c
	* libpicman/picmanchannel_pdb.c
	* libpicman/picmancontext_pdb.c
	* libpicman/picmangradient_pdb.c
	* libpicman/picmanlayer_pdb.c
	* libpicman/picmanunit_pdb.c
	* libpicman/picmanvectors_pdb.c: all doubles are initialized with 0.0
	instead of 0 now.

2006-04-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: removed PICMAN_TYPE_PARASITE,
	PICMAN_TYPE_PARAM_PARASITE and the PicmanRGB utility functions. Some
	fixes/cleanup in the new array and string array code.

	* libpicmanbase/picmanbase.def
	* libpicmanbase/picmanparasite.[ch]
	* libpicmancolor/picmancolor.def
	* libpicmancolor/picmanrgb.[ch]: added the parasite and rgb stuff here.

	* app/pdb/picmanargument.c: #include "libpicmanbase/picmanbase.h"

	* app/pdb/procedural_db.c: removed unused variable.

2006-04-01  Karine Delvare  <edhel@picman.org>

	* app/tools/picmannewrectselecttool.c: don't automatically
	auto-shrink.

2006-04-01  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: added struct PicmanArray which can
	keep static or allocated data. Added boxed types PICMAN_TYPE_ARRAY
	and PICMAN_TYPE_STRING_ARRAY. Added GParamSpecs for PDB int32,
	int16, int8, float and string arrays. Added functions to get, dup,
	set and set_static the various arrays from/to GValues.

	* app/pdb/picmanprocedure.c
	* app/pdb/procedural_db.c
	* app/plug-in/plug-in-params.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb.pl: use the new param pspecs and picman_value
	functions to keep arrays in PicmanArguments.

	* app/pdb/picmanargument.[ch] (picman_arguments_destroy): removed
	parameter "gboolean full_destroy". It's not needed any longer
	because the GValues fully memory-manage all their data now.

	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/dialogs/print-size-dialog.c
	* app/dialogs/resize-dialog.c
	* app/display/picmandisplayshell-handlers.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpdbdialog.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/pdb/brush_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/buffer_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/fonts_cmds.c
	* app/pdb/picmanargument.c
	* app/pdb/picmanargument.h
	* app/pdb/picmanprocedure.c
	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/pattern_cmds.c
	* app/pdb/patterns_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/vectors_cmds.c: regenerated.

	... and ported everything to perl btw...

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/pdb-types.h
	* app/pdb/picmanargument.h: renamed struct Argument to PicmanArgument
	and struct ProcArg to PicmanArgumentSpec.

	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/pdb/picmanargument.c
	* app/pdb/picmanprocedure.[ch]
	* app/pdb/procedural-db-query.c
	* app/pdb/procedural_db.[ch]
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-params.[ch]
	* app/plug-in/plug-in-proc-frame.h
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.[ch]
	* app/plug-in/plug-ins.c
	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanfontselect.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpaletteselect.c
	* app/widgets/picmanpatternselect.c
	* app/widgets/picmanpdbdialog.[ch]
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/picmanargument.[ch]: moved Argument and ProcArg structs
	and functions to these new files. Renamed functions to
	picman_argument_foo().

	* app/pdb/procedural_db.[ch]: removed them here.

	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/pdb/picmanprocedure.c
	* app/pdb/procedural_db_cmds.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-params.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpdbdialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/fileops.pdb: changed #includes and function
	calls accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/pdb-types.h
	* app/pdb/picmanprocedure.h: renamed struct ProcRecord to
	PicmanProcedure. Added PICMAN_IS_PROCEDURE() which checks for != NULL.

	* app/pdb/picmanprocedure.c
	* app/pdb/procedural-db-query.c
	* app/pdb/procedural_db.[ch]
	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/file/file-open.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-proc-def.h
	* app/plug-in/plug-in-proc-frame.[ch]
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.[ch]
	* app/plug-in/plug-in.[ch]
	* app/plug-in/plug-ins-query.c
	* app/plug-in/plug-ins.[ch]
	* app/widgets/picmanhelp.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/app.pl: changed accordingly. Renamed 'proc_rec' and
	similarily named variables and parameters to 'procedure'.

	* tools/pdbgen/pdb/procedural_db.pdb: changed 'procedure'
	parameters to 'procedure_name'.

	* app/pdb/*_cmds.c
	* libpicman/picmanproceduraldb_pdb.[ch]: regenerated.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanprocedure.h (struct ProcRecord): added new member
	"gboolean static_strings", so the ProcRecord struct and its
	strings can be marked as static separately.

	* app/pdb/picmanprocedure.[ch] (picman_procedure_dispose): removed.

	(picman_procedure_free): don't free the struct if it's static.

	(picman_procedure_set_strings)
	(picman_procedure_set_static_strings)
	(picman_procedure_take_strings): new functions to set a procedure's
	strings.

	* app/pdb/procedural_db.c (procedural_db_free_entry): simply call
	picman_procedure_free() on all procedures, the memory-manage
	themselves now.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install): use
	picman_procedure_set_strings() instead of setting them manually.

	* app/xcf/xcf.c: register picman-xcf-load and picman-xcf-save
	dynamically so further ProcRecord struct changes don't affect this
	file.

	* tools/pdbgen/app.pl: set "static_proc" to TRUE for static procs.

	* app/pdb/*_cmds.c: regenerated.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc-def.h (struct PlugInProcDef)
	(plug_in_proc_def_set_icon): changed "icon_data" from gchar* to
	guint8*.

	* app/plug-in/plug-in-proc-def.c
	* app/plug-in/plug-in-rc.c
	* app/xcf/xcf.c: cast a bit to the fix resulting warnings. There
	are less casts needed than before.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanprocedure.[ch] (struct ProcRecord): added new member
	"gboolean static_proc" which indicates whether a ProcRecord struct
	and its strings are static.

	(picman_procedure_dispose): new function which frees the procedure's
	args and values, and its strings if it is not static.

	* app/xcf/xcf.c
	* tools/pdbgen/app.pl: set "static_proc" to TRUE for static procs.

	* app/pdb/procedural_db.c (procedural_db_free): call
	picman_procedure_free() or picman_procedure_dispose(), depending on
	procedure->static_proc.

	* app/pdb/procedural_db.h: removed #if 0'ed cruft.

	* app/plug-in/plug-in-proc-def.[ch]: removed
	plug_in_proc_def_get_proc().

	* app/file/file-open.c
	* app/file/file-save.c
	* tools/pdbgen/pdb/fileops.pdb: access proc_def->procedure directly.

	* app/pdb/*_cmds.c: regenerated.

2006-03-31  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am
	* app/dialogs/dialogs-types.h
	* app/dialogs/dialogs.c
	* app/dialogs/info-dialog.[ch]: good bye InfoDialog.

	* app/tools/picmanperspectivetool.[ch]
	* app/tools/picmanrotatetool.[ch]
	* app/tools/picmansheartool.[ch]
	* app/tools/picmantransformtool.[ch]: use PicmanToolDialog instead of
	InfoDialog and add the widgets manually.

	* app/tools/picmanscaletool.c: commented out use of InfoDialog. This
	tools still needs to be ported to PicmanToolDialog.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/picmanprocedure.[ch]: added picman_procedure_new() and
	picman_procedure_free() functions.

	* app/plug-in/plug-in-proc-def.h (struct PlugInProcDef): use a
	ProcRecord pointer instead of including the entire struct.

	* app/plug-in/plug-in-proc-def.c: use the new() and free()
	functions above to allocate/free the ProcRecord.

	* app/actions/plug-in-actions.c
	* app/actions/plug-in-commands.c
	* app/menus/plug-in-menus.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-in.c
	* app/plug-in/plug-ins-query.c
	* app/plug-in/plug-ins.c
	* app/xcf/xcf.c: changed accordingly.

	Unrelated:

	* app/pdb/picmanprocedure.c (picman_procedure_execute): be more verbose
	when warning about out-of-bounds parameter values.

	* tools/pdbgen/pdb/fileops.pdb: allow PICMAN_RUN_WITH_LAST_VALS for
	file_save because indirect saving (e.g. remote or compressed)
	needs it.

	* app/pdb/fileops_cmds.c: regenerated.

2006-03-31  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.c: fixed compiler warning and
	sprinkled some empty lines for readability.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_destroy): always set
	dockable->blurb to NULL, also if its memory is shared with
	dockable->name.

2006-03-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_new_pixbuf): use
	"gtk-dialog-question" instead of "picman-wilber-eek" to indicate a
	missing thumbnail.

2006-03-31  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/picmanprocedure.[ch]: new files containing the functions
	operating on *one* procedure. Factored out of procedural_db.[ch]
	and renamed to picman_procedure_foo().

	* app/pdb/procedural_db.[ch]: removed them here.

	* app/pdb/procedural-db-query.c
	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-proc-def.[ch]
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-ins.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpdbdialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/app.pl: changed #includes and function calls
	accordingly. No logic changed.

	* app/pdb/*_cmds.c: regenerated.

2006-03-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: applied a patch from Guillermo
	S. Romero that adds basic support for saving layer masks.

2006-03-30  Sven Neumann  <sven@picman.org>

	* app/paint/picmanclone.[ch]: use doubles for src coordinates. Added
	properties for "src-drawable", "src-x" and "src-y".

	* tools/pdbgen/pdb/paint_tools.pdb: resurrected cloning from
	drawables over the PDB. This used to be broken for quite a while.

	* app/pdb/paint_tools_cmds.c: regenerated.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_execute_proc): don't
	memset(0) the array of return values if the procedure didn't
	succeed. GValues don't like to be treated like that and I don't
	understand what the memsetting is good for. It just looks like a
	very bad hack.

	* app/file/file-open.c: additionally, don't access return_vals[>0]
	unless the procedure returned successfully.

	* app/core/picmanpdbprogress.c
	* app/widgets/picmanpdbdialog.c: procedural_db_run_proc() always
	returns non-NULL, no need to check for it.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/procedural_db.pdb: got rid of one more (the
	last?) perl utility function.

2006-03-30  Sven Neumann  <sven@picman.org>

	* app/core/picman-utils.[ch]: added picman_get_temp_filename().

	* tools/pdbgen/pdb/fileops.pdb (temp_name): removed the
	implementation here and call picman_get_temp_filename() instead.

	* app/pdb/fileops_cmds.c: regenerated.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.h (structs Argument and ProcArg): renamed
	member "arg_type" to "type".

	* app/pdb/procedural_db.c
	* app/pdb/procedural-db-query.c
	* app/actions/plug-in-commands.c
	* app/core/picmanpdbprogress.c
	* app/plug-in/plug-in-params.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-rc.c
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/pdb/fileops_cmds.c
	* app/pdb/procedural_db_cmds.c: regenerated.

2006-03-30  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_foreground_extract): actually increment
	the tile counter used to limit the number of progress updates.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_free_entry): also
	unref the ProcRecord's GParamSpecs.

2006-03-30  Sven Neumann  <sven@picman.org>

	* app/core/picmanparamspecs.c (picman_param_parasite_validate): return
	FALSE in case of a valid parasite.

2006-03-30  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.c (picman_wire_read, picman_wire_write):
	sprinkled a few G_UNLIKELY() macros to help the compiler.

2006-03-30  Sven Neumann  <sven@picman.org>

	* app/pdb/procedural_db.c (procedural_db_free_entry): actually
	free the memory allocated for the procedure entry.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.[ch] (struct Argument): replace the value
	union by a GValue.

	(procedural_db_argument_init)
	(procedural_db_compat_arg_init): new functions to initialize
	an Argument. They call g_value_init() on the Argument's value.

	(procedural_db_arguments)
	(procedural_db_return_values): initialize the returned Argument
	arrays so their GValues are ready to use. Allow to get the
	(unsuccessful) return values of a NULL ProcRecord.

	(procedural_db_destroy_args): g_value_unset() the values. Added a
	"gboolean full_destroy" parameter. Its only effect is to destroy
	PDB arrays, everything else is nicely memory managed by GValue.

	(procedural_db_execute)
	(procedural_db_run_proc): do GValue stuff. Added n_args and
	n_return_vals parameters to execute().

	(procedural_db_execute_proc): private function to execute a
	procedure. Validates the passed in arguments using the registered
	GParamSpecs before passing them to the resp. exec method.

	* app/plug-in/plug-in-params.[ch] (plug_in_params_to_args): needs
	an array of ProcArgs now in order to initialize the Arguments'
	GValues correctly. Passing NULL ProcArgs uses
	procedural_db_compat_arg_init(), so procedures (plug-ins)
	returning more values than expected work.

	(plug_in_args_to_params): do GValue stuff here too.

	(plug_in_args_destroy): removed this function,
	procedural_db_destroy_args() does the same now.

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_run):
	simplified quite a bit because everything returns n_return_values
	now. Call plug_in_params_to_args() only of the procedure was found.

	(plug_in_handle_proc_return_priv): pass ProcRecs to
	plug_in_params_to_args().

	* app/batch.c
	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/core/picmanpdbprogress.c
	* app/dialogs/about-dialog.c
	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-ins.c
	* app/plug-in/plug-in-progress.c
	* app/plug-in/plug-in-run.[ch]
	* app/widgets/picmanhelp.c
	* app/widgets/picmanpdbdialog.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly: don't
	g_new/g_free Argument arrays, always use procedural_db_foo()
	functions. Use GValue functions to get/set Arguments.

	* tools/pdbgen/pdb.pl: added get_value_func and set_value_func to
	all PDB types. Removed id_func, id_ret_func and check_func. Added
	flags which indicated that a type is an ID. Removed unused utility
	functions.

	* tools/pdbgen/lib.pl: use the flag instead of looking at
	functions and value types.

	* tools/pdbgen/app.pl: use the get_value_func and set_value_func
	to marshal inargs and outargs. Removed all checks performed on
	inargs because that's done by GParamSpec validation now. Added the
	missing bits to register excluded values with PicmanParamSpecEnum.

	* app/pdb/*_cmds.c: regenerated.

2006-03-30  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c (plug_in_param_defs_check): can't
	just cast the GPParamDefs to ProcArgs any more, their struct
	layouts are different now. Convert them into temporary ProcArgs
	before calling plug_in_proc_args_check()

2006-03-29  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch]: added PicmanParamSpecEnum, which is
	a GParamSpecEnum plus the possibility to exclude values.
	Fixed lots of validation functions.
	Made all structs and macros public.

2006-03-29  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_init_proc): switch to
	g_return_val_if_fail() because it got a return value.

2006-03-29  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/fileops.pdb (file_save): pass the filename, not
	a PicmanImage to file_utils_filename_to_uri(). Fixes bug #336527.

	* app/pdb/fileops_cmds.c: regenerated.

2006-03-29  Sven Neumann  <sven@picman.org>

	* desktop/picman.desktop.in.in: dropped the extension from the icon
	name (bug #336498).

2006-03-29  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable.pdb (drawable_type_with_alpha): fixed
	forgotten antique enum values (RGBA_GIMAGE -> PICMAN_RGB_IMAGE etc.)

	* app/pdb/drawable_cmds.c: regenerated.

2006-03-29  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.[ch] (procedural_db_init_proc): return the
	procedure.

	* tools/pdbgen/app.pl: use a local ProcRecord* variable so the
	generated code becomes more readable.

	* app/pdb/*_cmds.c: regenerated.

2006-03-29  Michael Natterer  <mitch@picman.org>

	* libpicman/picman.c (picman_run_procedure2): add newline to g_printerr().

2006-03-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am: added an explicit dependency to
	force creation of picman-wilber-pixbufs.h.

2006-03-29  Sven Neumann  <sven@picman.org>

	* desktop/Makefile.am
	* desktop/picman.png: removed.

	* desktop/16x16/picman.png
	* desktop/22x22/picman.png
	* desktop/24x24/picman.png
	* desktop/32x32/picman.png
	* desktop/48x48/picman.png
	* desktop/64x64/picman.png
	* desktop/scalable/picman.svg: new application icons in different
	sizes, contributed by Jakub Steiner.

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-wilber-32.png
	* themes/Default/images/stock-wilber-48.png: removed.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/wilber-16.png
	* libpicmanwidgets/wilber-32.png
	* libpicmanwidgets/wilber-48.png
	* libpicmanwidgets/wilber-64.png: new window icons, identical to the
	new application icons.

	* libpicmanwidgets/picmanwidgets-private.c: use the new window icons.

2006-03-29  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-params.c
	* app/plug-in/plug-in.c: string review.

2006-03-29  Tor Lillqvist  <tml@novell.com>

	* plug-ins/common/winprint.c (query): Make it compile again, add
	missing parameter to picman_install_procedure().

2006-03-28  Sven Neumann  <sven@picman.org>

        * configure.in (ALL_LINGUAS): removed "ka" until all po files have
	been added.

2006-03-28 Vladimer Sichinava  <vlsichinava@gmail.com>

        * configure.in: Added "ka" (Georgian) to ALL_LINGUAS

2006-03-28  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.[ch] (struct ProcArg): replace "name"
	and "description" by a GParamSpec.

	(procedural_db_init_proc)
	(procedural_db_add_argument)
	(procedural_db_add_return_value)
	(procedural_db_add_compat_arg)
	(procedural_db_add_compat_val): new functions which dynamically
	allocate and register arguments and return value arrays based on
	GParamSpecs.

	* app/pdb/procedural-db-query.c
	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-in-proc-def.c
	* app/plug-in/plug-in-rc.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* tools/pdbgen/app.pl: get rid of all ProcArg arrays and generate
	code that registers args and values with the procedures.

	* app/pdb/*_cmds.c: regenerated.

2006-03-28  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_drop_dockable): allow
	dropping of dockables from the same dockbook to the empty space
	next to the notebook tabs. This moves the dockable to the end.

2006-03-28  Sven Neumann  <sven@picman.org>

	* app/*: did a global gdisp -> display substitution.

2006-03-28  Sven Neumann  <sven@picman.org>

	* app/*
	* plug-ins/common/psd.c
	* plug-ins/rcm/rcm_misc.c: did a global gimage -> image substitution.

2006-03-28  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparamspecs.[ch] (picman_param_spec_string): reordered
	params to be consistent with other param specs.

	(picman_value_get_rgb): utility function which reads the value
	into a PicmanRGB struct, instead of returning a pointer.

	(picman_value_set_rgb): added for symmetry. Just calls
	g_value_set_boxed().

2006-03-28  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg.h: added a utility function to work around
	filename encoding problems when reading EXIF data (bug #335391).

2006-03-28  Sven Neumann  <sven@picman.org>

	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/picman.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/maze/maze.c
	* plug-ins/metadata/metadata.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/print/print.c
	* plug-ins/rcm/rcm.c
	* plug-ins/winsnap/winsnap.c: reviewed blurbs and marked them for
	translation.

2006-03-28  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_arguments): argh, get
	types from procedure->args, not procedure->values.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.[ch]: renamed procedural_db_return_args()
	to procedural_db_return_values() and added
	procedural_db_arguments(), which returns a newly allocated,
	initialized array of the procedure's arguments.

	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c
	* app/plug-in/plug-in-run.c
	* app/widgets/picmanhelp.c
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/fileops.pdb: changed accordingly, some cleanup.

	* app/pdb/*_cmds.c: regenerated.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.h (ArgMarshal): pass the ProcRecord as
	first parameter, so marshallers have access to their ProcRecord
	without the need for global variables.

	* app/pdb/procedural_db.c
	* app/xcf/xcf.c
	* tools/pdbgen/app.pl: changed addordingly.

	* tools/pdbgen/app.pl: removed support for invoke->proc. Introduce
	invoke->no_marshalling instead which indicates that invoke->code
	should be used literally as marshaller code, without any
	substitutions or generated variables.

	* tools/pdbgen/pdb/fileops.pdb: changed accordingly.

	* app/pdb/*_cmds.c: regenerated.

2006-03-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.c
	* app/tools/picmanforegroundselecttool.c: use Ctrl to switch between
	foreground and background refinement.

2006-03-27  Karine Delvare  <edhel@picman.org>

	* app/tools/picmannewrectselecttool.c: allow modifier keys to work.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/core/Makefile.am
	* app/core/picmanparamspecs.[ch]: new unused files. Checked in so
	they can be easily reviewed.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/paint/paint-enums.h: register PicmanBrushApplicationMode.

	* app/paint/paint-enums.c
	* tools/pdbgen/enums.pl: regenerated.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/enums.pl: was reordered by the commit below.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/base/base-enums.h
	* app/core/core-enums.h
	* app/plug-in/plug-in-enums.h: register some more enums.

	* app/plug-in/Makefile.am: added rules to generate plug-in-enums.c

	* app/base/base-enums.c
	* app/core/core-enums.c
	* app/plug-in/plug-in-enums.c: (re)generated.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/file/file-open.c
	* app/file/file-save.c
	* app/plug-in/plug-ins.c: use procedural_db_run_proc() instead of
	procedural_db_execute(). execute() should be avoided for anything
	but PDB-internal calls.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_run_proc): some fixes and
	more robustness:

	- Procedures return proc->num_values + 1 return values, not only
	  proc->num_values.
	- Allocate the Argment array with g_new0 and initialize all its
	  types before parsing the va_list.
	- Stop parsing the va_list on PICMAN_PDB_END, so passing less
	  parameters is possible.
	- Cleanup switch() cases.

2006-03-27  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmanrgb.c (picman_param_rgb_init): default to fully
	opaque black instead of fully transparent.

	(picman_param_spec_rgb): allow a NULL default value. Simply use the
	opaque black set in init().

2006-03-27  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_run_proc): return a
	proper CALLING_ERROR on parameter type mispatch, not just NULL.

	* app/pdb/procedural_db.h: removed unused struct NetExec.

2006-03-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/fade-outline.scm: simplified blurb.

2006-03-27  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: applied changes from Kristian Jantz that
	improve the progress update from the SIOX routine.

2006-03-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/lib.pl: removed support for arg->implicit_fill.

	* tools/pdbgen/pdb/progress.pdb (progress_init): remove it without
	replacement, the generated function on the libpicman side is
	internal anyway.

	* libpicman/picmanprogress_pdb.[ch] (_picman_progress_init): regenerated
	with a display_ID parameter.

	* libpicman/picmanprogress.c (picman_progress_init): pass
	picman_default_display() to _picman_progress_init().

2006-03-26  Karine Delvare  <edhel@picman.org>

	* app/tools/picmancropoptions.c
	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangletool.[ch]: moved options gui creation
	from the tool to the options.

	* app/tools/picmanselectionoptions.c
	* app/tools/picmannewrectselecttool.[ch]
	* app/tools/picmanellipseselecttool.[ch]: ported ellipse selection
	tool to the new rectangle interface.

2006-03-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantool.[ch]
	* app/tools/tool_manager.[ch]: add "gboolean proximity" parameter
	to PicmanTool::oper_update() in order to emphasize its importance
	and to avoid peeking around in the PicmanDisplayShell struct.

	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancolortool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanselectiontool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: changed accordingly. Got rid of
	quite some "display/picmandisplayshell.h" includes.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): pass shell->proximity to
	tool_manager_oper_update_active().

2006-03-25  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmanvectortool.c (PicmanTool::oper_update): don't push
	status messages when shell->proximity is FALSE. Make sure the old
	status message gets popped regardless of shell->proximity's
	value. Fixes stuck status bar messages.

2006-03-25  Karine Delvare  <edhel@picman.org>

	* app/tools/picmanrectangletool.c: react to highlight notification.
	Fixes bug #335652.

2006-03-25  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: factored out a utility function. I need it
	in another pretty messed up tree ;)

2006-03-25  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb
	* tools/pdbgen/pdb/text_tool.pdb: removed all ':' before and all
	'()' around %%desc%%.

	* tools/pdbgen/app.pl: add () to int32, float and boolean
	descriptions automatically. They all look the same now.

	* tools/pdbgen/lib.pl: tweaked regex so %%desc%% doesn't appear in
	libpicman API docs.

	* app/pdb/brush_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/context_cmds.c
	* app/pdb/floating_sel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/text_tool_cmds.c
	* libpicman/picmanedit_pdb.c
	* libpicman/picmanplugin_pdb.c: regenerated.

2006-03-24  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb: replace '<' by '<=' in all
	int32 ranges so they specify min and max values.

	* app/pdb/channel_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/drawable_transform_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c: regenerated.

2006-03-24  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/transform_tools.pdb
	* tools/pdbgen/pdb/undo.pdb
	* tools/pdbgen/pdb/vectors.pdb: replaced 'True', 'true' and
	'non-zero' by 'TRUE' where appropriate. Added %%desc%% to enum arg
	descriptions where missing. Get object names using
	picman_object_get_name(). Set 'success' more consistently. Removed
	{ } from all enum arg descriptions...

	* tools/pdbgen/app.pl (make_arg_recs): ...and add the { }
	generically here. Removed some code that replaced the ',' by 'or'
	for enums without { } so all enums are now documented the same.

	* app/pdb/<some>_cmds.c
	* libpicman/<some>_pdb.c: regenerated.

2006-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_thumbnail_image): close the file
	descriptor.

2006-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mapcolor.c
	* plug-ins/common/warp.c: avoid using FG and BG.

2006-03-24  Sven Neumann  <sven@picman.org>

	* app/actions/colormap-editor-actions.c
	* app/actions/gradient-editor-actions.c
	* app/actions/palette-editor-actions.c
	* app/core/picman-edit.c
	* app/core/picmanchannel-select.c: some more string changes, mainly
	avoiding the use of FG and BG in labels where there's no need for
	being concise.

2006-03-24  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectselecttool.c: renamed from "Rect Select" to
	"Rectangle Select" (bug #335715).

	* app/core/picmanchannel-select.c (picman_channel_select_rectangle):
	string change (bug #335715).

	* plug-ins/common/svg.c: follow the change to the file format
	label done in the shared-mime-info package (bug #335716).

	* configure.in: fixed the --without-libtiff case in the summary
	(bug #335764).

2006-03-23  Michael Natterer  <mitch@picman.org>

	* app/core/picman-gui.[ch]
	* app/gui/gui-vtable.c
	* app/plug-in/plug-in-progress.[ch]: pass displays around as
	PicmanObject, not as integer IDs.

	* tools/pdbgen/pdb/progress.pdb: changed accordingly.

	* app/pdb/progress_cmds.c
	* libpicman/picmanprogress_pdb.c: regenerated.

2006-03-23  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/stddefs.pdb: removed std_image_arg(),
	std_antialias_arg() and std_orientation_enum().

	* tools/pdbgen/pdb/*.pdb: changed accordingly. Did a global
	s/gimage/image/. Some more cleanup.

	* tools/pdbgen/pdb/grid.pdb
	* tools/pdbgen/pdb/guides.pdb: removed utility functions.

	* tools/pdbgen/pdb/vectors.pdb: reordered procedures. Removed
	obsolete procedure.

	* app/pdb/channel_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/grid_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/selection_tools_cmds.c
	* app/pdb/text_tool_cmds.c
	* app/pdb/undo_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmandrawable_pdb.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2006-03-23  Sven Neumann  <sven@picman.org>

	* themes/Small/gtkrc: commented out the hardcoded font setting.
	It's just wrong to do this until bug #325767 has been addressed.

2006-03-23  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayoptions.c: avoid code duplication by
	using a #define.

	* app/config/picmandisplayconfig.c: for fullscreen mode, default to
	the same settings as we do for normal editing mode.

2006-03-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c: converted shorts to gint16 and longs
	to gint32 to fix 64bit problems as reported in bug #335130.

2006-03-23  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_foreground_extract): fixed the potential
	problem that the cache wouldn't have been cleared correctly if
	both background and foreground areas are added at the same time.

2006-03-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/randomize.c: removed version number from dialog
	title, improved progress update.

2006-03-22  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: removed support for invoke->pass_through.

	* tools/pdbgen/pdb/fileops.pdb: added a C utility function and
	call it from both register_load_handler() and
	register_magic_load_handler() instead of letting the generated
	invokers call each other.

	* app/pdb/fileops_cmds.c: regenerated.

2006-03-22  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/buffer.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: more perl stuff flattened,
	cleanup, nitpickyness.

	* app/pdb/buffer_cmds.c
	* app/pdb/color_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c
	* libpicman/picmanselection_pdb.[ch]: regenerated.

2006-03-22  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_foreground_extract): fixed assertions and
	progress calculation.

2006-03-22  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/paths.pdb: deprecated path_get_point_at_dist()

	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

2006-03-22  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch] (siox_foreground_extract): let the caller
	specify a region of interest. Call the progress function more often.

	* app/core/picmandrawable-foreground-extract.c
	(picman_drawable_foreground_extract_siox): pass a region of interest
	to siox_foreground_extract() to speed up the SIOX tool.

2006-03-22  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: reordered vectors procedures.

	* tools/pdbgen/pdb/parasite.pdb: removed all utility functions
	and added parasite procedures for vectors.

	* tools/pdbgen/pdb/paths.pdb: removed get_visible() and
	set_visible(), deprecated all procedures that are already
	implemented in the vectors namespace.

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/vectors.pdb: minor cleanup.

	* libpicman/picman.def: changed accordingly.

	* app/pdb/channel_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/parasite_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanparasite_pdb.[ch]
	* libpicman/picmanpaths_pdb.[ch]
	* libpicman/picmanvectors_pdb.c: regenerated.

2006-03-22  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.h: export PicmanBrushGeneratedShape to the PDB.

	* tools/pdbgen/pdb/brush.pdb: use it instead of int32.

	* libpicman/picman.def: add picman_brush_generated_shape_get_type().

	* tools/pdbgen/pdb/brush_select.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/display.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/floating_sel.pdb
	* tools/pdbgen/pdb/font_select.pdb
	* tools/pdbgen/pdb/fonts.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/help.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/misc.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/palette_select.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/pattern_select.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/text_tool.pdb: more perl/C code separation,
	removed some more utility functions, cleanup.

	* app/pdb/brush_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/fonts_cmds.c
	* app/pdb/picmanrc_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/patterns_cmds.c
	* tools/pdbgen/enums.pl
	* libpicman/picmanbrush_pdb.[ch]
	* libpicman/picmanenums.c.tail
	* libpicman/picmanenums.h: regenerated.

2006-03-21  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/gradient.pdb: removed all perl utility
	functions. Added some C ones instead. Doc fixes.

	* app/pdb/gradient_cmds.c
	* libpicman/picmangradient_pdb.c: regenerated.

2006-03-21  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: removed properties that are
	rather internal states.

2006-03-21  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangletool.[ch]: hide properties accessors.

2006-03-21  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmancropoptions.c: use PICMAN_RECTANGLE_OPTIONS_PROP_LAST
	instead of duplicating properties.

2006-03-21  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: removed support for arg->cond.

	* tools/pdbgen/edit.pdb
	* tools/pdbgen/image.pdb: move its logic into the C code.

	* app/pdb/edit_cmds.c
	* app/pdb/image_cmds.c: regenerated.

2006-03-19  Michael Natterer  <mitch@picman.org>

	* app/core/core-types.h: define PICMAN_COORDS_DEFAULT_VALUES, a
	struct initializer for PicmanCoords.

	* app/core/picmanimage-snap.c
	* app/paint/picmanpaintcore-stroke.c
	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanvectors-compat.c
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/vectors.pdb: use it here.

	* app/pdb/paint_tools_cmds.c
	* app/pdb/vectors_cmds.c: regenerated.

2006-03-19  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.c: untabbified.

2006-03-19  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: remove some code that has no effect on the
	generated code any more.

2006-03-18  Sven Neumann  <sven@picman.org>

	* app/actions/context-actions.c: added more action blurbs.

	* menus/image-menu.xml.in: moved toolbox and fg/bg color actions
	to the bottom of the Tools menu.

2006-03-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl
	* tools/pdbgen/pdb/progress.pdb: got rid of the unused
	arg->no_id_lookup.

	* tools/pdbgen/pdb/plug_in.pdb: flattened a forgotten foreach().

2006-03-18  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c
	* app/actions/select-actions.c
	* app/actions/view-actions.c: added more action blurbs.

2006-03-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/unit.pdb: got rid of all perl utility
	functions.

	* app/pdb/unit_cmds.c: regenerated.

2006-03-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: got rid of all perl utility
	functions.

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.c: regenerated.

2006-03-18  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/app.pl: removed support for arg->on_success and
	arg->on_fail.

	* tools/pdbgen/pdb/gradient_select.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/paint_tools.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: moved their logic to the C
	code.

	* app/pdb/gradient_select_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/paint_tools_cmds.c
	* app/pdb/selection_tools_cmds.c: regenerated.

2006-03-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/lic.c: applied a patch from Karine Delvare that
	fixes a performance problem in the Van Gogh plug-in (bug #113615).

2006-03-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanplugin.py: _run should pass on the return
	value. Fixes bug #334874.

2006-03-17  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: generically map NULL to -1 when returning
	object IDs.

	* tools/pdbgen/app.pl: remove support for "return_fail => foo"
	which did the same on a per-return-value basis. Removed some more
	obscure perl without any effect on the generated code.

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/text_tool.pdb: don't use "return_fail => foo".

	* app/pdb/channel_cmds.c
	* app/pdb/display_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/drawable_transform_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/transform_tools_cmds.c
	* app/pdb/vectors_cmds.c: regenerated.

2006-03-17  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: removed all remaining utility
	functions, some cleanup and doc fixes.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-03-17  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]
	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: allow to use red, green or
	blue for the selection preview used by the foreground selection tool.

2006-03-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/*.c: removed trailing period from procedure blurbs.

2006-03-16  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: replaced code generated by now gone
	utility functions list_proc() and type_move() by pdbgen
	boilerplate code. Fixed wrapper of picman_image_lower_channel() to
	actually lower the channel (it was lowering the active layer).

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.[ch]: regenerated.

2006-03-15  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/animoptimize.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/autocrop.c
	* plug-ins/common/autostretch_hsv.c
	* plug-ins/common/blinds.c
	* plug-ins/common/blur.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/c_astretch.c
	* plug-ins/common/cartoon.c
	* plug-ins/common/ccanalyze.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/color_enhance.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/compose.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/cubism.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/decompose.c
	* plug-ins/common/deinterlace.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/destripe.c
	* plug-ins/common/diffraction.c
	* plug-ins/common/displace.c
	* plug-ins/common/dog.c
	* plug-ins/common/edge.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/fp.c
	* plug-ins/common/fractaltrace.c
	* plug-ins/common/gauss.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/gnomeprint.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/grid.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/hot.c
	* plug-ins/common/illusion.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/laplace.c
	* plug-ins/common/lic.c
	* plug-ins/common/mail.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/mblur.c
	* plug-ins/common/mosaic.c
	* plug-ins/common/neon.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/noisify.c
	* plug-ins/common/normalize.c
	* plug-ins/common/nova.c
	* plug-ins/common/oilify.c
	* plug-ins/common/papertile.c
	* plug-ins/common/photocopy.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/plasma.c
	* plug-ins/common/plugin-browser.c
	* plug-ins/common/polar.c
	* plug-ins/common/procedure-browser.c
	* plug-ins/common/randomize.c
	* plug-ins/common/retinex.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sobel.c
	* plug-ins/common/softglow.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/spread.c
	* plug-ins/common/struc.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/tile.c
	* plug-ins/common/tileit.c
	* plug-ins/common/tiler.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/video.c
	* plug-ins/common/vinvert.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/warp.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c
	* plug-ins/common/winprint.c
	* plug-ins/common/zealouscrop.c: Give "helpful" blurbs to menu-
	accessible plugins, and mark them for translation.  Probably there
	is room for improvement in some of them.  Still needs to be done for
	plug-ins not in "common".

2006-03-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/channel.pdb
	* tools/pdbgen/pdb/layer.pdb: removed dim(), accessors(),
	get_prop() and set_prop() utility functions and expand everything
	to pdbgen boilerplate code. Use the real layer mask API instead of
	the crap from pdb_glue.h. Fixed some API docs.

	* app/pdb/channel_cmds.c
	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.c: regenerated.

	* app/pdb/Makefile.am
	* app/pdb/pdb_glue.h: bye bye uglyness.

2006-03-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb.pl: define init values for all pdb types.

	* tools/pdbgen/app.pl: unconditionally initialize all return
	values, and don't initialize any parameter.

	* tools/pdbgen/pdb/*.pdb: removed init => 1 from all arguments
	and return values.

	* app/pdb/*_cmds.c: regenerated.

2006-03-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/picmanrc.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/guides.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/layer.pdb
	* tools/pdbgen/pdb/message.pdb
	* tools/pdbgen/pdb/misc.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/undo.pdb
	* tools/pdbgen/pdb/unit.pdb: get rid of much more alias => 'foo'.
	Even more cleanup.

	* app/pdb/context_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/fileops_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/guides_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/layer_cmds.c
	* app/pdb/message_cmds.c
	* app/pdb/misc_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/plug_in_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/selection_cmds.c
	* app/pdb/undo_cmds.c
	* app/pdb/unit_cmds.c
	* libpicman/picmandrawable_pdb.[ch]
	* libpicman/picmanimage_pdb.[ch]: regenerated.

2006-03-15  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/context.pdb
	* tools/pdbgen/pdb/drawable.pdb
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/gradient.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/palette.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/pattern.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: let pdbgen handle *only*
	variables for arguments and return values and declare all local
	variables inside the C code. Removed lots of alias => '<expression>'
	and no_declare => 1 stuff from return values, instead let pdbgen
	declare the variables and assign them manually in the C code.
	More cleanup.

	* tools/pdbgen/app.pl: removed support for proc->vars.

	* app/pdb/brush_cmds.c
	* app/pdb/brushes_cmds.c
	* app/pdb/context_cmds.c
	* app/pdb/drawable_cmds.c
	* app/pdb/drawable_transform_cmds.c
	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/image_cmds.c
	* app/pdb/palette_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/paths_cmds.c
	* app/pdb/pattern_cmds.c
	* app/pdb/patterns_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/transform_tools_cmds.c
	* libpicman/picmanbrush_pdb.c
	* libpicman/picmanbrushes_pdb.c
	* libpicman/picmangradient_pdb.c
	* libpicman/picmangradients_pdb.c
	* libpicman/picmanpalette_pdb.c
	* libpicman/picmanpalettes_pdb.c
	* libpicman/picmanpatterns_pdb.c: regenerated.

2006-03-15  Sven Neumann  <sven@picman.org>

	* app/actions/channels-actions.c
	* app/actions/edit-actions.c
	* app/actions/file-actions.c
	* app/actions/image-actions.c
	* app/actions/layers-actions.c
	* app/actions/view-actions.c: added more action blurbs.

2006-03-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanaction.c (picman_action_set_proxy): enabled
	tooltips on all menu items for easier review of the action blurbs.
	This should be made configurable.

2006-03-15  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c
	* app/actions/layers-actions.c: added more tooltips, please review.

2006-03-14  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/*.pdb: remove lots of perl crack:
	- create almost	all parameter arrays manually instead of
	  generating them from utility functions
	- removed lots of other utility functions
	- moved variable declarations into the enclosed code snippets
	  where possible
	- some cleanup and API doc fixes

	* tools/pdbgen/stddefs.pdb: added some perl crack:
	define utility functions for all contributors which own more than
	some functions, so they can change their names and email addresses
	at a central place.

	* app/pdb/[many].c: regenerated.

	* libpicman/picmancolor_pdb.c
	* libpicman/picmandrawabletransform_pdb.c
	* libpicman/picmantransformtools_pdb.c
	* libpicman/picmanvectors_pdb.c: ditto. Changed affect only API docs.

2006-03-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-guides.[ch]: added picman_image_get_guide() and
	picman_image_get_next_guide(), which take a guide_ID and return the
	image's PicmanGuide with that ID (the one after that for next_guide())

	* tools/pdbgen/pdb/guides.pdb: use them instead of having this
	code here.

	* app/pdb/guides_cmds.c: regenerated.

2006-03-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_raise_layer_to_top,
	picman_image_lower_layer_to_bottom): silently return TRUE if the
	layer is already at the top (or the bottom respectively).

2006-03-11  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.h: added a const qualifier to the
	PicmanWireIOFunc signature.

	* libpicman/picman.c (picman_write)
	* app/plug-in/plug-in.c (plug_in_write): changed accordingly.

2006-03-10  Sven Neumann  <ven@picman.org>

	* app/widgets/picmanaction.c: factored out some code to a utility
	function.

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/dialogs/preferences-dialog.c
	* app/gui/gui.c
	* app/plug-in/plug-in-run.c
	* libpicman/picman.c
	* libpicmanbase/picmanprotocol.[ch]: renamed tool_tips to tooltips in
	variables and in the picmanrc.

	* app/config/picmanbaseconfig.[ch]: removed stingy_memory_use from
	the PicmanBaseConfig struct.

2006-03-10  Sven Neumann  <sven@picman.org>

	* modules/colorsel_water.c: remove color if Shift is pressed.

2006-03-10  Sven Neumann  <sven@picman.org>

	* app/actions/drawable-actions.c
	* app/actions/image-actions.c
	* app/actions/layers-actions.c: added tooltips, more to come here.

2006-03-10  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c (plug_in_actions_add_proc): use
	the procedure blurb as tooltip.

	* plug-ins/common/blur.c
	* plug-ins/common/gauss.c
	* plug-ins/common/mblur.c: rephrased some blurbs and marked them
	for translation.

	* app/pdb/procedural-db-query.c: formatting.

2006-03-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanuimanager.c: connect to the menu items' "select"
	and "deselect" signals instead of "enter-notify-event" and
	"leave-notify-event", so tooltips work with keynav.

2006-03-09  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c: show tooltps from the global image popup menu too.

2006-03-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanuimanager.[ch]: added "show-tooltip" and
	"hide-tooltip" signals. Connect to each menu item's
	enter-notify-event and leave-notify-event. On enter, emit
	show-tooltip, on leave emit hide-tooltip.

	* app/display/picmandisplayshell.c: connect to the menubar ui
	manager's show-tooltip and hide-tooltip signals and show the tip
	in the display's status bar.

2006-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c: create empty layers of image size instead
	of skipping empty layers in PSD files (bug #317044).

2006-03-09  Sven Neumann  <sven@picman.org>

	* libpicman/picmanexport.c (picman_export_image): offer the choice to
	Flatten or Merge Visible Layers (bug #332336).

2006-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: added accelerators for "close"
	and "quit" actions.

	* plug-ins/helpbrowser/dialog.c: added "close" to the popup menu.

2006-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.c (button_press): do not attempt to
	use a NULL function pointer.

	* plug-ins/imagemap/imap_preview.c: added some sanity checks.

2006-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: also add the popup menu to the
	standard playback window, not only to the detached one.

2006-03-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: register an icon, improved
	tooltips, some minor cleanups.

2006-03-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (find_max_blob): free the whole list instead of
	deleting it one element at a time.

2006-03-06  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay.c (picman_display_reconnect): keep a
	reference on the old image until the display is connected to the
	new one. Fixes bug #333568.

	* app/display/picmandisplay-handlers.c: fixed typo in comment.

	* app/actions/file-commands.c: cosmetics.

2006-03-05  DindinX  <dindinx@picman.org>

	* app/core/picmanimage-merge.c: fixed merge down (previously broken by a
	not that purely cosmetic change). Spotted by Amar Takhar.

2006-03-04  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_use_extension):
	use descriptive verbs in action buttons instead of Yes and No.

2006-03-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolordisplayeditor.c
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmancontrollerlist.c: set tooltips dynamically.

2006-03-03  Sven Neumann  <sven@picman.org>

	* app/dialogs/vectors-import-dialog.c (vectors_import_dialog_new)
	* app/widgets/picmanfiledialog.c (picman_file_dialog_add_filters):
	fixed capitalization of filter names.

2006-03-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/fileops.pdb:
	* app/dialogs/file-open-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/file/file-open.[ch]
	* app/widgets/picmanlayertreeview.c: pass the selected load procedure
	to file_open_layer() or NULL if none is selected. Fixes bug #333207.

	* app/pdb/fileops_cmds.c: regenerated.

2006-03-02  Manish Singh  <yosh@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_query): use proper sentinel type
	for gtk_dialog_set_alternative_button_order. Fixes bug #330800.

2006-03-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.c (picman_image_real_flush): made it a static
	function (was accidentially non-static).

2006-03-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpickable.[ch]: added new methods ::get_bytes() and
	::flush()

	* app/core/picmanchannel.c
	* app/core/picmandrawable.c
	* app/core/picmanimagemap.c
	* app/core/picmanprojection.c: implement ::get_bytes()

	* app/core/picmanprojection.c: implement ::flush() (immediately
	process both the idle renderer's queue and the unflushed update
	areas, to make sure that any reading from the projection will
	re-construct it).

	* app/core/picman-edit.c
	* app/core/picmanchannel.c
	* app/core/picmanimage-contiguous-region.c
	* app/core/picmanimage-crop.c
	* app/core/picmanpalette-import.c
	* app/paint/picmanclone.c
	* app/tools/picmanbycolorselecttool.c
	* app/tools/picmaniscissorstool.c
	* tools/pdbgen/pdb/image.pdb: use the pickable interface more
	consistently when reading from any drawable or the projection, and
	call picman_pickable_flush() before doing so. Fixes bug #332933.

	* app/core/picmanimage-pick-color.c: added comment why the we don't
	call picman_pickable_flush() here.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-03-02  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: corrected documentation for
	picman_image_[lower|raise]_layer(). We do not any longer refuse to
	raise and lower based on a missing alpha channel.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2006-03-02  Sven Neumann  <sven@picman.org>

	* autogen.sh: readded version check for glib-gettextize.

2005-03-02  Øyvind Kolås  <pippin@picman.org>

	* autogen.sh: added improved check_version() function that handles
	multiple digits in major/minor/micro.

2006-03-02  Sven Neumann  <sven@picman.org>

	* autogen.sh: removed version check for glib-gettextize. It didn't
	work with glib 2.10.x.

2006-03-01  Sven Neumann  <sven@picman.org>

	* app/about.h: use U+00A9 COPYRIGHT SIGN.

2006-02-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am
	* plug-ins/pypicman/pypicman-util.h: New file, provides only an
	initialization wrapper for now (pypicman_init_pygobject).

	* plug-ins/pypicman/picmancolormodule.c
	* plug-ins/pypicman/picmanenumsmodule.c: Use pypicman_init_pygobject here.
	Closes bug #332622.

2006-02-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmanimagefile.c
	* app/core/picmanpattern.c
	* app/dialogs/preferences-dialog.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanrectselecttool.c
	* app/widgets/picmanimagepropview.c
	* app/widgets/picmansizebox.c
	* app/widgets/picmantemplateeditor.c
	* plug-ins/common/ccanalyze.c
	* plug-ins/common/svg.c
	* plug-ins/common/wmf.c
	* plug-ins/imagemap/imap_cmd_guides.c
	* plug-ins/imagemap/imap_statusbar.c: use U+00D7 MULTIPLICATION SIGN
	instead of x when displaying sizes.

2006-02-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: coding style cleanup.

2006-02-27  Manish Singh  <yosh@picman.org>

	* app/base/cpu-accel.c
	* app/composite/picman-composite-3dnow.h
	* app/composite/picman-composite-mmx.h
	* app/composite/picman-composite-sse.h
	* app/composite/picman-composite-sse2.h: check for __PIC__ in addition
	to PIC.

2006-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.c: purely cosmetic change.

2006-02-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c (detach_callback): show the
	shape window with a small offset.

2006-02-26  Simon Budig  <simon@picman.org>

	* plug-ins/bmp/bmpwrite.c: properly round the resolution entry.
	Fixes bug #332501.

2005-06-26  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated

2006-02-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.c: added "drawable" as construct-only
	property so that the widget can be constructed using g_object_new().

2006-02-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmanaspectpreview.c: added "drawable" as construct-only
	property so that the widget can be constructed using g_object_new().

2006-02-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c: added "drawable" as construct-only
	property so that the widget can be constructed using g_object_new().

2006-02-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: use a normal toplevel window for
	the plug-in dialog. Moved the Help button to the toolbar. Use a
	toggle action for Play.

2006-02-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.h: added a define for PICMAN_STOCK_DETACH
	to the list of missing icons.

	* app/actions/dockable-actions.c: use PICMAN_STOCK_DETACH instead of
	GTK_STOCK_CONVERT.

	* plug-ins/common/animationplay.c: unveiled a long-standing secret
	feature of the Animation Playback plug-in by. Needs more love.

2006-02-25  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c (quit_close_all_dialog_container_changed):
	default to GTK_RESPONSE_CANCEL.

2006-02-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (remap_indexed_layer): fixed bug
	introduced by optimization (bug #332324).

2006-02-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (generate_histogram_gray): only
	count pixels with an alpha value > 127.

2006-02-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc.c (picman_rc_save)
	* app/gui/session.c (session_save): s/The PICMAN/PICMAN/

2006-02-24  Simon Budig  <simon@picman.org>

	* app/base/lut-funcs.c: change the LUT function for the contrast.
	Fixes the buggy behaviour as described in bug #319872 and
	bug #332068 and makes the behaviour consistent with the standard
	contrast formula. However, I am leaving the bug open to discuss
	further improvements.

	Untabbified.

2006-02-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.[ch]: added utility functions to send
	PicmanRGB values over the wire.

	* libpicmanbase/picmanprotocol.c: use the new functions.

2006-02-22  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors-import.c: fix the import of svg circles.

2006-02-21  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-data.[ch]: new files which keep the
	plug-in data list.

	* app/pdb/procedural_db.[ch]: removed here, it only cluttered the
	file with unrelated functionality.

	* app/core/picman.[ch]
	* app/actions/plug-in-commands.c
	* tools/pdbgen/pdb/procedural_db.pdb: changed accordingly.

	* app/pdb/procedural_db_cmds.c: regenerated.

2006-02-20  Michael Natterer  <mitch@picman.org>

	* app/actions/file-actions.c (file_actions_setup)
	* app/actions/plug-in-actions.c (plug_in_actions_setup): use ""
	instead of NULL for "no label" on an action (we can't rely on the
	stock item to provide the label that prevents the gtk warning from
	firing).

2006-02-20  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: zero division check should be
	changed according to the aspect redefinition

2006-02-20  Simon Budig  <simon@picman.org>

	* app/tools/picmanpaintoptions-gui.c: allow maximum jitter of 5.0.

2006-02-20  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/core/picman.[ch]: keep a history of recently used plug-ins.

	* app/plug-in/plug-in-run.[ch] (plug_in_repeat): pass an index
	into the plug-in history.

	* app/actions/plug-in-actions.c
	* app/actions/plug-in-commands.c
	* app/menus/plug-in-menus.c
	* menus/image-menu.xml.in: added a submenu with recently used
	plug-ins to the Filters menu. Fixes bug #148855.

2006-02-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmagnifytool.c: renamed to Zoom tool.

	* menus/image-menu.xml.in: changed accordingly.

2006-02-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfgbgview.c (picman_fg_bg_view_expose): tweaked
	drawing of shadows.

2006-02-20  Sven Neumann  <sven@picman.org>

	* etc/sessionrc: set tab-style for dockables.

2006-02-20  Sven Neumann  <sven@picman.org>

	* configure.in: updated comments.

2006-02-20  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/lighting_ui.c: use a check button instead of a
	toggle button.

2006-02-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mosaic.c: use a combo-box to select the tiling
	primitives.

2006-02-20  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/progress.pdb
	* libpicman/picmanprogress.[ch]: applied slightly modified patch from
	Stephane Chauveau.  Wraps the picman_progress_update() PDB call so
	that redundant progress updates are suppressed in libpicman.  This
	gives a noticeable speedup for all plug-ins that update the
	progress too often (bug #331470).

	* libpicman/picmanprogress_pdb.[ch]: regenerated.

2006-02-20  Sven Neumann  <sven@picman.org>

	* libpicman/picmanplugin.c (picman_plugin_icon_register): added a cast to
	get rid of a compiler warning.

2006-02-19  Tor Lillqvist  <tml@novell.com>

	* configure.in: Don't think we have Mac OS X TWAIN if on Win32.

2006-02-19  DindinX  <dindinx@picman.org>

	* plug-ins/common/mosaic.c: applied a (slightly modified) patch from
	Esben Mose Hansen which add triangles as a tile type.

2006-02-19  Manish Singh  <yosh@picman.org>

	* m4macros/binreloc.m4: introduce automake conditional USE_BINRELOC.

	* app/Makefile.am: ... and use the above here, so that -rpath is only
	specified when binreloc functionality is enabled. Fixes bug #331677.

2006-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gif.c (save_image): removed warning when reusing
	a color index for transparency. Shouldn't pose a problem for any
	GIF viewer and only confuses our users.

2006-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: added some const qualifiers and other
	minor cleanups.

2006-02-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: applied patch from Stephane Chauveau.
	Code cleanup and major performance improvements (bug #331569).

2006-02-18  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.c: as an experiment, removed the color
	and foo area from the toolbox and added a Colors dock to the
	default session.

2006-02-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/convmatrix.c (redraw_channels): check if the
	widget exists before setting its state.

2006-02-17  Sven Neumann  <sven@picman.org>

	* app/dialogs/desaturate-dialog.c: applied patch from Alexandre
	Prokoudine that adds a missing mnemonic (bug #331473).

2006-02-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/ifscompose/ifscompose_utils.c: applied patches from
	Stephane Chauveau. Reduces number of progress updates (bug #331470).

2006-02-17  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: use a scrolled window as
	suggested in bug #331436.

2006-02-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.c: as an experiment, changed default
	window hint for toolbox and docks to utility window.

2006-02-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: applied patch from Stephane Chauveau
	that corrects the calculation of the tile cache size (bug #331344).

2006-02-15  Carol Spears  <carol@picman.org>

	* plug-ins/pypicman/picmanfu.py: removed the snake image from the
        picman-python dialogs.

2006-02-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooldialog.c: do not unset focus-on-map for all
	tool dialogs.

	* app/tools/picmancolorpickertool.c
	* app/tools/picmanmeasuretool.c: explicitely do it here instead.

2006-02-15  Sven Neumann  <sven@picman.org>

	* app/dialogs/info-dialog.c: unset focus-on-map for info dialogs.

2006-02-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c (render_frame): applied patch
	from Michael Schumacher that fixes a potential crash in the
	plug-in (bug #328919).

2006-02-14  Sven Neumann  <sven@picman.org>

	Added some tool shortcuts:

	* app/tools/picmancroptool.c: Shift+C
	* app/tools/picmanfuzzyselecttool.c: changed from Z to U.
	* app/tools/picmanmagnifytool.c: Z.
	* app/tools/picmanmeasuretool.c: Shift+M.

2006-02-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/despeckle.c (despeckle_median): fixed incorrect
	loop boundaries. Should fix bug #331044.

2006-02-14  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.c
	* plug-ins/winicon/icosave.c: applied patches from Felix Pahl.
	Fixes incorrect bit shifts that caused scrambled transparency
	(bug #330692).

2006-02-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sparkle.c: renamed parameter from opacity to
	transparency, since that's how it is being used (bug #331086,
	spotted by Joao).

	* plug-ins/common/gauss.c (gauss): apply multiply_alpha() on the
	source buffer, not the destination (bug #331051, spotted by
	Stephane Chauveau).

2006-02-13  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.c: make the internal help browser the
	default for all platforms (bug #329888).

2006-02-13  Sven Neumann  <sven@picman.org>

	* configure.in: output a nicer and more complete summary.

2006-02-12  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanlayer.c: remove extra semicolon; fix for
	bug #330882 from Jens Granseuer.

2006-02-09  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.8.

2006-02-08  Sven Neumann  <sven@picman.org>

	* Made 2.3.7 development release.

2006-02-08  Roman Joost	<romanofski@picman.org>

	* data/images/picman-splash.png: splash screen for a new release

2006-02-08  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c: register menu branches for the
	web-browser script.

	* plug-ins/script-fu/scripts/web-browser.scm: string review.

2006-02-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c: use canonical property names.

2006-02-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/raw.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/helpbrowser/dialog.c
	* plug-ins/imagemap/imap_browse.c
	* plug-ins/print/picman_main_window.c: use canonical signal names.

2006-02-07  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.[ch]
	* libpicman/picmanzoompreview.c: reduced code duplication by exporting
	two PicmanDrawablePreview functions for internal use.

2006-02-07  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c
	(picman_scrolled_preview_area_event): fixed check that suppresses
	the redraw for motion events that don't cause the preview to scroll.

2006-02-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: applied a patch from Dennis
	Bjorklund that prevents a possible division by zero and fixes the
	calculation of the center point.

2006-02-07  Sven Neumann  <sven@picman.org>

	* app/core/picman-gui.c
	* app/widgets/picmantoolbox.c: use PICMAN_ACRONYM.

	* app/main.c (picman_show_version): use PICMAN_NAME.

	* app/about.h (PICMAN_LICENSE): s/This program/PICMAN/g

2006-02-06  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: added const qualifier.

2006-02-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.c: connect-after to "realize" and
	"size-allocate" signals of the preview area and call the
	set-cursor method from the callback.

	* libpicmanwidgets/picmanscrolledpreview.c: no need to explicitely set
	the cursor now that the virtual method is used correctly.

	* libpicman/picmanzoompreview.c: implement set-cursor and set the move
	cursor in accordance with the zoom factor.

2006-02-06  DindinX  <dindinx@picman.org>

	* plug-ins/common/mblur.c: length should at least be 1, or the zoom
	mode will produce garbage. length==0 is useless in other modes.
	(reported by daelstorm on freenode/#picman)

2006-02-03  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/ripple.c: Fixed antialiasing.  Replaced "black"
	with "blank".  Fixes bug #308750

2006-02-03  Carol Spears  <carol@picman.org>

	* app/tools/picmanrectangletool.c: Applied patch from Joao S. O. Bueno
	Calligaris that corrects status bar coordinate display.  Fixes bug
        #329817

2006-02-04  DindinX  <dindinx@picman.org>

	* plug-ins/common/pnm.c: untabbified and some other small
	style-related fixes.

2006-02-03  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: aspect ratio should be width /
	height.

2006-02-01  Matt Wilson  <msw@picman.org>

	* plug-ins/common/compressor.c (run): file_{gz,bz2}_save takes 5
	parameters, not 4.  Correct the nparams check in non-interactive
	mode.

2006-02-01  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animoptimize.c: renamed to "Unoptimize".

	* plug-ins/common/polar.c: renamed to "Polar Coordinates" and some
	other string changes.

2006-02-01  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_about.c
	* plug-ins/imagemap/imap_file.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_preferences.c: renamed to "Image Map" and
	unified spelling.

2006-01-31  Michael Schumacher  <schumaml@cvs.gnome.org>

	* app/core/picmanbrushpipe.c: applying a patch by Joao S. O. Bueno
	Calligaris which implements PIPE_SELECT_VELOCITY for brush
	pipes. Fixes bug #150227.

2006-01-31  Sven Neumann  <sven@picman.org>

	* app/tools/picmanlevelstool.c (picman_levels_tool_color_picker_new):
	manually add the icons to the color picker buttons instead of
	abusing the stock-id property. Fixes bug #325745.

2006-01-31  Michael Natterer  <mitch@picman.org>

	* autogen.sh: s/head -1/head -n 1/ (spotted by brix).

2006-01-30  Akkana Peck	 <akkana@cvs.gnome.org>

	* configure.in: don't report yes for xjt if on Windows.

2006-01-30  Michael Schumacher  <schumaml@cvs.gnome.org>

	* app/tools/picmanmeasuretool.c: use the closest corner of the
	current pixel as origin. Fixes bug #329000.

2006-01-30  Sven Neumann  <sven@picman.org>

	* app/config/config-types.h: moved PICMAN_PARAM defines from here ...

	* libpicmanbase/picmanparam.h: ... to this new files.

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbasetypes.h: include the new header file.

	* libpicman/picmanfontselectbutton.c
	* libpicmanconfig/picmancolorconfig.c
	* libpicmanthumb/picmanthumbnail.c
	* libpicmanwidgets/picmancellrenderercolor.c
	* libpicmanwidgets/picmancellrenderertoggle.c
	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmancolordisplay.c
	* libpicmanwidgets/picmancontroller.c
	* libpicmanwidgets/picmandialog.c
	* libpicmanwidgets/picmanenumcombobox.c
	* libpicmanwidgets/picmanintcombobox.c
	* libpicmanwidgets/picmanpageselector.c
	* libpicmanwidgets/picmanpreview.c
	* libpicmanwidgets/picmanpreviewarea.c
	* libpicmanwidgets/picmanzoommodel.c: use the PICMAN_PARAM defines to
	avoid unnecessary string allocations.

2006-01-29  Michael Natterer  <mitch@picman.org>

	* autogen.sh: make autoconf check more robust and the generic
	"Tool old" error message more verbose.

2006-01-29  Akkana Peck	 <akkana@cvs.gnome.org>

	* configure.in: Print a table of features enabled/disabled
        at the end (as discussed in bug 303383c11 and c13).

2006-01-29  Roman Joost	 <romanofski@picman.org>

	* plug-ins/script-fu/scripts/web-browser.scm: adds eight
	bookmarks to the user manual (Basics, Dialogs and Docks, Drawing
	Simple Objects, Fileformats, Photography, Preparing for the Web,
	Using Paths). It also adds a new link to http://docs.picman.org.

2006-01-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanthumbbox.c: some finetuning to the labels.

2006-01-25  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.[ch]: added a priv pointer to the
	instance struct and changed the GET_PRIVATE() macro to access the
	private data via that pointer.

2006-01-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.[ch]
	* libpicmanwidgets/picmanpageselector.[ch]
	* libpicmanwidgets/picmanzoommodel.[ch]: added a priv pointer to the
	instance struct and changed the GET_PRIVATE() macro to access the
	private data via that pointer.

	* libpicmanwidgets/picmanscrolledpreview.[ch]
	* libpicmanwidgets/picmanwidgets.def: added a priv pointer to the
	instance struct and moved all private data to the
	PicmanScrolledPreviewPrivate struct. Added freeze/thaw methods so
	that derived widgets can be implemented without accessing private
	data.

	* libpicman/picmanzoompreview.c: use picman_scrolled_preview_[freeze|thaw].

	* libpicman/picmanfontselectbutton.[ch]: let the priv pointer be an
	anonymous void pointer.

2006-01-25  Sven Neumann  <sven@picman.org>

	* docs/picman.1.in: document some more environment variables.

	* docs/picmanrc.5.in
	* docs/picmantool.1.in: unified spelling of "plug-in".

2006-01-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/guides-new.scm
	* plug-ins/script-fu/scripts/guides-new-percent.scm: allow guides
	at the right and bottom edges of the canvas. Fixes bug #328320.

2006-01-21  Simon Budig  <simon@picman.org>

	* desktop/picman.desktop.in.in: Added "GTK" category. Fixes
	bug #328012.

        * tools/pdbgen/pdb/vectors.pdb: removed unused variables.
	* app/pdb/vectors_cmds.c: regenerated.

2006-01-21  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangletool.c: indentation fixes.

2006-01-20  Michael Natterer  <mitch@picman.org>

	* configure.in: applied modified patch from Henrik Brix Andersen
	which adds the possibility to build --without-alsa, even if alsa
	is available. Fixes bug #327777.

2006-01-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_dispose):
	don't call g_free() on a widget pointer. Fixes bug #327639.

2006-01-18  Michael Natterer  <mitch@picman.org>

	* app/config/config-types.h: define PICMAN_PARAM_STATIC_STRINGS
	which is G_PARAM_STATIC_NAME|NICK|BLURB. Also define
	PICMAN_PARAM_READABLE, _WRITABLE and _READWRITE which include
	PICMAN_PARAM_STATIC_STRINGS.

	* app/*/*.c: use them for all object properties so their
	strings are not copied.

2006-01-17  Michael Natterer  <mitch@picman.org>

	* app/dialogs/quit-dialog.c (quit_close_all_dialog_new):
	s/preview-size/view-size/

2006-01-17  Michael Natterer  <mitch@picman.org>

	* app/dialogs/image-new-dialog.c (image_new_dialog_new): one
	more s/preview-size/view-size/.

2006-01-17  Raphaël Quinet  <raphael@picman.org>

	* tools/pdbgen/pdb/buffer.pdb
	* tools/pdbgen/pdb/color.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/guides.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/paths.pdb
	* tools/pdbgen/pdb/selection.pdb
	* tools/pdbgen/pdb/selection_tools.pdb: removed trailing
	whitespace in the parts of these files generating C code.

	* app/composite/make-installer.py (print_function_table): updated
	so that the code does not add trailing whitespace in generated
	function tables.

	* (about 130 *.[ch] files): automatically removed trailing
	whitespace from 3460 lines.

2006-01-17  Sven Neumann  <sven@picman.org>

	* app/about.h (PICMAN_COPYRIGHT): updated year in copyright.

	* app/actions/dialogs-actions.c: string change.

2006-01-17  Michael Natterer  <mitch@picman.org>

	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.[ch]
	* app/dialogs/dialogs-constructors.[ch]
	* app/dialogs/dialogs.c
	* app/display/picmandisplayshell-layer-select.c
	* app/widgets/picmanbrusheditor.[ch]
	* app/widgets/picmanbrushfactoryview.h
	* app/widgets/picmanbufferview.[ch]
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmancomponenteditor.[ch]
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontainercombobox.[ch]
	* app/widgets/picmancontainereditor.[ch]
	* app/widgets/picmancontainerentry.[ch]
	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmancontainerpopup.[ch]
	* app/widgets/picmancontainertreeview.[ch]
	* app/widgets/picmancontainerview.[ch]
	* app/widgets/picmandatafactoryview.[ch]
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmandialogfactory.[ch]
	* app/widgets/picmandocumentview.[ch]
	* app/widgets/picmanfontview.[ch]
	* app/widgets/picmangradienteditor.[ch]
	* app/widgets/picmanimageview.[ch]
	* app/widgets/picmanitemtreeview.[ch]
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmanpatternfactoryview.[ch]
	* app/widgets/picmanpropwidgets.[ch]
	* app/widgets/picmanselectioneditor.[ch]
	* app/widgets/picmansessioninfo.[ch]
	* app/widgets/picmantemplateview.[ch]
	* app/widgets/picmantooloptionseditor.c
	* app/widgets/picmantoolview.[ch]
	* app/widgets/picmanundoeditor.[ch]
	* app/widgets/picmanviewablebox.c
	* app/widgets/picmanviewablebutton.[ch]
	* app/widgets/picmanviewabledialog.[ch]
	* app/widgets/picmanviewrenderer.c: change the word "preview" to
	"view" whereever we talk about PicmanView or PicmanViewRenderer
	objects or their sizes. Ther were renamed from "Preview" a long
	time ago and we had a preview/view naming mess ever since.

2006-01-14  Michael Natterer  <mitch@picman.org>

	* app/config/picmanconfig-utils.[ch] (picman_config_connect_full):
	variant of picman_config_connect() which allows the connected
	objects to have different property names.

	* app/widgets/widgets-enums.[ch]: removed enum PicmanViewType...

	* app/core/core-enums.[ch]: ...and added it here.

	* app/widgets/picmanviewablebutton.[ch] (picman_viewable_button_new):
	added "button_preview_size" parameter so the button and popup
	preview sizes can be specified separately.

	* app/widgets/picmantemplateeditor.c: changed accordingly.

	* app/widgets/picmanviewablebox.[ch] (picman_prop_*_box_new):
	new functions which take additional "view_type_prop" and
	"view_size_prop" parameters and sync the passed context's
	properties with the resp. properties of the viewable button.

	* app/paint/picmanpaintoptions.[ch]
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmantextoptions.[ch]: added view-type and view-size
	properties to the options objects and use the new viewable box
	constructors so the selected view types and sizes are persistant
	across sessions. Fixes bug #315443.

2006-01-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansessioninfo.c (picman_session_info_restore): always
	set the current page of dockbooks, also if it's the first one.

2006-01-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/flarefx.c: renamed to "Lens Flare", don't use
	the term "Cursor" incorrectly (bug #326700).

	* plug-ins/common/nova.c: renamed to "Supernova", don't use the
	term "Cursor" incorrectly (bug #326700).

2006-01-12  Sven Neumann  <sven@picman.org>

	* app/actions/actions.c
	* app/actions/cursor-info-actions.c
	* app/actions/dialogs-actions.c
	* app/config/picmanrc-blurbs.h
	* app/dialogs/dialogs.c
	* app/dialogs/preferences-dialog.c
	* app/widgets/picmanhelp-ids.h: use the term Pointer instead of
	Cursor when refering to the mouse pointer (bug #326700).

2006-01-11  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in.[ch]
	* tools/pdbgen/pdb/plug_in.pdb: moved code from the PDB wrapper to
	a utility function in the core.

	* app/pdb/plug_in_cmds.c: regenerated.

2006-01-11  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb (plugin_menu_register): warn if a
	plug-in attempts to register a menu path for a procedure that it
	didn't install.

	* app/pdb/plug_in_cmds.c: regenerated.

2006-01-07  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c: implement GtkWidget::hide() and set
	the the focus widget to NULL, so a focussed entry emits focus_out
	and its callbacks are invoked immediately (before the call to
	gtk_widget_hide() returns). Fixes crashes and warnings in tool
	dialogs when hitting escape while a spinbutton is being edited.

	* app/tools/picmantransformtool.c
	(picman_transform_tool_force_expose_preview): return silently
	instead of warning when being called while the draw tool is not
	active (same scenario as above).

2006-01-07  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: applied patch from Tobias Lenz that plugs a
	memleak and yields another small speedup.

2006-01-06  Sven Neumann  <sven@picman.org>

	* picmantool-2.0.in: if available use pkg-config to determine
	compiler and linker flags at runtime. Fixes bug #324761.

2006-01-06  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_image): give more feedback by
	changing the file size label while the preview is being regenerated.

2006-01-06  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c: merged a patch from Mukund that fixes
	handling of EXIF data when preview is enabled (bug #303383).

2006-01-05  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_sanity_check): depend on gtk+ >= 2.8.8 also
	at runtime. We don't want to debug everybody's gtk problems...

2006-01-05  Sven Neumann  <sven@picman.org>

	* configure.in: depend on gtk+ >= 2.8.8 (see bug #325794).

2006-01-05  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/brush.pdb (picman-brush-set-spacing): allow to
	change the spacing of brushes the user doesn't have write access
	to. The user interface allows to do that as well.

	* app/pdb/brush_cmds.c: regenerated.

2006-01-04  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/context.pdb: fixed docs for picman-context-push/pop.

	* app/pdb/context_cmds.c
	* libpicman/picmancontext_pdb.c: regenerated.

2006-01-03  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h (SWAP_PATH_BLURB): added missing space
	(bug #325617).

2006-01-03  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c (picman_dialog_init): connect to our
	own "response" signal so our callback is the first one called.

	(picman_dialog_response): let the activated widget grab the focus,
	so input fields which update their model and/or constraints on
	focus_out are properly recalculated. Fixes bug #309373.

2006-01-02  Simon Budig  <simon@picman.org>

	* libpicman/picman.def: added a bunch of missing symbols.

2006-01-02  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/context.pdb
	* libpicman/picman.def: added picman-context-get/set-paint-method which
	get/set the context's paint-info by name. Use these functions to
	stroke with any paint method (still only with its default paint
	options).

	* app/pdb/context_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmancontext_pdb.[ch]: regenerated.

2006-01-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert-data.h
	* app/core/picmanimage-convert.c: applied patch by Adam D. Moss that
	replaces the default dither matrix by a 32x32 Bayer pattern (see
	bug #136604).

2005-12-30  DindinX  <dindinx@picman.org>

	* libpicmanmath/picmanvector.c
	* libpicmanconfig/picmanconfig-deserialize.c: shut up some compiler
	warnings.

2005-12-30  DindinX  <dindinx@picman.org>

	* plug-ins/ifscompose/ifscompose_utils.c: fixed some compiler warnings
	and did some cleanups.

2005-12-30  DindinX  <dindinx@picman.org>

	* plug-ins/gfig/gfig-arc.c
	* plug-ins/gfig/gfig-grid.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-spiral.c
	* plug-ins/gfig/gfig-star.c: fixed some compiler warnings and did some
	cleanups.

2005-12-30  DindinX  <dindinx@picman.org>

	* plug-ins/common/depthmerge.c: fixed some compiler warnings and did
	some cleanups.

2005-12-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerentry.c (picman_container_entry_init):
	set "inline-completion" and unset "popup-set-width" properties.

2005-12-30  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c
	* app/actions/view-actions.c
	* app/dialogs/image-properties-dialog.c: use new stock icons from
	GTK+ 2.8.

2005-12-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: #define PICMAN_DOCKABLE_DRAG_OFFSET
	publically.

	* app/widgets/picmandockbook.c (picman_dockbook_tab_drag_end): use the
	define to reset the dockable's drag offsets.

2005-12-30  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c
	(prefs_tree_select_callback)
	(prefs_notebook_page_callback): clean up treeview/model code.

2005-12-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmangradienteditor.c (view_events): typo.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new):
	commented out gravity setting. While it's nice with
	"resize-windows-on-zoom" it doesn't yield satisfying behaviour in
	most cases.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_dockable_added): set
	the current notebook page to the dockable that was just added.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c (picman_dialog_factories_show_foreach):
	fiddle with the "focus-on-map" window hint to prevent the dialogs
	from grabbing the focus away from the image window. Fixes bug #167762
	for window managers supporting this hint.

	* app/display/picmandisplayshell-callbacks.c: removed redundant call
	to gdk_window_focus() that wasn't having the desired effect anyway.

2005-12-29  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/image.pdb: new function:
	    image_add_vectors

	* tools/pdbgen/pdb/vectors.pdb: new functions:
	    vectors_get_strokes
	    vectors_stroke_get_point_at_dist
	    vectors_stroke_close

	removed nonfunctional undo code (that does not belong here anyways)
	and fixed a bug in [...]_cubicto.

	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.[ch]: split
	picman_dialog_factories_toggle() into two functions. Turned the
	tri-state into a simple boolean state. Dialogs are now either
	shown or not, without treating the toolbox any special.

	* app/actions/dialogs-commands.c
	* app/display/picmandisplayshell-callbacks.c: changed accordingly.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/main.c: added --license command-line option.

	* docs/picman.1.in: documented the new option.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c: set the source dockable insensitive
	during the drag operation.

2005-12-29  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.[ch]: extended
	picman_bezier_stroke_new_ellipse() with an "angle" parameter.
	* app/vectors/picmanvectors-import.c: changed accordingly, untabbified.

	* tools/pdbgen/pdb/vectors.pdb: added PDB-wrappers for
	      vectors_bezier_stroke_new_moveto
	      vectors_bezier_stroke_lineto
	      vectors_bezier_stroke_conicto
	      vectors_bezier_stroke_cubicto
	      vectors_bezier_stroke_new_ellipse

	Undo does not work properly yet.

	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_expose_event): moved
	some code to an internal helper function.

2005-12-29  DindinX  <dindinx@picman.org>

	* plug-ins/common/waves.c: small cleanups

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.[ch]: invalidate stored coordinates on
	button release.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c: let the drag icon mimic the
	appearance of a notebook tab.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockbook.c (picman_dockbook_tab_drag_begin): use
	the width of the source widget as the minimum width of the drag icon.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.[ch]: store coordinates of last button
	press event.

	* app/widgets/picmandockbook.c (picman_dockbook_tab_drag_begin): set
	the drag hotspot to the mouse position that started the drag.

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_expose_event): draw the
	standalone dockable like a notebook tab to indicate that it can be
	dragged.

2005-12-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanhelpui.c (picman_help_set_help_data): allow to
	unset the tooltip by passing NULL.

	* app/widgets/picmandockseparator.c: unset the tooltip while the same
	text is being shown as a label.

2005-12-29  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.[ch] (enum PicmanPDBArgType): renamed
	PICMAN_PDB_PATH to PICMAN_PDB_VECTORS and added the former as an alias
	for the latter.

	* libpicman/picman.h (union _PicmanParamData): added back d_path member
	to maintain source compatibility.

	* tools/pdbgen/pdb.pl
	* libpicman/picman.c
	* app/pdb/procedural_db.c
	* app/plug-in/plug-in-params.c
	* libpicmanbase/picmanprotocol.[ch]
	* plug-ins/pypicman/pypicman-pdb.c
	* plug-ins/script-fu/siod-wrapper.c: s/PICMAN_PDB_PATH/PICMAN_PDB_VECTORS/

	* app/pdb/image_cmds.c
	* app/pdb/procedural_db_cmds.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanimage_pdb.c
	* libpicman/picmanvectors_pdb.c
	* tools/pdbgen/enums.pl: regenerated.

2005-12-29  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/vectors.pdb:
	   picman_vectors_[gs]et_locked  renamed to _linked for consistency.

	   picman_vectors_[gs]et_tattoo, picman_vectors_get_image: new.

	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.c: code cleanup, use alloca in
	picman_colormap_editor_clear().

2005-12-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c: make sure the title area is cleared
	when the timeout is cancelled.

2005-12-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c: handle d_path -> d_vectors rename.

2005-12-28  Sven Neumann  <sven@picman.org>

	* HACKING
	* INSTALL: document the changed dependencies.

	* configure.in
	* app/sanity.c: check for glib >= 2.8.2 at compile and run-time.

	* app/plug-in/plug-in.c: removed workaround for glib < 2.8.2.

2005-12-28  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/vectors.pdb: Added new functions for the vectors
	PDB API. Minor cleanups. Please try to use them and test:

	  picman_image_get_active_vectors
	  picman_image_set_active_vectors
	  picman_image_get_vectors_by_tattoo
	  picman_image_lower_vectors
	  picman_image_lower_vectors_to_bottom
	  picman_image_raise_vectors
	  picman_image_raise_vectors_to_top
	  picman_image_remove_vectors

	  picman_vectors_get_locked
	  picman_vectors_set_locked
	  picman_vectors_get_name
	  picman_vectors_set_name
	  picman_vectors_get_visible
	  picman_vectors_set_visible
	  picman_vectors_stroke_get_length
	  picman_vectors_stroke_remove
	  picman_vectors_stroke_scale

	* libpicman/picman.[ch]: renamed the unused d_path to d_vectors and
	use it. Untabbified.

	* devel-docs/libpicman/tmpl/picmanvectors.sgml
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanimage_pdb.[ch]
	* libpicman/picmanvectors_pdb.[ch]: Regenerated

	* app/vectors/picmanstroke.h: minor cleanup.

2005-12-28  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added "Image/Arrange" placeholder.

	* plug-ins/common/align_layers.c: moved to the Image menu, it
	doesn't work on a single layer.

2005-12-28  Sven Neumann  <sven@picman.org>

	* app/Makefile.am
	* app/about.h: new file collecting some strings about the app.

	* app/main.c
	* app/dialogs/about-dialog.c
	* app/dialogs/user-install-dialog.c: use the defines from about.h.

2005-12-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.[ch]: set the new
	"do-overwrite-confirmation" property on GtkFileChooser. Removed
	picman_file_overwrite_dialog().

	* app/dialogs/file-save-dialog.c (file_save_dialog_check_uri):
	removed broken code which tried to figure if a file exists.
	Fixes bug #309729.

	* app/widgets/picmandnd-xds.c: added picman_file_overwrite_dialog()
	here as private utility function.

2005-12-28  Michael Natterer  <mitch@picman.org>

	* app/dialogs/about-dialog.c: set the new "wrap-license" property
	on GtkAboutDialog and remove the explicit newlines from the string
	holding the GPL.

2005-12-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch]: removed
	picman_action_get_accel_closure().

	* app/widgets/picmanactionview.c (picman_action_view_new): use
	gtk_action_get_accel_closure() instead.

2005-12-28  Michael Natterer  <mitch@picman.org>

	* configure.in: bump version to 2.3.7,
	require GTK+ >= 2.8.0 and pango >= 2.10.0.

	* app/gui/gui.c (gui_sanity_check): changed accordingly.

2005-12-28  Sven Neumann  <sven@picman.org>

	* Made 2.3.6 development release from the 22nd Chaos Communication
	Congress.

2005-12-28  Sven Neumann  <sven@picman.org>

	* data/images/picman-splash.png: splash screen for the 22C3 release.

2005-12-28  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/paint_tools.pdb: follow paint-info renaming.

	* app/pdb/paint_tools_cmds.c: regenerated.

2005-12-27  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanconvolve.c (picman_convolve_register)
	* app/paint/picmandodgeburn.c (picman_dodge_burn_register): fixed
	stock IDs.

2005-12-27  Michael Natterer  <mitch@picman.org>

	Fixed incomplete core/ui separation of paint tools and paint
	methods:

	* app/core/core-enums.h
	* app/core/picmancontext.[ch]: added a "paint-info" property and API
	so the current paint method can be selected without the need for
	an active tool.

	(picman_context_real_set_tool): set the paint-info to
	tool_info->paint_info so the paint method follows the active tool
	just as the active image follows the active display.

	* app/core/picman.h (struct Picman)
	* app/core/picmanpaintinfo.[ch]: added "standard_paint_info" API
	and stuff to be consistent with other context object properties.

	* app/paint/picman-paint.c: set the paintbrush as
	standard_paint_info.

	* app/core/picmanstrokedesc.c (picman_stroke_desc_new): removed the
	hack of falling back to the paintbrush when there is no active
	tool and use the active paint method instead. Fall back to the
	standard paint method if there is no active one.
	(nothing in the core uses the active tool any more now).

	* app/widgets/picmandeviceinfo.h: add the paint info to the
	properties which are saved in devicerc.

	Added identifiers (names) and stock-ids to PicmanPaintInfo:

	* app/core/picmanpaintinfo.[ch] (picman_paint_info_new): added
	identifier and stock-id parameters.

	* app/core/picmantoolinfo.c (picman_tool_info_new): removed the hack
	of setting the paint-info stock-id from the tool-info stock-id.

	* app/paint/paint-types.h
	* app/paint/picman-paint.c: changed PicmanPaintRegisterCallback
	accordingly.

	* app/tools/picman-tools.c (picman_tools_register): changed paint
	info names accordingly.

	* app/paint/*.c (picman_*_register): pass identifier and stock-id
	accordingly.

2005-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c (query): fixed type of threshold
	parameter (bug #325007).

2005-12-23  DindinX  <dindinx@picman.org>

	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c: revert to aspect preview until these
	plug-ins fully support zoomed preview.

2005-12-23  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c
	* app/core/picmandrawable.c
	* app/core/picmanlayer.c
	* app/core/picmanlayermask.c
	* app/text/picmantextlayer.c
	* app/vectors/picmanvectors.c: moved variables to local scopes in
	implementations of PicmanItem::duplicate()

2005-12-23  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c
	* app/vectors/picmanstroke.c: shuffled some g_return*_if_fail
	around as suggested by mitch.

2005-12-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfileprocview.c: removed icons from
	PicmanFileProcView.  It turned out that the Wilber icon is commonly
	mistaken as an indicator for the selected file-type.

2005-12-20  Michael Natterer  <mitch@picman.org>

	* libpicman/*.c
	* libpicmanconfig/*.c
	* libpicmanmodule/*.c
	* libpicmanthumb/*.c
	* libpicmanwidgets/*.c: port to G_DEFINE_TYPE() and friends. Some
	related cleanup.

2005-12-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c: removed unused variable.

2005-12-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/*.c: port to G_DEFINE_TYPE() and friends. Some
	related cleanup.

2005-12-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: fixed handling of librsvg API change,
	based on a patch by S. Mukund (bug #314400).

2005-12-18  Manish Singh  <yosh@picman.org>

	* plug-ins/script-fu/siod-wrapper.c: Finish the reverting here.

2005-12-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod/siod.h
	* plug-ins/script-fu/siod/sliba.c: Reverted changes to handling
	of string arrays to stay backward compatible (see bug #168290 and
	bug #317634). These files were not reverted when other files were.

2005-12-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/screenshot.c (shoot_dialog): cleaned up the GUI.

2005-12-16  Sven Neumann  <sven@picman.org>

	* app/paint/paint-enums.[ch]: changed description of
	PICMAN_CLONE_ALIGN_NO enum value.

	* app/tools/picmanclonetool.c (picman_clone_options_gui): use a combo
	box for the align mode.

2005-12-14  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.[ch]: declare gp_params_destroy() in
	the private header file.

	* libpicman/picman.c (picman_destroy_params): removed extern declaration.

	* libpicmanbase/picmanenv.h: changed parameter name to match what's
	used in picmanenv.c.

	* libpicmanbase/picmanreloc.c: changed comments to please gtk-doc.

2005-12-13  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanwire.[ch]: let the private wire methods live in
	the PICMAN namespace. Declare internal functions as such and prefix
	them with an underscore.

	* libpicman/picman.c
	* libpicman/picmantile.c
	* libpicmanbase/picmanbase.def
	* libpicmanbase/picmanprotocol.c
	* app/plug-in/plug-in-message.[ch]
	* app/plug-in/plug-in-run.c
	* app/plug-in/plug-in.c: changed accordingly.

2005-12-13  Michael Natterer  <mitch@picman.org>

	* app/tools/*.c: port to G_DEFINE_TYPE() and friends. Some related
	cleanup.

2005-12-12  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/script-fu/siod/slib.c: added a fix for the script-fu
	crash in chinese (and maybe other) locales. Applied to both
	branches. Fixes bug #163212.

2005-12-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanstrokedesc.c (picman_stroke_desc_new): fall back to
	the paintbrush if we can't get the paint method from the active
	tool (because there is no active tool). Fixes bug #323778.

2005-12-10  Michael Natterer  <mitch@picman.org>

	* app/config/*.c
	* app/core/*.c
	* app/display/*.c
	* app/text/*.c
	* app/vectors/*.c: port to G_DEFINE_TYPE() and friends. Some related
	core reordering and cleanup.

2005-12-07  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanclone.c (picman_clone_motion): In fixed mode, paint
	incremental so the individual brushes are properly applied on top
	of each other. Fixes bug #322791.

2005-12-07  Michael Natterer  <mitch@picman.org>

	* app/paint/*: use G_DEFINE_TYPE().

2005-12-07  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanhelpui.c: allow to cancel context sensitive
	help by pressing escape.

2005-12-07  Michael Schumacher  <schumaml@cvs.gnome.org>

	* app/paint/picmanclone.c
	* app/paint/paint-enums.c
	* app/paint/paint-enums.h: added alignment mode for cloning from a
	fixed location source as suggested in bug #322791.

2005-12-06  Manish Singh  <yosh@picman.org>

	* autogen.sh: Allow overriding from shell environment variables,
	and prefer any overrid automakes to the default, so long as the
	version is new enough.

2005-12-06  Sven Neumann  <sven@picman.org>

	* autogen.sh: applied a patch provided by Pierre-Paul Lavoie that
	makes it easier to adapt autogen.sh to uncommon executable names
	(bug #323341).

2005-12-06  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c (picman_drawable_preview_destroy):
	initialize all fields of the struct passed to picman_set_data().

2005-12-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c: corrected the algorithm name as
	suggested in bug #323304.

2005-12-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c: applied a modified version of a patch
	by Joao S. O. Bueno Calligaris that makes the IWarp preview
	resizable (bug #323177).

2005-12-05  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mkgen.pl
	* plug-ins/faxg3/Makefile.am
	* plug-ins/help/Makefile.am
	* plug-ins/metadata/Makefile.am: workaround for libtool brokeness
	on Linux (bug #314513 and bug #323085)

	* plug-ins/common/Makefile.am: regenerated.

2005-12-02  Sven Neumann  <sven@picman.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): added
	"-v" to the wget command-line options. Fixes bug #322977.

2005-11-30  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): timeout
	message format string should use %d, not %s.

2005-11-30  Manish Singh  <yosh@picman.org>

	* plug-ins/common/screenshot.c: can't use gtk_main_quit as a
	timeout function, since it doesn't return a value. Wrap it in a
	function that returns FALSE instead. Fixes bug #322343.

2005-11-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: handle fixed_width,
	fixed_height, and fixed_aspect in a reasonable way.
	Also don't crash when user modifies aspect of a
	nonexistent rectangle, and disconnect notify
	handler in dispose.

2005-11-30  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmaneditor.c (picman_editor_add_button)
	(picman_editor_add_action_button): set the "use-stock" property on
	the created buttons so changes of the underlying action's name
	don't change the button's icon to a string.

2005-11-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: don't crash when
	user modifies width/height of nonexistent rectangle, and
	make sure to disconnect option notify handlers in dispose.
	Should fix bug #322396.

2005-11-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandeviceinfo.[ch]: added GdkDisplay member since
	there is no way fo figure the display a GdkDevice exists on.
	Minor cleanups.

	* app/widgets/picmandevices.[ch]: connect to the GdkDeviceManager
	and add input devices when displays are opened. Added API to get
	the PicmanContainer of devices.

	* app/widgets/picmandevicestatus.[ch]: don't just show the devices
	of the default display. Instead get the device container from the
	new API above and update the GUI when devices are added/removed.
	Cleaned up the whole file quite a bit.

2005-11-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandeviceinfo.c (picman_device_info_get_property):
	use gtk_accelerator_name() instead of serializing the accelerator
	manually.

2005-11-27  Michael Natterer  <mitch@picman.org>

	Apparently, there was a reason for implementing the window actions
	separately for views and docks, fixed the bugs resulting from the
	merge:

	* app/actions/dock-actions.c (dock_actions_update): only update
	the dock actions if the update function is called in the context
	of a dock (not in the context of an image window). Fixes docks
	jumping to other screens on any action on an image window on that
	screen.

	* app/actions/view-actions.c (view_actions_setup): add the window
	actions only to action groups that live in an image window or
	global popup ui manager (not to action groups that belong to a
	dock or dockable). Prevents bugs similar to the one above.

2005-11-26  Michael Natterer  <mitch@picman.org>

	* app/menus/window-menu.c (window_menu_display_opened,closed):
	don't crash if gdk_display_get_name() returns NULL.

2005-11-26  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_unrealize):
	new function which destroys the GCs kept by the shell and
	unrealizes the navigation popup.

2005-11-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/oilify.c: applied a patch by Daniel Richard G.
	that greatly improves the output of the Oilify filter (bug #322258).
	Also changed the default to use the Intensity algorithm as
	suggested in bug #322296.

2005-11-24  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_message): reverted previous change.

2005-11-24  Sven Neumann  <sven@picman.org>

	* app/gui/gui-vtable.c (gui_message): only show the error console
	but don't move the keyboard focus to it. Fixes bug #322210.

2005-11-24  Michael Natterer  <mitch@picman.org>

	* app/actions/dock-actions.c
	* app/actions/view-actions.c
	* app/actions/window-actions.c
	* app/actions/window-commands.[ch]
	* menus/dockable-menu.xml.in
	* menus/image-menu.xml.in: added "Open Display" dialog for
	debugging purposes.

2005-11-23  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.c: print error messages unconditionally
	and let "verbose" print module access debugging stuff. Misc cleanup.

2005-11-23  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantoolcontrol.[ch]: cleaned up and reordered
	instance struct and functions. Renamed functions so getters and
	setters actually have "get" and "set" in their names.

	* app/display/picmandisplayshell-autoscroll.c
	* app/display/picmandisplayshell-callbacks.c
	* app/tools/picmanaligntool.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanforegroundselecttool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmanvectortool.c
	* app/tools/tool_manager.c: changed accordingly.

2005-11-23  Sven Neumann  <sven@picman.org>

	* plug-ins/sel2path/sel2path.[ch]: set a translatable name for the
	created path.

2005-11-22  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors.c (picman_vectors_stroke): return
	successfully when stroking an empty path. Fixes bug #322067.

2005-11-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c: request motion hints in
	the navigation popup and redraw the window immidiately to give
	better feedback.

2005-11-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.c: moved the controls closer to the
	preview.

2005-11-22  Sven Neumann  <sven@picman.org>

	* libpicman/picmanzoompreview.c: zoom on Ctrl-Scroll events.

	* libpicmanwidgets/picmanscrolledpreview.c
	(picman_scrolled_preview_area_event): correctly clamp adjustment
	value on scroll events. Ignore scroll events when Ctrl is pressed.

2005-11-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c
	(picman_scrolled_preview_area_event): scroll using the mouse wheel.

2005-11-21  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added "Animators" placeholder.

	* plug-ins/script-fu/script-fu.c (script_fu_extension_init):
	removed registration of "Animators" submenu.

2005-11-21  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: renamed "discontiguous" to
	"continuous", both in the UI and as a variable.

2005-11-21  Sven Neumann  <sven@picman.org>

	* app/actions/context-actions.c (context_brush_radius_actions):
	added default keyboard shortcuts for changing the brush radius
	as suggested in bug #322028.

2005-11-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanzoommodel.c (picman_zoom_button_new): connect
	to the model's "zoomed" signal and set the button sensitivity.

2005-11-21  Sven Neumann  <sven@picman.org>

	* plug-ins/MapObject/mapobject_main.[ch]
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_ui.c: must not keep pointers in the
	struct that is being used to preserve data between invocations of
	the plug-in. Fixes bug #321932.

2005-11-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmanselectionoptions.c: code cleanup.

2005-11-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanaligntool.c
	* app/tools/picmancolortool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectortool.c: started to get rid of all stock GDK
	cursors in preparation of fixing bug #158407.

2005-11-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.c (view_events):
	* app/widgets/picmannavigationview.c (picman_navigation_view_scroll):
	changed wheel scrolling to be HIG-compliant (control zooms). Also
	handle GDK_SCROLL_LEFT/RIGHT correctly and made shift switch the
	scroll axis. The widgets behave as the image window now.

2005-11-18  Jakub Steiner <jimmac@ximian.com>

	* data/palettes/Tango.gpl: Made the greens more vibrant.

2005-11-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.c: implement GtkWidget::unrealize()
	and destroy the control pixmap. fixes crash when moving the dialog
	to another display.

	* menus/dockable-menu.xml.in: added a separator before the
	"Move to Screen" submenu.

2005-11-17  Michael Natterer  <mitch@picman.org>

	* app/actions/window-actions.[ch]: connect to GdkDisplayManager
	and automatically add/remove move-to-screen actions when
	displays are opened/closed.

	* app/menus/window-menu.c: added similar code here to add/remove
	menu items for the above actions.

	* app/actions/Makefile.am
	* app/actions/window-commands.[ch]: new files containing window
	close and move-to-screen callbacks. There is no need to implement
	these twice for PicmanDock and PicmanDisplay.

	* app/actions/dock-commands.[ch]
	* app/actions/view-commands.[ch]: remove the callbacks here.

	* app/actions/dock-actions.c
	* app/actions/view-actions.c: changed accordingly.

2005-11-16  Manish Singh  <yosh@picman.org>

	* plug-ins/common/curve_bend.c (p_picman_rotate): use
	picman_drawable_transform_rotate_default instead of deprecated
	picman-rotate PDB call. Fixes bug #321692.

2005-11-16  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanenv.c (picman_toplevel_directory)
	* app/widgets/picmancolormapeditor.c (picman_colormap_editor_draw_cell):
	plugged memory leaks.

2005-11-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_convert):
	picman_layer_transform_color() wants the destination image passed,
	not the source image.

2005-11-16  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanreloc.c: minor cleanups.

2005-11-15  Michael Natterer  <mitch@picman.org>

	Allow to construct a group of radio actions in multiple chunks.
	(not used yet).

	* app/widgets/picmanactiongroup.[ch]
	(picman_action_group_add_radio_actions): added "GSList *radio_group"
	parameter and return value.

	* app/actions/dockable-actions.c
	* app/actions/gradient-editor-actions.c
	* app/actions/quick-mask-actions.c
	* app/actions/text-editor-actions.c
	* app/actions/view-actions.c
	* app/actions/window-actions.c: pass NULL as radio_group.

2005-11-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainercombobox.c: implement
	GtkWidget::unrealize() and unrealize all PicmanViewRenderers.
	Fixes BadMatch with the renderers' GCs on display change.

2005-11-14  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: better looking rectangle boundary.

2005-11-14  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_mask_bounds):
	return TRUE only if the selection intersects with the viewport, as
	expected by picman_display_shell_selection_invis(), which is the
	only caller of this function. Fixes bug #319029.

2005-11-13  Sven Neumann  <sven@picman.org>

	* plug-ins/sgi/sgi.c (run): fixed cut'n'paste bug that broke saving.

2005-11-13  Sven Neumann  <sven@picman.org>

	* app/core/picmandatafactory.c (picman_data_factory_data_free): do not
	return a value from a void function. Fixes bug #321333.

2005-11-11  Sven Neumann  <sven@picman.org>

	* INSTALL: document --enable-binreloc.

2005-11-11  Michael Natterer  <mitch@picman.org>

	* m4macros/binreloc.m4: disable binreloc by default.

2005-11-11  Sven Neumann  <sven@picman.org>

	* app/base/tile-swap.c (tile_swap_default_in): fixed compilation
	of experimental threaded tile-swapper. Fixes bug #320977.

2005-11-09  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c: wrap picmanenv directory functions.

2005-11-09  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: better fixed-aspect behavior.

2005-11-09  Simos Xenitellis  <simos@gnome.org>

	* configure.in: (Re)Added tt (Tatarish) to ALL_LINGUAS,
	added stubs for missing PO files.

2005-11-09  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c: reverted patch which makes
	alpha=255 when turned off because these functions are not only
	used for display projection. Re-opens bug #143315.
	Fixes bug #307213.

2005-11-08  Michael Natterer  <mitch@picman.org>

	* configure.in: Removed 'tt' again until all po files are there.

2005-11-08  Simos Xenitellis  <simos@gnome.org>

	* configure.in: Added tt (Tatarish) to ALL_LINGUAS.

2005-11-08  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/guides-new.scm
	* plug-ins/script-fu/scripts/guides-new-percent.scm: look at the
	image's width/height, not the drawable's. Fixes bug #320933.

2005-11-07  Michael Natterer  <mitch@picman.org>

	* app/core/picman-modules.c
	* app/menus/menus.c: more output on --verbose

2005-11-06  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolorpickertool.c (picman_color_picker_tool_picked):
	when picking FG or BG color from an indexed layer, select its
	index in the colormap editor. Fixes bug #320660.

2005-11-06  Michael Natterer  <mitch@picman.org>

	* app/core/picman-contexts.c
	* app/core/picman-documents.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman-units.c
	* app/core/picmandatafactory.c
	* app/core/picmantooloptions.c
	* app/gui/color-history.[ch]
	* app/gui/gui.c
	* app/gui/session.c
	* app/plug-in/plug-ins.c
	* app/text/picman-fonts.c
	* app/tools/picman-tools.c
	* app/widgets/picmancontrollers.c
	* app/widgets/picmandevices.c: when running --verbose, print the
	name of each config file parsed or written.

2005-11-06  Sven Neumann  <sven@picman.org>

	Added support for binary relocation by means of binreloc, largely
	based on a patch by Hongli Lai:

	* m4macros/Makefile.am
	* m4macros/binreloc.m4: new file providing a macro to check for
	binreloc support.

	* acinclude.m4
	* configure.in: use the macro.

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanreloc.[ch]: new files providing binreloc support
	on Linux.

	* libpicmanbase/picmanenv.[ch]: use binreloc, provide a function to
	initialize the environment machinery.

	* libpicmanbase/picmanbase.def: updated.

	* app/Makefile.am: fiddle with the LDFLAGS for binreloc.

	* app/main.c (main): picman_env_init(FALSE).

	* libpicman/picman.c (picman_main): picman_env_init(TRUE).

2005-11-06  Sven Neumann  <sven@picman.org>

	* modules/controller_midi.c (midi_set_device): corrected casting.

2005-11-05  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: removed unused variable scriptdata.

	* app/plug-in/plug-ins.c (plug_ins_init): Fixed progress value for
	plug-in query and initialization.

	* plug-ins/common/uniteditor.c (new_unit_dialog): use a
	GtkMessageDialog instead of g_message(). Some string changes.

2005-11-05  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): fine-tuning.

2005-11-05  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/app.pl: removed calls to the splash update function
	during initialization of internal procedures. This only takes time
	and doesn't provide useful information.

	* app/pdb/internal_procs.[ch]: regenerated.

	* app/pdb/procedural_db.[ch]: changed accordingly.

	* core/picman.c: call the splash update function from here.

2005-11-05  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c: don't return void in a
	function returning a gboolean.

2005-11-05  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: added some commented-out debug output that can
	be used to get an idea of where the startup time is being spent.

	* app/core/picman.c
	* app/pdb/internal_procs.c
	* app/pdb/procedural_db.c
	* app/plug-in/plug-ins.c
	* tools/pdbgen/app.pl: cosmetic changes.

2005-11-05  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_area_expose): set the clip region
	instead of just the clip rectangle.

	* configure.in: bumped version to 2.3.6.

2005-11-04  Manish Singh  <yosh@picman.org>

	* app/core/picmanenvirontable.c (picman_environ_table_load_env_file):
	remove now unused "expanded" variable.

2005-11-04  Sven Neumann  <sven@picman.org>

	* Made 2.3.5 development release.

2005-11-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontrollereditor.c (picman_controller_editor_init):
	set the widget's spacing to 12 pixels.

2005-11-04  Sven Neumann  <sven@picman.org>

	* app/actions/Makefile.am (libappactions_a_SOURCES): fixed typo.

2005-11-04  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: applied a patch by Gerald Friedland that
	changes the code to clear the cache selectively instead of dumping
	it completely if the foreground or background area is changed.

2005-11-04  Sven Neumann  <sven@picman.org>

	* app/core/picmanenvirontable.c (picman_environ_table_load_env_file):
	picman_config_path_expand() only ever returns NULL if called with a
	NULL path argument.

2005-11-04  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c: fixed typo.

2005-11-04  Sven Neumann  <sven@picman.org>

	* app/errors.c
	* app/sanity.c: s/The PICMAN/PICMAN/

2005-11-03  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c: set the splash image as back pixmap.

2005-11-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanaction.c
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontrollerlist.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmanpluginaction.c
	* app/widgets/picmantooloptionseditor.c
	* app/widgets/picmanwidgets-utils.c
	* libpicmanwidgets/picmancellrenderercolor.c: use gtk_widget_get_settings()
	instead of gtk_settings_get_for_screen(gtk_widget_get_screen())

2005-11-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanclipboard.c (picman_clipboard_set_text): added
	g_return_if_fail (PICMAN_IS_PICMAN (picman)).

2005-11-02  Michael Natterer  <mitch@picman.org>

	* app/text/picmantext.c: code cleanup, untabified.

2005-11-02  Michael Natterer  <mitch@picman.org>

	* app/actions/data-commands.c
	* app/core/picmanprogress.c: #include "picman.h" instead of "picman-gui.h"

2005-11-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tga.c (save_image): allocate a tile cache.

2005-11-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/actions/data-commands.c: add missing include file.

2005-11-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c
	* app/widgets/picmanimagepropview.c
	* app/widgets/picmansizebox.c
	* app/widgets/picmantemplateeditor.c: use ngettext() for plural forms.

2005-11-02  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanmemsize.c (picman_memsize_to_string): use
	dngettext() for plural form.

2005-11-02  Sven Neumann  <sven@picman.org>

	* app/core/picmanpattern.c: rephrased error message for consistency
	and to avoid another plural form.

2005-11-02  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c: use g_utf8_strlen().

	* plug-ins/uri/uri-backend-wget.c: use ngettext().

2005-11-02  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanprocbrowserdialog.c
	* libpicmanwidgets/picmanpropwidgets.c
	* plug-ins/uri/uri-backend-wget.c: use dngettext() for plural
	forms. Fixes bug #320460, bug #320461 and bug #320462.

2005-11-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.[ch] (picman_clipboard_set_text): clear
	the PICMAN clipboard. Suppress debug output unless picman is started
	with the --verbose command-line option.

	* app/actions/data-commands.c
	* app/actions/documents-commands.c: adapt to clipboard API change.

2005-11-02  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c
	* plug-ins/uri/uri-backend-wget.c: added translator comments for
	plural forms (bug #320461 and bug #320462).

2005-11-02  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansizebox.[ch]: added a GtkSizeGroup member and put
	all labels into the group.

	* app/dialogs/scale-dialog.c: put the "Interpolation:" label into
	the same size box.

2005-11-02  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanprocbrowserdialog.c (browser_search): added comment
	that _("%d procedures") should be translated with a plural form
	for *lots* of procedures. Fixes bug #320460.

2005-11-01  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushgenerated.c: fixed compiler warning.

	* app/core/picmanobject.c: turned "name" into a construct property.

2005-11-01  Sven Neumann  <sven@picman.org>

	* app/core/picmanbrushgenerated.c (picman_brush_generated_load): use
	picman_brush_generated_new() to create the brush object. Removed
	redundant calls to picman_data_dirty().

	* app/core/picmandata.c: freeze the data object during construction.

2005-11-01  Sven Neumann  <sven@picman.org>

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/widgets/picmanclipboard.[ch]: moved text clipboard handling to
	utility function to avoid code duplication.

2005-11-01  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins.c: formatting.

2005-10-31  Michael Natterer  <mitch@picman.org>

	Applied modified patch from Luis de Bethencourt Guimera which adds
	a "Save document history" prefs option. Fixes bug #140001.

	* app/config/picmanrc-blurbs.h
	* app/config/picmancoreconfig.[ch]: added boolean property
	"save-document-hitory".

	* app/core/picman.c
	* app/file/file-open.c
	* app/file/file-save.c: don't save the document history and don't
	add files to the desktop-wide list of recently used files if the
	option is FALSE.

	* app/dialogs/preferences-dialog.c: added its toggle to the
	"Environment" page.

2005-10-31  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmessagebox.c (picman_message_box_init): reverted
	the change for bug #302400; it caused bug #319962 to be opened.
	Instead unset the focus chain for the message box.

2005-10-31  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins.c (plug_ins_init): only call the status
	callback for plug-ins that are actually queried or initialized.

2005-10-31  Sven Neumann  <sven@picman.org>

	* app/actions/data-commands.[ch]: added new action command
	data_copy_location_cmd_callback().

	* app/actions/brushes-actions.c
	* app/actions/gradients-actions.c
	* app/actions/palettes-actions.c
	* app/actions/patterns-actions.c
	* app/widgets/picmanhelp-ids.h
	* menus/brushes-menu.xml
	* menus/gradients-menu.xml
	* menus/palettes-menu.xml
	* menus/patterns-menu.xml: added Copy Location menu entries to all
	data views. Allows to retrieve the file location for data files.

2005-10-31  Tor Lillqvist  <tml@novell.com>

	* picmantool-win32.c.in: Drop unnecessary <sys/stat.h>.
	(gtk_config): Drop the PICMAN 1.2.x and gtk+-1-3-win32-production
	support.
	(get_cflags): Output PICMAN's -I switch before GTK's CFLAGS. Use
	"include/picman-2.0" instead of just "include".
	(get_libs, get_libs_noui): Update the list of libraries to match
	reality, use PICMAN_API_VERSION in library names.
	(get_sys_plugin_dir): Use PICMAN_PLUGIN_VERSION and not
	PICMAN_MAJOR_VERSION.PICMAN_MINOR_VERSION in the plug-in folder name.

2005-10-31  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.[ch]
	* app/core/picmandatafactory.c: applied a heavily modified version
	of the patch provided by Shlomi Fish in bug #311740. Introduces a
	cache to speed up reloading of data files.

	* app/actions/data-commands.c: set picman busy while refreshing data
	factories.

	* app/widgets/picmanwidgets-utils.c (picman_widget_accel_changed):
	free the return value of picman_get_accel_string().

2005-10-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewablebutton.[ch] (picman_viewable_button_new):
	add PicmanViewType parameter.

	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmanviewablebox.c: pass view types, using grid view
	for brushes and patterns ass suggested in bug #315443.

2005-10-30  Michael Natterer  <mitch@picman.org>

	Fixed bug #316395:

	* app/actions/dialogs-actions.c (dialogs_dockable_actions)
	* app/actions/quick-mask-actions.c (quick_mask_toggle_actions):
	added tooltips to action entries.

	* app/display/picmandisplayshell.c (picman_display_shell_new): use
	picman_widget_set_accel_help() to set the tooltip so it contains
	the accelerator.

	* app/dialogs/dialogs-constructors.c (dialogs_dockable_constructor):
	attach the dialog's identifier to the dockable widget (hack).

	* app/widgets/picmandockbook.c (picman_dockbook_get_tab_widget): use
	the attached identifier to find the action for this dockable in
	the dock's UI manager (HACK HACK). Use the found action to set
	a tooltip with accelerator.

	* app/widgets/picmanwidgets-utils.c (picman_widget_set_accel_help):
	fixed bug in fallback code what should never be used.

2005-10-30  Michael Natterer  <mitch@picman.org>

	* app/actions/dialogs-actions.c (dialogs_dockable_actions): removed
	shift+ctrl+t accelerator from dialogs-tool-options because it's
	already taken by view-show-guides. Fixes bug #320196.

2005-10-29  Michael Natterer  <mitch@picman.org>

	* app/dialogs/user-install-dialog.c: added global "oldpicman_major"
	an "oldpicman_minor" variables.

	(user_install_dialog_run): set them to the version of the picman
	directory that should be migrated.

	(user_install_migrate_files): skip "menurc" only when migrating
	from 2.0. Fixes bug #317170.

2005-10-29  Michael Natterer  <mitch@picman.org>

	 Fix bug #145492:

	* app/actions/file-commands.c (file_save_cmd_callback)
	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image):
	set the "file-quit" action insensitive while the image is being
	saved to prevent data loss.

	* app/widgets/picmantoolbox.c (picman_toolbox_delete_event): activate
	the "file-quit" action instead of calling picman_exit() directly so
	trying to close the toolbox while saving is impossible too.

2005-10-29  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanconvolve.c (picman_convolve_motion): allocate both
	oversize buffers with the right size, instead of one twice with
	the wrong size. Was broken since porting to pixel_region_init_data().
	Spotted by Seth Burgess. Fixes bug #317340.

2005-10-29  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/image.pdb: improved documentation of
	picman-image-clean-all and picman-image-is-dirty. Fixes bug #318075.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2005-10-28  Michael Natterer  <mitch@picman.org>

	* app/actions/image-actions.c: removed "colors-transform-menu".

	* menus/image-menu.xml.in: revamped again: Moved desaturate and
	the invert items to the toplevel, into a separator-enclosed group.
	Changed Modify to a placeholder again. Things that have no useful
	category can't go to a sub-menu, so please don't invent one just
	for the sake of it.

	* plug-ins/common/channel_mixer.c: -> Colors/Components
	* plug-ins/common/vinvert.c: -> Colors/Invert

2005-10-28  Carol Spears  <carol@picman.org>

	* app/actions/image-actions.c: Changed colors-modify-menu to
        colors-transform-menu

	* menus/image-menu.xml.in: moved Desaturate and Invert into the tools
        section of the colors-menu.

2005-10-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/AlienMap2.c: renamed to "Alien Map".

2005-10-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/hot.c: also moved into Colors/Modify.

	* menus/image-menu.xml.in: moved Info submenu to the bottom.

2005-10-28  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: applied a patch by Tobias Lenz that makes use
	of the state that was added to SIOX in order to speed up the tool.

2005-10-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpageselector.[ch]: added new signal "activate"
	and emit it if the user activates an item in the icon view.

	* plug-ins/common/poppler.c
	* plug-ins/common/postscript.c: activate the dialog if the page
	selector emits "activate" as suggested in bug #320080.

2005-10-28  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: handle picmanprint just like other libraries. It
	doesn't make sense any longer to require it.

	* app/paint/picmanink-blob.c: commented out unused code.

2005-10-27  Manish Singh  <yosh@picman.org>

	* app/paint-funcs/paint-funcs.h: declare component_pixels,
	combine_mask_and_alpha_channel_{stipple,stroke}. Fixes bug #319811.

2005-10-27  Michael Natterer  <mitch@picman.org>

	* configure.in: check for gnome-keyring.

	* plug-ins/uri/uri-backend.h
	* plug-ins/uri/uri-backend-wget.c
	* plug-ins/uri/uri-backend-gnomevfs.c: added "plugin_name",
	boolean "run" and "run_mode" parameters to uri_backend_init().

	* plug-ins/uri/uri-backend-gnomevfs.c (uri_backend_init):
	initialize the gnome authentication manager only when called
	interactively from "run". Also call picman_ui_init() when using the
	auth manager, since recent versions seem to require an already
	initialized GTK+. When running noninteractively and gnome-keyring
	is available, implement the needed GnomeVFS authentication
	callbacks ourselves and ask gnome-keyring directly.

	* plug-ins/uri/uri.c: pass the additional parameters to
	uri_backend_init().

2005-10-26  Carol Spears  <carol@picman.org>

	* app/actions/image-actions.c: added colors-info-menu and
        colors-modify-menu as children of colors-menu

	* menus/image-menu.xml.in: changed Modify placeholder to
        colors-modify-menu menuaction and added color-info-menu action to
        colors-menu

        * plug-ins/common/colortoalpha.c: moved to Colors/Modify in the
        registration part.

2005-10-26  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c (script_fu_console_run):
	removed run-mode check.

2005-10-26  Michael Natterer  <mitch@picman.org>

	Fixed bug #313547:

	* app/widgets/picmandataeditor.c
	(picman_data_editor_set_aux_info)
	(picman_data_editor_get_aux_info): store the state of edit_active
	in sessionrc.

	(picman_data_editor_constructor): enable edit_active by default.

2005-10-25  Michael Natterer  <mitch@picman.org>

	Let the data editors optionally follow the active brush, palette
	and gradient. Still needs to be saved in sessionrc and probably
	be enabled by default. Addresses bug #313547.

	* app/widgets/picmandataeditor.[ch]: added new functions
	picman_data_editor_set,get_edit_active().

	Make it configurable from the palette and gradient editor menus:

	* app/actions/gradient-editor-actions.c
	* app/actions/palette-editor-actions.c: added actions...

	* app/actions/data-editor-commands.[ch]: ...and callbacks...
	(new file).

	* app/widgets/picmanhelp-ids.h: ...help IDs...

	* menus/gradient-editor-menu.xml
	* menus/palette-editor-menu.xml: ...and menu items.

	Add menu to the brush editor and make it configurable there too:

	* app/actions/Makefile.am
	* app/actions/actions.c
	* app/actions/brush-editor-actions.[ch]
	* app/menus/menus.c
	* menus/Makefile.am
	* menus/brush-editor-menu.xml: added all the bits needed for
	the new menu.

	* app/widgets/picmanbrusheditor.[ch]: use the menu. Added menu_factory
	parameter to the contstructor.

	* app/dialogs/dialogs-constructors.c: changed accordingly.

2005-10-25  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-close.c
	* app/widgets/picmanactionview.c
	* modules/controller_midi.c: g_source_unref() GSources after
	attaching them.

2005-10-25  DindinX  <dindinx@picman.org>

	* app/paint-funcs/scale-funcs.c (subsample_region): correctly pass
	the region offset to pixel_region_get_row().

2005-10-25  Bill skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanpaintoptions-gui.c (jitter_options_gui):
	Use a scale entry instead of spinbutton for jitter amount,
	as discussed in bug #163049.

2005-10-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-contiguous-region.c
	(struct ContinuousRegionData)
	(picman_image_contiguous_region_by_color)
	(contiguous_region_by_color): the color samples are always RGB or
	RGBA, so always compare 3 or 4 bytes of pixel data, and not just
	the number of bytes of the drawable/projection. Fixes "select by
	color" on GRAYA (bug #319683).

2005-10-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/lib.pl: add G_GNUC_INTERNAL to declaration of
	wrapped PDB functions.

	* libpicman/picmanchannel_pdb.h
	* libpicman/picmandrawable_pdb.h
	* libpicman/picmanpicmanrc_pdb.h
	* libpicman/picmanimage_pdb.h
	* libpicman/picmanlayer_pdb.h
	* libpicman/picmanplugin_pdb.h
	* libpicman/picmanproceduraldb_pdb.h
	* libpicman/picmanprogress_pdb.h
	* libpicman/picmanselection_pdb.h
	* libpicman/picmanunit_pdb.h: regenerated.

	* libpicman/picmantile.h
	* libpicman/picmanunitcache.h
	* libpicmanthumb/picmanthumb-utils.h
	* libpicmanwidgets/picmancolorarea.h
	* libpicmanwidgets/picmanhelpui.h: declare internal functions as such
	using G_GNUC_INTERNAL.

2005-10-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb: added getter and setter for path
	visibility (bug #319617).

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-10-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: load and save embedded ICC profiles, based
	on a patch from Ture Pålsson (bug #319580).

	* devel-docs/parasites.txt: document the "icc-profile-name" parasite.

2005-10-24  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-path-16.png
	* themes/Default/images/tools/stock-tool-path-22.png: works on
	dark themes (bug #168981)

2005-10-24  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-airbrush-16.png
	* themes/Default/images/tools/stock-tool-airbrush-22.png: make it
	work on dark background

2005-10-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_realize): create the
	title window as GDK_WINDOW_CHILD, not GDK_WINDOW_TEMP.

2005-10-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: add "notify" callbacks for changes
	of width, height, or aspect entries in the tool options.

2005-10-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c:
	* app/tools/picmannewrectselecttool.c Make clicking inside an existing
	selection create rect matching the marching ants.

2005-10-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangleoptions.c: remove fixed-center stuff
	from options gui in order to simplify it.

2005-10-20  Sven Neumann  <sven@picman.org>

	* plug-ins/twain/twain.c: renamed menu entry to "Scanner/Camera"
	as suggested in bug #311965.

2005-10-20  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_run): always call the batch interpreter in
	NON-INTERACTIVE mode (see bug #167964).

	* plug-ins/script-fu/script-fu-text-console.c: removed the run-mode
	check.

2005-10-20  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c (title_changed): replace newlines
	with spaces to avoid multiple lines in the combo box.

2005-10-20  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: renamed "multiblob"
	property to "discontinuous" and added a check button for it.

2005-10-19  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.[ch]: move tool_control out of
	rectangle tool and into users of it, and make rect select execute
	on leaving but crop tool not.  Also rename functions and clean up
	formatting a bit.

2005-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plugin-browser.c: strip ellipsis from menu labels.

2005-10-19  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: "execute" the tool if the
	user switches to a different tool or clicks in a different
	image.  Good for rect select, not so sure about crop.

2005-10-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/warp.c: use picman_drawable_mask_intersect()
	instead of picman_drawable_mask_bounds().

2005-10-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.[ch]: added keyboard control to the
	Curves tool as suggested in bug #154809.

2005-10-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c (picman_curves_tool_oper_update): set
	cursor modifier and status bar hints to improve discoverability of
	Curves tool features.

2005-10-18  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/presets.c: added a Save icon.

2005-10-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanaligntool.[ch]: Make buttons insensitive
	until a target item has been selected; fixes bug #309038.

2005-10-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanaligntool.c: Remove bogus stuff about
	weak pointers, and disconnect properly in dispose
	callback instead of finalize, as suggested by mitch.
	Fixes bug #314880.

2005-10-18  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-selection.c: formatting.

2005-10-17  Manish Singh  <yosh@picman.org>

	* app/core/picmanpalette-import.c
	(picman_palette_import_create_image_palette): delete stray ;

2005-10-17  Manish Singh  <yosh@picman.org>

	* app/base/siox.c (siox_drb): declare mindistbg, mindistfg, and alpha
	float variables at the start of the block.

2005-10-17  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h
	* app/base/siox.[ch]
	* app/core/picmandrawable-foreground-extract.[ch]
	* app/tools/picmanforegroundselecttool.[ch]: export stateful SIOX to
	the core API and use it from the foreground selection tool.

2005-10-17  Sven Neumann  <sven@picman.org>

	* app/base/base.c (base_init)
	* app/base/tile-swap.c (tile_swap_init): create temp and swap
	directories using g_mkdir_with_parents() (bug #308658).

2005-10-17  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-foreground-extract.[ch]
	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: added "multiblob"
	property to PicmanForegroundSelectOptions and pass it to
	picman_drawable_foreground_extract_siox().

2005-10-17  Sven Neumann  <sven@picman.org>

	* app/file/file-open.[ch]: added run-mode parameter to
	file_open_layer().

	* app/dialogs/file-open-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanlayertreeview.c: pass PICMAN_RUN_INTERACTIVE to
	file_open_layer().

	* tools/pdbgen/pdb/fileops.pdb: export file_open_layer() to the PDB
	as file-load-layer.

	* app/pdb/fileops_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanfileops_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-10-16  Akkana Peck  <akkana@shallowsky.com>

	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py
	* plug-ins/pypicman/plug-ins/sphere.py
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/3dTruchet.scm
	* plug-ins/script-fu/scripts/alien-glow-arrow.scm
	* plug-ins/script-fu/scripts/alien-glow-bar.scm
	* plug-ins/script-fu/scripts/alien-glow-bullet.scm
	* plug-ins/script-fu/scripts/alien-glow-button.scm
	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/alien-neon-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/beveled-button.scm
	* plug-ins/script-fu/scripts/beveled-pattern-arrow.scm
	* plug-ins/script-fu/scripts/beveled-pattern-bullet.scm
	* plug-ins/script-fu/scripts/beveled-pattern-button.scm
	* plug-ins/script-fu/scripts/beveled-pattern-heading.scm
	* plug-ins/script-fu/scripts/beveled-pattern-hrule.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/bovinated-logo.scm
	* plug-ins/script-fu/scripts/camo.scm
	* plug-ins/script-fu/scripts/carved-logo.scm
	* plug-ins/script-fu/scripts/chalk.scm
	* plug-ins/script-fu/scripts/chip-away.scm
	* plug-ins/script-fu/scripts/chrome-logo.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/flatland.scm
	* plug-ins/script-fu/scripts/frosty-logo.scm
	* plug-ins/script-fu/scripts/picman-headers.scm
	* plug-ins/script-fu/scripts/picman-labels.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/glowing-logo.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/i26-gunya2.scm
	* plug-ins/script-fu/scripts/land.scm
	* plug-ins/script-fu/scripts/neon-logo.scm
	* plug-ins/script-fu/scripts/news-text.scm
	* plug-ins/script-fu/scripts/pupi-button.scm
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/sota-chrome-logo.scm
	* plug-ins/script-fu/scripts/speed-text.scm
	* plug-ins/script-fu/scripts/sphere.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/swirltile.scm
	* plug-ins/script-fu/scripts/swirly-pattern.scm
	* plug-ins/script-fu/scripts/t-o-p-logo.scm
	* plug-ins/script-fu/scripts/test-sphere.scm
	* plug-ins/script-fu/scripts/text-circle.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/title-header.scm
	* plug-ins/script-fu/scripts/truchet.scm:
	Move the script categories that were in Xtns->Script-Fu
        directly into Xtns. Language specific tools (e.g. Refresh,
        Console) remain in language-specific menus. Bug 145507.

2005-10-15  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanselectiontool.c: let status info be pushed.

2005-10-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/channel_mixer.c: indentation and other cleanups.

2005-10-13  Sven Neumann  <sven@picman.org>

	* app/dialogs/palette-import-dialog.c: minor dialog tweaks.

2005-10-13  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: pass sensitivity to
	_picman_color_area_render_buf().

	* libpicmanwidgets/picmancellrenderercolor.c
	(picman_cell_renderer_color_render): respect cell and widget
	sensitivity.

2005-10-13  Sven Neumann  <sven@picman.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.c: special case picman-rotate-tool
	being called from the Layer menu and set transform type to
	PICMAN_TRANSFORM_TYPE_LAYER. Fixes bug #318540.

2005-10-13  Jakub Steiner <jimmac@ximian.com>

	* data/palettes/Tango.gpl: Added the tango icon palette
	  (http://www.tango-project.org)

2005-10-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/displace.c: check that displacement maps have
	the same size as the target drawable, return a PDB_CALLING_ERROR
	otherwise. Fixes bug #318644.

2005-10-12  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plugin-browser.c: store the installation time in
	the models, not only the string representation. Sort by time, not
	alphabetically. Fixes bug #318652.

2005-10-12  Sven Neumann  <sven@picman.org>

	* app/base/base-types.h
	* app/base/siox.[ch]: applied patch from Gerald Friedland that
	introduces a state to the SIOX operation.

	* app/core/picmandrawable-foreground-extract.c: adapted to the new API.

2005-10-11  Michael Natterer  <mitch@picman.org>

	* libpicmanthumb/picmanthumbnail.c: the mime-type is stored in
	"tEXt::Thumb::Mimetype", not in "tEXt::Thumb::Image::Mimetype".
	Fixed this and reordered properties so "tEXt::Thumb" and
	"tEXt::Thumb::Image" stuff is grouped together again.

2005-10-10  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmancolorselection.c: added a pick button, it's
	too useful to be just in the color dockable.

2005-10-10  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.c (picman_viewable_get_description): set the
	"tooltip" return value to NULL before calling the virtual function.

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmanchannel.c
	* app/core/picmanlayer.c
	* app/core/picmanpaintinfo.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/core/picmantoolinfo.c (get_description): don't do it here.

	* app/core/picmanbuffer.c
	* app/core/picmanpaintinfo.c: untabbify, cleanup.

	* app/core/picmanobject.c: emit "notify::name" whenerver the name
	changes, clenup.

2005-10-09  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.c: Enable selection masking, even if it
	looks buggy. It looks to me that the bug is in
	picman_drawable_get_sub_preview (), not handling the selection drawable
	as a normal drawable.

2005-10-09  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.c: better handling of selections and
	navigation popup. Still not perfect.

2005-10-09  DindinX  <dindinx@picman.org>

	* libpicman/picmandrawablepreview.c: made the navigation popup respect
	the aspect ratio of the selection or the drawable.

2005-10-08  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmancroptool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.c: added status bar info to tell the
	user what to do once the rectangle area is drawn. Fixes bug #318267.

2005-10-07  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/grid.pdb: fixed (false) uninitialized variable
	warnings and cleaned up the code a bit.

	* app/pdb/grid_cmds.c: regenerated.

2005-10-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/palette-import-dialog.c (palette_import_filename_changed)
	(palette_import_file_callback): use UTF8 encoding with GtkEntry.

2005-10-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.[ch]: added new function
	picman_palette_import_from_drawable(), respecting the selection as
	suggested in bug #316212.

2005-10-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/gauss.c: always use RLE if horz or
	vert radius is less than 1.  Fixes bug #315953.

2005-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c: can't use smoothing with nonstandard
	sampling ratios. Set the slider sensitivity accordingly (bug #318081).

2005-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/picmanressionist.c: removed About dialog.

	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/picmanressionist/logo.png: removed logo.

2005-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/picmanressionist.[ch]
	* plug-ins/picmanressionist/orientation.c
	* plug-ins/picmanressionist/orientmap.[ch]
	* plug-ins/picmanressionist/placement.c
	* plug-ins/picmanressionist/presets.c
	* plug-ins/picmanressionist/preview.c
	* plug-ins/picmanressionist/repaint.c
	* plug-ins/picmanressionist/size.c

	* plug-ins/picmanressionist/sizemap.c: various minor improvements
	like setting all dialogs transient to the main window.

2005-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/presets.c
	* app/config/picmanrc-blurbs.h
	* app/dialogs/quit-dialog.c
	* app/config/picmancoreconfig.c: changed "The PICMAN" to "PICMAN".

	* plug-ins/common/xbm.c: unmarked same string for translation.

2005-10-06  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c: picman_canonicalize_identifier() is new API,
	mark it as such.

2005-10-06  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprocbrowserdialog.c: capitalization and other string
	changes.

	* libpicmanwidgets/picmanbrowser.c: string unification. Set the
	message label italic.

	* plug-ins/common/plugin-browser.c: use ngettext() for plural forms.

2005-10-06  Sven Neumann  <sven@picman.org>

	* app/dialogs/dialogs-constructors.c
	* app/dialogs/keyboard-shortcuts-dialog.[ch]: include a check
	button for the "save-accels" picmanrc property.

2005-10-06  Sven Neumann  <sven@picman.org>

	* plug-ins/help/domain.c: try to improve the error message that is
	shown for missing help files.

2005-10-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c: set application name to "PICMAN", the
	expanded acronym is in the comment already.

2005-10-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c: fixed string.

2005-10-05  Sven Neumann  <sven@picman.org>

	* libpicman/picmanaspectpreview.c
	* libpicman/picmanzoompreview.c: added missing API docs.

2005-10-05  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod-wrapper.c: reverted changes to handling
	of string arrays to stay backward compatible (see bug #168290 and
	bug #317634).

	* plug-ins/script-fu/scripts/font-map.scm: reverted change that
	was done to adapt to above changes (see bug #308681).

2005-10-04  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c (picman_brush_core_start): set
	core->jitter here for all brush-based paint tools.

	(picman_brush_core_interpolate): cleanup.

	* app/paint/picmanbrushcore.h: removed trailing whitespace.

	* app/paint/picmanclone.c (picman_clone_motion)
	* app/paint/picmanpaintbrush.c (_picman_paintbrush_motion): removed
	jitter stuff here.

2005-10-04  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: another optimization by Tobias Lenz.

2005-10-04  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: small optimization by Tobias Lenz.

2005-10-03  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpainttool.c (picman_paint_tool_color_picked):
	fix compile warning by adding default: for unused enum values.

2005-10-03  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* picman/app/paint/picmanbrushcore.c
	* picman/app/paint/picmanbrushcore.h
	* picman/app/paint/picmanclone.c
	* picman/app/paint/picmanpaintbrush.c
	* picman/app/paint/picmanpaintoptions.c
	* picman/app/paint/picmanpaintoptions.h
	* picman/app/tools/picmanpaintoptions-gui.c: Apply patch from
	Adrian Likins to add "jitter" to paint tools (bug #163049),
	with small fixes for coding style and default jitter set
	to 0.2 instead of 0.0.

2005-10-02  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.[ch]: added a new function:
	picman_zoom_preview_get_factor(), which is a proxy to get the zoom
	factor of the zoom model used by the zoom preview.
	Also renamed the zoom field of the private data of picmanzoompreview to
	model, since it is a picmanzoommodel.

	* libpicman/picmanui.def: added picman_zoom_preview_get_factor.

	* plug-ins/common/nova.c: use picman_zoom_preview_get_factor to
	correctly handle the position of the nova at various zoom level.
	There still are problems if there is a selection before when running
	this plugin.

2005-10-02  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: fixed the bogus snaps. One
	should not calculate tangents for points beyond the end of the
	array...

	Don't leak lots of g_arrays...

2005-10-02  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: a segment doesn't necessarily
	have a matching tangent. Check for this when iterating over all
	segments of a path...

	* app/vectors/picmanstroke.c: fix the dispatch of
	_nearest_intersection_get().

2005-10-02  Simon Budig  <simon@picman.org>

	* app/vectors/picmanbezierstroke.c: correctly pass back the
	nearest coordinate. Snapping sortof works.

2005-10-02  Simon Budig  <simon@picman.org>

	* app/core/picmancoords.c: use ABS instead of fabs.

	* app/core/picmanimage-snap.c: Use proper default values for the
	coordinates.

	* app/vectors/picmanbezierstroke.c: Fix a bug plus add some debug
	output. For some reason does not snap yet.

2005-10-02  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.[ch]: introduced variants of
	file_utils_uri_to_utf8_filename() and
	file_utils_uri_to_utf8_basename() that use g_filename_display_name()
	and g_filename_display_basename().

	* app/actions/data-commands.c
	* app/actions/documents-commands.c
	* app/actions/file-actions.c
	* app/actions/file-commands.c
	* app/core/picmanimage.c
	* app/core/picmanimagefile.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/display/picmandisplayshell-close.c
	* app/display/picmandisplayshell-dnd.c
	* app/display/picmandisplayshell-title.c
	* app/file/file-open.c
	* app/widgets/picmandnd-xds.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanthumbbox.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmanviewabledialog.c: use the new functions.

	* plug-ins/help/domain.c: use g_filename_display_name().

2005-10-01  Michael Natterer  <mitch@picman.org>

	* app/sanity.c (sanity_check_glib): we require 2.8.0 now.

2005-10-01  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanwidgetsmarshal.list: added VOID__DOUBLE_DOUBLE
	marshaller.

	* libpicmanwidgets/picmanzoommodel.[ch]: new signal: "zoomed", emitted
	when the zoom factor changes.  This signal have the old factor and the
	new factor as argument.

	* libpicman/picmanzoompreview.c: use the "zoomed" signal instead of the
	"notify::value" one. This allow to use the old and new factors to keep
	the preview centered on the same point.

2005-10-01  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.c: call gtk_adjustment_value_changed in
	addition to gtk_adjustment_changed, so the offsets are correctly
	updated.

2005-09-30  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-pdb.c (pf_call): use canonical name for
	run-mode.

	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/foggify.py: revert the below, since
	we eat the run-mode parameter again.

2005-09-30  Carol Spears  <carol@picman.org>

	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/foggify.py: Added run_mode parameter.

2005-10-01  Simon Budig  <simon@picman.org>

	* app/core/picmancoords.[ch]: Added small utility function for the
	manhattan metric.

	* app/vectors/picmanstroke.[ch]: virtualized stubs provided by mitch

	* app/vectors/picmanbezierstroke.c: Reworked some internal functions
	to make it easier to access the parameters for the coordinates of an
	stroke interpolation. Simplified the straight line test. Added an
	implementation of the _nearest_tangent_get () function that does
	not yet seem to work properly. Not sure where the problem is.

2005-09-30  Michael Natterer  <mitch@picman.org>

	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/actions/view-actions.c
	* app/core/picmandrawable-foreground-extract.c
	* app/core/picmanimagefile.c
	* app/core/picmanprogress.c
	* app/dialogs/convert-dialog.c
	* app/tools/picmanblendtool.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/tools/picmantransformtool.c
	* app/widgets/picmanthumbbox.c
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/edit.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: removed '...' from
	progress messages. Removed spaces between the text and the '...'
	in some other places.

	* app/pdb/drawable_transform_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2005-09-30  Carol Spears  <carol@picman.org>

	* plug-ins/pypicman/picmanfu.py: removed code that limited plug-in
        registration.

2005-09-30  Michael Natterer  <mitch@picman.org>

	* app/vectors/picmanstroke.[ch]: added stubs of two new snapping
	functions.

	* app/core/picmanimage-snap.c: removed their #defines here.

2005-09-30  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]
	* libpicmanbase/picmanbaseenums.[ch]: moved PicmanGridStyle enum to
	libpicmanbase.

	* app/core/picmanimage-grid.h: indentation.

	* app/pdb/Makefile.am
	* libpicman/Makefile.am
	* tools/pdbgen/Makefile.am
	* tools/pdbgen/pdb/grid.pdb: applied slightly modified patch by
	Sylvain FORET that adds a PDB API for the image grid.

	* app/pdb/grid_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picman_pdb.h
	* libpicman/picmanenums.c.tail
	* libpicman/picmangrid_pdb.[ch]
	* tools/pdbgen/enums.pl
	* tools/pdbgen/groups.pl: (re)generated.

	* libpicman/picman.def
	* libpicmanbase/picmanbase.def: updated.

2005-09-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gbr.c (save_image): handle RGB drawables and
	implicitely add the alpha channel.

2005-09-30  Michael Natterer  <mitch@picman.org>

	* app/actions/dialogs-actions.c (dialogs_toplevel_actions): use
	PICMAN_STOCK_CHAR_PICKER for the keyboard shortcuts dialog. Not
	quite right but at least greppable when we have a proper icon.

2005-09-30  Michael Natterer  <mitch@picman.org>

	* app/dialogs/dialog.c: removed forgotten foreign registration of
	"picman-keyboard-shortcuts-dialog".

2005-09-30  Michael Natterer  <mitch@picman.org>

	* plug-ins/*/*.c: removed '...' from progress messages. They are
	redundant because we are already in a progress. Ported some more
	g_strdup_printf()/picman_progress_init() to
	picman_progress_init_printf(). Core will follow...

2005-09-29  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/uri-backend-wget.c: Finish porting to new progress
	API (and make it build).

	* plug-ins/uri/uri-backend-gnomevfs.c: Convert a g_strdup_printf
	picman_progress_set_text pair to picman_progress_set_text_printf.

2005-09-30  Sven Neumann  <sven@picman.org>

	* app/actions/dialogs-actions.c
	* app/dialogs/dialogs-constructors.[ch]
	* app/dialogs/dialogs.c
	* app/dialogs/keyboard-shortcuts-dialog.[ch]: register the keyboard
	shortcut dialog with the dialog factory as singleton toplevel dialog.

	* app/dialogs/preferences-dialog.c: changed accordingly.

	* menus/image-menu.xml.in: added a "Keyboard Shortcuts" entry to
	the Edit menu.

2005-09-30  Sven Neumann  <sven@picman.org>

	* app/dialogs/Makefile.am
	* app/dialogs/keyboard-shortcuts-dialog.[ch]
	* app/dialogs/preferences-dialog.c
	* app/widgets/picmanhelp-ids.h: moved Keyboard Shortcuts dialog into
	it's own file.

2005-09-29  Akkana Peck  <akkana@cvs.gnome.org>

	* plug-ins/common/autocrop.c:
	It was cropping too much, eliminating the first non-background
	row/column on each edge.

2005-09-29  Sven Neumann  <sven@picman.org>

	* app/base/tile-cache.c
	* app/base/tile-manager.c
	* app/base/tile-private.h
	* app/base/tile-swap.c
	* app/base/tile.c: keep the data size of a tile in the Tile struct
	instead of recalculating it over and over again. Adds an overhead
	of 4 bytes per tile but speeds up the tile cache significantly.

2005-09-29  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: optimizations by Tobias Lenz.

2005-09-29  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/progress.pdb: removed the "wrap" from
	picman_progress_set_text() so it shows up as libpicman function again.

	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* libpicman/picmanprogress.[ch]: changed the old
	picman_progress_set_text() to picman_progress_set_text_printf() and
	added picman_progress_init_printf(). (did this because the method of
	calling init(NULL) followed by set_text("foo") caused popup
	progress windows to be resized after they were shown).

	* libpicman/picman.def: changed accordingly.

	* plug-ins/*/*.c: use picman_progress_init_printf() instead of
	init(NULL) plus set_text(foo) and changed users of set_text() to
	use set_text_printf().

2005-09-29  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c: removed the frame
	around the progress bar.

2005-09-29  Akkana Peck  <akkana@cvs.gnome.org>

	* plug-ins/common/zealouscrop.c:
	Update every 20 steps, instead of 19 out of every 20.

2005-09-29  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c
	(script_fu_browse_callback): don't set the procedure browser
	transient to the script-fu console.

2005-09-28  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanprogressbox.c
	* plug-ins/script-fu/script-fu-interface.c: made progress bars HIG
	compliant (with italic label below).

	* app/widgets/picmanfiledialog.[ch]: use a PicmanProgressBox intead of
	implementing the progress bar again.

2005-09-28  Michael Natterer  <mitch@picman.org>

	* app/actions/dialogs-actions.c (dialogs_dockable_actions): fixed
	action parameter to match both the palette list and grid.
	Fixes bug #317435.

2005-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanscanner.c (picman_scanner_new_file): mmap the
	config file using GMappedFile. Let's see how well this works...

2005-08-28  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/chrome-it.scm: Removed extraneous -
	in register block left when script was renamed.

	* plug-ins/script-fu/scripts/text-circle.scm: Fixed minor errors
	in comments.

2005-09-28  Tor Lillqvist  <tml@novell.com>

	* libpicman/picman.def: Fix typo.

2005-09-28  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gqbist.c: use a single random number generator
	for the lifetime of the plug-in. Fixes bug #317355.

2005-09-28  Sven Neumann  <sven@picman.org>

	* docs/Makefile.am
	* docs/keybindings.txt
	* docs/quick_reference.ps
	* docs/quick_reference.tar.gz: removed outdated documentation that
	is now being maintained in the user manual (bug #316423).

2005-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.c
	(picman_scrolled_preview_nav_popup_expose): draw the rectangle
	according to the scrollbar adjustments.

2005-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.[ch]
	(picman_scrolled_preview_set_position): must not set the adjustment
	value directly. Instead make sure that the scrollbar adjustments
	are uptodate and use gtk_adjustment_set_value().

2005-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.[ch]: renamed newly added function to
	picman_preview_get_controls(). Increased row padding for controls.

	* libpicmanwidgets/picmanwidgets.def
	* libpicman/picmanzoompreview.c: changed accordingly.

	* libpicmanbase/picmanutils.c (picman_enum_get_value): ref the enum
	class instead of only peeking at it.

	* libpicmanwidgets/picmanzoommodel.c (picman_zoom_button_new): set a
	tooltip on zoom buttons that only show an icon.

2005-09-28  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.[ch]: added a hbox to the table and
	the "Update Preview" checkbutton there. Added a function to access
	this control box. Increased default size to 200.

	* libpicmanwidgets/picmanscrolledpreview.[ch]: added function
	picman_scrolled_preview_set_policy() to control when the scrollbars
	should be shown.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* libpicman/picmanzoompreview.c: pack the zoom buttons into the
	preview's control box. Commented out the label, it shows a bogus
	zoom factor. Set scrollbar policy to ALWAYS to avoid resizing.

2005-09-28  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.[ch]: do not calculate the
	histogram if the histogram dock is invisible.

2005-09-28  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs-generic.h (swap_pixels): replaced
	binary operations with a naive but faster implementation using a
	local variable.

	* app/composite/picman-composite-generic.c
	(picman_composite_swap_any_any_any_generic): same change here.

2005-09-27  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: minor code cleanups by Tobias Lenz.

2005-09-27  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.c: document how to construct an
	empty PicmanIntComboBox using g_object_new().

	* plug-ins/common/aa.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/gflare/gflare.c
	* plug-ins/pagecurl/pagecurl.c: use g_object_new() to construct an
	empty PicmanIntComboBox. The old way of doing it caused warnings.

2005-09-27  Michael Natterer  <mitch@picman.org>

	* app/actions/data-commands.c
	* app/actions/file-commands.c
	* app/actions/templates-commands.c
	* app/dialogs/image-scale-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/vectors-options-dialog.c
	* app/tools/picmantexttool.c
	* libpicmanwidgets/picmancolorbutton.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/aa.c
	* plug-ins/picmanressionist/orientmap.c
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/xjt/xjt.c: fixed indentation in calls to
	gtk_dialog_set_alternative_button_order().

2005-09-27  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/buffer.pdb: added picman-buffers-get-list,
	should probably get its own PDB group.

	* libpicman/picman.def: changed accordingly.

	* app/pdb/buffer_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanbuffer_pdb.[ch]: regenerated.

2005-09-27  Sven Neumann  <sven@picman.org>

	* app/core/picman-gui.h
	* app/core/picman-utils.h
	* app/core/picmanimage-undo.h
	* app/text/picmantextlayer.h
	* app/widgets/picmaneditor.h
	* app/widgets/picmanmenufactory.h
	* app/widgets/picmanmessagedialog.h
	* app/widgets/picmansessioninfo.h
	* app/widgets/picmantooldialog.h
	* app/widgets/picmanviewabledialog.h: use G_GNUC_NULL_TERMINATED
	where appropriate.

2005-09-27  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprocbrowserdialog.h
	* libpicmanwidgets/picmanbrowser.h
	* libpicmanwidgets/picmandialog.h
	* libpicmanwidgets/picmanintcombobox.h
	* libpicmanwidgets/picmanoldwidgets.h
	* libpicmanwidgets/picmanwidgets.h: use G_GNUC_NULL_TERMINATED where
	appropriate.

	* libpicman/picmanprocbrowserdialog.c
	* libpicmanwidgets/picmanbrowser.c: added missing API docs.

2005-09-27  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprocbrowserdialog.[ch]: let
	picman_proc_browser_dialog_new() take standard dialog parameters,
	similar to picman_dialog_new().

	* plug-ins/common/procedure-browser.c
	* plug-ins/pypicman/procbrowser.c
	* plug-ins/script-fu/script-fu-console.c: changed accordingly.

2005-09-27  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	use GTK_STOCK_ABOUT for the About button (bug #317339).

2005-09-27  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbuffer.[ch]: added picman_buffer_get_bytes()
	and picman_buffer_get_image_type().

	* tools/pdbgen/pdb/edit.pdb: removed edit_named_rename() and
	edit_named_delete().

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/groups.pl
	* tools/pdbgen/pdb/buffer.pdb: new PDB group featuring
	buffer_rename(), delete(), get_width(), get_height(), get_bytes(),
	get_image_type(). Fixes bug #315130.

	* app/pdb/Makefile.am
	* libpicman/Makefile.am
	* libpicman/picman.def: changed accordingly.

	* app/pdb/buffer_cmds.c
	* app/pdb/edit_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picman_pdb.h
	* libpicman/picmanbuffer_pdb.[ch]
	* libpicman/picmanedit_pdb.[ch]: (re)generated.

2005-09-27  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanzoommodel.c: zooming out more is zooming out
	three times, not zooming in. Fixes bug #155446.

2005-09-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): applied
	patch from Robert Ögren that works around problem creating guides
	with a tablet on Windows by enabling extension events for the
	rulers.  Fixes the first problem described in bug #168516.

	* configure.in: bumped version to 2.3.5.

2005-09-26  Sven Neumann  <sven@picman.org>

	* Made 2.3.4 development release.

2005-09-26  Michael Natterer  <mitch@picman.org>

	Allow to disable the color picker info dialog. Fixes bug #315011:

	* app/tools/tools-enums.[ch] (enum PicmanColorPickerMode): added
	value PICMAN_COLOR_PICK_MODE_PALETTE.

	* app/tools/picmancolorpickeroptions.[ch]: deprecated property
	"add-to-palette" and added property "use-info-window". Changed
	tool options GUI accordingly.

	* app/tools/picmancolorpickertool.c
	(picman_color_picker_tool_modifier_key): made <shift> toggle
	the use-info-window property.

	(picman_color_picker_tool_picked): moved palette picking code
	into the pick_mode switch() statement.

	* app/tools/picmancolortool.c (picman_color_tool_cursor_update):
	show a "plus" cursor when adding to the palette.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_interface):
	set "activates-default" on all entries.

2005-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-interface.c: removed some frames
	from the Script-Fu dialogs.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* app/actions/debug-commands.c (debug_dump_menus_cmd_callback)
	(debug_dump_menus_recurse_menu): resurrected.

2005-09-26  Michael Natterer  <mitch@picman.org>

	Allow plug-ins to register menu entries in the <Brushes>,
	<Gradients>, <Palettes>, <Patterns> and <Fonts> menus:

	* app/actions/actions.c (action_data_get_picman): return a Picman
	also if "data" is a PicmanContainerView or PicmanContainerEditor.

	* app/gui/gui-vtable.c (gui_menus_add_proc)
	* app/plug-in/plug-in-params.c (plug_in_proc_args_check): support
	the new plug-in menu locations.

	* app/menus/menus.c (menus_init): add the "plug-in" action group
	to the resp. UI managers.

	* menus/brushes-menu.xml
	* menus/buffers-menu.xml
	* menus/fonts-menu.xml
	* menus/gradients-menu.xml
	* menus/palettes-menu.xml
	* menus/patterns-menu.xml: added separators at the end of the menus.

	* plug-ins/script-fu/scripts/font-map.scm: -> <Fonts>
	* plug-ins/script-fu/scripts/gradient-example.scm: -> <Gradients>
	* plug-ins/script-fu/scripts/mkbrush.scm: -> <Brushes>

	* plug-ins/script-fu/script-fu.c (script_fu_extension_init): don't
	register the "Make Brush" menu branch.

2005-09-26  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c
	* tools/test-clipboard.c: use G_OPTION_FLAG_NO_ARG where needed.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/paste-as-brush.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: cleanup.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* app/actions/edit-actions.c: renamed action back to "Paste as
	New" and added a second action with the "New Image" label. The
	original label is needed for <Toolbox>/File/Acquire.

	* menus/image-menu.xml.in: changed accordingly.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-params.c (plug_in_proc_args_check): drop the
	restriction that plug-ins registered in <Image> must have
	RUN-MODE, IMAGE, DRAWABLE parameters because everything but
	RUN-MODE is actually treated as optional be the rest of the code.

	* plug-ins/script-fu/scripts/paste-as-brush.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: removed IMAGE
	and DRAWABLE parameters.

	* plug-ins/common/screenshot.c
	* plug-ins/twain/twain.c
	* plug-ins/winsnap/winsnap.c: register menu entries in
	<Image>/File/Acquire

2005-09-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gqbist.c: minor dialog tweak.

2005-09-26  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c
	* app/file/file-save.c
	* app/file/file-open.c: use g_access() from gstdio.h.

	* app/config/picmanconfig-file.c (picman_config_file_copy)
	* libpicmanthumb/picmanthumbnail.c: use g_chmod() from gstdio.h.

	* app/file/picmanrecentlist.c
	* libpicmanconfig/picmanconfigwriter.c: use g_creat() from gstdio.h.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* menus/image-menu.xml.in: added Colors/Modify placeholder.

	* plug-ins/common/vinvert.c: moved to Colors/Modify/Invert.

2005-09-26  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: bumped the required version of glib to 2.8.

	* app/main.c: use G_OPTION_FLAG_NO_ARG with callback options that
	take no argument. Fixes command-line options needed for 'make
	dist', such as '--dump-picmanrc'

2005-09-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/carve-it.scm
	* plug-ins/script-fu/scripts/chrome-it.scm: renamed to "Stencil Carve"
	and "Stencil Chrome" and moved to Filters/Decor.

	* plug-ins/script-fu/script-fu.c: don't register menu branches
	"Filters/Selection" and "Filters/Decor/Stencil Ops".

2005-09-25  Carol Spears  <carol@picman.org>

	* plug-ins/common/max_rgb.c moved menu entry from Colors to
        Colors/Modify.

	* plug-ins/common/borderaverage.c moved menu entry from Colors to
        Colors/Info and added some vital information to the registration
        information.

	* plug-ins/common/channel_mixer.c moved menu entry from Colors to
        Colors/Modify.

	* plug-ins/common/colorify.c moved menu entry from Colors to
        Colors/Modify.

	* plug-ins/common/fp.c moved menu entry from Colors to
        Colors/Modify.

	* plug-ins/common/retinex.c moved menu entry from Colors to
        Colors/Modify.

2005-09-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/fade-outline.scm: renamed to
	"Fade to Layer Mask..." and moved to the Select menu.

2005-09-25  Sven Neumann  <sven@picman.org>

	* plug-ins/common/max_rgb.c: moved it back, the plug-in changes
	the image. Renamed to "Maximum RGB".

2005-09-25  Carol Spears  <carol@picman.org>

	* plug-ins/common/max_rgb.c moved menu entry from Colors to
        Colors/Info.

	* plug-ins/common/smooth_palette.c moved menu entry from Colors to
        Colors/Info.

	* plug-ins/common/semiflatten.c removed menu entry from Colors and
        added it to Filters/Web

	* plug-ins/pypicman/plug-ins/py-slice.py added the patch from
        Joao S. O. Bueno Calligaris that was attached to bug #159564.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/actions/edit-actions.c
	* menus/image-menu.xml.in: added "Edit/Paste as" submenu and moved
	"Paste as new" there (renamed to "New Image").

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/paste-as-brush.scm
	* plug-ins/script-fu/scripts/paste-as-pattern.scm: new scripts
	roughly derived from select-to-brush and select-to-pattern.

	* plug-ins/script-fu/scripts/select-to-brush.scm
	* plug-ins/script-fu/scripts/select-to-image.scm
	* plug-ins/script-fu/scripts/select-to-pattern.scm: don't register
	menu entries.

2005-09-25  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]: applied patch from Gerald Friedland and
	Tobias Lenz. Introduces a hash table to speed up the algorithm
	and changes the post-processing so that multiple disjunct objects
	can be selected.

	* app/tools/picmanforegroundselecttool.c: changed tooltip, the tool
	doesn't any longer extract single objects only.

2005-09-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgetsenums.[ch]: removed PicmanZoomWidgetType.

	* libpicmanwidgets/picmanzoommodel.[ch]: removed picman_zoom_widget_new()
	in favor of picman_zoom_button_new().

	* libpicman/picmanzoompreview.c: changed accordingly.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* plug-ins/MapObject/mapobject_main.[ch]
	* plug-ins/MapObject/mapobject_preview.c
	* plug-ins/MapObject/mapobject_ui.c: use a PicmanZoomModel and let
	it create the zoom buttons.

	* plug-ins/MapObject/mapobject_apply.c
	* plug-ins/MapObject/mapobject_image.c
	* plug-ins/MapObject/mapobject_shade.c: include "picman/picmanui.h".

2005-09-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/help/Makefile.am (picman_help_lookup_LDADD): link
	against libpicmanbase now that we use picman_data_directory().

2005-09-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/distress-selection.scm: renamed to
	"Distort..." and moved to Select/Modify.

2005-09-24  Hans Breuer  <hans@breuer.org>

	* **makefile.msc : updated

	* app/dialogs/user-install-dialog.c : only add the migrate page if
	there is something to migrate from. Avoids on version being NULL.

	* app/dialogs/file-save-dialog.c : the g_print() output was crashing
	on the assumption that ->menu_label != NULL. It is for colorhtml.py.

	* app/widgets/picmanselectiondata.c : use HAVE_UNISTD_H and move
	* process.h definition by G_OS_WIN32 below it being defined
	* app/widgets/picmanwidgets-utils.c(picman_window_get_native) : cast
	return value to (GdkNativeWindow) it is not necessary an int.

	* libpicmanwidgets/picmanwidgets.def : added picman_zoom_type_get_type

	* plug-ins/help/picman-help-lookup.c : dynamic lookup of help_root
	instead of hard-coding DATADIR/PICMAN_HELP_PREFIX

	* plug-ins/xjt/xjt.c : there is no pid_t with msvc, typedef one.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-actions.c
	* menus/image-menu.xml.in: get rid of Filters/Effects because it
	doesn't mean anything. Added Filters/Generic and Filters/Combine
	back instead. Not perfect either but more meaningful.

	* plug-ins/common/depthmerge.c
	* plug-ins/common/film.c: -> Filters/Combine

	* plug-ins/common/convmatrix.c
	* plug-ins/common/vpropagate.c: -> Filters/Generic

	* plug-ins/script-fu/scripts/erase-rows.scm: -> Filters/Distorts

	* plug-ins/script-fu/scripts/predator.scm: -> Filters/Artistic

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/dialogs/convert-dialog.c
	* app/dialogs/palette-import-dialog.c: added icons to the
	affirmative action buttons.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c (view_zoom_actions): use
	PICMAN_STOCK_CHAR_PICKER for the actions which are only there for
	keyboard shortcuts. Not perfect but better than before.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/actions/file-actions.c (file_actions): made Shift+Ctrl+W the
	shortcut for "Close all".

2005-09-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/psd.c: massively indented and de-uglyfied,
	(not many lines unmodified). Still not the incarnation of
	beautiful code, but more readable for an eye used to Picman code.
	No logic changes, just formatting.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compose.c (run): set "is_ID" to TRUE, not FALSE
	when decoding the "compose-data" parasite. Fixes Recompose.
	Return error, not success if recomposing fails. Misc cleanups.

2005-09-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanzoommodel.[ch]: added picman_zoom_model_zoom()
	and changed picman_zoom_model_get_fraction() to take a model instead
	of the zoom factor.

	* app/display/picmandisplayshell.[ch]: use a PicmanZoomModel for the
	display scale factor.

	* app/actions/image-commands.c
	* app/actions/view-actions.c
	* app/actions/view-commands.c
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scale.c
	* app/display/picmandisplayshell-title.c
	* app/display/picmannavigationeditor.c
	* app/display/picmanstatusbar.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanmagnifytool.c: changed accordingly.

2005-09-25  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmancroptool.c: fixed assignment of local variable
	"rectangle_exists".

2005-09-25  Sven Neumann  <sven@picman.org>

	* app/tools/picmannewrectselecttool.c: fixed assignment of local
	variable "rectangle_exists".

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): reordered checks for
	the modifiers pressed on <Tab> so NumLock and friends don't
	interfere. Fixes bug #317118.

2005-09-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgetsenums.h: added more values to the
	PicmanZoomType enum.

	* libpicmanwidgets/picmanzoommodel.c (picman_zoom_model_zoom_step):
	handle the new enum values.

	* app/actions/view-commands.c (view_zoom_cmd_callback) use the new
	values.

	* app/display/picmandisplayshell.c (picman_display_shell_new): cosmetics.

2005-09-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanzoommodel.[ch]: minor cleanup, documentation.

2005-09-25  Michael Natterer  <mitch@picman.org>

	* app/dialogs/quit-dialog.c (quit_close_all_dialog_new): another
	patch from Sylvain Foret that fixes the dialog title for the close
	all dialog. Fixes bug #317137. Also pass the right help IDs to
	picman_message_dialog_new().

2005-09-24  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanwidgetsenums.h: remove the PICMAN_ZOOM_LABEL value
	from PicmanZoomWidgetType.

	* libpicmanwidgets/picmanwidgetsenums.c: regenerated.

	* libpicman/picmanzoompreview.c: provides two read only properties,
	"fraction" and "percentage" to be used with prop widgets.

	* libpicmanwidgets/picmanzoommodel.c: use a picman_prop_label to show the
	zoom fraction.

2005-09-24  Michael Natterer  <mitch@picman.org>

	* app/actions/file-actions.c: set "Close all" insensitive when
	there are no displays.

2005-09-24  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]: de-uglify callback names for
	"new" and "close".

2005-09-24  Michael Natterer  <mitch@picman.org>

	Applied (slightly modified) patch from Sylvain Foret which adds
	"Close All" menu entries and dialog. Fixes bug #163532.

	* app/actions/file-actions.c
	* app/actions/file-commands.[ch]: added "file-close-all" action
	and callback.

	* app/dialogs/dialogs-constructors.[ch]
	* app/dialogs/dialogs.c
	* app/dialogs/quit-dialog.[ch]: added close all dialog which is a
	modified quit dialog.

	* app/widgets/picmanhelp-ids.h: added help ID.

	* menus/image-menu.xml.in
	* menus/toolbox-menu.xml.in: add close all next to quit.

2005-09-24  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_dialog): set "activates-default" on all
	spinbuttons.

2005-09-24  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compose.c: fixed some brokenness caused by my
	last "cleanup". Should work as before now.

	* plug-ins/common/decompose.c: cleaned up GUI and code.

2005-09-24  DindinX  <dindinx@picman.org>

	* app/widgets/widgets-enums.h: Moved the PicmanZoomType enum from
	here...

	* libpicmanwidgets/picmanwidgetsenums.h: ...to here.

	* app/widgets/widgets-enums.c
	* libpicmanwidgets/picmanwidgetsenums.c: regenerated.

	* app/display/picmandisplayshell-scale.[ch]: removed
	picman_display_shell_scale_zoom_step and
	picman_display_shell_scale_get_fraction from here...

	* libpicmanwidgets/picmanzoommodel.[ch]: ... to here so we can use these
	utility functions in plug-ins and in the core.
	Also removed the step-size property since the zoom-model now use
	picman_zoom_model_zoom_step.

	* app/actions/view-commands.c
	* app/display/picmandisplayshell-title.c
	* app/display/picmandisplayshell.c
	* app/tools/picmanmagnifytool.c: modified accordingly.

	* libpicman/picmanzoompreview.c: don't pass any argument to the
	picman_zoom_model_new function.

	* libpicmanwidgets/picmanwidgets.def: added picman_zoom_model_zoom_step
	(picman_zoom_model_get_fraction was already there)

2005-09-24  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.h
	* app/tools/picmanimagemaptool.c
	* tools/test-clipboard.c: indentation fixes.

2005-09-24  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanactiongroup.c
	(picman_action_group_set_action_hide_empty): renamed from
	set_action_important(). Set the "hide-if-empty" property so
	showing an insensitive "Empty" item instead of hiding the submenu
	works again (did this ever work?).

	* app/actions/tool-options-actions.c (tool_options_actions_setup):
	changed accordingly. Keeps the tool options submenus from
	disappearing.

2005-09-23  Michael Natterer  <mitch@picman.org>

	* menus/image-menu.xml.in: reordered submenus and placeholders
	so stuff is not grouped that randomly any longer.

	* plug-ins/script-fu/scripts/hsv-graph.scm: move it to the "Info"
	placeholder so it is next to histogram and ccanalyze.

2005-09-23  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c: added a tooltip that explains how to
	obtain the file size.

2005-09-22  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: added a check for libgnomeprintui.

	* plug-ins/common/gnomeprint.c: added a simple Print plug-in that
	uses libgnomeprint and libgnomeprintui. Needs more work.

	* plug-ins/common/plugin-defs.pl: added the new plug-in.

	* plug-ins/common/Makefile.am: regenerated.

2005-09-22  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanzoommodel.c: renamed the properties "value",
	"minimum" and "maximum".

	* libpicman/picmanzoompreview.c: modified accordingly.

2005-09-22  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: canonicalize procedure name and parameters.

2005-09-22  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compose.c: reorganized and cleaned up GUI and code.

2005-09-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c: don't hardcode unit conversion factors.

2005-09-21  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/psd.c: Load the resolution properly when it is
	specified in px/cm.
	* plug-ins/common/psd_save.c: Save the resolution of the image in
	the file.  Fixes bug #310426

2005-09-21  Sven Neumann  <sven@picman.org>

	* HACKING: minor update.

2005-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: update the preview from an
	idle handler. Removed obsolete "Update Preview" button.

2005-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/spheredesigner.c: more compact dialog layout,
	renamed "Textures" to "Layers" and make sure that one is always
	selected.

2005-09-21  Michael Natterer  <mitch@picman.org>

	Separated the global buffer logic from the clipboard
	implementation:

	* app/widgets/picmanclipboard.[ch]: removed all knowledge about
	picman->global_buffer. Removed the Picman::buffer-changed callback.
	Made picman_clipboard_set_buffer() public and remember the set
	buffer in the PicmanClipboard struct. Fixed the has_buffer() and
	has_svg() functions.

	* app/gui/gui.c: connect to Picman::buffer-changed here and call
	picman_clipboard_set_buffer() from the callback.

2005-09-21  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c: use ngettext for plural forms.

2005-09-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/cubism.c: initialize variables.

	* plug-ins/common/depthmerge.c: declare all functions as static.

2005-09-20  DindinX  <dindinx@picman.org>

	* libpicman/picmanzoompreview.[ch]: make use of private data instead
	of struct members. Added a picman_zoom_preview_get_drawable so we
	can still get the drawable from a preview in plug-ins.

	Also changed picman_zoom_preview_get_data() to
	picman_zoom_preview_get_source(), to make it more obvious what it
	returns.

	* libpicman/picmanui.def
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/colorify.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/illusion.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/nova.c
	* plug-ins/common/polar.c
	* plug-ins/common/retinex.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c: changed accordingly.

2005-09-20  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanzoommodel.[ch]: use private data instead of
	struct members. Added min-factor and max-factor properties so we can
	set the zoom range. These can be set by a new utility function:
	picman_zoom_model_set_range.

	* libpicmanwidgets/picmanwidgets.def: added picman_zoom_model_set_range.

	* libpicman/picmanzoompreview.c: use picman_zoom_model_set_range so we can
	only zoom in.

2005-09-20  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (erode_region, dilate_region):
	fixed bug in buffer initialization, spotted by Tobias Lenz.

2005-09-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: corrected version check (bug #314400).

2005-09-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscale.c: invalidate the buffer when the
	widget's sensitivity changes. Draw a stipple pattern on the
	insensitive color scale.

2005-09-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/raw.c (query): fixed capitalization.

2005-09-20  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compose.c: applied patch from Sylvain Foret
	which allows to use fixed greyscale values instead of drawables
	for color components. Fixes bug #309112.

2005-09-20  Sven Neumann  <sven@picman.org>

	* app/core/picmanitem.c: added read-only properties for id, width
	and height.

2005-09-20  DindinX  <dindinx@picman.org>

	* libpicman/picmanui.def: added the functions from picmanzoompreview.h

	* libpicmanwidgets/picmanwidgets.def: added the functions from
	picmanzoommodel.h

2005-09-20  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanzoommodel.[ch]: New object to handle zoom
	factor, and create widgets to control or view this value.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h: Added picmanzoommodel.[ch].

	* libpicmanwidgets/picmanwidgetsenums.h: new enum: PicmanZoomWidgetType.
	This enumerate which knid of widget you can created from the zoom
	model.

	* libpicmanwidgets/picmanwidgetsenums.c
	* libpicmanwidgets/picmanwidgetstypes.h: regenerated.

	* libpicmanwidgets/picmanpreview.c: move the update toggle to the bottom
	of the box.

	* libpicman/Makefile.am
	* libpicman/picmanui.h
	* libpicman/picmanuitypes.h
	* libpicman/picmanzoompreview.[ch]: New widget, derivated from
	PicmanScrolledPreview, which offer the same functionnalities as the
	PicmanAspectPreview widget plus zoom facilities.

	* plug-ins/common/AlienMap2.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/blinds.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/colorify.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/illusion.c
	* plug-ins/common/jigsaw.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/nova.c
	* plug-ins/common/polar.c
	* plug-ins/common/retinex.c
	* plug-ins/common/waves.c
	* plug-ins/common/whirlpinch.c: use a PicmanZoomPreview instead of a
	PicmanAspectPreview.

2005-09-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanclipboard.[ch]: added new public function
	picman_clipboard_set_svg() and internal stuff to offer and transfer
	the svg data to the clipboard.

	* app/actions/vectors-commands.c (vectors_copy_cmd_callback)
	(vectors_paste_cmd_callback): implement copy/paste of vectors as
	SVG. Fixes bug #316547.

	* app/widgets/picmanvectorstreeview.c
	(picman_vectors_tree_view_drag_svg): don't add the terminating
	nul-byte of the svg string to svg_data_length, it confuses the XML
	parser.

	* app/actions/vectors-actions.c
	* app/actions/vectors-commands.[ch]
	* menus/vectors-menu.xml: reordered export/import so they are in
	the same order as copy/paste.

2005-09-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: moved toolbar out of main vbox.

2005-09-19  Sven Neumann  <sven@picman.org>

	* autogen.sh
	* configure.in
	* app/main.c
	* app/widgets/picmantoolbox.c
	* plug-ins/script-fu/scripts/web-browser.scm: changed "The PICMAN"
	to "GNU Image Manipulation Program" or just "PICMAN".

2005-09-19  Sven Neumann  <sven@picman.org>

	* app/actions/actions.c: use GTK_STOCK_FILE for File actions.

	* app/actions/dialogs-actions.c
	* plug-ins/picmanressionist/picmanressionist.c
	* plug-ins/print/picman_main_window.c: use GTK_STOCK_ABOUT for About
	dialogs.

	* app/actions/actions.c
	* app/actions/brushes-actions.c
	* app/actions/channels-actions.c
	* app/actions/channels-commands.c
	* app/actions/colormap-editor-actions.c
	* app/actions/gradients-actions.c
	* app/actions/layers-actions.c
	* app/actions/layers-commands.c
	* app/actions/palette-editor-actions.c
	* app/actions/palettes-actions.c
	* app/actions/patterns-actions.c
	* app/actions/templates-actions.c
	* app/actions/templates-commands.c
	* app/actions/text-editor-actions.c
	* app/actions/tool-options-actions.c
	* app/actions/vectors-actions.c
	* app/actions/vectors-commands.c
	* app/tools/picmantexttool.c
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmancontrollerlist.c
	* plug-ins/flame/flame.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/orientation.c
	* plug-ins/picmanressionist/size.c
	* plug-ins/metadata/interface.c: s/PICMAN_STOCK_EDIT/GTK_STOCK_EDIT/

2005-09-19  Michael Natterer  <mitch@picman.org>

	Did a global s/qmask/quick-mask/:

	* app/actions/qmask-actions.[ch]
	* app/actions/qmask-commands.[ch]
	* app/core/picmanimage-qmask.[ch]
	* menus/qmask-menu.xml
	* themes/Default/images/stock-qmask-off-16.png
	* themes/Default/images/stock-qmask-on-16.png: removed.

	* app/actions/quick-mask-actions.[ch]
	* app/actions/quick-mask-commands.[ch]
	* app/core/picmanimage-quick-mask.[ch]
	* menus/quick-mask-menu.xml
	* themes/Default/images/stock-quick-mask-off-16.png
	* themes/Default/images/stock-quick-mask-on-16.png: added.

	* app/actions/Makefile.am
	* app/actions/actions.c
	* app/core/Makefile.am
	* app/core/core-enums.[ch]
	* app/core/picmanchannel.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-undo.c
	* app/core/picmanimage.[ch]
	* app/core/picmanundo.[ch]
	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell-callbacks.[ch]
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.[ch]
	* app/menus/menus.c
	* app/widgets/picmanhelp-ids.h
	* libpicmanwidgets/picmanstock.[ch]
	* menus/Makefile.am
	* menus/image-menu.xml.in
	* themes/Default/images/Makefile.am: changed accordingly.

2005-09-19  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_new_pixbuf): use
	GTK_STOCK_DIRECTORY for PICMAN_THUMB_STATE_FOLDER.

2005-09-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: replaced buttons with toolbar.

2005-09-18  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c (view_zoom_actions): added stock IDs
	and help IDs to the new zoom actions.

	* menus/image-menu.xml.in: removed the <accelerator .../> lines
	again. Actions don't need a visible proxy to be activatable.

2005-09-18  Sven Neumann  <sven@picman.org>

	* app/actions/view-actions.c (view_zoom_actions):
	* menus/image-menu.xml.in: added extra Zoom In/Out actions and
	bind them to the Add/Subtract keys on the keypad (bug #316555).

2005-09-17  Michael Natterer  <mitch@picman.org>

	We don't need two labels for "Toggle Quick Mask":

	* app/actions/qmask-actions.c: removed "qmask-active" action.

	* menus/qmask-menu.xml: use "qmask-toggle" instead.

	* app/actions/actions.c (action_groups): s/QuickMask/Quick Mask/
	Fixes bug #316569.

2005-09-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanactionview.c (picman_action_view_new): skip
	actions if their name starts with '<' (menu actions created by
	plug-ins have names like "<Image>/Foo/Bar"). Scroll the
	pre-selected action to the center of the view, not to the top.

	* app/widgets/picmancontrollereditor.c
	(picman_controller_editor_edit_clicked): make the action editor
	transient to the controller editor. Show the edited event's name
	in the controller editor's header.

	* app/widgets/picmancontrollerwheel.c: use picman_get_mod_string()
	instead of hardcoding the modifiers in tons of translatable
	strings. Don't call gettext() in PicmanController::get_blurb(),
	the strings are already translated.

	* app/widgets/picmancontrollerkeyboard.c: removed call to gettext()
	here too.

2005-09-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmanimagemaptool.c (picman_image_map_tool_initialize):
	set the imagemap tool dialogs transient to the image window. See
	comments in bug #316521.

2005-09-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch] (picman_widget_set_accel_help):
	mis-named and mis-placed function that sets a widget's tooltip to
	the action's tooltip plus the action's keyboard shortcut.

	* app/widgets/picmantoolbox.c: at least the code is not here any
	more.

	* app/actions/tools-actions.c: use tool_info->help, not ->blurb
	as the action's tooltip so the above works.

2005-09-13  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmancroptool.c
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmannewrectselecttool.c: changed the way we stay inside
	images boundaries so each tool decides whether it does or not.

2005-09-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c (picman_toolbox_substitute_underscores):
	removed.

2005-09-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_get_mod_name_*): removed
	"<>" around modifiers.

	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmancolorpickeroptions.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancropoptions.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanflipoptions.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanmagnifyoptions.c
	* app/tools/picmanmoveoptions.c
	* app/tools/picmanselectionoptions.c
	* app/tools/picmantransformoptions.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanthumbbox.c: added "()" around the whole modifier
	string where appropriate.

	* app/widgets/picmantoolbox.c (picman_toolbox_button_accel_changed):
	use picman_get_mod_string() instead of homebrewn variant of the same
	code.

	* app/widgets/picmancontrollerkeyboard.c: replaced tons of static
	translatable strings containing modifiers by generated ones using
	picman_get_mod_string() (traded for some more memory consumption).

2005-09-13  Michael Natterer  <mitch@picman.org>

	* app/actions/dockable-actions.c (dockable_actions_update): don't
	make "Detach Tab" insensitive if there are other dockbooks in the
	dock.

	* app/widgets/picmandock.[ch]
	* app/widgets/picmandockseparator.[ch]: cleanup.

2005-09-13  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: don't modify the rectangle while
	moving, and stick to edges when going out of image boundaries.

2005-09-13  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c: use "Undo History" instead of "Undo
	Editor" in user-visible string. Removed wrongly used ellipsis.

	* app/dialogs/offset-dialog.c: added translator comment.

	* app/dialogs/quit-dialog.c: string change.

2005-09-13  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: allow to disable build of the poppler plug-in.

2005-09-13  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c (picman_time_since): use
	ngettext for plural forms.

2005-09-13  Sven Neumann  <sven@picman.org>

	* modules/colorsel_cmyk.c: added comments for translators.

2005-09-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.c (picman_palette_import_from_image):
	ignore transparent pixels as suggested in bug #316212.

2005-09-13  Sven Neumann  <sven@picman.org>

	* app/tools/picmanbucketfilloptions.c: reorder options as suggested
	in bug #316150.

2005-09-13  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-title.c
	(picman_display_shell_format_title): use ngettext for plural form.

	* app/dialogs/user-install-dialog.c: string fix (bug #316148).

2005-09-12  Michael Natterer  <mitch@picman.org>

	Really fix bug #150593:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmandockseparator.[ch]: new widget implementing the
	droppable separator bar in docks.

	* app/widgets/picmandock.c: use it and removed local separator
	utility functions.

	* app/widgets/picmantoolbox.c: use PicmanDockSeparator API to show/hide
	the label. Expand the separator initially.

	* themes/Default/gtkrc
	* themes/Small/gtkrc: the separator height style property moved
	from PicmanDock to PicmanDockSeparator.

2005-09-12  Akkana Peck  <akkana@cvs.gnome.org>

	* menus/image-menu.xml.in
	* app/actions/image-actions.c: Move Mode menu from Colors
	back to Image, and rename it back to Mode, as per consensus
	on #picman.

2005-09-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox.c: set the label style italic. Moved
	separator code into utility functions.

2005-09-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c (picman_toolbox_book_added)
	(picman_toolbox_book_removed): if there is no dockbook added, expand
	the separator and add a label telling the user that she can drop
	dockables there. Fixes bug #150593.

2005-09-11  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch] (enum PicmanUndoType): replaced lots of
	bogus strings by properly translatable ones. Many of them are
	fallbacks anyway, but they should be presentable to the user.
	Fixes bug #315964.

2005-09-11  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.c: don't include "core/picmanmarshal.h",
	replaced '_' by '-' in property name.

2005-09-11  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-interface.c (script_fu_response):
	bail out if the action_area is insensitive. Ignores attempts to
	close the window while the script is running. Fixes bug #308662.

2005-09-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainerbox.c
	(picman_container_box_set_size_request): take the container's
	border_width into account.

	* app/widgets/picmancontainergridview.c
	(picman_container_grid_view_init): make sure GTK_SHADOW_IN is set on
	the scrolled window, not on the viewport, so we get the same
	results for list and grid views when using
	picman_container_box_set_size_request().

	* app/widgets/picmancontainerpopup.[ch]: added setters and getters
	for view_type and preview_size, don't allow the preview to grow
	larger than the popup.

	* app/widgets/picmanviewablebutton.[ch]: added "popup-view-type" and
	"popup-preview-size" properties and setters/getters.

2005-09-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewablebox.c: factored out common code in
	preparation of fixing bug #315443.

	* app/widgets/picmanviewablebutton.h (struct PicmanViewableButton):
	"popup_preview_size" is a gint, not a PicmanViewType.

2005-09-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmaniscissorstool.c	(picman_iscissors_tool_button_release):
	use picman_draw_tool_on_handle() to figure if we need to close the
	path. Makes sure that the anchor's sensitive area matches its size
	on screen. Fixes bug #134250.

2005-09-10  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbase-private.h: PicmanUnitVTable -> PicmanUnitVtable

	* libpicmanbase/picmanbase-private.c
	* libpicman/picman.c (picman_main)
	* app/units.c (units_init): changed accordingly.

2005-09-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c (picman_clone_options_gui): moved the
	"Sample merged" toggle below the "Image source" radio button.
	Also fixed capitalization of "Sample merged".

2005-09-10  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprogress.h: match parameter name in .c file.

2005-09-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/aa.c
	* plug-ins/common/csource.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gih.c
	* plug-ins/common/gtm.c
	* plug-ins/common/mng.c
	* plug-ins/common/pat.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/postscript.c
	* plug-ins/common/psp.c
	* plug-ins/common/raw.c
	* plug-ins/common/sunras.c
	* plug-ins/common/tga.c
	* plug-ins/common/tiff.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xpm.c
	* plug-ins/gfli/gfli.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/sgi/sgi.c
	* plug-ins/winicon/icodialog.c: actually call
	picman_window_set_transient() on save dialogs.
	Really fixes bug #62988.

2005-09-09  Michael Natterer  <mitch@picman.org>

	Added parent window API to the PicmanProgress interface and to
	the libpicman progress stuff. Might look strange, but does
	the right thing in almost all cases (image window, file dialog,
	script-fu dialog etc). Fixes bug #62988.

	* app/core/picmanprogress.[ch]: added PicmanProgress::get_window()
	which should return a toplevel window ID if the progress is in a
	window that wants to be the transient parent of plug-in dialogs.

	* app/widgets/picmanwidgets-utils.[ch] (picman_window_get_native): new
	function which returns the window handle of a GtkWindow's GdkWindow.

	* app/widgets/picmanfiledialog.c: implement ::get_window().

	* app/display/picmandisplay.[ch]: ditto. Removed window handle API.

	* app/gui/gui-vtable.c: changed accordingly.

	* libpicmanbase/picmanbaseenums.[ch] (enum PicmanProgressCommand):
	added PICMAN_PROGRESS_COMMAND_GET_WINDOW.

	* app/plug-in/plug-in-progress.[ch] (plug_in_progress_get_window):
	new function. Also renamed some functions to match the
	PicmanProgress interface, and not the legacy PDB procedure names.

	* tools/pdbgen/pdb/progress.pdb
	* app/core/picmanpdbprogress.c: implement get_window() on both
	sides of the wire, keeping backward compatibility (hopefully).

	* libpicman/picmanprogress.[ch]: deprecated picman_progress_install()
	and added picman_progress_install_vtable() which takes a vtable with
	padding to be extensible. Added get_window() vtable entry and
	dispatch it accordingly. Also added pulse() which was implemented
	in a hackish way before. Everything is of course backward
	compatible.

	* libpicman/picmanprogressbar.c: inmplement the get_window() stuff
	so a plug-in dialog containing a progress can be the transient
	parent of another dialog in another plug-in.

	* libpicman/picmanui.[ch] (picman_ui_get_progress_window): new function
	which returns a foreign GdkWindow of this plug-ins progress
	window.

	Renamed picman_window_set_transient_for_default_display() to
	picman_window_set_transient() and make it use the progress' window
	handle instead of the display's (which is the right thing to do in
	almost all cases).

	* libpicman/picman.def
	* libpicman/picmanui.def: add the new functions.

	* tools/pdbgen/enums.pl
	* app/pdb/internal_procs.c
	* app/pdb/progress_cmds.c
	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* libpicman/picmanexport.c
	* plug-ins/*/*.c: follow API change.

2005-09-09  Tor Lillqvist  <tml@novell.com>

	* picmantool-win32.c.in (get_prefix, maybe_append_exe)
	* libpicmanbase/picmandatafiles.c (is_script): Practice what I preach
	and use g_ascii_strcasecmp() instead of g_strcasecmp().

2005-09-09  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c (printrc_load): use g_ascii_strcasecmp()
	instead of strcasecmp().

2005-09-09  Michael Natterer  <mitch@picman.org>

	* configure.in: Removed 'hi' again until all po files are there.

2005-09-09  Rajesh Ranjan  <rajeshkajha@yahoo.com>

	* configure.in: Added 'hi' to ALL_LINGUAS.

2005-09-08  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer-floating-sel.c (floating_sel_boundary): if
	the floating selection has no alpha, manually create BoundSegs of
	its outline instead of calling boundary_find() (which creates a
	boundary of the last channel). Fixes bug #145373.

	* app/widgets/picmanlayertreeview.c
	(picman_layer_tree_view_floating_selection_changed): update all
	layer names' text attributes, not only for layers with alpha.
	Fixes layer name display when making a new layer out of a floating
	selection without alpha.

2005-09-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: allow to popup the context
	menu from the views' empty area. Fixes bug #314719.

2005-09-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel-combine.c (picman_channel_combine_ellipse):
	use picman_rectangle_intersect() instead of just looking at the
	passed in w,h to figure whether nothing needs to be done. While
	the algorithm does nicely with an entirely out-of-image ellipse,
	the channel's bounds were set to a rectangle of zero width or
	height, which caused subsequent calls to picman_channel_bounds() to
	return broken bounds. Fixes bug #315417.

	(picman_channel_combine_rect)
	(picman_channel_combine_mask): use picman_rectangle_intersect() here
	too instead of the usual unclear CLAMPing on x1,y1,x2,y2.

2005-09-07  Ankit Patel  <ankit644@yahoo.com>

	* configure.in: Added 'gu' to ALL_LINGUAS.

2005-09-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanerrordialog.[ch]: don't set a window icon, the
	dialog should be transient anyway.

	* app/dialogs/dialogs-constructors.c: changed accordingly.

2005-09-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels): change
	variables from unsigned to signed -- fixes problem described
	in comment 17 of bug #163721.

2005-09-06  Sven Neumann  <sven@picman.org>

	* app/dialogs/stroke-dialog.c (stroke_dialog_new): use
	gtk_object_sink() to destroy a floating widget.

2005-09-05  Sven Neumann  <sven@picman.org>

	* plug-ins: Call picman_window_set_transient_for_default_display()
	for most plug-in dialogs. Not yet done are load and save dialogs
	and dialogs created from language bindings.

2005-09-05  Sven Neumann  <sven@picman.org>

	Address bug #307971:

	* app/core/picman-gui.[ch]
	* app/display/picmandisplay.[ch]
	* app/gui/gui-vtable.c
	* tools/pdbgen/pdb/display.pdb: added PDB function to obtain a
	window handle on an image display.

	* app/pdb/display_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmandisplay_pdb.[ch]: regenerated.

	* libpicman/picmanui.[ch]: added functions to set a GtkWindow transient
	to an image display.

	* plug-ins/common/gauss.c: use the new function exemplarily.

	* libpicman/picman.def
	* libpicman/picmanui.def: updated.

2005-09-05  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c
	* app/menus/menus.c
	* app/widgets/picmanundoeditor.c
	* menus/Makefile.am
	* menus/undo-editor-menu.xml: added menu for undo editor.

2005-09-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/edit.pdb: applied patch from David Gowers which
	adds "picman-edit-named-delete". Addresses bug #315130. Added
	"picman-edit-named-rename" additionally.

	* libpicman/picman.def: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanedit_pdb.[ch]: regenerated.

2005-09-05  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c: don't let named cut/copy affect the global
	buffer. Fixes bug #315225. Also make "Global Buffer" translatable.

2005-09-05  Sven Neumann  <sven@picman.org>

	* app/core/picman.[ch]
	* app/core/picmanimage-new.c: removed the confusing and redundant
	feature of having the New Image dialog default to the size of the
	global buffer. Please use Paste as New instead. Fixes bug #315106.

2005-09-05  Sven Neumann  <sven@picman.org>

	* app/tools/picmanrectangletool.c: terminate variable argument list.
	Fixes bug #315255.

2005-09-05  Michael Natterer  <mitch@picman.org>

	* app/actions/edit-actions.c
	* app/actions/edit-commands.[ch]
	* menus/image-menu.xml.in: applied modified patch from David
	Gowers which adds an "edit-named-copy-visible" actions and its
	menu item. Addresses bug #315130.

2005-09-04  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangleoptions.c: evil => PICMAN_MAX_IMAGE_SIZE.

2005-09-04  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: stay within image boundaries.

2005-09-04  Michael Natterer  <mitch@picman.org>

	Cleaned up and fixed the order in which default tool options and
	user context values are initialized, and added loading / saving of
	the global user context.  Fixes bug #165078.

	* app/core/Makefile.am
	* app/core/picman-contexts.[ch]: new files which manage the global
	contexts. Contains picman_contexts_init/exit/load/save/clear().

	* app/core/picman.c: use the new init/exit functions instead of
	implementing the stuff here.

	* app/tools/picman-tools.c: load/save/clear the user context from
	here so it follows the same logic as the tool options. Reset all
	tool options before loading the user context and copy the user
	context's property to all tool options before loading tool
	options.

	* app/core/picmantoolinfo.c (picman_tool_info_new): don't initialize
	the tool options with the users context's properties. It's way too
	early here and they will be overwritten later.

	* app/widgets/picmandevices.c (picman_devices_restore): initialize all
	device contexts with the user context's properties before loading
	the devices and copying the active one back to the user context.

2005-09-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/coffee.scm
	* plug-ins/script-fu/scripts/fade-outline.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/select-to-pattern.scm: string fixes as
	pointed out in bug #315211.

2005-09-03  Michael Natterer  <mitch@picman.org>

	* app/base/temp-buf.c (temp_buf_resize): do new_size calculation
	only when needed.

2005-09-03  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore.c (picman_paint_core_get_orig_image)
	(picman_paint_core_get_orig_proj): replaced manual calculation of
	the offset of a pixel in a tile (marked as /* dubious... */ for a
	reason) by simply using the offset parameters of tile_data_pointer().

2005-09-03  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanrectangleoptions.[ch]: code cleanup, replace
	virtualization functions with interface properties.

	* app/tools/picmancroptool.[ch]
	* app/tools/picmannewrectselecttool.[ch]
	* app/tools/picmancropoptions.[ch]
	* app/tools/picmannewrectselectoptions.[ch]: code cleanup, use said
	interface properties.

2005-09-03  Michael Natterer  <mitch@picman.org>

	* app/base/pixel-surround.c: s/row_stride/rowstride/g.

2005-09-03  Michael Natterer  <mitch@picman.org>

	* app/base/pixel-region.[ch]: some general cleanup.

	(pixel_region_init_temp_buf)
	(pixel_region_init_data): new functions which initialize pixel
	regions on TempBufs and on raw contiguous arrays of pixel data.

	(pixel_region_configure): fixed a bug that has probably been there
	forever: when processing contiguous (non-tiled) data, interpret
	the original x and y coordinates of the region as offsets into
	the data. Before this fix, the initial x and y were simply ignored
	(by using them in a broken way), thus always forcing the upper
	left corner of the region being the beginning of the passed data.

	Lots of code was working around this problem by setting the
	pixel_region's data pointer to the proper starting pixel of the
	region in the middle the buffer.

	* libpicman/picmanpixelrgn.c: some general cleanup.

	(picman_pixel_rgn_configure): same fix as above. Fortunately, nobody
	seems to know that libpicman pixel regions can be used on arrays of
	data, just as core ones. Only two plug-ins were using this
	feature, and they are antique and written by spencer and federico,
	respectively. They both don't use offsets into the buffers and are
	not affected by this change. It's highly unlikely that anybody out
	there knows/uses this feature, so it can IMHO be safely changed.

	* app/base/temp-buf.c
	* app/core/picmanbuffer.c
	* app/core/picmandrawable-combine.c
	* app/core/picmandrawable-preview.c
	* app/core/picmanimage-preview.c
	* app/core/picmanlayer.c
	* app/paint/picmanbrushcore.c
	* app/paint/picmanclone.c
	* app/paint/picmanconvolve.c
	* app/paint/picmandodgeburn.c
	* app/paint/picmanpaintcore.c
	* app/paint/picmansmudge.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmanpainttool.c: use the pixel_region_init_foo()
	functions instead of initializing regions of TempBufs and raw data
	manually. Removed lots of workarounds for the broken offset
	handling. The changed places of code are much more readable now.

2005-09-03  Sven Neumann  <sven@picman.org>

	* app/tools/picmancolorbalancetool.c
	* app/tools/picmanhuesaturationtool.c
	* app/tools/picmantextoptions.c: minor string changes.

2005-09-03  Seth Burgess <sjburges@picman.org>

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancolorizetool.c
	* app/tools/picmanhuesaturationtool.c: change the update policy to
	GTK_UPDATE_CONTINUOUS for considerably better responsiveness

2005-09-03  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.[ch] (picman_edit_paste_as_new): don't create a
	display here.

	(picman_edit_named_cut)
	(picman_edit_named_copy)
	(picman_edit_named_copy_visible): new functions containing named
	buffer wrappers around the functions affecting the global buffer
	only.

	* app/actions/edit-commands.c: use the new functions instead of
	implementing them here, create a display for the image returned
	by paste as new.

	* app/actions/buffers-commands.c
	* app/widgets/picmantoolbox-dnd.c: create displays here too.

	* tools/pdbgen/pdb/edit.pdb: added wrappers for paste as new and
	wrappers for all the cut/copy/paste named stuff.
	Fixes bug #315130. Cleaned up and de-obfuscated.

	* libpicman/picman.def: changed accordingly.

	* app/pdb/edit_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmanedit_pdb.[ch]: regenerated.

2005-09-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainergridview.c
	* app/widgets/picmancontainertreeview.c: allow to popup menus on
	empty container views using the standard Shift-F10 keybinding.

2005-09-02  Sven Neumann  <sven@picman.org>

	* modules/Makefile.am: applied patch that fixes a build issue on
	Cygwin (bug #314893).

2005-09-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmantextoptions.c
	* app/widgets/picmanwidgets-utils.[ch]: dropped the labels from text
	tool options that have icons. Reduces visual clutter.

2005-09-02  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_expose): draw guides over the grid.

2005-09-02  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c (test_clipboard_copy_callback): don't
	quit the main loop after transferring the data to GTK, it needs a
	running main loop to get the chunks transferred to X.

2005-09-02  Sven Neumann  <sven@picman.org>

	* app/dialogs/convert-dialog.c
	* app/dialogs/image-merge-layers-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/dialogs/offset-dialog.c: use verbs instead of "OK" in the
	confirmative dialog button.

2005-09-02  Sven Neumann  <sven@picman.org>

	* AUTHORS
	* app/dialogs/authors.h: regenerated.

2005-09-02  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpwrite.c
	* plug-ins/common/aa.c
	* plug-ins/common/csource.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gif.c
	* plug-ins/common/gih.c
	* plug-ins/common/gtm.c
	* plug-ins/common/mail.c
	* plug-ins/common/mng.c
	* plug-ins/common/pat.c
	* plug-ins/common/png.c
	* plug-ins/common/pnm.c
	* plug-ins/common/postscript.c
	* plug-ins/common/psp.c
	* plug-ins/common/raw.c
	* plug-ins/common/sunras.c
	* plug-ins/common/svg.c
	* plug-ins/common/tga.c
	* plug-ins/common/tiff.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xpm.c
	* plug-ins/fits/fits.c
	* plug-ins/gfli/gfli.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/script-fu/script-fu-server.c
	* plug-ins/sgi/sgi.c
	* plug-ins/winicon/icodialog.c
	* plug-ins/xjt/xjt.c: use verbs instead of "OK" in the
	confirmative dialog button.

2005-09-02  Tor Lillqvist  <tml@novell.com>

	* authors.xml: Mark people as documenter or artist, based on
	ChangeLogs and other information. Remove translator names, they
	are in the respective .po files.

2005-09-02  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image)
	* plug-ins/jpeg/jpeg-save.c (save_image): removed tile cache again,
	it doesn't help for the way the plug-in accesses the pixels.

2005-09-01  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette.[ch]: reverted, it duplicates existing
	functionality.

	* app/core/picmanpalette-import.c
	(picman_palette_import_from_indexed_image): name the colors using
	their index in the colormap.

2005-09-01  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette.[ch]: added picman_palette_new_from_colormap().

2005-09-01  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c
	* libpicman/picmanprocbrowserdialog.c: use ngettext() for plural forms
	(bug #314764).

2005-08-31  Sven Neumann  <sven@picman.org>

	* libpicman/picman.c (picman_run_procedure2, picman_run_procedure):
	improved documentation.

2005-08-31  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c
	(prefs_check_button_add_with_icon): added optional size group
	parameter and add the icon to the group.

	(prefs_dialog_new): align the icons on the tool options and
	toolbox pages.

2005-08-29  Michael Natterer  <mitch@picman.org>

	The previous commit added tons of code just to completely break
	clone align behavior. Reverted lots of the changes and do the
	sample-merged stuff at the innermost place (picman_clone_motion).
	This change also enables changing sample-merged between paint
	strokes.

	* app/paint/picmanclone.[ch] (struct PicmanClone): changed member
	"src_pickable" back to "src_drawable".

	(picman_clone_paint): completely reverted.

	(picman_clone_motion): do the drawable/projection -> pickable
	stuff and drawable offset handling here.

	Fixed signal handling to connect to the drawable's "removed"
	signal (not "disconnect", eek). Disconnect from the signal once
	the drawable has been removed.

	* app/tools/picmanclonetool.c: changed accordingly.

2005-08-29  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gif.c: added toggles which allow to always use
	the frame delay and disposal entered in the dialog, overriding the
	ones specified in the layer names. Fixes bug #314726. Also fixed
	missing and non-working mnemonics.

2005-08-29  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.c: fix canceling the tool.

2005-08-29  Sven Neumann  <sven@picman.org>

	* plug-ins/common/poppler.c: retitled dialog to "Import from PDF"
	and changed the confirmative button label to "Import".

2005-08-28  Michael Natterer  <mitch@picman.org>

	Implement "Sample Merged" for the clone tool. Fixes bug #123627.

	* app/paint/picmanpaintcore.[ch] (struct PicmanPaintCore): added
	members "saved_proj_tiles" which stores the unmodified projection,
	"orig_proj_buf" which stores the unmodified temp paint application
	buf and "use_saved_proj" which controls if all the additional
	stuff should be allocated and managed.

	(picman_paint_core_start): allocate the saved_proj_tiles if needed.

	(picman_paint_core_get_orig_proj): new function like
	picman_paint_core_get_orig_image() which returns unmodified
	projection pixels for paint application.

	(picman_paint_core_validate_saved_proj_tiles): new function like
	picman_paint_core_validate_undo_tiles() which copies the tiles that
	will be dirtied to saved_proj_tiles.

	(picman_paint_core_paste): call above validate_saved_proj_tiles() so
	projection tiles are saved before dirtying them.

	* app/paint/picmanclone.[ch]: replaced member src_drawable by
	src_pickable and use the image's projection if sample_merged it
	TRUE. Adjust src offsets accordingly and use PicmanPaintCore's new
	get_orig_proj() API to get the src pixels.

	* app/paint/picmancloneoptions.[ch]: added boolean "sample_merged"
	property.

	* app/tools/picmanclonetool.c: follow PicmanClone's src_drawable ->
	src_pickable change.

	(picman_clone_tool_button_press): set the paint_core's
	"use_saved_proj" boolean before chaining up.

	(picman_clone_options_gui): add a "Sample Merged" toggle button.

2005-08-28  Manish Singh  <yosh@picman.org>

	* m4macros/pythondev.m4: python headers on Win32 don't live in a
	versioned subdir. Handle that case.

2005-08-27  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_init): initialize renderer->columns
	to != 0 to avoid floating point exceptions on initial layout
	calculation. Fixes bug #314663.

2005-08-27  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/gradmap.c: applied a patch by David Gowers,
	which makes palette-map behave the same as gradient-map.
	Fixes bug #313458.

2005-08-27  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image)
	* plug-ins/jpeg/jpeg-save.c (save_image): set tile cache.

2005-08-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/svg.c: deal with SVG API change. This is a
	compile-time check and thus somewhat ugly because it requires a
	recompile of the plug-in when updating librsvg. Fixes bug #314400.

2005-08-26  Michael Natterer  <mitch@picman.org>

	* app/dialogs/about-dialog.c (about_dialog_add_logo): move the
	logo to the top of the dialog.

2005-08-26  Tor Lillqvist  <tml@novell.com>

	* app/plug-in/plug-in.c (plug_in_prep_for_exec, plug_in_open):
	Instead of passing a child_setup function whose body is ifdeffed
	out on Win32 to g_spawn_async(), pass NULL for child_setup on
	Win32. Newer g_spawn_async() implementations on Win32 warn if
	child_setup functions are attempted to be used, as they don't make
	sense because without any fork(), they are called in the parent
	process.

2005-08-26  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/blend-anim.scm: removed newline from
	description.

2005-08-25  Sven Neumann  <sven@picman.org>

	* plug-ins/sel2path/curve.c (new_curve_list)
	* plug-ins/sel2path/fit.c (split_at_corners)
	* plug-ins/winicon/icosave.c (ico_init_data): initialize variables.

2005-08-25  Michael Natterer  <mitch@picman.org>

	* configure.in: define FOO_DISABLE_DEPRECATED for the new stable
	versions of GTK+ and Pango.

	Check for poppler >= 0.4.1, they did another API change.

	* plug-ins/common/poppler.c: and some more #ifdefs to
	poppler_page_render_to_pixbuf().

2005-08-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanview.[ch]: minor code and formatting cleanup.

2005-08-25  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]
	* app/core/picmanscanconvert.c: fixed API docs.

2005-08-25  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.h (picman_canonicalize_identifier): sync
	parameter name with implementation to please gtk-doc.

2005-08-24  Tor Lillqvist  <tml@novell.com>

	Make PICMAN work on Win32 even if installed in a path containing
	random non-ASCII characters.

	* libpicmanbase/picmanenv.c (picman_toplevel_directory): [Win32] Use
	wide-char API on NT-based Windowses. Keep the toplevel directory
	name in UTF-8. The rest of PICMAN assumes it is UTF-8 anyway, and
	for instance passes file names constructed from it to g_open().

	* app/plug-in/plug-in.c (plug_in_open): On Win32, if compiled
	against GLib < 2.8.2, convert the pathname arguments passed to
	g_spawn_async() to locale charset (system codepage). The
	g_spawn*() functions in GLib < 2.8.2 take system codepage
	arguments and not UTF-8.

2005-08-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/paint-funcs/paint-funcs-generic.h (blend_pixels):
	Change blending algorithm to fix misbehavior of smudge
	tool, should fix bug #163721.

2005-08-24  Sven Neumann  <sven@picman.org>

	* app/actions/image-commands.c
	* app/actions/layers-commands.c
	* app/dialogs/image-scale-dialog.c
	* app/dialogs/resize-dialog.[ch]: remember the selected unit for
	scale and resize dialogs on a per-image basis (bug #312950).

2005-08-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/i26-gunya2.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm: reverted the last
	change...

	* plug-ins/common/displace.c: ... and fixed the plug-in instead.
	The number of parameters must not change. Provide a new procedure
	for polar mode instead.

2005-08-24  Tor Lillqvist  <tml@novell.com>

	* plug-ins/script-fu/scripts/i26-gunya2.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm: Add the new last
	parameter to plug-in-displace calls. (See entry for displace.c
	from 2005-02-10 below.)

2005-08-24  Sven Neumann  <sven@picman.org>

	* configure.in: fixed quotes in AC_DEFINE() macros.

2005-08-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/iwarp.c (iwarp_dialog): added a hint on how to
	use this plug-in.

2005-08-23  Sven Neumann  <sven@picman.org>

	* [lots of files]: applied capitalization patches contributed by
	Stephan Binner. Fixes bug #309657.

2005-08-23  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: minor optimizations.

	* app/actions/gradients-actions.c
	* app/actions/patterns-actions.c
	* plug-ins/metadata/interface.c: applied patch from Stephan Binner
	that fixes wrong use of ellipsis (bug #309657).

2005-08-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sample_colorize.c: use GTK_STOCK_APPLY and fixed
	capitalization in button label.

2005-08-23  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/poppler.c: added loading of pages as images.
	Addresses bug #138495.

2005-08-22  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/sample_colorize.c (smp_dialog): applied patch
	from David Gowers that adds mnemonics to all action area
	buttons. Fixes bug #314191.

2005-08-22  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.[ch]: converted comments to gtk-doc
	inline API docs.

2005-08-22  Sven Neumann  <sven@picman.org>

	* tools/test-clipboard.c: added --version command-line option.

2005-08-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanselectionoptions.c (picman_selection_options_gui):
	the "Antialias" toggle got lost, resurrect it.

2005-08-21  Jens Seidel  <jseidel@cvs.gnome.org>

	* app/paint/picmanconvolve.c
	* app/tools/picmaniscissorstool.c
	* app/vectors/picmanvectors-import.c
	* libpicman/picman.c
	* m4macros/picman-2.0.m4
	* m4macros/picmanprint.m4
	* plug-ins/common/wind.c
	* plug-ins/fits/fitsrw.c
	* plug-ins/metadata/xmp-model.c
	* plug-ins/uri/uri-backend-wget.c: Fixed the typo
	"occured" (also in all effected PO files to avoid fuzzyness)

2005-08-21  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpencil.h
	* app/paint/picmanpenciloptions.[ch]
	* app/widgets/widgets-types.h
	* app/widgets/picmantooldialog.h: don't simply typedef object
	instance structs which add no members as their parent instance
	structs. Give them their own instance structs.  Fixes gtk-doc
	confusion.

2005-08-21  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.h: removed HALF_WAY define, it's
	BOUNDARY_HALF_WAY now.

2005-08-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_proc_changed):
	when looking for the file extension, only look at the part after
	the last directory separator.

2005-08-20  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.[ch]: even more cleanup, replaced informal
	comments by API docs.

2005-08-20  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.[ch]: renamed puclic functions, defines and
	enums to live in a proper "boundary" namespace. Cleaned up and
	simplified internal code even more.

	* app/core/picmanchannel.c
	* app/core/picmandrawable-stroke.c
	* app/core/picmanlayer-floating-sel.c
	* app/paint/picmanpaintcore-stroke.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanpainttool.c: changed accordingly.

2005-08-20  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.c: rename local "ns" variables to "num_segs"
	now that the global "num_segs" is gone.

2005-08-20  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.c: moved the entire internal state of boundary
	creation and sorting from <eek>global variables</eek> to a new
	"Boundary" struct that needs to be newly allocated for each
	boundary. Yes this allocates and frees memory more often than
	before but the old code was simply one big eek.

2005-08-20  Michael Natterer  <mitch@picman.org>

	* app/base/boundary.c (sort_boundary): look at the passed "ns"
	variable instead of at the global "num_segs" one to figure if the
	passed array of BoundSegs is empty. Fixes bug #313922 at its root.

2005-08-19  Akkana Peck  <akkana@cvs.gnome.org>

	* app/tools/picmandrawtool.c: Fix the parameter check at the
	beginning of picman_draw_tool_draw_boundary, to fix the crash
	described in bug 313922.

2005-08-20  Sven Neumann  <sven@picman.org>

	* authors.xml: exemplarily added artist and documenter roles to
	some contributors.

	* app/dialogs/authors.xsl: generate arrays for the new roles.

	* app/dialogs/authors.h: regenerated.

	* app/dialogs/about-dialog.c: pass the new arrays to the
	GtkAboutDialog constructor.

2005-08-20  Sven Neumann  <sven@picman.org>

	* authors.dtd
	* authors.xml: simplified by making dc: the default namespace.

	* authors.xsl
	* app/dialogs/authors.xsl: match the toplevel element in the dc:
	namespace.

2005-08-19  Sven Neumann  <sven@picman.org>

	* authors.dtd
	* authors.xml: use elements and attributes from Dublin Core.

	* authors.xsl
	* app/dialogs/authors.xsl: changed accordingly.

	* app/dialogs/authors.h: regenerated.

	* app/dialogs/about-dialog.c: Peter and Spencer are now part of
	the list of authors (but listed before everyone else).

2005-08-19  Sven Neumann  <sven@picman.org>

	* app/dialogs/about-dialog.c: set the role and window position.

2005-08-19  Michael Natterer  <mitch@picman.org>

	* app/config/picmanguiconfig.c (DEFAULT_WEB_BROWSER): changed to
	"mozilla-firefox %s" (was "mozilla %s").

2005-08-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c
	* plug-ins/common/plugin-browser.c
	* plug-ins/helpbrowser/dialog.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/jpeg/jpeg-load.c: use canonical procedure names with
	picman_run_procedure().

2005-08-19  Sven Neumann  <sven@picman.org>

	* app/dialogs/authors.xsl: generate a NULL terminated array.

	* app/dialogs/authors.h: regenerated.

	* app/dialogs/about-dialog.[ch]: embedded the about box into a
	GtkAboutDialog.

	* app/dialogs/dialogs-constructors.c: pass a PicmanContext to
	about_dialog_create().

2005-08-19  Nathan Summers  <rock@picman.org>

	* plugins/common/poppler.c: removed some extraneous commas.

2005-08-19  Michael Natterer  <mitch@picman.org>

	Poppler 0.4 changes the API of poppler_page_render_to_pixbuf():

	* configure.in: define HAVE_POPPLER_0_4 if it is available.

	* plug-ins/common/poppler.c: added some #ifdefs to compile with
	both the new and old version. Can be removed in some weeks
	propably.

2005-08-18  Michael Natterer  <mitch@picman.org>

	* cursors/Makefile.am
	* cursors/picman-tool-cursors.xcf
	* cursors/modifier-join.png
	* cursors/xbm/modifier-join-mask.xbm
	* cursors/xbm/modifier-join.xbm: images for a "join" cursor modifier.

	* app/widgets/widgets-enums.h
	* app/widgets/picmancursor.c: add the cursor.

	* app/tools/picmanvectortool.c: use it for connecting strokes.
	Fixes bug #313252.

2005-08-18  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: removed reference to SIOX
	algorithm from tooltip, it's an implementation detail.

2005-08-18  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: updated year in copyright.

	* libpicmanwidgets/picmanwidgets-private.c (picman_widgets_init):
	register the default window icons in descending sizes.

2005-08-18  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c: go back to using dpi as the default
	resolution unit.

	* app/core/picman-utils.[ch]: moved the code to determine the unit
	from the locale settings here as picman_get_default_unit().

	* app/dialogs/print-size-dialog.c
	* app/widgets/picmanimagepropview.c: use the unit returned by the
	new function to display the print size (bug #107497).

2005-08-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/procedure-browser.c (run): reverted last change.

	* libpicman/picmanprocbrowserdialog.[ch]: emit new signal "row-activated"
	instead of emitting "response" with GTK_RESPONSE_APPLY.

	* plug-ins/pypicman/procbrowser.c
	* plug-ins/script-fu/script-fu-console.c: connect to "row-activated"
	and call gtk_dialog_response() with GTK_RESPONSE_APPLY.

2005-08-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/procedure-browser.c (run): only close the dialog
	on GTK_RESPONSE_CLOSE.

2005-08-18  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/animoptimize.c
	* plug-ins/common/pnm.c
	* plug-ins/metadata/interface.c
	* plug-ins/metadata/metadata.c: some forgotten canonical names.

	* plug-ins/metadata/Makefile.am
	* plug-ins/metadata/metadata.h: new header containing the
	procedure name #defines for metadata.

2005-08-17  Sven Neumann  <sven@picman.org>

	* configure.in: check for langinfo.h and _NL_MEASUREMENT_MEASUREMENT.

	* app/core/picmantemplate.c: try to determine the default unit from
	the locale settings. Supposed to fix bug #107497.

2005-08-17  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (smooth_region): fixed
	initialization of row array.

	* app/base/siox.c: minor cleanups.

2005-08-17  Tor Lillqvist  <tml@novell.com>

	* plug-ins/winsnap/Makefile.am (LDADD): Use $(WINDRES) to handle
	cross-compilation.

	* plug-ins/winsnap/winsnap.rc: Refer to the .ico files in
	lowercase, in case cross-compiling.

2005-08-17  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: applied patch by Kristian Jantz. Reimplements
	find_max_blob() so that it needs less memory. Slows things down a
	bit, but that can be improved later.

2005-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/grid.c: update the progress less frequently.

2005-08-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteview.c (picman_palette_view_focus): when
	focussing the widget, select the palette's first entry if none is
	selected. Enables cursor navigation after tabbing in.

2005-08-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/deinterlace.c: fixed boundary conditions.

2005-08-16  Akkana Peck  <akkana@cvs.gnome.org>

	* plug-ins/script-fu/scripts/grid-system.scm: Rename "Grid" to
	"Divisions" to avoid confusion with the existing grid plug-in;
	move into Render->Pattern along with the other Grid plug-in.

2005-08-17  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteview.c (picman_palette_view_focus): return
	FALSE on TAB_FORWARD and TAB_BACKWARD. Enables tabbing out of the
	widget.

2005-08-17  Michael Natterer  <mitch@picman.org>

	* app/actions/layers-actions.c
	* app/actions/plug-in-actions.c
	* app/actions/image-actions.c: moved all color menu actions to
	image-actions.c because that's the place where we collect menu
	actions of menus that don't have its own foo-actions.c file.
	Renamed them all to "colors-foo-menu".

	* menus/image-menu.xml.in: changed accordingly.

2005-08-16  Akkana Peck  <akkana@cvs.gnome.org>

	* menus/image-menu.xml.in
	* app/actions/image-actions.c
	* app/actions/plug-in-actions.c
	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c
	* plug-ins/common/vinvert.c: Remove erroneous extra *compose
	entries, and move *compose into a Components submenu (re IRC
	discussion); move Value Invert to near Invert (suggested by mitch)

2005-08-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.[ch]: added utility function
	picman_container_view_install_properties() to reduce code duplication
	in classes implementing this interface.

	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontainercombobox.c
	* app/widgets/picmancontainerentry.c: changed accordingly.

2005-08-16  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/uri/Makefile.am: redid the libgnomeui and gnome-vfs
	checks so that pkg-config combines the compiler and linker flags
	instead of concatenating them in the Makefile.

2005-08-15  Akkana Peck  <akkana@cvs.gnome.org>

	* app/actions/image-actions.c
	* app/tools/picmanaligntool.c
	* menus/image-menu.xml.in
	* plug-ins/common/AlienMap2.c
	* plug-ins/common/autostretch_hsv.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/c_astretch.c
	* plug-ins/common/ccanalyze.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/color_enhance.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/compose.c
	* plug-ins/common/decompose.c
	* plug-ins/common/exchange.c
	* plug-ins/common/fp.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/hot.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/normalize.c
	* plug-ins/common/retinex.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/vinvert.c
	* plug-ins/rcm/rcm.c
	* plug-ins/script-fu/scripts/hsv-graph.scm: Move all color-related
	functions from the Image and Filters menus to a new toplevel
	Colors menu (as discussed in bug 116145).

2005-08-16  Sven Neumann  <sven@picman.org>

	* configure.in: define G_DISABLE_DEPRECATED unless glib >= 2.9.0.

	* app/core/picmanscanconvert.c: added missing include.

	* app/text/picman-fonts.c
	* libpicman/picman.c
	* libpicmanwidgets/picmancolornotebook.c
	* plug-ins/helpbrowser/dialog.c: fixed signedness warnings.

	* plug-ins/bmp/bmpread.c (ReadBMP): initialize variable.

2005-08-15  Manish Singh  <yosh@picman.org>

	* configure.in: fix reversed libgnomeui conditional test for
	the AC_DEFINE.

2005-08-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/tga.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/tiff.c
	* plug-ins/common/tile.c
	* plug-ins/common/tileit.c
	* plug-ins/common/tiler.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/unsharp.c
	* plug-ins/common/video.c
	* plug-ins/common/vinvert.c
	* plug-ins/common/vpropagate.c
	* plug-ins/common/warp.c
	* plug-ins/common/waves.c
	* plug-ins/common/webbrowser.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c
	* plug-ins/common/winprint.c
	* plug-ins/common/wmf.c
	* plug-ins/common/xbm.c
	* plug-ins/common/xpm.c
	* plug-ins/common/xwd.c
	* plug-ins/common/zealouscrop.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-15  Michael Natterer  <mitch@picman.org>

	* configure.in: check for libgnomeui-2.0. Added version
	requirements (>= 2.10.0) for libgnomeui and gnome-vfs.

	* plug-ins/uri/Makefile.am
	* plug-ins/uri/uri-backend-gnomevfs.c: if libgnomeui is available,
	call gnome_authentication_manager_init() so the URI plug-in can
	access sites that require authentication.

	(this needs more hacking so packagers can build both versions of
	the uri plug-in at the same time, since they will want to make the
	libgnomeui dependency optional)

2005-08-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/randomize.c
	* plug-ins/common/raw.c
	* plug-ins/common/retinex.c
	* plug-ins/common/ripple.c
	* plug-ins/common/rotate.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/common/scatter_hsv.c
	* plug-ins/common/screenshot.c
	* plug-ins/common/sel_gauss.c
	* plug-ins/common/semiflatten.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c
	* plug-ins/common/sinus.c
	* plug-ins/common/smooth_palette.c
	* plug-ins/common/snoise.c
	* plug-ins/common/sobel.c
	* plug-ins/common/softglow.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/spread.c
	* plug-ins/common/struc.c
	* plug-ins/common/sunras.c
	* plug-ins/common/svg.c: canonicalize procedure and parameter
	names. Misc cleanups.

2005-08-15  Manish Singh  <yosh@picman.org>

	* plug-ins/common/sample_colorize.c (smp_constrain): add an extra
	user data arg, so we fit the PicmanDrawableConstraintFunc type.

2005-08-15  Karine Delvare  <kdelvare@nerim.net>

	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanrectangleoptions.[ch]: transform into an interface.

	* app/tools/picmancroptool.[ch]
	* app/tools/picmannewrectselecttool.[ch]: use the rectangletool interface.

	* app/tools/picmancropoptions.[ch]
	* app/tools/picmannewrectselectoptions.[ch]: use the rectangleoptions
	interface.

	* app/tools/Makefile.am: added picmannewrectselectionoptions.[ch]

2005-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/rcm/rcm_callback.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/rcm/rcm_misc.[ch]: redraw the previews if their size
	changes. Fixes bug #172284.

2005-08-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/CML_explorer.c
	* plug-ins/common/cartoon.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/colorify.c
	* plug-ins/common/compose.c
	* plug-ins/common/csource.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfli/gfli.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/sgi/sgi.c: fix indentation.

2005-08-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/papertile.c
	* plug-ins/common/pat.c
	* plug-ins/common/pcx.c
	* plug-ins/common/photocopy.c
	* plug-ins/common/pix.c
	* plug-ins/common/pixelize.c
	* plug-ins/common/plasma.c
	* plug-ins/common/plugin-browser.c
	* plug-ins/common/png.c
	* plug-ins/common/polar.c
	* plug-ins/common/procedure-browser.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/poppler.c: make sure the opened image has a
	filename that cannot be saved (ok, we don't have a PDF save
	plug-in, but PS does the same and this way it's consistent).

	* plug-ins/common/poppler.c
	* plug-ins/common/postscript.c: canonicalize procedure and
	parameter names.

2005-08-15  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/postscript.c: applied patch from Felix Riemann
	that adds page counting and a page selector widget to the load
	dialog.  Fixed some minor issues in the patch and added code that
	names layers and images after the document's pages. Disable undo
	on all created images and set them clean before returning them.
	Addresses bug #138495.

2005-08-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: fixed signedness issue.

2005-08-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/jigsaw.c
	* plug-ins/common/laplace.c
	* plug-ins/common/lic.c
	* plug-ins/common/mail.c
	* plug-ins/common/mapcolor.c
	* plug-ins/common/max_rgb.c
	* plug-ins/common/mblur.c
	* plug-ins/common/mng.c
	* plug-ins/common/mosaic.c
	* plug-ins/common/neon.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/nlfilt.c
	* plug-ins/common/noisify.c
	* plug-ins/common/normalize.c
	* plug-ins/common/nova.c
	* plug-ins/common/oilify.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-13  Manish Singh  <yosh@picman.org>

	* app/core/picmanimage-preview.c (picman_image_get_new_preview): if the
	offsets of the layer are such that they are just on the border of
	the image, detect that and bail instead of trying to make a
	sub-preview with a 0 dimension. Fixes bug #312144.

2005-08-14  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/gauss.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c
	* plug-ins/common/gif.c
	* plug-ins/common/gifload.c
	* plug-ins/common/gih.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/glob.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/grid.c
	* plug-ins/common/gtm.c
	* plug-ins/common/guillotine.c
	* plug-ins/common/header.c
	* plug-ins/common/hot.c
	* plug-ins/common/illusion.c
	* plug-ins/common/iwarp.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-13  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/decompose.c
	* plug-ins/common/deinterlace.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/destripe.c
	* plug-ins/common/dicom.c
	* plug-ins/common/diffraction.c
	* plug-ins/common/displace.c
	* plug-ins/common/dog.c
	* plug-ins/common/edge.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/exchange.c
	* plug-ins/common/film.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/fp.c
	* plug-ins/common/fractaltrace.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-13  DindinX  <dindinx@picman.org>

	* plug-ins/common/threshold_alpha.c: added a preview, and some minor
	cleanups.

2005-08-13  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/AlienMap2.c
	* plug-ins/common/CEL.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/aa.c
	* plug-ins/common/align_layers.c
	* plug-ins/common/animationplay.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/autocrop.c
	* plug-ins/common/autostretch_hsv.c
	* plug-ins/common/blinds.c
	* plug-ins/common/blur.c
	* plug-ins/common/borderaverage.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/c_astretch.c
	* plug-ins/common/cartoon.c
	* plug-ins/common/ccanalyze.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/checkerboard.c
	* plug-ins/common/color_enhance.c
	* plug-ins/common/colorify.c
	* plug-ins/common/colortoalpha.c
	* plug-ins/common/compose.c
	* plug-ins/common/compressor.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/csource.c
	* plug-ins/common/cubism.c
	* plug-ins/common/curve_bend.c: canonicalize procedure and
	parameter names. Misc cleanups.

2005-08-13  DindinX  <dindinx@picman.org>

	* plug-ins/common/checkerboard.c: added a preview, and some minor
	cleanups.

2005-08-12  DindinX  <dindinx@picman.org>

	* plug-ins/common/sample_colorize.c: shut up a Gtk-Critical Warning
	that happened after reopening the filter, but only when a gradient had
	been selected on the previous invocation.

2005-08-12  DindinX  <dindinx@picman.org>

	* plug-ins/common/sample_colorize.c: preliminary clean-ups.

2005-08-12  Michael Natterer  <mitch@picman.org>

	* plug-ins/bmp/bmp.c
	* plug-ins/faxg3/faxg3.c
	* plug-ins/fits/fits.c
	* plug-ins/flame/flame.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig.[ch]
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/help/help.c
	* plug-ins/helpbrowser/helpbrowser.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg.[ch]
	* plug-ins/maze/maze.[ch]
	* plug-ins/maze/maze_face.c
	* plug-ins/pagecurl/pagecurl.c
	* plug-ins/rcm/rcm.[ch]
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/sel2path/sel2path.c
	* plug-ins/sgi/sgi.c
	* plug-ins/uri/uri.c
	* plug-ins/xjt/xjt.c: canonicalize procedure and parameter names.
	#define them instead of repeating the same string several times.
	Minor cleanups.

2005-08-12  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc-def.c (plug_in_proc_def_get_help_id):
	removed s/_/-/, proc names are already canonicalized.

2005-08-10  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.4.

2005-08-10  Michael Natterer  <mitch@picman.org>

	* cursors/tool-paths-anchor.png
	* cursors/tool-paths-control.png
	* cursors/tool-paths-segment.png
	* cursors/tool-paths.png
	* cursors/xbm/tool-paths-control-mask.xbm
	* cursors/xbm/tool-paths-control.xbm: applied Jimmac's changes.

2005-08-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/xbm.c (mask_ext_entry_callback): fixed
	copy'n'paste bug that was clearing the identifier prefix when
	editing the mask extension.

2005-08-10  Jakub Steiner <jimmac@ximian.com>

	* cursors/picman-tool-cursors.xcf: touched up RGBA versions; add
	  color; for controls, change circles to squares.

2005-08-10  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: small fixes to the cursors - now
	the handles have their respective cursor as well.

2005-08-10  Sven Neumann  <sven@picman.org>

	* Made 2.3.3, the "What The Hack" release.

	* data/images/picman-splash.png: What The Splash, photo by antenne.

2005-08-10  Michael Natterer  <mitch@picman.org>

	* app/dialogs/preferences-dialog.c (prefs_dialog_new): don't have
	widgets from different pages in the same size group. Fixes spacing
	on the "Display" page.

2005-08-10  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: fixed dist-dump-picmanrc rule.

2005-08-09  Michael Natterer  <mitch@picman.org>

	* app/paint-funcs/paint-funcs.[ch] (extract_from_inten_pixels)
	(extract_from_indexed_pixels): pass src_bytes and dest_bytes to
	these functions instead of just the source's bytes and whether it
	has an alpha. Honor dest_bytes when extracting instead of crashing
	by always asuming that the destination has alpha.
	Fixes bug #312392.

	(extract_from_region): removed has_alpha parameter. pass
	src->bytes and dest->bytes to above functions.

	* app/core/picmanselection.c (picman_selection_extract): changed
	accordingly.

2005-08-09  Michael Natterer  <mitch@picman.org>

	* cursors/picman-tool-cursors.xcf: changed path tool cursor to
	actually show a path and added 3 new cursors which are supposed
	to show a path's anchor, handle and segments. Someone really
	needs to beautify these...

	* cursors/tool-paths.png
	* cursors/xbm/tool-paths-mask.xbm
	* cursors/xbm/tool-paths.xbm: changed accordingly.

	* cursors/Makefile.am
	* cursors/tool-paths-anchor.png
	* cursors/tool-paths-control.png
	* cursors/tool-paths-segment.png
	* cursors/xbm/tool-paths-anchor-mask.xbm
	* cursors/xbm/tool-paths-anchor.xbm
	* cursors/xbm/tool-paths-control-mask.xbm
	* cursors/xbm/tool-paths-control.xbm
	* cursors/xbm/tool-paths-segment-mask.xbm
	* cursors/xbm/tool-paths-segment.xbm: new files.

	* app/widgets/widgets-enums.h (enum PicmanToolCursorType): added
	PATH_ANCHOR, PATH_CONTROL and PATH_SEGMENTS.

	* app/widgets/picmancursor.c: added the new cursors.

	* app/tools/picmanvectortool.c (picman_vector_tool_cursor_update):
	use them. Fixes bug #124972.

2005-08-09  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/xbm.c: make sure the mask file has valid C
	identifiers, too.

2005-08-09  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]
	* app/core/picmandrawable-foreground-extract.[ch]
	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: renamed Granularity to
	Color Sensitivity, both in the GUI and in the APIs.

2005-08-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/dicom.c: use an empty string instead of "?" for
	the unknown value (bug #313008).

2005-08-09  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.c: reduced default brush
	size a little.

	* app/config/picmanxmlparser.c: fixed signedness warnings.

	* plug-ins/imagemap/imap_browse.c (handle_drop): UTF-8 validate
	the dropped text before setting it on the entry.

2005-08-08  Manish Singh  <yosh@picman.org>

	* plug-ins/common/psd.c: Generate valid names for aux channels that
	do not have names defined. Fixes bug #312963.

2005-08-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c (picman_layer_transform_color): take image
	type instead of basetype of the source drawable. Handle conversion
	from drawables without alpha channel.
	(picman_layer_new_from_region): handle source regions without alpha.

2005-08-08  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/tools/stock-tool-foreground-select-16.png
	* themes/Default/images/tools/stock-tool-foreground-select-22.png:
	  icon for the new tool. Hopefully gets the message across.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (find_max_blob): optimized further.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: added another call to picman_progress_update().

	* app/core/picman.c (picman_init): fixed harmless cut-n-paste error.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.[ch]: added the possibility to specify
	a clip rectangle.

	* app/base/siox.c (find_max_blob): use g_try_malloc().

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (find_max_blob): optimizations.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (find_max_blob): fixed for offsetted regions.
	Do thresholding as part of find_max_blob().

2005-08-08  Michael Natterer  <mitch@picman.org>

	* cursors/picman-tool-cursors.xcf: resized all layers to image size.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (find_max_blob): check boundary conditions
	before pushing a pixel to the queue.

2005-08-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.c: made hitting Escape in the name
	entry restore the data's original name. Enables undoing of
	accidential editing. Addresses bug #169257.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-draw.c (picman_display_shell_get_pen_gc)
	* app/tools/picmanforegroundselecttool.c: use round joins for the
	brush strokes.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: do not attempt foreground
	extraction until the user has specificied a foreground area.

2005-08-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c
	(picman_foreground_select_tool_draw): do not use drawable offsets.
	Disabled the rectangle indicating the working area.

2005-08-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-resize.c (picman_image_resize_with_layers):
	take care of sample points. Addresses bug #137776.

2005-08-07  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: made variables more local to make the code
	easier to read and to optimize.

2005-08-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.[ch] (picman_layer_flatten): new function.

	* app/actions/layers-actions.c
	* app/actions/layers-commands.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/image-menu.xml.in
	* menus/layers-menu.xml: added "Remove Alpha Channel" action,
	action callback, help ID and menu items. Fixes bug #309762.

2005-08-07  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: micro optimizations.

2005-08-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: do not restart draw tool
	unless shell->proximity.

2005-08-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c
	(picman_foreground_select_tool_draw): show the extents of the working
	area if the user moves the mouse out of it. Is this useful?

	* app/tools/picmanforegroundselectoptions.c: removed colons from labels.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.c: increased default brush
	size and upper limit.

	* app/tools/picmanforegroundselecttool.c: draw a brush outline.

2005-08-06  Manish Singh  <yosh@picman.org>

	* plug-ins/Makefile.am: remove dbbrowser from SUBDIRS.

2005-08-06  Manish Singh  <yosh@picman.org>

	* plug-ins/dbbrowser/plugin-browser.c
	* plug-ins/dbbrowser/procedure-browser.c: removed these files...

	* plug-ins/common/plugin-browser.c
	* plug-ins/common/procedure-browser.c: ...and added them here.

	* plug-ins/common/mkgen.pl: transform - to _ in makefile variable
	names, and attach optional CFLAGS to only the plugins that need
	them.

	* plug-ins/common/plugin-defs.pl: added plugin-browser and
	procedure-browser, and changed poppler, svg, and wmf to use the new
	CFLAGS stuff.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am: regenerated.

	* configure.in: remove plug-ins/dbbrowser reference.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]: reordered parameters to match the order of
	parameters in picman_drawable_foreground_extract_siox().

	* app/core/picmandrawable-foreground-extract.c: changed accordingly.

	* app/tools/picmanforegroundselectoptions.[ch]: draw slider value to
	the right.

	* app/tools/picmanfreeselecttool.[ch]: added
	picman_free_select_tool_select() to call the virtual select() method.

	* app/tools/picmanforegroundselecttool.[ch]: queue an idle select if
	the smoothness or granularity values change in the tool options.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]
	* app/core/picmandrawable-foreground-extract.[ch]: expose all
	parameters of the SIOX algorithm. Provide default values.

	* app/tools/picmanforegroundselectoptions.[ch]: added properties and
	user interface for all SIOX parameters.

	* app/tools/picmanforegroundselecttool.c: changed accordingly.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: added a statusbar message
	to encourage the user to draw on the object.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/base/siox.c
	* app/core/picmandrawable-foreground-extract.c: moved rectangle
	intersection into picman_drawable_foreground_extract().

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.[ch]: added picman_scan_convert_compose(),
	an alternative to picman_scan_convert_render() that allows to compose
	strokes on a drawable.

	* app/tools/picmanforegroundselecttool.c: use the new function to
	get rid of temporary channels for applying the strokes. Also fixed
	calculation of stroke width from display scale.

2005-08-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanuimanager.c (picman_ui_manager_ui_popup): applied
	patch from Robert Ögren that frees the event returned by
	gtk_get_current_event(). Fixes bug #312017.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-draw.c (picman_display_shell_draw_pen):
	* app/tools/picmanforegroundselecttool.c: correctly handle a stroke
	consisting of just a single point.

2005-08-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch]
	* libpicmanwidgets/picmanwidgets.def: added picman_prop_hscale_new().

	* app/tools/picmanforegroundselectoptions.c: added a control for the
	stroke width.

	* app/tools/picmanforegroundselecttool.c: cancel the tool if the
	active drawable or the image size changes.

	* app/widgets/picmancontrollerlist.c: fixed signedness warning.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.c (picman_canvas_set_custom_gc) do not
	drop the reference if the same custom GC is being set again.

	* app/display/picmandisplayshell-draw.[ch]
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.[ch]: added GC and methods to draw
	on the canvas with a solid pen.

	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.c: draw using the new pen
	functions. Scale the stroke width with the display scale.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.c:
	* app/paint-funcs/paint-funcs-generic.h
	* app/paint-funcs/paint-funcs.c: fixed signedness warnings.

2005-08-05  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/test-sphere.scm: Added missing argument
	in define statement. Fixed spelling errors.

	* ChangeLog: Corrected my e-mail address.

2005-08-06  Sven Neumann  <sven@picman.org>

	* app/batch.c: canonicalize hardcoded procedure names.

	* app/base/siox.[ch]
	* app/core/picmandrawable-foreground-extract.[ch]
	* app/tools/picmanforegroundselecttool.c: restrict the working area
	to the double of the bounding box of the initial selection.

2005-08-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-message.c (plug_in_handle_proc_install):
	canonicalize proc args registered by plug-ins.

	* plug-ins/script-fu/siod-wrapper.c: removed s/_/-/ for proc args.

2005-08-05  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdbgen.pl: store canonical names of proc names and
	args in the proc structure.

	* tools/pdbgen/app.pl
	* tools/pdbgen/lib.pl: use the above.

	* app/pdb/*_cmds.c: regenerated.

2005-08-05  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c (picman_item_parasite_attach): revert previous
	change. Instead, don't push undos if the item is not attached.

2005-08-05  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf-load.c (xcf_load_image): disable undo while the
	image is being loaded.

	* app/core/picmanitem.c (picman_item_parasite_attach): don't try to
	push an undo step if undo is disabled. Gets rid of warnings while
	loading an XCF file with undoable drawable parasites.

2005-08-04  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-rgb.c: don't wrap deprecated function
	picman_rgb_intensity().

2005-08-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanimagepropview.c: increased spacing between
	property groups to 12 pixels.

2005-08-04  Sven Neumann  <sven@picman.org>

	* app/xcf/xcf.c: canonicalize PDB parameter names.

2005-08-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteview.c: added cursor navigation.

2005-08-03  Sven Neumann  <sven@picman.org>

	* app/vectors/picmanvectors-compat.[ch]
	* app/xcf/xcf-load.c
	* app/xcf/xcf-save.c: fixed signedness warnings.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.h: typo: FOEEGROUND -> FOREGROUND.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_new):
	canonicalize hardcoded procedure names.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* app/dialogs/module-dialog.c
	* app/dialogs/palette-import-dialog.c
	* app/gui/gui.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanvectortool.c
	* app/widgets/picmanaction.c
	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmancursorview.c
	* app/widgets/picmandnd.c
	* app/widgets/picmandock.c
	* app/widgets/picmandockbook.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanenumaction.c
	* app/widgets/picmanerrordialog.c
	* app/widgets/picmanfileprocview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanmenudock.c
	* app/widgets/picmanmessagebox.c
	* app/widgets/picmanmessagedialog.c
	* app/widgets/picmanpluginaction.c
	* app/widgets/picmanprogressdialog.c
	* app/widgets/picmansamplepointeditor.c
	* app/widgets/picmanstringaction.c
	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmantoolbox-image-area.c
	* app/widgets/picmantoolbox.c: use canonical names for signals and
	properties.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* plug-ins/help/Makefile.am: link against libpicmancolor. WhyTheHack
	did this work before?

2005-08-03  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]: added PICMAN_UNDO_FOREGROUND_SELECT.

	* app/tools/Makefile.am
	* app/tools/picmanforegroundselecttool-undo.[ch]: added stubs for
	undo in the new foreground selection tool.

	* tools/pdbgen/pdb/procedural_db.pdb: include picmanbase.h for
	picman_canonicalize_identifier().

	* app/pdb/procedural_db_cmds.c: regenerated.

	* app/file/file-utils.c: fixed signedness warning.

2005-08-03  Sven Neumann  <sven@picman.org>

	* libpicmanmath/picmanmd5.c
	* libpicmanmath/test-md5.c
	* plug-ins/common/CEL.c
	* plug-ins/common/cartoon.c
	* plug-ins/common/emboss.c
	* plug-ins/common/exchange.c
	* plug-ins/common/gifload.c
	* plug-ins/common/poppler.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg-save.h
	* plug-ins/metadata/interface.c
	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/xmp-model.c
	* plug-ins/script-fu/siod/sliba.c: fixed signedness warnings.

2005-08-03  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb.[ch]: deprecated RGB intensity functions
	and definitions. These coefficients do not accurately compute
	luminance for contemporary monitors. Instead the coefficients from
	the sRGB spec should be used which have now been added.

	* libpicmancolor/picmancolor.def: updated.

	* libpicman/picmandrawable.c
	* libpicman/picmanpixelfetcher.c
	* app/base/colorize.c
	* app/base/levels.c
	* app/base/temp-buf.c
	* app/core/picmandrawable-blend.c
	* app/core/picmandrawable-convert.c
	* app/core/picmandrawable-desaturate.c
	* app/core/picmanimage-convert.c
	* app/core/picmanimage.c
	* app/gui/splash.c
	* app/widgets/picmangradienteditor.c
	* modules/colorsel_triangle.c
	* plug-ins/common/aa.c
	* plug-ins/common/bumpmap.c
	* plug-ins/common/colorify.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/displace.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gradmap.c
	* plug-ins/common/grid.c
	* plug-ins/common/mng.c
	* plug-ins/common/newsprint.c
	* plug-ins/common/png.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/gflare/gflare.c
	* plug-ins/gfli/gfli.c
	* plug-ins/maze/handy.c
	* plug-ins/pagecurl/pagecurl.c: use picman_rgb_luminance() and
	friends instead of the deprecated intensity functions.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanprocbrowserdialog.[ch]: removed all parameters from
	picman_proc_browser_dialog_new() and removed the "scheme_names"
	stuff.

	* plug-ins/dbbrowser/procedure-browser.c
	* plug-ins/pypicman/procbrowser.c
	* plug-ins/script-fu/script-fu-console.c: changed accordingly.

	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h
	* plug-ins/script-fu/siod-wrapper.c: removed all sorts of
	conversions between '-' and '_' for procedure names.

	* plug-ins/script-fu/script-fu.c: use canonical names for
	script-fu's procedures.

2005-08-03  Michael Natterer  <mitch@picman.org>

	* app/actions/vectors-commands.c
	* app/widgets/picmanhelp.c: canonicalized some hardcoded procedure
	names because internal functions accept only canonical names now.

2005-08-03  Michael Natterer  <mitch@picman.org>

	Changed naming scheme for PDB procedure names from
	random_crap_that_traditionally_has_underscores to
	enforced-canonical-identifiers. I'm pretty sure some things are
	broken after this commit. More changes to come...

	* libpicmanbase/picmanbase.def
	* libpicmanbase/picmanutils.[ch]: added picman_canonicalize_identifier().

	* app/pdb/procedural_db.[ch] (struct ProcRecord): added
	"gchar *original_name" to keep a procedure's original name as
	reigstered by plug-ins (compat cruft).

	(procedural_db_init_procs): canonicalized list of deprecated
	procedures.

	* app/plug-in/plug-in-proc-def.c (plug_in_proc_def_free): free
	original_name.

	* app/plug-in/plug-in-message.c: canonicalize procedure names
	which are received over the wire.

	* app/plug-in/plug-in-rc.c: serialize the original_name and create
	the canonicalized name on-the-fly when deserializing.

	* app/plug-in/plug-in-run.c: pass the original_name to plug-ins
	when running them because they strcmp() the passed procedure name.

	* app/plug-in/plug-ins.c (plug_ins_add_to_db): pass
	canonical procedure names to procedural_db_execute().

	(plug_ins_file_proc_compare): special-case "picman-xcf", not "picman_xcf".

	* app/xcf/xcf.c: changed static XCF procedures accordingly.

	* tools/pdbgen/app.pl
	* tools/pdbgen/lib.pl: do some trivial substitutions to generate
	canonicalized names in app/, and C identifiers with underscores in
	libpicman/.

	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/image.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb
	* tools/pdbgen/pdb/plug_in.pdb
	* tools/pdbgen/pdb/procedural_db.pdb
	* tools/pdbgen/pdb/text_tool.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: canonicaloized procedure
	names in calls to std_pdb_deprecated() and in procedure names in
	generated C code.

	* app/pdb/*_cmds.c
	* libpicman/*_pdb.c: regenerated.

2005-08-03  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmandrawablecombobox.c
	* libpicman/picmanfontselectbutton.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanimagecombobox.c
	* libpicman/picmanpalettemenu.c
	* libpicman/picmanpatternmenu.c: fixed signedness warnings.

2005-08-02  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/procbrowser.c: Quick and dirty restore of browser
	functionality.

2005-08-02  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanuitypes.h: added PicmanProcBrowserDialog typedef here.

	* libpicman/picmanprocbrowserdialog.[ch]
	* libpicman/picmanprocview.[ch]: fixed copyright headers, added
	G_BEGIN_DECLS / G_END_DECLS.

2005-08-02  Michael Natterer  <mitch@picman.org>

	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/dbbrowser/picmanprocbrowser.[ch]
	* plug-ins/dbbrowser/picmanprocview.[ch]: removed these files...

	* libpicman/Makefile.am
	* libpicman/picmanui.h
	* libpicman/picmanui.def
	* libpicman/picmanprocbrowserdialog.[ch]
	* libpicman/picmanprocview.[ch]: ...and added them here. Turned the
	procedure browser into a widget called PicmanProcBrowserDialog and
	changed its API completely. Fixes bug #165009.

	* plug-ins/dbbrowser/plugin-browser.c
	* plug-ins/dbbrowser/procedure-browser.c
	* plug-ins/script-fu/Makefile.am
	* plug-ins/script-fu/script-fu-console.c: changed accordingly.

	* plug-ins/pypicman/Makefile.am
	* plug-ins/pypicman/procbrowser.c: ditto (#if 0'ed stuff so it compiles).

2005-08-02  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselectoptions.[ch]
	* app/tools/picmanforegroundselecttool.[ch]: some code cleanup; moved
	stroke width to the tool options.

2005-07-31  Manish Singh  <yosh@picman.org>

	* app/composite/Makefile.am
	* app/composite/make-installer.py: fix code generation filenames.

2005-07-31  Manish Singh  <yosh@picman.org>

	* acinclude.m4
	* m4macros/Makefile.am
	* m4macros/detectcflags.m4: new macro: PICMAN_DETECT_CFLAGS; used
	to detect which of a set of compiler options a compiler supports.

	* configure.in: use the above for the altivec and -fno-strict-aliasing
	flags. Also, use it to detect the presence of -mmmx and -msse, since
	those are needed to compile even MMX/SSE assembly with gcc 4.0. Define
	MMX/SSE_EXTRA_CFLAGS.

	* app/composite/Makefile.am: compile each of the composite flavors
	into their own library, so we can use automake's per-target CFLAGS.
	Use MMX/SSE/ALTIVEC_EXTRA_CFLAGS in the appropriate places. Build
	libappcomposite.a out of the resulting objects.

	* app/composite/picman-composite-3dnow.c
	* app/composite/picman-composite-altivec.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	* app/composite/picman-composite-sse2.c
	* app/composite/picman-composite-vis.c
	* app/composite/make-installer.py: move the _init functions into
	the installers, so only actually mmx/sse/etc. code gets compiled
	under the appropriate CFLAGS.

	* app/composite/picman-composite-3dnow-installer.c
	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-mmx-installer.c
	* app/composite/picman-composite-sse-installer.c
	* app/composite/picman-composite-sse2-installer.c
	* app/composite/picman-composite-vis-installer.c: regenerated.

	* app/composite/picman-composite.c: remove useless cpu-accel.h include.

2005-07-31  DindinX  <dindinx@picman.org>

	* app/dialogs/preferences-dialog.c: when the notebook page is changed
	with the mouse wheel, update the title and the selection in the
	treeview.

2005-07-31  Sven Neumann  <sven@picman.org>

	* app/tools/Makefile.am
	* app/tools/picmanforegroundselectoptions.[ch]: added options for
	PicmanForegroundSelectionTool.

	* app/tools/picmanforegroundselecttool.c: also allow to classify
	background pixels.

	* app/tools/picmanfreeselecttool.c: implement PicmanTool::control and
	reset the points array if the tool is HALTed.

2005-07-31  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: give some visual feedback
	when the user is drawing. Should use a different GC though.

	* app/tools/picmandrawtool.[ch]: added some const qualifiers.

2005-07-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c (picman_scan_convert_render): pass 255
	as value to picman_scan_convert_render_internal().

	* app/tools/picmanforegroundselecttool.[ch]: add paint strokes as
	classified foreground area; draw function is missing.

2005-07-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.c: fixed some minor coding style issues.

2005-07-31  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]: removed the overlay again.
	This needs to be done differently.

	* app/tools/picmanforegroundselecttool.c: changed accordingly.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]: renamed overlay to mask and
	added a different overlay implementation that will be needed to
	finish the new foreground-select tool.

	* app/tools/picmanforegroundselecttool.c: changed accordingly.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmantoolcontrol.[ch]: transparently handle cursor
	vs. toggle cursor in the cursor accessor functions.

	* app/tools/picmanconvolvetool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanmagnifytool.c
	* app/tools/picmantool.c: simplifies things here.

	* app/tools/picmanforegroundselecttool.c: set a toggle cursor and
	toggle the tool if a mask is set.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: implement cursor_update().
	Suppress standard selection tool functionality if a mask exists.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmanforegroundselecttool.c: implement oper_update() and
	and give some hints in the statusbar.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c
	* app/display/picmandisplayshell.[ch]: added
	picman_display_shell_set_overlay(); allows to overlay a mask over the
	display to visualize a selection.

	* app/tools/picmanforegroundselecttool.[ch]: use the new functionality
	to display the selection. Escape cancels the tool, Enter applies the
	selection.

2005-07-30  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbase.def: added missing symbol.

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c (picman_histogram_calculate_sub_region):
	loop unrolling.

	* app/dialogs/about-dialog.c
	* app/widgets/picmanselectiondata.c
	* plug-ins/bmp/bmpread.c (ReadBMP)
	* plug-ins/gfig/gfig.c (gfig_load)
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_selection.c
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/common/dicom.c
	* plug/ins/common/screenshot.c: fixed signedness warnings.

2005-07-30  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/image-structure.scm: removed this
	script (see bug #307016).

2005-07-30  Sven Neumann  <sven@picman.org>

	* app/base/tile-swap.c: increase the size of the swap file in
	chunks of 16MB instead of only 256KB. Check the return value of
	ftruncate().

2005-07-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpageselector.c: increased spacing.

2005-07-29  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added "tools-foreground-select" to the
	Selection Tools menu.

	* app/tools/picmanforegroundselecttool.c: resolved clashing mnemonic.

2005-07-29  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-foreground-select-16.png
	* themes/Default/images/tools/stock-tool-foreground-select-22.png:
	added placeholder for yet-to-be-drawn tool icon.

	* libpicmanwidgets/picmanstock.[ch]: register it.

	* app/tools/picmanforegroundselecttool.c: use it.

	* app/widgets/picmanclipboard.[ch] (picman_clipboard_get_svg): return
	a signed char pointer.

	* app/actions/edit-commands.c
	* app/tools/picmaninkoptions-gui.c: fixed signedness issues.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]
	* app/core/picmandrawable-foreground-extract.c: pass progress_callback
	and progress_data to siox_foreground_extract().

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (add_to_list): keep a tail pointer. Speeds up
	the benchmark by about 50%.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-foreground-extract.[ch]: added a progress
	parameter.

	* app/tools/picmanforegroundselecttool.[ch]: changed the "select"
	method to take a PicmanDisplay instead of a PicmanImage.

	* tools/pdbgen/pdb/drawable.pdb
	* app/tools/picmanforegroundselecttool.c: changed accordingly.

	* app/pdb/drawable_cmds.c: regenerated.

2005-07-29  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c: fixed signedness warnings.

2005-07-29  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: added PicmanForegroundExtractMode
	in preparation for other implementations to be added in the future.

	* libpicman/picmanenums.c.tail
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmandrawable-foreground-extract.[ch]
	* app/tools/picmanforegroundselecttool.c
	* tools/pdbgen/pdb/drawable.pdb: added the mode parameter.

	* app/pdb/drawable_cmds.c
	* libpicman/picmandrawable_pdb.[ch]: regenerated.

2005-07-29  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-utils.c (picman_config_string_append_escaped):
	added casts to silent signedness warnings.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmanselectionoptions.c (picman_selection_options_gui): no
	antialiasing for the foreground selection tool (yet).

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanscanconvert.[ch]: added
	picman_scan_convert_render_value(), a variant of
	picman_scan_convert_render() that allows to pass the foreground value.

	* app/tools/picmanfreeselecttool.[ch]: added a virtual "select" method.

	* app/tools/Makefile.am
	* app/tools/picman-tools.c
	* app/tools/picmanforegroundselecttool.[ch]: added a rough first
	version of foreground selection tool based on the SIOX algorithm.
	Work in progress...

	* app/widgets/picmanhelp-ids.h: added help-id for the new tool.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/tools/picmanfreeselecttool.c: minor cleanup.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/base/siox.c (siox_foreground_extract): minor cleanup.

2005-07-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanundostack.[ch]: added picman_undo_stack_get_depth().

	* app/widgets/picmanimagepropview.[ch]: display number and memory
	usage of undo/redo steps.

	* app/core/picmanimage-merge.c: fixed signedness issue.

2005-07-28  Sven Neumann  <sven@picman.org>

	* app/base/siox.[ch]: accept an offset between pixels and mask,
	work only on the intersection rectangle.

	* app/core/picmandrawable-foreground-extract.c: pass the drawable
	offsets to siox_foreground_extract().

2005-07-28  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: allow to enable some debug output.

2005-07-27  Manish Singh  <yosh@picman.org>

	* app/core/picmandrawable-foreground-extract.c: #include
	picmanimage-colormap.h

2005-07-28  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/cpercep.[ch]: moved cpercep from here ...

	* app/base/Makefile.am
	* app/base/cpercep.[ch]: ... to here.

	* app/base/siox.[ch]: use the cpercep routines for RGB->LAB
	conversion, gives a 20% speedup. Removed normalization which seems
	redundant. Make it work for grayscale and indexed, not only RGB.

	* app/core/picmandrawable-foreground-extract.c
	* app/core/picmanimage-convert.c: changed accordingly.

2005-07-26  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: change the cursor with the tool
	(bug #90519).

2005-07-26  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: fixed signedness warnings.

2005-07-25  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_csim.y: make buffer large enough to hold
	all polygon data.

	* plug-ins/imagemap/imap_csim_parse.[ch]: regenerated. Fixes #169698

2005-07-25  Michael Natterer  <mitch@picman.org>

	Some DND fixes / cleanup:

	* app/widgets/widgets-enums.h: renamed PICMAN_DND_TYPE_TOOL to
	PICMAN_DND_TYPE_TOOL_INFO.

	* app/widgets/picmanselectiondata.[ch]: s/tool/tool_info/g. Moved
	private functions to the end of the file. Include PICMAN's PID in
	all GtkSelectionData strings which are used to pass around stuff
	by reference. For things which are referenced by name, also encode
	the object's address in the GtkSelectionData so having a brush
	called "Standard" or a named buffer called "Global Buffer" will
	work together with DND.

	* app/widgets/picmandnd.[ch]: s/tool/tool_info/g. Renamed
	picman_dnd_get_data_data() to picman_dnd_get_object_data() since it's
	not limited to PicmanData objects. Follow above selection data API
	changes. Cleanup.

	* libpicman/picmanbrushmenu.c
	* libpicman/picmandrawablecombobox.c
	* libpicman/picmanfontselectbutton.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanimagecombobox.c
	* libpicman/picmanpalettemenu.c
	* libpicman/picmanpatternmenu.c: follow GtkSelectionData format change
	and check the dropped things' PID against the return value of
	picman_getpid().

2005-07-25  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/misc.pdb: on Win32, include <process.h> for
	getpid().

	* app/pdb/misc_cmds.c: regenerated.

2005-07-25  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/misc.pdb: added picman_getpid().

	* libpicman/picman.def: changed accordingly.

	* app/pdb/internal_procs.c
	* app/pdb/misc_cmds.c
	* libpicman/picmanmisc_pdb.[ch]: regenerated.

2005-07-25  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmandialog.c (picman_dialog_add_buttons_valist):
	don't call gtk_widget_hide() on a NULL help button.

2005-07-24  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanpatternmenu.c: put the previews into sunken instead
	of etched-in frames.

2005-07-24  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpattern.c: untabify, minor cleanup.

2005-07-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanselectiondata.c
	(picman_selection_data_get_buffer): special case the global buffer
	so it can be dropped, not only dragged around.

2005-07-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.c: added a label showing the
	number of selected pages. Allow to enter ranges like "5-" or "-7"
	(treat them as if the user had entered "5-n_pages" or "1-7").
	Minor UI spacing and code cleanup.

2005-07-22  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmanwidgets/picmanwidgets.def: added missing
	picman_page_selector_[get|set]_target

2005-07-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.c (picman_palette_editor_init):
	allow to drop palettes onto the palette view again.

2005-07-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpaletteeditor.c (picman_palette_editor_zoom):
	fixed the PICMAN_ZOOM_TO case for palettes with a number of colors
	that is not a multiple of the number of columns.

2005-07-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): reverted my last change here
	and replaced it with a better fix.

2005-07-22  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteview.c: setup the dnd stuff in
	PicmanView::set_viewable() and remove PicmanView's automatically added
	PicmanPalette drag source. Fixes color dragging (bug #113237).

2005-07-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreview.[ch]: added picman_preview_get_area()
	for the rare case when one needs access to the PicmanPreviewArea
	used in the preview.

	* libpicmanwidgets/picmanwidgets.def: updated.

2005-07-21  Pawan Chitrakar  <pawan@nplinux.org>

	* configure.in: Added ne in ALL_LINGUAS

2005-07-20  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/poppler.c (run): don't return an execution error
	if the user cancelled the dialog.

2005-07-20  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c: fixed typo (Debian bug #310018).

2005-07-20  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig-grid.c: declare variables at the start of the
	scope. Apply PICMAN coding style to the new polar grid code.

2005-07-19  Sven Neumann  <sven@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_key_press): return
	FALSE if the keypress event isn't handled because the display
	doesn't match.

2005-07-19  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c (mng_save_image): fixed signedness warnings.

2005-07-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanrender.[ch]: new files keeping the render
	acceleration check buffers.

	* app/display/picmandisplayshell-render.[ch]: removed them here.

	* app/gui/gui.c: initialize/shutdown the new buffers.

	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmanviewrenderer.c
	* app/widgets/picmanviewrenderergradient.c
	* app/actions/view-actions.c
	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell.c: use the new stuff. Removes
	lots of broken widgets -> display dependencies.

2005-07-19  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolormapeditor.[ch]: renamed member "palette"
	to "preview", cleanup.

2005-07-19  Sven Neumann  <sven@picman.org>

	* app/actions/edit-actions.c
	* etc/ps-menurc: changed the default keybinding for Edit->Clear
	from Ctrl-K to Delete (bug #118115).

2005-07-19  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_menu.c: removed unused include.

2005-07-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.c: try a different style for the
	info labels below the histogram; mainly to avoid repositioning.

2005-07-18  DindinX  <dindinx@picman.org>

	* plug-ins/common/gauss.c: don't try to free unallocated space
	(happened when vert or horz were 0.0)

2005-07-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/poppler.c: marked strings for translation.

2005-07-18  Sven Neumann  <sven@picman.org>

	* app/tools/picmaneditselectiontool.c (picman_edit_selection_tool_start):
	need to sort the boundary here since picman_draw_tool_draw_boundary()
	expects a sorted boundary now. Fixes bug #310432.

	* app/tools/picmanpainttool.c: formatting.

2005-07-18  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanresolutionentry.c: tweaked spacing and
	alignments to make it look more like our other widgets.

	* plug-ins/common/poppler.c: put the resolution entry into a hbox
	so that it doesn't expand horizontally; removed unused table.

2005-07-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/nlfilt.c
	* plug-ins/common/pat.c
	* plug-ins/common/svg.c
	* plug-ins/common/tiff.c
	* plug-ins/common/tile.c
	* plug-ins/common/uniteditor.c
	* plug-ins/common/wmf.c: fixed signedness warnings.

2005-07-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd-xds.c: added missing casts.

2005-07-17  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-drawable.c: revert to old behavior of
	parasite_find functions returning None when there isn't a parasite
	found. Fixed bug #310666.

2005-07-17  Nathan Summers  <rock@picman.org>

	* libpicmanwidgets/picmanresolutionentry.[ch]: spiffy new widget that given
	a physical size, displays that size in an arbitrary unit, and lets
	you select a resolution via changing either the corresponding width
	and height or specifying it directly in pixels per your chosen unit.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h: added appropriate files, function,
	headers, and types, respectively

	* devel-docs/libpicmanwidgets/libpicmanwidgets.types: added
	picman_resolution_entry_get_type.  A section still needs to be created
	for it.

	* plug-ins/common/poppler.c (run): bugfix that accidentally wasn't
	merged in previous commit.

	* plug-ins/common/poppler.c (load_dialog): replaced resolution
	spinbutton with a PicmanResolutionEntry.

2005-07-16  Sven Neumann  <sven@picman.org>

	* app/base/siox.c: added comments about possible improvements.

2005-07-16  Nathan Summers  <rock@picman.org>

	* plug-ins/common/poppler.c: merged in all the changes in my
	current picman-poppler tree that don't need c++ or cause regressions.
	Insignificant code cleanups.

	* plug-ins/common/poppler.c (load_dialog): display title of pdf
	at the top of the dialog, and show the page labels in the page
	selector.  The loop for the page labels might be profitably moved
	into another thread, but I haven't actually timed how long it takes
	to be sure.

2005-07-16  Nathan Summers  <rock@picman.org>

	* plug-ins/common/plugin-defs.pl: added poppler

	* plug-ins/common/mkgen.pl: add poppler's CFLAGS, and make the
	comment about how plug-ins/common/Makefile.am is autogenerated
	more prominent

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am: regenerated

2005-07-16  Nathan Summers  <rock@picman.org>

	* plug-ins/common/poppler.c: initial import into CVS.  There was much
	rejoicing.

	* configure.in: check for gthread-2.0 in the poppler check, because
	it is not necessarily checked for elsewhere.  Once other threaded
	plugins become available, this probably should be moved.

	Also removed the HAVE_POPPLER am conditional; it wasn't needed.

	* plug-ins/common/Makefile.am: added poppler to the build process

2005-07-16  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.[ch]: also show the number of pixels.

2005-07-15  Carol Spears  <carol@picman.org>

	* docs/Wilber_Construction_Kit.xcf.gz: corrected the spelling of
	the word tassel.

2005-07-15  Carol Spears  <carol@picman.org>

	* docs/Wilber_Construction_Kit.xcf.gz:  added a tassle and a fez.

2005-07-15  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.c (erode_region) (dilate_region):
	fixed implementations.

	* app/base/siox.c (create_signature): moved comment to the right place.

2005-07-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): don't crash on empty palettes.

2005-07-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanhistogramview.c
	* app/widgets/picmannavigationview.c: cleanup.

2005-07-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteview.[ch]: added "entry-clicked" and
	"color-dropped" signals. Completely handle color DND. Cleanup.

	* app/core/picmanmarshal.list: marshallers for above signals.

	* app/widgets/picmanpaletteeditor.[ch]: chopped and reassembled.
	Remove tons of code and use a PicmanPaletteView instead of the
	deprecated GtkPreview. Addresses bug #102204.

2005-07-14  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: added erode_region() and
	dilate_region(). Less general than thin_region() and fatten_region()
	but a little faster.

	* app/base/siox.c: use the new functions.

2005-07-14  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanpaletteview.[ch]: new widget which manages the
	selected palette entry itself and emits "selected", "activated"
	and "context" signals. Not used yet.

	* app/widgets/picmanviewrendererpalette.[ch]: reimplemented palette
	drawing: added optional grid drawing and APIs to configure the
	renderer. Should be ready for the palette editor now.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanviewrendererpalette.c
	(picman_view_renderer_palette_render): implement it the same way as
	picman_palette_get_preview(). Can't be used for the palette editor
	yet.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanviewrendererpalette.[ch]: new view renderer,
	does nothing yet except chaining up in ::render().

	* app/widgets/picmanviewrenderer-utils.c
	(picman_view_renderer_type_by_viewable_type): use it for palettes.

2005-07-13  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-grid.c
	* plug-ins/gfig/gfig.h: applied a patch by Ted Shaneyfelt that
	addresses parts of bug 151092: less sectors on inner, more sectors
	on outer tracks.

2005-07-13  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/segmentator.[ch]: renamed to siox.[ch].

	* app/base/siox.[ch]: added API docs and a link to the algorithm's
	new homepage. Removed unused code.

	* app/core/picmandrawable-foreground-extract.c: changed accordingly.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette.c (picman_palette_add_entry): actually return
	the added entry, and not always the palette's last entry (argh!).

	* app/widgets/picmanpaletteeditor.c: make sure the cursor is always
	on the newly added color. Really fixes #15060 this time.

2005-07-13  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: added smooth_region(), a
	simple convolution filter to smooth a mask.

	* app/base/segmentator.c (smooth_mask): use the new function.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: added new public function
	picman_dockable_blink_cancel() which stops title blinking.

	* app/tools/picmancolorpickertool.c (picman_color_picker_tool_picked):
	cancel blinking when updating a picked color so the dockable
	doesn't flicker for each cursor movement.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanpaletteeditor.c (picman_palette_editor_pick_color):
	add colors after the cursor. Fixes bug #150608.

2005-07-13  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.c (procedural_db_init_procs): sorted list
	of deprecated procedures so deprecations since 2.0 and 2.2 are
	grouped together.

2005-07-12  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c: formatting.

2005-07-12  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c: pass opacity and paint_mode to
	picman_edit_fill_internal() instead of figuring them in the
	function.

2005-07-12  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.[ch]: removed "context" parameter from
	PicmanItem::stroke(), it's not needed any longer.

	* app/core/picmanchannel.c
	* app/core/picmanselection.c
	* app/vectors/picmanvectors.c: changed accordingly.

2005-07-12  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanpaintoptions-gui.c (picman_paint_options_gui):
	swapped the opacity scale and the paint mode menu to be consistent
	with the layers dialog. Also makes the paint options look more
	balanced.

2005-07-11  Sven Neumann  <sven@picman.org>

	* app/base/segmentator.c: for now, implement smooth_mask() by
	means of gaussian_blur_region().

2005-07-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c: minor fixes to the API docs.

2005-07-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpickable.[ch]: added PicmanPickable::get_opacity_at()

	* app/core/picmanchannel.[ch]: removed picman_channel_value() and
	implement ::get_opacity_at() instead.

	* app/core/picmanlayer.[ch]: removed picman_layer_pick_correlate()
	and implement ::get_opacity_at() instead.

	* app/core/picmanselection.c: PicmanChannel::value() doesn't exist
	any more.

	* app/core/picmanprojection.c: implement ::get_opacity_at(), always
	returns OPAQUE.

	* app/core/picmanimage.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanfliptool.c
	* app/tools/picmaniscissorstool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanselectiontool.c
	* app/tools/picmantransformtool.c
	* tools/pdbgen/pdb/selection.pdb: changed accordingly.

	* app/pdb/selection_cmds.c: regenerated.

2005-07-11  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c (picman_clone_tool_cursor_update):
	simplify check for "inside selected region".

2005-07-11  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c: added read-only properties "opacity",
	"mode" and "lock-alpha".

2005-07-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: plugged memory leaks (bug #309967).
	Invalidate the preview when the algorithm is changed; default to
	RLE since it appears to be faster for the cases I tried.

2005-07-10  Carol Spears  <carol@picman.org>

	* docs/Wilber_Construction_Kit.xcf.gz

2005-07-10  Manish Singh  <yosh@picman.org>

	* libpicman/picmanlayer.c (picman_layer_set_preserve_trans): actually
	return a value.

	* plug-ins/pypicman/pypicman-drawable.c: create new lock_alpha attribute,
	and deprecate old preserve_trans attribute.

	* plug-ins/pypicman/plug-ins/shadow_bevel.py: use new lock_alpha API.

2005-07-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanlayertreeview.c (picman_layer_tree_view_init):
	moved the lock alpha toggle to a separate "Lock:" line.

2005-07-10  Michael Natterer  <mitch@picman.org>

	* app/actions/layers-actions.c
	* app/actions/layers-commands.[ch]
	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanlayer-floating-sel.c
	* app/core/picmanlayer.[ch]
	* app/text/picmantextlayer-xcf.c
	* app/widgets/picmanhelp-ids.h
	* app/widgets/picmanlayertreeview.[ch]
	* app/xcf/xcf-load.c
	* app/xcf/xcf-private.h
	* app/xcf/xcf-save.c
	* tools/pdbgen/pdb/layer.pdb
	* menus/image-menu.xml.in
	* libpicman/picman.def: did a global s/preserve_trans/lock_alpha/ in
	preparation for more layer locking flags.

	* app/pdb/procedural_db.c
	* libpicman/picmanlayer.[ch]: added compat stuff for preserve_trans.

	* app/pdb/layer_cmds.c
	* libpicman/picmanlayer_pdb.[ch]: regenerated.

	* plug-ins/common/colortoalpha.c
	* plug-ins/common/iwarp.c
	* plug-ins/common/psd.c
	* plug-ins/common/psd_save.c
	* plug-ins/common/psp.c
	* plug-ins/common/rotate.c
	* plug-ins/common/threshold_alpha.c
	* plug-ins/common/vpropagate.c
	* plug-ins/script-fu/scripts/3d-outline.scm
	* plug-ins/script-fu/scripts/alien-glow-bar.scm
	* plug-ins/script-fu/scripts/alien-glow-bullet.scm
	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/beveled-pattern-button.scm
	* plug-ins/script-fu/scripts/blend-anim.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/bovinated-logo.scm
	* plug-ins/script-fu/scripts/burn-in-anim.scm
	* plug-ins/script-fu/scripts/carved-logo.scm
	* plug-ins/script-fu/scripts/chalk.scm
	* plug-ins/script-fu/scripts/chip-away.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/crystal-logo.scm
	* plug-ins/script-fu/scripts/drop-shadow.scm
	* plug-ins/script-fu/scripts/picman-headers.scm
	* plug-ins/script-fu/scripts/picman-labels.scm
	* plug-ins/script-fu/scripts/glowing-logo.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/image-structure.scm
	* plug-ins/script-fu/scripts/neon-logo.scm
	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/textured-logo.scm
	* plug-ins/script-fu/scripts/title-header.scm
	* plug-ins/script-fu/scripts/waves-anim.scm
	* plug-ins/xjt/xjt.c: changed accordingly.

2005-07-10  Sven Neumann  <sven@picman.org>

	* app/batch.c (batch_run): unified strings.

2005-07-10  Hans Breuer  <hans@breuer.org>

	* **/makefile.msc app/picmancore.def : updated
	* app/widgets/picmancontrollerlist.c : dont include
	"picmanmessagedialog.c" to avoid redefinitions.
	Instead include picmanmessagebox.h and picmanmessagedialog.h

	* plug-ins/common/raw.c : include <io.h>
	* plug-ins/common/screenshot.c : make it compile. It
	still has no code to actually work on win32.

2005-07-10  Sven Neumann  <sven@picman.org>

	* app/base/segmentator.[ch]: ported to PICMAN data structures. There
	are still some TODOs, smooth_mask() isn't implemented yet.

	* app/core/Makefile.am
	* app/core/picmandrawable-foreground-extract.[ch]: thin wrapper around
	the new segmentation algorithm.

	* tools/pdbgen/pdb/drawable.pdb: added a first draft of a PDB API
	for foreground extraction.

	* app/pdb/drawable_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmandrawable_pdb.[ch]: regenerated.

2005-07-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c: removed if(image) checks where the image
	can't be NULL.

2005-07-09  Sven Neumann  <sven@picman.org>

	* app/base/pixel-surround.[ch]: formatting.

	* app/core/picmanchannel.c (picman_channel_real_feather):
	gaussian_blur_region() writes to the pixel data, need to initialize
	the pixel region with dirty == TRUE;

	* app/paint-funcs/paint-funcs-generic.h: formatting.

2005-07-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansamplepointeditor.[ch]: added "sample-merged"
	property and API. Pass it to picman_image_pick_color().

	* app/actions/Makefile.am
	* app/actions/actions.c
	* app/actions/sample-point-editor-actions.[ch]
	* app/actions/sample-point-editor-commands.[ch]: actions and
	callbacks for the sample point editor's menu.

	* app/widgets/picmanhelp-ids.h: its help IDs.

	* app/menus/menus.c
	* menus/Makefile.am
	* menus/sample-point-editor-menu.xml: the sample point editor menu.

2005-07-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-pick-color.c (picman_image_pick_color): if
	sample_merged is FALSE and drawable is NULL, just get the image's
	active drawable instead of bailing out.

	* app/widgets/picmancursorview.c (picman_cursor_view_update_cursor):
	use picman_image_pick_color() insted of duplicating its code.

2005-07-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewabledialog.c: ellipsize the name label.

2005-07-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancursorview.[ch]: added boolean "sample-merged"
	property, API and GUI. Pick from the active drawable if it's
	FALSE.

	* app/actions/Makefile.am
	* app/actions/actions.c
	* app/actions/cursor-info-actions.[ch]
	* app/actions/cursor-info-commands.[ch]: new files with actions
	and callbacks for the cursor info dialog's menu.

	* app/widgets/picmanhelp-ids.h: help IDs for above actions.

	* app/actions/dialogs-actions.c
	* app/dialogs/dialogs.c: follow help ID change.

	* app/menus/menus.c
	* menus/Makefile.am
	* menus/cursor-info-menu.xml: add the cursor-info menu.

	* app/dialogs/dialogs-constructors.c: pass the menu factory to
	picman_cursor_view_new().

2005-07-09  Sven Neumann  <sven@picman.org>

	* app/base/segmentator.c: plugged memory leaks.

2005-07-08  Sven Neumann  <sven@picman.org>

	* app/base/segmentator.c: minor cleanup, use a GQueue instead of a
	custom queue implementation.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancursorview.c (picman_cursor_view_update_cursor):
	pass the color index value to picman_color_frame_set_color() so it
	would show up in the frame if we actually picked from indexed
	things.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanclonetool.c: initialize the parent_class pointer
	with NULL.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_new): enable
	remote files: set local_only to FALSE if the PDB has
	"file_uri_load/save" procedures (yes, this is questionable).

2005-07-08  Michael Natterer  <mitch@picman.org>

	* libpicmancolor/picmanbilinear.c
	* libpicmanwidgets/picmanpreviewarea.c: fix some uninitialized stuff
	gcc 4.0 was choking about.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.c (picman_page_selector_class_init):
	added and fixed some API docs.

2005-07-08  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: fixed spelling of Fractal.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.h: include picmanscrolledpreview.h

2005-07-08  Michael Natterer  <mitch@picman.org>

	* app/actions/edit-commands.c
	* app/actions/tool-options-commands.c: made the "Reset all tool
	options" and "Clear undo history" dialogs modal and simplified the
	code to use picman_dialog_run() instead of a separate callback
	function.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.[ch]: moved all instance members
	to a private struct.

2005-07-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.[ch]: fixed horizontal layout to
	not always use multiples of the default item width. Use the
	maximum thumbnail icon width instead. Also fixes keynav since it
	doesn't trigger a GTK+ bug any more.

2005-07-08  Sven Neumann  <sven@picman.org>

	* app/base/segmentator.[ch]: applied PICMAN coding style, switch to
	glib functions for memory allocation.

2005-07-08  Sven Neumann  <sven@picman.org>

	* app/base/Makefile.am
	* app/base/segmentator.[ch]: added foreground extraction
	algorithm.  This code is contributed by Gerald Friedland. Please
	see the comments in the code for links to further information.
	This is work in progress. Don't expect it to do anything yet.

2005-07-07  Michael Natterer  <mitch@picman.org>

	* app/actions/documents-actions.c
	* app/actions/documents-commands.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/documents-menu.xml: added "Copy Image Location" to the
	document history popup menu which copies the image's URI to
	clipbpard and primary.

2005-07-07  Sven Neumann  <sven@picman.org>

	* app/actions/gradient-editor-commands.c
	* app/widgets/picmancolordialog.c
	* app/widgets/picmandock.c
	* plug-ins/gflare/gflare.c
	* plug-ins/script-fu/script-fu-server.c: set alternative button
	order in some places that were missed earlier. Spotted by Stephan
	Binner.

2005-07-06  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanactionview.c (picman_action_view_new): set a
	search column.

2005-07-06  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanbrowser.c: set the count label in italic.

	* plug-ins/dbbrowser/picmanprocbrowser.c
	* plug-ins/dbbrowser/plugin-browser.c: try to make it more obvious
	that the list is the result of a query by explicitely mentioning
	this in the summary below the list.

2005-07-06  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins-query.c (match_strings): reverted previous
	change, it was bogus.

	* app/pdb/procedural-db-query.c: case-insensitive search for
	procedures.

2005-07-06  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-ins-query.c (match_strings): match
	case-insensitive.

	* libpicmanwidgets/picmanbrowser.c: unset "focus-on-click" on the
	filter combo-box.

	* plug-ins/dbbrowser/plugin-browser.c: moved "Insertation Date"
	column all the way to the right and renamed to "Installation Date".

	* plug-ins/common/gauss.c: tweaked dialog packing.

2005-07-05  Manish Singh  <yosh@picman.org>

	* INSTALL
	* configure.in: Allow gtkhtml2, svg, and lcms features to be disabled
	explicitly at configure time. Based on patch from John N. Laliberte,
	fixes bug #307704.

2005-07-06  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.c: added a frame around the
	thumbnails. The code is still a bit hackish... Frame stretching
	is a 1:1 copy from app/widgets/picmanviewrenderer-frame.c so it
	can be easily factored out).

2005-07-05  Sven Neumann  <sven@picman.org>

	* app/core/cpercep.[ch]: renamed cpercep_init_conversions() to
	cpercep_init(); only initialize the tables on the first call.

	* app/core/picmanimage-convert.c: changed accordingly.

2005-07-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: removed uesless g_malloc() wrapper.

2005-07-04  Sven Neumann  <sven@picman.org>

	* configure.in
	* devel-docs/tools/Makefile.am: build the doc-shooter utility
	conditionally and explicitely link it with -lX11.

2005-07-03  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanframe.c: cleanups.

2005-07-01  Nathan Summers  <rock@picman.org>

	Changes in preparation for integrating picman-poppler.

	* configure.in: check for libpoppler.

	* plug-ins/common/postscript.c (query): don't register file_load_pdf
	if HAVE_POPPLER is defined

2005-07-02  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.c: some cleanup and API docs.

2005-07-01  Nathan Summers  <rock@picman.org>

	* app/batch.c
	* app/config/picmanrc-blurbs.h
	* app/core/picmanimage-convert.c
	* app/dialogs/user-install-dialog.c: grammar and other pedantic string
	changes.

2005-07-01  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 2.3.3.

2005-07-01  Sven Neumann  <sven@picman.org>

	* Made 2.3.2 development release.

2005-07-01  Akkana Peck  <akkana@cvs.gnome.org>

	* app/actions/plug-in-actions.c
	* menus/image-menu.xml.in: Rename Effects menu's action to
	plug-in-effects-menu (missed during image menu reorg).

2005-07-01  Sven Neumann  <sven@picman.org>

	* Makefile.am (SUBDIRS): added po-tips.

	* app/Makefile.am (dist-dump-picmanrc): don't needlessly write to
	the source directory.

	* data/tips/Makefile.am (EXTRA_DIST): added tipsdata_DATA.

2005-07-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpageselector.c: added more API documentation.

2005-07-01  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c: load an embedded ICC profile and
	attach it using the "icc-profile" parasite.

	* plug-ins/jpeg/jpeg-save.c: look for the "icc-profile" parasite
	and embed the profile in the JPEG file if it is available.

2005-07-01  Manish Singh  <yosh@picman.org>

	* plug-ins/jpeg/jpeg-save.c: Initialize restart markers check button
	accordingly from defaults. Fixes bug #309091, patch from
	David 'Bombe' Roden.

2005-06-30  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanpageselector.[ch]: added API to set/get
	the label for each page.

2005-06-30  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-icc.[ch]: copied code from lcms that reads
	and writes ICC profiles from/to JPEG files. Not yet used at all.

2005-06-29  Sven Neumann  <sven@picman.org>

	* plug-ins/*/*.c: use the canonical form of signal names.

2005-06-28  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgetsenums.[ch]: added enum
	PicmanPageSelectorTarget which can be one of { LAYERS, IMAGES }
	(suggestions for a better name welcome).

	* libpicmanwidgets/picmanpageselector.[ch]: added "target" property
	and a combo box to select a target. Removed PicmanFrame around inner
	widgets again. Set a minimum width on the items so the "Page xxx"
	text doesn't wrap for pages smaller than 1000.

2005-06-27  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmanwidgets/picmanpageselector.c: fixed a typo:
	thmbnail -> thumbnail

2005-06-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanpageselector.[ch]: made range API public.

2005-06-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpageselector.[ch]: added "Select All/None"
	buttons and a "Select Range" entry which allows entering of page
	ranges manually (e.g. "1,6,8,10-16").

2005-06-27  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanwidgets-constructors.c: added missing casts.

2005-06-27  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanpageselector.[ch]: new widget, PicmanPageSelector
	which will be used to select which pages to open from multi-page
	documents (e.g. PS, PDF, TIFF). Work in progress!

2005-06-27  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumcombobox.[ch]: added new constructor
	picman_enum_combo_box_new_with_model(). Also override the "model"
	property to make it clear that PicmanEnumComboBox expects to be
	used with PicmanEnumStore.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanwidgets-constructors.c: use the new constructor.

	* libpicmanwidgets/picmanenumlabel.h
	* libpicmanwidgets/picmanenumstore.h
	* libpicmanwidgets/picmanintcombobox.h
	* libpicmanwidgets/picmanintstore.h: use "parent_class", not
	"parent_instance" when including the parent struct.

2005-06-27  Sven Neumann  <sven@picman.org>

	* app/actions/debug-commands.c: fixed memory profile debug action.

2005-06-27  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_configure): gracefully
	handle a NULL config until we have fixed creation of color display
	modules so that they always have a reference to PicmanColorConfig.

2005-06-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolordisplayeditor.c: dialog layout tweaks.

2005-06-26  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am: actually define pypicmandir in terms
	of pypicmanbase.

2005-06-27  Sven Neumann  <sven@picman.org>

	* menus/Makefile.am
	* menus/menus.xsl
	* menus/toolbox-menu.xml.in: readded the Debug menu but changed
	the XSLT and the build rules so that it is only included in the
	development versions.

2005-06-26  Manish Singh  <yosh@picman.org>

	* app/core/picmanenvirontable.c: feed environment values through
	picman_config_path_expand, so ${picman..} variables can be used.

	* plug-ins/pypicman/Makefile.am: define PYTHONPATH in terms of
	${picman_plug_in_dir}. Use ; as a path separator on windows.

	With this final changes, pypicman should work out of the box on
	Win32 now. Thanks to Michael Schumacher and lode leroy for
	figuring out the high level details and testing.

2005-06-27  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-dump.c (dump_picmanrc_manpage): don't dump
	properties that have the PICMAN_PARAM_IGNORE flag set.

2005-06-26  Sven Neumann  <sven@picman.org>

	* libpicman/picman.def: added picman_get_color_configuration.

2005-06-25  Karine Delvare  <kdelvare@nerim.net>

	* plug-ins/FractalExplorer/FractalExplorer.c: Add an apply button
	and remove the frame around the scrolled window.

2005-06-26  Manish Singh  <yosh@picman.org>

	* libpicman/picmanpicmanrc.c (picman_get_color_configuration): cast to
	PICMAN_CONFIG() for picman_config_deserialize_string().

2005-06-26  Sven Neumann  <sven@picman.org>

	* data/tips/Makefile.am
	* data/tips/fortunes.xsl: let the transformation work on the
	multi-language XML file and pass a language parameter to it.

2005-06-26  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c: use dgettext() instead of
	gettext() and try to obtain the translation domain from the type.
	Fixes i18n of tooltips on property widgets (bug #307756).

	* libpicmanconfig/picmancolorconfig.c: set a translation domain.

2005-06-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: added tooltips with more information on
	the used profiles.

2005-06-26  Tor Lillqvist  <tml@novell.com>

	* app/tools/picmanpainttool.c (picman_paint_tool_draw): Store the
	PicmanBrushCore::brush_bound_segs as sorted (the result of
	sort_boundary), as the only place where it is used
	(picman_draw_tool_draw_boundary()) would sort it each time it is
	called anyway.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_boundary):
	Correspondingly we now don't have to sort the boundary here.

2005-06-26  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/picmanrc.pdb: allow to access (read-only) the
	current color management configuration through the PDB.

	* libpicman/picmanpicmanrc_pdb.[ch]
	* app/pdb/picmanrc_cmds.c
	* app/pdb/internal_procs.c: regenerated.

	* libpicman/Makefile.am
	* libpicman/picman.h
	* libpicman/picmanpicmanrc.[ch]: wrap the new PDB function to make it
	easier to use from plug-ins. This change adds a dependency on
	libpicmanconfig to libpicman.

	* picman.pc.in: changed accordingly.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gflare/gflare.c: no need to include picmanconfig.h
	explicitely any longer.

	* libpicman/picmanfontselectbutton.c: fixed gtk-doc comments.

2005-06-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: also use bold, right-aligned labels here.

2005-06-25  Manish Singh  <yosh@picman.org>

	* app/core/picmaninterpreterdb.c: eat CRs too, since they might be
	there on Win32 systems.

2005-06-25  Manish Singh  <yosh@picman.org>

	* configure.in: introduce a notion of runtime path to the python
	interpreter, for the pypicman.interp file.

	* plug-ins/pypicman/Makefile.am: use it here.

2005-06-25  Manish Singh  <yosh@picman.org>

	* configure.in: attempt to work around weird escaping behavior
	in the windows shell when converting backslashes to forward
	slashes.

2005-06-25  Manish Singh  <yosh@picman.org>

	* configure.in: convert backslashes to forward slashes for python
	stuff on Win32.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.c: use bold and right-aligned
	labels for the label titles.

2005-06-25  Michael Natterer  <mitch@picman.org>

	* Makefile.am: added all-local target which rebuilds AUTHORS.

2005-06-25  Karine Delvare  <kdelvare@nerim.net>

	* AUTHORS
	* app/dialogs/authors.h: regenerated.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagepropview.c (picman_image_prop_view_update):
	use picman_enum_get_value() to avoid string duplication.

2005-06-25  Karine Delvare  <kdelvare@nerim.net>

	* authors.xml: added Akkana Peck to contributors and updated my
	last name.

	* po/fr.po: fixed typo.

2005-06-25  Karine Delvare  <kdelvare@cvs.picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c: activate fractal on
	double-click rather than select.

2005-06-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/maze/maze_face.c: First step in changing the UI to match
	the layout suggested in bug #82591.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolordisplayeditor.c: shortened bold labels.

2005-06-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am: drop the module suffix from the
	filename of the dynamic libraries.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c
	* modules/cdisplay_lcms.c: use italic text for info labels.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolordisplayeditor.c: use a GtkVPaned.

2005-06-25  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_configure): show the names
	of the color profiles that are used.

2005-06-24  Tor Lillqvist  <tml@novell.com>

	* app/display/picmancanvas.h: Add new PicmanCanvasStyle value,
	PICMAN_CANVAS_STYLE_XOR_DOTTED.

	* app/display/picmancanvas.c (picman_canvas_gc_new): Implement it like
	PICMAN_CANVAS_STYLE_XOR_DASHED, except that we set the dash pattern
	to a single-pixel on-off one.

	* app/tools/picmandrawtool.c (picman_draw_tool_draw_boundary): Sort
	the boundary so that we can draw each connected group of segments
	using picman_canvas_draw_lines(). (Even if we would still use
	picman_canvas_draw_segments(), the boundary would have to be sorted
	so that the XOR drawing and GDK_CAP_NOT_LAST cooperate properly.)

	Use PICMAN_CANVAS_STYLE_XOR_DOTTED so the outline doesn't look too
	heavy.

	Remove the dubious code snippet that offset some segments by one
	pixel. It didn't do what the comment claimed, and why one would
	need to do what the comment said, or what it actually did, is
	unclear.

	Now brush outlines shouldn't have gaps any longer. (#308710)

2005-06-24  Manish Singh  <yosh@picman.org>

	* configure.in: define PYLINK_LIBS on Win32, since DLLs need to have
	all their symbols fully resolved at link time.

	* plug-ins/pypicman/Makefile.am: link python modules with PYLINK_LIBS.

2005-06-25  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: relabel the profile used for
	softproofing to "Print simulation profile".

	* libpicmanconfig/picmancolorconfig.c: improved blurb.

	* modules/cdisplay_lcms.c (cdisplay_lcms_configure): show filenames
	of profiles; will be replaced by real profile information.

2005-06-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanenumlabel.[ch]: added new widget PicmanEnumLabel.

	* libpicmanwidgets/picmanpropwidgets.[ch]: added
	picman_prop_enum_label_new().

	* libpicmanwidgets/picmanwidgets.def: updated.

	* modules/cdisplay_lcms.c (cdisplay_lcms_configure): started to
	add a view on the current color managment configuration.

2005-06-24  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am: build all libraries with no-undefined.
	Ignore doc stuff for now, since it's ancient and needs to be massively
	revised.

	* configure.in: don't generate plug-ins/pypicman/doc/Makefile

2005-06-24  Manish Singh  <yosh@picman.org>

	* acinclude.m4: split out into separate files...

	* m4macros/alsa.m4
	* m4macros/picmanprint.m4
	* m4macros/gtk-doc.m4
	* m4macros/pythondev.m4: ... and put them here.

	* m4macros/Makefile.am: dist the above files.

2005-06-24  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/text-circle.scm: Incorporated changes
	made by Daniel P. Stasinski in his text-circle2.scm script. Letters
	are now placed properly for both positive and negative fill angles.
	Last(?) fix for bug #144588.

2005-06-24  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: added a mnemonic.

	* libpicmanwidgets/picmanpropwidgets.c
	(picman_prop_file_chooser_button_new): embed the button in an
	event-box if the param_spec provides a blurb to be used as a
	tooltip.

	* libpicmanconfig/picmancolorconfig.c: improved blurbs.

2005-06-24  Manish Singh  <yosh@picman.org>

	* libpicmancolor/picmancolor.def: add picman_rgba_parse_css

2005-06-24  Sven Neumann  <sven@picman.org>

	* app/actions/image-actions.c
	* app/actions/layers-actions.c
	* app/dialogs/image-properties-dialog.c: use GTK_STOCK_PROPERTIES
	as stock icon for property menu items and dialogs.

2005-06-24  Sven Neumann  <sven@picman.org>

	* app/core/picmanpdbprogress.[ch]: removed an incomplete and unused
	function.

2005-06-24  Sven Neumann  <sven@picman.org>

	* app/pdb/procedural_db.c (procedural_db_execute): if we end up
	without any return values, assume an execution error instead of
	crashing (bug #308904).

2005-06-24  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	increased maximum property size, added debug output.

2005-06-24  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: implement the configure method and tell
	the user where this module can be configured.

2005-06-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c: some code cleanup, no real changes.

2005-06-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/png.c (save_image):
	* app/dialogs/preferences-dialog.c: added a check button to control
	the "display-profile-from-gdk" option.

	* modules/cdisplay_lcms.c (cdisplay_lcms_get_display_profile):
	fixed use of gdk_property_get(). Return NULL if no display profile
	can be obtained.

2005-06-24  Sven Neumann  <sven@picman.org>

	Added basic support for the proposed ICC Profiles In X Specification
	(http://burtonini.com/temp/xicc-specification-0.1.html).

	* libpicmanconfig/picmancolorconfig.[ch]: added a configuration option
	"display-profile-from-gdk", default to TRUE.

	* modules/cdisplay_lcms.c: try to retrieve the display color
	profile from the "_ICC_PROFILE" property on the default screen.

2005-06-23  Akkana Peck  <akkana@shallowsky.com>

	* app/actions/plug-in-actions.c
	* menus/image-menu.xml.in
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/convmatrix.c
	* plug-ins/common/depthmerge.c
	* plug-ins/common/film.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/lic.c
	* plug-ins/common/nova.c
	* plug-ins/common/sparkle.c
	* plug-ins/common/vpropagate.c
	* plug-ins/gflare/gflare.c
	* plug-ins/pypicman/doc/pypicman.sgml
	* plug-ins/pypicman/doc/pypicman.html
	* plug-ins/pypicman/doc/structure-of-plugin.html
	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/scripts/clothify.scm
	* plug-ins/script-fu/scripts/drop-shadow.scm
	* plug-ins/script-fu/scripts/erase-rows.scm
	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/predator.scm
	* plug-ins/script-fu/scripts/weave.scm
	* plug-ins/script-fu/scripts/xach-effect.scm: Reorganize
	the Image window's Filters menu, as discussed in bug #116145.

2005-06-23  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c (plug_in_actions_last_changed): call
	plug_in_actions_update() to update the sensitivity of the last used
	plug-in entries.

2005-06-23  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/font-map.scm: Updated to fix problems
	related to change in handling of string arrays (see bug #168290).
	Fixes bug #308681.

2005-06-23  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.c (picman_int_combo_box_new_valist)
	(picman_int_combo_box_new_array): no need to create a new list store;
	picman_int_combo_box_init() already did that for us.

2005-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/grid.c: draw the intersection on top of the grid.
	Fixes bug #308754.

2005-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/shift.c: shift whole rows/columns, instead of
	tiles. Fixes bug #308748.

2005-06-23  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-console.c: removed redundant labels.

2005-06-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbrowser.[ch]: added the widget living in the
	right_vbox to the PicmanBrowser struct instead of attaching it to
	the browser.

2005-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c: applied a patch from
	Karine Delvare that removes an obsolete frame.

	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/FractalExplorer/logo.h: removed logo now that the About
	dialog is gone.

2005-06-22  Michael Natterer  <mitch@picman.org>

	* libpicmanconfig/picmanconfig-deserialize.h
	* libpicmanconfig/picmanconfig-error.h
	* libpicmanconfig/picmanconfig-iface.h
	* libpicmanconfig/picmanconfig-params.h
	* libpicmanconfig/picmanconfig-path.h
	* libpicmanconfig/picmanconfig-serialize.h
	* libpicmanconfig/picmanconfig-utils.h: added G_BEGIN_DECLS/G_END_DECLS.

2005-06-22  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in: added Edit->Preferences since that
	seems to be the standard location nowadays (bug #157613).

2005-06-22  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c: unified spelling of "Re-Show".

2005-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mblur.c: switch to a more compact dialog layout.

2005-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/mblur.c: add option of blurring inward
	or outward for zoom, should fix bug #142968.

2005-06-22  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/FractalExplorer/FractalExplorer.[ch]: merged in a patch
	from Karine Delvare with further UI improvements (see bug #140202).

2005-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/newsprint.c: remove "optimization" that interacts
	badly with preview; fixes bug #161573.

2005-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/retinex.c:  initialize memory before using.
	Fixes bug #157915.

2005-06-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanlayer-floating-sel.c: set "Keep Transparency"
	FALSE when creating floating sel; see bug #161042.

2005-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c: minor changes, mainly to the
	Rescan dialog.

2005-06-21  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c: applied a patch from
	Karine Delvare that ports the list to GtkTreeView and replaces the
	XPM icons with stock icons. Fixes bug #140202.

	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/FractalExplorer/pix_data.h: removed this file.

2005-06-21  Sven Neumann  <sven@picman.org>

	* app/actions/documents-commands.c: added a second text to the
	confirmation dialog; changed the primary text.

2005-06-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhelp-ids.h: added missing id to fix the build.

2005-06-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/laplace.c: don't normalize the result.
	Fixes bug #306874?

2005-06-20  Michael Natterer  <mitch@picman.org>

	* app/actions/documents-actions.c
	* app/actions/documents-commands.[ch]
	* app/widgets/picmandocumentview.c
	* app/widgets/picmanhelp-ids.h
	* menus/documents-menu.xml: added "Clear document history" action,
	button, menu item and confirm dialog (bug #140001).

2005-06-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/noisify.c: rename as "plug-in-rgb-noise"
	with menu entry "RGB Noise".  Leave "plug-in-noisify" for
	backward compatibility.

	* plug-ins/common/scatter_hsv.c: rename as "plug-in-hsv-noise"
	with menu entry "HSV Noise".  Leave "plug-in-scatter-hsv" for
	backward compatibility.

2005-06-20  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_new): set the
	gravity of the image window to CENTER. Gives much better behaviour
	for "resize-windows-on-zoom".

2005-06-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_new_pixbuf):
	simplified, use the eek wilber icon if the file doesn't exist.

2005-06-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c: string fixes (bug #308134).

2005-06-17  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: pass PicmanImageBaseType to
	extract_from_region() instead of some anonymous integer. Added
	some const qualifiers.

2005-06-17  Sven Neumann  <sven@picman.org>

	* app/core/picmanselection.c (picman_selection_extract): fixed
	long-standing bug in the calculation of the depth of the
	tile-manager created when copying from an indexed drawable.

2005-06-17  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/unsharp-mask.scm: removed menu
	registration (bug #307535).

2005-06-17  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gee.c
	* plug-ins/common/gee_zoom.c: don't register any menu entries
	(see bug #307998).

	* app/actions/plug-in-actions.c
	* menus/image-menu.xml.in: removed Toys submenu.

2005-06-17  Sven Neumann  <sven@picman.org>

	* menus/image-menu.xml.in
	* plug-ins/Lighting/lighting_main.c
	* plug-ins/common/apply_lens.c
	* plug-ins/common/flarefx.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/nova.c
	* plug-ins/common/sparkle.c
	* plug-ins/gflare/gflare.c
	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/shadow_bevel.py
	* plug-ins/pypicman/plug-ins/whirlpinch.py
	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/scripts/*.scm: applied menu reorganization
	patch done by Akkana Peck (bug #116145).

	* plug-ins/common/film.c: renamed filter to "Filmstrip".

2005-06-16  Sven Neumann  <sven@picman.org>

	* desktop/picman.applications.in: expand the PICMAN acronym.

	* desktop/picman.keys.in: removed some cruft.

2005-06-16  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in
	* desktop/Makefile.am: allow to skip installation of desktop files
	by passing --without-desktop-dir.

2005-06-16  Sven Neumann  <sven@picman.org>

	Redid the framework that deals with installing desktop files.
	Fixes bug #307705:

	* data/misc/*: removed.

	* desktop/*: readded the desktop files in a new directory.

	* Makefile.am
	* configure.in
	* data/Makefile.am: changed accordingly.

2005-06-16  Michael Natterer  <mitch@picman.org>

	* tools/pdb/pdbgen/edit.pdb: revert accidential commit.

2005-06-16  Sven Neumann  <sven@picman.org>

	* tools/test-clipboard.c (test_clipboard_copy_callback): exit from
	main loop if g_file_get_contents() fails.

2005-06-16  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c: capitalization.

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/actions/file-actions.c
	* app/actions/plug-in-actions.c
	* app/actions/tool-options-actions.c: removed ellipsis from commands
	that only present a confirmation dialog.

	* app/actions/file-actions.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmangrideditor.c: capitalization.

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: fix capitalization on the
	Color Management page.

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanlayertreeview.[ch]: there's no need to keep a
	reference to the anchor button.

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_load_thumb):
	* app/widgets/picmanthumbbox.c (picman_thumb_box_auto_thumbnail):
	don't display a preview and don't attempt to create one if the
	image file does not exist any longer (bug #307672).

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/actions/dockable-actions.c (dockable_actions_update): set the
	"Detach Tab" action insensitive if the dockable is alone in its dock.

2005-06-15  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c (prefs_input_devices_dialog):
	changed window title as suggested in bug #307701.

2005-06-15  Michael Natterer  <mitch@picman.org>

	* libpicmanmodule/picmanmodule.[ch] (picman_module_register_enum):
	deprecated. Changed implementation to simply call
	g_type_module_register_enum().

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_proof.c: use g_type_module_register_enum() instead.

2005-06-14  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_raise_layer)
	(picman_image_raise_layer_to_top): allow to raise a layer w/o an
	alpha channel.

2005-06-14  Sven Neumann  <sven@picman.org>

	* app/core/picman-gradients.c: renamed internal keys.

2005-06-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: some dialog changes, hopefully to
	the better.

2005-06-13  Michael Natterer  <mitch@picman.org>

	* app/core/picmanlayer.c (picman_layer_transform_color): copy the
	alpha channel from the correct source.

2005-06-13  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-resize.c: added missing brackets in macros.

2005-06-11  Manish Singh  <yosh@picman.org>

	* configure.in: if any of the pypicman dependencies aren't fulfilled,
	display a more informative message.

	* autogen.sh: depend on automake 1.8, so AM_PATH_PYTHON has a user
	defined failure mode. Also prefer automake 1.9.

2005-06-11  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c: connect to "selection-changed"
	instead of "file-activated". Fixes bug #307146.

2005-06-11  Michael Natterer  <mitch@picman.org>

	Allow to use the selected font in the text editor (bug #170299):

	* app/widgets/picmantexteditor.[ch]: added a "Use selected font"
	toggle and an API to set/get the selected font name.

	* app/tools/picmantextoptions.c: update the editor's font when the
	text option's font changes. Renamed text editor callbacks to
	picman_text_options_editor_foo().

2005-06-10  Michael Natterer  <mitch@picman.org>

	* configure.in: don't try to generate tips/Makefile.

2005-06-10  Sven Neumann  <sven@picman.org>

	Switch to a more standard way of treating the translations for the
	startup tips (bug #171846):

	* Makefile.am
	* configure.in: removed tips directory; added data/tips and po-tips
	directories instead.

	* data/Makefile.am
	* data/AUTHORS
	* data/ChangeLog
	* data/README: removed these three outdated files.

	* data/tips: picman.tips.xml and related files live here now.

	* po-tips: translations of the tips are found here now.

	* README.i18n: changed accordingly.

2005-06-10  Michael Natterer  <mitch@picman.org>

	Fix bug #134304, as far as it's fixable:

	* app/core/picman-edit.c (picman_edit_paste_as_new): handle pasting
	buffers without alpha. Also don't uselessly convert all buffers
	to RGB but create an image in the buffer's color space.

	(picman_edit_extract): call picman_selection_extract() with
	add_alpha = FALSE.

	* app/core/picmanselection.c (picman_selection_extract): set add_alpha
	to TRUE if there is a selection, because the selection could have
	any shape.

2005-06-09  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 2.3.2.

2005-06-09  Sven Neumann  <sven@picman.org>

	* Made 2.3.1 development release.

2005-06-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/laplace.c: minor code cleanup.

2005-06-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h: removed blurbs for unused preferences.

	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c: changed accordingly.

2005-06-08  Sven Neumann  <sven@picman.org>

	Removed "stingy-memory-use" all over the place. This feature was
	really not that useful anymore. The GUI for the preference option
	was already removed for PICMAN 2.2.  Fixes bug #306617.

	* app/config/picmanbaseconfig.[ch]: set IGNORE flag on
	"stingy-memory-use".

	* app/config/picmancoreconfig.h: added a comment that the
	font_path_writable variable is unused.

	* app/base/temp-buf.[ch]: removed code that used to deal with
	swapping temp-bufs to disk.

	* app/base/base.c: made base_config a static variable.

	* app/core/picmandata.[ch]
	* app/core/picmandatafactory.[ch]: removed stingy_memory_use
	parameter from data construction methods.

	* app/core/picman-gradients.c
	* app/core/picmanbrush-load.[ch]
	* app/core/picmanbrush.[ch]
	* app/core/picmanbrushgenerated.[ch]
	* app/core/picmanbrushpipe.[ch]
	* app/core/picmancontext.c
	* app/core/picmangradient-load.[ch]
	* app/core/picmangradient.[ch]
	* app/core/picmanpalette-import.c
	* app/core/picmanpalette.[ch]
	* app/core/picmanpattern.[ch]: changed accordingly.

2005-06-05  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanaligntool.[ch]: improve layout of controls.  Add
	radio buttons allowing selection of reference layer without
	using Ctrl modifier.  Handle removal of target or reference
	layers from image more correctly.  More to come.

2005-06-07  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.c
	* plug-ins/bmp/bmpread.c
	* plug-ins/bmp/bmpwrite.c: applied a (slightly modified) patch
	contributed by Brandon that adds support for reading and writing
	RGBA BMP files (bug #306339).

2005-06-07  Manish Singh  <yosh@picman.org>

	* app/base/cpu-accel.[ch]: detect SSE3.

2005-06-07  Manish Singh  <yosh@picman.org>

	* app/actions/dockable-actions.c (dockable_actions_update): cast
	the result of gtk_bin_get_child ().

2005-06-06  Michael Natterer  <mitch@picman.org>

	* app/actions/dockable-actions.c (dockable_toggle_actions): use
	'B' instead of 'S' as mnemonic for "Show Button Bar".

2005-06-06  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_grid.[ch]
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_menu_funcs.[ch]
	* plug-ins/imagemap/imap_object_popup.[ch]
	* plug-ins/imagemap/imap_polygon.[ch]: more conversion to action based
	menus. Almost done.

2005-06-06  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig.c (gfig_load_from_parasite): only create the
	temporary file if there is a parasite to load.

2005-06-06  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancellrendererdashes.c: removed unused variable.

2005-06-06  Tor Lillqvist  <tml@novell.com>

	* libpicman/picmanui.def: Add picman_font_select_button_*.

2005-06-05  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/pypicman/picmanenumsmodule.c: use old pygtk enum API so we
	still work with older pygtk versions.

2005-06-05  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: make " no decorations" option
	work; problem pointed out by Jean-Luc Coulon on dev list.

2005-06-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrendererbrush.c
	(picman_view_renderer_brush_render_timeout): if the area is larger
	than the brush, center the brush.

2005-06-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancoloreditor.c
	* app/widgets/picmancursorview.c
	* app/widgets/picmandataeditor.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanpaletteeditor.c: peek at the default interface to
	get the parent interface. Unconditionally chain up in get_aux_info()
	and set_aux_info() methods.

2005-06-04  Manish Singh  <yosh@picman.org>

	* libpicman/Makefile.am: reorder to get the marshal files built first.

2005-06-04  Manish Singh  <yosh@picman.org>

	* libpicman/picmanfontselectbutton.[ch]: new formal widget based on
	picmanfontmenu.[ch].

	* libpicman/picmanuimarshal.list: needed for new signal in above.

	* libpicman/picmanfontmenu.[ch]: deprecate, and thinly wrap around
	new PicmanFontSelectButton for compatibility.

	* libpicman/picmanuitypes.h: add PicmanFontSelectButton, as well
	as types for the future SelectButtons.

	* libpicman/picmanui.h
	* libpicman/Makefile.am: hook in the new widget.

	* plug-ins/common/film.c
	* plug-ins/script-fu/script-fu-interface.c: use new API.

2005-06-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandocked.[ch]
	* app/widgets/picmaneditor.[ch]: moved button-bar API to the
	PicmanDocked interface.

	* app/widgets/picmancontainereditor.c: implement the new interface
	methods and proxy them to the embedded docked.

	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.c: changed accordingly.

2005-06-04  Manish Singh  <yosh@picman.org>

	* libpicman/picmanimagecombobox.h
	* libpicman/picmandrawablecombobox.h: fix the type macros so they work.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.h: don't include picmaneditor.h.

	* app/widgets/picmanbufferview.c
	* app/widgets/picmandocumentview.c
	* app/widgets/picmanfontview.c: include it here instead.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.[ch]
	* app/widgets/picmaneditor.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/dockable-menu.xml.in: allow to show/hide the button-bar in
	PicmanEditor. Should be merged into the PicmanDocked interface.

2005-06-04  Manish Singh  <yosh@picman.org>

	* plug-ins/helpbrowser/dialog.c: define _O_BINARY ourselves if
	it's not defined by any headers, and use that instead of #ifdefed
	calls to g_open.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanwidgets-utils.c (picman_text_buffer_load):
	validate the iter after appending to the text buffer.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_button_release):
	fix calculation of zoom offsets in the case that dot-for-dot mode
	is not enabled (bug #306476).

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_get_viewable_icon): use the
	viewable's description in the drag icon. Use a larger preview.

	* app/widgets/picmandockbook.c: tweak spacing and border-width of
	the tab widget if it is being used as drag icon.

2005-06-04  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.[ch]: invalidate the buffer when
	the widget's sensitivity changes. Draw a stipple pattern on the
	insensitive color area.

	* libpicmanwidgets/picmancellrenderercolor.c: follow internal API change.

	* libpicmanwidgets/picmancolorbutton.c: pass GDK_BUTTON1_MASK as
	drag-mask. Doesn't work for whatever reason but it didn't work
	with GDK_BUTTON2_MASK either.

2005-06-04  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/webbrowser.c: use GetDesktopWindow() and SW_SHOW
	as suggested in bug #171200. Applied to both branches.

2005-06-04  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/helpbrowser/dialog.c: added #ifdef G_OS_WIN32 because
	O_BINARY isn't available on other platforms

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_get_viewable_icon): reduced the
	number of characters to show before ellipsizing the label.

	* libpicmanwidgets/picmancolorarea.c: added a "draw-border" property.

	* app/widgets/picmancolorframe.c: draw a border around the color area.

2005-06-03  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/helpbrowser/dialog.c: added a O_BINARY to make sure
	that images are loaded correctly

2005-06-03  Manish Singh  <yosh@picman.org>

	* libpicman/picmandrawablecombobox.c: create the layer combo with the
	right type.

2005-06-03  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/Makefile.am
	* tools/pdbgen/enumcode-py.pl: removed, unneeded now.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorframe.[ch]: added property for "mode",
	fixed some implementation issues.

	* app/widgets/picmansamplepointeditor.c: create the color frames
	using g_object_new().

2005-06-03  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-api.h
	* plug-ins/pypicman/picmanmodule.c: export our API to other modules
	in a saner fashion. Also add checks_get_shades method.

	* plug-ins/pypicman/procbrowser.c: Use new export API.

	* plug-ins/pypicman/pypicman-drawable.c (drw_mask_intersect):
	use Py_BuildValue to build the tuple.

	* plug-ins/pypicman/pypicman-image.c (img_repr): capitalization fix.

	* plug-ins/pypicman/pypicman-rgb.c
	* plug-ins/pypicman/pypicmancolor.h
	* plug-ins/pypicman/picmancolormodule.c: beginnings of a wrapper to
	libpicmancolor.

	* plug-ins/pypicman/picmanfu.py
	* plug-ins/pypicman/picmanenums.py
	* plug-ins/pypicman/picmanenumsmodule.c: use picman enum API to find out
	our enums.

	* plug-ins/pypicman/Makefile.am: hook in all of the above.

2005-06-03  Manish Singh  <yosh@picman.org>

	* configure.in: build pypicman by default.

2005-06-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmancolorframe.[ch]: add "has-color-area" property,
	FALSE by default.

	* app/widgets/picmansamplepointeditor.c: explicitly add a color
	area to the color frames.

2005-06-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_get_viewable_icon): show the
	viewable's name in the drag icon.

2005-06-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview-dnd.c
	(picman_container_tree_view_drop_status): bail out early if the view
	has no container (instead of crashing).

2005-06-03  Manish Singh  <yosh@picman.org>

	* libpicmancolor/picmanrgb.h: whitespace fix.

	* libpicmanwidgets/picmanchainbutton.h
	* libpicmanwidgets/picmanwidgetsenums.[ch]: move PicmanChainPosition
	to a registered enum, and register PicmanSizeEntryUpdatePolicy as
	as well.

	* libpicman/picmanuitypes.h
	* libpicman/picmandrawablecombobox.[ch]: turn these into GObjects
	with their own types.

	* libpicman/picmanimagecombobox.c: use G_DEFINE_TYPE.

2005-06-03  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/enumcode.pl: make _picman_enums_init public, so
	language bindings can do early enum registration if needed.

	* libpicman/picmanenums.h
	* libpicman/picmanenums.c.tail: regenerated

	* picman.c: call picman_enums_init instead of _picman_enums_init.

	* picman.def: add newly exported function.

2005-06-03  Manish Singh  <yosh@picman.org>

	* configure.in: require python 2.2.1, so True and False are always
	there. Check for pygtk codegen stuff, we'll be using that in the
	future.

	* plug-ins/pypicman/plug-ins/*.py: Use True and False instead of
	TRUE and FALSE.

2005-06-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanitem-align.c
	* app/core/picmanitem-align.h (picman_item_align): remove push_undo
	arg, useless as pointed out by mitch.

	* app/tools/picmanaligntool.c: changed correspondingly.

2005-06-04  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorframe.[ch]: added API to show a number in
	front of the color area.

	* app/widgets/picmansamplepointeditor.c: use the new API to put the
	sample points' numbers there.

2005-06-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanitem-align.[ch]: newly created to
	hold code for picman_item_align().

	* app/core/Makefile.am: add new files

	* app/core/picmanitem.[ch]: remove code from here.

	* app/tools/picmanaligntool.c: fix includes and remove
	unneeded includes.

2005-06-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorframe.c (picman_color_frame_init): pack the
	color area and the labels into different vboxes to make the widget
	compact again.

2005-06-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* picman/app/tools/Makefile.am
	* picman/app/tools/picman-tools.c
	* picman/app/tools/picmanalignoptions.c
	* picman/app/tools/picmanalignoptions.h
	* picman/app/tools/picmanaligntool.c
	* picman/app/tools/picmanaligntool.h: Add new tool for
	aligning layers etc, as described in bug #147437.

	* picman/app/core/picmanitem.c
	* picman/app/core/picmanitem.h (picman_item_align): add
	function required by new tool.

	* picman/app/core/core-enums.c
	* picman/app/core/core-enums.h: add enum for alignment
	types.

	* picman/themes/Default/images/stock-hcenter-24.png
	* picman/themes/Default/images/stock-vcenter-24.png
	* picman/libpicmanwidgets/picmanstock.c
	* picman/libpicmanwidgets/picmanstock.h
	* picman/themes/Default/images/Makefile.am
	* picman/themes/Default/images/makefile.msc: add two
	stock symbols, modeled on the gravity symbols.

2005-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c (picman_rectangle_tool_motion):
	Don't change function before creating new rectangle;
	cause of problem identified by Karine Delvare.

2005-06-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: trap errors when running
	XGrabKey, to prevent bail-out on BadAccess error as
	reported by Jean-Luc Coulon on developers list; solution
	suggested by Simon Budig.

2005-06-02  Raphaël Quinet  <raphael@picman.org>

	* data/images/picman-splash.png: New splash.  A twist on the
	original PixelPusher concept by jimmac.

2005-06-01  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmancolorframe.[ch]: add a color area, to make
	sample points dialog show a swatch of color for each point.

2005-06-01  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.c: cosmetic change: Make the stroke IDs
	start from 1.

	* tools/pdbgen/pdb/vectors.pdb: Two more wrappers:
	vectors_stroke_remove and vectors_stroke_interpolate. Undo still
	unsolved.

	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2005-05-31  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanbrightnesscontrasttool.[ch]: Allow tool to be
	operating by clicking and dragging inside the image, as
	described in bug #165330.

2005-05-31  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/common/CEL.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gee.c
	* plug-ins/common/hot.c
	* plug-ins/common/pat.c
	* plug-ins/common/pcx.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/tiler.c
	* plug-ins/common/zealouscrop.c: GPL license added for plug-ins
	without any license. If any of the authors objects we will
	probably have to remove the plug-in.

2005-05-31  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/gfig/gfig-dobject.c: plug memory leak: Fixes #305990

2005-05-31  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_selection.c: plug memory leak. Fixes #305995.

2005-05-31  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): use XGrabKey()
	to grab the Escape key instead of doing a full keyboard grab.

2005-05-31  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanaction.c (picman_action_set_proxy): added missing
	cast.

	* app/core/picmanprojection-construct.c: code cleanup.

2005-05-31  Michael Natterer  <mitch@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_init): enable
	ellipsation on the progressbar. Fixes initial display width
	calculation for long statusbar strings.

2005-05-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanaction.c (picman_action_set_proxy): re-enabled
	tooltips on the "Open Recent" menu items, using an evil but
	documented heuristic.

2005-05-31  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumwidgets.c
	(picman_enum_stock_box_set_child_padding): don't leak the return
	value of gtk_container_get_children (bug #305994, spotted by Ted
	Kremenek).

	* app/config/picmanrc-serialize.c (picman_rc_serialize_properties_diff):
	don't leak the GList in the unlikely case of an error (bug #305992,
	spotted by Ted Kremenek).

2005-05-31  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette-import.c: applied patch from Joao
	S. O. Bueno Calligaris that adds support for loading PSP color
	palette files (bug #305956).

2005-05-30  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: capitalization and mnemonics.

2005-05-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c (picman_dnd_get_color_icon): pass
	PICMAN_COLOR_AREA_CHECKS_SMALL instead of TRUE for the type of the
	PicmanColorArea.

	* app/widgets/picmancoloreditor.c: added a "context" property.

	* libpicmanwidgets/picmancolorarea.c (picman_color_area_set_color):
	always use picman_rgba_distance(), regardless of the area's type.

2005-05-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/procbrowser.c: use DL_EXPORT for the init functions,
	maybe this will help Win32 builds. Also some minor cleanups.

2005-05-28  Manish Singh  <yosh@picman.org>

	* libpicman/picmanuitypes.h
	* libpicman/picmanimagecombobox.[ch]: turn this into a GObject with its
	own type.

2005-05-28  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_about.c: use gtk_about_dialog instead of
	home-brewn stuff.

	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.c: minor clean-up.

2005-05-27  Sven Neumann  <sven@picman.org>

	* (lots of files): Use the canonical form for signal names.

2005-05-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.[ch]: connect to "name-changed"
	of the active drawable and change the name displayed in the editor.

2005-05-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmaneditor.[ch]: added a name label (with properties
	to show/hide and to set it).

	* app/widgets/picmancontainergridview.[ch]
	* app/widgets/picmanhistogrameditor.[ch]: removed the label here and
	use the functionality now provided by PicmanEditor instead.

	* app/widgets/picmancontainerpopup.c: changed accordingly.

2005-05-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhistogrameditor.c: use a smaller font for the
	statistics.

2005-05-27  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c: reverted previous change for now.

2005-05-27  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c: mark properties as serializable.

2005-05-26  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c
	* plug-ins/helpbrowser/queue.[ch]: store the scroll offset in the
	history and set it when using the Back and Forward actions. Fixes
	bug #165022.

2005-05-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_set_highlight):
	destroy the regions allocated here.

2005-05-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/channel-options-dialog.c: fixed capitalization,
	removed trailing whitespace.

	* app/actions/channels-commands.c (channels_new_channel_response):
	also set the channel color if creating the channel by duplicating
	the selection.

	* app/actions/channels-commands.c
	* app/actions/qmask-commands.c: added mnemonics.

2005-05-26  Nathan Summers  <rock@picman.org>

	* app/dialogs/channel-options-dialog.[ch]: added an "initialize from
	selection" option to the new channel dialog.

	* app/actions/channels-commands.c
	* app/actions/qmask-commands.c: modified accordingly.

2005-05-26  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c: added more properties.

2005-05-26  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.[ch]: added MIME type as a construct property
	to PicmanData.

	* app/core/picmanbrush-load.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmangradient-load.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c: set the MIME type when loading a data
	object from file. MIME types need review and PicmanPalette isn't
	quite done yet...

	* app/core/picmandashpattern.c: cosmetics.

2005-05-25  Nathan Summers  <rock@picman.org>

	* app/sanity.c (sanity_check_filename_encoding): made the
	G_FILENAME_ENCODING not or incorrectly set error message more
	idiomatic.

2005-05-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanoffsetarea.c (picman_offset_area_expose_event):
	correctly handle very small target sizes.

2005-05-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.[ch]: fixed gtk-doc comments.

2005-05-25  Michael Natterer  <mitch@picman.org>

	* app/core/picmanviewable.[ch]: added virtual function
	PicmanViewable::get_size() and public API picman_viewable_get_size()
	which return width and height and a boolean indicating if the
	viewable has a size at all.
	Added default implementation of PicmanViewable::get_popup_size()
	using the new get_size() API.

	* app/core/picmanbrush.c
	* app/core/picmanbuffer.c
	* app/core/picmandrawable.c
	* app/core/picmanimage.c
	* app/core/picmanpattern.c: implement PicmanViewable::get_size().

	* app/core/picmanbrush.c
	* app/core/picmanpattern.c: removed PicmanViewable::get_popup_size()
	implementations, the default one is good enough.

	* app/core/picmanbrushpipe.c (picman_brush_pipe_get_popup_size):
	redirect to picman_viewable_get_size() instead of duplicating its
	return values.

	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanview.c: allow pixbuf dragging out of any
	viewable that has a size.

	* app/widgets/picmandrawabletreeview.c: removed pixbuf dragging code
	here.

	* app/widgets/picmandnd.c: set picman busy around encoding/decoding
	pixbufs into/from GtkSelectionData, because it can be a time
	consuming operation.

2005-05-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-dnd.c (picman_toolbox_drop_pixbuf): fixed
	type of the dropped layer.

2005-05-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c: ellipsize the dockable title if it
	is too wide.

	* app/widgets/picmanstrokeeditor.c: added mnemonic for the presets
	combo.

2005-05-25  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox-dnd.c: implemented dropping of pixbufs.
	Bail out early from all callbacks if picman->busy is TRUE.

2005-05-25  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c: added --store option which tries to
	store a file in the clipboard manager, improved error reporting.

2005-05-24  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorselect.c: only set a horizontal size
	request on the vertical color bar.

2005-05-24  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig.c (picman_color_config_set_property):
	plugged a small memleak.

2005-05-23  Sven Neumann  <sven@picman.org>

	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig.c: initialize PicmanRGB and GFigContext structs
	before using them.

2005-05-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c (select_window_x11): also grab the
	keyboard and allow to cancel the operation using the Escape key.

2005-05-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: always apply the selected delay.

2005-05-23  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancellrendererdashes.[ch]: we don't actually need to
	keep a pointer to the dashes array.
	(picman_cell_renderer_dashes_render): respect horizontal padding.

	* app/widgets/picmanstrokeeditor.c: added 2 pixels horizontal
	padding for the dashes cell-renderer.

2005-05-23  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/helpbrowser/Makefile.am: added the missing -mwindows
	for OS_WIN32

2005-05-23  Tor Lillqvist  <tml@novell.com>

	* picmantool-win32.c.in (get_prefix): Don't crash if picman.exe isn't
	found in PATH either.

2005-05-22  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/Makefile.am: changed picmanwidgetsenums.c rule to
	include the bits for "desc" and "help" support.

	* libpicmanwidgets/picmanwidgetsenums.h: added "desc" and "help"
	strings for the PicmanColorSelectorChannel enum.

	* libpicmanwidgets/picmanwidgetsenums.c: added to CVS because it
	contains translatable strings now.

	* libpicmanwidgets/picmanwidgets.def: changed accordingly.

	* libpicmanwidgets/picmancolorscales.c
	* libpicmanwidgets/picmancolorselect.c: removed duplicated arrays of
	strings here and get them from the type system.

2005-05-22  Sven Neumann  <sven@picman.org>

	* tools/picman-mkenums (parse_trigraph): use quotewords() from
	Text::ParseWords to split the trigraph. This function correctly
	deals with commas inside quotes.

	* app/core/core-enums.[ch]: tweaked descriptions in the
	PicmanDashPreset enum.

2005-05-22  Sven Neumann  <sven@picman.org>

	* app/core/picmandashpattern.c: minor cleanup.

	* app/widgets/picmancellrendererdashes.c: don't draw a background,
	draw the dash pattern twice, use the correct widget state.

2005-05-21  Manish Singh  <yosh@picman.org>

	* plug-ins/metadata/metadata.c (run): don't do pointer arithmetic
	with void *. Fixes bug #305005.

2005-05-22  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c: added --selection-type option which
	allows operating on any of PRIMARY, SECONDARY and CLIPBOARD.

2005-05-21  Sven Neumann  <sven@picman.org>

	* app/core/picmandashpattern.[ch]: added utility functions to copy
	and to free a dash pattern.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancellrendererdashes.[ch]: added a simple cell
	renderer to visualize a dash pattern.

	* app/widgets/picmanstrokeeditor.c: show previews of the dash
	presets in the combo-box.

2005-05-21  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c (main): NULL terminate the options array.

2005-05-21  Sven Neumann  <sven@picman.org>

	Allow to paste a new image using Ctrl-V (bug #169477):

	* menus/toolbox-menu.xml.in: added an accelerator for "edit-paste".

	* app/actions/edit-actions.c: keep "edit-paste" always enabled,
	even if no image is present.

	* app/actions/edit-commands.c (edit_paste_cmd_callback): forward
	to "edit-paste-as-new" if we are being called from the toolbox.

2005-05-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanuimanager.c: improved reporting of errors while
	parsing the menu definitions.

2005-05-21  Sven Neumann  <sven@picman.org>

	* app/dialogs/convert-dialog.c:
	* libpicman/picmanexport.c (export_convert_indexed): changed default
	dithering to PICMAN_NO_DITHER (bug #303063).

2005-05-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorarea.c
	* libpicmanwidgets/picmancolorbutton.c: more object properties.

2005-05-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgetsenums.h
	* libpicmanwidgets/picmanwidgetstypes.h: moved enums to a new file and
	register the PicmanColorAreaType enum with the type system.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* libpicmanwidgets/picmancolorarea.c: added an object property.

2005-05-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorbutton.c: started to add object properties.

2005-05-20  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): Fix ytpo
	in wget command line so it actually works.

2005-05-20  Michael Natterer  <mitch@picman.org>

	* app/core/picmandashpattern.c: don't include "libpicmanbase/picmanbase.h"

2005-05-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorbutton.c (picman_color_button_clicked):
	made the color selection dialog transient to the window that
	contains the color button.

2005-05-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancoloreditor.c: moved the color picker button out
	of the row of notebook switching buttons next to the hex entry.

2005-05-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorselection.c: put the hex entry above the
	color history again.

	* libpicmanwidgets/picmancolorscales.c: do not allocate row spacing
	for the alpha row if it isn't visible.

2005-05-19  Manish Singh  <yosh@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_image): don't do pointer arithmetic
	with void *. Fixes bug #304701.

2005-05-19  Manish Singh  <yosh@picman.org>

	* app/config/test-config.c: Add casts to G_OBJECT() for
	picman_config_diff().

2005-05-19  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolorscales.c: removed the hex entry from the
	PicmanColorScales widget.

	* libpicmanwidgets/picmancolorselection.c: added it here instead.

	* app/widgets/picmancoloreditor.[ch]: and here, next to the FG/BG
	editor.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/picmanstrokeoptions.[ch]: renamed property "miter" to
	"miter-limit" and added a description to be used as a tooltip in
	the stroke editor.

	* app/core/picmandrawable-stroke.c
	* app/widgets/picmanstrokeeditor.c: changed accordingly.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/picmanstrokeoptions.[ch]
	* app/widgets/picmandasheditor.c
	* app/widgets/picmanstrokeeditor.c: small change to the internal API
	to reduce code and conversion between GArray and GValueArray.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/picmandashpattern.[ch]
	* app/widgets/picmandasheditor.c: moved more code out of
	PicmanDashEditor to picmandashpattern.c. Fixed bug in last commit.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/picmandashpattern.[ch]
	* app/widgets/picmandasheditor.c: moved code out of PicmanDashEditor
	to picmandashpattern.c.

2005-05-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/dbbrowser/picmanbrowser.[ch]: removed again...

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetsmarshal.list
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanbrowser.[ch]: ...and added here.

	* plug-ins/dbbrowser/picmanprocbrowser.c
	* plug-ins/dbbrowser/plugin-browser.c: changed accordingly.

	* plug-ins/dbbrowser/picmanprocbrowser.c: fixed searching by help.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandasheditor.c: use code from picmandashpattern.c
	instead of duplicating it.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/picmandashpattern.[ch]
	* app/core/picmanstrokeoptions.c: moved more code to the new files.

2005-05-19  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picmandashpattern.[ch]: new files with code split out of
	picmanstrokeoptions.c.

	* app/core/picmanstrokeoptions.c: use picman_dash_pattern_from_preset().

2005-05-19  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c: don't allow copy and paste at the same
	time, fixed exit codes.

2005-05-19  Michael Natterer  <mitch@picman.org>

	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/dbbrowser/picmanprocbox.[ch]: removed.

	* plug-ins/dbbrowser/picmanbrowser.[ch]: new widget derived from
	GtkHPaned. Contains lots of common code from the procedure and
	plug-in browsers.

	* plug-ins/dbbrowser/picmanprocbrowser.c
	* plug-ins/dbbrowser/plugin-browser.c: use a PicmanBrowser, lots of
	cleanups.

	* plug-ins/dbbrowser/picmanprocbrowser.c: support all possible search
	types. Addresses bug #301201.

2005-05-18  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c (file_open_dialog_show): set the
	file dialogs transient for the parent window (display or toolbox).

2005-05-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-snap.c: fix compilation on IRIX (bug #304685).

2005-05-18  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell.c: removed the 2px border and
	replaced it with a 1px spacing in the main vbox. Makes the screen
	edges active when working in fullscreen mode (bug #165774).

2005-05-18  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell.c: hack around with gtk+ widget
	styles to get rid of the menubar padding in fullscreen mode.

2005-05-18  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c: implemented pasting.
	s/mime-type/target/g because that's what it is.

2005-05-18  Michael Natterer  <mitch@picman.org>

	* tools/test-clipboard.c: cleanup.

2005-05-18  Michael Natterer  <mitch@picman.org>

	* tools/Makefile.am
	* tools/test-clipboard.c: new file, a test hack for clipboard
	debugging.

2005-05-17  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2.c:
	Trying to be more flexible in register use so the compiler can do
	reloads without running out of registers when using optimisation
	modes other than 2.

	Avoid the message "error: can't find a register in class
	`GENERAL_REGS' while reloading `asm'"

	* app/composite/picman-composite-x86.h
	Use more newlines in asm() macros to ensure that gcc gets the
	instruction count correct.  This is partially complete as of this
	commit.

2005-05-17  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version number to 2.3.1.

2005-05-17  Simon Budig  <simon@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: Make picman_vectors_get_strokes()
	work, add picman_vectors_stroke_translate()  (I am not sure if this
	stays in the API, I am currently testing undo and freeze/thaw
	issues...)

	* app/pdb/internal_procs.c
	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.[ch]: regenerated.

2005-05-17  Simon Budig  <simon@picman.org>

	* app/vectors/picmanvectors.[ch]: added picman_vectors_get_n_strokes ();
	* tools/pdbgen/pdb/vectors.pdb: Attempt to fill an array with IDs,
	does not yet work.

	* app/pdb/vectors_cmds.c
	* libpicman/picmanvectors_pdb.c: regenerated.

2005-05-16  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg-load.c: Don't detach from drawable if
	it belongs to a preview layer.  Fixes bug #304352.

2005-05-16  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/procedural_db.pdb: fixed typo in API docs.

	* app/pdb/procedural_db_cmds.c
	* libpicman/picmanproceduraldb_pdb.c: regenerated.

2005-05-16  Sven Neumann  <sven@picman.org>

	* app/config/picmanxmlparser.c (picman_xml_parser_parse_buffer): check
	encoding being not NULL before accessing it; added gtk-doc comment.

2005-05-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanclipboard.[ch]: added picman_clipboard_has_svg()
	and picman_clipboard_get_svg().

	* app/actions/edit-commands.c (edit_paste_cmd_callback): enabled
	pasting of SVG data using picman_vectors_import_buffer().

2005-05-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c: reverted to working
	versions.  Currently, if you regenerate the installers and
	testers, only those that work on your current machine will be
	generated properly.


2005-05-15  Michael Natterer  <mitch@picman.org>

	* app/pdb/Makefile.am
	* app/pdb/procedural-db-query.[ch]: new files containing all the
	evil string matching and DB dump code.

	* tools/pdbgen/pdb/procedural_db.pdb: removed the evilness here
	and use the new functions.

	* app/pdb/procedural_db_cmds.c: regenerated.

2005-05-14  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c:
	Fixed signedness problems is calls to picman_rgb_to_hsv_int() and the like.

	* app/composite/picman-composite-mmx.[ch]:
	Small fixes to register clobber lists.
	Added picman_composite_subtract_va8_va8_va8_mmx.

	Regenerated

2005-05-14  Sven Neumann  <sven@picman.org>

	* Made 2.3.0 development release.

2005-05-14  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanenums.py: reverted a change that I had
	committed accidentally.

2005-05-14  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.[ch]: register descriptions for the
	PicmanPDBProcType enum.

	* plug-ins/dbbrowser/picmanprocview.c
	* tools/pdbgen/pdb/procedural_db.pdb: get rid of all selfmade
	enum->string mapping. Get the strings from the GType system instead.

	* app/pdb/procedural_db_cmds.c
	* libpicman/picmanproceduraldb_pdb.c: regenerated.

2005-05-13  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2.c:
	Updated with proper register clobber lists.  Some code clean-up
	(removing dead code, commented out code).

2005-05-14  Michael Natterer  <mitch@picman.org>

	* app/pdb/procedural_db.h
	* tools/pdbgen/pdb/procedural_db.pdb: removed pdb_type_name()
	uglyness.

	* app/pdb/procedural_db.c: add private function
	procedural_db_type_name() instead which uses picman_enum_get_value()
	and always returns a newly allocated string. Use it for the error
	messages.

	* app/pdb/procedural_db_cmds.c: regenerated.

2005-05-13  Michael Natterer  <mitch@picman.org>

	* plug-ins/dbbrowser/picmanprocbrowser.c
	* plug-ins/dbbrowser/plugin-browser.c: implement typeahead search
	and get rid of the search buttons in the action area. Cleaned up
	dialog layout and code. Fixes bug #301287.

2005-05-13  Tor Lillqvist  <tml@novell.com>

	* configure.in: Don't bother looking for fd_set on Win32, we won't
	find it in sys/types.h or (the nonexistent) sys/select.h
	anyway. (It's in winsock2.h.)

	* plug-ins/common/xpm.c: Include gdkconfig.h for GDK_WINDOWING_WIN32.

	* plug-ins/script-fu/script-fu-server.c: Give it a chance to work
	on Win32 by covering for the differences between the WinSock and
	Unix socket APIs. Use recv() and send() instead of read() and
	write() on sockets. On Win32, use closesocket() for sockets
	instead of close(). Don't use perror() or look at errno after
	socket API errors on Win32. No EINTR failure mode with WinSock 2.
	(print_socket_api_error): New function. On Unix, just call
	perror(). On Win32, call WSAGetLastError() and produce an
	appropriate error message on stderr.

	* plug-ins/script-fu/Makefile.am (WINSOCK_LIBS): Link with the
	winsock2 library, as we compile with the winsock2 header.

2005-05-13  Michael Natterer  <mitch@picman.org>

	* themes/Default/gtkrc
	* themes/Small/gtkrc: s/PicmanImageDock/PicmanMenuDock/ (Renaming this
	widget apparently was an incompatible change, gtkrc-wise, but I
	think we can live with that...).

2005-05-13  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-ins-query.c (plug_ins_query): don't crash on
	invalid regular expressions.

2005-05-13  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpwrite.c (WriteBMP): added missing brackets.
	Fixes bug #303972.

2005-05-13  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/procedural_db.pdb (procedural_db_query): don't
	crash on invalid regular expressions.

	* app/pdb/procedural_db_cmds.c: regenerated.

2005-05-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontrollerlist.c
	(picman_controller_list_remove_clicked): implement removing of
	controllers, confirmed by a dialog.

	* app/widgets/picmancontrollereditor.c
	(picman_controller_editor_edit_clicked): set an alternative button
	order for the event mapping dialog.

2005-05-12  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: reset the vector tool to Design
	mode whenever a new vectors object gets connected to the tool.
	This time also when you pick a path in Edit mode (Oops).

2005-05-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c: refactoring.

2005-05-12  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanimagedock.c: request notification about changes
	to the "transient-docks" preference and react accordingly.

2005-05-12  Sven Neumann  <sven@picman.org>

	* app/config/picmanguiconfig.[ch]
	* app/config/picmanrc-blurbs.h: added new picmanrc option
	"transient-docks".

	* app/widgets/picmanimagedock.c (picman_image_dock_display_changed):
	as an experiment, obey the "transient-docks" preference and set
	the dock window transient to the active display shell. Please
	comment on the behaviour you observe.

	* app/dialogs/preferences-dialog.c (prefs_dialog_new): added a
	view on the new picmanrc property.

	* app/config/picmanguiconfig.[ch]: set the IGNORE flag on the
	"info-window-per-display" property; it isn't used any longer.

	* app/config/picmanconfig-dump.c (dump_picmanrc_system): don't dump
	properties that have the PICMAN_CONFIG_PARAM_IGNORE flag set.

2005-05-11  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c (jpeg_query): split the message into
	primary and secondary label.

2005-05-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanuimanager.c (picman_ui_manager_find_action): allow
	to pass a NULL group_name and iterate all action groups to find
	the action in that case.

	* app/widgets/picmancontrollereditor.c: show the action's stock icon
	in the "Action" column, using above function.

2005-05-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplay.c: added a read-only property to access
	the display-shell w/o having to include picmandisplay.h.

2005-05-11  Michael Natterer  <mitch@picman.org>

	Some dock refactoring which separates the docking logic from
	active image and UI manager stuff:

	* app/widgets/picmanmenudock.[ch]: new widget renamed from
	PicmanImageDock, zero changes except the name change.

	* app/widgets/picmanimagedock.[ch]: new widget derived from
	PicmanDock. Keeps the UI manager.

	* app/widgets/picmandock.[ch]: removed the UI manager. PicmanDock only
	contains the basic docking logic again.

	* app/widgets/picmanmenudock.[ch]
	* app/widgets/picmantoolbox.[ch]: derive them from PicmanImageDock.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/actions/dialogs-commands.c
	* app/actions/dock-actions.c
	* app/actions/dock-commands.c
	* app/actions/dockable-commands.c
	* app/dialogs/dialogs-constructors.c: changed accordingly.

2005-05-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	also zoom on mouse position if the event originates from the canvas
	(see bug #79384).

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): replaced a g_warning()
	with g_return_if_fail().

2005-05-11  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.c: reset the vector tool to Design
	mode whenever a new vectors object gets connected to the tool.

	Attempt to fix #300663, please report there if you like / dislike
	the new behaviour.

2005-05-11  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_shrink_wrap):
	return silently instead of warning if the window hasn't been
	realized. This happens as part of the setup process if
	"resize-windows-on-zoom" is selected in the prefs.

2005-05-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontrollerinfo.[ch]: added API to set an event
	snooper which, if set, receives any controller event first, even
	if event dispatching is disabled for the controller.

	* app/widgets/picmancontrollereditor.[ch]: use the new API to
	implement a "Grab Event" button, which takes the next event from
	the controller and selects it in the event mapping tree view.

2005-05-10  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontrollerlist.[ch]: some more stuff: up/down
	buttons, remember the dialogs' size and positions, misc stuff.

	* app/widgets/picmancontrollereditor.c
	(picman_controller_editor_edit_clicked): use a PicmanViewableDialog
	now that PicmanControllerInfo is a PicmanViewable.

	* app/dialogs/dialogs.c: added a foreign entry for the controller
	editor dialog. Allow the controller editors and its event mapping
	dialogs to exist multiple times.

	* app/dialogs/preferences-dialog.c (prefs_notebook_append_page):
	create the pages' event boxes with input-only windows.

2005-05-09  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-sse2.c: Repaired a latent bug in
	picman_composite_lighten_rgba8_rgba8_rgba8_sse2 where setting up
	the alpha masks were not done correctly.  A redundant (better?)
	fix to bug #164061

	Use movntq instructions to avoid processor cache pollution.

	Some adjustments to register allocation specifications.

2005-05-09  DindinX  <dindinx@picman.org>

	* plug-ins/common/grid.c: use the correct bounds for the spinners.
	This is related to #114225. Spotted by Lomaxx.

2005-05-09  Sven Neumann  <sven@picman.org>

	* plug-ins/common/tiff.c: sprinkled some const qualifiers.

2005-05-09  Michael Natterer  <mitch@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancontrollerlist.[ch]: new widget which allows
	adding/removing controllers using two lists of available/active
	controllers. Work in progress...

	* app/widgets/picmancontrollerinfo.[ch]: derive it from PicmanViewable
	so it can have an icon (unfinished). Added convenience constructor
	picman_controller_info_new().

	* app/dialogs/preferences-dialog.c: use a PicmanControllerList
	instead of a notebook of PicmanControllerEditors.

2005-05-09  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/Makefile.am: removed traces of plug-ins/common,

2005-05-09  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c: inline tile_manager_get_tile_num().

	* app/display/picmandisplayshell-render.c (render_image_tile_fault):
	reverted one of the changes I did here earlier.

2005-05-08  Sven Neumann  <sven@picman.org>

	* app/dialogs/layer-options-dialog.c (layer_options_dialog_new):
	always set "activates-default" on the name entry.

2005-05-08  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.[ch]: some code cleanup.

2005-05-08  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanpropwidgets.c (picman_prop_entry_new)
	(picman_prop_entry_notify): don't call gtk_entry_set_text() with a
	NULL text.

2005-05-08  Sven Neumann  <sven@picman.org>

	* app/config/picmanbaseconfig.c: limit the tile-cache-size to
	G_MAXULONG or PICMAN_MAX_MEMSIZE, whatever is smaller. Fixes
	bug #303371.

2005-05-07  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/image.pdb: Fix a typo reported in bug #303379.

	* app/pdb/image_cmds.c
	* libpicman/picmanimage_pdb.c: regenerated.

2005-05-07  Sven Neumann  <sven@picman.org>

	* app/actions/edit-commands.c (edit_undo_clear_cmd_callback): tell
	the user how much memory will be freed by clearing the undo history.

2005-05-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpainttool.[ch]
	* app/tools/picmantool.[ch]: unified tool and paint-tool statusbar APIs.

	* app/tools/picmanblendtool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancolortool.c
	* app/tools/picmancroptool.c
	* app/tools/picmaneditselectiontool.c
	* app/tools/picmanfuzzyselecttool.c
	* app/tools/picmanmeasuretool.c
	* app/tools/picmanmovetool.c
	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.c
	* app/tools/picmanrectselecttool.c
	* app/tools/picmanvectortool.c: changed accordingly.

	* app/tools/picmanselectiontool.c: give more hints in the statusbar.
	Some of the selection tools should probably override these.

2005-05-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanpreviewcache.c: minor code cleanup.

2005-05-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanselectionoptions.c: added modifier keys to the
	tooltips of the selection mode buttons.

	* app/dialogs/preferences-dialog.c: removed the GUI for the
	"default-threshold" preference.

	* app/tools/picmanmagnifyoptions.c: removed the GUI for the
	Threshold option; it was more confusing than useful.

	* app/config/picmanguiconfig.c: changed the default value for
	"save-tool-options" to FALSE. This is a major source of confusion;
	let's try if disabling it is an improvement.

2005-05-07  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/psd.c: add comments describing thumbnail resource.

2005-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.c
	* plug-ins/winicon/main.c: added a thumbnail loader for .ico files
	Fixes bug #158191.

2005-05-07  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.[ch]
	* plug-ins/winicon/main.c: code cleanup, prepare for thumbnail
	loading.

2005-05-06  Sven Neumann  <sven@picman.org>

	* app/actions/layers-actions.c
	* app/core/picmanimage.c (picman_image_position_layer)
	* app/widgets/picmanlayertreeview.c (picman_layer_tree_view_drop_possible):
	drop the limitation that layers not at the bottom of the stack
	have to have an alpha channel. Allow the user to move the
	background layer up in the stack or reposition it using DND.

	* tips/picman-tips.xml.in: changed the relevant tip and some more.

2005-05-06  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/compressor.c: use G_DIR_SEPARATOR instead of '/'.

	* plug-ins/common/mail.c: ditto. Fixed some coding style issues.
	Special case .bz2 files just as .gz ones.

2005-05-06  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-merge.c: removed redundant casts.

2005-05-06  Michael Natterer  <mitch@picman.org>

	* app/actions/gradient-editor-commands.h: added enum for the
	"load_color" actions.

	* app/actions/gradient-editor-actions.c
	* app/actions/gradient-editor-commands.c: use the new enum instead
	of magic values, cleanup.

	* app/actions/palette-editor-commands.c: cleanup.

	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmandataeditor.c: cleanup.

	* app/widgets/picmangradienteditor.c: added GtkObject::destroy() and
	GtkWidget::unmap() implementations which destroy the color dialog.
	Destroy color dialogs by cancelling them via gtk_dialog_response(),
	so temporarily changed colors are restored correctly. Refactored
	my last commit below a bit. Various cleanups.

	* app/widgets/picmanpaletteeditor.[ch]: no need to remember the
	buttons in the PicmanPaletteEditor struct.

2005-05-06  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c
	(picman_display_shell_scale_by_values): abort early if the values are
	all setup already. Fixes bug #164281.

2005-05-06  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-sse2.c
	(picman_composite_lighten_rgba8_rgba8_rgba8_sse2): applied a patch
	from Joao S. O. Bueno Calligaris that changes the SSE2 code to
	load the proper register. Fixes bug #164061.

2005-05-05  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmangradienteditor.c (control_draw)
	(control_draw_normal_handle)
	(control_draw_middle_handle): changed handle colors to be always
	black and white. Fixes bug #303118. Also changed the handle bar's
	background and the handles' outlines to theme colors which should
	make the handles distinguishable from the background for all
	themes.

	Various unrelated cleanups.

2005-05-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc-def.[ch] (plug_in_proc_def_find): new
	function which finds a proc_def in a GSList by its procedure name.

	* app/plug-in/plug-in-message.c
	* app/plug-in/plug-ins.c
	* tools/pdbgen/pdb/plug_in.pdb: use it instead of iterating and
	comparing manually.

	* app/pdb/plug_in_cmds.c: regenerated.

	* app/plug-in/plug-in-def.c: minor cleanups.

2005-05-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfgbgeditor.c (picman_fg_bg_editor_button_press):
	emit "color-clicked" on first click.

	* app/widgets/picmantoolbox.c: changed tooltip accordingly.

2005-05-04  Michael Natterer  <mitch@picman.org>

	* app/plug-in/plug-in-proc-def.[ch] (plug_in_proc_def_set_icon):
	new function.

	* tools/pdbgen/pdb/plug_in.pdb: removed the same code here and use
	the new function.

	* app/pdb/plug_in_cmds.c: regenerated.

2005-05-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolordisplayeditor.h: include the parent class,
	not picmaneditor.h

	* app/widgets/picmancolordisplayeditor.c: include picmaneditor.h here

2005-05-03  Sven Neumann  <sven@picman.org>

	* plug-ins/pypicman/picmanfu.py (progress_update): special case
	percentage < 0 and pulse progress.

2005-04-30  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c: applied a patch from David Costanzo that
	adds missing error handling to the BMP loader, allowing it to deal
	gracefully with incomplete BMP image files.

2005-04-29  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icodialog.c
	* plug-ins/winicon/icosave.c: changed dialog layout.

2005-04-29  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/enumcode.pl: declared function array as const.

	* libpicman/picmanenums.c.tail: regenerated.

2005-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection-construct.c (picman_projection_construct):
	use copy_region() instead of using tile_manager_map_over_tile()
	directly.

2005-04-29  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmessagebox.c (picman_message_box_init): unset
	"can-focus" on the message labels. Fixes bug #302400.

2005-04-29  Sven Neumann  <sven@picman.org>

	* app/core/picmanprojection-construct.c: save COW projection code from
	bit-rotting. It can now be enabled again (but is definitely broken).

2005-04-28  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/clothify.py: don't reset the passed
	parameters to default values. Spotted by Joao S. O. Bueno Calligaris.

2005-04-28  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.h: corrected variable names.

2005-04-28  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-load.c (load_image): detach from the drawable.

2005-04-28  Sven Neumann  <sven@picman.org>

	* app/core/picmantemplate.c (picman_template_create_image): fill the
	layer before adding it to the image.

2005-04-28  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c (render_image_rgb): fixed
	an oversight from yesterday's changes.

2005-04-28  Sven Neumann  <sven@picman.org>

	* app/core/picmanunit.c
	* libpicman/picmanunitcache.c: built-in units are const.

2005-04-28  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: spare a few CPU cycles.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/base/tile-manager.c (tile_manager_get_tile): removed
	redundant check.

	* app/display/picmandisplayshell-render.c: don't access the next
	tile if we are at the end of the render loop anyway.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-render.c: removed unused byte_order
	variables.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-colormap.[ch]: declared the return value of
	picman_image_get_colormap() as const.

	* app/display/picmandisplayshell-render.c: added some const qualifiers.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.c (picman_clipboard_free): free all
	memory allocated for PicmanClipboard.

	* libpicmanwidgets/picmanpatheditor.c (picman_path_editor_set_path):
	always free old_path.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanunitstore.c: don't call va_arg() too often.

	* libpicmanconfig/picmancolorconfig.c (picman_color_config_finalize):
	free the string allocated for the display module.

2005-04-27  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/image.pdb: plugged a small memleak.

	* app/pdb/image_cmds.c: regenerated.

2005-04-27  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: added more standard keybindings.

2005-04-27  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/metadata.c: don't mark the menu identifier for
	translation.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.[ch]: applied a patch from Aron
	Stansvik that adds actions to control hue, saturation and value
	of the foreground and background colors.

2005-04-27  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: use the same terms for the
	checkerboard parameters as used in the PicmanPreviewArea popup menu
	(bug #302141).

2005-04-26  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: reviewed strings, simplified
	if possible.

2005-04-26  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colortoalpha.c: use the standard order of
	"static" and "inline" qualifiers.

2005-04-25  DindinX  <dindinx@picman.org>

	* plug-ins/common/colortoalpha.c: update the preview continuously
	when the color changes in the color selector.

2005-04-25  Michael Natterer  <mitch@picman.org>

	* app/app_procs.c (app_libs_init): call g_thread_init() only if
	the GThread system is not already initialized.

2005-04-25  Sven Neumann  <sven@picman.org>

	* app/file/picmanrecentlist.c (picman_recent_list_add_item): close the
	file descriptor if we fail to obtain the lock (bug #151767).

2005-04-25  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-proc-def.h: added a boolean flag to the
	ProcDef struct to identify file procedures.

	* app/xcf/xcf.c: changed accordingly.

	* app/plug-in/plug-ins.c: look at the new flag instead of checking
	extensions, prefixes and magics being non-NULL. A file plug-in
	doesn't necessarily have any of these fields set.

	* app/plug-in/plug-in-rc.c: changed pluginrc format to contain an
	extra section for file procedures. Moved all file related info there.

2005-04-25  Manish Singh  <yosh@picman.org>

	* plug-in/common/tiff.c: Only store compression types we can actually
	handle in the save options parasite. Fixes bug #301557.

2005-04-24  Sven Neumann  <sven@picman.org>

	* app/base/temp-buf.c (generate_unique_tmp_filename): removed the
	local pid_t variable and the msvc definition for it.

2005-04-24  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/fileops.pdb
	* app/pdb/fileops_cmds.c: spelling.

2005-04-24  Hans Breuer  <hans@breuer.org>

	* menus/makefile.msc : build menus with nmake, too
	* menus/Makefile.am : added to EXTRA_DIST

	* **/makefile.msc app/picmancore.def : updated

	* app/base/temp-buf.c : there is no pid_t with msvc so typedef one

2005-04-23  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c (picman_drawable_preview_draw_thumb):
	respect the selection (fixes bug #301523).

2005-04-23  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-schemas.[ch]: Added definition of
	properties from IPTC Core XMP schema (Iptc4xmpCore).

	* plug-ins/metadata/base64.[ch]: Added option to ignore invalid
	characters in base64 encoded text.

	* plug-ins/metadata/xmp-encode.c
	* plug-ins/metadata/xmp-parse.c
	* plug-ins/metadata/testbase64.c: Updated accordingly.

2005-04-22  Sven Neumann  <sven@picman.org>

	* configure.in
	* plug-ins/common/Makefile.am
	* plug-ins/common/plugin-defs.pl
	* plug-ins/common/winclipboard.c: removed winclipboard plug-in
	from CVS. It is not any longer needed as long as GTK+ >= 2.6.5
	is being used. Fixes bug #165219.

2005-04-22  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmp-model.[ch]: Fixed crash occuring after a
	double free of some structured XMP properties.  Added new type
	XMP_TYPE_GENERIC_STRUCTURE for unknown structured properties.  Be
	more tolerant in parsing incorrectly written schema URIs and try
	to extract a valid URI from them.  Converted to use g_print().
	Moved the definitions of standard XMP schemas from here...

	* plug-ins/metadata/xmp-schemas.[ch]: ...to these new files.

	* plug-ins/metadata/xmp-encode.[ch]: Rewritten using GString
	instead of fixed buffers.

	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/interface.c: Adapted to the new function
	xmp_generate_block() using GString.

	* plug-ins/metadata/base64.c (base64_encode): Fixed incorrect
	encoding of bytes with the sign bit set.

	* plug-ins/metadata/testbase64.c
	* plug-ins/metadata/Makefile.am: Added xmp-schema.[ch] and test
	program testbase64.c (testing base64 encoding and decoding).

	* plug-ins/metadata/xmpdump.c: Converted to use g_print().

	* plug-ins/metadata/xmp-parse.c: Added some #ifdef's around
	debugging code, added more comments.

2005-04-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbaseenums.h (PicmanTransformDirection): removed
	(traditional) and (corrective) from the enum descriptions.

2005-04-22  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintstore.c: removed the "row_deleted" handler
	which used to take care of reinserting the "Empty" item when the
	last row gets deleted. This doesn't work any longer with GTK+ 2.6
	and I see no way to make it work again. Fixes bug #301524.

2005-04-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.[ch]: removed Close button from
	dockables as suggested in bug #301348.

2005-04-21  Manish Singh  <yosh@picman.org>

	* plug-ins/common/postscript.c: pass -dUseCropBox when loading PDF
	files, to match Acrobat Reader's behavior in honoring CropBox over
	MediaBox. Fixes bug #301432.

2005-04-21  Sven Neumann  <sven@picman.org>

	* plug-ins/dbbrowser/picmanprocview.c: make more labels selectable.

2005-04-21  Nathan Summers  <rock@picman.org>

	* data/images/picman-splash.png: removed flare effect

2005-04-20  Nathan Summers  <rock@picman.org>

	* data/images/picman-splash.png: new splash

2005-04-20  Sven Neumann  <sven@picman.org>

	* plug-ins/Lighting/images/Makefile.am
	* plug-ins/gfig/images/Makefile.am
	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/imagemap/images/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/rcm/images/Makefile.am: use $(GDK_PIXBUF_CSOURCE) as
	defined by the configure script.

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/wilber-reading.png: added icon.

	* plug-ins/helpbrowser/picmanthrobber.[ch]: added API to set an image
	to be used instead of the stock-id.

	* plug-ins/helpbrowser/dialog.c: use the Reading Wilber icon for
	the throbber and as window icon.

2005-04-20  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.c
	* themes/Default/images/Makefile.am: reverted the change to
	register a wilber icon in button size; it broke the color selector.

2005-04-20  Sven Neumann  <sven@picman.org>

	* libpicmancolor/picmanrgb-parse.c: fixed typos in comments.

2005-04-20  Sven Neumann  <sven@picman.org>

	* libpicman/picmanui.c (picman_ensure_modules): cosmetics.

2005-04-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mail.c: set charset to UTF-8. Initialize the
	filename from the image's filename. Don't set From: if the Sender
	entry remains blank. Reordered dialog.

2005-04-20  Michael Natterer  <mitch@picman.org>

	* app/xcf/xcf-load.c (xcf_load_layer): initialize text_layer_flags
	with 0 so it doesn't contain random garbage if the text layer
	flags in the XCF have default values (are not saved at all). Fixes
	bug #301028. Initialize other stuff too for the sake of sanity.

2005-04-19  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/color.pdb: applied patch from Karine Delvare
	which adds picman_desaturate_full(). Fixes bug #155507.

	* app/pdb/color_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmancolor_pdb.[ch]: regenerated.

	* libpicman/picman.def: added the new symbol.

2005-04-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-snap.c: bail out early if the coords are
	out-of-image plus a border of the snapping epsilon, and not just
	out-of-image. Fixes bug #169892.

2005-04-18  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmansizeentry.c: #include picmanwidgets.h for
	picman_spin_button_new().

	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/metadata/interface.c
	* plug-ins/metadata/xmp-parse.c: 64-bit safety for some of the
	debugging g_prints.

2005-04-18  Manish Singh  <yosh@picman.org>

	* plug-ins/common/newsprint.c: Redo comment for spot_PSsquare
	and spot_PSdiamonds, since the code was not a derived work in
	the copyright sense. It is a C implementation of the same
	algorithm.

2005-04-18  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/common/newsprint.c: Added comment to clarify the
	copyright notice (bug #301076).

2005-04-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage.c (picman_image_real_colormap_changed):
	invalidate layer previews when the colormap changes. Fixes
	bug #301033.

2005-04-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmansamplepointeditor.[ch]: Connect to the
	PicmanImage::update-sample-point and PicmanProjection::update signals
	and idle-pick colors at the sample points' coordinates.
	Addresses bug #137776.

2005-04-18  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: restrict the menus to 15 items.

2005-04-18  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/base64.[ch]: Added parameter 'columns' to
	base64_encode() to add optional line breaks in the output.
	Improved documentation.

2005-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: workaround a GTK+ bug to make the
	tooltips for the Back and Forward buttons appear.

2005-04-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.c: use picman_spin_button_new() which
	calls gtk_spin_button_set_numeric() for us. Part of a fix for bug
	#300935.

	* libpicmanwidgets/picmanwidgets.c: improved the API docs for
	picman_spin_button_new().

	* app/tools/picmancolorbalancetool.c
	* app/tools/picmanlevelstool.c
	* plug-ins/common/screenshot.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/rcm/rcm_dialog.c
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/winsnap/winsnap.c: use picman_spin_button_new().

2005-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: set a busy cursor while loading a
	page. Offer drags as "text/uri-list" in addition to "_NETSCAPE_URL".

2005-04-17  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanstock.c
	* themes/Default/images/Makefile.am: register a wilber icon in
	button size.

	* plug-ins/helpbrowser/picmanthrobber.c: choose a slightly larger
	icon than the configured size for toolbars.

2005-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: added actions to zoom in/out.

	* plug-ins/helpbrowser/picmanthrobberaction.[ch]: fixed handling of
	overflow menu items.

2005-04-17  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/helpbrowser/picmanthrobber.[ch]
	* plug-ins/helpbrowser/picmanthrobberaction.[ch]: new files
	implementing a custom GtkToolItem and a GtkAction to use it.

	* plug-ins/helpbrowser/dialog.c: use the new widget.

2005-04-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanaction.h
	* app/widgets/picmanactiongroup.h
	* app/widgets/picmancellrendereraccel.h
	* app/widgets/picmanenumaction.h
	* app/widgets/picmanpluginaction.h
	* app/widgets/picmanstringaction.h
	* app/widgets/picmanuimanager.h: declare get_type() function as
	G_GNUC_CONST.

2005-04-17  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/guides-new-percent.scm
	* plug-ins/script-fu/scripts/guides-new.scm: don't use undo
	groups. It's useless for a single operation and it's wrong to use
	the undo group unconditionally, but add the guides conditionally.

2005-04-16  Michael Natterer  <mitch@picman.org>

	* app/core/picmancontext.c (picman_context_real_set_brush)
	(picman_context_real_set_pattern): no need to get base_config twice
	in the same function.

	* app/widgets/picmanblobeditor.h: include the parent class.

	* app/widgets/picmandataeditor.c (picman_data_editor_init): set the
	name entry insensitive.

2005-04-16  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandataeditor.[ch]: implement
	PicmanDocked::get_title() and add "(read only)" to the dialog's
	title if the data is not editable. Fixes bug #164003.

	(picman_data_editor_real_set_data): call picman_docked_title_changed()
	when the editable state changes.

	(struct PicmanDataEditorClass): added "const gchar *title" member.

	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanpaletteeditor.c (class_init): set titles.

2005-04-16  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbase.def: added picman_desaturate_mode_get_type.

2005-04-16  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: use a PicmanFileEntry to
	configure the web-browser setting. GtkFileChooserButton just
	doesn't work for it.

2005-04-16  Michael Natterer  <mitch@picman.org>

	* plug-ins/helpbrowser/dialog.c: removed the "Close" button and
	added a "Wilber" button instead which opens the online docs in the
	web browser. Added accelerators ctrl+w and ctrl+q which close the
	help browser.

	* plug-ins/helpbrowser/queue.[ch]: updated my email address.

2005-04-16  Sven Neumann  <sven@picman.org>

	* app/dialogs/desaturate-dialog.c: added an icon to the action
	button.

	* app/vectors/picmanvectors-import.c: reduce the number of string
	comparisons by using switches on the first character.

2005-04-16  Sven Neumann  <sven@picman.org>

	Applied a patch (with minor modifications) from Karine Delvare
	that makes it possible to choose between various ways to remove
	color from a drawable (bug #155507):

	* libpicmanbase/picmanbaseenums.h: added new enum PicmanDesaturateMode.

	* libpicmanbase/picmanbaseenums.c
	* libpicman/picmanenums.c.tail
	* plug-ins/pypicman/picmanenums.py
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmandrawable-desaturate.[ch]: implement other formulas
	to remove colors from a drawable.

	* tools/pdbgen/pdb/color.pdb: let picman_desaturate() call
	picman_drawable_desaturate() with PICMAN_DESATURATE_LIGHTNESS so that
	it behaves like it always did.

	* app/pdb/color_cmds.c: regenerated.

	* app/dialogs/Makefile.am
	* app/dialogs/desaturate-dialog.[ch]: new files that define a simple
	dialog to choose a mode for desaturation.

	* app/actions/drawable-actions.[ch]: use the new dialog.

2005-04-16  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/vectors.pdb: let pdbgen create the code to
	initialize the variables.

	* app/pdb/vectors_cmds.c: regenerated.

2005-04-15  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c
	* plug-ins/helpbrowser/queue.[ch]: finished menu implementation.

2005-04-15  Manish Singh  <yosh@picman.org>

	* plug-ins/helpbrowser/queue.c: call has_next/prev functions with
	arguments.

2005-04-15  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c
	* plug-ins/helpbrowser/queue.[ch]: added menu toolbar buttons; not
	functional yet.

2005-04-15  Michael Natterer  <mitch@picman.org>

	Added loading of Photoshop brushes. Fixes bug #163047:

	* app/core/Makefile.am
	* app/core/picmanbrush-load.[ch]: new files holding all brush
	loading code. Added .abr loader based on a patch by Adrian
	Likins. Didn't add a new brush subclass as in the original patch,
	but only a loading function which loads the brushes into standard
	PicmanBrush objects. Did misc fixes to the code, needs further
	cleanup.

	* app/core/picmanbrush.[ch]: removed brush loading code here.

	* app/core/picmanbrushpipe.c: changed #includes accordingly.

	* app/core/picman.c (picman_real_initialize): register the new load
	functions and their extensions with the brush factory.

2005-04-15  Simon Budig  <simon@picman.org>

	* app/tools/picmannewrectselecttool.c: NULLified the Keyboard
	Shortcut for the new rect select tool (clash with the Crop tool).

2005-04-14  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: added a simple right-click menu.

2005-04-14  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_cmd_unselect_all.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_object_popup.c: removed bunch of
	compilation warnings (spotted by Sven Neumann).

2005-04-14  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawable.[ch] (picman_drawable_get_tile)
	(picman_drawable_get_tile2): cleanup gint/gboolean confusion (spotted
	by Maurits Rijk).

2005-04-14  Sven Neumann  <sven@picman.org>

	* plug-ins/helpbrowser/dialog.c: use a GtkUIManager to construct the
	toolbar.

	* plug-ins/ifscompose/ifscompose.c: use gtk_action_set_sensitive().

2005-04-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/dialogs/image-new-dialog.c
	* app/dialogs/image-scale-dialog.c
	* app/widgets/gtkhwrapbox.c
	* app/widgets/gtkvwrapbox.c: s/choosen/chosen/g; fixes bug #300608.

2005-04-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.c (picman_display_shell_set_property):
	don't call picman_display_shell_scale() if the display isn't
	completely setup yet.

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	hack around to find out whether we should pass the pointer location
	or the center of the display to picman_display_shell_scale_to().

2005-04-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale):
	changed to use the location of the pointer instead of the display
	center. This is the behaviour requested in bug #79384.

2005-04-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scale.[ch]: reduced code duplication.

2005-04-14  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-scale.c (picman_display_shell_scale_to):
	changed to keep the point under the mouse at the same location,
	rather than to center it. Also added API docs.

2005-04-14  Simon Budig  <simon@picman.org>

	Started a PDB api for vectors/strokes. Not yet functional, this
	commit is to get the infrastructure up and running.

	* app/vectors/picmanstroke.[ch]
	* app/vectors/picmanvectors.[ch]: Added IDs to the strokes

	* tools/pdbgen/pdb.pl: corrected "vectors" type, deleted "path" type.
	* tools/pdbgen/pdb/image.pdb: added picman_image_get_vectors()
	* tools/pdbgen/pdb/vectors.pdb: New file for the vectors API
	(just a stub for now)

	* tools/pdbgen/Makefile.am: Added vectors.pdb
	* tools/pdbgen/groups.pl: regenerated.

	* plug-ins/script-fu/siod-wrapper.c: Enable the Path/Vectors type.

	* libpicman/picmanvectors_pdb.[ch]
	* app/pdb/vectors_cmds.c: new autogenerated files.

	* libpicman/Makefile.am
	* app/pdb/Makefile.am: Added new autogenerated file.

	* libpicman/picman_pdb.h
	* libpicman/picmanimage_pdb.[ch]
	* app/pdb/image_cmds.c
	* app/pdb/internal_procs.c: regenerated.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c: fixed gtk-doc comment.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-scale.[ch]: when using Ctrl-wheel
	to zoom in/out, center on the mouse position (bug #79384).

2005-04-13  Adi Attar  <aattar@cvs.gnome.org>

	* configure.in: Added "xh" to ALL_LINGUAS.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c: set PICMAN_CONFIG_PARAM_CONFIRM on
	the "font-path" property. Set PICMAN_CONFIG_PARAM_IGNORE for
	"font-path-writable".

	* app/dialogs/preferences-dialog.c: don't use "font-path-writable".

	* app/core/picman.c (picman_restore)
	* app/text/picman-fonts.c: handle --no-fonts similar to --no-data
	and allow to load the fonts later by pressing "Refresh" in the
	fonts dialog.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/app_procs.c: register handler for the "PicmanPaint" log domain.

	* app/core/picmandatafactory.c (picman_data_factory_init): don't load
	any data if TRUE is passed for no_data.

	* app/tools/picmanpainttool.c (picman_paint_tool_draw): handle a NULL
	brush gracefully.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): handle a NULL
	palette with PICMAN_CUSTOM_PALETTE type, use the builtin mono
	palette as fallback.

	* app/dialogs/convert-dialog.c: handle empty palette container.

	* app/gui/gui-vtable.c (gui_pdb_dialog_new): removed unused code.

	* tools/pdbgen/pdb/convert.pdb: don't load the palettes implicitely.

	* app/pdb/convert_cmds.c: regenerated.

2005-04-13  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanimagedock.c (picman_image_dock_image_changed):
	don't use the image container as display container.

2005-04-13  Sven Neumann  <sven@picman.org>

	* app/core/picmandatafactory.[ch]: added picman_data_factory_refresh().

	* app/actions/data-commands.c
	* tools/pdbgen/pdb/brushes.pdb
	* tools/pdbgen/pdb/convert.pdb
	* tools/pdbgen/pdb/gradients.pdb
	* tools/pdbgen/pdb/palettes.pdb
	* tools/pdbgen/pdb/patterns.pdb: use the new function.

	* app/pdb/brushes_cmds.c
	* app/pdb/convert_cmds.c
	* app/pdb/gradients_cmds.c
	* app/pdb/palettes_cmds.c
	* app/pdb/patterns_cmds.c: regenerated.

2005-04-12  Sven Neumann  <sven@picman.org>

	* app/core/picmancontainer.[ch]: added picman_container_is_empty().

	* app/core/picmancontext.c
	* app/core/picmanimage.c
	* app/dialogs/palette-import-dialog.c
	* app/text/picmantextlayer.c
	* app/widgets/picmanimagedock.c: use the new function.

2005-04-12  Michael Natterer  <mitch@picman.org>

	* app/core/picman-transform-utils.c
	(picman_transform_matrix_perspective): undo the "cosmetic changes"
	of 2005-03-20. Fixes bug #300269.

2005-04-12  Raphaël Quinet  <raphael@picman.org>

	* configure.in: updated test for libjpeg so that it requires
	version 6b (27-Mar-1998) or later.

	* plug-ins/jpeg/jpeg.h
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.h
	* plug-ins/jpeg/jpeg-save.c: added support for loading and saving
	XMP packets in JPEG APP1 markers, simplified the code that reads
	comments from COM markers and removed #ifdef HAVE_PROGRESSIVE_JPEG
	because we require jpeg-6b, which includes progressive support.

2005-04-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_shade.c:  Fix typo responsible for
	bug #300122, also revise env-mapping code to make it perform
	better.

2005-04-11  DindinX  <dindinx@picman.org>

	* plug-ins/common/convmatrix.c: small cleanups, more will come.

2005-04-11  Michael Natterer  <mitch@picman.org>

	Let the user decide whether tool options are persistant or not as
	suggested in bug #165078:

	* app/config/picmanrc-blurbs.h
	* app/config/picmanguiconfig.[ch]: added "gboolean save_tool_options".

	* app/tools/picman-tools.[ch]: implement the same logic as for
	devicerc and sessionrc: added picman_tools_clear() which deletes the
	stored tool options and added "save_tool_options" and
	"always_save" parameters to picman_tools_save(). Everything affects
	just the primary tool options, *not* the separately saved presets
	for each tool.

	* app/gui/gui.c (gui_exit_callback): changed accordingly.

	* app/dialogs/preferences-dialog.c: added GUI for the stuff above
	in the style of the devicerc and seccionrc prefs GUIs.

2005-04-11  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/base64.h
	* plug-ins/metadata/base64.c: Added implementation of
	base64_encode(), use gsize or gssize for sizes.

2005-04-11  Raphaël Quinet  <raphael@picman.org>

	* plug-ins/metadata/metadata.c: Register plug_in_metadata_import
	and plug_in_metadata_export in the PDB.

	* plug-ins/metadata/Makefile.am
	* plug-ins/metadata/base64.h
	* plug-ins/metadata/base64.c: Added base64 decoder, needed for
	reading the thumbnail images (base64 encoded inside XML element).

	* plug-ins/metadata/xmp-parse.h
	* plug-ins/metadata/xmp-parse.c: Added XMP_PTYPE_ALT_THUMBS for
	parsing a list of thumbnail images.  Decode and store the base64
	encoded images.

	* plug-ins/metadata/xmpdump.c
	* plug-ins/metadata/xmp-model.h
	* plug-ins/metadata/xmp-model.c: Added support for thumbnails,
	defined global symbols for standard XMP schema URIs.

	* plug-ins/metadata/interface.c: Preliminary support for widget
	cross-references just for testing - it does not save anything yet.
	Added thumbnail tab, although the thumbnail image is not displayed
	yet.

2005-04-11  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanclipboard.c: don't include "core/picmanviewable.h"

2005-04-11  Sven Neumann  <sven@picman.org>

	* app/tools/picmanfuzzyselecttool.c: added a hint to the statusbar.
	Closes bug #300125.

2005-04-10  DindinX  <dindinx@picman.org>

	* plug-ins/common/convmatrix.c: added a preview, but this plug-in
	certainly need some more work.

2005-04-10  DindinX  <dindinx@picman.org>

	* plug-ins/common/convmatrix.c: preliminary cleanup before
	implementing a preview.

2005-04-10  Sven Neumann  <sven@picman.org>

	* app/actions/drawable-commands.h: removed duplicate function
	declarations (spotted by Karine Delvare).

2005-04-10  Sven Neumann  <sven@picman.org>

	Merged from picman-2-2 branch:

	* plug-ins/print/print.c: reverted the previous change, it was wrong
	(see bug #169909).

2005-04-10  Michael Natterer  <mitch@picman.org>

	* app/file/file-utils.c
	* app/tools/picmanfliptool.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanpaletteselect.c: removed unneeded base/ includes.

2005-04-09  Sven Neumann  <sven@picman.org>

	Merged from picman-2-2 branch:

	* menus/Makefile.am
	* tips/Makefile.am: changed the validate rules to work with srcdir
	!= builddir.

2005-04-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanbuffer.[ch]: added picman_buffer_new_from_pixbuf().

	* app/widgets/picmanclipboard.c: removed
	tile_manager_new_from_pixbuf() and base/ dependency.

2005-04-09  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanpixbuf.c: #include <string.h> for strcmp, and
	fix gdk_atom_intern usage.

2005-04-09  Sven Neumann  <sven@picman.org>

	* plug-ins/print/print.c: quote the shell command passed to execl().
	Fixes bug #169909.

2005-04-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmannewrectselecttool.[ch]
	* app/tools/picmanrectangletool.[ch]: more work on rectangle
	tool ui.

2005-04-09  Michael Natterer  <mitch@picman.org>

	Implement dragging and dropping in any GdkPixbuf supported format.
	Fixes bug #172794 and bug #172795.

	* app/core/picmanlayer.[ch] (picman_layer_new_from_region): new
	function which contains all stuff that was in
	picman_layer_new_from_tiles().

	(picman_layer_new_from_tiles): use above function.
	(picman_layer_new_from_pixbuf): new function.

	* app/widgets/Makefile.am
	* app/widgets/picmanpixbuf.[ch]: new files containing GdkPixbuf
	utility functions for clipboard and DnD.

	* app/widgets/picmanselectiondata.[ch]: removed
	picman_selection_data_set,get_pixbuf(), GTK+ provides the same API.
	Also removed GdkAtom parameters all over the place because it's
	always the same as selection_data->target.

	* app/widgets/picmanclipboard.c: use the new pixbuf utility
	functions and gtk_selection_data_set,get_pixbuf().

	* app/widgets/widgets-enums.h
	* app/widgets/picmandnd.[ch]: removed never-implemented
	PICMAN_DND_TYPE_PNG and added a generic PICMAN_DND_TYPE_PIXBUF
	instead. Added API to drag and drop GdkPixbufs which transparently
	converts from/to any GdkPixbuf-supported image format. Removed
	passing around of GdkAtoms, since they were always the same
	as selection_data->target.

	* app/widgets/picmandnd-xds.[ch]: follow GdkAtom parameter removal.

	* app/widgets/picmancontainertreeview.[ch]: added virtual function
	PicmanContainerTreeView::drop_pixbuf().

	* app/widgets/picmancontainertreeview-dnd.c: dispatch drop_pixbuf().

	* app/widgets/picmanlayertreeview.c: implement drop_pixbuf().

	* app/widgets/picmandrawabletreeview.c: allow to drag all drawables
	as pixbufs.

	* app/display/picmandisplayshell-dnd.c: allow dropping of pixbufs.

2005-04-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: Change default back to Window
	rather than Root.  When shooting window, delay after instead
	of before selecting, so shooting menus etc becomes possible.

2005-04-09  Manish Singh  <yosh@picman.org>

	* plug-ins/common/gifload.c (GetCode): GetDataBlock returns -1 on
	error, so count should be an int, not an unsigned char. Fixes
	bug #173119.

2005-04-09  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icosave.c: implement color counting without
	changing the image-type to RGB. A save plug-in must not change the
	image.

2005-04-08  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icodialog.c: rewrote preview code to use
	GtkImage and pixbufs. The previous implementation was severily
	broken.

	* plug-ins/winicon/icosave.c: cosmetics.

2005-04-08  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icoload.c: code cleanup, no real changes.

2005-04-08  Simon Budig  <simon@picman.org>

	* app/tools/picmanvectortool.[ch]: Applied Patch by Sven Neumann
	to use the new statusbar functionality.

2005-04-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/animationplay.c: coding style, no real changes.

2005-04-08  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gauss.c: fixed preview for zero blur radii
	(bug #173039).

2005-04-08  Sven Neumann  <sven@picman.org>

	* app/base/base.c: include libpicmanbase/picmanwin32-io.h.

2005-04-07  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-path.c: added API documentation.

2005-04-07  Sven Neumann  <sven@picman.org>

	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c: need to free the return value of
	picman_config_build_foo_path() now that picman_param_spec_path() is
	sane and doesn't take ownership of the passed string any longer.

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/utils.c: use picman_config_build_data_path().

	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/common/CML_explorer.c
	* plug-ins/common/channel_mixer.c
	* plug-ins/common/curve_bend.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/flame/flame.c
	* plug-ins/picmanressionist/brush.c
	* plug-ins/ifscompose/ifscompose.c
	* plug-ins/imagemap/imap_browse.c
	* plug-ins/imagemap/imap_file.c
	* plug-ins/print/picman_main_window.c: set alternative button order
	on file-chooser dialogs (as well as default response where missing).

2005-04-07  Sven Neumann  <sven@picman.org>

	* docs/picman.1.in: fixed typos and improved explanation of parasiterc.

2005-04-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolorframe.c
	(picman_color_frame_set_color) (picman_color_frame_set_invalid): only
	update the view if there's actually a change.

2005-04-07  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-utils.[ch]: changed PicmanConfig utility
	functions to take GObject variables instead of PicmanConfig. There's
	nothing PicmanConfig specific about these utilities.

	* app/actions/templates-commands.c
	* app/actions/tool-options-commands.c
	* app/base/base.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanrc.c
	* app/config/picmanrc-serialize.c
	* app/core/picmanimage-grid.c
	* app/core/picmanimage-new.c
	* app/core/picmanstrokedesc.c
	* app/dialogs/grid-dialog.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/display/picmandisplayshell.c
	* app/text/picmantextlayer.c
	* app/text/picmantextundo.c
	* app/tools/picmantextoptions.c
	* app/tools/picmantexttool.c:
	* libpicmanconfig/picmanconfig-iface.c: changed accordingly.

2005-04-07  Sven Neumann  <sven@picman.org>

	* app/actions/plug-in-actions.c (plug_in_actions_add_branch)
	* app/core/picmaninterpreterdb.c (resolve_extension)
	* app/widgets/picmancolorframe.c (picman_color_frame_update): plugged
	memleaks.

2005-04-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmessagebox.c: plugged a small memleak.

	* libpicmanwidgets/picmancontroller.c: added a finalizer and free the
	allocated strings.

2005-04-06  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-utils.[ch]: added new function to reset
	a single property to its default value.

	* libpicmanconfig/picmanconfig.def: updated.

	* app/config/picmanbaseconfig.[ch]: reverted last change.

	* app/base/base.c: use picman_config_reset_property() instead.

2005-04-06  Sven Neumann  <sven@picman.org>

	* app/Makefile.am: don't use -mwindows when linking picman-console.

2005-04-06  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-path.[ch] (picman_param_spec_config_path):
	declare default_value as const and allocate a copy.

	* app/config/picmanbaseconfig.[ch]: gives access to the default values
	for temp and swap path.

	* app/base/base.c (base_init): create the temp directory if it
	doesn't exist (bug #172682).

	* plug-ins/uri/uri-backend-gnomevfs.c: fixed path in error message.

2005-04-06  Sven Neumann  <sven@picman.org>

	* docs/Makefile.am: install a link to the picman(1) man-page for
	picman-console(1).

	* docs/picman.1.in: mention picman-console.

2005-04-06  Sven Neumann  <sven@picman.org>

	* app/main.c: improved "--help" output.

	* docs/picman.1.in: updated.

2005-04-05  Sven Neumann  <sven@picman.org>

	* INSTALL
	* configure.in: build and install picman-console by default.

2005-04-05  Michael Natterer  <mitch@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-ins-query.[ch]: new files containing
	plug_ins_query().

	* tools/pdbgen/pdb/plug_in.pdb (plugins_query): remove all code
	and use above function.

	* app/pdb/plug_in_cmds.c: regenerated.

2005-04-05  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/plug_in.pdb (plugins_query): strip the menu
	strings from underlines before matching. Fixed function to not
	match all procedures twice.

	* app/pdb/plug_in_cmds.c: regenerated.

2005-04-05  Sven Neumann  <sven@picman.org>

	* plug-ins/dbbrowser/picmanprocbrowser.c: s/Blurb/Description/

	* plug-ins/dbbrowser/picmanprocview.c: allow to select the menu path
	label.

2005-04-05  Sven Neumann  <sven@picman.org>

	* app/dialogs/image-properties-dialog.c: shorter dialog title.

2005-04-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantemplateeditor.c: s/Colorspace/Color space/

2005-04-05  Michael Natterer  <mitch@picman.org>

	* app/dialogs/Makefile.am
	* app/dialogs/info-window.[ch]: removed.

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* menus/image-menu.xml.in: removed its action and menu stuff.

	* app/display/picmandisplayshell-cursor.c
	* app/display/picmandisplayshell-title.c
	* app/display/picmandisplayshell.[ch]: removed info window stuff.
	This was the last display -> dialogs dependency.

	* app/dialogs/dialogs.c: added ugly hack that references
	info_dialog. Otherwise the still existing tools -> dialogs
	dependency breaks the build.

2005-04-05  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.[ch]
	* app/core/picmanimage.c
	(picman_image_remove_layer, picman_image_remove_channel): handle a
	floating selection attached to the layer or channel that is being
	removed.  Fixes bug #168582 but doesn't handle floating selections
	attached to layer masks.

2005-04-05  Sven Neumann  <sven@picman.org>

	* configure.in: renamed localedir to picmanlocaledir.

	* libpicmanbase/Makefile.am (AM_CPPFLAGS)
	* tools/Makefile.am (AM_CPPFLAGS): changed accordingly.

	* picman.pc.in: added picmanlocaledir to the pkg-config file to give
	plug-ins a chance to get picman_locale_directory() at compile time.

2005-04-05  Sven Neumann  <sven@picman.org>

	* configure.in: select localedir according to the format of the
	gettext message catalogs. Closes bug #169274 again.

2005-04-05  Michael Natterer  <mitch@picman.org>

	More unfinished replacement for the info window:

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanimagepropview.[ch]: new widget showing an image's
	size, resolution, mode, memsize etc.

	* app/dialogs/Makefile.am
	* app/dialogs/image-properties-dialog.[ch]: a dialog keeping the
	widget.

	* app/widgets/picmanhelp-ids.h: a help ID for the dialog.

	* app/actions/image-actions.c
	* app/actions/image-commands.[ch]
	* menus/image-menu.xml.in: action and menu entry for the dialog.

2005-04-04  Sven Neumann  <sven@picman.org>

	* app/tools/picmanclonetool.c (picman_clone_tool_oper_update): check
	for options->clone_type.

2005-04-04  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpainttool.[ch] export paint tool statusbar API.

	* app/tools/picmanclonetool.c: added statusbar hint.

2005-04-04  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanenv.c (picman_directory): use g_ascii_isalnum()
	instead of isalnum(). Rephrased some comments.

2005-04-04  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_edit_area_info.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_stock.c: replaced 2 icons by PICMAN stock
	icons

	* plug-ins/imagemap/images/Makefile.am: changed accordingly

	* plug-ins/imagemap/images/stock-arrow.png
	* plug-ins/imagemap/images/stock-link.png: removed accordingly

2005-04-04  Sven Neumann  <sven@picman.org>

	* app/core/picmandata.c (picman_data_create_filename): return early if
	called for an internal data object. Fixes bug #172581.

2005-04-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/deinterlace.c (deinterlace): fixed boundary
	conditions that led to incorrect preview (bug #172589).

2005-04-04  Tor Lillqvist  <tml@novell.com>

	* app/widgets/picmanclipboard.c (picman_clipboard_format_compare): On
	Win32, move the "bmp" format to the front. Means less conversion
	in most cases, as other apps on Win32 typically provide/want the
	BMP format on the Clipboard. (Actually CF_DIB, but that's the
	same, just without the BMP file header.) See also bug #168173.

2005-04-04  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/FractalExplorer.c: fixed typo that
	caused a crash when deleting a fractal from the list (bug #172347).

2005-04-03  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINGUAS): readded "rw" (Kinyarwanda).

2005-04-03  Jakub Steiner <jimmac@ximian.com>

	* themes/Default/images/stock-cursor-16.png
	* themes/Default/images/stock-cursor-24.png
	* themes/Default/images/stock-sample-point-16.png
	* themes/Default/images/stock-sample-point-24.png: touch up a
	little.

2005-04-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancursorview.[ch]: fixed spacings and update them
	in GtkWidget::style_set(). Removed lots of cruft from the widget
	this files were copied from, including the PicmanContext param
	to picman_cursor_view_new(). Remember the state of the two color
	frames as aux-info in sessionrc.

	* app/dialogs/dialogs-constructors.c: changed accordingly.

2005-04-03  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancolorframe.c (picman_color_frame_init): switch
	from a table to a vbox containing hboxes, so the widget's width is
	not determined by the longest label *plus* the longest value.

2005-04-03  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage.[ch]: added new signals "sample-point-added"
	and "sample-point-removed" and public functions to emit them.

	* app/core/picmanimage-sample-points.c (picman_image_add_sample_point)
	(picman_image_remove_sample_point): emit them accordingly.

	* app/core/picmanimage-undo-push.c (undo_pop_image_sample_point):
	ditto.

	(undo_pop_image_guide)
	(undo_pop_image_sample_point): added comments why we add/remove
	stuff manually instead of using the PicmanImage APIs.

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmancursorview.[ch]
	* app/widgets/picmansamplepointeditor.[ch]: new widgets.
	PicmanCursorView is a replacement for the info window's "Cursor"
	page, PicmanSamplePointEditor is a view on an image's sample points.
	The sample point editor does nothing yet except keeping a 2x2 grid
	of PicmanColorFrames. Addresses bug #137776.

	* app/dialogs/dialogs.c
	* app/dialogs/dialogs-constructors.[ch]: register the new widgets
	as dockable dialogs.

	* app/actions/dialogs-actions.c (dialogs_dockable_actions)
	* menus/dialogs-menuitems.xml: added actions and menu items for
	the new dialogs.

	* app/display/picmandisplayshell-cursor.c
	(picman_display_shell_update_cursor)
	(picman_display_shell_clear_cursor): update the new cursor view.

	* app/widgets/picmanhelp-ids.h: help IDs for the new dialogs.

	* app/widgets/widgets-enums.[ch] (enum PicmanColorFrameMode):
	changed description "Pixel values" to "Pixel" because the former
	was too long.

2005-04-02  Michael Natterer  <mitch@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/stock-cursor-16.png
	* themes/Default/images/stock-cursor-24.png
	* themes/Default/images/stock-sample-point-16.png
	* themes/Default/images/stock-sample-point-24.png: new icons for
	new dockables which are about to be added. Jimmac, I made them
	as ugly as possible, as you said :)

	* libpicmanwidgets/picmanstock.[ch]: add them as stock icons.

2005-04-01  Michael Natterer  <mitch@picman.org>

	* configure.in: revert previous commit because not all po files
	were added and the ALL_LINGUAS change was broken too.

2005-04-01  Steve Murphy  <murf@e-tools.com>

	* configure.in: Added "rw" to ALL_LINGUAS.

2005-04-01  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_push): do nothing if
	this message is at the top of the stack already.

2005-04-01  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpainttool.c: added a statusbar message suggesting
	to use Shift to draw a straight line.

2005-04-01  Sven Neumann  <sven@picman.org>

	* plug-ins/rcm/rcm_dialog.c: keep the previews from expanding. Fixes
	bug #172284.

2005-04-01  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINGUAS): removed "sl" until all required files
	have been added to CVS.

2005-03-31  Manish Singh  <yosh@picman.org>

	* app/dialogs/quit-dialog.c (quit_dialog_new): cast to
	PICMAN_CONTAINER_VIEW for picman_container_view_get_dnd_widget()

2005-03-31  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmanfgbgview.[ch]
	* app/widgets/widgets-types.h: added new widget PicmanFgBgView;
	somewhat similar to PicmanFgBgEditor but a lot simpler.

	* app/widgets/picmancoloreditor.c: use PicmanFgBgView as preview widget.
	Closes bug #168592.

	* app/widgets/picmanfgbgeditor.c: gracefully handle a very small
	size allocation.

2005-03-31  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c: enable save via DND from the image
	list in the quit dialog.

2005-03-31  Sven Neumann  <sven@picman.org>

	* app/dialogs/quit-dialog.c: use GTK_STOCK_DELETE for the "Discard
	Changes" button.

2005-03-31  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-close.c
	(picman_display_shell_close_dialog): use GTK_STOCK_DELETE for the
	"Don't Save" button.

2005-03-30  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanwidgets.c (picman_label_set_attributes): fixed
	copy-n-paste bug that affected PANGO_ATTR_SIZE.

2005-03-30  Sven Neumann  <sven@picman.org>

	* app/tools/picmanvectortool.c (picman_vector_tool_status_update):
	set a different help message in polygonal mode. Fixes bug #172051.

2005-03-30  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanclipboard.c: when PICMAN exits and a clipboard
	manager is available, store the clipboard content.

2005-03-28  Sven Neumann  <sven@picman.org>

	* app/dialogs/resize-dialog.c (resize_dialog_new): handle
	picman_viewable_get_pixbuf() returning NULL. Fixes bug #171827.

2005-03-26  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_find_scripts):
	removed menu branch registering here (this function is called on
	each refresh).

	* plug-ins/script-fu/script-fu.c (script_fu_extension_init):
	renamed from script_fu_auxillary_init(), this function is only
	called once when the extension starts up. Register the menu
	branches here.

2005-03-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c (lut_lookup): actually do a binary
	search, not a linear search starting in the middle.

2005-03-26  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c
	(picman_display_shell_close_dialog): added an icon to the "Don't Save"
	button.

2005-03-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd.c: don't add the same target multiple times.
	This used to happen when  picman_dnd_foo_source_add() is called
	after calling picman_dnd_drag_source_set_by_type().

2005-03-26  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablecombobox.c
	* libpicman/picmanimagecombobox.c: accept DND of image / drawable IDs.

2005-03-26  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox-image-area.c: added a hint about XDS to
	the tooltip, but only if compiled for X11.

2005-03-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: use the same LUT for all color
	channels. Do a binary search in the LUT for the backward
	transformation.

2005-03-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c: applied a modified version of
	a patch by Gautier Portet that introduces a LUT for the gamma
	correction (bug #101256). Also moved constants out of the
	CdisplayColorblind struct.

2005-03-26  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_lcms.c: disconnect from the config in dispose
	instead of in finalize.

2005-03-25  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c: better error message (bug #171646).

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_add): initialize the
	tab style to a supported one. Fixes bug #171567.

2005-03-25  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c: applied patch from David Costanzo that
	initializes unspecified pixels in RLE bitmaps. Fixes bug #171562.

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c
	* app/widgets/picmanfiledialog.[ch]: moved overwrite confirmation
	dialog to app/widgets.

	* app/widgets/picmandnd-xds.c: set "Untitled.xcf" as default name
	for untitled images; ask for confirmation before overwriting a
	local file.

2005-03-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/emboss.c: fix usage of RGBA data,
	change to premultiplied alpha for embossing, hopefully
	fixes bug #72864.

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/core/picmanmarshal.list: added VOID: OBJECT, OBJECT.

	* app/widgets/picmanview.[ch]: pass old and new viewable in the
	"set-viewable" signal.

	* app/widgets/picmantoolbox-image-area.c: don't add the XDS drag source
	more than once.

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandnd-xds.c (picman_dnd_xds_save_image): in case of
	an error, answer with E (error) instead of F (failure).

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanview.[ch]: virtualized PicmanView::set_viewable.

	* app/widgets/picmantoolbox-image-area.c: hook into "set_viewable"
	and add an XDS drag source.

	* app/widgets/picmandnd-xds.c
	* app/widgets/picmandnd.c: unset the XdndDirectSave0 property when
	the drag ends, minor cleanups.

	* app/widgets/picmanimageview.c: removed unused function prototype.

2005-03-25  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/picmandnd-xds.[ch]: new files.

	* app/widgets/picmandnd.[ch]
	* app/widgets/widgets-enums.h: added a basic XDS (Direct Save
	Protocol) implementation.

	* app/widgets/picmanimageview.c: allow to save images by dragging
	them from the Images dialog to an XDS capable file manager.

2005-03-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/common/displace.c: Fixed off-by-one error in check for
	number of passed parameters.

2005-03-25  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch]: added
	picman_prop_file_chooser_button_new(), a convenience constructor for
	GtkFileChooserButton.

	* libpicmanwidgets/picmanwidgets.def: updated.

	* app/dialogs/preferences-dialog.c: use the new prop widget on the
	color management page.

2005-03-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* configure.in
	* plug-ins/common/screenshot.c: allow option of screenshot
	without decorations if libXmu is present (fixes bug #133626),
	clean up code a bit.

2005-03-24  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanlayermask.[ch]: eek, my fault... removed
	PICMAN_UNDO_LAYER_MASK_EDIT stuff again because that just determines
	the active drawable, which must not affect undo.

	* app/pdb/pdb_glue.h
	* app/actions/layers-commands.c (layers_mask_edit_cmd_callback):
	changed accordingly.

	(layers_mask_disable_cmd_callback): reverted last change. the old
	code was correct.

2005-03-24  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch] (enum PicmanUndoType) : reordered values
	so layer and layer mask undos are grouped together.

	* app/core/picmanimage-undo-push.[ch]: same here. Changed the new
	layer mask undos to have 3 simple push functions for the 3
	properties, just as the layer property undos. Also made the code
	look like the layer properties undo stuff.

	* app/core/picmanlayermask.c (picman_layer_mask_set_apply,edit,show):
	changed accordingly.

2005-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmp.h (Bitmap_Head_Struct)
	* plug-ins/bmp/bmpread.c: use a signed long for width and height
	and check that width is > 0 (negative height is allowed and
	handled by our code). Fixes bug #171453.

2005-03-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanlayermask.c: fix compile warnings.

2005-03-24  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c (picman_statusbar_push_coords)
	(picman_statusbar_set_cursor): use RINT() instead of ROUND() to get
	proper rounding of negative values. Fixes bug #171497.

2005-03-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanlayermask.[ch]:
	* app/pdb/pdb_glue.h
	* app/actions/layers-commands.c: try again from clean tree;
	hopefully will work this time.  (bug #148852)

2005-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/*.scm: don't mark menu branches for
	translation; the translatable branch name is registered by the
	Script-Fu extension.

2005-03-24  Michael Natterer  <mitch@picman.org>

	Added API to explicitly register dynamic menu items hierarchies.
	Fixes bug #170623.

	* app/core/picman.h: added "GSList *plug_in_menu_branches".

	* app/plug-in/plug-in-types.h
	* app/plug-in/plug-ins.[ch]: added API to register plug-in menu
	branches, just as for locale and help domains. Cleaned up handling
	of locale and help domains.

	(plug_ins_exit): free the registered menu branches.

	* app/actions/plug-in-actions.[ch] (plug_in_actions_add_branch):
	new function to explicitly add a menu branch action.

	(plug_in_actions_setup): add the registered menu branches to each
	new action group.

	(plug_in_actions_build_path): always strip the untranslated menu
	path from underlines before using it as hash table key or action
	name.

	* app/menus/plug-in-menus.c (plug_in_menus_add_proc): changed
	accordingly: strip underlines from untranslated menu paths before
	passing them to plug_in_menus_build_path().

	* app/core/picman-gui.[ch]: added picman_menus_create_branch() plus
	vtable entry to access the new stuff from the core. Renamed the
	functions desling with items from picman_foo_entry() to
	picman_foo_item().

	* app/gui/gui-vtable.c: implement create_branch() and add the
	branch action to all existing "plug-in" action groups. Note that
	we don't need to create any menus because that happens implicitly
	when adding menu items.

	* tools/pdbgen/pdb/plug_in.pdb (plugin_menu_branch_register): new
	PDB wrapper to access branch registering from plug-ins.

	* app/pdb/internal_procs.c
	* app/pdb/plug_in_cmds.c
	* libpicman/picmanplugin_pdb.[ch]: regenerated.

	* libpicman/picman.def: changed accordingly.

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_find_scripts):
	register the menu branches for all included scripts.

2005-03-24  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancolormapeditor.c: use a PicmanColorHexEntry widget.

2005-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c: applied a patch from David Costanzo that
	fixes handling of odd-length pixel encodings in "absolute mode" of
	RLE4 compressed data (bug #171306).

2005-03-24  Sven Neumann  <sven@picman.org>

	Merged from picman-2-2 branch:

	* app/widgets/picmanhistogrameditor.c: change to the Value channel
	if the current channel becomes invalid due to an image mode change.
	Fixes bug #170116.

2005-03-24  Sven Neumann  <sven@picman.org>

	* app/actions/layers-commands.c
	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/pdb/pdb_glue.h: reverted Bill's changes to fix the build.

2005-03-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/core-enums.[ch]
	* app/core/picmanimage-undo-push.[ch]
	* app/pdb/pdb_glue.h
	* app/actions/layers-commands.c: make layer mask property changes
	undoable, should fix bug #148852.  Note that a little shape-layer
	stuff is in core-enums, will be needed shortly.

2005-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: seperated platform specific code into
	individual functions; should make it easier to contribute the missing
	platform specific code ...

2005-03-24  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/alien-glow-logo.scm
	* plug-ins/script-fu/scripts/alien-neon-logo.scm
	* plug-ins/script-fu/scripts/basic1-logo.scm
	* plug-ins/script-fu/scripts/basic2-logo.scm
	* plug-ins/script-fu/scripts/blended-logo.scm
	* plug-ins/script-fu/scripts/bovinated-logo.scm
	* plug-ins/script-fu/scripts/chalk.scm
	* plug-ins/script-fu/scripts/chip-away.scm
	* plug-ins/script-fu/scripts/chrome-logo.scm
	* plug-ins/script-fu/scripts/comic-logo.scm
	* plug-ins/script-fu/scripts/coolmetal-logo.scm
	* plug-ins/script-fu/scripts/frosty-logo.scm
	* plug-ins/script-fu/scripts/glossy.scm
	* plug-ins/script-fu/scripts/gradient-bevel-logo.scm
	* plug-ins/script-fu/scripts/neon-logo.scm
	* plug-ins/script-fu/scripts/starburst-logo.scm
	* plug-ins/script-fu/scripts/starscape-logo.scm
	* plug-ins/script-fu/scripts/t-o-p-logo.scm
	* plug-ins/script-fu/scripts/textured-logo.scm: no need to set the
	text as name of the text layer. The text layer is created with that
	name already.

2005-03-24  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanmessagebox.h
	* libpicmanconfig/picmanconfigwriter.h: added G_GNUC_PRINTF attributes.

2005-03-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: add ability to define region
	by pointer-dragging.  UI may need tweaking.

2005-03-23  Sven Neumann  <sven@picman.org>

	* app/display/picmancanvas.[ch] (picman_canvas_draw_text): fixed
	gtk-doc comments; added G_GNUC_PRINTF attribute.

2005-03-23  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanselectiondata.c (picman_selection_data_get_image)
	(picman_selection_data_get_component)
	(picman_selection_data_get_item): same fix as below for ID-based DND
	types.

2005-03-23  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpalettemenu.c
	* libpicman/picmanpatternmenu.c: accept names passed over DND no matter
	whether they are NULL-terminated or not.

	* app/widgets/picmanselectiondata.c: same change here, also
	UTF8-validate the selection data before accepting it.

2005-03-23  Sven Neumann  <sven@picman.org>

	* libpicman/picmanbrushmenu.c
	* libpicman/picmanfontmenu.c
	* libpicman/picmangradientmenu.c
	* libpicman/picmanpalettemenu.c
	* libpicman/picmanpatternmenu.c: accept drops on selection widgets as
	requested in bug #10677.

2005-03-23  Sven Neumann  <sven@picman.org>

	* libpicman/picmanmenu.c: added gtk-doc comments explaining what
	functions to use instead of these deprecated ones.

2005-03-23  Sven Neumann  <sven@picman.org>

	* app/base/tile-swap.c (tile_swap_init): create the swap directory
	if it doesn't exist. Will still fail if the parent directory is not
	available. Still good enough to close bug #167506.

	* app/app_procs.c: tweaked error message.

2005-03-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colortoalpha.c: unset "Keep transparency", it is
	not what the user wants if this plug-in is being used (bug #151910).

2005-03-22  Sven Neumann  <sven@picman.org>

	* plug-ins/common/screenshot.c: removed global variables; added a
	short delay after destroying the dialog so that the root window
	gets redrawn; moved camera icon to the action button.

2005-03-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/screenshot.c: always derive image from root
	window, fixes bug #144788.

2005-03-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactiongroup.c
	* app/widgets/picmancolorpanel.c: use gtk_action_set_sensitive()
	and gtk_action_set_visible() instead of setting the respective
	properties.

2005-03-22  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* configure.in: raise required librsvg version to 2.8.0
	* plug-ins/common/svg.c: change deprecated librsvg api,
	fixes bug #147662.

2005-03-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/sparkle.c
	* plug-ins/common/spheredesigner.c
	* plug-ins/common/struc.c
	* plug-ins/common/tileit.c
	* plug-ins/common/warp.c
	* plug-ins/common/whirlpinch.c
	* plug-ins/common/wind.c: handle situation where intersection
	of selection and drawable is empty; progress on bug #155733.

2005-03-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmantransformtool.c
	* app/tools/picmanfliptool.c
	* app/core/picmandrawabletransform.c: avoid messages and critical
	error when transforming a drawable that does not intersect
	the selection.

2005-03-21  Sven Neumann  <sven@picman.org>

	* app/paint/picmanink.c: changed time-smoother code to use guint32
	time values externally, guint64 internally. Proper fix for bug
	#164272.

2005-03-21  Sven Neumann  <sven@picman.org>

	* app/actions/dialogs-actions.h: bail out if
	widgets/picmanactiongroup.h has not been included beforehand.

	* app/actions/actions.c: include widgets/picmanactiongroup.h. Fixes
	build with amd64/gcc-4.0 (Debian bug report #300227).

2005-03-21  Sven Neumann  <sven@picman.org>

	* etc/controllerrc: fixed defaults for mouse wheel controller (bug
	#171083, fix spotted by Michael Schumacher).

2005-03-21  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_constructor): disable search for tree
	views so that treeview typeahead doesn't collide with global
	accelerators. Fixes bug #169339 and would suck less if bug #170435
	was fixed.

2005-03-21  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-utils.[ch]: changed all transform
	utilities to modify the passed transform matrix instead of
	creating a new one.

	* app/text/picmantextlayer-transform.c
	* app/tools/picmanperspectivetool.c
	* app/tools/picmanrotatetool.c
	* app/tools/picmanscaletool.c
	* app/tools/picmansheartool.c
	* app/vectors/picmanvectors.c
	* tools/pdbgen/pdb/drawable_transform.pdb
	* tools/pdbgen/pdb/transform_tools.pdb: changed accordingly.

	* app/pdb/drawable_transform_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2005-03-21  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icosave.c (ico_create_palette): fixed parameter
	check, NULL is valid for an empty palette. Fixes bug #170812.

2005-03-21  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): added missing
	period in newly added message.

	* app/dialogs/convert-dialog.c (convert_dialog_palette_filter): don't
	show empty palettes (bug #170973).

2005-03-21  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmeasuretool.[ch]: added width and height to the
	info displayed in the statusbar and the info window.
	Fixes bug #165275.

2005-03-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmancolorscales.c (picman_color_scales_update_scales):
	Block callback when updating hex entry, fixes bug #169882.

2005-03-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-convert.c: check for non-empty palette
	before converting to indexed using custom palette, otherwise
	show warning and abort;	fixes bug #170973.

2005-03-20  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-convert.c: applied patch from Adam
	Moss converning gray->indexed conversion,
	fixes bug #170825.

2005-03-20  Sven Neumann  <sven@picman.org>

	* app/text/picmantext.[ch]
	* app/text/picmantextlayer-transform.[ch]: some infrastructure for
	text transforms.

2005-03-20  Sven Neumann  <sven@picman.org>

	* app/core/picman-transform-utils.c (picman_transform_matrix_perspective):
	cosmetic changes.

	* libpicmanmath/picmanmatrix.[ch]
	* libpicmanmath/picmanmath.def: added picman_matrix_is_affine().

2005-03-19  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-sample-points.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell.c
	* app/tools/picmancolortool.c: make sure sample points always have
	coordinates in the range [0..width/height-1], also added lots of
	+0.5 because they live at the pixels' centers, not at their
	borders. Fixed drawing of sample points at the display borders.

2005-03-19  Manish Singh  <yosh@picman.org>

	* app/config/Makefile.am: actually link test program with
	libpicmanconfig.

	* app/Makefile.am
	* libpicmanwidgets/Makefile.am: reordered library link order to be
	consistent with shared library dependencies.

	* plug-ins/common/mkgen.pl: Cosmetic fix to the generated Makefile.am.

	* plug-ins/common/Makefile.am: regenerated.

2005-03-19  Manish Singh  <yosh@picman.org>

	* picman.spec.in: Remove outdated file.

2005-03-19  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-altivec.[ch]: More accelerated functions
	(screen, grain_merge, grain_extract, divide, dodge) from Frederic
	Leroy.

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c: regenerated.

2005-03-19  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-altivec.[ch]: More accelerated functions
	(multiply, blend) from Frederic Leroy.

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c: regenerated.

2005-03-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/fp.c: use callbacks to handle
	"size-allocate" for preview size changes, fixes
	bug #160032.

2005-03-18  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-convert.c:  when converting grayscale
	to mono, treat the palette as gray rather than rgb, giving
	more than tenfold speedup.  Fixes bug #170801.

2005-03-18  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.c: make "preview-size" and
	"preview-border-width" construct properties. Fixes creation
	using g_object_new().

	* app/widgets/picmancontainerentry.c
	* app/widgets/picmancontainertreeview.c
	* app/widgets/picmanlayertreeview.c (set_preview_size): handle
	unset model and/or view gracefully.

	* app/dialogs/image-new-dialog.c: unset "focus-on-click" on the
	template combo-box.

2005-03-17  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/fp.c:  major code cleanup, make it
	Repeat and Re-Show properly.  Should fix bug #141032.

2005-03-17  Sven Neumann  <sven@picman.org>

	* app/actions/layers-actions.c
	* app/actions/plug-in-actions.c
	* app/actions/view-actions.c
	* plug-ins/common/compose.c
	* plug-ins/common/dog.c
	* plug-ins/pypicman/plug-ins/py-slice.py
	* plug-ins/script-fu/scripts/i26-gunya2.scm
	* plug-ins/script-fu/scripts/news-text.scm
	* plug-ins/script-fu/scripts/text-circle.scm: applied patch from
	Michael Terry that adds missing mnemonics (bug #106991).

2005-03-16  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c: fixed checks for uncalculated histogram.
	Fixes bug #170570.

2005-03-14  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmannewrectselecttool.c
	* app/tools/picmanrectangletool.[ch]: improve cursor handling and
	other aspects of ui for rectangle tools.

2005-03-14  Shlomi Fish  <shlomif@iglu.org.il>

	* app/paint-funcs/paint-funcs.c
	* app/paint-funcs/paint-funcs-generic.h: fix bug #143315. When the
	visibility of the Alpha channel is turned off, it should make
	alpha=255.

2005-03-13  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-altivec.[ch]: More accelerated functions
	from Frederic Leroy.

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c: regenerated.

2005-03-13  Sven Neumann  <sven@picman.org>

	* app/dialogs/print-size-dialog.c (print_size_dialog_response):
	handle the resolution unit correctly, fixes bug #170200.

2005-03-13  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/drawable_transform.pdb
	(drawable_transform_scale)
	(drawable_transform_scale_default): applied fix from Theodor de
	Ment which fixes a wrong precondition check which made certain
	scale operations impossible. Fixes bug #170195.

	* tools/pdbgen/pdb/transform_tools.pdb (scale): fixed the same
	copy & paste bug here.

	* app/pdb/drawable_transform_cmds.c
	* app/pdb/transform_tools_cmds.c: regenerated.

2005-03-12  Michael Schumacher  <schumaml@cvs.gnome.org>

	* plug-ins/common/winclipboard.c: applied a patch from
	Sven Neumann that removes the paste functionality from the
	plug-in. Since GTK+ 2.6.x, this isn't needed anymore.
	Fixes bug #168488.

2005-03-12  Sven Neumann  <sven@picman.org>

	* app/base/hue-saturation.[ch]
	* app/tools/picmanhuesaturationtool.[ch]: applied a patch from Joao
	S. O. Bueno Calligaris and modified it a little. This adds a way
	to control the overlap between hue ranges in the Hue Saturation
	tool (bug #166628).

2005-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/despeckle.c: test intensity against white and
	black level, not only the red channel. Improved border behavior.
	Iterate over the pixels row-by-row, instead of jumping through the
	data column-wise.

2005-03-11  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanstrokedesc.h
	* app/core/picmanstrokedesc.c (picman_stroke_desc_duplicate):
	New function, will be needed for shape layers.

2005-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/deinterlace.c
	* plug-ins/common/despeckle.c
	* plug-ins/common/laplace.c
	* plug-ins/common/neon.c
	* plug-ins/common/sobel.c
	* plug-ins/common/dog.c: update progress less frequently.

2005-03-11  Sven Neumann  <sven@picman.org>

	* plug-ins/common/despeckle.c: minor cleanup, inline
	pixel_intensity() and pixel_copy().

2005-03-10  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/url-backend-wget.c: force the server-response wget
	option off so it doesn't screw up our parsing.

2005-03-10  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c: lots of code for dealing
	with constraints.  Almost functional now ...

2005-03-10  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-altivec.c: delete trailing whitespace.

2005-03-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmantexttool.c (picman_text_tool_create_vectors_warped):
	make created path visible and active.

2005-03-09  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanfu.py: initialize button variable before using
	it in PF_BUTTON code. Fixes bug #169793. Thanks to Joao S. O. Bueno
	Calligaris.

2005-03-10  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.c (picman_size_entry_show_unit_menu):
	added "Since: PICMAN 2.4" to the docs.

	* libpicmanwidgets/picmanwidgets.def: added the new symbol.

2005-03-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmansizeentry.[ch]: added function
	picman_size_entry_show_unit_menu() for convenience.

	* app/tools/picmanrectangleoptions.[ch]
	* app/tools/picmanrectangletool.[ch]:  more work on
	controls in Tool Options.  Can now resize rectangle
	by dragging any corner or edge -- move rectangle by
	clicking inside and dragging.

2005-03-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainerview.c
	* app/widgets/picmanimagedock.c
	* app/widgets/picmantoolbox.c
	* app/widgets/gtkwrapbox.c
	* libpicmanwidgets/picmancellrenderercolor.c
	* libpicmanwidgets/picmancellrenderertoggle.c
	* libpicmanwidgets/picmanframe.c: use canonical names when registering
	param specs.

2005-03-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/vectors/picmanvectors-warp.c
	* app/vectors/picmanvectors-warp.h: new files implementing
	"path along a path" functionality.

	* app/vectors/Makefile.am: new stuff added

	* picman/app/vectors/picmanvectors.[ch]: actually implement
	picman_vectors_real_stroke_get_length().

	* app/tools/picmantexttool.c
	* app/tools/picmantextoptions.c: first pass at "text
	along a path", using new functions.  See bug #169616.

2005-03-09  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette.[ch]: renamed again, to
	picman_palette_[gs]et_columns this time.

	* app/dialogs/palette-import-dialog.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

	* tools/pdbgen/pdb/palette.pdb: renamed newly added PDB function.
	Also added a getter for the columns.

	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* libpicman/picmanpalette_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-03-09  Michael Natterer  <mitch@picman.org>

	More sample point stuff. Addresses bug #137776.

	* app/core/picmanimage-sample-points.c
	* app/core/picmanimage-undo-push.c: append, not prepend the sample
	points to the image's list because their index matters. Update
	sample points when their index changes.

	* app/display/picmancanvas.[ch]: added own sytles for the sample
	points.  Added picman_canvas_draw_text() which uses a PangoLayout
	which is cached in the canvas.

	* app/display/picmandisplayshell-draw.c
	(picman_display_shell_draw_sample_point): draw the sample points
	more distinct from guides using the new canvas APIs above.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_[hv]ruler_button_press): factored out all
	code to

	(picman_display_shell_ruler_burron_press): which takes a boolean
	"horizontal" variable and allows to add sample points with
	<control>+drag.

	* app/tools/picmancolortool.[ch]: implement adding, moving and
	removing of sample points in the same way as the move tool moves
	guides.

	* app/tools/picmancolorpickertool.c
	(picman_color_picker_tool_oper_update): chain up.

2005-03-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/metadata/interface.c: fix spelling error
	noted in bug #169656.

2005-03-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.[ch]
	* app/tools/picmanrectangleoptions.[ch]: add size entry in
	options to control dimensions.  Still work in progress.

2005-03-09  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell.[ch]: added
	picman_display_shell_get_unit(), for completeness.

2005-03-08  Sven Neumann  <sven@picman.org>

	* app/core/picmangradient.c (picman_gradient_segment_split_uniform):
	fixed brokeness introduced when eliminating gradient->last_visited.

2005-03-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanviewrenderergradient.c: revert previous
	change.  Didn't read the code carefully enough.

2005-03-08  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanviewrenderergradient.c:
	(picman_view_renderer_gradient_render): Make sure specified
	point lies within specified gradient segment; should
	fix bug #167604.

2005-03-08  Sven Neumann  <sven@picman.org>

	* app/file/file-open.c (file_open_layer): open images interactively.
	Fixes bug #168936.

2005-03-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpaintoptions-gui.c (fade_options_gui)
	(gradient_options_gui)
	* app/tools/picmanselectionoptions.c (picman_selection_options_gui):
	call picman_unit_menu_set_pixel_digits() after connecting up the
	spinbuttons and the unitmenu. Fixes initial display (bug #169066).

2005-03-08  Sven Neumann  <sven@picman.org>

	* app/core/picmanpalette.[ch]: renamed picman_palette_[gs]et_n_columns
	to picman_palette_[gs]et_num_columns().

	* app/dialogs/palette-import-dialog.c
	* app/widgets/picmanpaletteeditor.c: changed accordingly.

	* tools/pdbgen/pdb/palette.pdb: added new PDB function to control
	the number of columns used when displaying a palette (bug #169370).

	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* libpicman/picmanpalette_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-03-08  Sven Neumann  <sven@picman.org>

	* app/tools/picmancurvestool.c (picman_curves_tool_dialog)
	* app/tools/picmanlevelstool.c (picman_levels_tool_dialog): added
	mnemonics for the Channels menu.

2005-03-07  Manish Singh  <yosh@picman.org>

	* plug-ins/metadata/interface.c
	* plug-ins/metadata/xmp-model.c: fix some gssize confusion.

2005-03-07  Sven Neumann  <sven@picman.org>

	* app/tools/picmanellipseselecttool.c
	* app/tools/picmanrectselecttool.[ch]: applied a patch by Nils
	Bjorklund that should fix bug #143887 (selection rectangle "moves"
	when starting at the top-right corner).

2005-03-07  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/perspective-shadow.scm: Reverting previous
	change as I was mixing up two different versions of PICMAN at the time.

2005-03-07  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/scripts/perspective-shadow.scm: Fixed the
	options for SF-ENUM in the register block which were changed (read
	broken) when the entry was changed from SF-OPTION.

2005-03-07  RaphaÃ«l Quinet  <raphael@picman.org>

	* configure.in
	* plug-ins/Makefile.am (SUBDIRS): Enable build of metadata plug-in.

	* plug-ins/metadata/xmp-gen.c
	* plug-ins/metadata/xmp-gen.h
	* plug-ins/metadata/xmp-encode.c
	* plug-ins/metadata/xmp-encode.h: Renamed xmp-gen.[ch] to
	xmp-encode.[ch].

	* plug-ins/metadata/Makefile.am
	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/interface.c: Updated accordingly + minor fixes.

2005-03-07  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancolortool.c: converted tabs to spaces, stylistic
	cleanups.

2005-03-06  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-altivec.c: contort it to compile with
	Apple's weirdo gcc.

	* app/composite/picman-composite-altivec.h: honor USE_ALTIVEC.

2005-03-06  Manish Singh  <yosh@picman.org>

	* configure.in: rework AltiVec tests some.

2005-03-06  Manish Singh  <yosh@picman.org>

	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c: regenerated so the new
	implementation is actually used.

2005-03-06  Manish Singh  <yosh@picman.org>

	* configure.in: revised tests for AltiVec. Define ALTIVEC_EXTRA_CFLAGS
	for the extra compiler options needed. Also, support runtime checking
	for AltiVec through the sysctl on Mac OS X, instead of SIGILL assembly
	instruction checking, which needs GNU as.

	* app/base/cpu_accel.c: use the sysctl if available.

	* app/composite/Makefile.am: use ALTIVEC_EXTRA_CFLAGS.

	* app/composite/picman-composite-altivec.c: conditionally #include
	altivec.h

2005-03-05  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-altivec.[ch]
	* app/composite/picman-composite-altivec-installer.c
	* app/composite/picman-composite-altivec-test.c:
	Added updates from starox-picman@starox.org
	(Frederic Leroy) to implement Altivec instruction optimisations.

	Regenerated sources.

	* app/composite/picman-composite-mmx.c: Replaced a pesky movntq
	instruction with a movq.  Movntq is an SSE instruction, not an MMX
	instruction.

2005-03-05  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod/sliba.c: Oops...one 'case tc_string:' was
	lost while fixing handling of string arrays.

2005-03-05  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/picman-composite-generic.c
	* app/composite/picman-composite-mmx.c
	* app/composite/picman-composite-sse.c
	Incorporated a very clean patch from starox-picman@starox.org
	(Frederic Leroy) which improves the generic performance of the
	burn compositing function.  Speed is improved at a cost of a 64k
	look-up table which is probably manageable for 8bpp images, but at
	larger bpp images (which currently are not supported by the PICMAN)
	this is unlikely to be tolerable.

	The generic C implementation of the burn function uses this
	look-up table, the mmx/sse implementations have been commented
	out.

2005-03-05  Sven Neumann  <sven@picman.org>

	Fix for bug #169274:

	* configure.in: updated definition of localedir.

	* po/Makefile.in.in: updated.

	* po-libpicman/Makefile.in.in
	* po-plug-ins/Makefile.in.in
	* po-script-fu/Makefile.in.in: synchronized with po/Makefile.in.in.

2005-03-05  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/*: Update or add missing copyright and GPL comments.

2005-03-05  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman-drawable.c: default args for layer
	constructor.

2005-03-04  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/enumcode-py.pl: include Parasite flag values.

	* plug-ins/pypicman/picmanenums.py: regenerated.

	* plug-ins/pypicman/pypicman-drawable.c: minor change for type
	consistency.

	* plug-ins/pypicman/pypicman-image.c: add keyword args, is_dirty getter.

2005-03-04  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/picmanmodule.c: wrap fonts_refresh and fonts_get_list,
	clean up some of the other resource list plugins.

	* plug-ins/pypicman/pypicman-drawable.c: more keyword args and better
	exception messages.

	* plug-ins/pypicman/pypicman-parasite.c: support keyword args for
	parasite constructor.

2005-03-04  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/layer.pdb: fix documentation of edit_mask
	accessors.

	* libpicman/picmanlayer_pdb.c
	* app/pdb/layer_cmds.c: regenerated.

2005-03-05  Sven Neumann  <sven@picman.org>

	* plug-ins/metadata/interface.c: specify alternative button order
	for the new dialogs.

2005-03-04  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am: no need to export PLUG_IN_INFO symbol.

	* plug-ins/pypicman/pypicman-image.c: more descriptive exception for
	Image constructor.

	* plug-ins/pypicman/pypicman-pdb.c: cosmetic changes.

	* plug-ins/pypicman/pypicman-drawable.c: wrap transform API, add keyword
	arguments to several drawable methods, wrap
	layer_resize_to_image_size.

2005-03-05  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/config/picmanrc-blurbs.h
	* app/core/core-enums.[ch]
	* app/core/picman.c
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-undo-push.[ch]
	* app/core/picmanimage.c
	* app/display/picmandisplayoptions.[ch]
	* app/display/picmandisplayshell-appearance.[ch]
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-draw.[ch]
	* app/widgets/picmanhelp-ids.h
	* menus/image-menu.xml.in: reordered stuff to be in guides, grid,
	sample points order. Some cleanup and indentation.

2005-03-04  RaphaÃ«l Quinet  <raphael@picman.org>

	* plug-ins/metadata/xmpdump.c: test program that tries to extract
	XMP metadata from files (image files, AI files, PDF documents...)

	* menus/image-menu.xml.in: Added placeholder for file properties.

	* plug-ins/metadata/.cvsignore
	* plug-ins/metadata/Makefile.am
	* plug-ins/metadata/README
	* plug-ins/metadata/interface.c
	* plug-ins/metadata/interface.h
	* plug-ins/metadata/metadata.c
	* plug-ins/metadata/xmp-model.c
	* plug-ins/metadata/xmp-model.h
	* plug-ins/metadata/xmp-parse.c
	* plug-ins/metadata/xmp-parse.h
	* plug-ins/metadata/xmp-gen.c
	* plug-ins/metadata/xmp-gen.h: First import of metadata editor.
	Currently, it cannot read metadata (except for XMP), it cannot
	edit metadata and it cannot save metadata (just export).  But this
	might improve later...  The README file contains some info.

2005-03-04  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c
	* app/file/picmanrecentlist.c
	* app/widgets/picmanwidgets-utils.c
	* modules/controller_linux_input.c
	* modules/controller_midi.c
	* plug-ins/common/compressor.c
	* plug-ins/common/mail.c
	* plug-ins/common/psp.c
	* plug-ins/common/raw.c
	* plug-ins/helpbrowser/dialog.c
	* plug-ins/imagemap/imap_cern.y
	* plug-ins/imagemap/imap_cern_parse.[ch]
	* plug-ins/imagemap/imap_csim.y
	* plug-ins/imagemap/imap_csim_parse.[ch]
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_ncsa.y
	* plug-ins/imagemap/imap_ncsa_parse.[ch]
	* plug-ins/uri/uri.c
	* plug-ins/xjt/xjt.c: ported the remaining functions to gstdio.

2005-03-04  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantoolcontrol.[ch]: in the spirit of the fix for bug
	#165618 below, allow tools to specify up to two "object actions"
	(actions which select brushes, patterns, ...).

	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmanclonetool.c
	* app/tools/picmanpainttool.c
	* app/tools/picmantexttool.c: set actions where appropriate.

	* app/actions/actions.c (action_select_object): allow objects to
	be selected by index.

	* app/actions/context-actions.c: added actions which select
	objects by index. Not really used but the same actions can be used
	to generically pass any PicmanActionSelectType enum value to the
	action callbacks.

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: added actions and callbacks
	for the new generic tool objects.

	Also fixed and cleaned up the new generic tool value code.

2005-03-04  Manish Singh  <yosh@picman.org>

	* plug-ins/common/gqbist.c: #include gstdio.h

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/CEL.c
	* plug-ins/common/gbr.c
	* plug-ins/common/gih.c
	* plug-ins/common/gqbist.c
	* plug-ins/common/pat.c
	* plug-ins/common/pnm.c
	* plug-ins/common/postscript.c
	* plug-ins/common/raw.c
	* plug-ins/common/sample_colorize.c
	* plug-ins/faxg3/faxg3.c
	* plug-ins/imagemap/imap_preferences.c
	* plug-ins/print/print.c: added missing parameter to g_open() calls,
	ported some functions I missed earlier.

2005-03-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage.c
	* app/display/picmandisplayoptions.c: re-order code so
	sample-point stuff comes directly after guide stuff.

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod/slib.c (vload) (fopen_c): ported to
	g_stdio. Also disabled code that attempts to load scripts from
	SIOD_LIB.

2005-03-04  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-path.c (picman_config_path_expand_only):
	handle g_get_home_dir() returning NULL and enable it for the Win32
	platform as well.

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer/Dialogs.c
	* plug-ins/Lighting/lighting_ui.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gflare/gflare.c
	* plug-ins/picmanressionist/utils.c: same fix for path encoding as
	done in Script-Fu (see bug #165002).

2005-03-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/core/picmanimage-sample-points.c
	* app/core/picmanimage-sample-points.h: new files

	* app/actions/view-actions.c
	* app/actions/view-commands.c
	* app/actions/view-commands.h
	* app/config/picmanrc-blurbs.h
	* app/core/Makefile.am
	* app/core/core-enums.c
	* app/core/core-enums.h
	* app/core/core-types.h
	* app/core/picman.c
	* app/core/picman.h
	* app/core/picmanimage-crop.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-flip.c
	* app/core/picmanimage-rotate.c
	* app/core/picmanimage-scale.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage-undo-push.h
	* app/core/picmanimage.c
	* app/core/picmanimage.h
	* app/display/picmandisplayoptions.c
	* app/display/picmandisplayoptions.h
	* app/display/picmandisplayshell-appearance.c
	* app/display/picmandisplayshell-appearance.h
	* app/display/picmandisplayshell-callbacks.c
	* app/display/picmandisplayshell-draw.c
	* app/display/picmandisplayshell-draw.h
	* app/display/picmandisplayshell-handlers.c
	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell.h
	* app/widgets/picmanhelp-ids.h
	* menus/image-menu.xml.in: add support for a list of "sample
	points" in each image, coded and handled very similarly to
	guides, for use mainly in color correction.  See bug #137776.

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_find_scripts):
	need to convert script-fu-path to filesystem encoding. Should fix
	bug #165002.

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/common/*: ported to gstdio, removed unnecessary includes.

2005-03-04  Sven Neumann  <sven@picman.org>

	* plug-ins/FractalExplorer
	* plug-ins/Lighting
	* plug-ins/bmp
	* plug-ins/dbbrowser
	* plug-ins/faxg3
	* plug-ins/fits
	* plug-ins/flame
	* plug-ins/gfig
	* plug-ins/gflare
	* plug-ins/gfli
	* plug-ins/picmanressionist
	* plug-ins/ifscompose
	* plug-ins/jpeg
	* plug-ins/maze
	* plug-ins/pagecurl
	* plug-ins/print
	* plug-ins/rcm
	* plug-ins/script-fu
	* plug-ins/sel2path
	* plug-ins/sgi
	* plug-ins/twain
	* plug-ins/winicon
	* plug-ins/xjt: ported to gstdio, removed unnecessary includes,
	minor fixes to filename handling here and there.

2005-03-04  Michael Natterer  <mitch@picman.org>

	Fixed bug #165618:

	* app/tools/picmantoolcontrol.[ch]: added new functions
	picman_tool_control_set/get_action_value_1/2/3/4() which allow tools
	to specify their primary, secondary etc. "values" using
	action-identifying strings like "context/context-brush-radius-set".

	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c
	* app/tools/picmancolortool.c
	* app/tools/picmaninktool.c
	* app/tools/picmanpainttool.c: set actions where appropriate. Still
	needs some way to document the mapping in a user-visible way.

	* app/tools/picmanblendtool.c
	* app/tools/picmanbucketfilltool.c: tab removal and minor cleanups.

	* app/actions/actions.[ch]: added utility function
	action_select_property().

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: added actions and callbacks for
	setting the ink blob size, aspect and angle. Also added actions
	and callbacks for the new generic tool values.

2005-03-03  Helvetix Victorinox  <helvetix@picman.org>

	* app/composite/make-installer.py:Applied patch from
	starox-picman@starox.org (Frederic Leroy) which fixed the parser of
	the nm programme output to understand the output on 64bit
	machines.  Fixes bug #168529

	* app/composite/ns.py:
	Applied patch from starox-picman@starox.org (Frederic Leroy) which
	fixed a bug that would appear when only one compositing function
	was implemented.  Fixes bug #168529

	Regenerated app/composite function tables.

2005-03-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/gifload.c (ReadImage): added a sanity check for
	bogus frame dimensions. Fixes bug #169113.

2005-03-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/autocrop.c: allocate tile-cache size more
	intelligently.

2005-03-03  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-params.h: removed linebreak from macro
	definition; gtk-doc doesn't like this.

2005-03-03  Sven Neumann  <sven@picman.org>

	* app/base/curves.c: minor code cleanup.

2005-03-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb: use boolean values to indicate
	whether a path is linked ("locked").

	* app/pdb/drawable_cmds.c
	* app/pdb/paths_cmds.c
	* libpicman/picmandrawable_pdb.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

2005-03-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/paths.pdb: added new PDB function
	picman_path_import_string() to allow to easily import dynamically
	created SVG.

	* app/pdb/internal_procs.c
	* app/pdb/paths_cmds.c
	* libpicman/picmanpaths_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

	* plug-ins/script-fu/siod-wrapper.c (marshall_proc_db_call):
	removed unused variable.

2005-03-03  Manish Singh  <yosh@picman.org>

	* configure.in: Add check for ppc64.

2005-03-03  Manish Singh  <yosh@picman.org>

	* tools/pdbgen/pdb/drawable.pdb: fix a typo in the docs.

2005-03-03  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/pypicman.h: Make a compatibility wrapper for
	PyBool_FromLong for pre-2.3 versions of python.

	* plug-ins/pypicman/picmanfu.py
	* plug-ins/pypicman/picmanui.py: Update to use some more modern python
	features.

	* plug-ins/pypicman/picmanmodule.c
	* plug-ins/pypicman/pypicman-display.c
	* plug-ins/pypicman/pypicman-drawable.c
	* plug-ins/pypicman/pypicman-image.c
	* plug-ins/pypicman/pypicman-parasite.c
	* plug-ins/pypicman/pypicman-pdb.c
	* plug-ins/pypicman/pypicman-tile.c: Throw exceptions on failures for
	libpicman wrappers (fixes bug #160136), and make the exception strings
	a lot more descriptive to aid debugging. Also return proper Bools when
	appropriate. Some new API wrapped as well. Still a work in progress.

	* plug-ins/pypicman/picmanplugin.py
	* plug-ins/pypicman/picmanshelf.py
	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/foggify.py
	* plug-ins/pypicman/plug-ins/sphere.py: Add some whitespace to make
	things more readable.

2005-03-03  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablecombobox.c
	* libpicman/picmanimagecombobox.c: set a width request on the combo boxes.

	* plug-ins/common/bumpmap.c (SCALE_WIDTH): set a minimum width on
	the scales.

2005-03-02  Manish Singh  <yosh@picman.org>

	* libpicman/picman.[ch]
	* libpicman/picmandrawable.[ch]
	* libpicman/picmanimage.[ch]: changed attach_new_parasite variants
	to return success or failure.

2005-03-02  Sven Neumann  <sven@picman.org>

	* app/dialogs/resize-dialog.c (resize_dialog_reset)
	* app/dialogs/scale-dialog.c (scale_dialog_reset): don't rely on
	GObject internals about the order in which properties are being
	set. Fixes one aspect of bug #169011.

2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.[ch]: oops, missed in previous
	commit.

2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanrectangletool.c
	* app/tools/picmanrectangletool.h
	* app/tools/picmanrectangleoptions.c
	* app/tools/picmanrectangleoptions.h: new code for base
	class for rectangle tools.

	* app/tools/picmannewrectselecttool.[ch]: modified to
	derive from PicmanRectangleTool.

	* app/tools/Makefile.am: modified accordingly

	* app/tools/picmanselectionoptions.[ch]: remove stuff
	no longer needed by new rect select tool.

	This is work in progress.

2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmangradienteditor.c: allow dnd of colors
	into preview and control areas, as described in
	bug #119470.

2005-03-02  Sven Neumann  <sven@picman.org>

	* app/text/picmantextlayout.c
	* app/tools/picmantextoptions.[ch]: allow to adjust letter-spacing.

2005-03-01  Manish Singh  <yosh@picman.org>

	* plug-ins/common/mail.c: use g_spawn_async_with_pipes instead of
	popen. Addresses bug #108659. Also some general cleanup.

	* plug-ins/common/mblur.c: Fix some typos in comments.

2005-03-01  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch]: added VISIBLE and LINKED to the
	PicmanImageResizeLayers enum.

	* app/core/picmanimage-resize.c (picman_image_resize_with_layers):
	changed accordingly. Also looks nicer now.

2005-03-01  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.[ch]
	* plug-ins/ifscompose/ifscompose_utils.c: purely cosmetic coding
	style changes.

2005-03-01  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod-wrapper.c: Fixed marshalling code to
	treat string arrays as arrays instead of lists of strings. Last
	part of the fix for bug #168290.

2005-03-01  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumcombobox.[ch]: removed
	picman_enum_combo_box_set_visible().

	* libpicmanwidgets/picmanintcombobox.[ch]: added
	picman_int_combo_box_set_sensitivity() instead.

	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmanhistogrameditor.c: changed accordingly.

	* libpicmanwidgets/picmanenumstore.h: added padding for future expansion.

	* libpicmanwidgets/picmanwidgets.def: updated.

2005-02-28  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: major speedup for dithering code
	thanks to a suggestion from Jay Cox.

2005-02-28  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanhelp.c (picman_help_get_locales): use
	g_get_language_names().

	* plug-ins/help/locales.c (locales_parse): simplified;
	g_get_language_names() already takes care of this.

2005-02-27  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.c: allow to change ellipsation
	mode after the combo has been created.

2005-02-27  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_menu.c (menu_build_mru_items): another
	build fix for compilers that don't support C99 extensions.

2005-02-27  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanintcombobox.c: added an "ellipsize" construct
	property and changed the default behaviour back to not doing
	ellipsation on the text.

	* libpicman/picmanimagecombobox.c
	* libpicman/picmandrawablecombobox.c: set "ellipsize" to middle for
	drawable and image combo boxes.

2005-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: improved readability by
	introducing a macro for the dithering code.

2005-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: fixed rounding errors in the
	non-dithered case and optimized the dithering code.

2005-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: (hopefully) improve the threaded
	performance by using a dedicated RNG per tile.

2005-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert-fsdither.h
	* app/core/picmanimage-convertc: save a kilobyte of data by using
	guchar for the range array.

2005-02-27  Daniel Egger  <de@axiros.com>

	* app/base/Makefile.am
	* app/composite/Makefile.am
	* app/config/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am
	* app/file/Makefile.am
	* app/paint-funcs/Makefile.am
	* app/pdb/Makefile.am
	* app/plug-in/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/vectors/Makefile.am
	* app/xcf/Makefile.am: Commonized include paths to always look
	in the builddir also to cater for srcdir != builddir builds.

2005-02-27  Sven Neumann  <sven@picman.org>

	* app/core/picmangradient.[ch]: removed the "last_visited" field
	from PicmanGradient. Instead added a segment parameter to
	picman_gradient_get_color_at() that allows the caller to do the same
	optimization.

	* app/actions/gradient-editor-commands.c
	* app/core/picmandrawable-blend.c
	* app/core/picmanpalette-import.c
	* app/paint/picmanpaintoptions.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmangradientselect.c
	* app/widgets/picmanviewrenderergradient.c: changed accordingly.

	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c: regenerated.

2005-02-26  Manish Singh  <yosh@picman.org>

	* plug-ins/common/png.c: revert change to read images one row at a
	time, it didn't really fix the bug.

2005-02-26  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-blend.c: minor code cleanup.

2005-02-26  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c (do_parallel_regions): obtain a lock
	on the pool mutex while signalling the termination condition.

2005-02-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/png.c: read non-interlaced files one row
	at a time instead of in 64-row chunks; fixes bug #137327.

2005-02-25  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod/siod.h
	* plug-ins/script-fu/siod/sliba.c: Creation and manipulation of
	string arrays was seriously broken. Fixes bug #168290.

2005-02-25  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: fixed indentation.

2005-02-24  Jay Cox  <jaycox@picman.org>

	* app/base/pixel-processor.c: fixed potential race condition on
	processor->threads.  Changed mutex to a GMutex from a GStaticMutex
	because it needs to be initialized anyway.  Placed g_cond_wait
	calls inside while loops to handle g_cond_wait returning prematurely.

2005-02-24  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/uri-backend-wget.c: Handle large file sizes, and
	update the downloaded size for unknown file sizes.

2005-02-24  Sven Neumann  <sven@picman.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): pulse
	the progress while downloading an unspecified amount of data.

2005-02-24  Manish Singh  <yosh@picman.org>

	* plug-ins/uri/uri-backend-wget.c: Handle HTTP 302 Redirect output
	from wget properly. Also give a little more informative display for
	unspecified sizes. Fixes bug #168322.

2005-02-24  Sven Neumann  <sven@picman.org>

	* app/actions/file-commands.c (file_open_as_layer_cmd_callback):
	preselect the image just as in file_open_from_image_cmd_callback().

2005-02-24  Michael Natterer  <mitch@picman.org>

	Allow to resize layers with the image. Fixes bug #87789.
	Based on patch by Akkana Peck.

	* app/core/core-enums.[ch]: added enum PicmanImageResizeLayers which
	can be one of { NONE, MATCHING, ALL }.

	* app/core/picmanimage-resize.[ch]: added new function
	picman_image_resize_with_layers().

	* app/dialogs/resize-dialog.[ch]: added a "Layers" frame
	containing a "Resize Layers" combo box offering the choices above.
	Changed PicmanResizeCallback signature accordingly.

	* app/actions/image-commands.c
	* app/actions/layers-commands.c: changed accordingly.

2005-02-23  Michael Natterer  <mitch@picman.org>

	* libpicmanwidgets/picmanbutton.c (picman_button_button_press): don't
	reset button->press_state on double clicks because
	GDK_2BUTTON_PRESS always arrive immediately after
	GDK_BUTTON_PRESS, so resetting the state causes the second click
	of a double click to be always interpreted as "clicked", not
	"extended-clicked", breaking e.g. adding of multiple layers by
	shift-clicking the layers dialog's "new" button. Phew, too much
	text for a one-liner bug fix, blah... Spotted by Jimmac.
	Cleaned up this antique file a bit.

2005-02-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/*/Makefile.am
	* plug-ins/common/mkgen.pl: add libpicmanmath deps
	needed because libpicmanconfig links it.

2005-02-23  Shlomi Fish  <shlomif@iglu.org.il>

	* plug-ins/common/displace.c: fixed the numbers of parameters check
	in RUN_NONINTERACTIVE. (it was a typo).

2005-02-22  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c: removed redundant casts,
	made picman_display_shell_compress_motion() static.

2005-02-22  Shlomi Fish  <shlomif@iglu.org.il>

	* tools/pdbgen/pdb/channel.pdb: add the
	picman_channel_new_from_component() PDB function.

	* libpicman/picmanchannel_pdb.[ch]
	* app/pdb/channel_cmds.c: resultant files.

	* libpicman/picman.def: add the new function to the def file

2005-02-22  Michael Natterer  <mitch@picman.org>

	* app/tools/picmanmagnifytool.c (picman_magnify_tool_init)
	* app/tools/picmanmeasuretool.c (picman_measure_tool_init)
	* app/tools/picmanvectortool.c (picman_vector_tool_init): set
	handles_empty_image to TRUE because all these tools work fine
	without active drawable.

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): also look at
	handles_empty_image, not only at picman_image_is_empty() before
	setting the BAD cursor.

2005-02-21  Manish Singh  <yosh@picman.org>

	* app/text/picmanfont-utils.[ch]: be smarter about finding trailing
	numbers that look like sizes, so we don't have spurious commas.

	* app/text/picmanfontlist.c: As an optimization, figure out if
	pango needs a workaround, and if not, just call it directly.

2005-02-21  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): put back some important
	code that was accidentially removed when fixing bug #162823. Also
	moved the calls to gtk_grab_add() and gtk_grab_remove() around a
	bit.

2005-02-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmantoolbox.c (toolbox_area_notify): apply evil
	size_request hacks to the color/image/foo areas' wrapbox because
	its child requisition/allocation code is apparently broken. Works
	around bug #162500.

2005-02-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/emboss.c: fixed emboss on small images (bug #168022).

2005-02-21  Sven Neumann  <sven@picman.org>

	* libpicmanthumb/picmanthumb-utils.c (picman_thumb_init): workaround for
	bug #167973: if no valid home directory exists, use the folder for
	temporary files to store thumbnails.

2005-02-21  Michael Natterer  <mitch@picman.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.[ch]: removed the newly added color
	picker radius actions...

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: ...and added them here.

2005-02-20  Manish Singh  <yosh@picman.org>

	Support for custom plug-in interpreters, independent of OS support.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/picmaninterpreterdb.[ch]: implemented PicmanInterpreterDB,
	which handles registering and resolving custom plug-in interpreters.

	* app/core/picman.[ch]: keep a PicmanInterpreterDB around.

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h
	* app/dialogs/preferences-dialog.c
	* app/dialogs/user-install-dialog.c
	* app/widgets/picmanhelp-ids.h: interpreter-path config stuff.

	* app/plug-in/plug-in.c: use registered interpreters when running
	plug-ins.

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders-interp.png: just copied
	folders-plug-ins.png here, need a better one.

	* data/interpreters/Makefile.am: creates system interpreter directory.

	* data/interpreters/default.interp: sample interpreter file info.

	* data/Makefile.am
	* configure.in: add data/interpreters directory.

	* plug-ins/pypicman/Makefile.am: install pypicman.interp, which configures
	the python interpreter to point to the python we were built with. Also
	register the .py extension.

	* etc/picmanrc
	* docs/picmanrc.5.in: regenerated

2005-02-20  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/psd.c: Fix layer mask support.  Addresses bug
	#166976

2005-02-21  Sven Neumann  <sven@picman.org>

	Another step towards color management:

	* modules/Makefile.am
	* modules/cdisplay_lcms.c: added new color display module that
	implements color management for the image displays. Still work
	in progress...

	* modules/cdisplay_proof.c: no need to include <string.h> here.

	* libpicmanconfig/picmancolorconfig.[ch]: added new property
	"display-module" to configure the display color management module.

	* app/display/picmandisplayshell-filter.[ch]
	* app/display/picmandisplayshell.c: create the configured color
	management display filter for each display.

2005-02-20  Sven Neumann  <sven@picman.org>

	* plug-ins/picmanressionist/presets.c (get_object_name): use
	g_filename_display_basename().

2005-02-20  Sven Neumann  <sven@picman.org>

	* app/core/picmangradient-load.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/plug-in/plug-in.c
	* libpicmanbase/picmanutils.c
	* libpicmanmodule/picmanmodule.c
	* libpicmanwidgets/picmanpatheditor.c
	* tools/pdbgen/pdb/image.pdb: use g_filename_display_name() or
	g_filename_display_basename() where appropriate.

	* app/pdb/image_cmds.c: regenerated.

2005-02-20  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: better error reporting.

2005-02-20  Sven Neumann  <sven@picman.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.c[ch]: added actions to control the
	average radius of color picker tools (bug #167765).

	* app/actions/tool-options-actions.c: fixed a typo in a comment.

2005-02-20  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/Makefile.am: attempt to support Win32 (untested).

2005-02-19  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/gtkcons.py
	* plug-ins/pypicman/plug-ins/picmancons.py: Use newer gtkcons widget
	from pygtk. Some cosmetic additions.

2005-02-19  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/py-slice.py: Ignore guides at or beyond
	image bounds, since those aren't valid slicing bounds. Fixes bug
	#167843.

2005-02-20  Sven Neumann  <sven@picman.org>

	* app/dialogs/user-install-dialog.c: migrate picman-2.2 settings if
	available. Pass the version to picman_templates_migrate().

	* app/core/picman-templates.[ch] (picman_templates_migrate): if
	migrating templaterc from ~/.picman-2.0, do a case-insensitive match
	on template names to accommodate for the fact that we changed the
	spelling of some default templates between 2.0 and 2.2.

2005-02-19  Michael Natterer  <mitch@picman.org>

	* app/tools/picmantexttool.c (picman_text_tool_create_layer): block
	the "active-layer-changed" callback while anchoring the floating
	selection so the callback doesn't reset the text tool in the
	middle of adding a new text layer. Fixes bug #166829.

2005-02-19  Hans Breuer  <hans@breuer.org>

	* plug-ins/makefile.msc plug-ins/script-fu/script-fu-server.c :
	now that I'm aware of script-fu-server running on win32 make it
	compile with msvc, too ;)

2005-02-19  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandockable.c
	* app/widgets/picmanhelp-ids.h: added a tooltip and a help-id for the
	dockable menu.

2005-02-19  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/siod-wrapper.c: there is script-fu server on
	Win32. Reverted this change, again!

2005-02-19  Hans Breuer  <hans@breuer.org>

	* app/base/pixel-processor.c : TILE_WIDTH is used unconditionally
	so always include "tile.h"
	* app/base/tile-swap.c : WIN32 needs <process.h> for _getpid()

	* app/dialogs/user-install-dialog.c : include picmanwin32-io.h
	* libpicmanbase/picmanwin32-io.h : there are no group or other
	flags in msvcrt, define S_IGRP etc in terms of _S_IREAD etc

	* plug-ins/script-fu/script-fu.c plug-ins/script-fu/siod-wrapper.c :
	no script-fu server on win32, make respective function calls conditional

	* libpicmanconfig/makefile.msc : new file
	* **/makefile.msc app/picmancore.def : updated, picman builds
	and runs once more with ms toolchain

2005-02-18  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mng.c (mng_save_image): write a DEFI chunk to
	set the frame offset if the layer offsets are != 0, not only if
	they are > 0. Fixes bug #166059.

2005-02-18  Sven Neumann  <sven@picman.org>

	* app/display/picmanstatusbar.c: unset the CAN_FOCUS flag on the
	combo boxes and the cancel button. Set "focus-on-click" to FALSE
	for the combo boxes. Fixes bug #167809.

2005-02-18  Michael Natterer  <mitch@picman.org>

	* libpicman/picmanexport.c (export_dialog): applied patch from Patrice
	Tremblay which sets an alternative button order for the export
	dialog (bug #166678).

2005-02-18  Sven Neumann  <sven@picman.org>

	* app/core/Makefile.am
	* app/core/picmandrawable-convert.[ch]: new files holding
	picman_drawable_convert_rgb() and picman_drawable_convert_grayscale()
	moved out of picmanimage-convert.[ch].

	* app/core/picmanchannel.c
	* app/core/picmanimage-convert.[ch]
	* app/core/picmanlayer.c: changed accordingly.

2005-02-18  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-convert.c: some simple loop unrolling,
	converted tabs to spaces and sprinkled the code with const
	qualifiers.

2005-02-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanviewrenderergradient.c
	(picman_view_renderer_gradient_render): don't attempt to read beyond
	the pre-calculated render buffers, even if the gradient somehow
	has out-of-bounds values. Fixes the crash reported in bug #167604.

2005-02-17  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_main.c: fixed the build for compilers that
	don't support C99 extensions.

2005-02-16  Kevin Cozens  <kcozens@cvs.gnome.org>

	* plug-ins/script-fu/siod-wrapper.c: Added constants MIN-IMAGE-SIZE,
	MAX-IMAGE-SIZE, MIN-RESOLUTION, and MAX-RESOLUTION for use in Script-Fu
	scripts. See comment #4 in bug #167529.

2005-02-17  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainercombobox.c
	* libpicmanwidgets/picmanintcombobox.c: set the "ellipsize" property
	on the text cell-renderer. Not sure if it's a good idea to
	hardcode this for PicmanIntComboBox, but let's give it a try. Fixes
	bug #136676.

2005-02-17  Sven Neumann  <sven@picman.org>

	* plug-ins/help/picman-help-lookup.c: use GOptionContext to parse
	the command-line.

2005-02-16  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: switched to using a thread pool.
	Enables the progress callback for the threaded case.

2005-02-16  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/plug-ins/script-fu/scripts/guides-new.scm:  committted
	slightly modified patch from  Joao S. O. Bueno Calligaris
	to raise guide position limit to 262144.

2005-02-16  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmanclonetool.[ch]: make sure clone source is
	shown in correct display, fixes bug #167002.

2005-02-16  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.[ch]: added a variant of
	pixel_regions_process_parallel() that takes a progress callback and
	progress data. Does only work for the single-threaded case yet.

	* app/core/picmandrawable-blend.c (gradient_fill_region): parallelized.

2005-02-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanimage-contiguous-region.c
	(picman_image_contiguous_region_by_color): parallelized.

	* app/core/picmandrawable-desaturate.c (picman_drawable_desaturate):
	parallelized.

2005-02-16  Sven Neumann  <sven@picman.org>

	* app/core/picmanlayer.c (picman_layer_transform_color): code cleanup.

2005-02-15  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/paint-funcs.[ch]: formatting.

2005-02-15  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.[ch]: changed PicmanImageMapApplyFunc to
	be compatible with PixelProcessorFunc.

	* app/base/color-balance.[ch]
	* app/base/colorize.[ch]
	* app/base/picmanlut.[ch]
	* app/base/hue-saturation.[ch]
	* app/base/threshold.[ch]: removed wrappers that used to
	shift parameters around to match PicmanImageMapApplyFunc and
	PixelProcessorFunc signatures.

	* app/tools/picmanbrightnesscontrasttool.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanposterizetool.c
	* app/tools/picmanthresholdtool.c: changed accordingly.

	* tools/pdbgen/pdb/color.pdb: use pixel_region_process_parallel()
	for all color operations.

	* app/pdb/color_cmds.c: regenerated.

2005-02-15  Sven Neumann  <sven@picman.org>

	* app/main.c (picman_init_malloc): added a comment about the use of
	mallopt() and what could be done instead. Use the TILE_WIDTH and
	TILE_HEIGHT defines to determine the M_MMAP_THRESHOLD value.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c: allocate histogram slots in one large
	block instead of multiple smaller chunks. Hide pointer arithmetic
	in macros.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/dialogs/resolution-calibrate-dialog.c: fix for setups with
	multiple monitors on the same screen (bug #167339).

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.c: fixed gtk-doc comment.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/config/picmanrc-blurbs.h
	* app/dialogs/offset-dialog.c
	* plug-ins/common/displace.c
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm: use the american
	spelling of "behaviour". Fixes bug #167267.

2005-02-14  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_check_uri):
	when appending an extension, update the filename entry so the user
	can see what's going on. Added even more debugging output.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c: simplified the code and avoid
	excessive memory allocations for the threaded case.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.[ch]: allocate temporary histogram slots
	on demand and provide an array with enough slots for the maximum
	number of threads. picman_histogram_new() doesn't need a
	PicmanBaseConfig parameter any longer.

	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-levels.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanthresholdtool.c
	* app/widgets/picmanhistogrameditor.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/pdb/color_cmds.c: regenerated.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.[ch]: define the maximum number of
	threads in the header file.

	* app/config/picmanbaseconfig.c: use the #define.

2005-02-14  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c
	* app/base/pixel-processor.c: use static mutexes.

2005-02-14  Sven Neumann  <sven@picman.org>

	* configure.in: allow to enable the threaded tile-swapper code
	(use at your own risk).

2005-02-13  Sven Neumann  <sven@picman.org>

	* configure.in
	* app/base/tile-cache.c
	* app/base/tile-private.h
	* app/base/tile-swap.c
	* app/base/tile.c: in an attempt to save this code from bit-rot,
	ported the experimental threaded tile-swapper to gthread.

2005-02-13  Sven Neumann  <sven@picman.org>

	* app/base/picmanhistogram.c: port this code to gthread as well.

2005-02-13  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/psd_save.c: Rewrote all the code that deals with
	pixels to be stingy with memory and operate on tile-size chunks.
	Create a flattened copy of the image when necessary. Fixes file
	corruption bug #167139 and memory bug #121871.

2005-02-13  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: some more cleanup; introduced a
	#define to control the number of tiles per thread.

2005-02-13  Sven Neumann  <sven@picman.org>

	* app/base/base.c: fixed typo.

	* app/config/picmanbaseconfig.c: reverted last change,
	"num-processor" doesn't need a confirmation.

2005-02-13  Michael Natterer  <mitch@picman.org>

	* app/file/file-save.[ch]: removed file_save() and renamed
	file_save_as() to file_save() which always requires "uri" and
	"file_proc" to be passed. This functions does no more file_proc by
	extension finding and stuff.

	* app/actions/file-commands.c (file_save_cmd_callback): only call
	file_save() if the image has both uri and save_proc, fall back to
	file_save_as_cmd_callback() otherwise.

	* app/dialogs/file-save-dialog.c: completely chopped and
	reconstructed. Added tons of checks for extension vs. save_proc
	consistency and ask the user if she really wants to save weird
	stuff. Added masive debugging output because I'm far from certain
	that everything is correct.

2005-02-13  Sven Neumann  <sven@picman.org>

	* libpicman*/Makefile.am: s/PICMAN_THREAD_FLAGS/GTHREAD_CFLAGS/

2005-02-13  Sven Neumann  <sven@picman.org>

	* app/base/base.c
	* app/base/tile-swap.[ch]: moved some code from base_init() into
	tile_swap_init().

	* app/base/pixel-processor.[ch]: prepared for porting to GThreadPool.

	* app/config/picmanbaseconfig.c: changed "num-processors" option to
	require a confirmation before being changed.

2005-02-13  Sven Neumann  <sven@picman.org>

	* configure.in: check for gthread-2.0 unless the --disable-mp
	option is given.

	* app/app_procs.c (app_libs_init): call g_thread_init().

	* app/base/pixel-processor.c: ported to GThread.

	* app/Makefile.am
	* app/*/Makefile.am: use @GTHREAD_CFLAGS@.

2005-02-13  Sven Neumann  <sven@picman.org>

	* libpicman/picmanprogress.c (picman_progress_install): fixed typos in
	comment.

	* libpicman/picmanprogress.[ch]: picman_progress_set_text() has boolean
	return value.

2005-02-13  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-exif.c: use context specific labels for the
	action buttons in the rotate confirmation dialog.

2005-02-13  Sven Neumann  <sven@picman.org>

	* app/core/picmanprogress.c (picman_progress_start): accept an empty
	string.

	* app/plug-in/plug-in-progress.c: if NULL is passed as message to
	plug_in_progress_start(), set an empty string on the progress.

	* tools/pdbgen/pdb/progress.pdb:
	* libpicman/picmanprogress.[ch]: wrap the new picman_progress_set_text()
	PDP function with a function that accepts printf-like arguments.

	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* lots of plug-ins, most of them file plug-ins:
	use picman_progress_init(NULL) followed by picman_progress_set_text()
	to initialize the progress using the new API instead of constructing
	a temporary string.

2005-02-12  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_response): use
	gtk_file_chooser_set_uri() to check if a file exists. Seems to
	work reliably even for remote files and fixes the issue i
	mentioned below.

2005-02-12  Sven Neumann  <sven@picman.org>

	Changes suggested in bug #167200:

	* plug-ins/common/unsharp.c: increased maximum value for Amount.

	* app/tools/picmanlevelstool.c: changed increments for gamma
	spinbutton.

	* app/tools/picmancoloroptions.c: increased maximum radius for color
	picking to 300 pixels and made the slider logarithmic.

2005-02-12  Sven Neumann  <sven@picman.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: use picman_progress_set_text().

2005-02-12  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-progress.[ch]
	* tools/pdbgen/pdb/progress.pdb: added new PDB function
	picman_progress_set_text().

	* app/pdb/internal_procs.c
	* app/pdb/progress_cmds.c
	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-02-12  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-progress.c (plug_in_progress_start): only
	set progress value to 0.0 if it isn't 0.0 already. Allows to use
	picman_progress_init() to change the progress message w/o causing
	gtk_progress_bar_set_fraction() to be called.

	* plug-ins/uri/uri-backend-gnomevfs.c: use picman_progress_pulse()
	if the filesize is unknown. Also limit frequency of progress
	updates.

2005-02-12  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: fixed a bug I introduced with my
	latest changes and cleaned up the code further.

2005-02-12  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-open-dialog.c (file_open_dialog_response)
	* app/dialogs/file-save-dialog.c (file_save_dialog_response):
	don't bail out if filename_from_uri() returns NULL. Perform
	checks for G_FILE_TEST_IS_REGULAR and G_FILE_TEST_EXISTS
	only on local files.

	(This brings up the problem that we will overwrite existing remote
	files without warning. Need to fix that before enabling remote
	files in PicmanFileDialog).

2005-02-12  Michael Natterer  <mitch@picman.org>

	* libpicmanbase/picmanbaseenums.h (enum PicmanProgressCommand):
	added PICMAN_PROGRESS_COMMAND_PULSE.

	* libpicmanbase/picmanbaseenums.c
	* plug-ins/pypicman/picmanenums.py
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/picmanpdbprogress.c: implement PicmanProgress::pulse()
	and send a PULSE command to the callback.

	* libpicman/picmanprogress.c: handle PULSE by calling the set_value()
	callback with a value of -1 and document that hack in the API docs.

	* libpicman/picmanprogressbar.c: interpret -1 as request to pulse.

2005-02-12  Sven Neumann  <sven@picman.org>

	* app/core/picmanprogress.[ch]: added PicmanProgress::pulse.

	* app/display/picmandisplay.c
	* app/display/picmanstatusbar.c
	* app/widgets/picmanfiledialog.c
	* app/widgets/picmanprogressbox.c
	* app/widgets/picmanprogressdialog.c
	* app/widgets/picmanthumbbox.c: implement it in the classes that
	implement the PicmanProgress interface.

	* app/plug-in/plug-in-progress.[ch]: allow plug-ins to pulse their
	progress.

	* tools/pdbgen/pdb/progress.pdb: added a procedure for the new
	functionality.

	* app/pdb/internal_procs.c
	* app/pdb/progress_cmds.c
	* libpicman/picmanprogress_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.[ch]: code cleanup. Removed unused code,
	renamed variables and types.

	* app/base/picmanhistogram.c
	* app/core/picmanchannel-combine.c
	* app/core/picmanchannel.c
	* app/core/picmandrawable-equalize.c
	* app/core/picmandrawable-invert.c
	* app/core/picmandrawable-levels.c
	* app/paint-funcs/paint-funcs.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/pdb/color_cmds.c: regenerated.

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/base/pixel-processor.c: include <string.h>.

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: reordered pages in an attempt
	to list important settings first.

2005-02-11  Sven Neumann  <sven@picman.org>

	* configure.in: enable support for multiple processors by default.
	Hyperthreading and multicore CPUs are becoming common and we
	should try to give this as much testing as possible.

	* app/config/picmanbaseconfig.c: use two processors by default. Also
	increased default tile-cache-size to 256MB.

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox.c (toolbox_paste_received): drop
	everything after the first newline and strip leading and trailing
	whitespace from the pasted text.

2005-02-11  Michael Natterer  <mitch@picman.org>

	* app/actions/layers-actions.c (layers_actions): fixed
	"layers-duplicate" action entry.

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/actions/layers-actions.c
	* app/actions/view-actions.c: added shortcuts for New
	Layer (Shift-Ctrl-N, used to be the Navigation Dialog) and
	Duplicate Layer (Shift-Ctrl-D).

2005-02-11  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantoolbox.c: allow to paste URLs and filenames to
	the toolbox using the middle mouse button.

2005-02-10  Manish Singh  <yosh@picman.org>

	* app/file/file-save.c (file_save_as): Make sure filename is
	initialized before use.

2005-02-10  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: use picman_memsize_to_string()
	instead of always showing bytes with a translatable %llu format
	string. Increased BUFSIZE to 4096.

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): don't
	leak the memsize string. Use sizeof(buf) instead of BUFSIZE.

2005-02-10  Michael Natterer  <mitch@picman.org>

	* app/tools/picmancroptool.c
	* app/tools/picmantransformtool.c: alternative button order for
	the info dialogs (bug #166678).

2005-02-10  Sven Neumann  <sven@picman.org>

	* plug-ins/common/displace.c: applied a modified patch from Joao
	S. O. Bueno Calligaris that adds a polar mode to the Displace
	plug-in (bug #161131).

2005-02-10  Sven Neumann  <sven@picman.org>

	* app/file/file-save.c (file_save_as): applied a (slightly
	modified) patch from Shlomi Fish that automatically adds the .xcf
	extension if none is given (bug #165684).

2005-02-10  Sven Neumann  <sven@picman.org>

	* app/actions/data-commands.c
	* app/actions/edit-commands.c
	* app/actions/error-console-commands.c
	* app/actions/file-commands.c
	* app/actions/gradient-editor-commands.c
	* app/actions/gradients-commands.c
	* app/actions/plug-in-commands.c
	* app/actions/templates-commands.c
	* app/actions/text-editor-commands.c
	* app/actions/tool-options-commands.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/resize-dialog.c
	* app/display/picmandisplayshell-close.c
	* app/display/picmandisplayshell-filter-dialog.c
	* app/display/picmandisplayshell-scale.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmantexttool.c
	* libpicman/picmanexport.c
	* libpicmanwidgets/picmancolorbutton.c
	* libpicmanwidgets/picmanfileentry.c
	* libpicmanwidgets/picmanquerybox.c
	* libpicmanwidgets/picmanunitmenu.c: applied another patch by Patrice
	Tremblay to make more dialogs obey the alternative button order
	setting (bug #166678).

2005-02-09  Manish Singh  <yosh@picman.org>

	* app/text/picmanfont-utils.[ch]: new function to workaround pango
	bug #166540, by tacking on a ',' to font names that end in numbers,
	so pango_font_description_from_string doesn't interpret it as a size.

	* app/text/Makefile.am: add above files.

	* app/text/picmanfontlist.c
	* app/text/picmantext-compat.c: use new function.

	* app/text/picmantext-xlfd.c: also make sure font names pulled out
	from XLFD don't end in numbers.

	* app/text/picmanfont.c
	* app/text/picmantextlayout.c: remove some redundant checks.

2005-02-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events):  For testing, apply
	patch switching display-wide grab to app-wide grab while
	handling button-release event, see bug #162823.

2005-02-09  DindinX  <dindinx@picman.org>

	* plug-ins/common/pixelize.c: added a preview.

2005-02-09  Sven Neumann  <sven@picman.org>

	* plug-ins/uri/uri-backend-wget.c: marked strings for translation.

2005-02-09  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmansizeentry.[ch]
	* libpicmanwidgets/picmanwidgets.def: added new function
	picman_size_entry_set_activates_default().

	* app/dialogs/image-new-dialog.c: set the initial focus on the
	Width entry and set the activates_default flag for the size entry.
	Fixes bug #165748.

2005-02-09  Sven Neumann  <sven@picman.org>

	* app/display/picmanscalecombobox.[ch]
	* app/display/picmanstatusbar.c: pass an action label to
	picman_scale_combo_box_add_action().

2005-02-09  Sven Neumann  <sven@picman.org>

	* app/display/picmanscalecombobox.c: fixed brokeness introduced by
	the latest changes.

2005-02-09  Sven Neumann  <sven@picman.org>

	* app/display/picmanscalecombobox.[ch]
	* app/display/picmanstatusbar.c: add an "Other..." item to the scale
	menu in the image window. Somewhat hackish but fixes bug #143747.

2005-02-09  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimagefile.c
	* app/widgets/picmanthumbbox.c: enable explicit (not automatic while
	browsing the list of files) thumbnailing of remote files

2005-02-08  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]
	* app/gui/gui.[ch]
	* app/main.c: simplified initialization by passing GOptionContext
	to app_libs_init() and gui_libs_init().

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/main.c: removed SIGCHLD handler which used to call
	waitpid(-1,...) because this breaks all waitpid(pid,...) calls
	in a non-deterministic way. Apparently it is possible to use both
	SIG_DFL *and* SA_RESTART (SA_RESTART being the original reason
	why the call to sigaction() was introduced).

	* app/plug-in/plug-in.c (plug_in_close): don't have a million
	subsequent if(plug_in->pid) blocks. Put everything into one big
	if(plug_in->pid) block instead. Call g_spawn_close_pid() on all
	platforms instead of using the Win32 CloseHandle().

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/actions/file-actions.c
	* app/actions/image-actions.c
	* app/actions/qmask-actions.c
	* app/actions/tools-actions.c: removed ugly accel_path hacks
	(don't g_object_set_data(action, "picman-accel-path", "foo")).

	* app/widgets/picmanactionview.c (picman_action_view_accel_edited):
	simply use gtk_action_get_accel_path() instead of doing even more
	ugly stuff than above.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/actions/actions.c (action_data_get_widget): return the
	active display's shell instead of the toolbox when called from the
	<Image> popup. Fall back to the toolbox if there is no active
	display. Fixes bug #166012.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* HACKING: updated info about stable CVS branches of modules we
	depend on.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanuimanager.[ch]: removed picman_ui_manager_ui_get()
	and implement the new virtual functions GtkUIManager::get_widget()
	and ::get_action() instead. Menu loading happens transparently now.

	* app/display/picmandisplayshell.c
	* app/widgets/picmandockable.c
	* app/widgets/picmantexteditor.c
	* app/widgets/picmantoolbox.c
	* app/widgets/picmantooloptionseditor.c: use
	gtk_ui_manager_get_widget() instead of the removed
	picman_ui_manager_ui_get().

2005-02-08  Sven Neumann  <sven@picman.org>

	Applied a patch from Patrice Tremblay that makes (almost) all
	dialogs obey the "gtk-alternative-button-order" setting
	(bug #166678). Changes too many files to list them all...

2005-02-08  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: add the gtk+ options to the GOptionContext.

2005-02-08  Sven Neumann  <sven@picman.org>

	* INSTALL: updated.

2005-02-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmangradienteditor.c (picman_gradient_editor_init):
	use "single-line-mode" for the hint labels. Should fix bug #157570.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-constructors.[ch]: undeprecated the
	paint mode menu (ported to PicmanEnumComboBox with separators).
	The separator code is quite hackish and therefore still
	implemented privately here.

	* app/widgets/picmanbrushselect.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanpropwidgets.c: changed accordingly.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* configure.in: depend on GTK+ >= 2.6.0 and pango >= 1.8.0.

	* app/gui/gui.c (gui_sanity_check): changed accordingly.

2005-02-08  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icosave.c: minor cleanup.

2005-02-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/Makefile.am: install sphere.py in unstable
	releases only.

2005-02-08  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/sphere.py
	* plug-ins/pypicman/plug-ins/picmancons.py
	* plug-ins/pypicman/plug-ins/pdbbrowse.py: Just leave imagetypes empty,
	since we don't operate on existing images here. Fixes bug #166650.

2005-02-08  Michael Natterer  <mitch@picman.org>

	* app/gui/gui.c (gui_display_changed): if display became NULL
	(e.g. by closing a view) and we decide to activate another view
	of the same image, stop the emission of the original
	"display-changed" signal so it doesn't affect the toolbox'
	UI manager. Fixes bug #159304.

2005-02-08  Sven Neumann  <sven@picman.org>

	* plug-ins/winicon/icosave.c (ico_image_get_reduced_buf): fixed
	bug in save routine for 256-slot palette (bug #162742).

2005-02-08  Sven Neumann  <sven@picman.org>

	* configure.in: added automake conditional PICMAN_UNSTABLE.

	* plug-ins/script-fu/scripts/Makefile.am: install test-sphere.scm
	in unstable releases only.

2005-02-08  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmancolorconfig-enums.[ch]: picman-mkenums doesn't
	seem to like newlines in enum definitions.

	* libpicmanconfig/picmancolorconfig.[ch]: removed the "profile-path"
	property for now. It doesn't work too well with PicmanFileEntry.
	We can add it back later if it turns out that we really need it.

	* app/dialogs/preferences-dialog.c
	* app/widgets/picmanhelp-ids.h: added a color management page to the
	preferences dialog.

2005-02-07  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend.h: added backend methods for saving to
	URIs.

	* plug-ins/uri/uri.c: register a save procecure if the save method
	is available, using some code from compressor.c

	* plug-ins/uri/uri-backend-gnomevfs.c: implement saving.

	* plug-ins/uri/uri-backend-wget.c: added saving stubs which always
	fail.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanfiledialog.c (picman_file_dialog_add_filters): add
	an "All Images" filter and select it by default.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanselectiondata.c
	* plug-ins/help/domain.c
	* plug-ins/helpbrowser/dialog.c: fixed my latest changes.

2005-02-07  Michael Natterer  <mitch@picman.org>

	* app/dialogs/file-open-location-dialog.c
	(file_open_location_dialog_new): set "activates-default" on the
	URI entry.

2005-02-07  Sven Neumann  <sven@picman.org>

	* plug-ins/help/domain.c
	* plug-ins/helpbrowser/dialog.c: same trick here; should allow to
	work with help files installed in an UNC path.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/widgets/picmanthumbbox.c: use file_utils_filename_from_uri()
	in some more places.

	* app/dialogs/file-open-location-dialog.c
	* app/widgets/picmanselectiondata.c: deal with hostname in URIs.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagefile.c (picman_imagefile_get_desc_string):
	changed "Remote Image" to "Remote File". The state of the
	thumbnail doesn't tell us if this is an image file at all.

	* app/widgets/picmanthumbbox.c: don't auto-thumbnail remote files.

	* libpicmanthumb/picmanthumb-utils.[ch]
	* libpicmanthumb/picmanthumbnail.c: do the same workaround for UNC
	paths as in file_utils_filename_from_uri().

2005-02-07  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend.h: added backend methods
	uri_backend_init() and uri_backend_shutdown().

	* plug-ins/uri/uri.c: call them around using other backend
	functions (both in query() and run()).

	* plug-ins/uri/uri-backend-gnomevfs.c: moved init()/shutdown() of
	GnomeVFS into the new backend methods. Create the list of
	supported protocols dynamically. Get rid of one translatable
	string.

	* plug-ins/uri/uri-backend-wget.c: implement the new methods as
	empty stubs which always succeed.

2005-02-07  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/Makefile.am
	* libpicmanconfig/picmanconfig.def
	* libpicmanconfig/picmanconfig.h
	* libpicmanconfig/picmanconfigtypes.h: install the PicmanColorConfig
	header and include it.

	* libpicmanconfig/picmancolorconfig.[ch]: commented out some options
	that will only be needed later and that will most likely undergo
	some changes.

	* app/config/picmancoreconfig.[ch]
	* app/config/picmanrc-blurbs.h: added PicmanColorConfig to PicmanRc.

2005-02-07  Michael Natterer  <mitch@picman.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: fixed wrong use of
	GnomeVFSFileInfo (it wants to be allocated and unrefed). Extended
	the list of supported prefixes (still conceptually broken).

2005-02-07  Sven Neumann  <sven@picman.org>

	* HACKING
	* autogen.sh: dropped support for automake 1.6, automake >= 1.7 is
	now required.

	* configure.in: removed cruft that was there only for automake 1.6.

2005-02-07  Michael Natterer  <mitch@picman.org>

	* configure.in: check for gnome-vfs-2.0

	* plug-ins/uri/Makefile.am
	* plug-ins/uri/uri-backend-gnomevfs.c: new file which is built
	instead of the wget backend if GnomeVFS is available.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-file.c
	* app/file/file-utils.c
	* app/gui/themes.c
	* app/tools/picmanimagemaptool.c
	* app/vectors/picmanvectors-export.c
	* app/widgets/picmanwidgets-utils.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/procedural_db.pdb: use gstdio wrappers.

	* app/pdb/procedural_db_cmds.c: regenerated.

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/base/base.c
	* app/base/temp-buf.c
	* app/base/tile-swap.c
	* app/config/picmanconfig-file.c
	* app/core/picmanbrush.c
	* app/core/picmanbrushgenerated.c
	* app/core/picmanbrushpipe.c
	* app/core/picmandata.c
	* app/core/picmanenvirontable.c
	* app/core/picmangradient-load.c
	* app/core/picmangradient-save.c
	* app/core/picmanpalette-import.c
	* app/core/picmanpalette.c
	* app/core/picmanpattern.c
	* app/dialogs/user-install-dialog.c
	* app/gui/session.c
	* app/menus/menus.c
	* app/widgets/picmandevices.c: use gstdio wrappers.

2005-02-07  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmandatafiles.c
	* libpicmanbase/picmanenv.c
	* libpicmanconfig/picmanconfigwriter.c
	* libpicmanconfig/picmanscanner.c
	* libpicmanthumb/picmanthumb-utils.c
	* libpicmanthumb/picmanthumbnail.c: include gstdio.h.

2005-02-07  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmandatafiles.c
	* libpicmanbase/picmanenv.c
	* libpicmanconfig/picmanconfigwriter.c
	* libpicmanconfig/picmanscanner.c
	* libpicmanthumb/picmanthumb-utils.c
	* libpicmanthumb/picmanthumbnail.c: use gstdio wrappers.
	Unfortunately this causes compiler warnings, see bug #166512.

2005-02-07  Sven Neumann  <sven@picman.org>

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/color-management.png: added
	icon for the yet to be added color management preferences page.
	Icon kindly provided by Alastair M. Robinson (bug #78265).

2005-02-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmantooldialog.c (picman_tool_dialog_new): unset the
	"focus-on-map" property for tool dialogs. Fixes bug #154651 (on
	window managers supporting this hint).

2005-02-06  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/Makefile.am
	* libpicmanconfig/picmancolorconfig-enums.[ch]
	* libpicmanconfig/picmancolorconfig.[ch]: added a first draft of a
	color management configuration object. Not yet installed nor used
	by anything. This is based on an older patch by Stefan DÃ¶hla.

2005-02-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/unsharp.c:  apply speedup proposed
	by Peter Heckert in bug #166406.

2005-02-06  Sven Neumann  <sven@picman.org>

	* configure.in: removed traces of url plug-in.

	* plug-ins/Makefile.am: don't build uri on Win32 (for now).

2005-02-06  Sven Neumann  <sven@picman.org>

	* configure.in: added $(EXEEXT) to picman-remote so it can be built
	on Win32 when compiling for GTK+-X11.

2005-02-06  Michael Natterer  <mitch@picman.org>

	* plug-ins/common/url.c: removed.

	* plug-ins/common/plugin-defs.pl: changed accordingly.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am: regenerated.

	* configure.in
	* plug-ins/Makefile.am: added the "uri" subdir.

	* plug-ins/uri/.cvsignore
	* plug-ins/uri/Makefile.am
	* plug-ins/uri/uri-backend-wget.c
	* plug-ins/uri/uri-backend.h
	* plug-ins/uri/uri.c: new files: split uri plug-in into common and
	backend-specific code that will soon optionally use gnomre-vfs.

	Also treat everything after the basename's first dot as extension,
	not after the last dot, so opening "foo.ext.gz" doesn't trigger
	warnings from the compressor plug-in.

2005-02-06  Sven Neumann  <sven@picman.org>

	* app/main.c: moved call to sanity_check() after the
	initialization of gtk+ so that the error message can be displayed.

2005-02-05  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollers.c (picman_controllers_init): removed
	some eeeky code that used to fiddle with the PicmanController type.

	* libpicmanwidgets/picmancontroller.c (picman_controller_get_type): add
	the PicmanConfig interface here, where it belongs.

2005-02-05  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: there's no longer a need to keep a
	pointer to the widget returned by PicmanColorDisplay::configure.

2005-02-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolordisplay.[ch]: deprecate the
	implementation of the class methods clone, load_state, save_state
	and configure_reset and implement them in the base class using the
	PicmanConfigInterface.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: removed deprecated implementations here.

2005-02-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancolordisplay.c: add the PicmanConfig interface
	in the PicmanColorDisplay class...

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: ... instead of adding it in each
	implementation.

2005-02-05  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c
	(picman_display_shell_canvas_tool_events): switched meaning of Ctrl
	and Shift modifiers used with the mouse scroll wheel. The HIG
	suggests to use Ctrl for zooming and it makes PICMAN more consistent
	with other apps (for example Inkscape).

2005-02-05  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-params.h: renamed PICMAN_PARAM_ #defines
	to PICMAN_CONFIG_PARAM_.

	* app/config/picmanbaseconfig.c
	* app/config/picmanconfig-dump.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanrc-deserialize.c
	* app/config/picmanrc-serialize.c
	* app/config/picmanrc.c
	* app/core/picman.c
	* app/core/picmanstrokedesc.c
	* app/dialogs/preferences-dialog.c
	* app/text/picmantext.c
	* app/tools/picmantextoptions.c
	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-iface.c
	* libpicmanconfig/picmanconfig-serialize.c
	* libpicmanconfig/picmanconfig-utils.c: changed accordingly.

	* libpicmanmodule/picmanmoduletypes.h: deprecate the
	PICMAN_MODULE_PARAM_SERIALIZE #define, PICMAN_CONFIG_PARAM_SERIALIZE
	should be used instead.

	* modules/controller_linux_input.c
	* modules/controller_midi.c: changed accordingly.

2005-02-05  Sven Neumann  <sven@picman.org>

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: ported all ColorDisplay modules to
	PicmanConfig.

2005-02-05  Sven Neumann  <sven@picman.org>

	* modules/Makefile.am: link ColorDisplay modules with libpicmanconfig.

	* modules/cdisplay_colorblind.c: added the PicmanConfig interface
	and use it.

2005-02-05  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpropwidgets.[ch]: documentation fixes.

2005-02-05  Dave Neary  <bolsh@picman.org>

	* tools/picman-remote.c: Added locale.h to the headers
	included - fixes the build.

2005-02-04  Manish Singh  <yosh@picman.org>

	* app/widgets/picmanpropwidgets.h: readd declaration of
	picman_prop_paint_mode_menu_new().

2005-02-04  Manish Singh  <yosh@picman.org>

	* picmanui.pc.in: add libpicmanconfig to Libs.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	added dependencies in wrong spot, fixed.  Same list of
	files as for previous commit.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/Makefile.am
	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/bmp/Makefile.am
	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/faxg3/Makefile.am
	* plug-ins/fits/Makefile.am
	* plug-ins/flame/Makefile.am
	* plug-ins/gfig/Makefile.am
	* plug-ins/gflare/Makefile.am
	* plug-ins/gfli/Makefile.am
	* plug-ins/picmanressionist/Makefile.am
	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/ifscompose/Makefile.am
	* plug-ins/imagemap/Makefile.am
	* plug-ins/jpeg/Makefile.am
	* plug-ins/maze/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/print/Makefile.am
	* plug-ins/pypicman/Makefile.am
	* plug-ins/rcm/Makefile.am
	* plug-ins/script-fu/Makefile.am
	* plug-ins/sel2path/Makefile.am
	* plug-ins/sgi/Makefile.am
	* plug-ins/twain/Makefile.am
	* plug-ins/winicon/Makefile.am
	* plug-ins/winsnap/Makefile.am
	* plug-ins/xjt/Makefile.am: ouch, broke build badly, needed to
	add libpicmanconfig dependencies after moving picmanpropwidgets.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanpropwidgets.[ch]: oops, use libpicman header.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanpropwidgets.[ch]: magic-copied from app/widgets
	and un-movable things then removed.

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgets.h: corresponding changes

	* app/widgets/picmanpropwidgets.[ch]: remove functions that were
	moved.

	* app/dialogs/stroke-dialog.c
	* app/dialogs/tips-dialog.c
	* app/dialogs/user-install-dialog.c
	* app/tools/picmanairbrushtool.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmanclonetool.c
	* app/tools/picmancoloroptions.c
	* app/tools/picmancolorpickeroptions.c
	* app/tools/picmanconvolvetool.c
	* app/tools/picmancropoptions.c
	* app/tools/picmancurvestool.c
	* app/tools/picmandodgeburntool.c
	* app/tools/picmanerasertool.c
	* app/tools/picmanflipoptions.c
	* app/tools/picmanhistogramoptions.c
	* app/tools/picmanimagemaptool.c
	* app/tools/picmaninkoptions-gui.c
	* app/tools/picmanlevelstool.c
	* app/tools/picmanmagnifyoptions.c
	* app/tools/picmanmeasureoptions.c
	* app/tools/picmanmoveoptions.c
	* app/tools/picmanselectionoptions.c
	* app/tools/picmansmudgetool.c
	* app/tools/picmanthresholdtool.c
	* app/tools/picmantransformoptions.c
	* app/tools/picmanvectoroptions.c
	* app/widgets/picmancontainerbox.c
	* app/widgets/picmancontrollereditor.c
	* app/widgets/picmandevicestatus.c
	* app/widgets/picmangrideditor.c
	* app/widgets/picmanhistogrambox.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmansizebox.c
	* app/widgets/picmanstrokeeditor.c
	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmantooloptionseditor.c: fix includes.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg-exif.c: check validity of orientation
	value before using, see bug #166248.

2005-02-03  Sven Neumann  <sven@picman.org>

	* app/file/file-utils.[ch]: added new utility function
	file_utils_filename_from_uri().

	* app/file/file-open.c (file_open_image)
	* app/file/file-save.c (file_save_as):
	* app/file/file-utils.c (file_utils_find_proc)
	(file_utils_uri_to_utf8_filename): replaced calls to
	g_filename_from_uri() with file_utils_filename_from_uri().

2005-02-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanpropwidgets.c:  add gtk-doc comments to
	public functions in prep for moving to libpicmanwidgets.

2005-02-03  Michael Natterer  <mitch@picman.org>

	* app/dialogs/print-size-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/scale-dialog.c: moved "Reset" buttons left of "Cancel".

2005-02-03  Sven Neumann  <sven@picman.org>

	* tools/Makefile.am
	* tools/picman-remote.c: allow to localize picman-remote.

	* app/main.c: changed a string so it can be shared with picman-remote.

2005-02-03  Michael Natterer  <mitch@picman.org>

	* app/actions/help-commands.c (help_context_help_cmd_callback):
	for consistency, use return_if_no_widget() instead of
	action_data_get_widget()

2005-02-03  Michael Natterer  <mitch@picman.org>

	* app/dialogs/image-scale-dialog.c (image_scale_dialog_new): use
	the passed parent widget instead of display->shell.

2005-02-03  Sven Neumann  <sven@picman.org>

	* tools/picman-remote.c: ported to GOption command-line parser.

2005-02-03  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_do): fixed handling of
	pixel region that broke with my latest change. Fixes bug #166126.

2005-02-03  Sven Neumann  <sven@picman.org>

	* app/main.c: some cleanup in main().

2005-02-03  Michael Natterer  <mitch@picman.org>

	* app/sanity.c (sanity_check_glib): there is no such thing as GLib+

2005-02-03  Sven Neumann  <sven@picman.org>

	* app/app_procs.[ch]
	* app/main.c: let the GLib command-line parser deal with the
	remaining arguments and pass a string array to app_run().

2005-02-03  Sven Neumann  <sven@picman.org>

	* app/main.c: more work on the command-line option parser.

2005-02-02  Michael Natterer  <mitch@picman.org>

	* app/core/picman-utils.[ch] (picman_check_glib_version): removed this
	function.

	* app/sanity.c (sanity_check_glib): use glib_check_version()
	instead and set required version to 2.6.0.

2005-02-02  Sven Neumann  <sven@picman.org>

	* configure.in: depend on glib >= 2.6.0.

	* app/main.c: use the new GLib commandline option parser. Still
	work in progress.

2005-02-02  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-convert.c (picman_image_convert): relax/rigor
	the floating selection around the convert operations so color
	analysis for indexed conversion works on the floating selection's
	drawable original pixels, and not on the composited one.
	Fixes bug #165342.

2005-02-02  Sven Neumann  <sven@picman.org>

	* data/misc/picman.desktop.in.in (_Name): experimentally expand the
	PICMAN acronym. Not sure if this is a good idea at all...

2005-02-01  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c (picman_image_map_do): tiny optimization
	based on a patch by Bill Skaggs. Process up to 16 tiles in one go
	before updating the display.

2005-01-31  Sven Neumann  <sven@picman.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-new-rect-select-16.png
	* themes/Default/images/tools/stock-tool-new-rect-select-22.png
	* libpicmanwidgets/picmanstock.[ch]: removed the new icon again;
	there's no point in adding a stock icon temporarily.

	* app/tools/picmannewrectselecttool.c: changed accordingly.

2005-01-31  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmannewrectselecttool.[ch]: new rectangle select tool

	* app/tools/Makefile.am
	* app/tools/picman-tools.c: add it to toolbox

	* app/tools/picmanselectionoptions.[ch]: set its options

	* themes/Default/images/tools/stock-tool-new-rect-select-16.png
	* themes/Default/images/tools/stock-tool-new-rect-select-22.png:
	toolbox icon

	* libpicmanwidgets/picmanstock.[ch]
	* themes/Default/images/Makefile.am: add the toolbox icon

2005-01-31  Michael Natterer  <mitch@picman.org>

	Some cleanup to make plug-in menu creation less hackish and
	finally enable registering plug-in menu entries in much more UI
	managers (not only in the image and toolbox menus):

	* app/menus/menus.c: added a <Toolbox> UI manager instead of
	creating the toolbox menu from the <Image> UI manager.

	* app/widgets/picmanimagedock.[ch]: removed the ui_manager and the
	signal connections to update it...

	* app/widgets/picmandock.[ch]: ...and added them here so all docks
	have their own UI manager. Determine which manager to create from
	looking at PicmanDockClass::ui_manager_name (defaults to <Dock>).

	* app/widgets/picmantoolbox.c: set ui_manager_name to <Toolbox> and
	use the UI manager created by our parent class instead of using
	the <Image> one.

	(toolbox_create_tools): use picman_action_get_accel_closure()
	instead of doing evil hacks.

	* app/gui/gui-vtable.c
	* app/menus/plug-in-menus.c: removed lots of special casing of the
	<Image> UI manager. The code is almost ready for allowing plug-in
	menus under <Layers>, <Channels>, <Brushes> etc.

2005-01-30  Sven Neumann  <sven@picman.org>

	* app/core/picmanimagemap.c: formatting.

2005-01-29  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libpicmanbase/picmanbase.def: added picman_path_parse
	* libpicmanmath/picmanmath.def: added picman_param_spec_matrix2

2005-01-29  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-error.c
	* libpicmanconfig/picmanconfig-iface.c
	* libpicmanconfig/picmanconfig-path.c
	* libpicmanconfig/picmanconfig-serialize.c
	* libpicmanconfig/picmanconfig-utils.c
	* libpicmanconfig/picmanconfigwriter.c
	* libpicmanconfig/picmanscanner.c: use libpicman header,
	added "Since: PICMAN 2.4" to the gtk-doc comments.

2005-01-29  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumwidgets.[ch]: use libpicman header,
	added "Since: PICMAN 2.4" to the gtk-doc comments.

2005-01-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmanenumwidgets.c
	* app/widgets/picmanenumwidgets.h: magic-moved from here...

	* libpicmanwidgets/picmanenumwidgets.c
	* libpicmanwidgets/picmanenumwidgets.h: ...to here.

	* app/dialogs/convert-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/dialogs/layer-options-dialog.c
	* app/tools/picmancolorbalancetool.c
	* app/tools/picmancroptool.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/Makefile.am
	* app/widgets/picmanbrusheditor.c
	* app/widgets/picmaneditor.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmantemplateeditor.c
	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgets.h: all changed accordingly.
	Still need to do devel-docs.

2005-01-28  Michael Natterer  <mitch@picman.org>

	* app/actions/Makefile.am
	* app/actions/window-actions.[ch]: new files holding utility
	functions to create actions to move windows to other screens.

	* app/actions/dock-actions.c
	* app/actions/dock-commands.[ch]
	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]: use the new actions instead of
	the change screen dialog.

	* app/menus/Makefile.am
	* app/menus/window-menu.[ch]: new files which create menu items
	for above actions.

	* app/menus/dockable-menu.[ch]: new files using above window-menu
	utility functions.

	* app/menus/image-menu.c: use them here too.

	* app/menus/menus.c: set a setup_func for the "<Dockable>"
	UI manager.

	* menus/dockable-menu.xml.in
	* menus/image-menu.xml.in: changed accordingly.

2005-01-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicman/picmandrawablepreview.c: set preview bounds correctly
	when previewed drawable extends beyond image edges,
	fixes bug #165372.

2005-01-27  Manish Singh  <yosh@picman.org>

	* README: update ancient IRC info.

2005-01-27  Sven Neumann  <sven@picman.org>

	* app/core/picmangrid.c: changed default grid distance to 32 as
	suggested in bug #165367.

2005-01-26  Manish Singh  <yosh@picman.org>

	* libpicmanconfig/Makefile.am: make LIBADD really work.

	* Makefile.am: build libpicmanconfig after libpicmancolor and libpicmanmath.

2005-01-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg-exif.c:  libexif can return a result
	even for files without exif, need to validate it.

2005-01-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanconfig/Makefile.am: add necessary stuff to
	LIBADD -- reported by schumaml, fix explained by yosh.

2005-01-26  Michael Natterer  <mitch@picman.org>

	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/picmanrc.pdb: fixed includes after libpicmanconfig
	file moving. Reported by Volker Sturm.

	* app/pdb/picmanrc_cmds.c: regenerated.

2005-01-26  Michael Natterer  <mitch@picman.org>

	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.[ch]: removed dock-related
	actions (show-image-menu, auto-follow-active and move-to-screen).

	* app/actions/dock-actions.c
	* app/actions/dock-commands.[ch]: and added them here.

	* app/menus/menus.c: add the "dock" action group to the
	"<Dockable>" UI Manager.

	* app/widgets/picmanhelp-ids.h: reordered to match the new grouping.

	* menus/dockable-menu.xml.in: changed accordingly.

2005-01-26  RaphaÃ«l Quinet  <raphael@picman.org>

	* app/composite/picman-composite-generic.c: minor doc fix for
	formula used by picman_composite_multiply_any_any_any_generic().

2005-01-26  Sven Neumann  <sven@picman.org>

	* libpicmanconfig/picmanconfig-path.h: added declarations for the
	picman_config_build_path functions.

	* app/config/Makefile.am
	* app/config/picmanrc-utils.[ch]: removed these two files again;
	they used to duplicate functionality from libpicmanconfig.

	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c: changed accordingly.

2005-01-26  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanpath.[ch]: removed these two files again.

	* libpicmanconfig/picmanconfig-path.[ch]: merged the path type and
	param spec here. Renamed to PicmanConfigPath and PicmanParamConfigPath.

	* libpicmanbase/picmanbase.h
	* libpicmanbase/picmanbasetypes.[ch]
	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-params.h
	* app/config/picmanbaseconfig.c
	* app/config/picmanconfig-dump.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c
	* app/widgets/picmanpropwidgets.c: changed accordingly.

	* libpicmanbase/picmanbase.def: updated.

2005-01-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanconfig/picmanconfig.def: added

2005-01-25  Michael Natterer  <mitch@picman.org>

	* libpicmanconfig/picmanconfigtypes.h: new file holding the opaque
	typedefs for libpicmanconfig. Includes "libpicmanbase/picmanbasetypes.h"

	* libpicmanconfig/Makefile.am: added the new file. Removed stuff
	that is not needed.

	* libpicmanconfig/picmanconfigwriter.h
	* libpicmanconfig/picmanconfig-iface.h: removed typedefs here.

	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-iface.c
	* libpicmanconfig/picmanconfig-serialize.c
	* libpicmanconfig/picmanconfig-utils.c
	* libpicmanconfig/picmanconfig.h
	* libpicmanconfig/picmanconfigwriter.c: include it before including
	any other libpicmanconfig stuff.

	* app/config/config-types.h: #include "libpicmanbase/picmanbasetypes.h"

	* app/config/picmanconfig-utils.h: changed include guards to
	__APP_PICMAN_CONFIG_UTILS_H__.

	* app/dialogs/tips-parser.c: include <glib-object.h> instead of
	just <glib.h>.

	* app/tools/picmanhistogramoptions.c
	* app/tools/picmantextoptions.c: include "config/picmanconfig-utils.h"

	* app/widgets/picmandialogfactory.h
	* app/widgets/picmansessioninfo.h: removed inclusion of
	"libpicmanconfig/picmanconfig.h".

2005-01-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-deserialize.h
	* app/config/picmanconfig-error.c
	* app/config/picmanconfig-error.h
	* app/config/picmanconfig-params.h
	* app/config/picmanconfig-path.c
	* app/config/picmanconfig-path.h
	* app/config/picmanconfig-serialize.c
	* app/config/picmanconfig-serialize.h
	* app/config/picmanconfig.c
	* app/config/picmanconfig.h
	* app/config/picmanconfigwriter.c
	* app/config/picmanconfigwriter.h
	* app/config/picmanscanner.c
	* app/config/picmanscanner.h: removed

	* libpicmanconfig/picmanconfig-deserialize.c
	* libpicmanconfig/picmanconfig-deserialize.h
	* libpicmanconfig/picmanconfig-error.h
	* libpicmanconfig/picmanconfig-iface.c
	* libpicmanconfig/picmanconfig-iface.h
	* libpicmanconfig/picmanconfig-params.h
	* libpicmanconfig/picmanconfig-path.c
	* libpicmanconfig/picmanconfig-path.h
	* libpicmanconfig/picmanconfig-serialize.c
	* libpicmanconfig/picmanconfig-serialize.h
	* libpicmanconfig/picmanconfig-utils.c
	* libpicmanconfig/picmanconfig-utils.h
	* libpicmanconfig/picmanconfig.h
	* libpicmanconfig/picmanconfigwriter.c
	* libpicmanconfig/picmanconfigwriter.h
	* libpicmanconfig/picmanscanner.c
	* libpicmanconfig/picmanscanner.h: copied from app/config
	by yosh.

	* libpicmanconfig/.cvsignore: added

	* libpicmanconfig/Makefile.am: modified

	* Makefile.am
	* configure.in
	* app/Makefile.am
	* app/actions/templates-commands.c
	* app/actions/tool-options-commands.c
	* app/base/base.c
	* app/base/temp-buf.c
	* app/config/Makefile.am
	* app/config/config-types.h
	* app/config/picmanconfig-utils.c
	* app/config/picmanconfig-utils.h
	* app/config/picmanconfig-file.c
	* app/config/picmanconfig-dump.c
	* app/config/picmanbaseconfig.c
	* app/config/picmancoreconfig.c
	* app/config/picmandisplayconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c
	* app/config/picmanrc-deserialize.c
	* app/config/picmanrc-serialize.c
	* app/config/picmanrc-unknown.c
	* app/config/picmanrc.c
	* app/config/test-config.c
	* app/core/picman-documents.c
	* app/core/picman-modules.c
	* app/core/picman-parasites.c
	* app/core/picman-templates.c
	* app/core/picman-units.c
	* app/core/picman.c
	* app/core/picmancontainer.c
	* app/core/picmancontext.c
	* app/core/picmandatafactory.c
	* app/core/picmandocumentlist.c
	* app/core/picmangrid.c
	* app/core/picmanimage-duplicate.c
	* app/core/picmanimage-grid.c
	* app/core/picmanimage-new.c
	* app/core/picmanimage-undo-push.c
	* app/core/picmanimage.c
	* app/core/picmanparasitelist.c
	* app/core/picmanstrokedesc.c
	* app/core/picmanstrokeoptions.c
	* app/core/picmantemplate.c
	* app/core/picmantoolinfo.c
	* app/core/picmantooloptions.c
	* app/core/picmanviewable.c
	* app/dialogs/grid-dialog.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/dialogs/template-options-dialog.c
	* app/display/picmandisplayoptions.c
	* app/display/picmandisplayshell.c
	* app/gui/color-history.c
	* app/gui/session.c
	* app/gui/themes.c
	* app/paint/picmanairbrushoptions.c
	* app/paint/picmancloneoptions.c
	* app/paint/picmanconvolveoptions.c
	* app/paint/picmandodgeburnoptions.c
	* app/paint/picmaneraseroptions.c
	* app/paint/picmaninkoptions.c
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanpenciloptions.c
	* app/paint/picmansmudgeoptions.c
	* app/pdb/fileops_cmds.c
	* app/pdb/picmanrc_cmds.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.c
	* app/text/picman-fonts.c
	* app/text/picmantext-parasite.c
	* app/text/picmantext.c
	* app/text/picmantextlayer.c
	* app/text/picmantextundo.c
	* app/tools/picman-tools.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmanbucketfilloptions.c
	* app/tools/picmancoloroptions.c
	* app/tools/picmancolorpickeroptions.c
	* app/tools/picmancolorpickertool.c
	* app/tools/picmancropoptions.c
	* app/tools/picmancroptool.c
	* app/tools/picmanflipoptions.c
	* app/tools/picmanhistogramoptions.c
	* app/tools/picmanimagemapoptions.c
	* app/tools/picmanmagnifyoptions.c
	* app/tools/picmanmeasureoptions.c
	* app/tools/picmanmoveoptions.c
	* app/tools/picmanpaintoptions-gui.c
	* app/tools/picmanselectionoptions.c
	* app/tools/picmantextoptions.c
	* app/tools/picmantexttool.c
	* app/tools/picmantransformoptions.c
	* app/tools/picmantransformtool.c
	* app/tools/picmanvectoroptions.c
	* app/widgets/picmancolorbar.c
	* app/widgets/picmancontrollerinfo.c
	* app/widgets/picmancontrollers.c
	* app/widgets/picmandasheditor.c
	* app/widgets/picmandeviceinfo.c
	* app/widgets/picmandevices.c
	* app/widgets/picmandialogfactory.h
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmansessioninfo.c
	* app/widgets/picmansessioninfo.h
	* app/widgets/picmansizebox.c
	* app/widgets/picmantemplateeditor.c
	* app/widgets/picmantemplateview.c: changed accordingly

	Moving things from app/config to libpicmanconfig.

2005-01-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libpicmanconfig/Makefile.am
	* libpicmanconfig/picmanconfig.h: setting up for libpicmanconfig

2005-01-24  Sven Neumann  <sven@picman.org>

	* app/config/Makefile.am
	* app/config/picmanconfig-file.[ch]
	* app/config/picmanrc-utils.[ch]: more new files, code factored out
	of picmanconfig-utils.[ch].

	* app/config/picmanconfig-path.[ch]
	* app/config/picmanconfig-utils.[ch]
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c
	* app/config/picmanrc.c
	* app/core/picman-units.c
	* app/dialogs/user-install-dialog.c
	* app/gui/session.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.[ch]: removed an unused parameter.

	* app/config/picmanconfig.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@picman.org>

	* app/config/picmanconfig-deserialize.[ch]
	* app/config/picmanconfig-serialize.[ch]
	* app/config/picmanconfig.[ch]: factored out some rather obscure
	PicmanConfig features that were added solely for picmanrc.

	* app/config/Makefile.am
	* app/config/picmanrc-deserialize.[ch]
	* app/config/picmanrc-serialize.[ch]
	* app/config/picmanrc-unknown.[ch]: moved picmanrc-specific code to
	these new files.

	* app/config/picmanrc.c
	* app/config/test-config.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanenumcombobox.c
	* libpicmanwidgets/picmanenumstore.[ch]: improved API docs.

2005-01-24  Michael Natterer  <mitch@picman.org>

	Enabled closing docks with Ctrl-W:

	* app/actions/Makefile.am
	* app/actions/dock-actions.[ch]
	* app/actions/dock-commands.[ch]: added new action group which
	holds a single action, "dock-close".

	* app/actions/actions.c: register the "dock" group.

	* app/menus/menus.c: add it to the "<Dock>" UI manager.

	* app/widgets/picmanhelp-ids.h: added PICMAN_HELP_DOCK_CLOSE.

2005-01-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/picmancroptool.c (crop_aspect_changed): don't
	accept aspect ratios that make image less than 1 byte high,
	fixes bug #164827.

2005-01-23  Sven Neumann  <sven@picman.org>

	* plug-ins/MapObject/Makefile.am (MapObject_SOURCES): added
	arcball.c; it isn't used but it doesn't hurt to have it in the
	tarball in case someone wants to resurrect this functionality.

2005-01-23  Sven Neumann  <sven@picman.org>

	* plug-ins/common/edge.c: don't read beyond the src buffer. Fixes
	bug #164963.

2005-01-23  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_misc.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_selection.c: more conversion to action based
	menus. Still have to attach some actions.

2005-01-23  Sven Neumann  <sven@picman.org>

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbaseparams.[ch]: removed this file again.

	* libpicmanbase/picmanmemsize.[ch]
	* libpicmanbase/picmanpath.[ch]
	* libpicmanbase/picmanunit.[ch]: moved the paramspec definitions to
	the types they belong to.

	* libpicmanbase/picmanbase.h: changed accordingly.

	* libpicmanwidgets/Makefile.am (libpicmanwidgetsinclude_HEADERS):
	install the new header files.

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/text/text-enums.h
	* libpicmanbase/picmanbaseenums.h: moved enum to libpicmanbase (from
	app/text and libpicman).

	* libpicman/picmanenums.h
	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def
	* libpicman/picman.def: updated.

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/actions/dialogs-actions.c (dialogs_actions): set Ctrl-B as
	default shortcut to raise the Toolbox (as suggested in bug #163368).

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/paint/paint-enums.h
	* libpicmanbase/picmanbaseenums.h: moved enums to libpicmanbase (from
	app/paint and libpicman). The remaining enums in
	app/paint/paint-enums.h need special treatment.

	* app/paint/paint-enums.c:
	* libpicman/picmanenums.h
	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def
	* libpicman/picman.def: updated.

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-enums.h: new file with enums moved from ...

	* app/plug-in/plug-in-types.h: ... here.

	* tools/pdbgen/Makefile.am (enum_headers): changed accordingly.

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/core/core-enums.h
	* libpicmanbase/picmanbaseenums.h: moved enums to libpicmanbase (from
	app/core and libpicman). The remaining enums in app/core/core-enums.h
	need special treatment.

	* app/core/core-enums.c:
	* libpicman/picmanenums.h
	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def
	* libpicman/picman.def: updated.

2005-01-23  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.h
	* libpicmanbase/picmanbaseenums.h: moved PicmanInterpolationType and
	PicmanTransferMode to libpicmanbase (from app/base and libpicman). The
	remaining enums in app/base/base-enums.h need special treatment.

	* app/base/base-enums.c
	* libpicman/picmanenums.h
	* libpicmanbase/picmanbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libpicmanbase/picmanbase.def
	* libpicman/picman.def: updated.

2005-01-22  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h
	* plug-ins/script-fu/siod-wrapper.c: added new script-fu
	parameter SF-ENUM that allows to easily create a combo-box to
	choose values from registered enums. For this to work correctly,
	another change is needed that I will commit separately.

	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: use the new SF-ENUM
	parameter.

2005-01-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanpropwidgets.[ch]: added picman_prop_expander_new().

	* app/paint/picmanpaintoptions.[ch]: added a property to track the
	state of the "Pressure sensitivity" expander.

	* app/tools/picmanpaintoptions-gui.c: use picman_prop_expander_new()
	to create the "Pressure sensitivity" expander.

2005-01-22  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_file.c
	* plug-ins/imagemap/imap_main.c
	* plug-ins/imagemap/imap_menu.c
	* plug-ins/imagemap/imap_menu_funcs.[ch]
	* plug-ins/imagemap/imap_misc.[ch]
	* plug-ins/imagemap/imap_object.[ch]
	* plug-ins/imagemap/imap_selection.c: cleaning up code, mostly
	replacing homebrewn stuff that is now in either GTK or one of the
	PICMAN libs. More to come.

2005-01-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanselectiondata.c: include <stdio.h> for sscanf().

2005-01-22  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): update the preview (and
	thus the filesize) if the EXIF or thumbnail toggles are being used.
	Fixes bug #164914.

2005-01-22  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_file.c: fixed overwrite confirmation
	dialog (bug #164864).

2005-01-22  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_file.c (do_file_save_as_dialog): use
	GTK_STOCK_SAVE for the save dialog (bug #164864).

2005-01-21  Manish Singh  <yosh@picman.org>

	* app/display/picmandisplayshell.c: #include picmanbase.h for declaration
	of picman_param_spec_unit().

2005-01-22  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanenumwidgets.c: added more gtk-doc comments.

2005-01-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanbase.def
	* libpicmancolor/picmancolor.def
	* libpicmanmath/picmanmath.def: added new symbols.

2005-01-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_enum_value_get_help): same fix here.

2005-01-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/config/picmanconfig-types.c
	* app/config/picmanconfig-types.h: removed...

	* libpicmanbase/picmanbasetypes.c
	* libpicmanbase/picmanbasetypes.h: and contents merged
	into here.

	* app/config/picmanconfig-params.c: removed...

	* libpicmanbase/picmanbaseparams.c
	* libpicmancolor/picmanrgb.c
	* libpicmanmath/picmanmatrix.c: and contents merged
	into here.

	* app/config/picmanconfig-params.h: part removed...

	* libpicmanbase/picmanbaseparams.h
	* libpicmancolor/picmanrgb.h
	* libpicmanmath/picmanmatrix.h: and merged into here

	* libpicmanbase/Makefile.am
	* libpicmanbase/picmanbase.h
	* libpicmancolor/picmanbilinear.c
	* libpicmancolor/picmancmyk.c
	* libpicmanmath/picmanvector.c
	* app/config/Makefile.am
	* app/config/picmanconfig-deserialize.c
	* app/config/picmanconfig-dump.c
	* app/config/picmanconfig-serialize.c
	* app/config/picmancoreconfig.c
	* app/config/picmanguiconfig.c
	* app/config/picmanpluginconfig.c
	* app/core/picman-utils.c
	* app/core/picmancontext.c
	* app/tools/tools-utils.c
	* app/widgets/picmanaction.c
	* plug-ins/picmanressionist/utils.c: dependencies changed
	accordingly.

	First step in config migration out of core.  Need to fix
	devel-docs to reflect these changes.

2005-01-22  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanutils.c (picman_enum_value_get_desc): no point in
	crashing if picman_enum_get_desc() returns NULL.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_proof.c: register enum descriptions, use
	PicmanEnumComboBox.

2005-01-21  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmanpreviewarea.c: improved docs.

2005-01-21  Sven Neumann  <sven@picman.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/picmanenumcombobox.[ch]
	* app/widgets/picmanenumstore.[ch]: moved PicmanEnumStore and
	PicmanEnumComboBox from here ...

	* libpicmanwidgets/Makefile.am
	* libpicmanwidgets/picmanwidgets.def
	* libpicmanwidgets/picmanwidgets.h
	* libpicmanwidgets/picmanwidgetstypes.h
	* libpicmanwidgets/picmanenumcombobox.[ch]
	* libpicmanwidgets/picmanenumstore.[ch]: ... to libpicmanwidgets.

	* app/dialogs/convert-dialog.c
	* app/dialogs/scale-dialog.c
	* app/tools/picmanblendoptions.c
	* app/tools/picmancurvestool.c
	* app/tools/picmanlevelstool.c
	* app/widgets/picmancolorframe.c
	* app/widgets/picmanhistogrameditor.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmanstrokeeditor.c
	* data/images/picman-splash.png: changed includes accordingly.

2005-01-21  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanwidgets-utils.[ch] (picman_action_get_accel_closure):
	new function as workaround for missing GTK+ API	(see bug #141750).

	* app/widgets/picmanactionview.[ch]: use the function instead of
	having this ugly hack here. Store the accel_closure instead of the
	hackish menu_item in the tree store. Removed cruft and cleaned up
	a bit.

2005-01-21  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c: applied a patch from Geert
	Jordaens that seems to fix drawable transformation using the new
	Lanczos interpolation routine :)

2005-01-20  Sven Neumann  <sven@picman.org>

	* HACKING
	* Makefile.am
	* acinclude.m4
	* autogen.sh: applied (modified) patch from Raphaël Quinet that
	allows to build PICMAN from CVS without having gtk-doc installed.
	If you need to do this, pass --disable-gtk-doc to autogen.sh.

	* configure.in: removed --disable-devel-docs option since it has
	become obsolete now.

	* devel-docs/Makefile.am: require gtk-doc when running 'make dist'.

2005-01-20  Sven Neumann  <sven@picman.org>

	* app/paint-funcs/scale-funcs.[ch]: applied patch from Geert
	Jordaens that improves results of the Lanczos interpolation
	routine.

2005-01-20  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancomponenteditor.c
	(picman_component_editor_button_press): call picman_image_flush() after
	setting the active component since this might unselect the active
	channel. Fixes bug #164195.

2005-01-19  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c: applied a patch from Geert
	Jordaens that fixes the crash in the drawable transformations
	using the Lanczos interpolation type. The result is somewhat wrong
	though :(

2005-01-18  Manish Singh  <yosh@picman.org>

	* plug-ins/jpeg/jpeg-save.[ch]: Adapted the code from the stable
	branch (based on a patch from Nils Philippsen) that makes sure that
	the EXIF thumbnail doesn't cause the EXIF data block to grow beyond
	its maximum size. Fixes bug #164087.

2005-01-19  Sven Neumann  <sven@picman.org>

	* app/display/picmanscalecombobox.c (picman_scale_combo_box_set_scale):
	don't use == to compare floating point values.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/bumpmap.c: make sure bumpmap_init_params()
	is called when necessary, fixes bug #162285.

2005-01-18  Michael Natterer  <mitch@picman.org>

	* app/core/picmanparasitelist.c (parasite_serialize): use
	picman_config_writer_data() to write the parasite data because
	it's binary and can contain '\0'.

	(picman_parasite_list_deserialize): use picman_scanner_parse_data() to
	read it. Still accepts the old file format for backward
	compatibility. Fixes bug #163131.

2005-01-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.c (picman_dockable_expose_event): blink
	more correctly.

2005-01-18  Carol Spears  <carol@picman.org>

	* data/images/picman-splash.png a different splash for the
        developers branch.

	* data/images/picman-splash.png fixed a commit conflict.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* picman/plug-ins/jpeg/picmanexif.c
	* picman/plug-ins/jpeg/picmanexif.h: new files with prototype
	interface code for metadata system.

	* picman/plug-ins/jpeg/Makefile.am
	* picman/plug-ins/jpeg/jpeg-exif.c
	* picman/plug-ins/jpeg/jpeg.c: adapted to metadata interface
	as described on picman-dev mailing list.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* libpicmanwidgets/picmanwidgets.c (picman_coordinates_callback):
	Make sure last_x and last_y are set to values that match
	those returned by picman_size_entry_get_refval(),
	fixes bug #163951.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/dialogs/info-dialog.c: disconnect callbacks to prevent crash
	when destroying dialog, fixes bug #163617.

2005-01-18  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandockable.[ch]: added new function
	picman_dockable_blink() which lets the dockable's title_area blink.

	* app/widgets/picmandialogfactory.c
	(picman_dialog_factory_dialog_new_internal): let wilber blink at the
	user :) Fixes bug #164156.

2005-01-18  Alexander Shopov  <ash@contact.bg>

	* configure.in (ALL_LINGUAS): Added "bg" (Bulgarian)

2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/xjt/xjt.c: use picman_temp_name instead of trying to
	create temp dir at loc of file, fixes bug #164116.

2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/spheredesigner.c: add basic validity check
	when attempting to open a preset; let's say this fixes
	bug #148984.

2005-01-17  Michael Natterer  <mitch@picman.org>

	Allow to drop stuff onto empty layers, channels and paths dialogs
	to create new items:

	* app/widgets/picmancontainertreeview.h (struct PicmanContainerTreeView):
	added "gboolean dnd_drop_to_empty".

	* app/widgets/picmancontainertreeview-dnd.c: if "dnd_drop_to_empty"
	is TRUE, dispatch drops to empty views and to the empty area below
	all items.

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_init): set
	"dnd_drop_to_empty" to TRUE.

	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanchanneltreeview.c
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmanvectorstreeview.c: made all drop functions work
	with "dest_viewable" being NULL and changed drop_possible()
	implementations accordingly. Cleaned up the whole DND code a bit.

	* app/widgets/picmanlayertreeview.c: removed color and pattern
	drop code...

	* app/widgets/picmandrawabletreeview.c: and added it here so colors
	and patterns can be dropped to the channels dialog too.

2005-01-16  Sven Neumann  <sven@picman.org>

	* app/tools/picmanpaintoptions-gui.c (pressure_options_gui): added a
	toggle to control whether pressure affects opacity of the Airbrush
	tool (bug #164237).

2005-01-16  Sven Neumann  <sven@picman.org>

	* app/config/picmandisplayconfig.[ch]
	* app/dialogs/preferences-dialog.c: also list the default image
	title and statusbar formats.

2005-01-16  Sven Neumann  <sven@picman.org>

	* app/dialogs/preferences-dialog.c: renamed default image title
	and statusbar format as suggested in bug #150679.

2005-01-16  Sven Neumann  <sven@picman.org>

	* plug-ins/common/curve_bend.c: applied patch from Jan Heller that
	fixes broken expose event handling (bug #164207).

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c: implement PicmanItem::convert(). Handles
	any drawable, including conversion to GRAY, flattening and
	resizing.

	* app/widgets/picmanchanneltreeview.c: implement dropping of all
	kinds of drawables as new channels. Fixes bug #158133.

	Simplified component dropping by removing stuff which is done by
	picman_item_convert() now.

2005-01-15  Sven Neumann  <sven@picman.org>

	* app/core/picmandrawable-transform.c
	* app/paint-funcs/scale-funcs.c: minor cleanups to the new Lanczos
	interpolation routines. Drawable transformations do still crash :(

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-dnd.[ch]: added new function
	picman_display_shell_dnd_init() which connects all DND callbacks.
	Made all DND callbacks static.

	* app/display/picmandisplayshell.c (picman_display_shell_init): call
	above function instead of connecting all DND callbacks here. Removed
	lots of now unused #includes.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanitem.c
	* app/core/picmandrawable.c
	* app/vectors/picmanvectors.c: made PicmanItem::scale() and ::resize()
	work on unattached items.

	* app/widgets/picmanlayertreeview.c
	(picman_layer_tree_view_drop_component): fix drop index.

	* app/widgets/picmanchanneltreeview.c: implement dropping of
	components as new channels. Fixes bug #158483.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmancontainertreeview.[ch]: added virtual function
	PicmanContainerTreeView::drop_component(). Added EEKy "dnd_picman"
	needed for picman_selection_data_get_component().

	* app/widgets/picmanitemtreeview.c (picman_item_tree_view_set_context):
	set the "dnd_picman" pointer if it is NULL.

	* app/widgets/picmancontainertreeview-dnd.c: handle component drops
	and dispatch ::drop_component() accordingly.

	* app/widgets/picmanlayertreeview.c: implement dropping of
	components as new layers. Addresses bugs #158483 and #158133.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell.c
	* app/display/picmandisplayshell-dnd.[ch]
	* app/widgets/picmantoolbox-dnd.c: enabled dropping of components
	to the display and the toolbox. Addresses bug #158483.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/core/picmanchannel.c (picman_channel_new*): don't require a
	non-NULL color parameter (just leave the default color untouched
	if NULL is passed).

	* app/actions/channels-commands.c
	* app/core/picmanchannel-select.c: pass NULL as color for temporary
	channels or channels where we used to pass black.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmandnd.c: added picman_dnd_get_component_icon().

	* app/widgets/picmancomponenteditor.c: allow to drag
	components. They can't be dropped anywhere yet.

2005-01-15  Sven Neumann  <sven@picman.org>

	* libpicman/picmantile.c (picman_tile_put)
	* libpicman/picman.c (picman_loop) (picman_read_expect_msg): added missing
	calls to wire_destroy(). Plugs memory leaks in the wire protocol.

2005-01-15  Sven Neumann  <sven@picman.org>

	* libpicmanbase/picmanprotocol.c: formatting.

2005-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_free_script)
	* plug-ins/script-fu/siod-wrapper.c (init_procedures): plugged
	memory leaks.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanitemtreeview.c
	(picman_item_tree_view_drop_viewable): handle drops of items of all
	types from all images and convert them if needed.

	* app/widgets/picmanlayertreeview.c: enable dropping of all kinds of
	drawables. Addresses bug #158133.

2005-01-15  Michael Natterer  <mitch@picman.org>

	* app/widgets/widgets-enums.h (enum PicmanDndType): reordered so
	COMPONENT is after IMAGE.

	* app/widgets/picmandnd.[ch]
	* app/widgets/picmanselectiondata.[ch]: added API for passing
	components around via DND. Speaks in terms of a
	(PicmanImage,PicmanChannelType) tuple.

2005-01-15  Sven Neumann  <sven@picman.org>

	* plug-ins/common/psd_save.c: fixed array out-of-bounds access and
	some mem-leaks reported by valgrind.

2005-01-14  Jay Cox  <jaycox@picman.org>

	* plug-ins/common/psd_save.c: Much less wasted memory.  Save guides.
	Fixes bug #151904.

2005-01-14  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanpaintcore-undo.c: doesn't need "picman-intl.h" either.

2005-01-14  Sven Neumann  <sven@picman.org>

	* app/paint/picmanink-undo.c: doesn't need to include "picman-intl.h".

2005-01-14  Michael Natterer  <mitch@picman.org>

	* app/core/core-enums.[ch] (enum PicmanUndoType): added PICMAN_UNDO_INK.

	* app/paint/picmanpaintcore.[ch]: added virtual function
	PicmanPaintCore::push_undo() and call it.

	* app/paint/picmanpaintcore-undo.[ch]: made it the default
	implementation.

	* app/paint/picmanink-blob.[ch]: added blob_duplicate().

	* app/paint/picmanink.[ch]: added a "start_blob" (just like
	PicmanPaintCore::start_coords) which gets set whenever we start a
	new stroke or line. Removed ink->lastx and ink->lasty because
	they are the same as paint_core->last_coords.

	* app/paint/Makefile.am
	* app/paint/picmanink-undo.[ch]: new files implementing an
	undo step for ink which restores the last blob used along
	with the whole ink state. Fixes bug #163670.

2005-01-14  Michael Natterer  <mitch@picman.org>

	* app/actions/buffers-commands.[ch]
	* app/actions/data-commands.[ch]
	* app/actions/documents-commands.[ch]
	* app/actions/palettes-commands.[ch]
	* app/actions/templates-commands.[ch]: changed the remaining
	callbacks to follow a consistent naming scheme
	(e.g. buffers_delete_buffer_cmd_callback ->
	buffers_delete_cmd_callback).

	* app/actions/brushes-actions.c
	* app/actions/buffers-actions.c
	* app/actions/documents-actions.c
	* app/actions/gradients-actions.c
	* app/actions/palettes-actions.c
	* app/actions/patterns-actions.c
	* app/actions/templates-actions.c: changed accordingly.

2005-01-14  Sven Neumann  <sven@picman.org>

	* plug-ins/common/retinex.c (run): fixed check for number of
	parameters in non-interactive mode.

2005-01-13  Manish Singh  <yosh@picman.org>

	* plug-ins/common/channel_mixer.c: Add a Reset button. Addresses
	bug #163045.

2005-01-14  Sven Neumann  <sven@picman.org>

	* plug-ins/bmp/bmpread.c: removed obscure error codes from
	translatable error messages.

2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_shade.c: remove artifacts
	when light strikes underside of bumpmapped surface;
	should fix bug #163877.

2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/bmp/bmp.h
	* plug-ins/bmp/bmpread.c: handle negative height values
	as per spec, fixes bug #158033

2005-01-13  Michael Natterer  <mitch@picman.org>

	Allow to easily open brushes and patterns as images.
	Fixes bug #163059.

	* app/actions/brushes-actions.c
	* app/actions/patterns-actions.c: added "brushes-open-as-image"
	and "patterns-open-as-image" actions.

	* app/actions/data-commands.[ch]: added
	data_open_as_image_cmd_callback() which tries to load
	data->filename as image.

	* app/widgets/picmanhelp-ids.h: added help IDs for the new actions.

	* app/widgets/picmandatafactoryview.c: added buttons.

	* menus/brushes-menu.xml
	* menus/patterns-menu.xml: added them to the menus.

2005-01-13  Michael Natterer  <mitch@picman.org>

	Splitting PicmanItem::convert() into two virtual functions was
	apparently buggy over-engineering. Reverted that stuff and
	implement item conversion much simpler:

	* app/core/picmanitem.[ch]: have a single virtual function,
	PicmanItem::convert(), which takes a newly duplicated item and the
	destination image.

	(picman_item_convert): simply call PicmanItem::convert() on the result
	of picman_item_duplicate().

	(picman_item_real_convert): set the item's new image.

	* app/core/picmanlayer.c (picman_layer_convert)
	* app/vectors/picmanvectors.c (picman_vectors_convert): changed
	accordingly and chain up after, not before doing our own stuff
	so the old image is still available as item->image for stuff
	like colormap conversion. Fixes bug #163879.

2005-01-13  Michael Natterer  <mitch@picman.org>

	Made the file open and save dialogs use the last used folder
	instead of defaulting to current directory. Fixes bug #162385.

	* app/widgets/picmanfiledialog.[ch] (picman_file_dialog_set_uri):
	removed this function because it had no functionality except
	creating usability problems.

	* app/actions/file-commands.c: use gtk_file_chooser_set_uri()
	instead but *only* if we already have an uri from an alread open
	image or the document hinstory.

	* app/widgets/picmanfiledialog.c (picman_file_dialog_set_image): set
	the file chooser's uri only if we have an uri from the image
	itself. Leave the current folder untouched otherwise and just set
	the current name (e.g. "Untitled").

	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image): on
	successful save, remember the used uri by attaching it to the
	"picman" instance.

	(file_save_dialog_new): set the last saved uri's folder on the
	newly created file save dialog.

2005-01-13  Sven Neumann  <sven@picman.org>

	* app/units.c
	* app/core/picman-units.c
	* app/core/picman.c
	* app/core/picmanunit.[ch]: added a utility function that frees the
	memory allocated for user units. Minor cleanups.

2005-01-13  Sven Neumann  <sven@picman.org>

	* configure.in (ALL_LINGUAS): added mk (Macedonian).

2005-01-11  Sven Neumann  <sven@picman.org>

	* app/pdb/drawable_transform_cmds.c
	* libpicman/picmanenums.h
	* plug-ins/pypicman/picmanenums.py
	* tools/pdbgen/enums.pl: regenerated after change of
	PicmanInterpolationType enum.

2005-01-11  Sven Neumann  <sven@picman.org>

	* app/base/base-enums.[ch]
	* app/core/picmandrawable-transform.c
	* app/core/picmandrawable.c
	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs.[ch]
	* app/paint-funcs/scale-funcs.[ch]: applied patch by Geert Jordaens
	(after a good deal of reformatting for coding style compliance).
	This factors the scale routines into their own file and adds a
	sinc-based (Lanczos) interpolation routine (bug #162250).

2005-01-11  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/siod/slib.c (help): removed wrong URL from
	help output.

2005-01-10  Manish Singh  <yosh@picman.org>

	* modules/controller_midi.c: #include <time.h> to make sure all
	the types are there for the alsa headers. Should address bug
	#163593.

2005-01-10  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/text_tool.pdb: explicitely mention the encoding.

	* app/pdb/text_tool_cmds.c
	* libpicman/picmantexttool_pdb.c: regenerated.

2005-01-10  DindinX  <dindinx@picman.org>

	* plug-ins/common/sparkle.c: update the preview when a parameter
	change.  Updating the preview is now disabled by default since it
	can be very slow.

2005-01-09  Sven Neumann  <sven@picman.org>

	* libpicman/picmangradientmenu.c: fixed out-of-bounds access in
	gradient selection widget. Presumably fixes bug #163427.

2005-01-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontrollerkeyboard.c: changed "Key" to "Cursor".

2005-01-09  DindinX  <dindinx@picman.org>

	* plug-ins/common/sparkle.c: added a preview. This will need more
	testing.  Shlomi Fish, can you please try to test this plug-in again?

2005-01-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmanactionview.c (picman_action_view_new): connect to
	"button_press_event" and start editing immidiately instead of
	waiting for a second click. Fixes bug #163385.

2005-01-09  Sven Neumann  <sven@picman.org>

	* app/widgets/picmandialogfactory.c (picman_dialog_factories_toggle):
	if called with (ensure_visibility == TRUE), raise the toolbox.
	Fixes bug #163381.

2005-01-08  DindinX  <dindinx@picman.org>

	* plug-ins/common/mosaic.c: made the preview fast enough to be useful.

2005-01-08  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): fixed handling of clicks
	into a horizontally scrolled treeview.

	(picman_container_tree_view_find_click_cell): really fix handling of
	RTL layouts (bug #162663).

2005-01-08  Sven Neumann  <sven@picman.org>

	* app/dialogs/scale-dialog.c: use a PicmanMessageBox to display the
	informative message when scaling an indexed image.

2005-01-07  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainertreeview.c
	(picman_container_tree_view_button_press): handle RTL layouts (fixes
	bug #162663).

2005-01-07  Shlomi Fish  <shlomif@iglu.org.il>

	* plug-ins/script-fu/scripts/frosty-logo.scm: made sure the shadow
	is given enough space and then truncated instead of translated to
	the center of the image, thus preventing the display of shadows
	with a completely horizontal or vertical edge.
	Fixes bug #132145.

2005-01-07  Michael Natterer  <mitch@picman.org>

	* app/core/picmanimage-snap.c: moved variables to local scopes,
	assign the snapped coords unconditionally (also if we don't snap),
	cleanup.

	(picman_image_snap_rectangle): entirely rewritten to use local
	mindist_x, mindist_y variables instead of fiddling with lots of
	boolean variables. Implemented vectors snapping as if the required
	PicmanStroke functions existed (#defined them). Simon, your turn :)

2005-01-07  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c: PICMAN_PROGRESS(NULL) is perfectly
	valid, no need to say gdisp ? PICMAN_PROGRESS(gdisp) : NULL.

	* app/actions/plug-in-commands.c (plug_in_run_cmd_callback):
	remember the last plug-in if it has at least 3 args, not 2.
	Cleaned up the whole function and removed cruft.

2005-01-07  Sven Neumann  <sven@picman.org>

	* app/composite/picman-composite-x86.h
	* app/composite/picman-composite-sse.c: applied patch from Andreas
	Jochens that fixes the build on amd64 with gcc-4.0 (bug #163041).

2005-01-07  Sven Neumann  <sven@picman.org>

	* data/misc/picman.desktop.in.in: changed Comment field as suggested
	in bug #160990.

2005-01-07  Sven Neumann  <sven@picman.org>

	* plug-ins/common/mail.c: just some minor formatting changes.

2005-01-07  Sven Neumann  <sven@picman.org>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg.[ch]: some code cleanup.

2005-01-06  Manish Singh  <yosh@picman.org>

	* libpicmanwidgets/picmandialog.c: flush the display in dispose if we're
	no longer in a main loop, so the dialog doesn't hang around while
	possibly long running calculations are being done. Fixes bug #163084.

2005-01-06  Michael Schumacher <schumaml@cvs.gnome.org>

	* libpicmanwidgets/picmanwidgets.def: added
	picman_scrolled_preview_set_position

2005-01-06  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes more regressions in Sparkle plug-in (bug #132145).

2005-01-05  DindinX  <dindinx@picman.org>

	* libpicmanwidgets/picmanscrolledpreview.[ch]: new function:
	picman_scrolled_preview_set_position () to set the position of the
	preview content wrt the drawable.  This function might be moved to a
	virtual function of PicmanPreview in a near future.

	* libpicman/picmandrawablepreview.c: use this function, so a preview
	remembers its position from one invocation to the next.  This is done
	using the current executable name as a key for picman_set/get_data () so
	each plug-in can have its preview on a different place.

	More informations could be saved this way: the update toggle, the
	checks, etc.

	Addresses bug #162286.

	* libpicmanwidgets/picmanpreview.c: smallish cleanup.

2005-01-04  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* configure.in: add check for libexif version >= 0.6.0,
	necessary because of nasty incompatible api change.

	* plug-ins/jpeg/exif-handling.txt: removed from here...

	* devel-docs/exif-handling.txt: ...and added here

	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h: extract info from exif on loading,
	and add info to exif on saving, addresses bug #56433,
	bug #61499, and bug #121810.

2005-01-04  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-close.c
	(picman_display_shell_close_dialog): set the default response to
	Cancel in order to reduce the risk of accidentally saving an
	image (bug #162872).

2005-01-04  Sven Neumann  <sven@picman.org>

	* app/widgets/picmancontainertreeview.c: prepared code for fixing
	bug #162663.

2005-01-03  DindinX  <dindinx@picman.org>

	* plug-ins/common/mosaic.c: invalidate the preview when a parameter
	changes.  Disabled updating the preview by default. There is room
	for optimisations, but this fixes #162710.

2005-01-03  Sven Neumann  <sven@picman.org>

	* libpicmanwidgets/picmancellrenderertoggle.c
	(picman_cell_renderer_toggle_get_size): made the code look more
	similar to GtkCellRendererToggle to allow for easy comparison.

2005-01-03  Sven Neumann  <sven@picman.org>

	* app/menus/plug-in-menus.c: made the code a little more robust by
	not relying on certain properties of the menu path.

2005-01-03  Sven Neumann  <sven@picman.org>

	* tools/pdbgen/pdb/gradient.pdb: do actually add the new procedure
	picman_gradient_is_editable().

	* app/pdb/gradient_cmds.c
	* app/pdb/internal_procs.c
	* libpicman/picmangradient_pdb.[ch]: regenerated.

	* libpicman/picman.def: updated.

2005-01-03  Michael Natterer  <mitch@picman.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/display/picmandisplayshell-appearance.[ch]
	* menus/image-menu.xml.in: reordered actions, functions and menu
	items so the "show" and "snap" actions are grouped.

2005-01-03  Michael Natterer  <mitch@picman.org>

	Implemented "Snap to Canvas Edges" (fixes bug #152971) and
	"Snap to Active Path" (half way done):

	* app/core/picmanimage-snap.[ch]: added boolean snap_to_canvas and
	snap_to_vectors parameters (snap_to_vectors works fine when
	snapping to a point, but is unimplemented for snapping to a
	rectangle).

	* app/display/picmandisplayshell.[ch] (struct PicmanDisplayShell):
	added snap_to_canvas and snap_to_vectors booleans.

	* app/display/picmandisplayshell-appearance.[ch]: added API to
	get/set them.

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/widgets/picmanhelp-ids.h: added actions, callbacks and help IDs.

	* menus/image-menu.xml.in: added them to Image->View.

2005-01-03  Sven Neumann  <sven@picman.org>

	* plug-ins/ifscompose/ifscompose.c: use g_free() to release memory
	allocated using g_malloc().

2005-01-03  Michael Natterer  <mitch@picman.org>

	* app/display/picmandisplayshell-autoscroll.c
	(picman_display_shell_autoscroll_timeout): need to snap the
	coordinates before passing them to the active tool.

2005-01-03  Sven Neumann  <sven@picman.org>

	* plug-ins/common/fp.c: removed GtkFrame from dialog and replaced
	a call to free() by g_free().

2005-01-03  Michael Natterer  <mitch@picman.org>

	* app/paint/picmanbrushcore.c
	* app/paint/picmanpaintoptions.[ch]
	* app/tools/picmanpaintoptions-gui.c: renamed "invsize" to
	"inverse-size" and reordered it to be after "size".

2005-01-03  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: another update from Eric Pierce.

2005-01-03  Sven Neumann  <sven@picman.org>

	* app/paint/picmanink.[ch]: handle event time as guint32. That's the
	type we deal with here and it avoids a crash that occured when
	autoscrolling with the Ink tool.

	* app/display/picmandisplayshell-autoscroll.c: cosmetics.

2005-01-02  Michael Natterer  <mitch@picman.org>

	* app/display/Makefile.am
	* app/display/picmandisplayshell-autoscroll.[ch]
	* app/display/picmandisplayshell-coords.[ch]: new files factored out
	of picmandisplayshell-callbacks.c

	* app/display/picmandisplayshell.h (struct PicmanDisplayShell): added
	"gpointer scroll_info" needed by autoscroll.

	* app/display/picmandisplayshell-callbacks.c: removed the stuff
	above. Also removed the static autoscroll struct because it's not
	needed any longer.

2005-01-02  DindinX  <dindinx@picman.org>

	* plug-ins/common/mosaic.c: Added a preview.  This still needs some
	work and some testing.  Calculating the preview takes ages.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/exif-handling.txt:  added summary of how Picman should
	handle each exif field according to the specs.

2005-01-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansizebox.c
	* app/widgets/picmantemplateeditor.c: round displayed resolution
	instead of just casting to integer values. Use image size limits
	from libpicmanbase/picmanlimits.h instead of some arbitrary numbers.

2005-01-02  Manish Singh  <yosh@picman.org>

	* plug-ins/pypicman/plug-ins/clothify.py
	* plug-ins/pypicman/plug-ins/foggify.py: Add layers to images before
	using them. Fixes bug #162707.

2005-01-02  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_about.c: bumped version number

	* plug-ins/imagemap/AUTHORS
	* plug-ins/imagemap/NEWS
	* plug-ins/imagemap/README
	* plug-ins/imagemap/TODO: removed since they don't contain relevant
	information anymore.

	* plug-ins/imagemap/imap_popup.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: first set of changes to fix
	#138841 (Use action based menus in Imagemap plug-in).

2005-01-02  Sven Neumann  <sven@picman.org>

	* app/gui/splash.c (splash_update): fixed display of progress
	labels in RTL environment.

2005-01-02  Sven Neumann  <sven@picman.org>

	* etc/ps-menurc: updated PS keybindings contributed by Eric Pierce.

2005-01-02  Sven Neumann  <sven@picman.org>

	* app/widgets/picmansizebox.c (picman_size_box_constructor): fixed
	position of pixel and resolution labels.

2005-01-02  Sven Neumann  <sven@picman.org>

	* app/display/picmandisplayshell-callbacks.c: fixed auto-scrolling
	for left and bottom display edges. Remove the timeout on
	button-release event, some minor cleanups.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: removed

	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-load.h
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg-save.h: added (changing _ to -)

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg.c
	* po-plug-ins/POTFILES.in: changed accordingly

2005-01-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes regressions in Sparkle plug-in (bug #132145).

2005-01-02  Sven Neumann  <sven@picman.org>

	* plug-ins/common/plugin-defs.pl: changed for move of JPEG plug-in.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_ui.c: add a control for
	viewpoint distance.  Should finish fixing bug #4044.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/NEWS
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h
	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: moved jpeg code into new
	dir and split up, already too large and a good bit more
	will be needed for proper exif handling.

	* plug-ins/common/jpeg.c: removed

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/common/Makefile.am: changed accordingly

2005-01-01  Manish Singh  <yosh@picman.org>

	* plug-ins/common/tiff.c: Revert incorrect optimization from previous
	change.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/gradmap.c: added procedure plug_in_palettemap
	that does the same thing as gradmap except using the current
	palette; should resolve bug #68879.

2005-01-02  Manish Singh  <yosh@picman.org>

	* plug-ins/common/tiff.c: Special case 1-bit black & white indexed
	images to save out as 1-bit grayscale MINISWHITE tiffs. Also load
	these images as indexed images into PICMAN. Fixes bug #150865.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/display/picmandisplayshell-callbacks.c: use a timeout for
	autoscrolling, to fix bug #8269.  Happy new year!

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/picmanbrushcore.c
	* app/paint/picmanpaintoptions.c
	* app/paint/picmanpaintoptions.h
	* app/tools/picmanpaintoptions-gui.c: reverted last change, and
	applied full patch from Dave Ahlswede in bug #149576.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/gradient.pdb: added gradient-is-editable

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/palette.pdb: changed mitch_misc to bill_misc
	where correct.

	* app/pdb/brush_cmds.c
	* app/pdb/palette_cmds.c
	* libpicman/picmanbrush_pdb.c
	* libpicman/picmanpalette_pdb.c: regenerated.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/picmanbrushcore.c: make previously committed change
	in pressure-size relationship apply only to airbrush, as
	intended.

2004-12-31  Michael Natterer  <mitch@picman.org>

	* app/actions/plug-in-actions.c: use the orininal string if
	plug_in_actions_check_translation() fails instead of bailing out.
	Fixes bug #162590.

2004-12-31  Michael Natterer  <mitch@picman.org>

	* app/core/picmanpalette.[ch]: removed the just added
	picman_palette_insert_entry() and added a "gint position" parameter
	to picman_palette_add_entry() instead (no need to have two almost
	identical functions).

	* app/actions/palette-editor-commands.c
	* app/core/picmanpalette-import.c
	* app/widgets/picmanpaletteeditor.c
	* tools/pdbgen/pdb/palette.pdb: changed accordingly.

	* app/pdb/palette_cmds.c: regenerated.

2004-12-31  Michael Natterer  <mitch@picman.org>

	* app/widgets/picmanfgbgeditor.[ch]: use the coordinates passed in
	the color drop callback instead of remembering them in the
	drag_motion handler.

2004-12-31  Sven Neumann  <sven@picman.org>

	* tools/kernelgen.c: fixed rounding so that all brush kernels are
	created with a constant sum of 256.

	* app/paint/picmanbrushcore-kernels.h: regenerated.

	* app/paint/picmanbrushcore.c (picman_brush_core_subsample_mask): use
	the constant defined in app/paint/picmanbrushcore-kernels.h. Should
	give a tiny speedup.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/picmanbrushcore.c: invert dependence of brush size on
	pressure, using formula from Dave Ahlswede in bug #149576.

2004-12-31  Michael Natterer  <mitch@picman.org>

	Applied modified patch from Ben Campbell which adds drop
	coordinates to the color drop callback and uses it to insert
	colors in the palette editor. Extended the patch to add drop
	coordinates to all drop callbacks.

	* app/core/picmanpalette.[ch]: added picman_palette_insert_entry().

	* app/display/picmandisplayshell-dnd.[ch]: added drop coordinates
	to all drop callbacks.

	* app/dialogs/palette-import-dialog.c
	* app/widgets/picmancolormapeditor.c
	* app/widgets/picmancontainerview.c
	* app/widgets/picmandnd.[ch]
	* app/widgets/picmandrawabletreeview.c
	* app/widgets/picmanfgbgeditor.c
	* app/widgets/picmangradienteditor.c
	* app/widgets/picmanitemtreeview.c
	* app/widgets/picmanpaletteeditor.c
	* app/widgets/picmanpropwidgets.c
	* app/widgets/picmanselectioneditor.c
	* app/widgets/picmantoolbox-dnd.c
	* app/widgets/picmantoolbox-image-area.c
	* app/widgets/picmantoolbox-indicator-area.c
	* app/widgets/picmantooloptionseditor.c
	* libpicmanwidgets/picmancolorselect.c: changed accordingly. The passed
	drop coordiantes are so far unused.

	* app/widgets/picmanpaletteeditor.c: use the drop coordinates to
	insert the new color into the palette at the right place instead
	of always appending. Fixes bug #150030.

2004-12-31  Michael Natterer  <mitch@picman.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]
	* app/widgets/picmantoolview.[ch]: applied a (modified) patch from
	Joao S. O. Bueno which adds "raise" and "lower" actions and
	their buttons in the tool dialog. Fixes bug #158666.
	Cleaned up the tool action callbacks.

2004-12-31  Sven Neumann  <sven@picman.org>

	* plug-ins/imagemap/imap_preview.c (render_rgb_image): use the proper
	image type and rowstride. Fixes bug #162592.

2004-12-30  Manish Singh  <yosh@picman.org>

	* tools/Makefile.am
	* app/Makefile.am: build binaries with 2.3 versions.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/widgets/picmansizebox.c: give correct arguments to
	picman_coordinates_new().  Fixes problem described in
	comment 6 of bug #162387.

2004-12-31  Sven Neumann  <sven@picman.org>

	* configure.in: bumped picman_app_version and picman_user_version to 2.3.

	* app/Makefile.am
	* tools/Makefile.am: changed to 2.3.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/brush.pdb: added api for changing properties
	of generated brushes.

	* tools/pdbgen/pdb/palette.pdb: added palette_is_editable().

	* app/pdb/brush_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* libpicman/picmanbrush_pdb.c
	* libpicman/picmanbrush_pdb.h
	* libpicman/picmanpalette_pdb.c
	* libpicman/picmanpalette_pdb.h: autogenerated.

2004-12-29  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.3.0.

2004-12-29  Sven Neumann  <sven@picman.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_response):
	handle a NULL return value from gtk_file_chooser_get_uri(). Fixes
	bug #162443.

2004-12-29  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_preferences.[ch]: replace home-brewn color
	selection by PicmanColorButton.

2004-12-29  DindinX  <dindinx@picman.org>

	* plug-ins/gfig/gfig-rectangle.[ch]
	* plug-ins/gfig/images/stock-rectangle.png: news files to implement a
	rectangle tool to gfig.

	* plug-ins/gfig/gfig-stock.c
	* plug-ins/gfig/gfig-stock.h
	* plug-ins/gfig/Makefile.am: modified accordingly.

	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-dobject.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-types.h
	* plug-ins/gfig/gfig.c
	* plug-ins/gfig/gfig.h: modified to support the new shape and
	implement two new filling types: vertical and horizontal gradients.
	These gradients are imho much more useful than the shapeburst one.

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: Recompose did not properly
	handle case where layer with alpha is decomposed into
	something that does not encode alpha -- now does.


2004-12-28  Michael Natterer  <mitch@picman.org>

	* app/core/picman-edit.c (picman_edit_set_buffer): new utility
	function instead of code duplication.

2004-12-28  Michael Natterer  <mitch@picman.org>

	* app/base/base-enums.[ch]: added translatable strings to the
	PicmanLayerModeEffects enum because they will soon disappear from
	widgets/picmanwidgets-constructors.c

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: add "Recompose" (plug_in_recompose)
	as described on dev mailing list.

	* plug-ins/common/decompose.c: add "decompose-data" parasite
	when decomposing, to support Recompose.  Also add missing
	alpha channels to newly produced layers

2004-12-28  Sven Neumann  <sven@picman.org>

	* Made 2.2.1 release.

2004-12-28  Sven Neumann  <sven@picman.org>

	* libpicman/picman.[ch] (picman_install_procedure, picman_install_temp_proc):
	renamed menu_path parameter to menu_label and added a pointer to
	picman_plugin_menu_register()

	* app/widgets/picmansizebox.c (picman_size_box_constructor): removed
	unused variables.

2004-12-28  Sven Neumann  <sven@picman.org>

	* app/paint/picmanbrushcore.c (picman_brush_core_subsample_mask):
	reverted Bill's change since it is obviously not the right fix.
	Allocate the array larger to avoid the crash. We need to
	investigate bug #161323 further.

2004-12-27  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/picmanbrushcore.c (picman_brush_core_subsample_mask):
	don't set array outside its bounds.  Should fix bug #161323.
	Credit to Robert Ögren for figuring out what was wrong.

2004-12-27  Sven Neumann  <sven@picman.org>

	* plug-ins/common/colortoalpha.c: if possible, use
	picman_preview_draw_buffer() so that the selection mask is correctly
	previewed. Minor cleanups.

2004-12-27  Sven Neumann  <sven@picman.org>

	* libpicman/picmanregioniterator.c: added some checks to avoid
	division by zero.

	* libpicmanwidgets/picmanpreviewarea.[ch]: minor cleanups, improved
	API documentation.

2004-12-26  DindinX  <dindinx@picman.org>

	* plug-ins/gfig/gfig-arc.c
	* plug-ins/gfig/gfig-bezier.c
	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-line.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-spiral.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-style.h
	* plug-ins/gfig/gfig.h: plugged some memory-leaks, and done some
	cleanups.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/core/picmanbrush.c: don't ask for preview with
	zero width or height, fixes bug #162232.

	* app/base/brush-scale.c: remove tabs and trailing
	whitespace.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantoolbox-dnd.c: undo changes of 12-24,
	in favor of a better fix.

	* app/widgets/picmanerrordialog.c: fix bug #162147 properly,
	as suggested by mitch.

2004-12-25  Michael Natterer  <mitch@picman.org>

	* plug-ins/script-fu/scripts/weave.scm: limit the "Thread
	intensity" parameter to [0..100] because it's used as layer
	opacity. Fixes bug #162182.

2004-12-24  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/picmandisplayshell-dnd.c
	* app/widgets/picmanlayertreeview.c
	* app/widgets/picmantoolbox-dnd.c: replace % with space
	in file name before showing error message,
	fixes bug #162147.

	* app/core/picman-gui.c
	* app/widgets/picmanmessagebox.c: be a bit more paranoid
	about validating utf8 for messages.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* picman/app/widgets/picmansizebox.c: fix incorrect Update
	Policy for size entry as pointed out by mitch.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/cartoon.c
	* plug-ins/common/cubism.c
	* plug-ins/common/displace.c
	* plug-ins/common/dog.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gauss.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/neon.c
	* plug-ins/common/noisify.c
	* plug-ins/common/oilify.c
	* plug-ins/common/photocopy.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c
	* plug-ins/common/sobel.c
	* plug-ins/common/softglow.c
	* plug-ins/common/spread.c
	* plug-ins/common/tileit.c
	* plug-ins/common/whirlpinch.c: make sure tile cache is allocated
	before preview is shown -- significant speedup in some cases,
	minimal in others.

	* plug-ins/common/sel_gauss.c: give it a tile cache (didn't
	have one).  Still very slow but a little better.

2004-12-24  Sven Neumann  <sven@picman.org>

	* plug-ins/common/despeckle.c (despeckle_median): don't call
	picman_progress_update() for each and every pixel. Every few rows
	should be enough. Fixes bug #162129.

	* plug-ins/common/blur.c: set progress to 1.0 when done, not to 100.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/mblur.c: set up tile cache before
	creating dialog -- major speedup in preview.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* picman/app/widgets/picmansizebox.c: use picman_coordinates_new()
	instead of duplicating a lot of code.  Fixes bug #161756.

	* picman/app/widgets/picmanpropwidgets.c: small change in
	chainbutton handling to make above work.

2004-12-23  Sven Neumann  <sven@picman.org>

	* app/plug-in/plug-in-proc-frame.[ch]: made plug_in_proc_frame_free()
	a static function.

2004-12-23  Michael Natterer  <mitch@picman.org>

	Item conversion depends on the old *and* the new item type, so
	it can't live in the old item's vtable only:

	* app/core/picmanitem.[ch]: split PicmanItem::convert() into
	PicmanItem::convert_from() (which is called on the old item and
	creates the new item) and PicmanItem::convert_to() (which is called
	on the new item). This way functions from the old *and* new items'
	vtables are called and it's possible to convert between item types
	which live on different branches of the class hierarchy or to item
	types which live further down the class tree than the old item.

	(picman_item_convert): call ::convert_to() on the new item created
	by ::convert_from().

	* app/vectors/picmanvectors.c: changed ::convert() implementation
	to ::convert_from().

	* app/core/picmanlayer.c: changed ::convert() to ::convert_to().
	Fixes bug #161877.

2004-12-22  Sven Neumann  <sven@picman.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/asc2img.scm: removed this script as it
	is broken beyond repair and the functionality is provided by the
	text tool itself.

2004-12-22  Sven Neumann  <sven@picman.org>

	* NEWS: added NEWS for the stable branch (no, we haven't branched
	yet).

	* Makefile.am
	* NEWS.pre-2.2: moved old NEWS here.

2004-12-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c (blur_line): fixed the degenerate case
	where the source image is smaller than the blurred area. This used
	to give artefacts at the borders.

2004-12-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: more code cleanup and micro
	optimizations.

2004-12-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: reverted the last change since it
	introduced artefacts. Even had to increase the border around the
	previewed area. Fixed a bug in unsharp_region() where it was using
	the wrong source region for blurring.

2004-12-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: compute preview for the displayed area
	only, some more code cleanup.

2004-12-21  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c (preview_update): fixed bug #157910.
	More code cleanup and some trivial optimizations.

2004-12-21  Michael Natterer  <mitch@picman.org>

	* app/actions/gradient-editor-actions.c
	(gradient_editor_actions_update): if the dialog is insensitive,
	disable all actions which modify the gradient. Fixes bug #161411.

	* app/actions/gradient-editor-commands.c: update the UI manager
	after setting the dialog sensitive/insensitive so te above works.

2004-12-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: more code cleanup.

2004-12-20  Sven Neumann  <sven@picman.org>

	* libpicman/picmandrawablepreview.c (picman_drawable_preview_draw_region):
	unset the dirty flag on the PicmanPixelRgn used to iterate the region.

	* libpicman/picmanpixelrgn.c (picman_pixel_rgn_init): improved docs.

2004-12-20  Sven Neumann  <sven@picman.org>

	* plug-ins/common/unsharp.c: code cleanup, no real changes.

2004-12-20  Sven Neumann  <sven@picman.org>

	* configure.in: bumped version to 2.2.1.

	* plug-ins/FractalExplorer/FractalExplorer.c: applied patch from
	Yeti that fixes a memory corruption (bug #161729).

2004-12-19  Sven Neumann  <sven@picman.org>

	* Made 2.2.0 release.
