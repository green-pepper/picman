/* PICMAN - The GNU Image Manipulation Program
 * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

/* NOTE: This file is auto-generated by pdbgen.pl. */

#include "config.h"

#include <cairo.h>
#include <string.h>

#include <gegl.h>

#include <gdk-pixbuf/gdk-pixbuf.h>

#include "libpicmancolor/picmancolor.h"

#include "libpicmanbase/picmanbase.h"

#include "pdb-types.h"

#include "core/picman.h"
#include "core/picmancontext.h"
#include "core/picmandatafactory.h"
#include "core/picmanpalette.h"
#include "core/picmanparamspecs.h"

#include "picmanpdb.h"
#include "picmanpdb-utils.h"
#include "picmanprocedure.h"
#include "internal-procs.h"


static PicmanValueArray *
palette_new_invoker (PicmanProcedure         *procedure,
                     Picman                  *picman,
                     PicmanContext           *context,
                     PicmanProgress          *progress,
                     const PicmanValueArray  *args,
                     GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gchar *actual_name = NULL;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanData *data = picman_data_factory_data_new (picman->palette_factory,
                                                   context, name);

      if (data)
        actual_name = g_strdup (picman_object_get_name (data));
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_take_string (picman_value_array_index (return_vals, 1), actual_name);

  return return_vals;
}

static PicmanValueArray *
palette_duplicate_invoker (PicmanProcedure         *procedure,
                           Picman                  *picman,
                           PicmanContext           *context,
                           PicmanProgress          *progress,
                           const PicmanValueArray  *args,
                           GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gchar *copy_name = NULL;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        {
          PicmanPalette *palette_copy = (PicmanPalette *)
            picman_data_factory_data_duplicate (picman->palette_factory,
                                              PICMAN_DATA (palette));

          if (palette_copy)
            copy_name = g_strdup (picman_object_get_name (palette_copy));
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_take_string (picman_value_array_index (return_vals, 1), copy_name);

  return return_vals;
}

static PicmanValueArray *
palette_rename_invoker (PicmanProcedure         *procedure,
                        Picman                  *picman,
                        PicmanContext           *context,
                        PicmanProgress          *progress,
                        const PicmanValueArray  *args,
                        GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  const gchar *new_name;
  gchar *actual_name = NULL;

  name = g_value_get_string (picman_value_array_index (args, 0));
  new_name = g_value_get_string (picman_value_array_index (args, 1));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        {
          picman_object_set_name (PICMAN_OBJECT (palette), new_name);
          actual_name = g_strdup (picman_object_get_name (palette));
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_take_string (picman_value_array_index (return_vals, 1), actual_name);

  return return_vals;
}

static PicmanValueArray *
palette_delete_invoker (PicmanProcedure         *procedure,
                        Picman                  *picman,
                        PicmanContext           *context,
                        PicmanProgress          *progress,
                        const PicmanValueArray  *args,
                        GError               **error)
{
  gboolean success = TRUE;
  const gchar *name;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette && picman_data_is_deletable (PICMAN_DATA (palette)))
        success = picman_data_factory_data_delete (picman->palette_factory,
                                                 PICMAN_DATA (palette),
                                                 TRUE, error);
      else
        success = FALSE;
    }

  return picman_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static PicmanValueArray *
palette_is_editable_invoker (PicmanProcedure         *procedure,
                             Picman                  *picman,
                             PicmanContext           *context,
                             PicmanProgress          *progress,
                             const PicmanValueArray  *args,
                             GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gboolean editable = FALSE;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        editable = picman_data_is_writable (PICMAN_DATA (palette));
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_boolean (picman_value_array_index (return_vals, 1), editable);

  return return_vals;
}

static PicmanValueArray *
palette_get_info_invoker (PicmanProcedure         *procedure,
                          Picman                  *picman,
                          PicmanContext           *context,
                          PicmanProgress          *progress,
                          const PicmanValueArray  *args,
                          GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gint32 num_colors = 0;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        num_colors = picman_palette_get_n_colors (palette);
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_int (picman_value_array_index (return_vals, 1), num_colors);

  return return_vals;
}

static PicmanValueArray *
palette_get_colors_invoker (PicmanProcedure         *procedure,
                            Picman                  *picman,
                            PicmanContext           *context,
                            PicmanProgress          *progress,
                            const PicmanValueArray  *args,
                            GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gint32 num_colors = 0;
  PicmanRGB *colors = NULL;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        {
          GList *list = picman_palette_get_colors (palette);
          gint   i;

          num_colors = picman_palette_get_n_colors (palette);
          colors     = g_new (PicmanRGB, num_colors);

          for (i = 0; i < num_colors; i++, list = g_list_next (list))
            {
              PicmanPaletteEntry *entry = list->data;

              colors[i] = entry->color;
            }
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    {
      g_value_set_int (picman_value_array_index (return_vals, 1), num_colors);
      picman_value_take_colorarray (picman_value_array_index (return_vals, 2), colors, num_colors);
    }

  return return_vals;
}

static PicmanValueArray *
palette_get_columns_invoker (PicmanProcedure         *procedure,
                             Picman                  *picman,
                             PicmanContext           *context,
                             PicmanProgress          *progress,
                             const PicmanValueArray  *args,
                             GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gint32 num_columns = 0;

  name = g_value_get_string (picman_value_array_index (args, 0));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        num_columns = picman_palette_get_columns (palette);
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_int (picman_value_array_index (return_vals, 1), num_columns);

  return return_vals;
}

static PicmanValueArray *
palette_set_columns_invoker (PicmanProcedure         *procedure,
                             Picman                  *picman,
                             PicmanContext           *context,
                             PicmanProgress          *progress,
                             const PicmanValueArray  *args,
                             GError               **error)
{
  gboolean success = TRUE;
  const gchar *name;
  gint32 columns;

  name = g_value_get_string (picman_value_array_index (args, 0));
  columns = g_value_get_int (picman_value_array_index (args, 1));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        picman_palette_set_columns (palette, columns);
      else
        success = FALSE;
    }

  return picman_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static PicmanValueArray *
palette_add_entry_invoker (PicmanProcedure         *procedure,
                           Picman                  *picman,
                           PicmanContext           *context,
                           PicmanProgress          *progress,
                           const PicmanValueArray  *args,
                           GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  const gchar *entry_name;
  PicmanRGB color;
  gint32 entry_num = 0;

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_name = g_value_get_string (picman_value_array_index (args, 1));
  picman_value_get_rgb (picman_value_array_index (args, 2), &color);

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        {
          PicmanPaletteEntry *entry =
            picman_palette_add_entry (palette, -1, entry_name, &color);

          entry_num = entry->position;
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_set_int (picman_value_array_index (return_vals, 1), entry_num);

  return return_vals;
}

static PicmanValueArray *
palette_delete_entry_invoker (PicmanProcedure         *procedure,
                              Picman                  *picman,
                              PicmanContext           *context,
                              PicmanProgress          *progress,
                              const PicmanValueArray  *args,
                              GError               **error)
{
  gboolean success = TRUE;
  const gchar *name;
  gint32 entry_num;

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_num = g_value_get_int (picman_value_array_index (args, 1));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        {
          PicmanPaletteEntry *entry = picman_palette_get_entry (palette, entry_num);

          if (entry)
            picman_palette_delete_entry (palette, entry);
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return picman_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static PicmanValueArray *
palette_entry_get_color_invoker (PicmanProcedure         *procedure,
                                 Picman                  *picman,
                                 PicmanContext           *context,
                                 PicmanProgress          *progress,
                                 const PicmanValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gint32 entry_num;
  PicmanRGB color = { 0.0, 0.0, 0.0, 1.0 };

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_num = g_value_get_int (picman_value_array_index (args, 1));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        {
          PicmanPaletteEntry *entry = picman_palette_get_entry (palette, entry_num);

          if (entry)
            color = entry->color;
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    picman_value_set_rgb (picman_value_array_index (return_vals, 1), &color);

  return return_vals;
}

static PicmanValueArray *
palette_entry_set_color_invoker (PicmanProcedure         *procedure,
                                 Picman                  *picman,
                                 PicmanContext           *context,
                                 PicmanProgress          *progress,
                                 const PicmanValueArray  *args,
                                 GError               **error)
{
  gboolean success = TRUE;
  const gchar *name;
  gint32 entry_num;
  PicmanRGB color;

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_num = g_value_get_int (picman_value_array_index (args, 1));
  picman_value_get_rgb (picman_value_array_index (args, 2), &color);

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        success = picman_palette_set_entry_color (palette, entry_num, &color);
      else
        success = FALSE;
    }

  return picman_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

static PicmanValueArray *
palette_entry_get_name_invoker (PicmanProcedure         *procedure,
                                Picman                  *picman,
                                PicmanContext           *context,
                                PicmanProgress          *progress,
                                const PicmanValueArray  *args,
                                GError               **error)
{
  gboolean success = TRUE;
  PicmanValueArray *return_vals;
  const gchar *name;
  gint32 entry_num;
  gchar *entry_name = NULL;

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_num = g_value_get_int (picman_value_array_index (args, 1));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, FALSE, error);

      if (palette)
        {
          PicmanPaletteEntry *entry = picman_palette_get_entry (palette, entry_num);

          if (entry)
            entry_name = g_strdup (entry->name);
          else
            success = FALSE;
        }
      else
        success = FALSE;
    }

  return_vals = picman_procedure_get_return_values (procedure, success,
                                                  error ? *error : NULL);

  if (success)
    g_value_take_string (picman_value_array_index (return_vals, 1), entry_name);

  return return_vals;
}

static PicmanValueArray *
palette_entry_set_name_invoker (PicmanProcedure         *procedure,
                                Picman                  *picman,
                                PicmanContext           *context,
                                PicmanProgress          *progress,
                                const PicmanValueArray  *args,
                                GError               **error)
{
  gboolean success = TRUE;
  const gchar *name;
  gint32 entry_num;
  const gchar *entry_name;

  name = g_value_get_string (picman_value_array_index (args, 0));
  entry_num = g_value_get_int (picman_value_array_index (args, 1));
  entry_name = g_value_get_string (picman_value_array_index (args, 2));

  if (success)
    {
      PicmanPalette *palette = picman_pdb_get_palette (picman, name, TRUE, error);

      if (palette)
        success = picman_palette_set_entry_name (palette, entry_num, entry_name);
      else
        success = FALSE;
    }

  return picman_procedure_get_return_values (procedure, success,
                                           error ? *error : NULL);
}

void
register_palette_procs (PicmanPDB *pdb)
{
  PicmanProcedure *procedure;

  /*
   * picman-palette-new
   */
  procedure = picman_procedure_new (palette_new_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-new");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-new",
                                     "Creates a new palette",
                                     "This procedure creates a new, uninitialized palette",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The requested name of the new palette",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_string ("actual-name",
                                                           "actual name",
                                                           "The actual new palette name",
                                                           FALSE, FALSE, FALSE,
                                                           NULL,
                                                           PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-duplicate
   */
  procedure = picman_procedure_new (palette_duplicate_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-duplicate");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-duplicate",
                                     "Duplicates a palette",
                                     "This procedure creates an identical palette by a different name",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_string ("copy-name",
                                                           "copy name",
                                                           "The name of the palette's copy",
                                                           FALSE, FALSE, TRUE,
                                                           NULL,
                                                           PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-rename
   */
  procedure = picman_procedure_new (palette_rename_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-rename");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-rename",
                                     "Rename a palette",
                                     "This procedure renames a palette",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("new-name",
                                                       "new name",
                                                       "The new name of the palette",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_string ("actual-name",
                                                           "actual name",
                                                           "The actual new name of the palette",
                                                           FALSE, FALSE, FALSE,
                                                           NULL,
                                                           PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-delete
   */
  procedure = picman_procedure_new (palette_delete_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-delete");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-delete",
                                     "Deletes a palette",
                                     "This procedure deletes a palette",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-is-editable
   */
  procedure = picman_procedure_new (palette_is_editable_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-is-editable");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-is-editable",
                                     "Tests if palette can be edited",
                                     "Returns TRUE if you have permission to change the palette",
                                     "Bill Skaggs <weskaggs@primate.ucdavis.edu>",
                                     "Bill Skaggs",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   g_param_spec_boolean ("editable",
                                                         "editable",
                                                         "TRUE if the palette can be edited",
                                                         FALSE,
                                                         PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-get-info
   */
  procedure = picman_procedure_new (palette_get_info_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-get-info");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-get-info",
                                     "Retrieve information about the specified palette.",
                                     "This procedure retrieves information about the specified palette. This includes the name, and the number of colors.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_int32 ("num-colors",
                                                          "num colors",
                                                          "The number of colors in the palette",
                                                          G_MININT32, G_MAXINT32, 0,
                                                          PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-get-colors
   */
  procedure = picman_procedure_new (palette_get_colors_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-get-colors");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-get-colors",
                                     "Gets all colors from the specified palette.",
                                     "This procedure retrieves all color entries of the specified palette.",
                                     "Sven Neumann <sven@picman.org>",
                                     "Sven Neumann",
                                     "2006",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_int32 ("num-colors",
                                                          "num colors",
                                                          "Length of the colors array",
                                                          0, G_MAXINT32, 0,
                                                          PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_color_array ("colors",
                                                                "colors",
                                                                "The colors in the palette",
                                                                PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-get-columns
   */
  procedure = picman_procedure_new (palette_get_columns_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-get-columns");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-get-columns",
                                     "Retrieves the number of columns to use to display this palette",
                                     "This procedures retrieves the preferred number of columns to use when the palette is being displayed.",
                                     "Sven Neumann <sven@picman.org>",
                                     "Sven Neumann",
                                     "2005",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_int32 ("num-columns",
                                                          "num columns",
                                                          "The number of columns used to display this palette",
                                                          G_MININT32, G_MAXINT32, 0,
                                                          PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-set-columns
   */
  procedure = picman_procedure_new (palette_set_columns_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-set-columns");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-set-columns",
                                     "Sets the number of columns to use when displaying the palette",
                                     "This procedures controls how many colors are shown per row when the palette is being displayed. This value can only be changed if the palette is writable. The maximum allowed value is 64.",
                                     "Sven Neumann <sven@picman.org>",
                                     "Sven Neumann",
                                     "2005",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("columns",
                                                      "columns",
                                                      "The new number of columns",
                                                      0, 64, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-add-entry
   */
  procedure = picman_procedure_new (palette_add_entry_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-add-entry");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-add-entry",
                                     "Adds a palette entry to the specified palette.",
                                     "This procedure adds an entry to the specified palette. It returns an error if the entry palette does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("entry-name",
                                                       "entry name",
                                                       "The name of the entry",
                                                       FALSE, TRUE, FALSE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_rgb ("color",
                                                    "color",
                                                    "The new entry's color color",
                                                    FALSE,
                                                    NULL,
                                                    PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_int32 ("entry-num",
                                                          "entry num",
                                                          "The index of the added entry",
                                                          G_MININT32, G_MAXINT32, 0,
                                                          PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-delete-entry
   */
  procedure = picman_procedure_new (palette_delete_entry_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-delete-entry");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-delete-entry",
                                     "Deletes a palette entry from the specified palette.",
                                     "This procedure deletes an entry from the specified palette. It returns an error if the entry palette does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("entry-num",
                                                      "entry num",
                                                      "The index of the added entry",
                                                      G_MININT32, G_MAXINT32, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-entry-get-color
   */
  procedure = picman_procedure_new (palette_entry_get_color_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-entry-get-color");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-entry-get-color",
                                     "Gets the specified palette entry from the specified palette.",
                                     "This procedure retrieves the color of the zero-based entry specified for the specified palette. It returns an error if the entry does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("entry-num",
                                                      "entry num",
                                                      "The entry to retrieve",
                                                      G_MININT32, G_MAXINT32, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_rgb ("color",
                                                        "color",
                                                        "The color requested",
                                                        FALSE,
                                                        NULL,
                                                        PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-entry-set-color
   */
  procedure = picman_procedure_new (palette_entry_set_color_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-entry-set-color");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-entry-set-color",
                                     "Sets the specified palette entry in the specified palette.",
                                     "This procedure sets the color of the zero-based entry specified for the specified palette. It returns an error if the entry does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("entry-num",
                                                      "entry num",
                                                      "The entry to retrieve",
                                                      G_MININT32, G_MAXINT32, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_rgb ("color",
                                                    "color",
                                                    "The new color",
                                                    FALSE,
                                                    NULL,
                                                    PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-entry-get-name
   */
  procedure = picman_procedure_new (palette_entry_get_name_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-entry-get-name");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-entry-get-name",
                                     "Gets the specified palette entry from the specified palette.",
                                     "This procedure retrieves the name of the zero-based entry specified for the specified palette. It returns an error if the entry does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("entry-num",
                                                      "entry num",
                                                      "The entry to retrieve",
                                                      G_MININT32, G_MAXINT32, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_procedure_add_return_value (procedure,
                                   picman_param_spec_string ("entry-name",
                                                           "entry name",
                                                           "The name requested",
                                                           FALSE, FALSE, FALSE,
                                                           NULL,
                                                           PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);

  /*
   * picman-palette-entry-set-name
   */
  procedure = picman_procedure_new (palette_entry_set_name_invoker);
  picman_object_set_static_name (PICMAN_OBJECT (procedure),
                               "picman-palette-entry-set-name");
  picman_procedure_set_static_strings (procedure,
                                     "picman-palette-entry-set-name",
                                     "Sets the specified palette entry in the specified palette.",
                                     "This procedure sets the name of the zero-based entry specified for the specified palette. It returns an error if the entry does not exist.",
                                     "Michael Natterer <mitch@picman.org>",
                                     "Michael Natterer",
                                     "2004",
                                     NULL);
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("name",
                                                       "name",
                                                       "The palette name",
                                                       FALSE, FALSE, TRUE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_int32 ("entry-num",
                                                      "entry num",
                                                      "The entry to retrieve",
                                                      G_MININT32, G_MAXINT32, 0,
                                                      PICMAN_PARAM_READWRITE));
  picman_procedure_add_argument (procedure,
                               picman_param_spec_string ("entry-name",
                                                       "entry name",
                                                       "The new name",
                                                       FALSE, TRUE, FALSE,
                                                       NULL,
                                                       PICMAN_PARAM_READWRITE));
  picman_pdb_register_procedure (pdb, procedure);
  g_object_unref (procedure);
}
